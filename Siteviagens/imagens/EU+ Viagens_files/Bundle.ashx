

ï»¿if (!this.JSON2) {
    JSON2 = function () {
        var reISO = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/;

        function f(n) { return n < 10 ? '0' + n : n; }
        var escapeable = /["\\\x00-\x1f\x7f-\x9f]/g, gap, indent, meta = { '\b': '\\b', '\t': '\\t', '\n': '\\n', '\f': '\\f', '\r': '\\r', '"': '\\"', '\\': '\\\\' }, rep; function quote(string) {
            return escapeable.test(string) ? '"' + string.replace(escapeable, function (a) {
                var c = meta[a]; if (typeof c === 'string') { return c; }
                c = a.charCodeAt(); return '\\u00' + Math.floor(c / 16).toString(16) +
(c % 16).toString(16);
            }) + '"' : '"' + string + '"';
        }
        function str(key, holder) {
            var i, k, v, length, mind = gap, partial, value = holder[key]; if (value && typeof value === 'object' && typeof value.toJSON === 'function') { value = value.toJSON(key); }
            if (typeof rep === 'function') { value = rep.call(holder, key, value); }
            switch (typeof value) {
                case 'string': return quote(value); case 'number': return isFinite(value) ? String(value) : 'null'; case 'boolean': case 'null': return String(value); case 'object': if (!value) { return 'null'; }
                    if (value.toUTCString) {
                        var xx = '"\\/Date(' + value.getTime() + ')\\/"';
                        return xx;
                    }
                    gap += indent; partial = []; if (typeof value.length === 'number' && !(value.propertyIsEnumerable('length'))) {
                        length = value.length; for (i = 0; i < length; i += 1) { partial[i] = str(i, value) || 'null'; }
                        v = partial.length === 0 ? '[]' : gap ? '[\n' + gap + partial.join(',\n' + gap) + '\n' + mind + ']' : '[' + partial.join(',') + ']'; gap = mind; return v;
                    }
                    if (typeof rep === 'object') { length = rep.length; for (i = 0; i < length; i += 1) { k = rep[i]; if (typeof k === 'string') { v = str(k, value, rep); if (v) { partial.push(quote(k) + (gap ? ': ' : ':') + v); } } } } else { for (k in value) { v = str(k, value, rep); if (v) { partial.push(quote(k) + (gap ? ': ' : ':') + v); } } }
                    v = partial.length === 0 ? '{}' : gap ? '{\n' + gap + partial.join(',\n' + gap) + '\n' + mind + '}' : '{' + partial.join(',') + '}'; gap = mind; return v;
            }
        }
        return { stringify: function (value, replacer, space) {
            var i; gap = ''; indent = ''; if (space) { if (typeof space === 'number') { for (i = 0; i < space; i += 1) { indent += ' '; } } else if (typeof space === 'string') { indent = space; } }
            if (!replacer) {
                rep = function (key, value) {
                    if (!Object.hasOwnProperty.call(this, key)) { return undefined; }
                    return value;
                };
            } else if (typeof replacer === 'function' || (typeof replacer === 'object' && typeof replacer.length === 'number')) { rep = replacer; } else { throw new Error('JSON.stringify'); }
            return str('', { '': value });
        }, parse: function (text, reviver) {
            var j; function walk(holder, key) {
                var k, v, value = holder[key]; if (value && typeof value === 'object') { for (k in value) { if (Object.hasOwnProperty.call(value, k)) { v = walk(value, k); if (v !== undefined) { value[k] = v; } else { delete value[k]; } } } }
                return reviver.call(holder, key, value);
            }

            if (/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/bfnrtu]/g, '@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ']').replace(/(?:^|:|,)(?:\s*\[)+/g, ''))) {
                var regEx = /(\"\d{4}-\d{2}-\d{2}T\d{2}:\d{2}.*?\")|(\"\\*\/Date\(.*?\)\\*\/")/g; text = text.replace(regEx, this.regExDate);

                j = eval('(' + text + ')');

                return typeof reviver === 'function' ? walk({ '': j }, '') : j;
            }
            throw new SyntaxError('JSON.parse');
        }, regExDate: function (str, p1, p2, offset, s) {
            str = str.substring(1).replace('"', ''); var date = str; if (/\/Date(.*)\//.test(str)) { str = str.match(/Date\((.*?)\)/)[1]; date = "getBrazilianDateInternal(new Date(" + parseInt(str) + "))"; }
            else { var matches = str.split(/[-,:,T,Z,.]/); matches[1] = (parseInt(matches[1], 0) - 1).toString(); var dateGenerated = matches.join(","); if (dateGenerated.lastIndexOf(',') == (dateGenerated.length - 1)) { dateGenerated = dateGenerated.substring(0, dateGenerated.length - 1); } date = "new Date(Date.UTC(" + dateGenerated + "))"; }
            return date;
        }, quote: quote
         , stringifyWcf: function (json) {
             return JSON2.stringify(json, function (key, value) {
                 if (typeof value == "string") {
                     var a = reISO.exec(value);
                     if (a) {
                         var val = '/Date(' + new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4], +a[5], +a[6])).getTime() + '-0300)/';
                         this[key] = val;
                         return val;
                     }
                 }
                 return value;
             })
         }
        };
    } ();
}

function getBrazilianDateInternal(date) {

    var DayUTC = date.getUTCDate();
    var MonthUTC = date.getUTCMonth();
    var YearUTC = date.getUTCFullYear();
    var HourUTC = date.getUTCHours() - 3;
    var MinUTC = date.getUTCMinutes();
    var SecUTC = date.getUTCSeconds();
    var TMZ = date.getTimezoneOffset();

    //HourUTC = (HourUTC - ((180 - TMZ) / 60));

    var dateUTC = new Date(YearUTC, MonthUTC, DayUTC, HourUTC, MinUTC, SecUTC);
    dateUTC.setUTCHours(date.getUTCHours() - ((180 - TMZ) / 60));

    return dateUTC;
}



/*
 * Copyright 2008 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * @fileoverview
 * Utility functions and classes for Soy.
 *
 * <p>
 * The top portion of this file contains utilities for Soy users:<ul>
 *   <li> soy.StringBuilder: Compatible with the 'stringbuilder' code style.
 *   <li> soy.renderElement: Render template and set as innerHTML of an element.
 *   <li> soy.renderAsFragment: Render template and return as HTML fragment.
 * </ul>
 *
 * <p>
 * The bottom portion of this file contains utilities that should only be called
 * by Soy-generated JS code. Please do not use these functions directly from
 * your hand-writen code. Their names all start with '$$'.
 *
 * @author Garrett Boyer
 * @author Mike Samuel
 * @author Kai Huang
 * @author Aharon Lanin
 */


// COPIED FROM nogoog_shim.js

// Create closure namespaces.
var goog = goog || {};


goog.DEBUG = false;


goog.inherits = function(childCtor, parentCtor) {
  /** @constructor */
  function tempCtor() {};
  tempCtor.prototype = parentCtor.prototype;
  childCtor.superClass_ = parentCtor.prototype;
  childCtor.prototype = new tempCtor();
  childCtor.prototype.constructor = childCtor;

  /**
   * Calls superclass constructor/method.
   * @param {!Object} me Should always be "this".
   * @param {string} methodName
   * @param {...*} var_args
   * @return {?} The return value of the superclass method/constructor.
   */
  childCtor.base = function(me, methodName, var_args) {
    var args = Array.prototype.slice.call(arguments, 2);
    return parentCtor.prototype[methodName].apply(me, args);
  };
};


// Just enough browser detection for this file.
if (!goog.userAgent) {
  goog.userAgent = (function() {
    var userAgent = "";
    if ("undefined" !== typeof navigator && navigator
        && "string" == typeof navigator.userAgent) {
      userAgent = navigator.userAgent;
    }
    var isOpera = userAgent.indexOf('Opera') == 0;
    return {
      jscript: {
        /**
         * @type {boolean}
         */
        HAS_JSCRIPT: 'ScriptEngine' in this
      },
      /**
       * @type {boolean}
       */
      OPERA: isOpera,
      /**
       * @type {boolean}
       */
      IE: !isOpera && userAgent.indexOf('MSIE') != -1,
      /**
       * @type {boolean}
       */
      WEBKIT: !isOpera && userAgent.indexOf('WebKit') != -1
    };
  })();
}

if (!goog.asserts) {
  goog.asserts = {
    /**
     * @param {*} condition Condition to check.
     */
    assert: function (condition) {
      if (!condition) {
        throw Error('Assertion error');
      }
    },
    /**
     * @param {...*} var_args
     */
    fail: function (var_args) {}
  };
}


// Stub out the document wrapper used by renderAs*.
if (!goog.dom) {
  goog.dom = {};
  /**
   * @param {Document=} d
   * @constructor
   */
  goog.dom.DomHelper = function(d) {
    this.document_ = d || document;
  };
  /**
   * @return {!Document}
   */
  goog.dom.DomHelper.prototype.getDocument = function() {
    return this.document_;
  };
  /**
   * Creates a new element.
   * @param {string} name Tag name.
   * @return {!Element}
   */
  goog.dom.DomHelper.prototype.createElement = function(name) {
    return this.document_.createElement(name);
  };
  /**
   * Creates a new document fragment.
   * @return {!DocumentFragment}
   */
  goog.dom.DomHelper.prototype.createDocumentFragment = function() {
    return this.document_.createDocumentFragment();
  };
}


if (!goog.format) {
  goog.format = {
    insertWordBreaks: function(str, maxCharsBetweenWordBreaks) {
      str = String(str);

      var resultArr = [];
      var resultArrLen = 0;

      // These variables keep track of important state inside str.
      var isInTag = false;  // whether we're inside an HTML tag
      var isMaybeInEntity = false;  // whether we might be inside an HTML entity
      var numCharsWithoutBreak = 0;  // number of chars since last word break
      var flushIndex = 0;  // index of first char not yet flushed to resultArr

      for (var i = 0, n = str.length; i < n; ++i) {
        var charCode = str.charCodeAt(i);

        // If hit maxCharsBetweenWordBreaks, and not space next, then add <wbr>.
        if (numCharsWithoutBreak >= maxCharsBetweenWordBreaks &&
            // space
            charCode != 32) {
          resultArr[resultArrLen++] = str.substring(flushIndex, i);
          flushIndex = i;
          resultArr[resultArrLen++] = goog.format.WORD_BREAK;
          numCharsWithoutBreak = 0;
        }

        if (isInTag) {
          // If inside an HTML tag and we see '>', it's the end of the tag.
          if (charCode == 62) {
            isInTag = false;
          }

        } else if (isMaybeInEntity) {
          switch (charCode) {
            // Inside an entity, a ';' is the end of the entity.
            // The entity that just ended counts as one char, so increment
            // numCharsWithoutBreak.
          case 59:  // ';'
            isMaybeInEntity = false;
            ++numCharsWithoutBreak;
            break;
            // If maybe inside an entity and we see '<', we weren't actually in
            // an entity. But now we're inside and HTML tag.
          case 60:  // '<'
            isMaybeInEntity = false;
            isInTag = true;
            break;
            // If maybe inside an entity and we see ' ', we weren't actually in
            // an entity. Just correct the state and reset the
            // numCharsWithoutBreak since we just saw a space.
          case 32:  // ' '
            isMaybeInEntity = false;
            numCharsWithoutBreak = 0;
            break;
          }

        } else {  // !isInTag && !isInEntity
          switch (charCode) {
            // When not within a tag or an entity and we see '<', we're now
            // inside an HTML tag.
          case 60:  // '<'
            isInTag = true;
            break;
            // When not within a tag or an entity and we see '&', we might be
            // inside an entity.
          case 38:  // '&'
            isMaybeInEntity = true;
            break;
            // When we see a space, reset the numCharsWithoutBreak count.
          case 32:  // ' '
            numCharsWithoutBreak = 0;
            break;
            // When we see a non-space, increment the numCharsWithoutBreak.
          default:
            ++numCharsWithoutBreak;
            break;
          }
        }
      }

      // Flush the remaining chars at the end of the string.
      resultArr[resultArrLen++] = str.substring(flushIndex);

      return resultArr.join('');
    },
    /**
     * String inserted as a word break by insertWordBreaks(). Safari requires
     * <wbr></wbr>, Opera needs the &shy; entity, though this will give a
     * visible hyphen at breaks. IE8+ use a zero width space. Other browsers
     * just use <wbr>.
     * @type {string}
     * @private
     */
    WORD_BREAK:
        goog.userAgent.WEBKIT ? '<wbr></wbr>' :
        goog.userAgent.OPERA ? '&shy;' :
        goog.userAgent.IE ? '&#8203;' :
        '<wbr>'
  };
}


if (!goog.i18n) {
  goog.i18n = {
    bidi: {}
  };
}


/**
 * Constant that defines whether or not the current locale is an RTL locale.
 *
 * @type {boolean}
 */
goog.i18n.bidi.IS_RTL = false;


/**
 * Directionality enum.
 * @enum {number}
 */
goog.i18n.bidi.Dir = {
  /**
   * Left-to-right.
   */
  LTR: 1,

  /**
   * Right-to-left.
   */
  RTL: -1,

  /**
   * Neither left-to-right nor right-to-left.
   */
  NEUTRAL: 0,

  /**
   * A historical misnomer for NEUTRAL.
   * @deprecated For "neutral", use NEUTRAL; for "unknown", use null.
   */
  UNKNOWN: 0
};


/**
 * Convert a directionality given in various formats to a goog.i18n.bidi.Dir
 * constant. Useful for interaction with different standards of directionality
 * representation.
 *
 * @param {goog.i18n.bidi.Dir|number|boolean|null} givenDir Directionality given
 *     in one of the following formats:
 *     1. A goog.i18n.bidi.Dir constant.
 *     2. A number (positive = LTR, negative = RTL, 0 = neutral).
 *     3. A boolean (true = RTL, false = LTR).
 *     4. A null for unknown directionality.
 * @param {boolean=} opt_noNeutral Whether a givenDir of zero or
 *     goog.i18n.bidi.Dir.NEUTRAL should be treated as null, i.e. unknown, in
 *     order to preserve legacy behavior.
 * @return {?goog.i18n.bidi.Dir} A goog.i18n.bidi.Dir constant matching the
 *     given directionality. If given null, returns null (i.e. unknown).
 */
goog.i18n.bidi.toDir = function(givenDir, opt_noNeutral) {
  if (typeof givenDir == 'number') {
    // This includes the non-null goog.i18n.bidi.Dir case.
    return givenDir > 0 ? goog.i18n.bidi.Dir.LTR :
        givenDir < 0 ? goog.i18n.bidi.Dir.RTL :
        opt_noNeutral ? null : goog.i18n.bidi.Dir.NEUTRAL;
  } else if (givenDir == null) {
    return null;
  } else {
    // Must be typeof givenDir == 'boolean'.
    return givenDir ? goog.i18n.bidi.Dir.RTL : goog.i18n.bidi.Dir.LTR;
  }
};


/**
 * Estimates the directionality of a string based on relative word counts.
 * If the number of RTL words is above a certain percentage of the total number
 * of strongly directional words, returns RTL.
 * Otherwise, if any words are strongly or weakly LTR, returns LTR.
 * Otherwise, returns NEUTRAL.
 * Numbers are counted as weakly LTR.
 * @param {string} str The string to be checked.
 * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.
 *     Default: false.
 * @return {goog.i18n.bidi.Dir} Estimated overall directionality of {@code str}.
 */
goog.i18n.bidi.estimateDirection = function(str, opt_isHtml) {
  var rtlCount = 0;
  var totalCount = 0;
  var hasWeaklyLtr = false;
  var tokens = soyshim.$$bidiStripHtmlIfNecessary_(str, opt_isHtml).
      split(soyshim.$$bidiWordSeparatorRe_);
  for (var i = 0; i < tokens.length; i++) {
    var token = tokens[i];
    if (soyshim.$$bidiRtlDirCheckRe_.test(token)) {
      rtlCount++;
      totalCount++;
    } else if (soyshim.$$bidiIsRequiredLtrRe_.test(token)) {
      hasWeaklyLtr = true;
    } else if (soyshim.$$bidiLtrCharRe_.test(token)) {
      totalCount++;
    } else if (soyshim.$$bidiHasNumeralsRe_.test(token)) {
      hasWeaklyLtr = true;
    }
  }

  return totalCount == 0 ?
      (hasWeaklyLtr ? goog.i18n.bidi.Dir.LTR : goog.i18n.bidi.Dir.NEUTRAL) :
      (rtlCount / totalCount > soyshim.$$bidiRtlDetectionThreshold_ ?
          goog.i18n.bidi.Dir.RTL : goog.i18n.bidi.Dir.LTR);
};


/**
 * Utility class for formatting text for display in a potentially
 * opposite-directionality context without garbling. Provides the following
 * functionality:
 *
 * @param {goog.i18n.bidi.Dir|number|boolean|null} dir The context
 *     directionality, in one of the following formats:
 *     1. A goog.i18n.bidi.Dir constant. NEUTRAL is treated the same as null,
 *        i.e. unknown, for backward compatibility with legacy calls.
 *     2. A number (positive = LTR, negative = RTL, 0 = unknown).
 *     3. A boolean (true = RTL, false = LTR).
 *     4. A null for unknown directionality.
 * @constructor
 */
goog.i18n.BidiFormatter = function(dir) {
  /**
   * The overall directionality of the context in which the formatter is being
   * used.
   * @type {?goog.i18n.bidi.Dir}
   * @private
   */
  this.dir_ = goog.i18n.bidi.toDir(dir, true /* opt_noNeutral */);
};

/**
 * @return {?goog.i18n.bidi.Dir} The context directionality.
 */
goog.i18n.BidiFormatter.prototype.getContextDir = function() {
  return this.dir_;
};

/**
 * Returns 'dir="ltr"' or 'dir="rtl"', depending on the given directionality, if
 * it is not the same as the context directionality. Otherwise, returns the
 * empty string.
 *
 * @param {goog.i18n.bidi.Dir} dir A directionality.
 * @return {string} 'dir="rtl"' for RTL text in non-RTL context; 'dir="ltr"' for
 *     LTR text in non-LTR context; else, the empty string.
 */
goog.i18n.BidiFormatter.prototype.knownDirAttr = function(dir) {
  return !dir || dir == this.dir_ ? '' : dir < 0 ? 'dir="rtl"' : 'dir="ltr"';
};

/**
 * Returns the trailing horizontal edge, i.e. "right" or "left", depending on
 * the global bidi directionality.
 * @return {string} "left" for RTL context and "right" otherwise.
 */
goog.i18n.BidiFormatter.prototype.endEdge = function () {
  return this.dir_ < 0 ? 'left' : 'right';
};

/**
 * Returns the Unicode BiDi mark matching the context directionality (LRM for
 * LTR context directionality, RLM for RTL context directionality), or the
 * empty string for unknown context directionality.
 *
 * @return {string} LRM for LTR context directionality and RLM for RTL context
 *     directionality.
 */
goog.i18n.BidiFormatter.prototype.mark = function () {
  return (
      (this.dir_ > 0) ? '\u200E' /*LRM*/ :
      (this.dir_ < 0) ? '\u200F' /*RLM*/ :
      '');
};

/**
 * Returns a Unicode bidi mark matching the context directionality (LRM or RLM)
 * if the directionality or the exit directionality of {@code text} are opposite
 * to the context directionality. Otherwise returns the empty string.
 * If opt_isHtml, makes sure to ignore the LTR nature of the mark-up and escapes
 * in text, making the logic suitable for HTML and HTML-escaped text.
 * @param {?goog.i18n.bidi.Dir} textDir {@code text}'s overall directionality,
 *     or null if unknown and needs to be estimated.
 * @param {string} text The text whose directionality is to be estimated.
 * @param {boolean=} opt_isHtml Whether text is HTML/HTML-escaped.
 *     Default: false.
 * @return {string} A Unicode bidi mark matching the context directionality, or
 *     the empty string when either the context directionality is unknown or
 *     neither the text's overall nor its exit directionality is opposite to it.
 */
goog.i18n.BidiFormatter.prototype.markAfterKnownDir = function (
    textDir, text, opt_isHtml) {
  if (textDir == null) {
    textDir = goog.i18n.bidi.estimateDirection(text, opt_isHtml);
  }
  return (
      this.dir_ > 0 && (textDir < 0 ||
          soyshim.$$bidiIsRtlExitText_(text, opt_isHtml)) ? '\u200E' : // LRM
      this.dir_ < 0 && (textDir > 0 ||
          soyshim.$$bidiIsLtrExitText_(text, opt_isHtml)) ? '\u200F' : // RLM
      '');
};

/**
 * Formats an HTML string for use in HTML output of the context directionality,
 * so an opposite-directionality string is neither garbled nor garbles what
 * follows it.
 *
 * @param {?goog.i18n.bidi.Dir} textDir {@code str}'s overall directionality, or
 *     null if unknown and needs to be estimated.
 * @param {string} str The input text (HTML or HTML-escaped).
 * @param {boolean=} placeholder This argument exists for consistency with the
 *     Closure Library. Specifying it has no effect.
 * @return {string} The input text after applying the above processing.
 */
goog.i18n.BidiFormatter.prototype.spanWrapWithKnownDir = function(
    textDir, str, placeholder) {
  if (textDir == null) {
    textDir = goog.i18n.bidi.estimateDirection(str, true);
  }
  var reset = this.markAfterKnownDir(textDir, str, true);
  if (textDir > 0 && this.dir_ <= 0) {
    str = '<span dir="ltr">' + str + '</span>';
  } else if (textDir < 0 && this.dir_ >= 0) {
    str = '<span dir="rtl">' + str + '</span>';
  }
  return str + reset;
};

/**
 * Returns the leading horizontal edge, i.e. "left" or "right", depending on
 * the global bidi directionality.
 * @return {string} "right" for RTL context and "left" otherwise.
 */
goog.i18n.BidiFormatter.prototype.startEdge = function () {
  return this.dir_ < 0 ? 'right' : 'left';
};

/**
 * Formats an HTML-escaped string for use in HTML output of the context
 * directionality, so an opposite-directionality string is neither garbled nor
 * garbles what follows it.
 * As opposed to {@link #spanWrapWithKnownDir}, this makes use of unicode bidi
 * formatting characters. In HTML, it should only be used inside attribute
 * values and elements that do not allow markup, e.g. an 'option' tag.
 *
 * @param {?goog.i18n.bidi.Dir} textDir {@code str}'s overall directionality, or
 *     null if unknown and needs to be estimated.
 * @param {string} str The input text (HTML-escaped).
 * @param {boolean=} opt_isHtml Whether {@code str} is HTML / HTML-escaped.
 *     Default: false.
 * @return {string} The input text after applying the above processing.
 */
goog.i18n.BidiFormatter.prototype.unicodeWrapWithKnownDir = function(
    textDir, str, opt_isHtml) {
  if (textDir == null) {
    textDir = goog.i18n.bidi.estimateDirection(str, opt_isHtml);
  }
  var reset = this.markAfterKnownDir(textDir, str, opt_isHtml);
  if (textDir > 0 && this.dir_ <= 0) {
    str = '\u202A' + str + '\u202C';
  } else if (textDir < 0 && this.dir_ >= 0) {
    str = '\u202B' + str + '\u202C';
  }
  return str + reset;
};


if (!goog.string) {
  goog.string = {
    /**
     * Converts \r\n, \r, and \n to <br>s
     * @param {*} str The string in which to convert newlines.
     * @param {boolean=} opt_xml Whether to use XML compatible tags.
     * @return {string} A copy of {@code str} with converted newlines.
     */
    newLineToBr: function(str, opt_xml) {

      str = String(str);

      // This quick test helps in the case when there are no chars to replace,
      // in the worst case this makes barely a difference to the time taken.
      if (!goog.string.NEWLINE_TO_BR_RE_.test(str)) {
        return str;
      }

      return str.replace(/(\r\n|\r|\n)/g, opt_xml ? '<br />' : '<br>');
    },
    urlEncode: encodeURIComponent,
    /**
     * Regular expression used within newlineToBr().
     * @type {RegExp}
     * @private
     */
    NEWLINE_TO_BR_RE_: /[\r\n]/
  };
}

/**
 * Utility class to facilitate much faster string concatenation in IE,
 * using Array.join() rather than the '+' operator. For other browsers
 * we simply use the '+' operator.
 *
 * @param {Object|number|string|boolean=} opt_a1 Optional first initial item
 *     to append.
 * @param {...Object|number|string|boolean} var_args Other initial items to
 *     append, e.g., new goog.string.StringBuffer('foo', 'bar').
 * @constructor
 */
goog.string.StringBuffer = function(opt_a1, var_args) {
  /**
   * Internal buffer for the string to be concatenated.
   * @type {string|Array}
   * @private
   */
  this.buffer_ = goog.userAgent.jscript.HAS_JSCRIPT ? [] : '';

  if (opt_a1 != null) {
    this.append.apply(this, arguments);
  }
};


/**
 * Length of internal buffer (faster than calling buffer_.length).
 * Only used for IE.
 * @type {number}
 * @private
 */
goog.string.StringBuffer.prototype.bufferLength_ = 0;

/**
 * Appends one or more items to the string.
 *
 * Calling this with null, undefined, or empty arguments is an error.
 *
 * @param {Object|number|string|boolean} a1 Required first string.
 * @param {Object|number|string|boolean=} opt_a2 Optional second string.
 * @param {...Object|number|string|boolean} var_args Other items to append,
 *     e.g., sb.append('foo', 'bar', 'baz').
 * @return {goog.string.StringBuffer} This same StringBuilder object.
 */
goog.string.StringBuffer.prototype.append = function(a1, opt_a2, var_args) {

  if (goog.userAgent.jscript.HAS_JSCRIPT) {
    if (opt_a2 == null) {  // no second argument (note: undefined == null)
      // Array assignment is 2x faster than Array push. Also, use a1
      // directly to avoid arguments instantiation, another 2x improvement.
      this.buffer_[this.bufferLength_++] = a1;
    } else {
      var arr = /**@type {Array.<number|string|boolean>}*/(this.buffer_);
      arr.push.apply(arr, arguments);
      this.bufferLength_ = this.buffer_.length;
    }

  } else {

    // Use a1 directly to avoid arguments instantiation for single-arg case.
    this.buffer_ += a1;
    if (opt_a2 != null) {  // no second argument (note: undefined == null)
      for (var i = 1; i < arguments.length; i++) {
        this.buffer_ += arguments[i];
      }
    }
  }

  return this;
};


/**
 * Clears the string.
 */
goog.string.StringBuffer.prototype.clear = function() {

  if (goog.userAgent.jscript.HAS_JSCRIPT) {
     this.buffer_.length = 0;  // reuse array to avoid creating new object
     this.bufferLength_ = 0;

   } else {
     this.buffer_ = '';
   }
};


/**
 * Returns the concatenated string.
 *
 * @return {string} The concatenated string.
 */
goog.string.StringBuffer.prototype.toString = function() {

  if (goog.userAgent.jscript.HAS_JSCRIPT) {
    var str = this.buffer_.join('');
    // Given a string with the entire contents, simplify the StringBuilder by
    // setting its contents to only be this string, rather than many fragments.
    this.clear();
    if (str) {
      this.append(str);
    }
    return str;

  } else {
    return /** @type {string} */ (this.buffer_);
  }
};


if (!goog.soy) goog.soy = {
  /**
   * Helper function to render a Soy template and then set the
   * output string as the innerHTML of an element. It is recommended
   * to use this helper function instead of directly setting
   * innerHTML in your hand-written code, so that it will be easier
   * to audit the code for cross-site scripting vulnerabilities.
   *
   * @param {Function} template The Soy template defining element's content.
   * @param {Object=} opt_templateData The data for the template.
   * @param {Object=} opt_injectedData The injected data for the template.
   * @param {(goog.dom.DomHelper|Document)=} opt_dom The context in which DOM
   *     nodes will be created.
   */
  renderAsElement: function(
    template, opt_templateData, opt_injectedData, opt_dom) {
    return /** @type {!Element} */ (soyshim.$$renderWithWrapper_(
        template, opt_templateData, opt_dom, true /* asElement */,
        opt_injectedData));
  },
  /**
   * Helper function to render a Soy template into a single node or
   * a document fragment. If the rendered HTML string represents a
   * single node, then that node is returned (note that this is
   * *not* a fragment, despite them name of the method). Otherwise a
   * document fragment is returned containing the rendered nodes.
   *
   * @param {Function} template The Soy template defining element's content.
   * @param {Object=} opt_templateData The data for the template.
   * @param {Object=} opt_injectedData The injected data for the template.
   * @param {(goog.dom.DomHelper|Document)=} opt_dom The context in which DOM
   *     nodes will be created.
   * @return {!Node} The resulting node or document fragment.
   */
  renderAsFragment: function(
    template, opt_templateData, opt_injectedData, opt_dom) {
    return soyshim.$$renderWithWrapper_(
        template, opt_templateData, opt_dom, false /* asElement */,
        opt_injectedData);
  },
  /**
   * Helper function to render a Soy template and then set the output string as
   * the innerHTML of an element. It is recommended to use this helper function
   * instead of directly setting innerHTML in your hand-written code, so that it
   * will be easier to audit the code for cross-site scripting vulnerabilities.
   *
   * NOTE: New code should consider using goog.soy.renderElement instead.
   *
   * @param {Element} element The element whose content we are rendering.
   * @param {Function} template The Soy template defining the element's content.
   * @param {Object=} opt_templateData The data for the template.
   * @param {Object=} opt_injectedData The injected data for the template.
   */
  renderElement: function(
      element, template, opt_templateData, opt_injectedData) {
    element.innerHTML = template(opt_templateData, null, opt_injectedData);
  },
  data: {}
};


/**
 * A type of textual content.
 *
 * This is an enum of type Object so that these values are unforgeable.
 *
 * @enum {!Object}
 */
goog.soy.data.SanitizedContentKind = {

  /**
   * A snippet of HTML that does not start or end inside a tag, comment, entity,
   * or DOCTYPE; and that does not contain any executable code
   * (JS, {@code <object>}s, etc.) from a different trust domain.
   */
  HTML: goog.DEBUG ? {sanitizedContentKindHtml: true} : {},

  /**
   * Executable Javascript code or expression, safe for insertion in a
   * script-tag or event handler context, known to be free of any
   * attacker-controlled scripts. This can either be side-effect-free
   * Javascript (such as JSON) or Javascript that's entirely under Google's
   * control.
   */
  JS: goog.DEBUG ? {sanitizedContentJsChars: true} : {},

  /**
   * A sequence of code units that can appear between quotes (either kind) in a
   * JS program without causing a parse error, and without causing any side
   * effects.
   * <p>
   * The content should not contain unescaped quotes, newlines, or anything else
   * that would cause parsing to fail or to cause a JS parser to finish the
   * string its parsing inside the content.
   * <p>
   * The content must also not end inside an escape sequence ; no partial octal
   * escape sequences or odd number of '{@code \}'s at the end.
   */
  JS_STR_CHARS: goog.DEBUG ? {sanitizedContentJsStrChars: true} : {},

  /** A properly encoded portion of a URI. */
  URI: goog.DEBUG ? {sanitizedContentUri: true} : {},

  /**
   * Repeated attribute names and values. For example,
   * {@code dir="ltr" foo="bar" onclick="trustedFunction()" checked}.
   */
  ATTRIBUTES: goog.DEBUG ? {sanitizedContentHtmlAttribute: true} : {},

  // TODO: Consider separating rules, declarations, and values into
  // separate types, but for simplicity, we'll treat explicitly blessed
  // SanitizedContent as allowed in all of these contexts.
  /**
   * A CSS3 declaration, property, value or group of semicolon separated
   * declarations.
   */
  CSS: goog.DEBUG ? {sanitizedContentCss: true} : {},

  /**
   * Unsanitized plain-text content.
   *
   * This is effectively the "null" entry of this enum, and is sometimes used
   * to explicitly mark content that should never be used unescaped. Since any
   * string is safe to use as text, being of ContentKind.TEXT makes no
   * guarantees about its safety in any other context such as HTML.
   */
  TEXT: goog.DEBUG ? {sanitizedContentKindText: true} : {}
};



/**
 * A string-like object that carries a content-type and a content direction.
 *
 * IMPORTANT! Do not create these directly, nor instantiate the subclasses.
 * Instead, use a trusted, centrally reviewed library as endorsed by your team
 * to generate these objects. Otherwise, you risk accidentally creating
 * SanitizedContent that is attacker-controlled and gets evaluated unescaped in
 * templates.
 *
 * @constructor
 */
goog.soy.data.SanitizedContent = function() {
  throw Error('Do not instantiate directly');
};


/**
 * The context in which this content is safe from XSS attacks.
 * @type {goog.soy.data.SanitizedContentKind}
 */
goog.soy.data.SanitizedContent.prototype.contentKind;


/**
 * The content's direction; null if unknown and thus to be estimated when
 * necessary.
 * @type {?goog.i18n.bidi.Dir}
 */
goog.soy.data.SanitizedContent.prototype.contentDir = null;


/**
 * The already-safe content.
 * @type {string}
 */
goog.soy.data.SanitizedContent.prototype.content;


/** @override */
goog.soy.data.SanitizedContent.prototype.toString = function() {
  return this.content;
};


var soy = { esc: {} };
var soydata = {};
soydata.VERY_UNSAFE = {};
var soyshim = { $$DEFAULT_TEMPLATE_DATA_: {} };
/**
 * Helper function to render a Soy template into a single node or a document
 * fragment. If the rendered HTML string represents a single node, then that
 * node is returned. Otherwise a document fragment is created and returned
 * (wrapped in a DIV element if #opt_singleNode is true).
 *
 * @param {Function} template The Soy template defining the element's content.
 * @param {Object=} opt_templateData The data for the template.
 * @param {(goog.dom.DomHelper|Document)=} opt_dom The context in which DOM
 *     nodes will be created.
 * @param {boolean=} opt_asElement Whether to wrap the fragment in an
 *     element if the template does not render a single element. If true,
 *     result is always an Element.
 * @param {Object=} opt_injectedData The injected data for the template.
 * @return {!Node} The resulting node or document fragment.
 * @private
 */
soyshim.$$renderWithWrapper_ = function(
    template, opt_templateData, opt_dom, opt_asElement, opt_injectedData) {

  var dom = opt_dom || document;
  var wrapper = dom.createElement('div');
  wrapper.innerHTML = template(
    opt_templateData || soyshim.$$DEFAULT_TEMPLATE_DATA_, undefined,
    opt_injectedData);

  // If the template renders as a single element, return it.
  if (wrapper.childNodes.length == 1) {
    var firstChild = wrapper.firstChild;
    if (!opt_asElement || firstChild.nodeType == 1 /* Element */) {
      return /** @type {!Node} */ (firstChild);
    }
  }

  // If we're forcing it to be a single element, return the wrapper DIV.
  if (opt_asElement) {
    return wrapper;
  }

  // Otherwise, create and return a fragment.
  var fragment = dom.createDocumentFragment();
  while (wrapper.firstChild) {
    fragment.appendChild(wrapper.firstChild);
  }
  return fragment;
};


/**
 * Strips str of any HTML mark-up and escapes. Imprecise in several ways, but
 * precision is not very important, since the result is only meant to be used
 * for directionality detection.
 * Based on goog.i18n.bidi.stripHtmlIfNeeded_().
 * @param {string} str The string to be stripped.
 * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.
 *     Default: false.
 * @return {string} The stripped string.
 * @private
 */
soyshim.$$bidiStripHtmlIfNecessary_ = function(str, opt_isHtml) {
  return opt_isHtml ? str.replace(soyshim.$$BIDI_HTML_SKIP_RE_, '') : str;
};


/**
 * Simplified regular expression for am HTML tag (opening or closing) or an HTML
 * escape - the things we want to skip over in order to ignore their ltr
 * characters.
 * Copied from goog.i18n.bidi.htmlSkipReg_.
 * @type {RegExp}
 * @private
 */
soyshim.$$BIDI_HTML_SKIP_RE_ = /<[^>]*>|&[^;]+;/g;


/**
 * A practical pattern to identify strong LTR character. This pattern is not
 * theoretically correct according to unicode standard. It is simplified for
 * performance and small code size.
 * Copied from goog.i18n.bidi.ltrChars_.
 * @type {string}
 * @private
 */
soyshim.$$bidiLtrChars_ =
    'A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02B8\u0300-\u0590\u0800-\u1FFF' +
    '\u200E\u2C00-\uFB1C\uFE00-\uFE6F\uFEFD-\uFFFF';


/**
 * A practical pattern to identify strong RTL character. This pattern is not
 * theoretically correct according to unicode standard. It is simplified for
 * performance and small code size.
 * Copied from goog.i18n.bidi.rtlChars_.
 * @type {string}
 * @private
 */
soyshim.$$bidiRtlChars_ = '\u0591-\u07FF\u200F\uFB1D-\uFDFF\uFE70-\uFEFC';


/**
 * Regular expressions to check if a piece of text is of RTL directionality
 * on first character with strong directionality.
 * Based on goog.i18n.bidi.rtlDirCheckRe_.
 * @type {RegExp}
 * @private
 */
soyshim.$$bidiRtlDirCheckRe_ = new RegExp(
    '^[^' + soyshim.$$bidiLtrChars_ + ']*[' + soyshim.$$bidiRtlChars_ + ']');


/**
 * Regular expression to check for LTR characters.
 * Based on goog.i18n.bidi.ltrCharReg_.
 * @type {RegExp}
 * @private
 */
soyshim.$$bidiLtrCharRe_ = new RegExp('[' + soyshim.$$bidiLtrChars_ + ']');


/**
 * Regular expression to check if a string looks like something that must
 * always be LTR even in RTL text, e.g. a URL. When estimating the
 * directionality of text containing these, we treat these as weakly LTR,
 * like numbers.
 * Copied from goog.i18n.bidi.isRequiredLtrRe_.
 * @type {RegExp}
 * @private
 */
soyshim.$$bidiIsRequiredLtrRe_ = /^http:\/\/.*/;


/**
 * Regular expression to check if a string contains any numerals. Used to
 * differentiate between completely neutral strings and those containing
 * numbers, which are weakly LTR.
 * Copied from goog.i18n.bidi.hasNumeralsRe_.
 * @type {RegExp}
 * @private
 */
soyshim.$$bidiHasNumeralsRe_ = /\d/;


/**
 * Regular expression to split a string into "words" for directionality
 * estimation based on relative word counts.
 * Copied from goog.i18n.bidi.wordSeparatorRe_.
 * @type {RegExp}
 * @private
 */
soyshim.$$bidiWordSeparatorRe_ = /\s+/;


/**
 * This constant controls threshold of rtl directionality.
 * Copied from goog.i18n.bidi.rtlDetectionThreshold_.
 * @type {number}
 * @private
 */
soyshim.$$bidiRtlDetectionThreshold_ = 0.40;

/**
 * Regular expressions to check if the last strongly-directional character in a
 * piece of text is LTR.
 * Based on goog.i18n.bidi.ltrExitDirCheckRe_.
 * @type {RegExp}
 * @private
 */
soyshim.$$bidiLtrExitDirCheckRe_ = new RegExp(
    '[' + soyshim.$$bidiLtrChars_ + '][^' + soyshim.$$bidiRtlChars_ + ']*$');


/**
 * Regular expressions to check if the last strongly-directional character in a
 * piece of text is RTL.
 * Based on goog.i18n.bidi.rtlExitDirCheckRe_.
 * @type {RegExp}
 * @private
 */
soyshim.$$bidiRtlExitDirCheckRe_ = new RegExp(
    '[' + soyshim.$$bidiRtlChars_ + '][^' + soyshim.$$bidiLtrChars_ + ']*$');


/**
 * Check if the exit directionality a piece of text is LTR, i.e. if the last
 * strongly-directional character in the string is LTR.
 * Based on goog.i18n.bidi.endsWithLtr().
 * @param {string} str string being checked.
 * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.
 *     Default: false.
 * @return {boolean} Whether LTR exit directionality was detected.
 * @private
 */
soyshim.$$bidiIsLtrExitText_ = function(str, opt_isHtml) {
  str = soyshim.$$bidiStripHtmlIfNecessary_(str, opt_isHtml);
  return soyshim.$$bidiLtrExitDirCheckRe_.test(str);
};


/**
 * Check if the exit directionality a piece of text is RTL, i.e. if the last
 * strongly-directional character in the string is RTL.
 * Based on goog.i18n.bidi.endsWithRtl().
 * @param {string} str string being checked.
 * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.
 *     Default: false.
 * @return {boolean} Whether RTL exit directionality was detected.
 * @private
 */
soyshim.$$bidiIsRtlExitText_ = function(str, opt_isHtml) {
  str = soyshim.$$bidiStripHtmlIfNecessary_(str, opt_isHtml);
  return soyshim.$$bidiRtlExitDirCheckRe_.test(str);
};


// =============================================================================
// COPIED FROM soyutils_usegoog.js


// -----------------------------------------------------------------------------
// StringBuilder (compatible with the 'stringbuilder' code style).


/**
 * Utility class to facilitate much faster string concatenation in IE,
 * using Array.join() rather than the '+' operator. For other browsers
 * we simply use the '+' operator.
 *
 * @param {Object} var_args Initial items to append,
 *     e.g., new soy.StringBuilder('foo', 'bar').
 * @constructor
 */
soy.StringBuilder = goog.string.StringBuffer;


// -----------------------------------------------------------------------------
// soydata: Defines typed strings, e.g. an HTML string {@code "a<b>c"} is
// semantically distinct from the plain text string {@code "a<b>c"} and smart
// templates can take that distinction into account.

/**
 * A type of textual content.
 *
 * This is an enum of type Object so that these values are unforgeable.
 *
 * @enum {!Object}
 */
soydata.SanitizedContentKind = goog.soy.data.SanitizedContentKind;


/**
 * Checks whether a given value is of a given content kind.
 *
 * @param {*} value The value to be examined.
 * @param {soydata.SanitizedContentKind} contentKind The desired content
 *     kind.
 * @return {boolean} Whether the given value is of the given kind.
 * @private
 */
soydata.isContentKind = function(value, contentKind) {
  // TODO(user): This function should really include the assert on
  // value.constructor that is currently sprinkled at most of the call sites.
  // Unfortunately, that would require a (debug-mode-only) switch statement.
  // TODO(user): Perhaps we should get rid of the contentKind property
  // altogether and only at the constructor.
  return value != null && value.contentKind === contentKind;
};


/**
 * Returns a given value's contentDir property, constrained to a
 * goog.i18n.bidi.Dir value or null. Returns null if the value is null,
 * undefined, a primitive or does not have a contentDir property, or the
 * property's value is not 1 (for LTR), -1 (for RTL), or 0 (for neutral).
 *
 * @param {*} value The value whose contentDir property, if any, is to
 *     be returned.
 * @return {?goog.i18n.bidi.Dir} The contentDir property.
 */
soydata.getContentDir = function(value) {
  if (value != null) {
    switch (value.contentDir) {
      case goog.i18n.bidi.Dir.LTR:
        return goog.i18n.bidi.Dir.LTR;
      case goog.i18n.bidi.Dir.RTL:
        return goog.i18n.bidi.Dir.RTL;
      case goog.i18n.bidi.Dir.NEUTRAL:
        return goog.i18n.bidi.Dir.NEUTRAL;
    }
  }
  return null;
};


/**
 * Content of type {@link soydata.SanitizedContentKind.HTML}.
 *
 * The content is a string of HTML that can safely be embedded in a PCDATA
 * context in your app.  If you would be surprised to find that an HTML
 * sanitizer produced {@code s} (e.g.  it runs code or fetches bad URLs) and
 * you wouldn't write a template that produces {@code s} on security or privacy
 * grounds, then don't pass {@code s} here. The default content direction is
 * unknown, i.e. to be estimated when necessary.
 *
 * @constructor
 * @extends {goog.soy.data.SanitizedContent}
 */
soydata.SanitizedHtml = function() {
  goog.soy.data.SanitizedContent.call(this);  // Throws an exception.
};
goog.inherits(soydata.SanitizedHtml, goog.soy.data.SanitizedContent);

/** @override */
soydata.SanitizedHtml.prototype.contentKind = soydata.SanitizedContentKind.HTML;

/**
 * Returns a SanitizedHtml object for a particular value. The content direction
 * is preserved.
 *
 * This HTML-escapes the value unless it is already SanitizedHtml.
 *
 * @param {*} value The value to convert. If it is already a SanitizedHtml
 *     object, it is left alone.
 * @return {!soydata.SanitizedHtml} A SanitizedHtml object derived from the
 *     stringified value. It is escaped unless the input is SanitizedHtml.
 */
soydata.SanitizedHtml.from = function(value) {
  // The check is soydata.isContentKind() inlined for performance.
  if (value != null &&
      value.contentKind === soydata.SanitizedContentKind.HTML) {
    goog.asserts.assert(value.constructor === soydata.SanitizedHtml);
    return /** @type {!soydata.SanitizedHtml} */ (value);
  }
  return soydata.VERY_UNSAFE.ordainSanitizedHtml(
      soy.esc.$$escapeHtmlHelper(String(value)), soydata.getContentDir(value));
};


/**
 * Content of type {@link soydata.SanitizedContentKind.JS}.
 *
 * The content is Javascript source that when evaluated does not execute any
 * attacker-controlled scripts. The content direction is LTR.
 *
 * @constructor
 * @extends {goog.soy.data.SanitizedContent}
 */
soydata.SanitizedJs = function() {
  goog.soy.data.SanitizedContent.call(this);  // Throws an exception.
};
goog.inherits(soydata.SanitizedJs, goog.soy.data.SanitizedContent);

/** @override */
soydata.SanitizedJs.prototype.contentKind =
    soydata.SanitizedContentKind.JS;

/** @override */
soydata.SanitizedJs.prototype.contentDir = goog.i18n.bidi.Dir.LTR;


/**
 * Content of type {@link soydata.SanitizedContentKind.JS_STR_CHARS}.
 *
 * The content can be safely inserted as part of a single- or double-quoted
 * string without terminating the string. The default content direction is
 * unknown, i.e. to be estimated when necessary.
 *
 * @constructor
 * @extends {goog.soy.data.SanitizedContent}
 */
soydata.SanitizedJsStrChars = function() {
  goog.soy.data.SanitizedContent.call(this);  // Throws an exception.
};
goog.inherits(soydata.SanitizedJsStrChars, goog.soy.data.SanitizedContent);

/** @override */
soydata.SanitizedJsStrChars.prototype.contentKind =
    soydata.SanitizedContentKind.JS_STR_CHARS;

/**
 * Content of type {@link soydata.SanitizedContentKind.URI}.
 *
 * The content is a URI chunk that the caller knows is safe to emit in a
 * template. The content direction is LTR.
 *
 * @constructor
 * @extends {goog.soy.data.SanitizedContent}
 */
soydata.SanitizedUri = function() {
  goog.soy.data.SanitizedContent.call(this);  // Throws an exception.
};
goog.inherits(soydata.SanitizedUri, goog.soy.data.SanitizedContent);

/** @override */
soydata.SanitizedUri.prototype.contentKind = soydata.SanitizedContentKind.URI;

/** @override */
soydata.SanitizedUri.prototype.contentDir = goog.i18n.bidi.Dir.LTR;


/**
 * Content of type {@link soydata.SanitizedContentKind.ATTRIBUTES}.
 *
 * The content should be safely embeddable within an open tag, such as a
 * key="value" pair. The content direction is LTR.
 *
 * @constructor
 * @extends {goog.soy.data.SanitizedContent}
 */
soydata.SanitizedHtmlAttribute = function() {
  goog.soy.data.SanitizedContent.call(this);  // Throws an exception.
};
goog.inherits(soydata.SanitizedHtmlAttribute, goog.soy.data.SanitizedContent);

/** @override */
soydata.SanitizedHtmlAttribute.prototype.contentKind =
    soydata.SanitizedContentKind.ATTRIBUTES;

/** @override */
soydata.SanitizedHtmlAttribute.prototype.contentDir = goog.i18n.bidi.Dir.LTR;


/**
 * Content of type {@link soydata.SanitizedContentKind.CSS}.
 *
 * The content is non-attacker-exploitable CSS, such as {@code color:#c3d9ff}.
 * The content direction is LTR.
 *
 * @constructor
 * @extends {goog.soy.data.SanitizedContent}
 */
soydata.SanitizedCss = function() {
  goog.soy.data.SanitizedContent.call(this);  // Throws an exception.
};
goog.inherits(soydata.SanitizedCss, goog.soy.data.SanitizedContent);

/** @override */
soydata.SanitizedCss.prototype.contentKind =
    soydata.SanitizedContentKind.CSS;

/** @override */
soydata.SanitizedCss.prototype.contentDir = goog.i18n.bidi.Dir.LTR;


/**
 * Unsanitized plain text string.
 *
 * While all strings are effectively safe to use as a plain text, there are no
 * guarantees about safety in any other context such as HTML. This is
 * sometimes used to mark that should never be used unescaped.
 *
 * @param {*} content Plain text with no guarantees.
 * @param {?goog.i18n.bidi.Dir=} opt_contentDir The content direction; null if
 *     unknown and thus to be estimated when necessary. Default: null.
 * @constructor
 * @extends {goog.soy.data.SanitizedContent}
 */
soydata.UnsanitizedText = function(content, opt_contentDir) {
  /** @override */
  this.content = String(content);
  this.contentDir = opt_contentDir != null ? opt_contentDir : null;
};
goog.inherits(soydata.UnsanitizedText, goog.soy.data.SanitizedContent);

/** @override */
soydata.UnsanitizedText.prototype.contentKind =
    soydata.SanitizedContentKind.TEXT;


/**
 * Empty string, used as a type in Soy templates.
 * @enum {string}
 * @private
 */
soydata.$$EMPTY_STRING_ = {
  VALUE: ''
};


/**
 * Creates a factory for SanitizedContent types.
 *
 * This is a hack so that the soydata.VERY_UNSAFE.ordainSanitized* can
 * instantiate Sanitized* classes, without making the Sanitized* constructors
 * publicly usable. Requiring all construction to use the VERY_UNSAFE names
 * helps callers and their reviewers easily tell that creating SanitizedContent
 * is not always safe and calls for careful review.
 *
 * @param {function(new: T)} ctor A constructor.
 * @return {!function(*, ?goog.i18n.bidi.Dir=): T} A factory that takes
 *     content and an optional content direction and returns a new instance. If
 *     the content direction is undefined, ctor.prototype.contentDir is used.
 * @template T
 * @private
 */
soydata.$$makeSanitizedContentFactory_ = function(ctor) {
  /** @type {function(new: goog.soy.data.SanitizedContent)} */
  function InstantiableCtor() {}
  InstantiableCtor.prototype = ctor.prototype;
  /**
   * Creates a ctor-type SanitizedContent instance.
   *
   * @param {*} content The content to put in the instance.
   * @param {?goog.i18n.bidi.Dir=} opt_contentDir The content direction. If
   *     undefined, ctor.prototype.contentDir is used.
   * @return {goog.soy.data.SanitizedContent} The new instance. It is actually
   *     of type T above (ctor's type, a descendant of SanitizedContent), but
   *     there is no way to express that here.
   */
  function sanitizedContentFactory(content, opt_contentDir) {
    var result = new InstantiableCtor();
    result.content = String(content);
    if (opt_contentDir !== undefined) {
      result.contentDir = opt_contentDir;
    }
    return result;
  }
  return sanitizedContentFactory;
};


/**
 * Creates a factory for SanitizedContent types that should always have their
 * default directionality.
 *
 * This is a hack so that the soydata.VERY_UNSAFE.ordainSanitized* can
 * instantiate Sanitized* classes, without making the Sanitized* constructors
 * publicly usable. Requiring all construction to use the VERY_UNSAFE names
 * helps callers and their reviewers easily tell that creating SanitizedContent
 * is not always safe and calls for careful review.
 *
 * @param {function(new: T, string)} ctor A constructor.
 * @return {!function(*): T} A factory that takes content and returns a new
 *     instance (with default directionality, i.e. ctor.prototype.contentDir).
 * @template T
 * @private
 */
soydata.$$makeSanitizedContentFactoryWithDefaultDirOnly_ = function(ctor) {
  /** @type {function(new: goog.soy.data.SanitizedContent)} */
  function InstantiableCtor() {}
  InstantiableCtor.prototype = ctor.prototype;
  /**
   * Creates a ctor-type SanitizedContent instance.
   *
   * @param {*} content The content to put in the instance.
   * @return {goog.soy.data.SanitizedContent} The new instance. It is actually
   *     of type T above (ctor's type, a descendant of SanitizedContent), but
   *     there is no way to express that here.
   */
  function sanitizedContentFactory(content) {
    var result = new InstantiableCtor();
    result.content = String(content);
    return result;
  }
  return sanitizedContentFactory;
};


// -----------------------------------------------------------------------------
// Sanitized content ordainers. Please use these with extreme caution (with the
// exception of markUnsanitizedText). A good recommendation is to limit usage
// of these to just a handful of files in your source tree where usages can be
// carefully audited.


/**
 * Protects a string from being used in an noAutoescaped context.
 *
 * This is useful for content where there is significant risk of accidental
 * unescaped usage in a Soy template. A great case is for user-controlled
 * data that has historically been a source of vulernabilities.
 *
 * @param {*} content Text to protect.
 * @param {?goog.i18n.bidi.Dir=} opt_contentDir The content direction; null if
 *     unknown and thus to be estimated when necessary. Default: null.
 * @return {!soydata.UnsanitizedText} A wrapper that is rejected by the
 *     Soy noAutoescape print directive.
 */
soydata.markUnsanitizedText = function(content, opt_contentDir) {
  return new soydata.UnsanitizedText(content, opt_contentDir);
};


/**
 * Takes a leap of faith that the provided content is "safe" HTML.
 *
 * @param {*} content A string of HTML that can safely be embedded in
 *     a PCDATA context in your app. If you would be surprised to find that an
 *     HTML sanitizer produced {@code s} (e.g. it runs code or fetches bad URLs)
 *     and you wouldn't write a template that produces {@code s} on security or
 *     privacy grounds, then don't pass {@code s} here.
 * @param {?goog.i18n.bidi.Dir=} opt_contentDir The content direction; null if
 *     unknown and thus to be estimated when necessary. Default: null.
 * @return {!soydata.SanitizedHtml} Sanitized content wrapper that
 *     indicates to Soy not to escape when printed as HTML.
 */
soydata.VERY_UNSAFE.ordainSanitizedHtml =
    soydata.$$makeSanitizedContentFactory_(soydata.SanitizedHtml);


/**
 * Takes a leap of faith that the provided content is "safe" (non-attacker-
 * controlled, XSS-free) Javascript.
 *
 * @param {*} content Javascript source that when evaluated does not
 *     execute any attacker-controlled scripts.
 * @return {!soydata.SanitizedJs} Sanitized content wrapper that indicates to
 *     Soy not to escape when printed as Javascript source.
 */
soydata.VERY_UNSAFE.ordainSanitizedJs =
    soydata.$$makeSanitizedContentFactoryWithDefaultDirOnly_(
        soydata.SanitizedJs);


// TODO: This function is probably necessary, either externally or internally
// as an implementation detail. Generally, plain text will always work here,
// as there's no harm to unescaping the string and then re-escaping when
// finally printed.
/**
 * Takes a leap of faith that the provided content can be safely embedded in
 * a Javascript string without re-esacping.
 *
 * @param {*} content Content that can be safely inserted as part of a
 *     single- or double-quoted string without terminating the string.
 * @param {?goog.i18n.bidi.Dir=} opt_contentDir The content direction; null if
 *     unknown and thus to be estimated when necessary. Default: null.
 * @return {!soydata.SanitizedJsStrChars} Sanitized content wrapper that
 *     indicates to Soy not to escape when printed in a JS string.
 */
soydata.VERY_UNSAFE.ordainSanitizedJsStrChars =
    soydata.$$makeSanitizedContentFactory_(soydata.SanitizedJsStrChars);


/**
 * Takes a leap of faith that the provided content is "safe" to use as a URI
 * in a Soy template.
 *
 * This creates a Soy SanitizedContent object which indicates to Soy there is
 * no need to escape it when printed as a URI (e.g. in an href or src
 * attribute), such as if it's already been encoded or  if it's a Javascript:
 * URI.
 *
 * @param {*} content A chunk of URI that the caller knows is safe to
 *     emit in a template.
 * @return {!soydata.SanitizedUri} Sanitized content wrapper that indicates to
 *     Soy not to escape or filter when printed in URI context.
 */
soydata.VERY_UNSAFE.ordainSanitizedUri =
    soydata.$$makeSanitizedContentFactoryWithDefaultDirOnly_(
        soydata.SanitizedUri);


/**
 * Takes a leap of faith that the provided content is "safe" to use as an
 * HTML attribute.
 *
 * @param {*} content An attribute name and value, such as
 *     {@code dir="ltr"}.
 * @return {!soydata.SanitizedHtmlAttribute} Sanitized content wrapper that
 *     indicates to Soy not to escape when printed as an HTML attribute.
 */
soydata.VERY_UNSAFE.ordainSanitizedHtmlAttribute =
    soydata.$$makeSanitizedContentFactoryWithDefaultDirOnly_(
        soydata.SanitizedHtmlAttribute);


/**
 * Takes a leap of faith that the provided content is "safe" to use as CSS
 * in a style attribute or block.
 *
 * @param {*} content CSS, such as {@code color:#c3d9ff}.
 * @return {!soydata.SanitizedCss} Sanitized CSS wrapper that indicates to
 *     Soy there is no need to escape or filter when printed in CSS context.
 */
soydata.VERY_UNSAFE.ordainSanitizedCss =
    soydata.$$makeSanitizedContentFactoryWithDefaultDirOnly_(
        soydata.SanitizedCss);


// -----------------------------------------------------------------------------
// Public utilities.


/**
 * Helper function to render a Soy template and then set the output string as
 * the innerHTML of an element. It is recommended to use this helper function
 * instead of directly setting innerHTML in your hand-written code, so that it
 * will be easier to audit the code for cross-site scripting vulnerabilities.
 *
 * NOTE: New code should consider using goog.soy.renderElement instead.
 *
 * @param {Element} element The element whose content we are rendering.
 * @param {Function} template The Soy template defining the element's content.
 * @param {Object=} opt_templateData The data for the template.
 * @param {Object=} opt_injectedData The injected data for the template.
 */
soy.renderElement = goog.soy.renderElement;


/**
 * Helper function to render a Soy template into a single node or a document
 * fragment. If the rendered HTML string represents a single node, then that
 * node is returned (note that this is *not* a fragment, despite them name of
 * the method). Otherwise a document fragment is returned containing the
 * rendered nodes.
 *
 * NOTE: New code should consider using goog.soy.renderAsFragment
 * instead (note that the arguments are different).
 *
 * @param {Function} template The Soy template defining the element's content.
 * @param {Object=} opt_templateData The data for the template.
 * @param {Document=} opt_document The document used to create DOM nodes. If not
 *     specified, global document object is used.
 * @param {Object=} opt_injectedData The injected data for the template.
 * @return {!Node} The resulting node or document fragment.
 */
soy.renderAsFragment = function(
    template, opt_templateData, opt_document, opt_injectedData) {
  return goog.soy.renderAsFragment(
      template, opt_templateData, opt_injectedData,
      new goog.dom.DomHelper(opt_document));
};


/**
 * Helper function to render a Soy template into a single node. If the rendered
 * HTML string represents a single node, then that node is returned. Otherwise,
 * a DIV element is returned containing the rendered nodes.
 *
 * NOTE: New code should consider using goog.soy.renderAsElement
 * instead (note that the arguments are different).
 *
 * @param {Function} template The Soy template defining the element's content.
 * @param {Object=} opt_templateData The data for the template.
 * @param {Document=} opt_document The document used to create DOM nodes. If not
 *     specified, global document object is used.
 * @param {Object=} opt_injectedData The injected data for the template.
 * @return {!Element} Rendered template contents, wrapped in a parent DIV
 *     element if necessary.
 */
soy.renderAsElement = function(
    template, opt_templateData, opt_document, opt_injectedData) {
  return goog.soy.renderAsElement(
      template, opt_templateData, opt_injectedData,
      new goog.dom.DomHelper(opt_document));
};


// -----------------------------------------------------------------------------
// Below are private utilities to be used by Soy-generated code only.


/**
 * Whether the locale is right-to-left.
 *
 * @type {boolean}
 */
soy.$$IS_LOCALE_RTL = goog.i18n.bidi.IS_RTL;


/**
 * Builds an augmented map. The returned map will contain mappings from both
 * the base map and the additional map. If the same key appears in both, then
 * the value from the additional map will be visible, while the value from the
 * base map will be hidden. The base map will be used, but not modified.
 *
 * @param {!Object} baseMap The original map to augment.
 * @param {!Object} additionalMap A map containing the additional mappings.
 * @return {!Object} An augmented map containing both the original and
 *     additional mappings.
 */
soy.$$augmentMap = function(baseMap, additionalMap) {

  // Create a new map whose '__proto__' field is set to baseMap.
  /** @constructor */
  function TempCtor() {}
  TempCtor.prototype = baseMap;
  var augmentedMap = new TempCtor();

  // Add the additional mappings to the new map.
  for (var key in additionalMap) {
    augmentedMap[key] = additionalMap[key];
  }

  return augmentedMap;
};


/**
 * Checks that the given map key is a string.
 * @param {*} key Key to check.
 * @return {string} The given key.
 */
soy.$$checkMapKey = function(key) {
  // TODO: Support map literal with nonstring key.
  if ((typeof key) != 'string') {
    throw Error(
        'Map literal\'s key expression must evaluate to string' +
        ' (encountered type "' + (typeof key) + '").');
  }
  return key;
};


/**
 * Gets the keys in a map as an array. There are no guarantees on the order.
 * @param {Object} map The map to get the keys of.
 * @return {Array.<string>} The array of keys in the given map.
 */
soy.$$getMapKeys = function(map) {
  var mapKeys = [];
  for (var key in map) {
    mapKeys.push(key);
  }
  return mapKeys;
};


/**
 * Gets a consistent unique id for the given delegate template name. Two calls
 * to this function will return the same id if and only if the input names are
 * the same.
 *
 * <p> Important: This function must always be called with a string constant.
 *
 * <p> If Closure Compiler is not being used, then this is just this identity
 * function. If Closure Compiler is being used, then each call to this function
 * will be replaced with a short string constant, which will be consistent per
 * input name.
 *
 * @param {string} delTemplateName The delegate template name for which to get a
 *     consistent unique id.
 * @return {string} A unique id that is consistent per input name.
 *
 * @consistentIdGenerator
 */
soy.$$getDelTemplateId = function(delTemplateName) {
  return delTemplateName;
};


/**
 * Map from registered delegate template key to the priority of the
 * implementation.
 * @type {Object}
 * @private
 */
soy.$$DELEGATE_REGISTRY_PRIORITIES_ = {};

/**
 * Map from registered delegate template key to the implementation function.
 * @type {Object}
 * @private
 */
soy.$$DELEGATE_REGISTRY_FUNCTIONS_ = {};


/**
 * Registers a delegate implementation. If the same delegate template key (id
 * and variant) has been registered previously, then priority values are
 * compared and only the higher priority implementation is stored (if
 * priorities are equal, an error is thrown).
 *
 * @param {string} delTemplateId The delegate template id.
 * @param {string} delTemplateVariant The delegate template variant (can be
 *     empty string).
 * @param {number} delPriority The implementation's priority value.
 * @param {Function} delFn The implementation function.
 */
soy.$$registerDelegateFn = function(
    delTemplateId, delTemplateVariant, delPriority, delFn) {

  var mapKey = 'key_' + delTemplateId + ':' + delTemplateVariant;
  var currPriority = soy.$$DELEGATE_REGISTRY_PRIORITIES_[mapKey];
  if (currPriority === undefined || delPriority > currPriority) {
    // Registering new or higher-priority function: replace registry entry.
    soy.$$DELEGATE_REGISTRY_PRIORITIES_[mapKey] = delPriority;
    soy.$$DELEGATE_REGISTRY_FUNCTIONS_[mapKey] = delFn;
  } else if (delPriority == currPriority) {
    // Registering same-priority function: error.
    throw Error(
        'Encountered two active delegates with the same priority ("' +
            delTemplateId + ':' + delTemplateVariant + '").');
  } else {
    // Registering lower-priority function: do nothing.
  }
};


/**
 * Retrieves the (highest-priority) implementation that has been registered for
 * a given delegate template key (id and variant). If no implementation has
 * been registered for the key, then the fallback is the same id with empty
 * variant. If the fallback is also not registered, and allowsEmptyDefault is
 * true, then returns an implementation that is equivalent to an empty template
 * (i.e. rendered output would be empty string).
 *
 * @param {string} delTemplateId The delegate template id.
 * @param {string|number} delTemplateVariant The delegate template variant (can
 *     be an empty string, or a number when a global is used).
 * @param {boolean} allowsEmptyDefault Whether to default to the empty template
 *     function if there's no active implementation.
 * @return {Function} The retrieved implementation function.
 */
soy.$$getDelegateFn = function(
    delTemplateId, delTemplateVariant, allowsEmptyDefault) {

  var delFn = soy.$$DELEGATE_REGISTRY_FUNCTIONS_[
      'key_' + delTemplateId + ':' + delTemplateVariant];
  if (! delFn && delTemplateVariant != '') {
    // Fallback to empty variant.
    delFn = soy.$$DELEGATE_REGISTRY_FUNCTIONS_['key_' + delTemplateId + ':'];
  }

  if (delFn) {
    return delFn;
  } else if (allowsEmptyDefault) {
    return soy.$$EMPTY_TEMPLATE_FN_;
  } else {
    throw Error(
        'Found no active impl for delegate call to "' + delTemplateId + ':' +
            delTemplateVariant + '" (and not allowemptydefault="true").');
  }
};


/**
 * Private helper soy.$$getDelegateFn(). This is the empty template function
 * that is returned whenever there's no delegate implementation found.
 *
 * @param {Object.<string, *>=} opt_data
 * @param {soy.StringBuilder=} opt_sb
 * @param {Object.<string, *>=} opt_ijData
 * @return {string}
 * @private
 */
soy.$$EMPTY_TEMPLATE_FN_ = function(opt_data, opt_sb, opt_ijData) {
  return '';
};


// -----------------------------------------------------------------------------
// Internal sanitized content wrappers.


/**
 * Creates a SanitizedContent factory for SanitizedContent types for internal
 * Soy let and param blocks.
 *
 * This is a hack within Soy so that SanitizedContent objects created via let
 * and param blocks will truth-test as false if they are empty string.
 * Tricking the Javascript runtime to treat empty SanitizedContent as falsey is
 * not possible, and changing the Soy compiler to wrap every boolean statement
 * for just this purpose is impractical.  Instead, we just avoid wrapping empty
 * string as SanitizedContent, since it's a no-op for empty strings anyways.
 *
 * @param {function(new: T)} ctor A constructor.
 * @return {!function(*, ?goog.i18n.bidi.Dir=): (T|soydata.$$EMPTY_STRING_)}
 *     A factory that takes content and an optional content direction and
 *     returns a new instance, or an empty string. If the content direction is
 *     undefined, ctor.prototype.contentDir is used.
 * @template T
 * @private
 */
soydata.$$makeSanitizedContentFactoryForInternalBlocks_ = function(ctor) {
  /** @type {function(new: goog.soy.data.SanitizedContent)} */
  function InstantiableCtor() {}
  InstantiableCtor.prototype = ctor.prototype;
  /**
   * Creates a ctor-type SanitizedContent instance.
   *
   * @param {*} content The content to put in the instance.
   * @param {?goog.i18n.bidi.Dir=} opt_contentDir The content direction. If
   *     undefined, ctor.prototype.contentDir is used.
   * @return {goog.soy.data.SanitizedContent|soydata.$$EMPTY_STRING_} The new
   *     instance, or an empty string. A new instance is actually of type T
   *     above (ctor's type, a descendant of SanitizedContent), but there's no
   *     way to express that here.
   */
  function sanitizedContentFactory(content, opt_contentDir) {
    var contentString = String(content);
    if (!contentString) {
      return soydata.$$EMPTY_STRING_.VALUE;
    }
    var result = new InstantiableCtor();
    result.content = String(content);
    if (opt_contentDir !== undefined) {
      result.contentDir = opt_contentDir;
    }
    return result;
  }
  return sanitizedContentFactory;
};


/**
 * Creates a SanitizedContent factory for SanitizedContent types that should
 * always have their default directionality for internal Soy let and param
 * blocks.
 *
 * This is a hack within Soy so that SanitizedContent objects created via let
 * and param blocks will truth-test as false if they are empty string.
 * Tricking the Javascript runtime to treat empty SanitizedContent as falsey is
 * not possible, and changing the Soy compiler to wrap every boolean statement
 * for just this purpose is impractical.  Instead, we just avoid wrapping empty
 * string as SanitizedContent, since it's a no-op for empty strings anyways.
 *
 * @param {function(new: T)} ctor A constructor.
 * @return {!function(*): (T|soydata.$$EMPTY_STRING_)} A
 *     factory that takes content and returns a
 *     new instance (with default directionality, i.e.
 *     ctor.prototype.contentDir), or an empty string.
 * @template T
 * @private
 */
soydata.$$makeSanitizedContentFactoryWithDefaultDirOnlyForInternalBlocks_ =
    function(ctor) {
  /** @type {function(new: goog.soy.data.SanitizedContent)} */
  function InstantiableCtor() {}
  InstantiableCtor.prototype = ctor.prototype;
  /**
   * Creates a ctor-type SanitizedContent instance.
   *
   * @param {*} content The content to put in the instance.
   * @return {goog.soy.data.SanitizedContent|soydata.$$EMPTY_STRING_} The new
   *     instance, or an empty string. A new instance is actually of type T
   *     above (ctor's type, a descendant of SanitizedContent), but there's no
   *     way to express that here.
   */
  function sanitizedContentFactory(content) {
    var contentString = String(content);
    if (!contentString) {
      return soydata.$$EMPTY_STRING_.VALUE;
    }
    var result = new InstantiableCtor();
    result.content = String(content);
    return result;
  }
  return sanitizedContentFactory;
};


/**
 * Creates kind="text" block contents (internal use only).
 *
 * @param {*} content Text.
 * @param {?goog.i18n.bidi.Dir=} opt_contentDir The content direction; null if
 *     unknown and thus to be estimated when necessary. Default: null.
 * @return {!soydata.UnsanitizedText|soydata.$$EMPTY_STRING_} Wrapped result.
 */
soydata.$$markUnsanitizedTextForInternalBlocks = function(
    content, opt_contentDir) {
  var contentString = String(content);
  if (!contentString) {
    return soydata.$$EMPTY_STRING_.VALUE;
  }
  return new soydata.UnsanitizedText(contentString, opt_contentDir);
};


/**
 * Creates kind="html" block contents (internal use only).
 *
 * @param {*} content Text.
 * @param {?goog.i18n.bidi.Dir=} opt_contentDir The content direction; null if
 *     unknown and thus to be estimated when necessary. Default: null.
 * @return {soydata.SanitizedHtml|soydata.$$EMPTY_STRING_} Wrapped result.
 */
soydata.VERY_UNSAFE.$$ordainSanitizedHtmlForInternalBlocks =
    soydata.$$makeSanitizedContentFactoryForInternalBlocks_(
        soydata.SanitizedHtml);


/**
 * Creates kind="js" block contents (internal use only).
 *
 * @param {*} content Text.
 * @return {soydata.SanitizedJs|soydata.$$EMPTY_STRING_} Wrapped result.
 */
soydata.VERY_UNSAFE.$$ordainSanitizedJsForInternalBlocks =
    soydata.$$makeSanitizedContentFactoryWithDefaultDirOnlyForInternalBlocks_(
        soydata.SanitizedJs);


/**
 * Creates kind="uri" block contents (internal use only).
 *
 * @param {*} content Text.
 * @return {soydata.SanitizedUri|soydata.$$EMPTY_STRING_} Wrapped result.
 */
soydata.VERY_UNSAFE.$$ordainSanitizedUriForInternalBlocks =
    soydata.$$makeSanitizedContentFactoryWithDefaultDirOnlyForInternalBlocks_(
        soydata.SanitizedUri);


/**
 * Creates kind="attributes" block contents (internal use only).
 *
 * @param {*} content Text.
 * @return {soydata.SanitizedHtmlAttribute|soydata.$$EMPTY_STRING_} Wrapped
 *     result.
 */
soydata.VERY_UNSAFE.$$ordainSanitizedAttributesForInternalBlocks =
    soydata.$$makeSanitizedContentFactoryWithDefaultDirOnlyForInternalBlocks_(
        soydata.SanitizedHtmlAttribute);


/**
 * Creates kind="css" block contents (internal use only).
 *
 * @param {*} content Text.
 * @return {soydata.SanitizedCss|soydata.$$EMPTY_STRING_} Wrapped result.
 */
soydata.VERY_UNSAFE.$$ordainSanitizedCssForInternalBlocks =
    soydata.$$makeSanitizedContentFactoryWithDefaultDirOnlyForInternalBlocks_(
        soydata.SanitizedCss);


// -----------------------------------------------------------------------------
// Escape/filter/normalize.


/**
 * Returns a SanitizedHtml object for a particular value. The content direction
 * is preserved.
 *
 * This HTML-escapes the value unless it is already SanitizedHtml. Escapes
 * double quote '"' in addition to '&', '<', and '>' so that a string can be
 * included in an HTML tag attribute value within double quotes.
 *
 * @param {*} value The value to convert. If it is already a SanitizedHtml
 *     object, it is left alone.
 * @return {!soydata.SanitizedHtml} An escaped version of value.
 */
soy.$$escapeHtml = function(value) {
  return soydata.SanitizedHtml.from(value);
};


/**
 * Strips unsafe tags to convert a string of untrusted HTML into HTML that
 * is safe to embed. The content direction is preserved.
 *
 * @param {*} value The string-like value to be escaped. May not be a string,
 *     but the value will be coerced to a string.
 * @return {!soydata.SanitizedHtml} A sanitized and normalized version of value.
 */
soy.$$cleanHtml = function(value) {
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.HTML)) {
    goog.asserts.assert(value.constructor === soydata.SanitizedHtml);
    return /** @type {!soydata.SanitizedHtml} */ (value);
  }
  return soydata.VERY_UNSAFE.ordainSanitizedHtml(
      soy.$$stripHtmlTags(value, soy.esc.$$SAFE_TAG_WHITELIST_),
      soydata.getContentDir(value));
};


/**
 * Escapes HTML special characters in a string so that it can be embedded in
 * RCDATA.
 * <p>
 * Escapes HTML special characters so that the value will not prematurely end
 * the body of a tag like {@code <textarea>} or {@code <title>}. RCDATA tags
 * cannot contain other HTML entities, so it is not strictly necessary to escape
 * HTML special characters except when part of that text looks like an HTML
 * entity or like a close tag : {@code </textarea>}.
 * <p>
 * Will normalize known safe HTML to make sure that sanitized HTML (which could
 * contain an innocuous {@code </textarea>} don't prematurely end an RCDATA
 * element.
 *
 * @param {*} value The string-like value to be escaped. May not be a string,
 *     but the value will be coerced to a string.
 * @return {string} An escaped version of value.
 */
soy.$$escapeHtmlRcdata = function(value) {
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.HTML)) {
    goog.asserts.assert(value.constructor === soydata.SanitizedHtml);
    return soy.esc.$$normalizeHtmlHelper(value.content);
  }
  return soy.esc.$$escapeHtmlHelper(value);
};


/**
 * Matches any/only HTML5 void elements' start tags.
 * See http://www.w3.org/TR/html-markup/syntax.html#syntax-elements
 * @type {RegExp}
 * @private
 */
soy.$$HTML5_VOID_ELEMENTS_ = new RegExp(
    '^<(?:area|base|br|col|command|embed|hr|img|input' +
    '|keygen|link|meta|param|source|track|wbr)\\b');


/**
 * Removes HTML tags from a string of known safe HTML.
 * If opt_tagWhitelist is not specified or is empty, then
 * the result can be used as an attribute value.
 *
 * @param {*} value The HTML to be escaped. May not be a string, but the
 *     value will be coerced to a string.
 * @param {Object.<string, number>=} opt_tagWhitelist Has an own property whose
 *     name is a lower-case tag name and whose value is {@code 1} for
 *     each element that is allowed in the output.
 * @return {string} A representation of value without disallowed tags,
 *     HTML comments, or other non-text content.
 */
soy.$$stripHtmlTags = function(value, opt_tagWhitelist) {
  if (!opt_tagWhitelist) {
    // If we have no white-list, then use a fast track which elides all tags.
    return String(value).replace(soy.esc.$$HTML_TAG_REGEX_, '')
        // This is just paranoia since callers should normalize the result
        // anyway, but if they didn't, it would be necessary to ensure that
        // after the first replace non-tag uses of < do not recombine into
        // tags as in "<<foo>script>alert(1337)</<foo>script>".
        .replace(soy.esc.$$LT_REGEX_, '&lt;');
  }

  // Escapes '[' so that we can use [123] below to mark places where tags
  // have been removed.
  var html = String(value).replace(/\[/g, '&#91;');

  // Consider all uses of '<' and replace whitelisted tags with markers like
  // [1] which are indices into a list of approved tag names.
  // Replace all other uses of < and > with entities.
  var tags = [];
  html = html.replace(
    soy.esc.$$HTML_TAG_REGEX_,
    function(tok, tagName) {
      if (tagName) {
        tagName = tagName.toLowerCase();
        if (opt_tagWhitelist.hasOwnProperty(tagName) &&
            opt_tagWhitelist[tagName]) {
          var start = tok.charAt(1) === '/' ? '</' : '<';
          var index = tags.length;
          tags[index] = start + tagName + '>';
          return '[' + index + ']';
        }
      }
      return '';
    });

  // Escape HTML special characters. Now there are no '<' in html that could
  // start a tag.
  html = soy.esc.$$normalizeHtmlHelper(html);

  var finalCloseTags = soy.$$balanceTags_(tags);

  // Now html contains no tags or less-than characters that could become
  // part of a tag via a replacement operation and tags only contains
  // approved tags.
  // Reinsert the white-listed tags.
  html = html.replace(
       /\[(\d+)\]/g, function(_, index) { return tags[index]; });

  // Close any still open tags.
  // This prevents unclosed formatting elements like <ol> and <table> from
  // breaking the layout of containing HTML.
  return html + finalCloseTags;
};


/**
 * Throw out any close tags that don't correspond to start tags.
 * If {@code <table>} is used for formatting, embedded HTML shouldn't be able
 * to use a mismatched {@code </table>} to break page layout.
 *
 * @param {Array.<string>} tags an array of tags that will be modified in place
 *    include tags, the empty string, or concatenations of empty tags.
 * @return {string} zero or more closed tags that close all elements that are
 *    opened in tags but not closed.
 * @private
 */
soy.$$balanceTags_ = function(tags) {
  var open = [];
  for (var i = 0, n = tags.length; i < n; ++i) {
    var tag = tags[i];
    if (tag.charAt(1) === '/') {
      var openTagIndex = open.length - 1;
      // NOTE: This is essentially lastIndexOf, but it's not supported in IE.
      while (openTagIndex >= 0 && open[openTagIndex] != tag) {
        openTagIndex--;
      }
      if (openTagIndex < 0) {
        tags[i] = '';  // Drop close tag.
      } else {
        tags[i] = open.slice(openTagIndex).reverse().join('');
        open.length = openTagIndex;
      }
    } else if (!soy.$$HTML5_VOID_ELEMENTS_.test(tag)) {
      open.push('</' + tag.substring(1));
    }
  }
  return open.reverse().join('');
};


/**
 * Escapes HTML special characters in an HTML attribute value.
 *
 * @param {*} value The HTML to be escaped. May not be a string, but the
 *     value will be coerced to a string.
 * @return {string} An escaped version of value.
 */
soy.$$escapeHtmlAttribute = function(value) {
  // NOTE: We don't accept ATTRIBUTES here because ATTRIBUTES is actually not
  // the attribute value context, but instead k/v pairs.
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.HTML)) {
    // NOTE: After removing tags, we also escape quotes ("normalize") so that
    // the HTML can be embedded in attribute context.
    goog.asserts.assert(value.constructor === soydata.SanitizedHtml);
    return soy.esc.$$normalizeHtmlHelper(soy.$$stripHtmlTags(value.content));
  }
  return soy.esc.$$escapeHtmlHelper(value);
};


/**
 * Escapes HTML special characters in a string including space and other
 * characters that can end an unquoted HTML attribute value.
 *
 * @param {*} value The HTML to be escaped. May not be a string, but the
 *     value will be coerced to a string.
 * @return {string} An escaped version of value.
 */
soy.$$escapeHtmlAttributeNospace = function(value) {
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.HTML)) {
    goog.asserts.assert(value.constructor === soydata.SanitizedHtml);
    return soy.esc.$$normalizeHtmlNospaceHelper(
        soy.$$stripHtmlTags(value.content));
  }
  return soy.esc.$$escapeHtmlNospaceHelper(value);
};


/**
 * Filters out strings that cannot be a substring of a valid HTML attribute.
 *
 * Note the input is expected to be key=value pairs.
 *
 * @param {*} value The value to escape. May not be a string, but the value
 *     will be coerced to a string.
 * @return {string} A valid HTML attribute name part or name/value pair.
 *     {@code "zSoyz"} if the input is invalid.
 */
soy.$$filterHtmlAttributes = function(value) {
  // NOTE: Explicitly no support for SanitizedContentKind.HTML, since that is
  // meaningless in this context, which is generally *between* html attributes.
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.ATTRIBUTES)) {
    goog.asserts.assert(value.constructor === soydata.SanitizedHtmlAttribute);
    // Add a space at the end to ensure this won't get merged into following
    // attributes, unless the interpretation is unambiguous (ending with quotes
    // or a space).
    return value.content.replace(/([^"'\s])$/, '$1 ');
  }
  // TODO: Dynamically inserting attributes that aren't marked as trusted is
  // probably unnecessary.  Any filtering done here will either be inadequate
  // for security or not flexible enough.  Having clients use kind="attributes"
  // in parameters seems like a wiser idea.
  return soy.esc.$$filterHtmlAttributesHelper(value);
};


/**
 * Filters out strings that cannot be a substring of a valid HTML element name.
 *
 * @param {*} value The value to escape. May not be a string, but the value
 *     will be coerced to a string.
 * @return {string} A valid HTML element name part.
 *     {@code "zSoyz"} if the input is invalid.
 */
soy.$$filterHtmlElementName = function(value) {
  // NOTE: We don't accept any SanitizedContent here. HTML indicates valid
  // PCDATA, not tag names. A sloppy developer shouldn't be able to cause an
  // exploit:
  // ... {let userInput}script src=http://evil.com/evil.js{/let} ...
  // ... {param tagName kind="html"}{$userInput}{/param} ...
  // ... <{$tagName}>Hello World</{$tagName}>
  return soy.esc.$$filterHtmlElementNameHelper(value);
};


/**
 * Escapes characters in the value to make it valid content for a JS string
 * literal.
 *
 * @param {*} value The value to escape. May not be a string, but the value
 *     will be coerced to a string.
 * @return {string} An escaped version of value.
 * @deprecated
 */
soy.$$escapeJs = function(value) {
  return soy.$$escapeJsString(value);
};


/**
 * Escapes characters in the value to make it valid content for a JS string
 * literal.
 *
 * @param {*} value The value to escape. May not be a string, but the value
 *     will be coerced to a string.
 * @return {string} An escaped version of value.
 */
soy.$$escapeJsString = function(value) {
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.JS_STR_CHARS)) {
    // TODO: It might still be worthwhile to normalize it to remove
    // unescaped quotes, null, etc: replace(/(?:^|[^\])['"]/g, '\\$
    goog.asserts.assert(value.constructor === soydata.SanitizedJsStrChars);
    return value.content;
  }
  return soy.esc.$$escapeJsStringHelper(value);
};


/**
 * Encodes a value as a JavaScript literal.
 *
 * @param {*} value The value to escape. May not be a string, but the value
 *     will be coerced to a string.
 * @return {string} A JavaScript code representation of the input.
 */
soy.$$escapeJsValue = function(value) {
  // We surround values with spaces so that they can't be interpolated into
  // identifiers by accident.
  // We could use parentheses but those might be interpreted as a function call.
  if (value == null) {  // Intentionally matches undefined.
    // Java returns null from maps where there is no corresponding key while
    // JS returns undefined.
    // We always output null for compatibility with Java which does not have a
    // distinct undefined value.
    return ' null ';
  }
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.JS)) {
    goog.asserts.assert(value.constructor === soydata.SanitizedJs);
    return value.content;
  }
  switch (typeof value) {
    case 'boolean': case 'number':
      return ' ' + value + ' ';
    default:
      return "'" + soy.esc.$$escapeJsStringHelper(String(value)) + "'";
  }
};


/**
 * Escapes characters in the string to make it valid content for a JS regular
 * expression literal.
 *
 * @param {*} value The value to escape. May not be a string, but the value
 *     will be coerced to a string.
 * @return {string} An escaped version of value.
 */
soy.$$escapeJsRegex = function(value) {
  return soy.esc.$$escapeJsRegexHelper(value);
};


/**
 * Matches all URI mark characters that conflict with HTML attribute delimiters
 * or that cannot appear in a CSS uri.
 * From <a href="http://www.w3.org/TR/CSS2/grammar.html">G.2: CSS grammar</a>
 * <pre>
 *     url        ([!#$%&*-~]|{nonascii}|{escape})*
 * </pre>
 *
 * @type {RegExp}
 * @private
 */
soy.$$problematicUriMarks_ = /['()]/g;

/**
 * @param {string} ch A single character in {@link soy.$$problematicUriMarks_}.
 * @return {string}
 * @private
 */
soy.$$pctEncode_ = function(ch) {
  return '%' + ch.charCodeAt(0).toString(16);
};

/**
 * Escapes a string so that it can be safely included in a URI.
 *
 * @param {*} value The value to escape. May not be a string, but the value
 *     will be coerced to a string.
 * @return {string} An escaped version of value.
 */
soy.$$escapeUri = function(value) {
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.URI)) {
    goog.asserts.assert(value.constructor === soydata.SanitizedUri);
    return soy.$$normalizeUri(value);
  }
  // Apostophes and parentheses are not matched by encodeURIComponent.
  // They are technically special in URIs, but only appear in the obsolete mark
  // production in Appendix D.2 of RFC 3986, so can be encoded without changing
  // semantics.
  var encoded = soy.esc.$$escapeUriHelper(value);
  soy.$$problematicUriMarks_.lastIndex = 0;
  if (soy.$$problematicUriMarks_.test(encoded)) {
    return encoded.replace(soy.$$problematicUriMarks_, soy.$$pctEncode_);
  }
  return encoded;
};


/**
 * Removes rough edges from a URI by escaping any raw HTML/JS string delimiters.
 *
 * @param {*} value The value to escape. May not be a string, but the value
 *     will be coerced to a string.
 * @return {string} An escaped version of value.
 */
soy.$$normalizeUri = function(value) {
  return soy.esc.$$normalizeUriHelper(value);
};


/**
 * Vets a URI's protocol and removes rough edges from a URI by escaping
 * any raw HTML/JS string delimiters.
 *
 * @param {*} value The value to escape. May not be a string, but the value
 *     will be coerced to a string.
 * @return {string} An escaped version of value.
 */
soy.$$filterNormalizeUri = function(value) {
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.URI)) {
    goog.asserts.assert(value.constructor === soydata.SanitizedUri);
    return soy.$$normalizeUri(value);
  }
  return soy.esc.$$filterNormalizeUriHelper(value);
};


/**
 * Allows only data-protocol image URI's.
 *
 * @param {*} value The value to process. May not be a string, but the value
 *     will be coerced to a string.
 * @return {!soydata.SanitizedUri} An escaped version of value.
 */
soy.$$filterImageDataUri = function(value) {
  // NOTE: Even if it's a SanitizedUri, we will still filter it.
  return soydata.VERY_UNSAFE.ordainSanitizedUri(
      soy.esc.$$filterImageDataUriHelper(value));
};


/**
 * Escapes a string so it can safely be included inside a quoted CSS string.
 *
 * @param {*} value The value to escape. May not be a string, but the value
 *     will be coerced to a string.
 * @return {string} An escaped version of value.
 */
soy.$$escapeCssString = function(value) {
  return soy.esc.$$escapeCssStringHelper(value);
};


/**
 * Encodes a value as a CSS identifier part, keyword, or quantity.
 *
 * @param {*} value The value to escape. May not be a string, but the value
 *     will be coerced to a string.
 * @return {string} A safe CSS identifier part, keyword, or quanitity.
 */
soy.$$filterCssValue = function(value) {
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.CSS)) {
    goog.asserts.assert(value.constructor === soydata.SanitizedCss);
    return value.content;
  }
  // Uses == to intentionally match null and undefined for Java compatibility.
  if (value == null) {
    return '';
  }
  return soy.esc.$$filterCssValueHelper(value);
};


/**
 * Sanity-checks noAutoescape input for explicitly tainted content.
 *
 * SanitizedContentKind.TEXT is used to explicitly mark input that was never
 * meant to be used unescaped.
 *
 * @param {*} value The value to filter.
 * @return {*} The value, that we dearly hope will not cause an attack.
 */
soy.$$filterNoAutoescape = function(value) {
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.TEXT)) {
    // Fail in development mode.
    goog.asserts.fail(
        'Tainted SanitizedContentKind.TEXT for |noAutoescape: `%s`',
        [value.content]);
    // Return innocuous data in production.
    return 'zSoyz';
  }

  return value;
};


// -----------------------------------------------------------------------------
// Basic directives/functions.


/**
 * Converts \r\n, \r, and \n to <br>s
 * @param {*} value The string in which to convert newlines.
 * @return {string|!soydata.SanitizedHtml} A copy of {@code value} with
 *     converted newlines. If {@code value} is SanitizedHtml, the return value
 *     is also SanitizedHtml, of the same known directionality.
 */
soy.$$changeNewlineToBr = function(value) {
  var result = goog.string.newLineToBr(String(value), false);
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.HTML)) {
    return soydata.VERY_UNSAFE.ordainSanitizedHtml(
        result, soydata.getContentDir(value));
  }
  return result;
};


/**
 * Inserts word breaks ('wbr' tags) into a HTML string at a given interval. The
 * counter is reset if a space is encountered. Word breaks aren't inserted into
 * HTML tags or entities. Entites count towards the character count; HTML tags
 * do not.
 *
 * @param {*} value The HTML string to insert word breaks into. Can be other
 *     types, but the value will be coerced to a string.
 * @param {number} maxCharsBetweenWordBreaks Maximum number of non-space
 *     characters to allow before adding a word break.
 * @return {string|!soydata.SanitizedHtml} The string including word
 *     breaks. If {@code value} is SanitizedHtml, the return value
 *     is also SanitizedHtml, of the same known directionality.
 */
soy.$$insertWordBreaks = function(value, maxCharsBetweenWordBreaks) {
  var result = goog.format.insertWordBreaks(
      String(value), maxCharsBetweenWordBreaks);
  if (soydata.isContentKind(value, soydata.SanitizedContentKind.HTML)) {
    return soydata.VERY_UNSAFE.ordainSanitizedHtml(
        result, soydata.getContentDir(value));
  }
  return result;
};


/**
 * Truncates a string to a given max length (if it's currently longer),
 * optionally adding ellipsis at the end.
 *
 * @param {*} str The string to truncate. Can be other types, but the value will
 *     be coerced to a string.
 * @param {number} maxLen The maximum length of the string after truncation
 *     (including ellipsis, if applicable).
 * @param {boolean} doAddEllipsis Whether to add ellipsis if the string needs
 *     truncation.
 * @return {string} The string after truncation.
 */
soy.$$truncate = function(str, maxLen, doAddEllipsis) {

  str = String(str);
  if (str.length <= maxLen) {
    return str;  // no need to truncate
  }

  // If doAddEllipsis, either reduce maxLen to compensate, or else if maxLen is
  // too small, just turn off doAddEllipsis.
  if (doAddEllipsis) {
    if (maxLen > 3) {
      maxLen -= 3;
    } else {
      doAddEllipsis = false;
    }
  }

  // Make sure truncating at maxLen doesn't cut up a unicode surrogate pair.
  if (soy.$$isHighSurrogate_(str.charAt(maxLen - 1)) &&
      soy.$$isLowSurrogate_(str.charAt(maxLen))) {
    maxLen -= 1;
  }

  // Truncate.
  str = str.substring(0, maxLen);

  // Add ellipsis.
  if (doAddEllipsis) {
    str += '...';
  }

  return str;
};

/**
 * Private helper for $$truncate() to check whether a char is a high surrogate.
 * @param {string} ch The char to check.
 * @return {boolean} Whether the given char is a unicode high surrogate.
 * @private
 */
soy.$$isHighSurrogate_ = function(ch) {
  return 0xD800 <= ch && ch <= 0xDBFF;
};

/**
 * Private helper for $$truncate() to check whether a char is a low surrogate.
 * @param {string} ch The char to check.
 * @return {boolean} Whether the given char is a unicode low surrogate.
 * @private
 */
soy.$$isLowSurrogate_ = function(ch) {
  return 0xDC00 <= ch && ch <= 0xDFFF;
};


// -----------------------------------------------------------------------------
// Bidi directives/functions.


/**
 * Cache of bidi formatter by context directionality, so we don't keep on
 * creating new objects.
 * @type {!Object.<!goog.i18n.BidiFormatter>}
 * @private
 */
soy.$$bidiFormatterCache_ = {};


/**
 * Returns cached bidi formatter for bidiGlobalDir, or creates a new one.
 * @param {number} bidiGlobalDir The global directionality context: 1 if ltr, -1
 *     if rtl, 0 if unknown.
 * @return {goog.i18n.BidiFormatter} A formatter for bidiGlobalDir.
 * @private
 */
soy.$$getBidiFormatterInstance_ = function(bidiGlobalDir) {
  return soy.$$bidiFormatterCache_[bidiGlobalDir] ||
         (soy.$$bidiFormatterCache_[bidiGlobalDir] =
             new goog.i18n.BidiFormatter(bidiGlobalDir));
};


/**
 * Estimate the overall directionality of text. If opt_isHtml, makes sure to
 * ignore the LTR nature of the mark-up and escapes in text, making the logic
 * suitable for HTML and HTML-escaped text.
 * If text has a goog.i18n.bidi.Dir-valued contentDir, this is used instead of
 * estimating the directionality.
 *
 * @param {*} text The content whose directionality is to be estimated.
 * @param {boolean=} opt_isHtml Whether text is HTML/HTML-escaped.
 *     Default: false.
 * @return {number} 1 if text is LTR, -1 if it is RTL, and 0 if it is neutral.
 */
soy.$$bidiTextDir = function(text, opt_isHtml) {
  var contentDir = soydata.getContentDir(text);
  if (contentDir != null) {
    return contentDir;
  }
  var isHtml = opt_isHtml ||
      soydata.isContentKind(text, soydata.SanitizedContentKind.HTML);
  return goog.i18n.bidi.estimateDirection(text + '', isHtml);
};


/**
 * Returns 'dir="ltr"' or 'dir="rtl"', depending on text's estimated
 * directionality, if it is not the same as bidiGlobalDir.
 * Otherwise, returns the empty string.
 * If opt_isHtml, makes sure to ignore the LTR nature of the mark-up and escapes
 * in text, making the logic suitable for HTML and HTML-escaped text.
 * If text has a goog.i18n.bidi.Dir-valued contentDir, this is used instead of
 * estimating the directionality.
 *
 * @param {number} bidiGlobalDir The global directionality context: 1 if ltr, -1
 *     if rtl, 0 if unknown.
 * @param {*} text The content whose directionality is to be estimated.
 * @param {boolean=} opt_isHtml Whether text is HTML/HTML-escaped.
 *     Default: false.
 * @return {soydata.SanitizedHtmlAttribute} 'dir="rtl"' for RTL text in non-RTL
 *     context; 'dir="ltr"' for LTR text in non-LTR context;
 *     else, the empty string.
 */
soy.$$bidiDirAttr = function(bidiGlobalDir, text, opt_isHtml) {
  var formatter = soy.$$getBidiFormatterInstance_(bidiGlobalDir);
  var contentDir = soydata.getContentDir(text);
  if (contentDir == null) {
    var isHtml = opt_isHtml ||
        soydata.isContentKind(text, soydata.SanitizedContentKind.HTML);
    contentDir = goog.i18n.bidi.estimateDirection(text + '', isHtml);
  }
  return soydata.VERY_UNSAFE.ordainSanitizedHtmlAttribute(
      formatter.knownDirAttr(contentDir));
};


/**
 * Returns a Unicode BiDi mark matching bidiGlobalDir (LRM or RLM) if the
 * directionality or the exit directionality of text are opposite to
 * bidiGlobalDir. Otherwise returns the empty string.
 * If opt_isHtml, makes sure to ignore the LTR nature of the mark-up and escapes
 * in text, making the logic suitable for HTML and HTML-escaped text.
 * If text has a goog.i18n.bidi.Dir-valued contentDir, this is used instead of
 * estimating the directionality.
 *
 * @param {number} bidiGlobalDir The global directionality context: 1 if ltr, -1
 *     if rtl, 0 if unknown.
 * @param {*} text The content whose directionality is to be estimated.
 * @param {boolean=} opt_isHtml Whether text is HTML/HTML-escaped.
 *     Default: false.
 * @return {string} A Unicode bidi mark matching bidiGlobalDir, or the empty
 *     string when text's overall and exit directionalities both match
 *     bidiGlobalDir, or bidiGlobalDir is 0 (unknown).
 */
soy.$$bidiMarkAfter = function(bidiGlobalDir, text, opt_isHtml) {
  var formatter = soy.$$getBidiFormatterInstance_(bidiGlobalDir);
  var isHtml = opt_isHtml ||
      soydata.isContentKind(text, soydata.SanitizedContentKind.HTML);
  return formatter.markAfterKnownDir(soydata.getContentDir(text), text + '',
      isHtml);
};


/**
 * Returns text wrapped in a <span dir="ltr|rtl"> according to its
 * directionality - but only if that is neither neutral nor the same as the
 * global context. Otherwise, returns text unchanged.
 * Always treats text as HTML/HTML-escaped, i.e. ignores mark-up and escapes
 * when estimating text's directionality.
 * If text has a goog.i18n.bidi.Dir-valued contentDir, this is used instead of
 * estimating the directionality.
 *
 * @param {number} bidiGlobalDir The global directionality context: 1 if ltr, -1
 *     if rtl, 0 if unknown.
 * @param {*} text The string to be wrapped. Can be other types, but the value
 *     will be coerced to a string.
 * @return {!goog.soy.data.SanitizedContent|string} The wrapped text.
 */
soy.$$bidiSpanWrap = function(bidiGlobalDir, text) {
  var formatter = soy.$$getBidiFormatterInstance_(bidiGlobalDir);

  // We always treat the value as HTML, because span-wrapping is only useful
  // when its output will be treated as HTML (without escaping), and because
  // |bidiSpanWrap is not itself specified to do HTML escaping in Soy. (Both
  // explicit and automatic HTML escaping, if any, is done before calling
  // |bidiSpanWrap because the BidiSpanWrapDirective Java class implements
  // SanitizedContentOperator, but this does not mean that the input has to be
  // HTML SanitizedContent. In legacy usage, a string that is not
  // SanitizedContent is often printed in an autoescape="false" template or by
  // a print with a |noAutoescape, in which case our input is just SoyData.) If
  // the output will be treated as HTML, the input had better be safe
  // HTML/HTML-escaped (even if it isn't HTML SanitizedData), or we have an XSS
  // opportunity and a much bigger problem than bidi garbling.
  var wrappedText = formatter.spanWrapWithKnownDir(
      soydata.getContentDir(text), text + '', true /* opt_isHtml */);

  // Like other directives whose Java class implements SanitizedContentOperator,
  // |bidiSpanWrap is called after the escaping (if any) has already been done,
  // and thus there is no need for it to produce actual SanitizedContent.
  return wrappedText;
};


/**
 * Returns text wrapped in Unicode BiDi formatting characters according to its
 * directionality, i.e. either LRE or RLE at the beginning and PDF at the end -
 * but only if text's directionality is neither neutral nor the same as the
 * global context. Otherwise, returns text unchanged.
 * Only treats soydata.SanitizedHtml as HTML/HTML-escaped, i.e. ignores mark-up
 * and escapes when estimating text's directionality.
 * If text has a goog.i18n.bidi.Dir-valued contentDir, this is used instead of
 * estimating the directionality.
 *
 * @param {number} bidiGlobalDir The global directionality context: 1 if ltr, -1
 *     if rtl, 0 if unknown.
 * @param {*} text The string to be wrapped. Can be other types, but the value
 *     will be coerced to a string.
 * @return {!goog.soy.data.SanitizedContent|string} The wrapped string.
 */
soy.$$bidiUnicodeWrap = function(bidiGlobalDir, text) {
  var formatter = soy.$$getBidiFormatterInstance_(bidiGlobalDir);

  // We treat the value as HTML if and only if it says it's HTML, even though in
  // legacy usage, we sometimes have an HTML string (not SanitizedContent) that
  // is passed to an autoescape="false" template or a {print $foo|noAutoescape},
  // with the output going into an HTML context without escaping. We simply have
  // no way of knowing if this is what is happening when we get
  // non-SanitizedContent input, and most of the time it isn't.
  var isHtml = soydata.isContentKind(text, soydata.SanitizedContentKind.HTML);
  var wrappedText = formatter.unicodeWrapWithKnownDir(
      soydata.getContentDir(text), text + '', isHtml);

  // Bidi-wrapping a value converts it to the context directionality. Since it
  // does not cost us anything, we will indicate this known direction in the
  // output SanitizedContent, even though the intended consumer of that
  // information - a bidi wrapping directive - has already been run.
  var wrappedTextDir = formatter.getContextDir();

  // Unicode-wrapping UnsanitizedText gives UnsanitizedText.
  // Unicode-wrapping safe HTML or JS string data gives valid, safe HTML or JS
  // string data.
  // ATTENTION: Do these need to be ...ForInternalBlocks()?
  if (soydata.isContentKind(text, soydata.SanitizedContentKind.TEXT)) {
    return new soydata.UnsanitizedText(wrappedText, wrappedTextDir);
  }
  if (isHtml) {
    return soydata.VERY_UNSAFE.ordainSanitizedHtml(wrappedText, wrappedTextDir);
  }
  if (soydata.isContentKind(text, soydata.SanitizedContentKind.JS_STR_CHARS)) {
    return soydata.VERY_UNSAFE.ordainSanitizedJsStrChars(
        wrappedText, wrappedTextDir);
  }

  // Unicode-wrapping does not conform to the syntax of the other types of
  // content. For lack of anything better to do, we we do not declare a content
  // kind at all by falling through to the non-SanitizedContent case below.
  // TODO(user): Consider throwing a runtime error on receipt of
  // SanitizedContent other than TEXT, HTML, or JS_STR_CHARS.

  // The input was not SanitizedContent, so our output isn't SanitizedContent
  // either.
  return wrappedText;
};


// -----------------------------------------------------------------------------
// Generated code.








// START GENERATED CODE FOR ESCAPERS.

/**
 * @type {function (*) : string}
 */
soy.esc.$$escapeUriHelper = function(v) {
  return encodeURIComponent(String(v));
};

/**
 * Maps characters to the escaped versions for the named escape directives.
 * @type {Object.<string, string>}
 * @private
 */
soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_ = {
  '\x00': '\x26#0;',
  '\x22': '\x26quot;',
  '\x26': '\x26amp;',
  '\x27': '\x26#39;',
  '\x3c': '\x26lt;',
  '\x3e': '\x26gt;',
  '\x09': '\x26#9;',
  '\x0a': '\x26#10;',
  '\x0b': '\x26#11;',
  '\x0c': '\x26#12;',
  '\x0d': '\x26#13;',
  ' ': '\x26#32;',
  '-': '\x26#45;',
  '\/': '\x26#47;',
  '\x3d': '\x26#61;',
  '`': '\x26#96;',
  '\x85': '\x26#133;',
  '\xa0': '\x26#160;',
  '\u2028': '\x26#8232;',
  '\u2029': '\x26#8233;'
};

/**
 * A function that can be used with String.replace.
 * @param {string} ch A single character matched by a compatible matcher.
 * @return {string} A token in the output language.
 * @private
 */
soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_ = function(ch) {
  return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_[ch];
};

/**
 * Maps characters to the escaped versions for the named escape directives.
 * @type {Object.<string, string>}
 * @private
 */
soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_ = {
  '\x00': '\\x00',
  '\x08': '\\x08',
  '\x09': '\\t',
  '\x0a': '\\n',
  '\x0b': '\\x0b',
  '\x0c': '\\f',
  '\x0d': '\\r',
  '\x22': '\\x22',
  '\x26': '\\x26',
  '\x27': '\\x27',
  '\/': '\\\/',
  '\x3c': '\\x3c',
  '\x3d': '\\x3d',
  '\x3e': '\\x3e',
  '\\': '\\\\',
  '\x85': '\\x85',
  '\u2028': '\\u2028',
  '\u2029': '\\u2029',
  '$': '\\x24',
  '(': '\\x28',
  ')': '\\x29',
  '*': '\\x2a',
  '+': '\\x2b',
  ',': '\\x2c',
  '-': '\\x2d',
  '.': '\\x2e',
  ':': '\\x3a',
  '?': '\\x3f',
  '[': '\\x5b',
  ']': '\\x5d',
  '^': '\\x5e',
  '{': '\\x7b',
  '|': '\\x7c',
  '}': '\\x7d'
};

/**
 * A function that can be used with String.replace.
 * @param {string} ch A single character matched by a compatible matcher.
 * @return {string} A token in the output language.
 * @private
 */
soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_ = function(ch) {
  return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_[ch];
};

/**
 * Maps characters to the escaped versions for the named escape directives.
 * @type {Object.<string, string>}
 * @private
 */
soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_CSS_STRING_ = {
  '\x00': '\\0 ',
  '\x08': '\\8 ',
  '\x09': '\\9 ',
  '\x0a': '\\a ',
  '\x0b': '\\b ',
  '\x0c': '\\c ',
  '\x0d': '\\d ',
  '\x22': '\\22 ',
  '\x26': '\\26 ',
  '\x27': '\\27 ',
  '(': '\\28 ',
  ')': '\\29 ',
  '*': '\\2a ',
  '\/': '\\2f ',
  ':': '\\3a ',
  ';': '\\3b ',
  '\x3c': '\\3c ',
  '\x3d': '\\3d ',
  '\x3e': '\\3e ',
  '@': '\\40 ',
  '\\': '\\5c ',
  '{': '\\7b ',
  '}': '\\7d ',
  '\x85': '\\85 ',
  '\xa0': '\\a0 ',
  '\u2028': '\\2028 ',
  '\u2029': '\\2029 '
};

/**
 * A function that can be used with String.replace.
 * @param {string} ch A single character matched by a compatible matcher.
 * @return {string} A token in the output language.
 * @private
 */
soy.esc.$$REPLACER_FOR_ESCAPE_CSS_STRING_ = function(ch) {
  return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_CSS_STRING_[ch];
};

/**
 * Maps characters to the escaped versions for the named escape directives.
 * @type {Object.<string, string>}
 * @private
 */
soy.esc.$$ESCAPE_MAP_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_ = {
  '\x00': '%00',
  '\x01': '%01',
  '\x02': '%02',
  '\x03': '%03',
  '\x04': '%04',
  '\x05': '%05',
  '\x06': '%06',
  '\x07': '%07',
  '\x08': '%08',
  '\x09': '%09',
  '\x0a': '%0A',
  '\x0b': '%0B',
  '\x0c': '%0C',
  '\x0d': '%0D',
  '\x0e': '%0E',
  '\x0f': '%0F',
  '\x10': '%10',
  '\x11': '%11',
  '\x12': '%12',
  '\x13': '%13',
  '\x14': '%14',
  '\x15': '%15',
  '\x16': '%16',
  '\x17': '%17',
  '\x18': '%18',
  '\x19': '%19',
  '\x1a': '%1A',
  '\x1b': '%1B',
  '\x1c': '%1C',
  '\x1d': '%1D',
  '\x1e': '%1E',
  '\x1f': '%1F',
  ' ': '%20',
  '\x22': '%22',
  '\x27': '%27',
  '(': '%28',
  ')': '%29',
  '\x3c': '%3C',
  '\x3e': '%3E',
  '\\': '%5C',
  '{': '%7B',
  '}': '%7D',
  '\x7f': '%7F',
  '\x85': '%C2%85',
  '\xa0': '%C2%A0',
  '\u2028': '%E2%80%A8',
  '\u2029': '%E2%80%A9',
  '\uff01': '%EF%BC%81',
  '\uff03': '%EF%BC%83',
  '\uff04': '%EF%BC%84',
  '\uff06': '%EF%BC%86',
  '\uff07': '%EF%BC%87',
  '\uff08': '%EF%BC%88',
  '\uff09': '%EF%BC%89',
  '\uff0a': '%EF%BC%8A',
  '\uff0b': '%EF%BC%8B',
  '\uff0c': '%EF%BC%8C',
  '\uff0f': '%EF%BC%8F',
  '\uff1a': '%EF%BC%9A',
  '\uff1b': '%EF%BC%9B',
  '\uff1d': '%EF%BC%9D',
  '\uff1f': '%EF%BC%9F',
  '\uff20': '%EF%BC%A0',
  '\uff3b': '%EF%BC%BB',
  '\uff3d': '%EF%BC%BD'
};

/**
 * A function that can be used with String.replace.
 * @param {string} ch A single character matched by a compatible matcher.
 * @return {string} A token in the output language.
 * @private
 */
soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_ = function(ch) {
  return soy.esc.$$ESCAPE_MAP_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_[ch];
};

/**
 * Matches characters that need to be escaped for the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$MATCHER_FOR_ESCAPE_HTML_ = /[\x00\x22\x26\x27\x3c\x3e]/g;

/**
 * Matches characters that need to be escaped for the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_ = /[\x00\x22\x27\x3c\x3e]/g;

/**
 * Matches characters that need to be escaped for the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$MATCHER_FOR_ESCAPE_HTML_NOSPACE_ = /[\x00\x09-\x0d \x22\x26\x27\x2d\/\x3c-\x3e`\x85\xa0\u2028\u2029]/g;

/**
 * Matches characters that need to be escaped for the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_NOSPACE_ = /[\x00\x09-\x0d \x22\x27\x2d\/\x3c-\x3e`\x85\xa0\u2028\u2029]/g;

/**
 * Matches characters that need to be escaped for the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$MATCHER_FOR_ESCAPE_JS_STRING_ = /[\x00\x08-\x0d\x22\x26\x27\/\x3c-\x3e\\\x85\u2028\u2029]/g;

/**
 * Matches characters that need to be escaped for the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$MATCHER_FOR_ESCAPE_JS_REGEX_ = /[\x00\x08-\x0d\x22\x24\x26-\/\x3a\x3c-\x3f\x5b-\x5e\x7b-\x7d\x85\u2028\u2029]/g;

/**
 * Matches characters that need to be escaped for the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$MATCHER_FOR_ESCAPE_CSS_STRING_ = /[\x00\x08-\x0d\x22\x26-\x2a\/\x3a-\x3e@\\\x7b\x7d\x85\xa0\u2028\u2029]/g;

/**
 * Matches characters that need to be escaped for the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_ = /[\x00- \x22\x27-\x29\x3c\x3e\\\x7b\x7d\x7f\x85\xa0\u2028\u2029\uff01\uff03\uff04\uff06-\uff0c\uff0f\uff1a\uff1b\uff1d\uff1f\uff20\uff3b\uff3d]/g;

/**
 * A pattern that vets values produced by the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$FILTER_FOR_FILTER_CSS_VALUE_ = /^(?!-*(?:expression|(?:moz-)?binding))(?:[.#]?-?(?:[_a-z0-9-]+)(?:-[_a-z0-9-]+)*-?|-?(?:[0-9]+(?:\.[0-9]*)?|\.[0-9]+)(?:[a-z]{1,2}|%)?|!important|)$/i;

/**
 * A pattern that vets values produced by the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$FILTER_FOR_FILTER_NORMALIZE_URI_ = /^(?:(?:https?|mailto):|[^&:\/?#]*(?:[\/?#]|$))/i;

/**
 * A pattern that vets values produced by the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$FILTER_FOR_FILTER_IMAGE_DATA_URI_ = /^data:image\/(?:bmp|gif|jpe?g|png|tiff|webp);base64,[a-z0-9+\/]+=*$/i;

/**
 * A pattern that vets values produced by the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$FILTER_FOR_FILTER_HTML_ATTRIBUTES_ = /^(?!style|on|action|archive|background|cite|classid|codebase|data|dsync|href|longdesc|src|usemap)(?:[a-z0-9_$:-]*)$/i;

/**
 * A pattern that vets values produced by the named directives.
 * @type RegExp
 * @private
 */
soy.esc.$$FILTER_FOR_FILTER_HTML_ELEMENT_NAME_ = /^(?!script|style|title|textarea|xmp|no)[a-z0-9_$:-]*$/i;

/**
 * A helper for the Soy directive |escapeHtml
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$escapeHtmlHelper = function(value) {
  var str = String(value);
  return str.replace(
      soy.esc.$$MATCHER_FOR_ESCAPE_HTML_,
      soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_);
};

/**
 * A helper for the Soy directive |normalizeHtml
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$normalizeHtmlHelper = function(value) {
  var str = String(value);
  return str.replace(
      soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_,
      soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_);
};

/**
 * A helper for the Soy directive |escapeHtmlNospace
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$escapeHtmlNospaceHelper = function(value) {
  var str = String(value);
  return str.replace(
      soy.esc.$$MATCHER_FOR_ESCAPE_HTML_NOSPACE_,
      soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_);
};

/**
 * A helper for the Soy directive |normalizeHtmlNospace
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$normalizeHtmlNospaceHelper = function(value) {
  var str = String(value);
  return str.replace(
      soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_NOSPACE_,
      soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_);
};

/**
 * A helper for the Soy directive |escapeJsString
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$escapeJsStringHelper = function(value) {
  var str = String(value);
  return str.replace(
      soy.esc.$$MATCHER_FOR_ESCAPE_JS_STRING_,
      soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_);
};

/**
 * A helper for the Soy directive |escapeJsRegex
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$escapeJsRegexHelper = function(value) {
  var str = String(value);
  return str.replace(
      soy.esc.$$MATCHER_FOR_ESCAPE_JS_REGEX_,
      soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_);
};

/**
 * A helper for the Soy directive |escapeCssString
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$escapeCssStringHelper = function(value) {
  var str = String(value);
  return str.replace(
      soy.esc.$$MATCHER_FOR_ESCAPE_CSS_STRING_,
      soy.esc.$$REPLACER_FOR_ESCAPE_CSS_STRING_);
};

/**
 * A helper for the Soy directive |filterCssValue
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$filterCssValueHelper = function(value) {
  var str = String(value);
  if (!soy.esc.$$FILTER_FOR_FILTER_CSS_VALUE_.test(str)) {
    return 'zSoyz';
  }
  return str;
};

/**
 * A helper for the Soy directive |normalizeUri
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$normalizeUriHelper = function(value) {
  var str = String(value);
  return str.replace(
      soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_,
      soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_);
};

/**
 * A helper for the Soy directive |filterNormalizeUri
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$filterNormalizeUriHelper = function(value) {
  var str = String(value);
  if (!soy.esc.$$FILTER_FOR_FILTER_NORMALIZE_URI_.test(str)) {
    return '#zSoyz';
  }
  return str.replace(
      soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_,
      soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_);
};

/**
 * A helper for the Soy directive |filterImageDataUri
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$filterImageDataUriHelper = function(value) {
  var str = String(value);
  if (!soy.esc.$$FILTER_FOR_FILTER_IMAGE_DATA_URI_.test(str)) {
    return 'data:image/gif;base64,zSoyz';
  }
  return str;
};

/**
 * A helper for the Soy directive |filterHtmlAttributes
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$filterHtmlAttributesHelper = function(value) {
  var str = String(value);
  if (!soy.esc.$$FILTER_FOR_FILTER_HTML_ATTRIBUTES_.test(str)) {
    return 'zSoyz';
  }
  return str;
};

/**
 * A helper for the Soy directive |filterHtmlElementName
 * @param {*} value Can be of any type but will be coerced to a string.
 * @return {string} The escaped text.
 */
soy.esc.$$filterHtmlElementNameHelper = function(value) {
  var str = String(value);
  if (!soy.esc.$$FILTER_FOR_FILTER_HTML_ELEMENT_NAME_.test(str)) {
    return 'zSoyz';
  }
  return str;
};

/**
 * Matches all tags, HTML comments, and DOCTYPEs in tag soup HTML.
 * By removing these, and replacing any '<' or '>' characters with
 * entities we guarantee that the result can be embedded into a
 * an attribute without introducing a tag boundary.
 *
 * @type {RegExp}
 * @private
 */
soy.esc.$$HTML_TAG_REGEX_ = /<(?:!|\/?([a-zA-Z][a-zA-Z0-9:\-]*))(?:[^>'"]|"[^"]*"|'[^']*')*>/g;

/**
 * Matches all occurrences of '<'.
 *
 * @type {RegExp}
 * @private
 */
soy.esc.$$LT_REGEX_ = /</g;

/**
 * Maps lower-case names of innocuous tags to 1.
 *
 * @type {Object.<string,number>}
 * @private
 */
soy.esc.$$SAFE_TAG_WHITELIST_ = {'b': 1, 'br': 1, 'em': 1, 'i': 1, 's': 1, 'sub': 1, 'sup': 1, 'u': 1};

// END GENERATED CODE


ï»¿/// <reference path="Jquery-1.6.1-min.js" />
var formatter = formatter || undefined;

var performance = typeof (performance) !== 'undefined' ? performance : {};
performance.now = performance.now || function () { return 0; }

if (typeof Util == 'undefined') { Util = {}; }

function binarySearch(selectorFunction, searchString, parcial) {
    var imin = 0;
    var imax = this.length - 1;

    searchString = searchString.getNeutralString();

    if (parcial == 'undefined')
        parcial = false;

    return bsRecursive(this, selectorFunction, imin, imax, searchString, parcial)
}

function bsRecursive(list, selectorFunction, imin, imax, searchString, parcial) {
    var imid;
    var currentElement;
    var funcRet;

    // test if array is empty
    if (imax < imin)
        return -1;
    else {
        // calculate midpoint to cut set in half
        imid = parseInt(imin + ((imax - imin) / 2));
        currentElement = selectorFunction(list[imid]);
        if (parcial)
            currentElement = currentElement.substring(0, searchString.length);

        // three-way comparison
        if (currentElement.getNeutralString() > searchString)
            // key is in lower subset
            return bsRecursive(list, selectorFunction, imin, imid - 1, searchString, parcial);
        else if (currentElement.getNeutralString() < searchString)
            // key is in upper subset
            return bsRecursive(list, selectorFunction, imid + 1, imax, searchString, parcial);
        else
            // key has been found
            return imid;
    }

}

function binarySearchRange(searchString, selectorFunction) {
    var index = this.binarySearch(selectorFunction, searchString, true);
    var begin;
    var end;

    var subItem = null;
    if (index > -1) {
        do {
            subItem = selectorFunction(this[index]).substring(0, searchString.length);
            if (subItem.getNeutralString() != searchString) {
                index++; //Adjust to the last equal element
                begin = index;
                break;
            }
            index--;
        } while (index >= 0)
        if (index < 0) {
            begin = 0;
            index = 0;
        }

        while (index < this.length && selectorFunction(this[index]).substring(0, searchString.length).getNeutralString() == searchString) {
            index++;
        }

        end = index - 1;
    }
    else {
        begin = -1;
        end = -1;
    }

    return {
        begin: begin,
        end: end
    }
}

Array.prototype.binarySearch = binarySearch;
Array.prototype.binarySearchRange = binarySearchRange;

var defaultDiacriticsRemovalap = [
    { 'base': 'A', 'letters': '\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F' },
    { 'base': 'AA', 'letters': '\uA732' },
    { 'base': 'AE', 'letters': '\u00C6\u01FC\u01E2' },
    { 'base': 'AO', 'letters': '\uA734' },
    { 'base': 'AU', 'letters': '\uA736' },
    { 'base': 'AV', 'letters': '\uA738\uA73A' },
    { 'base': 'AY', 'letters': '\uA73C' },
    { 'base': 'B', 'letters': '\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181' },
    { 'base': 'C', 'letters': '\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E' },
    { 'base': 'D', 'letters': '\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779' },
    { 'base': 'DZ', 'letters': '\u01F1\u01C4' },
    { 'base': 'Dz', 'letters': '\u01F2\u01C5' },
    { 'base': 'E', 'letters': '\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E' },
    { 'base': 'F', 'letters': '\u0046\u24BB\uFF26\u1E1E\u0191\uA77B' },
    { 'base': 'G', 'letters': '\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E' },
    { 'base': 'H', 'letters': '\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D' },
    { 'base': 'I', 'letters': '\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197' },
    { 'base': 'J', 'letters': '\u004A\u24BF\uFF2A\u0134\u0248' },
    { 'base': 'K', 'letters': '\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2' },
    { 'base': 'L', 'letters': '\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780' },
    { 'base': 'LJ', 'letters': '\u01C7' },
    { 'base': 'Lj', 'letters': '\u01C8' },
    { 'base': 'M', 'letters': '\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C' },
    { 'base': 'N', 'letters': '\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4' },
    { 'base': 'NJ', 'letters': '\u01CA' },
    { 'base': 'Nj', 'letters': '\u01CB' },
    { 'base': 'O', 'letters': '\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C' },
    { 'base': 'OI', 'letters': '\u01A2' },
    { 'base': 'OO', 'letters': '\uA74E' },
    { 'base': 'OU', 'letters': '\u0222' },
    { 'base': 'OE', 'letters': '\u008C\u0152' },
    { 'base': 'oe', 'letters': '\u009C\u0153' },
    { 'base': 'P', 'letters': '\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754' },
    { 'base': 'Q', 'letters': '\u0051\u24C6\uFF31\uA756\uA758\u024A' },
    { 'base': 'R', 'letters': '\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782' },
    { 'base': 'S', 'letters': '\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784' },
    { 'base': 'T', 'letters': '\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786' },
    { 'base': 'TZ', 'letters': '\uA728' },
    { 'base': 'U', 'letters': '\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244' },
    { 'base': 'V', 'letters': '\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245' },
    { 'base': 'VY', 'letters': '\uA760' },
    { 'base': 'W', 'letters': '\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72' },
    { 'base': 'X', 'letters': '\u0058\u24CD\uFF38\u1E8A\u1E8C' },
    { 'base': 'Y', 'letters': '\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE' },
    { 'base': 'Z', 'letters': '\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762' },
    { 'base': 'a', 'letters': '\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250' },
    { 'base': 'aa', 'letters': '\uA733' },
    { 'base': 'ae', 'letters': '\u00E6\u01FD\u01E3' },
    { 'base': 'ao', 'letters': '\uA735' },
    { 'base': 'au', 'letters': '\uA737' },
    { 'base': 'av', 'letters': '\uA739\uA73B' },
    { 'base': 'ay', 'letters': '\uA73D' },
    { 'base': 'b', 'letters': '\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253' },
    { 'base': 'c', 'letters': '\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184' },
    { 'base': 'd', 'letters': '\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A' },
    { 'base': 'dz', 'letters': '\u01F3\u01C6' },
    { 'base': 'e', 'letters': '\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD' },
    { 'base': 'f', 'letters': '\u0066\u24D5\uFF46\u1E1F\u0192\uA77C' },
    { 'base': 'g', 'letters': '\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F' },
    { 'base': 'h', 'letters': '\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265' },
    { 'base': 'hv', 'letters': '\u0195' },
    { 'base': 'i', 'letters': '\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131' },
    { 'base': 'j', 'letters': '\u006A\u24D9\uFF4A\u0135\u01F0\u0249' },
    { 'base': 'k', 'letters': '\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3' },
    { 'base': 'l', 'letters': '\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747' },
    { 'base': 'lj', 'letters': '\u01C9' },
    { 'base': 'm', 'letters': '\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F' },
    { 'base': 'n', 'letters': '\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5' },
    { 'base': 'nj', 'letters': '\u01CC' },
    { 'base': 'o', 'letters': '\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275' },
    { 'base': 'oi', 'letters': '\u01A3' },
    { 'base': 'ou', 'letters': '\u0223' },
    { 'base': 'oo', 'letters': '\uA74F' },
    { 'base': 'p', 'letters': '\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755' },
    { 'base': 'q', 'letters': '\u0071\u24E0\uFF51\u024B\uA757\uA759' },
    { 'base': 'r', 'letters': '\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783' },
    { 'base': 's', 'letters': '\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B' },
    { 'base': 't', 'letters': '\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787' },
    { 'base': 'tz', 'letters': '\uA729' },
    { 'base': 'u', 'letters': '\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289' },
    { 'base': 'v', 'letters': '\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C' },
    { 'base': 'vy', 'letters': '\uA761' },
    { 'base': 'w', 'letters': '\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73' },
    { 'base': 'x', 'letters': '\u0078\u24E7\uFF58\u1E8B\u1E8D' },
    { 'base': 'y', 'letters': '\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF' },
    { 'base': 'z', 'letters': '\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763' }
];

var diacriticsMap = {};
for (var i = 0; i < defaultDiacriticsRemovalap.length; i++) {
    var letters = defaultDiacriticsRemovalap[i].letters;
    for (var j = 0; j < letters.length; j++) {
        diacriticsMap[letters[j]] = defaultDiacriticsRemovalap[i].base;
    }
}

function removeDiacritics(str) {
    return str.replace(/[^\u0000-\u007E]/g, function (a) {
        return diacriticsMap[a] || a;
    });
}

function getNeutral() {
    return removeDiacritics(this).toLowerCase();
}

String.prototype.getNeutralString = getNeutral;

Util.addDaysToDateValue = function (objDate, days) {
    return Util.DateValuesToDate(objDate).addDays(days).toDateValues();
}

Util.BetweenDateValues = function (initDateValue, endDateValue, testDateValue, considerNoIntervals) {

    var initDate = Util.DateValuesToDate(initDateValue);
    var endDate = Util.DateValuesToDate(endDateValue);
    var testDate = Util.DateValuesToDate(testDateValue);
    var interval = 'days';

    var _return = initDate <= testDate
        && endDate >= testDate;

    if (!considerNoIntervals) {
        _return &= endDate > initDate;
    } else {
        _return &= endDate >= initDate;
    }

    return _return;
}

Util.DateValuesToDate = function (objDate) {
    if (objDate && objDate.Year != undefined && objDate.Month != undefined && objDate.Day != undefined)
        return new Date(objDate.Year, objDate.Month - 1, objDate.Day, objDate.Hour ? objDate.Hour : 0, objDate.Minutes ? objDate.Minutes : 0, 0, 0);

    return null;
}

Util.IntTimeToDateTime = function (objTime) {

    if (objTime >= 0) {
        var hour = parseInt(parseFloat(objTime) / 60);
        var minutes = parseFloat(objTime) % 60;
        var result = new Date(2010, 1, 1, hour, minutes, 0, 0);

        return result;
    }

    return null;
}

Util.ParseTravelAceBrokerCode = {
    BR: "TerritÃ³rio Nacional",
    X2: "AmÃ©rica Central e Caribe",
    X4: "AmÃ©rica do Norte",
    X3: "AmÃ©rica do Sul (menos Brasil)",
    X6: "Europa",
    X8: "Oceania",
    X7: "Ãsia",
    X5: "Ãfrica"
};


Util.GetLastDayFromMonth = function (month, year) {
    var _date = new Date(year, month, 0);

    return _date.toDateValues().Day;
}

Util.DateToDateValues = function (objDate) {

    if (!objDate || !(objDate instanceof Date))
        return null;

    return objDate.toDateValues();
};

Util.DateToYearFirstPattern = function (dt) {
    var ret = '';
    ret = dt.Day.toString();
    if (ret.length == 1)
        ret = '0' + ret;
    ret = dt.Month + ret;
    if (ret.length == 3)
        ret = '0' + ret;
    ret = dt.Year + ret;

    return ret;
}

function removeFromAutomaticQuotationAir(automaticQuotations, itemToCompare) {
    var isSameItem = true;
    var itemToRemove = undefined;

    for (var i = 0; i < automaticQuotations.length; i++) {
        var rec = automaticQuotations[i];
        isSameItem = true;
        for (var j = 0; j < rec.FlightGroups.length; j++) {
            var fg = rec.FlightGroups[j];
            var assFg = itemToCompare[j];
            if (assFg && fg.OriginalFlightGroup)
                isSameItem = assFg.Hash == fg.OriginalFlightGroup.Hash;

            if (!isSameItem)
                break;
        }

        if (isSameItem) {
            itemToRemove = rec;
            break;
        }
    }

    return itemToRemove;
}

function removeFromAutomaticQuotationHotel(automaticQuotations, itemToCompare) {
    var isSameItem = true;
    var itemToRemove = undefined;
    if (itemToCompare.length) {
        for (var i = 0; i < automaticQuotations.length; i++) {
            var hotel = automaticQuotations[i];
            isSameItem = hotel.Id == itemToCompare[0].Id;
            if (isSameItem) {
                itemToRemove = hotel;
                break;
            }
        }
    }
    return itemToRemove;
}

var RemoveFromAutomaticQuotationFunctions = {
    'Air': removeFromAutomaticQuotationAir,
    'Hotel': removeFromAutomaticQuotationHotel
};

Util.RemoveFromAutomaticQuotation = function (automaticQuotations, itemToCompare, type) {
    var isSameItem = true;
    var itemToRemove = RemoveFromAutomaticQuotationFunctions[type](automaticQuotations, itemToCompare);

    if (itemToRemove)
        automaticQuotations.removeItem(itemToRemove);

    return automaticQuotations;
}

Util.CreateAbsoluteDate = function () {
    var currentDate = new Date();
    return new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate());
}

Util.DateValuesDiff = function (init, end, strInterval) {
    if (strInterval == 'days') {
        var cloneInit = Util.Clone(init);
        var cloneEnd = Util.Clone(end);
        cloneInit.Hour = 0;
        cloneEnd.Hour = 0;
        cloneInit.Minutes = 0;
        cloneEnd.Minutes = 0;
        return Util.DateValuesToDate(cloneInit).dateDiff('d', Util.DateValuesToDate(cloneEnd));
    }
    else {
        return Util.DateValuesToDate(init).dateDiff(strInterval, Util.DateValuesToDate(end));
    }
};

Util.MonthsDiff = function (firstDate, secondDate) {
    var months = (secondDate.getFullYear() - firstDate.getFullYear()) * 12;
    months -= firstDate.getMonth() + 1;
    months += secondDate.getMonth();
    return months <= 0 ? 0 : months;
};

Util.NumberDiff = function (firstValue, secondValue) {
    var subtracted = firstValue - secondValue;
    if (subtracted < 0)
        subtracted = subtracted * -1;

    return subtracted;
}

Util.DateValuesToSQLStringDate = function (objDate) {
    var ret = "{0}-{1}-{2}".format([objDate.Year, formatter.toTwoDigits(objDate.Month), formatter.toTwoDigits(objDate.Day)]);

    if (Util.isValidNumber(objDate.Hour))
        ret = ret + " {0}:{1}".format([formatter.toTwoDigits(objDate.Hour), formatter.toTwoDigits(objDate.Minutes)]);

    return ret;
}

Util.SQLStringDateToDateValue = function (str) {

    var obj = {};

    var dateAndHour = str.split(' ');

    var dateValues = dateAndHour[0].split("-");

    if (dateValues.length == 3) {

        obj = {
            Year: dateValues[0],
            Month: dateValues[1],
            Day: dateValues[2]
        }

        if (dateAndHour.length == 2) {
            var hourValues = dateAndHour[1].split(":");

            obj.Hour = hourValues[0];
            obj.Minutes = hourValues[1];
        }
    }

    return obj;
}

Util.DateValuesEquals = function (dOne, dTwo) {
    return (dOne && dTwo) && (dOne.Year == dTwo.Year) && (dOne.Month == dTwo.Month) && (dOne.Day == dTwo.Day);
}

Util.StringToDateValues = function (value, language) {
    try {
        var objDate;
        var invertDayMonth = (language && language.toLowerCase().contains('en')) || (formatter && formatter.culture.contains('en'));

        var splited = value && value.split(' ');
        if (splited && splited.length > 0) {
            var splitedDate = [];
            if (splited[0].indexOf('-') > -1)
                splitedDate = splited[0].split('-');
            else
                splitedDate = splited[0].split('/');

            if (splitedDate.length == 3) {
                if (invertDayMonth)
                    objDate = { Year: splitedDate[2], Month: splitedDate[0], Day: splitedDate[1] };
                else
                    objDate = { Year: splitedDate[2], Month: splitedDate[1], Day: splitedDate[0] };
            }

            if (objDate && splited.length == 2) {
                var time = splited[1].split(':');

                objDate.Hour = time[0];
                objDate.Minutes = time[1];
                objDate.Seconds = time.length == 3 ? time[2] : "59";
            }
        }
    }
    catch (e) {
        return null;
    }

    return objDate;
};

Util.DateValuesToString = function (objDateValues) {
    return formatter.dateValuesShort(objDateValues);
};

Util.DateValuesToStringWithCulture = function (objDateValues, culture) {
    return formatter.dateValuesShortWithCulture(objDateValues, culture);
};

Util.DateToString = function (objDate) {

    if (!objDate)
        return null;

    var objDateValues = objDate;

    if (objDate instanceof Date)
        objDateValues = {
            Year: objDate.getFullYear(),
            Month: objDate.getMonth() + 1,
            Day: objDate.getDate()
        };

    return Util.DateValuesToString(objDateValues);
}

Util.StringToDate = function (value, language) {
    if (!value || value == "")
        return new Date();

    var dateValues = Util.StringToDateValues(value, language);

    return new Date(dateValues.Year, (dateValues.Month - 1), dateValues.Day);
}

if (!$ && jQuery)
    $ = jQuery;

$.fn.containsEvent = function (eventName) {
    return !!$(this).data("events")[eventName];
};

Util.PluginNamesToken = "pluginNames";

Util.AllCreatedPluginDatas = {};

Util.GetPluginDataToken = function (pluginName) {
    if (Util.AllCreatedPluginDatas[pluginName])
        Util.AllCreatedPluginDatas[pluginName].Count++;
    else
        Util.AllCreatedPluginDatas[pluginName] = { Name: pluginName + "Data", Count: 1 };

    return Util.AllCreatedPluginDatas[pluginName].Name;
}

$.fn.invokePlugin = function (functionName, args) {
    var ctrl = $(this);

    var instanceNames = ctrl.data(Util.PluginNamesToken);

    if (instanceNames && instanceNames.length) {
        return ctrl[instanceNames[0]](functionName, args);
    }

    return ctrl;
};

$.fn.containsPlugin = function (pluginName) {
    var token = Util.GetPluginDataToken(pluginName);

    var contains = false;
    if (this.data(pluginName) != undefined || this.data(token) != undefined)
        contains = true;
    else if (this.data('ui' + pluginName.capitalize()) != undefined)
        contains = true;
    else if (this.data(token) != undefined)
        contains = true;

    return contains;
};

$.fn.destroyPlugin = function (pluginName) {
    Util.defaultDestroy($(this), pluginName);
};

$.fn.destroyDialog = function () {
    var component = $(this);

    if (component.containsPlugin("dialog")) {
        component.dialog("close");
    }

    return component;
};

$.fn.removePlugins = function () {
    var ctrl = $(this);
    var pluginNames = ctrl.data(Util.PluginNamesToken);

    for (var i = 0; pluginNames && i < pluginNames.length; i++) {
        Util.defaultDestroy(ctrl, pluginNames[i]);
    }
};

Util.defaultDestroy = function (component, pluginName) {
    var token = Util.GetPluginDataToken(pluginName);
    component.data(token) && component.removeData(token);

    var pluginNames = component.data(Util.PluginNamesToken);
    pluginNames && pluginNames.removeItem(pluginName);
};

Util.pluginDefaultBehavior = function (plugin, pluginName, args, constructorFunc) {
    if (!plugin.length)
        return plugin;

    var options = args[0];

    if (typeof options == 'string') {
        return Util.execPluginMethod(plugin, pluginName, args, constructorFunc);
    }
    else {
        return plugin.each(function () {

            var token = Util.GetPluginDataToken(pluginName);

            var ctrl = $(this);

            var obj = ctrl.data(token);

            obj && ctrl.removeData(token);

            obj = constructorFunc();

            ctrl.data(token, obj);

            obj.initialize(this, options);

            var instanceNames = ctrl.data(Util.PluginNamesToken);

            if (instanceNames)
                instanceNames.push(pluginName);
            else
                instanceNames = [pluginName];

            ctrl.data(Util.PluginNamesToken, instanceNames);
        });
    }
};

Util.execPluginMethod = function (plugins, pluginName, args, constructorFunc) {

    var options = args[0];
    var args = Array.prototype.slice.call(args, 1);

    if (typeof options == 'string') {
        var obj = undefined;

        if (plugins && plugins.length) {

            var ret = [];

            for (var i = 0; i < plugins.length; i++) {

                var token = Util.GetPluginDataToken(pluginName);

                obj = $(plugins[i]).data(token);

                if (obj) {
                    if (obj[options]) {
                        ret.push(obj[options].apply(plugins, args));
                    }
                    else if (typeof console != 'undefined') {
                        console.log("Unable to find method " + options + " in element " + pluginName);
                    }
                }
                else if (typeof console != 'undefined') {
                    console.log("Unable to find instance of " + pluginName);
                }
            }

            if (plugins.length > 1) {
                var ids = $.map(plugins, function (item) { return $(item).attr("id"); })

                ids = ids.where(function (h) { return h.length; });

                if (ids.distinct().length != ids.length) {
                    console.log("HÃ¡ Ids iguais na execuÃ§Ã£o do mÃ©todo do plugin: " + ids.join(", "));
                }
            }

            return ret.length > 1 ? ret : ret[0];
        }
        else {
            obj = constructorFunc();

            return obj[options].apply(plugins, args);
        }
    }
};

Util.pluginStaticBehavior = function (plugin, pluginName, args, contructorFunc) {

};

Util.stringifyJSON = function (obj) {
    return JSON2 ? JSON2.stringify(obj) : JSON ? JSON.stringifyWcf(obj) : "";
}

Util.IsOldNavigator = function () {
    return (navigator.userAgent.indexOf("MSIE 6.") != -1) || (navigator.userAgent.indexOf("MSIE 5.") != -1) || (navigator.userAgent.indexOf("MSIE 4.") != -1);
};

Util.IsIE7Navigator = function () {
    return (navigator.userAgent.indexOf("MSIE 7.") != -1)
};

Util.IsIENavigator = function () {
    return (navigator.userAgent.indexOf("MSIE") != -1);
};

Util.clone = Util.Clone = function (obj, visitedObjects) {

    if (!visitedObjects)
        visitedObjects = [];

    if (typeof obj !== 'object' || obj == null) {
        return obj;
    }

    var c = obj instanceof Array ? [] : {};

    for (var i in obj) {
        var prop = obj[i];

        if (typeof prop == 'object') {

            var isVisitedObj = false;

            if (visitedObjects && visitedObjects.length) {
                for (var vObj = 0; vObj < visitedObjects.length; vObj++) {
                    if (visitedObjects[vObj].prop === prop) {
                        if (visitedObjects[vObj].count > 0) {
                            c[i] = null;
                            isVisitedObj = true;
                        }

                        visitedObjects[vObj].count++;
                        break;
                    }
                }
            }

            if (!isVisitedObj) {
                if (prop instanceof Array) {
                    c[i] = [];

                    for (var j = 0; j < prop.length; j++) {
                        if (typeof prop[j] != 'object') {
                            c[i].push(prop[j]);
                        } else {
                            visitedObjects.push({ prop: prop[j], count: 0 });
                            c[i].push(Util.Clone(prop[j], visitedObjects));
                        }
                    }
                } else if (prop instanceof Date) {
                    c[i] = new Date(prop.getTime());
                } else {
                    visitedObjects.push({ prop: prop, count: 0 });
                    c[i] = Util.Clone(prop, visitedObjects);

                }
            }
        } else {
            c[i] = prop;
        }
    }

    return c;
};

Util.CloneArray = function (toClone) {

    var cloned = [];

    if (toClone) {
        cloned = toClone.slice(0);
    }

    return cloned;
}

Util.CloneStringify = function (obj) {
    return JSON.parse(Util.stringifyJSON(obj));
};

Util.CloseHintBoxy = function (sender) {

    if (sender) {
        var oDiv = ((typeof sender == "string" || !sender.jquery) ? $(sender) : sender).hide();
        if (oDiv.attr("CreateHintBoxy") == "true")
            oDiv.remove();
    }

    $(document).unbind('keypress', _closeHistBodyEscPressed);
    var container = $("#CreateHintBoxyDIVFundo").closest('.overlay');
    if (container && container.children() && container.children().length == 1 && container.children('#CreateHintBoxyDIVFundo'))
        $('.overlay').remove();
    else
        $("#CreateHintBoxyDIVFundo").remove();

};

Util.CloseDoubleHintBoxy = function (sender) {

    if (sender) {
        var oDiv = ((typeof sender == "string" || !sender.jquery) ? $(sender) : sender).hide();

        if (oDiv.attr("CreateHintBoxy"))
            if (oDiv.closest('.overlay'))
                oDiv.remove();
    }

    $(document).unbind('keypress', _closeHistBodyEscPressed);

    $('.overlay').remove();


};

Util.CreateHintBoxy = function (mensagem, sender, bolAutomaticClose, position, doNotCenter, classe, doubleBackground, showBackground) {

    if (classe)
        classe = "class='" + classe + "'";

    var background = undefined;
    if (showBackground == true || showBackground === undefined)
        background = Util.CreateHintBoxBackground(doubleBackground);

    var xPosition;
    var yPosition;
    var bolCenter = true;

    if (doNotCenter)
        bolCenter = !doNotCenter;

    if (bolAutomaticClose == undefined)
        bolAutomaticClose = false;

    if (!position)
        position = "fixed";

    if (sender != undefined && $(sender).length) {
        xPosition = $(sender).position().left;
        yPosition = $(sender).position().top;
        width = $(sender).outerWidth(true);
        height = $(sender).outerHeight(true);
        xPosition += width;
    }
    else {
        if (self.innerHeight) {
            xPosition = self.innerWidth;
            yPosition = self.innerHeight;
        } else if (document.documentElement && document.documentElement.clientHeight) {
            xPosition = document.documentElement.clientWidth;
            yPosition = document.documentElement.clientHeight;
        } else if (document.body) {
            xPosition = document.body.clientWidth;
            yPosition = document.body.clientHeight;
        }

        yPosition = yPosition <= 5 ? YMousePosition : yPosition / 2;

        xPosition = xPosition / 2;
    }

    var oDiv = mensagem;

    if (typeof mensagem == "string") {

        oDiv = $("<div style='background: #FFF; position: " + position + "' " + classe + "></div>")

        oDiv.html(mensagem).attr("CreateHintBoxy", true);

        bolCenter = true;
    }

    if (oDiv) {
        if (!oDiv.jquery)
            oDiv = $(oDiv);

        oDiv.hide();

        $(document.body).append(oDiv);

        if (bolCenter) {
            xPosition -= (oDiv.width() / 2);
            yPosition -= (oDiv.height() / 2);
        }

        oDiv[0].style.left = xPosition + "px";
        oDiv[0].style.top = yPosition + "px";
        oDiv[0].style.position = position;
        oDiv[0].style.zIndex = "950";

        if ($(window).height() < oDiv.height()) {
            oDiv.height($(window).height() - 20);
            oDiv[0].style.top = "10px";
            oDiv.css("overflow-y", "scroll");
        }

        oDiv.fadeIn(500);
    }

    if (bolAutomaticClose && background) {
        background.click(function () {
            Util.CloseHintBoxy(oDiv);
        });
        $(document).keypress(_closeHistBodyEscPressed);
    }
};

function _closeHistBodyEscPressed(e) {
    if (e.keyCode == 27) {
        Util.CloseHintBoxy(oDiv);
    }
}

Util.CreateHintBoxBackground = function (doubleBackground, loaderClass) {
    if (!$("#CreateHintBoxyDIVFundo").length) {

        var oDivFundo = window.document.createElement("div");
        if (!doubleBackground) {
            oDivFundo.id = "CreateHintBoxyDIVFundo";
            oDivFundo.style.filter = "Alpha(Opacity=40)";

            oDivFundo.style.opacity = "0.4";
            oDivFundo.style.backgroundColor = "#CCC";

            if (window.scrollMaxY == 0)
                oDivFundo.style.height = "100%";
            else
                oDivFundo.style.height = $(document).height() + 100 + "px";

            oDivFundo.style.width = "100%";
            oDivFundo.style.position = Util.IsOldNavigator() ? "absolute" : "fixed";
            oDivFundo.style.zIndex = "900";
            oDivFundo.style.top = "0px";
            oDivFundo.style.left = "0px";
        }
        else {
            oDivFundo.className = "overlay";
            oDivFundo.innerHTML = '<div id="CreateHintBoxyDIVFundo" class="' + loaderClass + '"></div>';
        }

        window.document.body.appendChild(oDivFundo);
    }

    return $("#CreateHintBoxyDIVFundo");
}

Util.CreateBackground = function (bgID) {
    if (!$("#" + bgID).length) {
        var oDivFundo = window.document.createElement("div");
        oDivFundo.id = bgID;
        oDivFundo.style.filter = "Alpha(Opacity=40)";

        oDivFundo.style.opacity = "0.4";
        oDivFundo.style.backgroundColor = "#CCC";

        if (window.scrollMaxY == 0)
            oDivFundo.style.height = "100%";
        else
            oDivFundo.style.height = $(document).height() + 100 + "px";

        oDivFundo.style.width = "100%";
        oDivFundo.style.position = Util.IsOldNavigator() ? "absolute" : "fixed";
        oDivFundo.style.zIndex = "1900";
        oDivFundo.style.top = "0px";
        oDivFundo.style.left = "0px";

        window.document.body.appendChild(oDivFundo);
    }

    return $("#" + bgID);
}

Util.Block = Util.block = function (jqueryDom, urlLoader, toLeft, loaderClass, mid, percentTop, percentLeft, addHeight, jqueryDomToAppend) {

    var offset = jqueryDom.offset();
    var width = parseFloat(jqueryDom.width()) + parseFloat(jqueryDom.css('padding-left')) + parseFloat(jqueryDom.css('padding-right'));
    var height = jqueryDom.height();
    var top = offset.top;
    var left = offset.left;

    if (toLeft)
        left += toLeft;

    if (addHeight)
        height += addHeight;

    if ($('#block' + jqueryDom.selector.replaceAll('#', '').replaceAll('.', '').replaceAll('(', '').replaceAll(')', '').replaceAll(',', '').replaceAll(' ', '')).length)
        Util.BlockUpdate(jqueryDom);
    else {
        var block = $('<div>').css({
            width: width,
            height: height + 15,
            'min-height': height + 15,
            top: top,
            left: left,
            position: "absolute",
            'z-index': 2000,
            'background-color': '#ccc'
        }).attr('id', 'block' + jqueryDom.selector.replaceAll('#', '').replaceAll('.', '').replaceAll('(', '').replaceAll(')', '').replaceAll(',', '').replaceAll(' ', '')).addClass('loader');

        if (loaderClass)
            block.addClass(loaderClass);
        else
            block.addClass('loader');

        if (urlLoader) {
            var img = $('<img>').attr('src', urlLoader);
            if (mid) {
                var loaderMarginLeft = percentLeft;
                var loaderMarginTop = percentTop;
            }
            else {
                var loaderMarginLeft = ((width / 2) - img.width());
                var loaderMarginTop = 10;
            }

            var imgClass = '';

            if (!loaderClass) {
                img.css({ 'margin-left': loaderMarginLeft, 'margin-top': loaderMarginTop });
            }
            block.append(img);
        }

        if (toLeft)
            block.data('toleft', toLeft);

        if (jqueryDomToAppend) {
            jqueryDomToAppend.append(block);
            block.css({
                'height': jqueryDomToAppend.height(),
                'max-height': jqueryDomToAppend.height(),
            });
        }
        else {
            $('body').append(block);
        }

        if (!Util.IsIENavigator())
            block.fadeTo(1, 0.3);
        else
            block.show();

        jqueryDom.data('block', block.attr('id'));
        jqueryDom.customResize({
            interval: 10,
            func: function () {
                Util.BlockUpdate(jqueryDom);
            }
        });
        jqueryDom.top({
            interval: 100,
            func: function () {
                Util.BlockUpdate(jqueryDom);
            }
        });

        return block;
    }
}

Util.BlockModal = function (modal) {
    if (typeof modal != 'string') {
        var parent = modal.parent();
        var block = Util.Block(parent);
        if (block)
            block.attr('style', function (i, s) { return s + 'width: ' + parent.outerWidth() + 'px !important;height: ' + parent.outerHeight() + 'px !important;' });
    }
}

Util.UnblockModal = function (modal) {
    if (typeof modal != 'string') {
        var parent = modal.parent();
        Util.UnBlock(parent);
    }
}

Util.BlockUpdate = function (jqueryDom) {
    var block = $('#block' + jqueryDom.selector.replaceAll('#', '').replaceAll('.', '').replaceAll(' ', ''));
    var offset = jqueryDom.offset();
    var width = parseFloat(jqueryDom.width()) + parseFloat(jqueryDom.css('padding-left')) + parseFloat(jqueryDom.css('padding-right'));
    var height = jqueryDom.height();
    var top = offset.top;
    var left = offset.left;

    if (block.data('toleft'))
        left += block.data('toleft');

    jqueryDom.data('block', block.attr('id'));

    block.css({
        width: width,
        height: height + 15,
        top: top,
        left: left,
        display: jqueryDom.is(":visible") ? "block" : "none"
    });
}

function getValuesToOrder(element, selector, func) {
    var toOrder = [];
    $(selector, element).each(function () { toOrder.push(func($(this))) });
    return toOrder;
}

Util.getMin = function (element, selector, func) {
    var toOrder = getValuesToOrder(element, selector, func);
    var minimo = toOrder.orderBy()[0];
    return toOrder.indexOf(minimo);
}

Util.getMax = function (element, selector, func) {
    var toOrder = getValuesToOrder(element, selector, func);
    var maximo = toOrder.orderByDescending()[0];
    return toOrder.indexOf(maximo);
}

Util.UnBlock = Util.unblock = function (jqueryDomBlocked) {
    jqueryDomBlocked.top('destroy');
    jqueryDomBlocked.customResize('destroy');
    var idBlock = jqueryDomBlocked.data('block');
    $('#' + idBlock).remove();
}

Util.CreateStarsTypes = function (NumberOfStars) {

    var stars = ["silver", "silver", "silver", "silver", "silver"];
    var i = 0;
    for (i; i < NumberOfStars; i++)
        stars[i] = "gold";

    if (NumberOfStars < i)
        stars[i - 1] = "half";

    return stars;
};

Util.GetSetting = function (key) {
    var settings = (typeof Ide != 'undefined') && Ide.applicationSettings;

    settings = (typeof settings != 'undefined' && !$.isEmptyObject(settings) && settings) || (Global && Global.Settings);

    return typeof settings != 'undefined' && settings[key] || undefined;
};

Util.GetContextSetting = function (key) {
    var settings = Ide && Ide.companyContext && Ide.companyContext.Settings;

    return typeof settings != 'undefined' && settings[key] || undefined;
};

Util.CompareSettingValue = function (settingName, value) {
    return Util.GetSetting(settingName) == value;
};

Util.SelectComponent = function (component, context, onlyincontext) {
    if (component != undefined) {
        var toFind = '';

        if (component.jquery)
            toFind = component.selector.contains('parent') ? component : component.selector;
        else
            toFind = component;

        component = context ? $(toFind, context) : $(toFind);

        if (!onlyincontext) {
            if (context && component != null) {
                component = $(toFind);
            }
        }

        return component;
    }
};

Util.SelectComponents = function (components, context, onlyincontext) {
    for (var component in components) {
        if (component != "originalComponents") {
            if (component && components[component] != undefined && !jQuery.isArray(components[component])) {
                if (typeof components[component] == 'object' && !components[component].jquery)
                    Util.SelectComponents(components[component], context, onlyincontext);
                else {
                    var toFind = '';
                    if (components[component].jquery)
                        toFind = components[component].selector.contains('parent') ? components[component] : components[component].selector;
                    else
                        toFind = components[component];
                    components[component] = context ? $(toFind, context) : $(toFind);

                    if (!onlyincontext) {
                        if (context && (!components[component] || !components[component].length))
                            components[component] = $(toFind);
                    }
                }
            }
        }
    }
};

Util.GetShortIATA = function (str) {
    if (str) {
        str.toUpperCase();
        var indexOfSymbol;
        if (str.length == 3) {
            return str;
        }
        else if ((indexOfSymbol = str.lastIndexOf("(")) >= 0) {
            try {
                var StartPositionIata = indexOfSymbol;
                var EndPositionIata = str.lastIndexOf(")");
                return str.substring(StartPositionIata + 1, EndPositionIata);
            }
            catch (ex) {
                return "";
            }

        }
        else if ((indexOfSymbol = str.indexOf("--")) >= 0) {
            try {
                var StartPositionIata = indexOfSymbol;
                var EndPositionIata = str.lastIndexOf("--");
                return str.substring(StartPositionIata + 2, EndPositionIata - 1);
            }
            catch (ex) {
                return "";
            }

        }
        else if ((indexOfSymbol = str.indexOf("%28")) >= 0) {
            try {
                var StartPositionIata = indexOfSymbol;
                var EndPositionIata = str.indexOf("%29");
                return str.substring(StartPositionIata + 3, EndPositionIata);
            }
            catch (ex) {
                return "";
            }
        }
    }

    return str || "";
};

Util.GetTreatyTime = function (oTime, type) {

    type = type.toLowerCase();

    if (oTime != undefined && oTime != null && oTime != "") {
        var resp = undefined;

        if (isNaN(oTime)) {
            if (oTime.indexOf(":") >= 0) {
                oTime = oTime.split(":")[0];
            }
            else {
                oTime = oTime.toLowerCase();

                if (oTime == "madrugada" || oTime == "dawn")
                    resp = Util.GetTimeSetByPeriod(0, type);
                else if (oTime == "manhÃ£" || oTime == "morning")
                    resp = Util.GetTimeSetByPeriod(6, type);
                else if (oTime == "tarde" || oTime == "afternoon")
                    resp = Util.GetTimeSetByPeriod(12, type);
                else if (oTime == "noite" || oTime == "night")
                    resp = Util.GetTimeSetByPeriod(18, type);
                else if (oTime == "indifferent")
                    return 0;
            }
        }

        return resp == undefined ? Util.GetTimeSet(oTime, type) : resp;
    }

    return undefined;
};

Util.GetTimeSetByPeriod = function (startHour, type) {
    var resp = undefined;

    if (type == "start")
        resp = startHour;
    else if (type == "end")
        resp = startHour + 6;

    return resp;
};

Util.GetTimeSet = function (timeset, type) {
    if (timeset != undefined && timeset != null && !isNaN(timeset) && type) {

        timeset = parseInt(timeset);

        if (type == "start") timeset -= 1;
        else if (type == "end") timeset += 1;

        if (timeset < 0) timeset = 0;
        else if (timeset > 24) timeset = 24;
    }

    return timeset;
};

Util.GetPeriod = function (period) {
    period = period.toLowerCase();
    var ret = [];
    if (period == "dawn") {
        ret.push(0);
        ret.push(6);
    }
    else if (period == "morning") {
        ret.push(6);
        ret.push(12);
    }
    else if (period == "afternoon") {
        ret.push(12);
        ret.push(18);
    }
    else if (period == "night") {
        ret.push(18);
        ret.push(0);
    }

    return ret;
}

Util.GetPeriodByTime = function (time) {
    var ret = '';
    if (time[0] == 0 && time[1] == 6) {
        ret = 'dawn';
    }
    else if (time[0] == 6 && time[1] == 12) {
        ret = "morning";
    }
    else if (time[0] == 12 && time[1] == 18) {
        ret = "afternoon"
    }
    else if (time[0] == 18 && time[1] == 0) {
        ret = 'night';
    }

    return ret;
}

Util.SetSeparatedRooms = function (hotel) {
    hotel.SeparatedRooms = [];

    if (hotel.Rooms) {
        var groupKeys = hotel.Rooms.select(function (r) { return r.GroupKey; }).distinct();

        for (var i = 0; i < groupKeys.length; i++)
            hotel.SeparatedRooms.push(hotel.Rooms.where(function (r) { return r.GroupKey == groupKeys[i] }));

        var sortSeparatedRooms = function (room1, room2) {
            var result = 0;
            var option1 = room1.SelectedRoomOption;
            var option2 = room2.SelectedRoomOption;


            if (option1.TotalAmount > option2.TotalAmount || option1.PromoDisplayDailyPoints > option2.PromoDisplayDailyPoints)
                result = 1;
            else if (option1.TotalAmount < room2.SelectedRoomOption.TotalAmount || option1.PromoDisplayDailyPoints < option2.PromoDisplayDailyPoints)
                result = -1;

            return result;
        }

        for (var i = 0; i < hotel.SeparatedRooms.length; i++)
            hotel.SeparatedRooms[i].sort(sortSeparatedRooms);

        if (hotel.SeparatedRooms.length != groupKeys.length && console)
            console.log("O hotel " + hotel.Name + " nÃ£o estÃ¡ com os quartos separados corretamente!");
    }
};


Util.prepareRenderSearchPackageParameters = function (searchParameters) {

    searchParameters.Package.RoomsRequest = [];

    searchParameters.Package.PackageRoomsRequest.forEach(function (r) {

        var roomRequest = Util.prepareRoomRequestAges(r);
        searchParameters.Package.RoomsRequest.push(roomRequest);
    });

    searchParameters.Package.OriginFormatted = searchParameters.Package.OriginData.Name;
    searchParameters.Package.DestinationFormatted = searchParameters.Package.PackageDestination.PackageDestinationData.Name;
    searchParameters.Package.OutboundFormatted =
        Util.StringFormat("{0}/{1}", formatter.monthName(searchParameters.Package.BeginDepartureDateTime.Month), searchParameters.Package.BeginDepartureDateTime.Year);
};

Util.prepareRoomRequestAges = function (r) {

    var roomRequest = {
        Adults: 0,
        ChildAges: []
    };

    var totalChildren = 0;
    var totalInfants = 0;
    r.PassengersAges.forEach(function (a) {
        if (a >= 18)
            roomRequest.Adults++
        else {
            roomRequest.ChildAges.push(a);
            if (a > 2) totalChildren++;
            else totalInfants++;
        }
    });

    r.QtdeChild = totalChildren;
    r.QtdeBaby = totalInfants;

    return roomRequest;
};


Util.prepareRenderSearchPackageParameters = function (searchParameters) {

    searchParameters.Package.RoomsRequest = [];

    searchParameters.Package.PackageRoomsRequest.forEach(function (r) {

        var roomRequest = Util.prepareRoomRequestAges(r);
        searchParameters.Package.RoomsRequest.push(roomRequest);
    });

    searchParameters.Package.OriginFormatted = searchParameters.Package.OriginData.Name;
    searchParameters.Package.DestinationFormatted = searchParameters.Package.PackageDestination.PackageDestinationData.Name;
    searchParameters.Package.OutboundFormatted =
        Util.StringFormat("{0}/{1}", formatter.monthName(searchParameters.Package.BeginDepartureDateTime.Month), searchParameters.Package.BeginDepartureDateTime.Year);
};

Util.prepareRoomRequestAges = function (r) {

    var roomRequest = {
        Adults: 0,
        ChildAges: []
    };

    var totalChildren = 0;
    var totalInfants = 0;
    r.PassengersAges.forEach(function (a) {
        if (a >= 18)
            roomRequest.Adults++
        else {
            roomRequest.ChildAges.push(a);
            if (a > 2) totalChildren++;
            else totalInfants++;
        }
    });

    r.QtdeChild = totalChildren;
    r.QtdeBaby = totalInfants;

    return roomRequest;
};

Util.ParseAddress = function (address) {
    var resp = "";

    if (address) {
        resp = address.Street;
        resp += address.Number ? ", " + address.Number : "";
        resp += address.Complement ? " - " + address.Complement : "";
        resp += address.PostalCode ? " - " + address.PostalCode : "";
        resp += address.City ? " - " + address.City : "";
        resp += address.District ? " - " + address.District : "";
        resp += address.Country ? " - " + address.Country : "";
    }

    return resp;
};

Util.ForceMaskDate = function (sender) {

    var ctrl = $(this);

    var value = ctrl.val().trim().replaceAll("/", "").replaceAll("_");

    iKey = sender.keyCode;

    var strDia = "", strMes = "";

    if (value.length > 0 && ((iKey >= 48 && iKey <= 57) || (iKey >= 96 && iKey <= 105))) {
        mask = '';
        if (value.length > 0 && value.length <= 2) {
            mask = value;
            if (value.length == 2) {
                if (parseFloat(value.substring(0, 2)) > 31) {
                    mask = '31';
                }
            }
        }
        if (value.length > 2 && value.length <= 4) {
            if (parseFloat(value.substring(0, 2)) > 31) { strDia = '31' }

            else { strDia = value.substring(0, 2) }

            if (value.length == 4) {
                var valueSubString = value.substring(2, 4);
                if (parseFloat(valueSubString) > 12) {
                    strMes = '12'
                }
                else {
                    strMes = valueSubString
                }
            }
            else {
                strMes = value.substring(2, 4);
            }
            mask = mask + strDia + '/' + strMes;
        }
        if (value.length > 4) {
            if (parseFloat(value.substring(0, 2)) > 31) { strDia = '31' }

            else { strDia = value.substring(0, 2) }

            if (value.length > 4) {
                if (parseFloat(value.substring(2, 4)) > 12) { strMes = '12' }

                else { strMes = value.substring(2, 4) }
            }
            else {
                strMes = value.substring(2, 4);
            }
            mask = mask + strDia + '/' + strMes + '/' + value.substring(4, 8);
        }

        ctrl.val(mask);
    }
}

Util.ForceMaskTime = function (sender) {

    var ctrl = $(this);

    var req = ctrl.val().trim();

    hrs = (req.substring(0, 2));
    min = (req.substring(3, 5));

    if (parseFloat(hrs) > 23) {
        hrs = '00';
    }

    if (parseFloat(min) > 59) {
        min = '00';
    }
    mask = '';
    mask = hrs + ":" + min;

    if (mask != req)
        ctrl.val(mask);
}

Util.Sources = {
    'None': 0,
    'Amadeus': 1,
    'Sabre': 2,
    'Tam': 3,
    'Gol': 4,
    'Team': 5,
    'Avianca': 6,
    'WebJet': 7,
    'Total': 8,
    'Trip': 9,
    'Passaredo': 10,
    'AirMinas': 11,
    'TAF': 12,
    'Rico': 13,
    'Sete': 14,
    'NHT': 15,
    'Pantanal': 16,
    'AeroStar': 17,
    'Azul': 18,
    'Sol': 19,
    'H2W': 20,
    'Tourico': 21,
    'Travel': 22,
    'Trend': 23,
    'Puma': 24,
    'HotelBeds': 25,
    'Services': 26,
    'Fake': 27,
    'CMNet': 30,
    'HotelOffline': 32,
    'Asta': 36,
    'T4W': 37,
    'ExpediaHotel': 38,
    'Juniper': 39,
    'HBSi': 40,
    'CTNTours': 41,
    'AviancaAmadeus': 42,
    'AmericanAirlines': 43,
    'GTA': 44,
    'TravelAce': 45,
    'MikiTravel': 46,
    'Bonotel': 47,
    'MarkTravel': 48,
    'Galileo': 49,
    'Charter': 50,
    'Travelport': 51,
    'OmnibeesHoteisNet': 52,
    'MAP': 53,
    'B2B': 54,
    'ReservaFacil': 55,
    'GuestCentric': 56,
    'Kiu': 57,
    'Ifaseg': 58,
    'Latam': 59,
    'Royal': 60,
    'AssistCard': 61,
    'Chameleon': 62,
    'GTAInsurance': 64,
    'TZSystems': 65,
    'CruiseCharter': 66,
    'EHTL': 67,
    'EzLink': 68,
    'Movida': 69,    
    'ItineraryManager': 71,
    'SabreCSL': 72,
    'Itapemirim': 75,
    'GolGWS': 76,
    'Mobility': 73,
    'Omint': 74,
    'Copa': 77,
    'Eucatur': 78,
    'Iberia': 79,
    '0': 'None',
    '1': 'Amadeus',
    '2': 'Sabre',
    '3': 'Tam',
    '4': 'Gol',
    '5': 'Team',
    '6': 'Avianca',
    '7': 'WebJet',
    '8': 'Total',
    '9': 'Trip',
    '10': 'Passaredo',
    '11': 'AirMinas',
    '12': 'TAF',
    '13': 'Rico',
    '14': 'Sete',
    '15': 'NHT',
    '16': 'Pantanal',
    '17': 'AeroStar',
    '18': 'Azul',
    '19': 'Sol',
    '20': 'H2W',
    '21': 'Tourico',
    '22': 'Travel',
    '23': 'Trend',
    '24': 'Puma',
    '25': 'HotelBeds',
    '26': 'Services',
    '27': 'Fake',
    '30': 'CMNet',
    '32': 'HotelOffline',
    '36': 'Asta',
    '37': 'T4W',
    '38': 'ExpediaHotel',
    '39': 'Juniper',
    '40': 'HBSi',
    '41': 'CTNTours',
    '42': 'AviancaAmadeus',
    '43': 'AmericanAirlines',
    '44': 'GTA',
    '45': 'TravelAce',
    '46': 'MikiTravel',
    '47': 'Bonotel',
    '48': 'MarkTravel',
    '49': 'Galileo',
    '50': 'Charter',
    '51': 'Travelport',
    '52': 'OmnibeesHoteisNet',
    '53': 'MAP',
    '54': 'B2B',
    '55': 'ReservaFacil',
    '56': 'GuestCentric',
    '57': 'Kiu',
    '58': 'Ifaseg',
    '59': 'Latam',
    '60': 'Royal',
    '61': 'AssistCard',
    '62': 'Chameleon',
    '64': 'GTAInsurance',
    '65': 'TZSystems',
    '66': 'CruiseCharter',
    '67': 'EHTL',
    '68': 'EzLink',
    '69': 'Movida',
    '71': 'ItineraryManager',
    '72': 'SabreCSL',
    '73': 'Mobility',
    '74': 'Omint',
    '75': 'Itapemirim',
    '76': 'GolGWS',
    '73': 'Mobility',
    '77': 'Copa',
    '78': 'Eucatur',
    '79': 'Iberia'
};

Util.AirSourcesIds = [1, 2, 3, 4, 10, 18, 42, 43, 50, 49, 53, 59, 77];
Util.HotelSourcesIds = [2, 21, 22, 23, 25, 30, 32, 38, 39, 40, 41, 44, 46, 47, 48, 72];

Util.AirSources = {};

Util.HotelSources = {};


Util.mountSources = function (ids, obj) {
    if (ids) {
        for (var item in Util.Sources) {
            if (!isNaN(item) && ids.any(item)) {
                obj[item] = Util.Sources[item];
                obj[Util.Sources[item]] = item;
            }
        }
    }
};

Util.mountSources(Util.AirSourcesIds, Util.AirSources);
Util.mountSources(Util.HotelSourcesIds, Util.HotelSources);

Util.SeatProperties = {
    Smoking: 0,
    Infant: 1,
    Oxygen: 2,
    LegRoom: 3,
    Engine: 4,
    Disability: 5,
    NearLavatory: 6,
    PayableSeat: 7,
    "0": "Smoking",
    "1": "Infant",
    "2": "Oxygen",
    "3": "LegRoom",
    "4": "Engine",
    "5": "Disability",
    "6": "NearLavatory",
    "7": "PayableSeat"
};

Util.SeatPositionType = {
    Front: 0,
    Middle: 1,
    Back: 2,
    NoPreference: 3,
    "0": "Frente",
    "1": "Meio",
    "2": "Traseira",
    "3": "Sem preferÃªncia"
};

Util.SeatRowProperty = {
    Wing: 0,
    RightExit: 1,
    LeftExit: 2,
    Exit: 3,
    Undefined: 4,
    "0": "Wing",
    "1": "RightExit",
    "2": "LeftExit",
    "3": "Exit",
    "4": "Undefined"
};

var passengerTypes = {
    0: {
        "pt-br": "Adulto",
        "es-ar": "Adulto",
        "es-mx": "Adulto"
    },
    1: {
        "pt-br": "CrianÃ§a",
        "es-ar": "CrianÃ§a",
        "es-mx": "CrianÃ§a"
    },
    2: {
        "pt-br": "BebÃª",
        "es-ar": "BebÃª",
        "es-mx": "BebÃª"
    }
};

var genders = {
    0: {
        "pt-br": "Masculino",
        "es-ar": "Masculino",
        "es-mx": "Masculino"
    },
    1: {
        "pt-br": "Feminino",
        "es-ar": "Femenino",
        "es-mx": "Femenino"
    }
};

Util.GenderResolver = function (gender) {
    if (!genders[gender])
        gender = 0;

    return genders[gender][formatter ? formatter.culture : "pt-br"];
};

Util.PassengerTypeResolver = function (paxType) {
    if (!passengerTypes[paxType])
        paxType = 0;

    return passengerTypes[paxType][formatter ? formatter.culture : "pt-br"];
};

var equipmentTypes = {
    0: {
        "pt-br": "",
        "es-ar": "",
        "es-mx": "",
        "en-us": ""
    },
    1: {
        "pt-br": "Ã´nibus",
        "es-ar": "Onibus",
        "es-mx": "Onibus"
    },
    2: {
        "pt-br": "Trem",
        "es-ar": "Trem",
        "es-mx": "Trem"
    },
    3: {
        "pt-br": "Carro",
        "es-ar": "Carro",
        "es-mx": "Carro"
    },
    4: {
        "pt-br": "CaminhÃ£o",
        "es-ar": "CaminhÃ£o",
        "es-mx": "CaminhÃ£o"
    },
    5: {
        "pt-br": "Barco",
        "es-ar": "Barco",
        "es-mx": "Barco"
    },
    6: {
        "pt-br": "HelicÃ³ptero",
        "es-ar": "Helicoptero",
        "es-mx": "Helicoptero"
    }
};

Util.EquipmentResolver = function (Type) {
    if (!equipmentTypes[Type]) Type = 0;
    var equipment = equipmentTypes[Type][formatter ? formatter.culture : "pt-br"];
    return (equipment) ? equipment : "";
};

Util.stringformat = function (format) {
    var s = format;
    if (s) {
        for (var i = 0; i < arguments.length - 1; i++) {
            var reg = new RegExp("\\{" + i + "\\}", "gm");
            s = s.replace(reg, arguments[i + 1]);
        }
    }

    return s;
}

Util.memoizedSerializedTypesDefinitions = {};

Util.getSerializedTypesDefinitions = function (namesArr, callback) {

    if (!Util.memoizedSerializedTypesDefinitions[namesArr[0]]) {
        $.ajax({
            url: Global.SerializedTypesDefinitionsPath + "?assemblyName={0}&fullTypeName={1}".format([namesArr[0], namesArr[1]]),
            success: function (res) {
                Util.memoizedSerializedTypesDefinitions[namesArr[0]] = JSON.parse(res);
                callback(Util.memoizedSerializedTypesDefinitions[namesArr[0]]);
            }
        });
    }
    else {
        callback(Util.memoizedSerializedTypesDefinitions[namesArr[0]]);
    }
};

Util.MinimumJSONDeserialize = function (serializedObj, callback) {

    if (callback) {
        if ($.isArray(serializedObj) && serializedObj.length == 2 && callback) {

            var getObject = function (value, currentType, types) {
                if (!currentType || value == undefined)
                    return value;

                var obj = undefined;

                if (currentType.d || currentType.e) {

                    obj = [];

                    if (typeof (currentType.i) === "undefined")
                        currentType.i = -1;

                    var innerType = types[currentType.i];

                    if (currentType.d) {
                        for (var i = 0; i < value.length; i += 2)
                            obj.push({ Key: value[i], Value: getObject(value[i + 1], innerType, types) });
                    }
                    else {
                        for (var i = 0; i < value.length; i++)
                            obj.push(getObject(value[i], innerType, types));
                    }
                }
                else {
                    obj = {};

                    if (currentType.p)
                        for (var i = 0; i < currentType.p.length; i++) {
                            if (typeof (currentType.p[i].i) === 'undefined')
                                currentType.p[i].i = -1;

                            obj[currentType.p[i].n] = getObject(value[i], types[currentType.p[i].i], types);
                        }
                }

                return obj;
            };

            Util.getSerializedTypesDefinitions(serializedObj[0], function (serializedTypes) {
                callback(getObject(serializedObj[1], serializedTypes[0], serializedTypes));
            });
        }
        else {
            callback(serializedObj);
        }
    }
    else {
        return serializedObj;
    }
};

Util.isNumber = function (o) {
    return typeof o == "number";
};

Util.isInteger = function (o) {
    return Util.isNumber(o) && (o % 1 == 0);
};

Util.isValidNumber = function (n) {
    var isValid = !isNaN(parseFloat(n)) && isFinite(n);

    if (!isValid && n != undefined && typeof n === 'string') {
        var candidate = n.replace(',', ".");

        isValid = !isNaN(parseFloat(candidate)) && isFinite(candidate);
    }

    return isValid;
}

Util.isString = function (o) {
    return typeof o == "string";
};

Util.isNotNullOrWhiteSpace = function (o) {
    if (o != undefined && Util.isString(o)) {
        var trimmedString = o.trim();

        if (trimmedString.length > 0) {
            return trimmedString.replace(' ', '').length > 0;
        }
    }

    return false;
};

Util.isDate = function (o) {
    return o.getDay && typeof o.getDay == "function";
};

Util.isDateRegExp = function (date) {
    var dateDetector = new RegExp(/^(((0[1-9]|[12]\d|3[01])\/(0[13578]|1[02])\/((19|[2-9]\d)\d{2}))|((0[1-9]|[12]\d|30)\/(0[13456789]|1[012])\/((19|[2-9]\d)\d{2}))|((0[1-9]|1\d|2[0-8])\/02\/((19|[2-9]\d)\d{2}))|(29\/02\/((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))))$/);
    return dateDetector.test(date);
}

Util.isBool = function (o) {
    return typeof o == "boolean";
};

Util.isEmail = function (Email) {
    var emailDetector = new RegExp(/^[\d\w_.+-]+@([\d\w_-]+\.){1,}[\w\d]+$/);
    return emailDetector.test(Email);
}

Util.isDateValues = function (o) {
    return o != undefined && o.Day != undefined && o.Month != undefined && o.Year != undefined;
};

Util.isFunction = function (o) {
    return typeof o == "function";
};

//Valida hora no formato HH:MM
Util.isValidTime = function (timeStr) {
    return (timeStr.search(/^\d{2}:\d{2}$/) != -1)
        && (timeStr.substr(0, 2) >= 0 && timeStr.substr(0, 2) <= 24)
        && (timeStr.substr(3, 2) >= 0 && timeStr.substr(3, 2) <= 59);
};

Util.validateCreditCard = function (number, expirationDate, provider) {
    return true;
}

Util.QueryString = function (Key, QueryString, Index) {
    if (!Index) Index = 0;

    var Element = "";
    if (QueryString && QueryString.indexOf('?') > -1) {
        var interr = QueryString.indexOf('?');
        QueryString = QueryString.substr(interr);
    }

    var arrURI = (QueryString ? QueryString : window.location.search).substring(1).split("&");

    Key = Key.toLowerCase();

    for (var i = 0, leng = arrURI.length; i < leng; i++) {
        Element = arrURI[i].split("=");
        if (Element[0].toLowerCase() == Key) {
            if (Index == 0)
                return Element[1];
            else
                Index--;
        }
    }
}

Util.RemoveQueryStringParameter = function (url, key) {
    var urlparts = url.split('?');
    if (urlparts.length >= 2) {

        var prefix = encodeURIComponent(key) + '=';
        var pars = urlparts[1].split(/[&;]/g);

        for (var i = pars.length; i-- > 0;) {
            if (pars[i].lastIndexOf(prefix, 0) !== -1) {
                pars.splice(i, 1);
            }
        }

        url = urlparts[0] + '?' + pars.join('&');
        return url;
    } else {
        return url;
    }
}

Util.QueryStringToObject = function (urlParams) {
    var finalObj = {};
    var propsWithValues = urlParams.split('&');
    if (propsWithValues) {
        for (var i = 0; i < propsWithValues.length; i++) {
            var propWithValue = propsWithValues[i];
            var propAndValue = propWithValue.split('=');

            var propName = propAndValue.first();
            var propVal = propAndValue.last();

            if (propName.startsWith('?'))
                propName = propName.substring(1);

            finalObj[propName] = propVal;
        }
    }

    return finalObj;
}

Util.getServiceTypeKey = function (serviceTypeId) {
    var key = '';
    EnumHelper.ServiceDefinition.Identifier.forEach(function (st) {
        var atualKey = st.Key;
        st.Value.Subcategories.forEach(function (stv) {
            if (typeof (serviceTypeId) == "number" && stv.Value.Id == serviceTypeId) {
                atualKey += stv.Key;
            }
            else if (stv.Value == serviceTypeId) {
                atualKey += stv.Key;
            }
        });

        if (atualKey != st.Key) {
            key = atualKey;
        }
    });

    return key;
}

Util.getServiceTypeClass = function (serviceTypeId) {
    var key = Util.getServiceTypeKey(serviceTypeId);
    switch (key) {
        case 'ServiceOrder':
            return 'service_order';
        case 'AirOrder':
            return 'ordering_air';
        case 'HotelOrder':
            return 'ordering_hotel';
        case 'CarOrder':
            return 'ordering_car';
        case 'AirBook':
            return 'reserve_air';
        case 'HotelBook':
            return 'reserve_hotel';
        case 'CarBook':
            return 'reserve_car';
        case 'AirIssue':
            return 'ticketing';
        case 'OtherInsurance':
            return 'insurance';
        case 'ReimbursementRequest':
            return 'refund';
        case 'AdvancedRequest':
            return 'advance';
        case 'RefundRequest':
            return 'refund';
        case 'OtherGroup':
            return 'group';
        default:
            return key;
    }
}

Util.RetiraAcentos = function (word, doNotUpperCase) {
    var Acentos = "Ã¡Ã Ã£Ã¢Ã¢ÃÃÃÃÃ©ÃªÃÃÃ­ÃÃ³ÃµÃ´ÃÃÃÃºÃ¼ÃÃÃ§Ã";
    var Traducao = "aaaaaAAAAeeEEiIoooOOOuuUUcC";
    var Posic, Carac;
    var TempLog = "";
    var value = (doNotUpperCase) ? word : word.toUpperCase();

    for (var i = 0, len = word.length; i < len; i++) {

        Carac = value.charAt(i);
        Posic = Acentos.indexOf(Carac);

        if (Posic > -1)
            TempLog += Traducao.charAt(Posic);
        else
            TempLog += Carac;
    }

    return TempLog;
}

Util.NormalizeString = function (str) {
    if (str === 'undefined') {
        return str;
    }

    if (typeof str.normalize !== undefined) {
        return str.normalize('NFD');
    }
}

Util.NormalizedEquals = function (str1, str2) {
    if (str1 === 'undefined' || str2 === 'undefined') {
        return false;
    }

    var normalizedStr1 = Util.NormalizeString(str1);
    var normalizedStr2 = Util.NormalizeString(str2);

    return normalizedStr1.trim().toLowerCase() === normalizedStr2.trim().toLowerCase();
}

$(document).on('blur', '.have-placeholder', function (e) {
    if (this.value == "") {
        this.value = this.defaultValue;
    }
});

$(document).on('focus', '.have-placeholder', function (e) {
    if (this.value == this.defaultValue) {
        this.value = '';
    }
});

Util.keys = {
    BACKSPACE: 8,
    TAB: 9,
    ENTER: 13,
    SHIFT: 16,
    ESC: 27,
    PAGEUP: 33,
    PAGEDOWN: 34,
    END: 35,
    HOME: 36,
    LEFT: 37,
    UP: 38,
    RIGHT: 39,
    DOWN: 40
}

var ignoredKeysToCheck = [Util.keys.BACKSPACE, Util.keys.ENTER, Util.keys.SHIFT, Util.keys.ESC, Util.keys.PAGEUP, Util.keys.PAGEDOWN, Util.keys.END, Util.keys.END, Util.keys.HOME, Util.keys.LEFT, Util.keys.RIGHT, Util.keys.UP, Util.keys.DOWN];
$(document).on('blur keyup', '.just-letters', function (e) {
    if (e.keyCode && !ignoredKeysToCheck.any(e.keyCode)) {
        var ctrl = $(this);
        ctrl.val(ctrl.val().removeDiacritics().replace(/[^a-zA-Z ]+/g, ''));
    }
});

$(document).on('keyup', '.just-letters-for-locations', function (e) {
    if (!e.ctrlKey) {
        var ctrl = $(this);

        if (!ctrl.locationsFinder("getData")) {
            if (![37, 39, 9, 13, 40, 38, 35, 36, 33, 34, 32, 16, 17].any(e.keyCode)) {
                ctrl.val(ctrl.val().removeDiacritics().replace(/[^a-zA-Z ]+/g, ''));
            }
        }
    }
});

$(document).on('blur keyup', '.only-numbers', function (e) {
    if (e.keyCode && !ignoredKeysToCheck.any(e.keyCode)) {
        var ctrl = $(this);

        if (ctrl.hasClass("phone-prefix-mask")) {
            ctrl.val(ctrl.val().replace(/[^0-9]+(_)/g, ''));
        }
        else {
            ctrl.val(ctrl.val().replace(/[^0-9]+/g, ''));
        }
    }
});

$(document).on('blur keyup', '.only-floatNumbers', function (e) {
    if (e.keyCode && !ignoredKeysToCheck.any(e.keyCode)) {
        var ctrl = $(this);
        $(this).val(ctrl.val().replace(/[^0-9.,]+/g, ''));
    }
});

Util.adjustDate = function () {
    var ctrl = $(this);
    var valor = ctrl.val().trim().replaceAll("/");

    iDia = 0;
    iMes = 0;
    iAno = 0;
    mask = '';
    var today = new Date();
    var today_year = today.getFullYear();
    var today_mes = today.getMonth();
    var today_dia = today.getDay();
    if (valor.length != 0) {
        if (valor.length >= 1) {
            iDia = parseFloat(valor.substring(0, 2));
            if (iDia < 01) { iDia = 01 }
            if (iDia > 31) { iDia = 31 }
        }
        else {
            iDia = today_dia;
        }
        if (valor.length >= 3) {
            iMes = parseFloat(valor.substring(2, 4));
            if (iMes < 01) { iMes = 01 }
            if (iMes > 12) { iMes = 12 }
        }
        else {
            iMes = today_mes + 1;
        }
        if (valor.length > 4) {
            iAno = parseFloat(valor.substring(4, 8));
            if (iAno < 100) { iAno = iAno + 2000 }
        }
        else {
            iAno = today_year;
        }
        if (iAno < 1500 || iAno > 2500)
            iAno = today_year;
        ctrl.val("");
        //
        //Validacao de dias por mes
        //
        if (iMes == 4 && iDia > 30) { iDia = 30 }
        if (iMes == 6 && iDia > 30) { iDia = 30 }
        if (iMes == 9 && iDia > 30) { iDia = 30 }
        if (iMes == 11 && iDia > 30) { iDia = 30 }
        if (iMes == 2 && iDia > 29) { iDia = 29 }
        //
        //Bissexto
        //
        if (iMes == 2 && iDia >= 28) {
            iBiSexto = iAno / 4;
            iDia = iBiSexto.toString().length == 3 ? 29 : 28;
        }
        //
        //Dia
        //
        var iDiaToString = iDia.toString();
        ctrl.val(ctrl.val() + (iDiaToString.length < 2 ? '0' : '') + iDiaToString + '/');
        //
        //Mes e Ano
        //
        var iMesToString = iMes.toString();
        ctrl.val(ctrl.val() + (iMesToString.length < 2 ? '0' : '') + iMesToString + '/' + iAno.toString());
    }
}

Util.UpdateTips = function (t, tipComponent) {
    $(".validateTips", component).text("");
    if (tipComponent != undefined) {
        if (t != undefined && t.length > 0) {
            $(".ui-state-highlight", component).removeClass("ui-state-highlight");
            tipComponent.text(t).addClass("ui-state-highlight");
        }
        else
            $(".ui-state-highlight", component).removeClass("ui-state-highlight");
    }
}

Util.CheckLength = function (component, componentName, min, max, tipComponent) {
    if (min > 0 && max > 0) {
        if (component.val().length > max || component.val().length < min) {
            component.addClass("ui-state-error");
            component.focus();

            Util.UpdateTips("Tamanho do " + componentName + " deve estar entre " + min + " e " + max + ".", tipComponent);
            return false;
        }
        else {
            Util.UpdateTips("", tipComponent);
            return true;
        }
    }
    else {
        Util.UpdateTips("", tipComponent);
        return true;
    }
}

Util.CheckRegexp = function (component, regexp, n, tipComponent) {
    if (regexp != undefined) {
        if (!(regexp.test(component.val()))) {
            component.addClass("ui-state-error");
            Util.UpdateTips(n, tipComponent);
            return false;
        }
        else {
            return true;
        }
    }
    else
        return true;
}

Util.MountTree = function (objects, primaryField, foreignField, childListField, rootId) {
    var items = [];

    if (!rootId) {
        objects.forEach(function (item) {
            item.AuxForeignValue = typeof foreignField == "function" ? foreignField(item) : item[foreignField];

            if (!item[childListField])
                item[childListField] = [];

            if (!item.AuxForeignValue || !objects.any(function (obj) { return item.AuxForeignValue == obj[primaryField]; }))
                items.push(item);
        });

        items.forEach(function (item) {
            var childs = Util.MountTree(objects, primaryField, foreignField, childListField, item[primaryField]);

            for (var i = 0; i < childs.length; i++) {
                if (!item[childListField].any(function (current) { return current[primaryField] == childs[i][primaryField] }))
                    item[childListField].push(childs[i]);
            }

        });

    } else {
        objects.forEach(function (item) {
            if (!item.AuxForeignValue && rootId != item[primaryField])
                item.AuxForeignValue = typeof foreignField == "function" ? foreignField(item) : item[foreignField];
            if (!item[childListField])
                item[childListField] = [];

            if (rootId != item[primaryField] && rootId == item.AuxForeignValue) {
                var childs = Util.MountTree(objects, primaryField, foreignField, childListField, item[primaryField]);

                for (var i = 0; i < childs.length; i++) {
                    if (!item[childListField].any(function (current) { return current[primaryField] == childs[i][primaryField] }))
                        item[childListField].push(childs[i]);
                }
                items.push(item);
            }
        });
    }

    if (items.length > 0) {
        Util.CheckLengthForGroupPnr(items, foreignField, childListField);
    }

    return items;
}

Util.CheckLengthForGroupPnr = function (roots, foreignField, childListField) {
    for (var i = 0; i < roots.length; i++) {
        if (roots[i][childListField] && Util.LengthEnoughForGroupPnr(roots[i][childListField].length))
            roots[i].LengthEnoughForGroupPnr = true;
    }
}

Util.ProfileEntityType = {
    UserProfile: 0,
    UserProfile_Policies: 1,
    UserProfile_Company: 2,
    UserProfile_Agency: 3,
    UserProfile_Preferences: 4,
    UserProfile_SSR: 5,
    UserProfile_MembershipCards: 6,
    UserProfile_Passports: 7,
    UserProfile_Visas: 8,
    UserProfile_Vacines: 9,
    UserProfile_BankingDetails: 10,
    Warehouse_LastRequests: 11,
    UserSettings: 12,
    CreditCard: 13
}

Util.CreditCardProvider = {
    4: "MasterCard",
    1: "Visa",
    "MC": "MasterCard",
    "VI": "Visa",
    "AX": "Amex"
}

Util.CreditCardType = {
    0: "CartÃ£o Corporativo",
    1: "EBTA",
    2: "CTA",
    3: "VIRCC",
    4: "CFC"
}

Util.SeatPreference = {
    NoPrefrence: 0,
    Corridor: 1,
    Window: 2,
    Center: 3
}

Util.SeatPosition = {
    NoPreference: 0,
    Front: 1,
    Middle: 2,
    Back: 3
}

Util.setCookieWithExpire = function (name, value, expires, considerDomain, removeBlankPath) {
    cookie = name + "=" + value + expires;

    if (considerDomain == undefined || considerDomain)
        cookie += "; domain=" + document.domain;

    if (removeBlankPath == undefined || !removeBlankPath)
        cookie += "; path=/";

    document.cookie = cookie;
}

Util.setCookie = function (name, value, days, considerDomain, removeBlankPath) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        var expires = "; expires=" + date.toGMTString();
    }
    else var expires = "";

    Util.setCookieWithExpire(name, value, expires, considerDomain, removeBlankPath);
}

Util.setCookieWithSeconds = function (name, value, seconds, considerDomain, removeBlankPath) {
    if (seconds) {
        var date = new Date();
        date.setTime(date.getTime() + (seconds * 1000));
        var expires = "; expires=" + date.toGMTString();
    }
    else var expires = "";

    Util.setCookieWithExpire(name, value, expires, considerDomain, removeBlankPath);
}

Util.setCookieJSON = function (obj) {
    var cookie = { name: '', value: '', expires: '', domain: '', path: '' };

    if (typeof (obj) === 'object') {
        cookie.name = obj.name;
        cookie.value = obj.value;

        if (obj.days) {
            var date = new Date();
            date.setTime(date.getTime() + (obj.days * 24 * 60 * 60 * 1000));
            cookie.expires = "; expires=" + date.toGMTString();
        }

        if (obj.considerDomain == undefined || (typeof (obj.considerDomain) === 'boolean' && obj.considerDomain)) {
            cookie.domain = "; domain=" + document.domain;
        }

        if (obj.path) {
            cookie.path = "; path=" + obj.path;
        } else {
            cookie.path = "; path=/";
        }

        document.cookie = _toString(cookie);

        function _toString(cookie) {
            return cookie.name + "=" + cookie.value + cookie.expires + cookie.domain + cookie.path;
        }
    }
}

Util.getDecodeUriJSONCookie = function (name) {
    var value = Util.getDecodeUriCookie(name);


    try {
        return JSON.parse(value);
    } catch (e) {
        return value;
    }

}

Util.getCookie = function (name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
}

Util.getDecodeUriCookie = function (name) {
    var cookie = Util.getCookie(name);

    try {
        cookie = decodeURIComponent(cookie);
    }
    catch (ex) {
        if (typeof console != "undefined") {
            console.log("Erro ao decodificar o cookie '" + name + "'");
            console.log(ex);
        }
    }

    return cookie;
}

Util.removeCookie = function (name, considerDomain, removeBlankPath) {
    Util.setCookie(name, "", -10, considerDomain, removeBlankPath)
}

Util.removeCookieJSON = function (obj) {
    if (typeof (obj) === 'object') {
        obj.days = -10;
        Util.setCookieJSON(obj);
    }
}

function GetRabbitEncryptedString(input) {

    // ** utiliza biblioteca http://crypto-js.googlecode.com/files/2.5.3-crypto-sha1-hmac-pbkdf2-rabbit.js
    // ** referÃªncia: http://code.google.com/p/crypto-js/

    var aux = Crypto.Rabbit.encrypt(input, "b00gnish");
    while (aux.indexOf("+") != -1 || aux.indexOf("/") != -1) {
        aux = Crypto.Rabbit.encrypt(input, "b00gnish");
    }

    return aux;
}

function GetRabbitDecryptedString(input) {

    // ** utiliza biblioteca http://crypto-js.googlecode.com/files/2.5.3-crypto-sha1-hmac-pbkdf2-rabbit.js
    // ** referÃªncia: http://code.google.com/p/crypto-js/

    return Crypto.Rabbit.decrypt(input, "b00gnish");
}

/*********FunÃ§Ãµes recÃ©m incluidas*****/
function MascaraCPF_CNPJ(inputCPF_CNPJ, event) {
    if (inputCPF_CNPJ.value.length > 14)
        return fnMascaraCNPJ(inputCPF_CNPJ, event);
    else
        return fnMascaraCPF(inputCPF_CNPJ, event);
}

function fnlmpCNPJ(strCNPJ) {
    strResult = '';
    for (iCont = 0; iCont < strCNPJ.length; iCont++) {
        if (strCNPJ.charAt(iCont) != '.' && strCNPJ.charAt(iCont) != '-' && strCNPJ.charAt(iCont) != '/') {
            strResult += strCNPJ.charAt(iCont);
        }
    }
    return strResult;
}

function fnMascaraCNPJ(sCNPJ, event) {
    valor = '';
    valor = trim(fnlmpCNPJ(sCNPJ.value));
    Key = KeyStroke(event);
    if (valor.length > 0 && ((Key >= 48 && Key <= 57) || (Key >= 96 && Key <= 105))) {
        mask = '';
        if (valor.length > 0) {
            mask = valor;
            if (valor.length >= 2)
                mask = valor.substring(0, 2) + '.' + valor.substring(2, 5);
            if (valor.length >= 5)
                mask = valor.substring(0, 2) + '.' + valor.substring(2, 5) + '.' + valor.substring(5, 8);
            if (valor.length >= 8)
                mask = valor.substring(0, 2) + '.' + valor.substring(2, 5) + '.' + valor.substring(5, 8) + '/' + valor.substring(8, 12);
            if (valor.length >= 12)
                mask = valor.substring(0, 2) + '.' + valor.substring(2, 5) + '.' + valor.substring(5, 8) + '/' + valor.substring(8, 12) + '-' + valor.substring(12, 14);
        }
        sCNPJ.value = mask;
    }
}

function MascaraCEP(sender, event) {
    valor = sender.value;
    valor = valor.replace("-", "");

    Key = KeyStroke(event);

    if (valor.length > 0 && ((Key >= 48 && Key <= 57) || (Key >= 96 && Key <= 105))) {
        mask = '';
        if (valor.length > 0) {
            mask = valor;
            if (valor.length >= 5)
                mask = valor.substring(0, 5) + '-' + valor.substr(5, 3);
        }
        sender.value = mask;
    }
}

function fnMascaraCPF(sCPF, event) {
    valor = '';
    valor = trim(fnlmpCPF(sCPF.value));
    Key = KeyStroke(event);
    if (valor.length > 0 && ((Key >= 48 && Key <= 57) || (Key >= 96 && Key <= 105))) {
        mask = '';
        if (valor.length > 0) {
            mask = valor;
            if (valor.length >= 3)
                mask = valor.substring(0, 3) + '.' + valor.substring(3, 6);
            if (valor.length >= 6)
                mask = valor.substring(0, 3) + '.' + valor.substring(3, 6) + '.' + valor.substring(6, 9);
            if (valor.length >= 9)
                mask = valor.substring(0, 3) + '.' + valor.substring(3, 6) + '.' + valor.substring(6, 9) + '-' + valor.substring(9, 11);
        }
        sCPF.value = mask;
    }
}

function fnlmpCPF(strCPF) {
    strResult = '';
    for (iCont = 0; iCont < strCPF.length; iCont++) {
        if (strCPF.charAt(iCont) != '.' && strCPF.charAt(iCont) != '-') {
            strResult += strCPF.charAt(iCont);
        }
    }
    return strResult;
}

function fnMascaraCEP(sCEP, event) {
    valor = '';
    valor = trim(fnlmpCEP(sCEP.value));
    Key = KeyStroke(event);
    if (valor.length > 0 && ((Key >= 48 && Key <= 57) || (Key >= 96 && Key <= 105))) {
        mask = '';
        if (valor.length > 0) {
            mask = valor;
            if (valor.length >= 5)
                mask = valor.substring(0, 5) + '-' + valor.substring(5, 8);
        }
        sCEP.value = mask;
    }
}

function fnlmpCEP(strCEP) {
    strResult = '';
    for (iCont = 0; iCont < strCEP.length; iCont++) {
        if (strCEP.charAt(iCont) != '-') {
            strResult += strCEP.charAt(iCont);
        }
    }
    return strResult;
}

function ltrim(str) {
    l = new Number(str.length);
    if (l > 0) {
        while (str.charAt(0) == " " || str.charAt(0) == "\t")
            str = str.substr(1, l - 1);
    }
    return str;
}

function rtrim(str) {
    l = new Number(str.length);
    if (l > 0) {
        while (str.charAt(l - 1) == " " || str.charAt(l - 1) == "\t") {
            str = str.substr(0, l - 1);
            l = str.length;
        }
    }
    return str;
}

function lmpStr(strVal, StrCar) {

    strResult = '';
    for (iCont = 0; iCont < strVal.length; iCont++) {
        if (strVal.charAt(iCont) != StrCar) {
            strResult += strVal.charAt(iCont);
        }
    }
    return strResult;
}

function trim(str) {
    return (str == undefined || str == null) ? "" : ltrim(rtrim(str));
}

function soNumero(event) {
    var iKey = KeyStroke(event);
    return ((iKey > 47 && iKey < 58) || iKey == 0 || iKey == 8 || iKey == 13);
}

function soCaracter(event) {
    var iKey = KeyStroke(event);
    return ((iKey >= 97 && iKey <= 122) || (iKey >= 65 && iKey <= 90) || iKey == 0 || iKey == 8 || iKey == 13 || iKey == 32 || iKey == 89);
}

function soNumSinal(iKeyPerm, event) {
    var iKey = KeyStroke(event);
    return ((iKey > 47 && iKey < 58) || (iKey == 0 || iKey == 8 || iKey == 13 || iKey == 44 || iKey == iKeyPerm));
}

function soNumSinalsemVirgula(iKeyPerm, event) {
    var iKey = KeyStroke(event);
    return ((iKey > 47 && iKey < 58) || (iKey == 0 || iKey == 8 || iKey == 13 || iKey == iKeyPerm));
}

function soNaoSinal(iKeyPerm, event) {
    return !(KeyStroke(event) == iKeyPerm);
}

function KeyStroke(event) {
    var ikey = 0;
    if (event.which == undefined) {
        ikey = window.event.keyCode;
    }
    else {
        ikey = event.which;
    }
    return ikey;
}

function KeyIns(event, iKey) {
    if (event.which == undefined) {
        window.event.keyCode = iKey;
    }
    else {
        event.keyCode = iKey;
    }
}

$.fn.setDocumentProperties = function (doctype) {
    return $(this).each(function () {
        var $this = $(this);

        var type = EnumHelper.DocumentType[doctype * 1];

        $this.unmask();
        $this.removeAttr('validations');

        if (type == 'CPF') {
            $this.attr('validations', 'isCPF:Wrong, CPF');
            $this.mask(formatter.documentMask());
        }
        else if (type == 'CNPJ') {
            $this.attr('validations', 'isCNPJ:Wrong, CNPJ');
            $this.mask(formatter.juridicalDocumentMask());
        }
        else if (type == 'RNE')
            $this.attr('validations', 'isNotEmpty:Required, RNE');

        $this.attr('doctype', type);
    });
}

$.fn.setCreditCardProviderProperties = function (flagname) {
    return $(this).each(function () {
        var $this = $(this);

        $this.attr('flag', flagname);

        switch (flagname) {
            case "VI":
            case "MC":
            case "MS":
                $this.attr("maxlength", 19);
                $this.attr("digitquantity", 16);
                break;
            case "DC":
            case "DI":
                $this.attr("maxlength", 16);
                $this.attr("digitquantity", 14);
                break;
            case "AX":
                $this.attr("maxlength", 17);
                $this.attr("digitquantity", 15);
                break;
            case "HI":
            case "HP":
            case "GE":
                $this.attr("maxlength", 23);
                $this.attr("digitquantity", 19);
                break;
        };
    });
};

$.fn.removeDiacritics = function () {
    return $(this).each(function () {
        var ctrl = $(this);
        ctrl.val(ctrl.val().removeDiacritics());
    });
};

$.fn.containerOf = function (child) {
    var containersOf = $([]);

    this.each(function () {
        var $this = $(this);
        if ($this.find(child).length)
            containersOf = containersOf.add($this);
    });

    return containersOf;

}

jQuery.expr[':'].containerOf = function (element, child, meta) {
    return $(element).find(meta[3]).length;
};


Util.GetMaxZIndex = function (myselector) {

    return $("*").filter(":visible")
        .not(myselector || ".a-useless-class")
        .not("script")
        .not("link")
        .not("style")
        .map(function () {
            var zIndex = $(this).css('z-index');
            return isNaN(zIndex) ? 0 : parseInt(zIndex, 10);
        }).toArray().max();
};

var messagesExhibitorType = {
    0: {
        "pt-br": "Mensagem",
        "en-us": "Message"
    },
    1: {
        "pt-br": "Erro",
        "en-us": "Error"
    },
    2: {
        "pt-br": "Aviso",
        "en-us": "Warning"
    }
};

Util.MessagesExhibitionTypeResolver = function (Type) {
    if (!messagesExhibitorType[Type]) Type = 0;
    return messagesExhibitorType[Type][formatter ? formatter.culture : "pt-br"];
};

Util.GetDropBoxComponentText = function (comp) {
    var value = "";
    var parent = $(comp.find(".current"));
    if (parent && parent.length) {
        if (parent.children().length)
            value = parent.children().text();
        else
            value = parent.text();
    }

    return value;
};


Util.GetComponentValue = function (comp) {
    var value = "";

    function _getCustomElementValue(comp) {
        var value = "";

        if (comp.hasClass("customcheck")) {
            value = comp.attr("value");
        }
        else if (comp.hasClass("customradio")) {
            var type = comp.attr("type");

            var radios = $("[type='" + type + "']");

            for (var i = 0; i < radios.length; i++) {
                var radio = $(radios[i]);

                if (radio.hasClass("current")) {
                    value = radio.attr('value');

                    break;
                }
            }
        }
        else {
            var parent = $(comp.find(".current"));

            if (parent && parent.length) {
                if (parent.children().length)
                    value = parent.children().attr("value");
                else
                    value = parent.attr("value");
            }
        }

        return value;
    }

    if (comp && comp.length) {
        if (!comp.is("select") && !comp.is("input") && (comp.hasClass("multi_options") || comp.hasClass("customradio") || comp.hasClass("customcheck")))
            value = _getCustomElementValue(comp);
        else {
            if (comp.is("input:radio")) {

                var name = comp.attr("name");

                var radios = $("[name='" + name + "']");

                for (var i = 0; i < radios.length; i++) {
                    var radio = $(radios[i]);

                    if (radio.is(":checked")) {
                        value = radio.attr('value');

                        break;
                    }
                }
            }
            else if (comp.is("input:checkbox"))
                value = comp.attr("value");
            else
                value = comp.val();
        }
    }

    return value;
}

Util.IsChecked = function (comp) {
    var checked = undefined;

    if (!comp.is("input")) {
        if (comp.hasClass("customradio") || comp.hasClass("customcheck")) {
            checked = comp.hasClass("current");
        }
    }
    else {
        checked = comp.is(":checked");
    }

    return checked;
}

Util.GetInterfaceMessage = function (code) {
    var legend = code;
    var arguments = [];

    if ($.isArray(code)) {
        legend = code[0];

        if (code.length > 1)
            arguments = code.slice(1);
    }

    if (cultureResource)
        legend = cultureResource[legend];

    if (arguments.length > 0 && legend)
        legend = legend.format(arguments);

    return legend;
}

Util.CabinNameResolver = function (cabinType) {

    var cabin = {
        0: {
            "pt-br": "Primeira Classe"
        },
        1: {
            "pt-br": "Executiva"
        },
        2: {
            "pt-br": "EconÃ´mica"
        },
        3: {
            "pt-br": "EconÃ´mica Premium"
        }
    };

    if (!cabin[cabinType])
        cabinCode = 2;

    return cabin[cabinType][formatter ? formatter.culture : "pt-br"];
};

Util.CutText = function (text, limit) {
    if (text.length > limit) {
        text = text.substring(0, limit);
        return text + "...";
    } else
        return text;
};

Util.GetCultureResourceMessages = function (thisMessages) {

    for (var i = 0, messagesLen = thisMessages.length; i < messagesLen; i++) {
        var token = thisMessages[i];

        var messageArguments = undefined;

        if ($.isArray(token)) {
            token = thisMessages[i][0];
            messageArguments = thisMessages[i].slice(1);

            var message = cultureResource[token];

            if (message)
                if (messageArguments)
                    message = message.format(messageArguments) + "<br/>";

            thisMessages[i] = message + "<br/>";
        }

    }
    thisMessages.clearUndefined();

    for (var i = 0; i < thisMessages.length; i++) {
        thisMessages[i] = thisMessages[i] + "<br/>";
    }

    return thisMessages;
};

Util.StripHtml = function (text) {
    var newText = text.replace(/<(.|\n)*?>/gi, '');
    return (newText) ? newText : '';
}

Util.GetSumFareTaxesDU = function (step) {
    var config;
    if (typeof (Ide) != 'undefined')
        config = Ide.applicationSettings && Ide.applicationSettings["SumFareTaxesDU"];
    else if (typeof (Global) != 'undefined')
        config = Global.Settings && Global.Settings["SumFareTaxesDU"];

    var stepConfig;

    if (typeof (Ide) != 'undefined')
        stepConfig = Ide.applicationSettings && Ide.applicationSettings["SumFareTaxesDU_" + step];
    else if (typeof (Global) != 'undefined')
        stepConfig = Global.Settings && Global.Settings["SumFareTaxesDU_" + step];

    if (stepConfig)
        config = stepConfig;

    var str = "";

    if (config) {

        config = config.toLowerCase();

        var tokens = config.split('+');

        tokens.any("fare") && (str += "fare");

        tokens.any("taxes") && (str.length ? str += "+taxes" : str += "taxes");

        tokens.any("du") && (str.length ? str += "+du" : str += "du");
    }

    return str;
};

Util.GetQueryStringValue = function (querystring, key) {
    var resp;
    if (querystring.indexOf('?') == 0)
        querystring = querystring.substr(1, querystring.length);

    var values = querystring.split('&');

    for (var i = 0, len = values.length; i < len; i++) {
        var value = values[i].split('=');
        if (value[0] == key) {
            resp = value[1];
            break;
        }
    }

    return resp;
}

Util.DuResolver = function (source, fareAmmount, isInternational) {
    function calculate(fare, percentageTax, minTax) {
        var tax = ((fare * percentageTax) / 100);
        var duTaxes = (tax > minTax) ? tax : minTax;
        return duTaxes;
    }

    switch (source) {
        case Util.Sources.Sete:
        case Util.Sources.Azul:
        case Util.Sources.TAF:
        case Util.Sources.Puma:
            return calculate(fareAmmount, 10, 30);
        case Util.Sources.Asta:
        case Util.Sources.Trip:
        case Util.Sources.Azul:
        case Util.Sources.Passaredo:
        case Util.Sources.WebJet:
        case Util.Sources.Azul:
        case Util.Sources.Gol:
            return calculate(fareAmmount, 10, 40);
        case Util.Sources.Tam:
        case Util.Sources.Latam:
            var percentOfFare = isInternational ? 7 : 10;
            return calculate(fareAmmount, percentOfFare, 40);
        default:
            return 0;
            break;
    }

    return duTaxes;
}

Util.GetExternalPropertieValue = function (externalProperties, key) {
    if (externalProperties) {
        var obj = externalProperties.first(function (property) { return property.Key == key; });

        if (obj) {
            return obj.Value;
        }
    }

    return undefined;
};


Util.DontLostFocus = function (event) {
    if (event.keyCode !== $.ui.keyCode.TAB)
        return;

    var tabbables = $(':tabbable', this),
        first = tabbables.filter(':first'),
        last = tabbables.filter(':last');

    if (event.target === last[0] && !event.shiftKey) {
        first.focus(1);
        return false;
    } else if (event.target === first[0] && event.shiftKey) {
        last.focus(1);
        return false;
    }
};

Util.FieldValuesToObj = function (item) {
    item.FieldValuesObj = Util.FieldValuesToNewObj(item.FieldValues, true);
    item.FieldValuesObj.Id = item.Id;

    return item;
}

Util.FieldValuesToNewObj = function (fieldValues, removeInitial) {
    function getFunctionToEvaluate(type) {
        var funcToEvaluate = function (x) { return x; };

        if (type) {
            if (type.toLowerCase() == "int")
                funcToEvaluate = function (x) { return !isNaN(x) ? parseInt(x, 10) : null; };
            else if (type.toLowerCase() == "decimal")
                funcToEvaluate = function (x) { return !isNaN(x) ? parseFloat(x, 10) : null; };
        }

        return funcToEvaluate;
    }

    var rs = {};

    var regex = removeInitial ? /.*\./g : "";

    fieldValues.forEach(function (field) {
        var value;

        if (typeof field.PrimitiveValue !== 'undefined' && !field.DateValue && !field.GridColumns) {
            var funcToEvaluate = function (x) { return x; };

            funcToEvaluate = getFunctionToEvaluate(EnumHelper.FieldType[field.Type]);

            value = funcToEvaluate(field.PrimitiveValue);
        }
        else if (field.DateValue) {
            value = field.DateValue;
            value.MonthShort = formatter.monthNamesShort[formatter.culture][field.DateValue.Month - 1];
            value.Time = formatter.timeValuesShortSimple(field.DateValue);
        }
        else if (field.GridColumns && field.GridColumns.length) {

            var referenceColumn = field.GridColumns.getItemByMax(function (gc) { return gc.Values && gc.Values.length; });

            value = new Array(referenceColumn.Values.length);

            for (var i = 0; i < value.length; i++)
                value[i] = {};

            var col = null;
            for (var i = 0; i < field.GridColumns.length; i++) {
                var gridCol = field.GridColumns[i];
                var funcToEvaluate = getFunctionToEvaluate(gridCol.Type);

                for (var j = 0; j < value.length; j++) {
                    col = field.GridColumns[i].Values[j];

                    if (col)
                        value[j][field.GridColumns[i].Name.replace(regex, "")] = col.DateValue ? col.DateValue : funcToEvaluate(col.PrimitiveValue);
                }
            }
        }

        rs[field.RefName.replace(regex, "")] = value;
    });

    return rs;
}

Util.GetTypedResultSet = function (set) {
    var res = [];

    if (set.length === 0)
        return res;

    for (var i = 0; i < set[0].Value.length; i++) {
        var obj = {};
        for (var j = 0; j < set.length; j++) {
            obj[set[j].Key] = set[j].Value[i];
        }
        res[i] = obj;
    }
    return res;
}

Util.PassengerTitle = {
    Senhor: "Mr",
    Senhora: "Mrs",
    Senhorita: "Miss",
    Mr: "Senhor",
    Mrs: "Senhora",
    Miss: "Senhorita"
};

Util.ValidateResponse = function (response) {
    return (response.FlightGroups && response.FlightGroups.length > 0) || (response.Recommendations && response.Recommendations.length > 0) ||
        ((response.CityPairs && response.CityPairs.length > 0) && (response.CityPairs.first().FlightGroups && response.CityPairs.first().FlightGroups.length > 0)) ||
        (response.Hotels && response.Hotels.length > 0);
};

Util.ValidateWarnings = function (response, exhibitionType) {
    var warningList = [];

    for (var i = 0, len = response.Warnings.length; i < len; i++) {

        if (response.Warnings[i].FriendlyMessage != '') {
            warningList[i] = response.Warnings[i].FriendlyMessage;

            if (response.Warnings[i].Severity === EnumHelper.Warning.WarningSeverity.High)
                exhibitionType = EnumHelper.MessagesExhibitor.ExhibitionType.Alert;
        }
    }

    if (warningList.length > 0)
        Ide.notifyMessagesExhibitor("CustomError", warningList, exhibitionType);
};

Util.CompleteWithZeros = function (value, length, direction) {
    var value = value.toString();

    if (value.length < length) {
        var quantity = length - value.length;

        switch (direction) {
            case EnumHelper.NumberDirection.Right:
                for (var i = 0; i < quantity; i++)
                    value = value.toString() + "0";
                break;
            case EnumHelper.NumberDirection.Left:
                for (var i = 0; i < quantity; i++)
                    value = "0" + value.toString();
                break;
        }
    }

    return value;
};

Util.SorterCityPairBySchedule = function (propertyToSort, previousProperty) {
    function byFlightGroupCheapestFare() {
        var functionToSort = function (fg) { if (fg.RoundTripCheapestFare) { return fg.RoundTripCheapestFare.FareAmount + fg.RoundTripCheapestFare.TaxAmount + fg.RoundTripCheapestFare.DUTaxes; } else { return 99999999999999999999999999999; } };

        if (previousProperty == "OneWay")
            functionToSort = function (fg) { if (fg.OneWayCheapestFare) { return fg.OneWayCheapestFare.FareAmount + fg.OneWayCheapestFare.TaxAmount + fg.OneWayCheapestFare.DUTaxes; } else { return 99999999999999999999999999999; }; };

        return functionToSort;
    }

    function byGds() {
        return function (fg) { return Util.Sources[fg.SourceType]; };
    }

    function byFare() {
        return function (fg) {
            var value = 999999999999999999999999999;
            if (fg.FareOption)
                value = fg.FareOption.FareAmount;
            else if (fg.FareOptions.length)
                value = fg.FareOptions.min(function (fo) { return fo.FareAmount; });

            return value;
        };
    }

    function byFirstFlightsDateValues(index) {
        return function (fg) { return Util.DateValuesToDate(fg.Flights[0][propertyToSort]); };
    }
    function byLastFlightsDateValues(index) {
        return function (fg) { return Util.DateValuesToDate(fg.Flights[fg.Flights.length - 1][propertyToSort]); };
    }

    function byDateValues() {
        return function (fg) { return Util.DateValuesToDate(fg[propertyToSort]); };
    }

    function byFlightProperty() {
        return function (fg) { return fg.Flights[0][propertyToSort]; };
    }

    function byOtherOptionToBudget() {
        var functionToSort = function (fg) { return fg.Flights[0][propertyToSort] != true && Util.DateValuesToDate(fg.FirstDepartureTimeValues); };
        if (previousProperty) {
            functionToSort = function (fg) { if (fg.RoundTripCheapestFare) { return fg.Flights[0][propertyToSort] != true && fg.RoundTripCheapestFare.FareAmount + fg.RoundTripCheapestFare.TaxAmount + fg.RoundTripCheapestFare.DUTaxes; } else { return 99999999999999999999999999999; } };

            if (previousProperty == "OneWay")
                functionToSort = function (fg) { if (fg.OneWayCheapestFare) { return fg.Flights[0][propertyToSort] != true && fg.OneWayCheapestFare.FareAmount + fg.OneWayCheapestFare.TaxAmount + fg.OneWayCheapestFare.DUTaxes; } else { return 99999999999999999999999999999; }; };
        }

        return functionToSort;
    }

    var sorters = {
        flightGroupCheapestFare: byFlightGroupCheapestFare,
        GDS: byGds,
        Fare: byFare,
        ArrivalDateTimeValues: byLastFlightsDateValues,
        DepartureDateTimeValues: byFirstFlightsDateValues,
        FirstDepartureTimeValues: byDateValues,
        LastArrivalTimeValues: byDateValues,
        IsOtherOptionToBudget: byOtherOptionToBudget
    };

    if (sorters[propertyToSort])
        return sorters[propertyToSort]();
    else
        return byFlightProperty();
};

Util.GetHotelConnections = function (connections) {
    var hotelConnections = [];
    var keys = ['Sabre', 'Tourico', 'CMNet', 'Trend', 'Fake', 'T4W']

    connections.forEach(function (c) {
        keys.forEach(function (k) {
            if (k == 'Sabre' && c.Key == 'Sabre') {
                var propertie = c.Value.LoginInformations[0].ExternalProperties.first(function (prop) { return prop.Key == "SearchHotel" });

                if (propertie && propertie.Value.toLowerCase() == "true")
                    hotelConnections.push(c);
            } else if (c.Key == k)
                hotelConnections.push(c);
        });
    });

    return hotelConnections;
}

Util.GetAirConnections = function (connections) {
    var airConnections = [];
    var keys = ['Sabre', 'Tam', 'Gol', 'Avianca', 'Fake', 'Azul', 'Passaredo', 'Latam', 'Copa']

    connections.forEach(function (c) {
        keys.forEach(function (k) {
            if (c.Key == k)
                airConnections.push(c);
        });
    });

    return airConnections;
};


Util.ParseImagesUrl = function (pathImage) {
    if (document.location.protocol == "https:" && pathImage)
        pathImage = pathImage.replace("http:", "https:");

    return pathImage;
};

Util.CallFunctionWithNamespace = function (funcNamespace, args) {
    var parts = funcNamespace.split('.');

    if (parts.length == 1)
        return window[parts[0]](args && args[0]);
    else {
        var obj = window[parts[0]];

        for (var i = 1; obj && i <= parts.length - 2; i++)
            obj = obj[parts[i]];

        var func = obj && obj[parts[parts.length - 1]];

        if (func)
            return func(args && args[0]);
        else
            console.log("NÃ£o foi possÃ­vel executar a funÃ§Ã£o: " + funcNamespace);
    }
};

Util.showLoader = function (container, additionalClasses) {
    if (!container.children().last().hasClass("loader")) {
        container.append("<div class='loader'/>");

        if (additionalClasses)
            for (var i = 0; i < additionalClasses.length; i++)
                $(".loader", container).addClass(additionalClasses[i]);
    }
};

Util.hideLoader = function (container) {
    $(".loader", container).remove();
};

Util.StringFormat = function () {
    var s = arguments[0];
    if (s) {
        for (var i = 0; i < arguments.length - 1; i++) {
            var reg = new RegExp("\\{" + i + "\\}", "gm");
            s = s.replace(reg, arguments[i + 1]);
        }
    }
    return s;
};

Util.replaceCiaImagesError = function () {
    var path = Global.ImagesPath + "IconsCias/airplane_64x64.png";
    $(this).attr("src", path).css("width", 25).css("height", 18).addClass('visible');
};

Util.callOneParamClosureTemplate = function (template, paramName, value) {
    var opt_sb = "";
    var opt_data = {};
    opt_data[paramName] = value;
    return template(opt_data, opt_sb);
}

/*
FunÃ§Ã£o ResolverCEP: Efetuar a busca de CEP retornarndo os dados (nome da rua, cidade, estado)
Parametros: objComp - objeto JSON com os seguintes parametros:
                      objComp.CEP - componente com o campo CEP - Valor deve vir preenchido
                      objComp.Street - componente com o campo Rua
                      objComp.City - componente com o campo Cidade
                      objComp.State - componente com o campo Estado
*/
Util.ResolverCEP = function (objComp) {

    var settings = {
        components: {
            address: {
                CEP: objComp.CEP,
                Street: objComp.Street,
                City: objComp.City,
                State: objComp.State,
                Focus: objComp.Focus
            }
        },
        controllers: {
            checkOutController: new CheckOutController({ Global: {} })
        }
    };

    $(objComp.CEP).resolverCEP(settings);
}

Util.generateRandomGuids = function () {
    function s4() {
        return Math.floor((1 + Math.random()) * 0x10000)
            .toString(16)
            .substring(1);
    }
    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +
        s4() + '-' + s4() + s4() + s4();
};

Util.CreditCardPropertiesParser = function (provider) {
    var properties = {};
    switch (provider) {
        case "amex":
            properties.DisplayName = "Amex";
            properties.FlagName = "AX";
            break;
        case "aura":
            properties.DisplayName = "Aura";
            properties.FlagName = "AU";
            break;
        case "avista":
            properties.DisplayName = "Avista";
            properties.FlagName = "AV";
            break;
        case "brasilcard":
            properties.DisplayName = "BrasilCard";
            properties.FlagName = "BC";
            break;
        case "cabal":
            properties.DisplayName = "Cabal";
            properties.FlagName = "CA";
            break;
        case "cardban":
            properties.DisplayName = "CardBan";
            properties.FlagName = "CB";
            break;
        case "diners":
            properties.DisplayName = "Diners";
            properties.FlagName = "DI";
            break;
        case "discover":
            properties.DisplayName = "Discover";
            properties.FlagName = "DS";
            break;
        case "elo":
            properties.DisplayName = "ELO";
            properties.FlagName = "EL";
            break;
        case "fortbrasil":
            properties.DisplayName = "FortBrasil";
            properties.FlagName = "FB";
            break;
        case "grandcard":
            properties.DisplayName = "GrandCard";
            properties.FlagName = "GC";
            break;
        case "hipercard":
            properties.DisplayName = "Hipercard";
            properties.FlagName = "HI";
            break;
        case "jcb":
            properties.DisplayName = "JCB";
            properties.FlagName = "JC";
            break;
        case "mais":
            properties.DisplayName = "Mais!";
            properties.FlagName = "MI";
            break;
        case "mastercard":
            properties.DisplayName = "MasterCard";
            properties.FlagName = "MC";
            break;
        case "personalcard":
            properties.DisplayName = "PersonalCard";
            properties.FlagName = "PC";
            break;
        case "plenocard":
            properties.DisplayName = "PlenoCard";
            properties.FlagName = "PL";
            break;
        case "sorocred":
            properties.DisplayName = "Sorocred";
            properties.FlagName = "SO";
            break;
        case "valecard":
            properties.DisplayName = "ValeCard";
            properties.FlagName = "VC";
            break;
        case "visa":
            properties.DisplayName = "Visa";
            properties.FlagName = "VI";
            break;
    }

    return properties;
}

Util.SendToExternalLinks = function (data) {

    if (Util.getCookie('ExternalToken')) {
        var links = $('.sendToExternalLinks');

        if (links) {
            links.attr('href', function () {
                var link = $(this).attr('href');
                var character = link.indexOf('?') > -1 ? "&" : "?";
                $(this).attr('href', link + character + 'token=' + Util.getCookie('ExternalToken'));
            });
        }
    }
}

Util.CreateTravellerHash = function (user) {
    return (user.Name.trim() + user.MiddleName.trim() + user.LastName.trim()).replace(' ', '');
}

Util.GetRawDatesRange = function (startDate, endDate) {
    var datesRange = [];

    moment.lang(formatter.culture);

    var iteration = moment.twix(startDate, endDate, { allDay: true }).iterate("days");

    while (iteration.hasNext()) {
        var dateMoment = iteration.next();

        var nextDate = dateMoment.toDate();

        if (!datesRange.any(function (date) {
            return date.getFullYear() == nextDate.getFullYear()
                && date.getMonth() == nextDate.getMonth()
                && date.getDate() == nextDate.getDate();
        })) {
            datesRange.push(nextDate);
        }
    }

    return datesRange;
};

Util.GetDatesRange = function (startDate, endDate, datesRange) {

    if (!datesRange)
        datesRange = [];

    var rawDates = Util.GetRawDatesRange(startDate, endDate);

    datesRange.addRange(rawDates.select(function (date) { return Util.DateToString(date); }));

    return datesRange;
};

Util.ParseLocationsFinderDataToLocation = function (data) {
    return {
        "Id": data.id,
        "Hits": data.h,
        "IATA": data.i,
        "Name": data.n,
        "Type": data.t,
        "HasHotelCode": data.hc,
        "IdProximity": data.ip,
        "AirportsChildren": data.ac,
        "IataDescription": data.d,
        "IataCity": data.c,
        "IsInternational": data["in"],
        "DestinationId": data.id
    };
};

Util.CallResources = function (code) {
    return Resources.translate({ code: code });
};

Util.GetLastMonthDay = function (month, year) {
    var dt = new Date(year, month, 0);
    return dt.getDate();
};

Util.GetCurrentDateWithLastDay = function () {
    var currentDate = (new Date()).toDateValues();

    return new Date(currentDate.Year, (currentDate.Month - 1),
        Util.GetLastMonthDay(currentDate.Month, currentDate.Year));
};

Util.GetDateWithLastDay = function (date) {
    var dateValues = date.toDateValues();
    var lastDay = Util.GetLastMonthDay(dateValues.Month, dateValues.Year);

    return new Date(dateValues.Year, (dateValues.Month - 1), lastDay);
};

Util.ResolveDisplaySourceName = function (sourceType) {

    if (!isNaN(sourceType))
        sourceType = Util.Sources[sourceType];

    var displaySourceNames = '';
    if (typeof Ide == 'undefined')
        displaySourceNames = Global.Settings["DisplaySourceNamesConfiguration"];
    else
        displaySourceNames = Ide.applicationSettings["DisplaySourceNamesConfiguration"];

    if (displaySourceNames && displaySourceNames.length) {
        var sourceNames = JSON2.parse(displaySourceNames);

        var display = sourceNames[sourceType];

        if (display)
            sourceType = display;
    }

    return sourceType;
};

Util.ValidResponseArrayProperty = function (data, propertyName) {
    return data && data[propertyName] && (data[propertyName] instanceof Array) && data[propertyName].hasCount();
};

Util.CreateLocationsFinder = function (element, options) {

    var _settings = {
        "CurrentProduct": Global.Product.Air,
        "HasIata": false,
        "IsCity": true,
        "SearchType": Global.SearchTypes.Full,
        "maxResultsClient": 15,
        "maxResultsServer": 30,
        "idealNumberOfProximities": 6,
        "idealNumberOfProximitiesRoots": 3,
        "useCacheEnhancer": true,
        "onlyHalfClientResults": true,
        "onDropBoxSelect": function () { },
        "clientCache": Global.LocationsCache,
        "useScroll": true,
        "applyStatusClasses": false,
        "applyFixedClass": false,
        "controllers": {
            "locationsController": Global.LocationsController
        },
        "onDropBoxSelect": function (field, item) {
        }
    };

    $.fn.extend(_settings, options || {});

    $(element).locationsFinder(_settings);
}

Util.CreateUserExternalIDBackOfficeDropBox = function (element, options) {

    var _settings = {
        "controllers": {
            "profileController": new ProfileController()
        }
    };

    $.fn.extend(_settings, options || {});

    $(element).userExternalIDBackOfficeDropBox(_settings);
}


Util.CreateCostCentreAutocompleteDropBox = function (element, options) {

    var _settings = {
        companyContext: Ide.companyContext,
        controllers: {
            profileController: new ProfileController()
        }
    };

    $.fn.extend(_settings, options || {});

    $(element).costCenterAutocomplete(_settings);

    $(element).change(function () { isCostCenterFilled = false });
}

Util.CreateUserRequestorDropBox = function (element, options) {

    var _settings = {
        "controllers": {
            "profileController": new ProfileController()
        }
    };

    $.fn.extend(_settings, options || {});

    $(element).UserRequestorDropBox(_settings);
}

Util.ValidateFileExtension = function (fileName, validExtensions) {
    return validExtensions.contains(fileName.split(".")[1]);
};

Util.CreateCiaCodeImagePath = function (ciaCode) {
    return Util.StringFormat("{0}IconsCias/{1}.gif", Global.ImagesPath, ciaCode);
}

Util.JSONParse = function (value) {
    return typeof value === 'string'
        ? JSON2 ? JSON2.parse(value) : JSON.parse(value) : value;
};

Util.HasOwnProperty = function (propertyName, candidate) {
    if (candidate.hasOwnProperty(propertyName))
        return true;

    for (var p in candidate) {
        if (p.contains(propertyName))
            return true;
    }

    return false;
};

Util.GetProperty = function (propertyName, data) {
    if (data.hasOwnProperty(propertyName))
        return data[propertyName];

    for (var p in data) {
        if (p.contains(propertyName))
            return data[p];
    }

    return null;
};

Util.ControllerMaker = function (controller, model, events) {

    var actions = ["Starting", "Completed", "Error"];

    events && events.foreach(function (ev) {
        actions.foreach(function (action) {
            controller[ev + action] = new Event();
        });

        controller[ev] = function (req) {
            controller[ev + "Starting"].notify(req);
            model[ev](req);
        };

        ["Completed", "Error"].foreach(function (action) {
            controller["on" + ev.capitalize(true) + action] = function (resp) {
                controller[ev + action].notify(resp);
            };
        });
    });
};

Util.LengthEnoughForGroupPnr = function (length) {
    return length > 9;
}

Util.RemoveCurrencySymbol = function (value) {
    return value.replace(/[^0-9\,-.]/g, '');
};

Util.GetCardValidYears = function () {
    var cardValidYears = [new Date().getFullYear()];

    for (var i = 0; i < 14; i++)
        cardValidYears.push(cardValidYears[i] + 1);

    return cardValidYears;
};

Util.GetCardValidMonths = function () {
    return [{ Code: 1, Name: 'January' },
    { Code: 2, Name: 'February' },
    { Code: 3, Name: 'March' },
    { Code: 4, Name: 'April' },
    { Code: 5, Name: 'May' },
    { Code: 6, Name: 'June' },
    { Code: 7, Name: 'July' },
    { Code: 8, Name: 'August' },
    { Code: 9, Name: 'September' },
    { Code: 10, Name: 'October' },
    { Code: 11, Name: 'November' },
    { Code: 12, Name: 'December' }];
};

Util.IsValidObject = function (candidate) {
    return typeof candidate === "object" && candidate != null && !$.isEmptyObject(candidate);
};

Util.GetPaymentOptionsCreditCards = function (paymentOptions) {
    return paymentOptions.where(function (o) {
        return o.Type == EnumHelper.PaymentType.CreditCard;
    }).select(function (o) {
        return {
            DisplayName: o.DisplayName,
            FlagName: o.FlagName
        };
    }).orderBy(function (o) {
        return o.DisplayName;
    });
};

Util.RemoveCurrencyMask = function (value, precision, currencyCode) {
    currencyCode = (currencyCode || Global.CurrencyCode || "BRL");

    if (!precision) precision = 2;

    if (value) {

        var currencyDefault = formatter.currencyDefaults[currencyCode];

        var firstSignal = value.reverse().toArray().first(function (h) { return isNaN(h); });

        if (firstSignal == currencyDefault.thousandSeparator) {
            value = value.replaceAll(currencyDefault.decimalSeparator, "token")
                .replaceAll(currencyDefault.thousandSeparator, currencyDefault.decimalSeparator)
                .replaceAll("token", currencyDefault.decimalSeparator);
        }

        value = value.replaceAll(currencyDefault.thousandSeparator, '');

        if (currencyDefault.decimalSeparator != '.')
            value = value.replaceAll(currencyDefault.decimalSeparator, '.');

        value = parseFloat(parseFloat(value).toFixed(precision));
    }
    else {
        value = 0;
    }

    return value;
};

Util.AllowSendAirIssueByEmail = function (ticketStatus) {
    return !(["cancelled", "replaced", "pending"].any(function (s) { return s == ticketStatus.toLowerCase(); }));
};

Util.AllowSendHotelBookByEmail = function (hotelBook) {
    return hotelBook.IsPayed != undefined && hotelBook.IsPayed;
};


Util.UpdateExchangedPrices = function (exchangeRates) {
    var currentTabElem = Ide.getCurrentTabElement();

    if (currentTabElem) {
        var allSelects = $(".change_currency_select", currentTabElem);

        var select = allSelects.filter(":visible");

        if (select.is(":visible") && exchangeRates) {

            var ctrl = select.find("option:selected");

            var currentTab = Ide.getCurrentTab();

            var currency = ctrl.val();

            var exchangeRate = exchangeRates.first(function (h) { return h.OriginalCurrency == currency && h.ExchangedCurrency == formatter.currencyType(); });

            if (!exchangeRate)
                exchangeRate = { Value: 1 };

            currentTab.selectedCurrency = currency;
            currentTab.currentExchangeRate = exchangeRate;

            allSelects.each(function () { $(this).val(currency) });

            $(".price-exchange", currentTabElem).each(function () {
                var price = $(this);

                var originalPrice = price.attr("originalprice");

                if (originalPrice && originalPrice != "undefined") {
                    if (originalPrice.contains(","))
                        originalPrice = originalPrice.replaceAll(".", "").replaceAll(",", ".");

                    originalPrice = originalPrice.replaceAll("R$", "").trim();

                    var useSymbol = price.attr("usesymbol");

                    if (!useSymbol)
                        useSymbol = "true";

                    price.html(formatter.currency(originalPrice / exchangeRate.Value, useSymbol == "true", 2, currency));
                }
            });

            $(".currency-exchange", currentTabElem).each(function () {
                $(this).html(currency);
            });
        }
    }
};

Util.RemoveStackTraceFromErrorMessage = function (errorMessage) {
    if (errorMessage) {
        var limit = errorMessage.indexOf("\n   at ");

        if (limit == -1)
            limit = errorMessage.length;

        return errorMessage.substr(0, limit);
    }
    else {
        return errorMessage;
    }
};

Util.Guid = function () {
    function s4() {
        return Math.floor((1 + Math.random()) * 0x10000)
            .toString(16)
            .substring(1);
    }
    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +
        s4() + '-' + s4() + s4() + s4();
}

Util.FloatToPercent = function (value, perc) {
    return parseFloat(value) * (parseFloat(perc) / 100.0);
}

Util.GetWidth = function (classNameOrJQueryObject) {

    if (classNameOrJQueryObject != null) {
        var width = null;

        if (typeof classNameOrJQueryObject == 'string') {
            width = $.css('.' + classNameOrJQueryObject, "width", true);

            if (width.toString().indexOf('%') > -1) {
                return Util.FloatToPercent(Util.GetWidth($('.' + classNameOrJQueryObject).parent().get(0)), parseFloat(width));
            }

        } else if (typeof classNameOrJQueryObject == 'object' && classNameOrJQueryObject.clientWidth != null) {
            width = $.css(classNameOrJQueryObject, "width", true);

            if (width.toString().indexOf('%') > -1) {
                return Util.FloatToPercent(Util.GetWidth(classNameOrJQueryObject.parentNode), parseFloat(width));
            }
        }

        if (width != null) {
            return parseFloat(width);
        }
    }
}

Util.AirCompanies = {
    "AR": "Aerolineas Argentinas",
    "AM": "AeromÃ©xico",
    "5L": "Aerosur",
    "AC": "Air Canada",
    "CA": "Air China",
    "UX": "Air Europa",
    "AF": "Air France",
    "NH": "Air Nippon Airways",
    "AZ": "Alitalia",
    "AA": "American Airlines",
    "AV": "Avianca",
    "O6": "Avianca",
    "A0": "Avianca Argentina",
    "AD": "Azul",
    "BA": "British Airways",
    "CO": "Continental Airlines",
    "CM": "Copa Airlines",
    "DL": "Delta Airlines",
    "LY": "El Al",
    "EK": "Emirates",
    "G3": "Gol",
    "IB": "Iberia",
    "JL": "Japan Airlines",
    "KL": "Klm",
    "KE": "Korean Airlines",
    "4M": "Lan Argentina",
    "LA": "Lan Chile",
    "LP": "Lan Peru",
    "LH": "Lufthansa",
    "MX": "Mexicana",
    "GP": "Pantanal",
    "Z4": "Puma",
    "P3": "Passaredo",
    "PU": "Pluna",
    "QF": "Qantas",
    "QL": "Regional Laser C.A",
    "QR": "Qatar Airways",
    "S3": "SAN Air",
    "SA": "South African",
    "H2": "",
    "LX": "Swiss",
    "DT": "Taag Airlines",
    "JJ": "Tam",
    "TP": "Tap",
    "T4": "Trip Linhas AÃ©reas",
    "TK": "Turkish",
    "UA": "United Airlines",
    "US": "US Airways",
    "RG": "Varig",
};

Util.ObjectContainsProperty = function (obj, property) {
    return obj.hasOwnProperty(property) &&
        typeof obj[property] != "undefined" &&
        obj[property] != null;
};

Util.GetUrlParameterByName = function (parameterName) {
    var href = window.location.href.toLowerCase();

    parameterName = parameterName.toLowerCase();
    parameterName = parameterName.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS = "[\\?&]" + parameterName + "=([^&#]*)";
    var regex = new RegExp(regexS);
    var results = regex.exec(href);

    if (results == null)
        return "";

    return decodeURIComponent(results[1].replace(/\+/g, " "));
};

Util.IsMultipleSelectOnTrayBar = function (productType) {
    var _isMultipleItem = {
        Air: false,
        Hotel: false,
        Service: true
    };

    if (_isMultipleItem[productType])
        return _isMultipleItem[productType];
};

Util.GePassengerHash = function (passenger) {
    return Util.StringFormat("{0}{1}{2}{3}",
        passenger.Name,
        passenger.MiddleName,
        passenger.LastName,
        Util.DateValuesToString(passenger.BirthDateValues));
};

Util.InlineCSS = function (container) {
    var rules = document.styleSheets[document.styleSheets.length - 1].cssRules;
    for (var idx = 0, len = rules.length; idx < len; idx++) {
        container.find($(rules[idx].selectorText)).each(function (i, elem) {
            elem.style.cssText += rules[idx].style.cssText;
        });
    }
};

Util.IsIntelligentSearchEnabled = function () {
    var configEnabledIntelligentSearch = Ide.applicationSettings['EnableIntelligentSearch'];

    return (configEnabledIntelligentSearch != null) && (configEnabledIntelligentSearch === 'true');
}

Util.DeepCopy = function (originalObject) {
    return $.extend(true, {}, originalObject);
}

Util.RemoveUnusedSlickGridStyleTags = function () {
    var slickGridStyleTags = $('style[rel=stylesheet].slickGrid');
    var stylesToRemove = [];

    if (slickGridStyleTags != null && slickGridStyleTags.length > 0) {
        for (tagIndex = 0; tagIndex < slickGridStyleTags.length; tagIndex++) {
            var styleTag = slickGridStyleTags[tagIndex];
            var innerStyleText = styleTag.innerHTML;
            var styles = innerStyleText.split(' ');

            if (styles) {
                var slickGridStyleToCheck = styles[0];
                var elementsWithStyleToCheck = $(slickGridStyleToCheck);

                if (elementsWithStyleToCheck && elementsWithStyleToCheck.length === 0) {
                    stylesToRemove.push(styleTag);
                }
            }
        }

        if (stylesToRemove.length > 0) {
            var size = stylesToRemove.length;

            for (tagIndex = (size - 1); tagIndex > 0; tagIndex--) {
                stylesToRemove[tagIndex].remove();
            }
        }
    }
}

Util.ResolveSourceCapability = function (sourceCapabilities, source, capability) {
    var sourceCapability = sourceCapabilities.first(function (s) {
        return s.SourceName == source;
    });

    return sourceCapability && sourceCapability.hasOwnProperty(capability) && sourceCapability[capability];
};

Util.HasCount = function (param) {
    return param != undefined && param.length != undefined && param.length > 0;
}

Util.HasPlugin = function (control, pluginname) {
    if (control != null && control.data) {
        var data = control.data();
        return data.pluginNames && data.pluginNames.any(function (p) { return p == pluginname });
    }
    return false;
}

Util.TimeValuesToString = function (timeValue) {
    if (timeValue != undefined && timeValue.Hour != undefined && typeof timeValue.Hour === 'number' && timeValue.Minutes != undefined && typeof timeValue.Minutes === 'number' && timeValue.Seconds != undefined && typeof timeValue.Seconds === 'number') {
        return formatter.toTwoDigits(timeValue.Hour) + ':' + formatter.toTwoDigits(timeValue.Minutes.toString()) + ':' + formatter.toTwoDigits(timeValue.Seconds.toString());
    }

    return '';
}

Util.StringToFloat = function (value) {
    if (typeof value === 'number') {
        return parseFloat(value);
    } else if (typeof value === 'string') {
        if (/^(\-|\+)?([0-9]+(\.[0-9]+)?|Infinity)$/.test(value)) {
            return parseFloat(value);
        }
    }

    return NaN;
};

Util.GetShortCodeParameter = function (key) {
    return Global.ShortCodeParameters && Global.ShortCodeParameters[key];
};

Util.LocationFormatter = new (function () {
    this.isProximity = function (str) {
        return str.contains("[") && str.contains("]");
    },
        this.getIataOrDefault = function (fullName) {
            var str = fullName;

            if (str.contains("[") && str.contains("(")) {
                var iata = str.substring(str.indexOf("(") + 1, str.indexOf(")"));

                if (iata.length == 3)
                    return iata;
            }

            return str;
        },
        this.getDistancePartOrDefault = function (fullName) {

            var str = fullName;

            if (Util.LocationFormatter.isProximity(str)) {
                var distancePart = str.substring(str.indexOf("["), str.indexOf("]") + 1);

                if (distancePart.length)
                    return distancePart;
            }

            return "";
        },
        this.formatProximity = function (fullName) {
            return (Util.LocationFormatter.getIataOrDefault(fullName) + " " + Util.LocationFormatter.getDistancePartOrDefault(fullName)).trim();
        },
        this.formatAirLocation = function (locationLight) {
            var resp = "";

            if (locationLight) {
                var distancePart = Util.LocationFormatter.getDistancePartOrDefault(locationLight.n);

                if (distancePart.length) {
                    resp = (locationLight.i || locationLight.d) + " " + distancePart;
                }
                else if (locationLight.i) {
                    resp = locationLight.i;
                }
            }

            return resp;
        }
})();

Util.ValidateByType = function (objectToValidate, propertiesToValidate) {

    if (objectToValidate == undefined || propertiesToValidate == undefined || !Array.isArray(propertiesToValidate)) {
        return false;
    } else {
        var isValid = true;
        var propertySize = propertiesToValidate.length;

        for (i = 0; i < propertySize; i++) {
            var propertyToValidate = propertiesToValidate[i];

            if (objectToValidate[propertyToValidate.Property] == undefined || typeof objectToValidate[propertyToValidate.Property] !== propertyToValidate.Type) {
                isValid = false;

                break;
            }
        }

        return isValid;
    }
};

Util.IsEnableReplaceResultOptionInBatchSettingEnabled = function () {
    var config = Ide.applicationSettings['EnableReplaceResultOptionInBatch'];

    return (config != undefined) && (config === 'true');
};

Util.DateToHtml5Date = function (dt) {
    return Util.DateValueToHtml5Date(Util.DateToDateValues(dt));
}

Util.DateValueToHtml5Date = function (dt) {
    return dt.Year + '-' + formatter.toTwoDigits(dt.Month) + '-' + formatter.toTwoDigits(dt.Day);
}

Util.DateHtml5ToDateValue = function (dt) {
    var splitted = dt.split('-');
    if (splitted.length == 3) {
        return { Year: splitted[0], Month: splitted[1], Day: splitted[2] };
    }
    return null;
}

Util.Html5DateToDate = function (dt) {
    return Util.DateValuesToDate(Util.DateHtml5ToDateValue(dt));
}

Util.Html5DateToString = function (dt) {
    return Util.DateValuesToString(Util.DateHtml5ToDateValue(dt));
}

Util.StringToHtml5Date = function (dt) {
    return Util.DateValueToHtml5Date(Util.StringToDateValues(dt));
}

Util.SameContext = function (context, toCompare) {

    var toCheck = ["ConsolidatorId", "TravelAgencyId", "CustomerId"];

    for (var i = 0; i < toCheck.length; i++) {
        if (context[toCheck[i]] != toCompare[toCheck[i]])
            return false;
    }

    return true;
};

//EnumHelper.Passenger.PassengerType
Util.PassengerAge = function (passengerType) {
    switch (passengerType) {
        case EnumHelper.Passenger.PassengerType.Senior:
            return 56;
        case EnumHelper.Passenger.PassengerType.Adult:
            return 18;
        case EnumHelper.Passenger.PassengerType.Child:
            return 5;
        case EnumHelper.Passenger.PassengerType.Baby:
            return 1;
    }
};

Util.GetRecommendationTotalFare = function (recommendation, searchData) {
    var totalValue =
        (recommendation.BrandedFare.MarkupedTotalAmount * (searchData.Adults || searchData.NumberADTs || 0)) +
        (recommendation.BrandedFare.TotalAmountCHD * (searchData.Children || searchData.NumberCHDs || 0)) +
        (recommendation.BrandedFare.TotalAmountINF * (searchData.Babies || searchData.NumberINFs || 0)) +
        (recommendation.BrandedFare.TotalAmountSRC * (searchData.Srcs || searchData.NumberSRCs || 0));

    return totalValue;
};

Util.DebugMessage = function (message) {
    if (typeof console != 'undefined') {
        console.log(message);
    }
}

Util.CreatePerson = function (quantity, type) {
    return { Quantity: quantity, Type: type };
};

Util.IsValidDate = function (d) {
    if (Object.prototype.toString.call(d) !== "[object Date]")
        return false;
    return !isNaN(d.getTime());
}

Util.ParseIntOrZero = function (value) {
    return (parseInt(value) || 0);
}

Util.DictionaryToObject = function (dictionary) {
    var dictionaryObject = {};

    if (!dictionary || !(dictionary instanceof Array))
        return dictionaryObject;

    dictionary.forEach(function (k) { dictionaryObject[k.Key] = k.Value; });

    return dictionaryObject;
};

Util.CompareDictionaryKeyValue = function (dictionary, key, value) {
    var obj = Util.DictionaryToObject(dictionary)

    return (obj.hasOwnProperty(key) && obj[key] == value);
};

Util.ServiceItemContextEqualsCurrentContext = function (serviceItem) {
    var sameConsolidator = (Ide.companyContext.ConsolidatorId == serviceItem.ConsolidatorId);
    var sameTravelAgency = (Ide.companyContext.TravelAgencyId == serviceItem.TravelAgencyId);
    var sameCustomer = (Ide.companyContext.CustomerId == serviceItem.CorporateCostumerId);

    return (sameConsolidator && sameTravelAgency && sameCustomer);
};

Util.CreateServiceItemWithDefaults = function () {
    return {
        Id: 0,
        Fees: [],
        Links: [],
        Messages: [],
        Passengers: [],
        FieldValues: [],
        FieldValuesObj: {},
        ConsolidatorId: 0,
        ConsolidatorName: "",
        ConsolidatorType: "",
        CorporateCostumerId: 0,
        CorporateCostumerName: "",
        TravelAgencyId: 0,
        TravelAgencyName: ""
    };
};

Util.SetTravelAgentLogo = function (element, defaultLogoPath) {
    var agencyLogo;

    try { agencyLogo = Util.GetTravelAgentLogo(); }
    catch (ex) { }

    if (agencyLogo)
        Util.SetTopLogo(element, agencyLogo);
    else
        Util.SetTopLogo(element, defaultLogoPath);
};

Util.SetTopLogo = function (element, logo) {
    element.attr("src", logo).css("width", "105px");
};

Util.GetTravelAgentLogo = function () {

    var logoFileName = Ide.companyContext.CustomerUrlLogo;
    var logoUrl;

    if (!logoFileName) {
        logoFileName = Util.CompareSettingValue("useAgencyLogoOnTravelAgent", "true")
            ? (Ide.companyContext.TravelAgencyUrlLogo == "" ? Ide.companyContext.ConsolidatorUrlLogo : Ide.companyContext.TravelAgencyUrlLogo)
            : Ide.companyContext.ConsolidatorUrlLogo;
    }

    if (logoFileName && logoFileName != "") {
        logoUrl = Ide.filesRepositoryUrl.endsWith("/")
            ? Ide.filesRepositoryUrl + logoFileName
            : Ide.filesRepositoryUrl + "/" + logoFileName;

        logoUrl = location.href.contains("https://") ? logoUrl.replaceAll("http://", "https://") : logoUrl;
    }

    return logoUrl;
};

Util.subtractDates = function (lowerDate, greaterDate, returnType) {
    var inputInvalid = lowerDate == undefined || greaterDate == undefined || !Util.IsValidDate(lowerDate) || !Util.IsValidDate(greaterDate);

    if (inputInvalid || greaterDate <= lowerDate) {
        return 0;
    }

    if (returnType == undefined || (returnType != "d" && returnType != "h" && returnType != "m" && returnType != "s")) {
        returnType = "d";
    }

    var dateDiff = (greaterDate - lowerDate) / 1000;
    var days = 0;

    if (returnType == "d") {
        days = Math.round(dateDiff / (24 * 60 * 60));
        return days;
    }
    else {
        days = Math.floor(dateDiff / (24 * 60 * 60));
    }

    var leftSec = dateDiff - days * 24 * 60 * 60;
    var hrs = Math.floor(leftSec / (60 * 60));

    if (returnType == "h") {
        return hrs;
    }

    var leftSec = leftSec - hrs * 60 * 60;
    var min = Math.floor(leftSec / (60));

    if (returnType == "m") {
        return min;
    }

    return leftSec - min * 60;
};

Util.RoundDecimal = function (value, exp) {
    if (value == undefined || exp == undefined || isNaN(value) || isNaN(exp) || exp % 1 !== 0) {
        return NaN;
    }

    value = +value;
    exp = +exp;

    if (value == 0) {
        return 0;
    } else if (exp == 0) {
        return Math.round(value);
    } else if (value.toString().indexOf('.') == -1) {
        return value;
    }

    if (exp > 0) {
        exp = exp * -1;
    }

    value = value.toString().split('e');
    value = Math.round(+(value[0] + 'e' + (value[1] ? (+value[1] - exp) : -exp)));
    value = value.toString().split('e');

    return +(value[0] + 'e' + (value[1] ? (+value[1] + exp) : exp));
};

Util.ProposalIsActive = function () {
    if (typeof (ComplexEditor) != 'undefined' && ComplexEditor.Proposal) {
        var configuration = ComplexEditor.Proposal.GetConfiguration(Ide.applicationSettings);
        var active = configuration["Active"] || configuration["active"];

        switch (typeof active) {
            case "boolean": return active;
            case "string": return active.toLowerCase() === "true" || active === "1";
            case "number": return active === 1;
            default: return false;
        }
    }

    return Util.CompareSettingValue("proposal.active", "true");
};

Util.EnableQuotation = function () {
    var enable = true;
    if (typeof (ComplexEditor) != 'undefined' && ComplexEditor.Proposal) {
        enable = !Util.ProposalIsActive();
        if (!enable) {
            var configuration = ComplexEditor.Proposal.GetConfiguration(Ide.applicationSettings);
            var enableConfig = configuration["EnableEmailQuotation"] || configuration["EnableEmailQuotation"];

            switch (typeof enableConfig) {
                case "boolean": enable = enableConfig; break;
                case "string": enable = enableConfig.toLowerCase() === "true" || enableConfig === "1"; break;
                case "number": enable = enableConfig === 1; break;
            }
        }
    }

    return enable;
};

Util.PersonIsActive = function () {
    return Util.CompareSettingValue("Person.Active", "true");
};

Util.IsBuyerActive = function () {
    return "true".normalizedEquals(Util.GetSetting("Buyer.Active"));
};

Util.IsBuyerRequired = function () {
    var required = Util.GetSetting("MandatoryBuyerSelection");
    return typeof (required) == 'undefined' || "true".normalizedEquals(required);
};

Util.AskForCorporatePassenger = function () {
    return Ide.companyContext.CustomerId != undefined &&
        (Util.CompareSettingValue("AskForCorporatePassenger", "true") ||
            typeof Util.GetSetting("AskForCorporatePassenger") === "undefined");
};

Util.ImageExists = function (imageUrl) {
    var http = new XMLHttpRequest();

    http.open('HEAD', imageUrl, false);
    http.send();

    return http.status != 404;
};

Util.MinValue = function (values) {
    if (values != undefined && Array.isArray(values)) {
        return Math.min.apply(null, values);
    }
}

Util.MaxValue = function (values) {
    if (values != undefined && Array.isArray(values)) {
        return Math.max.apply(null, values);
    }
}

Util.GetServiceTypeIdFromIde = function (name, category, subCategory) {
    var definition = Ide.getServiceDefinitionType(name, category, subCategory);

    if (definition) {
        return definition.Id;
    }

    if (console && console.log)
        console.log(Util.StringFormat("{0} Service Definition Type not found.", name));

    return 0;
};

Util.TryGetProposalSettingConfig = function () {
    try {
        return ComplexEditor.Proposal.GetConfiguration(Ide.applicationSettings)
    }
    catch (e) {
        try {
            return ComplexEditor.Proposal.GetDefaultValue();
        }
        catch (e) {
        }
    }

    return null;
};


Util.GetDateValuesKey = function (dateValues) {

    var padding = function (str) {
        var pad = "00";
        return pad.substring(0, pad.length - str.length) + str;
    };

    dateValues = dateValues || {};

    var year = (dateValues.Year || 0).toString();
    var month = (dateValues.Month || 0).toString();
    var day = (dateValues.Day || 0).toString();
    var hour = (dateValues.Hour || 0).toString();
    var minutes = (dateValues.Minutes || 0).toString();
    var seconds = (dateValues.Seconds || 0).toString();

    return padding(year) + padding(month) + padding(day) + padding(hour) + padding(minutes) + padding(seconds);
};

Util.extendPluginSettings = function (defaultSettings, argumentSettings) {
    var ret = $.extend(false, {}, argumentSettings || {});

    if (defaultSettings && typeof (defaultSettings) == "object") {
        for (var prop in defaultSettings)
            if (!ret[prop])
                ret[prop] = Util.extendPluginSettings(defaultSettings[prop]);
    }
    else {
        return typeof (argumentSettings) == "undefined" ? defaultSettings : argumentSettings;
    }

    return ret;
};

Util.GetAge = function (birthday, whatDay) {
    var whatDay = whatDay || moment().toDate(),
        birthday = typeof birthday.getTime === "function" ? birthday : moment(birthday).toDate();

    var age = whatDay.getFullYear() - birthday.getFullYear(),
        m = whatDay.getMonth() - birthday.getMonth();

    if (m < 0 || (m === 0 && whatDay.getDate() < birthday.getDate())) {
        age--;
    }

    return age;
};

Util.GenerateHexColor = function (randomString) {

    function _hashCode(str) {
        var hash = 0;
        for (var i = 0; i < str.length; i++) {
            hash = str.charCodeAt(i) + ((hash << 5) - hash);
        }
        return hash;
    }

    function _intToRGB(i) {
        var c = (i & 0x00FFFFFF)
            .toString(16)
            .toUpperCase();

        return "00000".substring(0, 6 - c.length) + c;
    }

    function _balanceColor(hex) {
        return _getBalancedValue(hex.substring(0, 2)) + _getBalancedValue(hex.substring(2, 4)) + _getBalancedValue(hex.substring(4, 6));
    }

    //balanciamento para nÃ£o ficar muito escuro nem muito claro
    function _getBalancedValue(hexPart) {

        var minToBalance = 66;
        var maxToBalance = 192;

        var hexadecimal = ("0x" + hexPart).toString(10);

        while (hexadecimal > maxToBalance || hexadecimal < minToBalance) {
            if (hexadecimal > maxToBalance)
                hexadecimal--;
            else
                hexadecimal++;

            hexPart = (hexadecimal & 0x00FFFFFF)
                .toString(16)
                .toUpperCase();

            hexadecimal = ("0x" + hexPart).toString(10);
        }

        return hexPart;
    }

    var evaluatedString = "";

    for (var i = 0; i <= 3; i++) {

        if (i % 2 != 0)
            evaluatedString = evaluatedString.reverse();

        evaluatedString += randomString;
    }

    return _balanceColor(_intToRGB(_hashCode(evaluatedString)));

};

Util.GetBytes = function (s) {
    return ~-encodeURI(s).split(/%..|./).length;
};

Util.GetJSONSize = function (json) {
    return json && Util.GetBytes(JSON.stringify(json)) || 0;
};

Util.CalculateJSONSizes = function (json, myPath, acc) {
    if (!json)
        return [];

    if (!myPath)
        myPath = "";

    if (!acc)
        acc = [];

    if (typeof (json) === "object" && !Array.isArray(json)) {
        json["my_size"] = Util.GetJSONSize(json);
        json["my_path"] = myPath;

        acc.push({
            size: json["my_size"],
            path: json["my_path"]
        });
    }

    for (var item in json) {
        if (json[item]) {
            if (Array.isArray(json[item])) {
                json[item].foreach(function (subItem, i) {
                    Util.CalculateJSONSizes(subItem, (myPath ? myPath + "." + item : item.toString()) + "[{0}]".format(i), acc);
                });
            }
            else if (typeof (json[item]) === "object") {
                Util.CalculateJSONSizes(json[item], myPath ? myPath + "." + item : item.toString(), acc);
            }
        }
    }

    return acc.orderBy(function (h) { return h.size; });
};

Util.TrySetSessionStorage = function (name, value) {
    try {
        sessionStorage.setItem(name, value);
        return true;
    }
    catch (e) {
        return false;
    }
    finally {
    }


}

Util.TryGetSessionStorage = function (name) {
    try {
        return sessionStorage.getItem(name);
    }
    catch (e) {
        return false;
    }
    finally {
    }


}

Util.MountResolveQueryResult = function (queryResults, validation) {

    if (!validation) {
        validation = function () { return true; };
    }

    var objects = [];

    if (queryResults && queryResults.Values) {


        for (var i = 0; i < queryResults.Values.length; i++) {
            var items = [];

            var obj = {};

            for (var j = 0; j < queryResults.Values[i].length; j++)
                if (validation(queryResults, i, j))
                    obj[queryResults.Header[j].RefName] = queryResults.Header[j].Type == EnumHelper.FieldType.Grid && queryResults.Values[i][j] != null && queryResults.Values[i][j].length > 0 ? JSON.parse(queryResults.Values[i][j]) : queryResults.Values[i][j];

            objects.push(obj);
        }
    }

    return objects;
};

Util.HeaderToColumns = function (headers) {

    var columns = [];

    if (headers) {

        for (var i = 0; i < headers.length; i++) {
            var column = {
                name: headers[i].RefName,
                title: Util.CallResources(headers[i].Name),
                width: (600 / headers.length - 6)
            }
            columns.add(column);
        }

    }

    return columns;
};

Util.LoadAddressByZipCode = function (zipCode, callback) {

    if (formatter && "pt-br".normalizedEquals(formatter.culture)) {

        zipcode = formatter.unmaskZipCode(zipCode);

        if (zipcode.length == 8) {
            var myControlObj = {};

            var controller = new CheckOutController({ Global: myControlObj });

            if (callback) {
                controller.loadAddressCompleted.attach(function (response) {
                    if (response.CEPInformation) {
                        callback(response.CEPInformation);
                    }
                });
            }

            controller.loadAddress({ CEP: zipCode });
        }
    }
};

Util.complementDateValues = function (dateValues) {
    dateValues.DayOfWeekShortFormmated = formatter.dayOfWeekShort(dateValues.DayOfWeek);
    dateValues.DayMonthFormatted = formatter.dateValuesCustomizedShort(dateValues, "dd/mm");
    dateValues.DayMonthYearFormatted = formatter.dateValuesCustomizedShort(dateValues, "dd/mm/yyyy");
}

Util.GetQueryStringValue = function (Key, QueryString, ReplaceHTMLEncodedChars) {
    var value = Util.QueryString(Key, QueryString);

    if (value && ReplaceHTMLEncodedChars && ReplaceHTMLEncodedChars == true)
        value = unescape(value).replaceAll("---", ")").replaceAll("--", "(");

    return value;
}

Util.isTravelGo = function () {
    return typeof (Ide) == 'undefined';
}

Util.UserResolution = function () {
    var bodyWidth = $("body").width();
    if (bodyWidth <= 767)
        return EnumHelper.UserResolution.Mobile;
    else if (bodyWidth >= 767 && bodyWidth <= 1023)
        return EnumHelper.UserResolution.Tablet;
    else
        return EnumHelper.UserResolution.Desktop;
}

Util.hasNumber = function (content) {
    return /\d/.test(content);
}

Util.getOnlyNumbers = function (text) {
    return text.replace(/[^0-9]/gi, '');
}

Util.GetMonthYear = function (dateValues) {
    if (dateValues && dateValues.Month && dateValues.Year)
        return dateValues.Month + '-' + dateValues.Year;
    else
        return null;
}

Util.ShowModal = function (modalElement, show) {
    if (show == undefined)
        show = true;

    $(modalElement).find('.modalClose')[0].checked = !show;
}

//Util.GetPropertyIndex = function (obj, property) {
//    var idx = 0;
//    for (propName in obj) {
//        var prop = obj[propName];
//        if (property === prop)
//            return idx;
//        idx++;
//    }
//    return -1;
//}

Util.saveAsPDF = function (data) {
    var form = document.createElement("form");
    form.setAttribute("id", "bla");
    form.setAttribute("method", "post");
    form.setAttribute("enctype", "text/plain");
    form.setAttribute("action", '{0}travelagent/SaveAsPDF'.format([Global.RootPath]));
    form.setAttribute("target", "_blank");
    form.setAttribute("style", "display: none;");

    var hiddenField = document.createElement("input");
    hiddenField.setAttribute("name", "data");
    hiddenField.setAttribute("value", data);
    form.appendChild(hiddenField);

    document.body.appendChild(form);
    form.submit();

    document.body.removeChild(form);
}

Util.SendGtagEvent = function (action, category, label) {
    if (!Util.isTravelGo() && !Util.IsSupportUser(Ide.user) && Util.IsGtagInstalled() && Util.IsNotLocalhost()) {
        try {
            if (!action || !category)
                throw "Os parÃ¢metros action e category sÃ£o obrigatÃ³rios para enviar o evento para o Google Analytics.";
            else
                var fieldsObject = { "event_category": category };


            if (label) {
                fieldsObject.event_label = label;
            } else {
                var rootSystemAccountName = Util.GetRootSystemAccountInfo();

                if (!rootSystemAccountName)
                    throw "O evento para o Google Analytics nÃ£o foi disparado pois o rootSystemAccountName retornou vazio";
                else
                    fieldsObject.event_label = rootSystemAccountName;
            }

            //https://developers.google.com/analytics/devguides/collection/gtagjs/events
            gtag('event', action, fieldsObject);

        } catch (err) {
            console.error(err);
        }
    }
}

Util.ConcatenateStringSeparatedBy = function (separator, acc, str, index) {
    if (str) {
        if (index == 0 || acc == '') {
            return str;
        } else {
            return acc + separator + str;
        }
    } else {
        return acc;
    }
}

Util.IsGtagInstalled = function () {
    return typeof window.gtag != 'undefined' && typeof gtag != 'undefined';
}

Util.IsNotLocalhost = function () {
    return location.hostname !== "localhost" && location.hostname !== "127.0.0.1";
}

Util.IsSupportUser = function (user) {
    var ret = false;
    if (user.Username && user.Username.length)
        ret = user.Username.toLowerCase().indexOf("suporte") >= 0;

    return ret;
}

Util.IsAbleToSendGtagEvents = function (rootSystemAccountName) {
    return (!Util.isTravelGo() && rootSystemAccountName && !Util.IsSupportUser(Ide.user) && Util.IsGtagInstalled() && Util.IsNotLocalhost());
}

Util.GetRootSystemAccountInfo = function () {
    return !Util.isTravelGo() && Ide.user.RootSystemAccountName;
}

Util.SendPagePathToGA = function (path) {
    // VariÃ¡vel global GA_MEASUREMENT_ID definida em Site.Master
    if (!Util.isTravelGo() && !Util.IsSupportUser(Ide.user) && Util.IsGtagInstalled() && Util.IsNotLocalhost()) {
        if (GA_MEASUREMENT_ID)
            gtag('config', GA_MEASUREMENT_ID, {
                'page_title': path,
                'page_path': '/' + path
            });
    }
}

Util.IntegrateWithApp = function (serviceOrderController, serviceItemId, serviceOrderId) {
    serviceOrderController.processExtension({
        Operation: 'IntegrateWithApp',
        Parameters: [
            { Key: 'ServiceItemId', Value: serviceItemId },
            { Key: 'ServiceOrderId', Value: serviceOrderId }
        ]
    });
}

Util.NoTraceDownloadTypes = ['Person', 'Proposal', 'ProposalOption'];

Util.getRawPhoneNumber = function (phone) {
    if (phone) {
        phone = phone
            .replaceAll('(', '')
            .replaceAll(')', '')
            .replaceAll(' ', '')
            .replaceAll('-', '')
            .trim();

        if (!phone.startsWith('+55'))
            phone = '+55' + phone;
    }

    return phone;
}

Util.AddPassengerToBusTicket = function (busTickets, passengers){
    // adicionar os onibus na ordem
    var buses = [];
    var busGroupOutbound = busTickets.filter(b => b.IsOutbound === true);
    var busGroupInbound = busTickets.filter(b => b.IsOutbound === false);

    if (busGroupOutbound && busGroupOutbound.length){
        busGroupOutbound[0].BusGroup.Buses.forEach(function (bus) { bus.IsOutbound = true});
        buses.push(...busGroupOutbound[0].BusGroup.Buses);
    }

    if (busGroupInbound && busGroupInbound.length){
        busGroupInbound[0].BusGroup.Buses.forEach(function (bus) { bus.IsOutbound = false});
        buses.push(...busGroupInbound[0].BusGroup.Buses);
    }

    // adiciona o passenger no busTicket para renderizar
    passengers.forEach(function (passenger){
        var seatNumbers = passenger.ExternalProperties.find(e => e.Key === "SeatNumbers").Value.split(',');

        for (var i = 0; i < seatNumbers.length;i ++){
            var seatNumber = seatNumbers[i];
            var busTicket = busTickets.find(b => b.Seat.Number == seatNumber && b.Bus.OriginId == buses[i].OriginId);

            busTicket.Passenger = passenger;
            busTicket.Index = i;
        }
    });
}

function Event() {

    this.listenersByPri = {
        0: [],
        1: [],
        2: []
    };

    var thisEvent = this;
    var listenersByPriority = this.listenersByPri;

    this.count = function () { return getListeners().length; };

    this.attach = function (callback, priority, context, once) {

        if (typeof (priority) == "undefined")
            priority = EnumHelper.EventPriority["High"];

        listenersByPriority[priority].push({ callback: callback, context: context, once: once });
    };

    this.isEvent = true;

    this.notify = function () {
        for (var item in listenersByPriority) {
            if (listenersByPriority[item]) {
                var list = listenersByPriority[item];
                for (var i = 0; i < list.length; i++) {
                    if (list[i].callback) 
                        list[i].callback.apply(list[i].context || this, arguments);

                    if (list[i].once)
                        thisEvent.dettach(list[i].callback);
                }
            }
        }
    };

    this.dettach = function (listenerToRemove) {
        if (listenerToRemove) {
            for (var item in listenersByPriority) {
                if (listenersByPriority[item])
                    listenersByPriority[item] = listenersByPriority[item].removeAll(function (f) { return f.callback == listenerToRemove });
            }
        }
        else {
            listenersByPriority = {
                0: [],
                1: [],
                2: []
            };
        }
    };

    thisEvent.detach = thisEvent.dettach; //o correto Ã© detach com um Ãºnico 't'

    this.dettachAndAttach = function (listener) {
        thisEvent.dettach(listener);
        thisEvent.attach(listener);
    };

    this.forceDettachAll = function (listenerToRemove) {
        var toRemoveString = listenerToRemove.toString();
        for (var item in listenersByPriority) {
            if (listenersByPriority[item]) {
                listenersByPriority[item] = listenersByPriority[item].removeAll(function (h) { return h.callback.toString() == toRemoveString; });
            }
        }
    };

    this.getListeners = function () {

        var listeners = [];

        for (var item in listenersByPriority) {
            if (listenersByPriority[item]) {
                var list = listenersByPriority[item];
                for (var i = 0; i < list.length; i++)
                    listeners.push(list[i].callback);
            }
        }

        return listeners;
    };
};

var etsEvent = Event; //utilizado no TypeScript


ï»¿var formatter = new (function () {
    if (typeof Global == 'undefined')
        Global = {};

    this.culture = Global.Culture && Global.Culture.length ? Global.Culture.toLowerCase() : "pt-br";
    this.language = this.culture.substr(0, 2);

    this.daysOfWeekMin = {
        'en-us': ['S', 'M', 'T', 'W', 'Th', 'F', 'Sa', 'S'],
        'pt-br': ['D', 'S', 'T', 'Q', 'Q', 'S', 'S', 'D'],
        'es-ar': ['D', 'L', 'M', 'Mi', 'J', 'V', 'S', 'D'],
        'es-mx': ['D', 'L', 'M', 'Mi', 'J', 'V', 'S', 'D'],
        'es-ve': ['D', 'L', 'M', 'Mi', 'J', 'V', 'S', 'D']
    };

    this.daysOfWeekShort = {
        'en-us': ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
        'pt-br': ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'SÃ¡b', 'Dom'],
        'es-ar': ['Dom', 'Lun', 'Mar', 'MiÃ©', 'Jue', 'Vie', 'SÃ¡b', 'Dom'],
        'es-mx': ['Dom', 'Lun', 'Mar', 'MiÃ©', 'Jue', 'Vie', 'SÃ¡b', 'Dom'],
        'es-ve': ['Dom', 'Lun', 'Mar', 'MiÃ©', 'Jue', 'Vie', 'SÃ¡b', 'Dom']
    };

    this.monthNamesShort = {
        'en-us': ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        'pt-br': ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
        'es-ar': ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
        'es-mx': ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
        'es-ve': ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic']
    };

    this.daysOfWeek = {
        'en-us': ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", 'Saturday', "Sunday"],
        'pt-br': ["Domingo", "Segunda", "TerÃ§a", "Quarta", "Quinta", "Sexta", "SÃ¡bado", "Domingo"],
        'es-ar': ["Domingo", "Lunes", "Martes", "MiÃ©rcoles", "Jueves", "Viernes", "SÃ¡bado", "Domingo"],
        'es-mx': ["Domingo", "Lunes", "Martes", "MiÃ©rcoles", "Jueves", "Viernes", "SÃ¡bado", "Domingo"],
        'es-ve': ["Domingo", "Lunes", "Martes", "MiÃ©rcoles", "Jueves", "Viernes", "SÃ¡bado", "Domingo"]
    };

    this.dayOfWeekShort = function (d) {
        return formatter.daysOfWeekShort[formatter.culture][d];
    }

    this.dayOfWeek = function (d) {
        return formatter.daysOfWeek[formatter.culture][d];
    };

    this.monthNames = {
        'en-us': ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
        'pt-br': ['Janeiro', 'Fevereiro', 'MarÃ§o', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
        'es-ar': ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo ', 'Junioââ', 'Julio', 'Agosto', 'Septiembre ', 'Octubre ', 'Noviembre', 'Diciembre'],
        'es-mx': ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo ', 'Junioââ', 'Julio', 'Agosto', 'Septiembre ', 'Octubre ', 'Noviembre', 'Diciembre'],
        'es-ve': ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo ', 'Junioââ', 'Julio', 'Agosto', 'Septiembre ', 'Octubre ', 'Noviembre', 'Diciembre']
    };

    this.timeText = {
        'en-us': "Time",
        'pt-br': "HorÃ¡rio",
        'es-ar': "Horario",
        'es-mx': "Horario",
        'es-ve': "Horario"
    };

    this.hourText = {
        'en-us': "Hour",
        'pt-br': "Hora",
        'es-ar': "Hora",
        'es-mx': "Hora",
        'es-ve': "Hora"
    };

    this.minuteText = {
        'en-us': "Minute",
        'pt-br': "Minuto",
        'es-ar': "Minuto",
        'es-mx': "Minuto",
        'es-ve': "Minuto"
    };

    this.monthName = function (m) {
        return formatter.monthNames[formatter.culture][m - 1];
    };

    this.toTwoDigits = function (number) {
        var parsed = parseInt(number, 10);
        return (parsed < 10 ? "0" : "") + parsed;
    };

    this.monthNameShort = function (m) {
        return formatter.monthNamesShort[formatter.culture][m - 1];
    };

    var dateValuesShortFunctions = {
        "pt-br": function (dt) { return formatter.toTwoDigits(dt.Day) + "/" + formatter.toTwoDigits(dt.Month) + "/" + dt.Year; },
        "en-us": function (dt) { return formatter.toTwoDigits(dt.Month) + "/" + formatter.toTwoDigits(dt.Day) + "/" + dt.Year; },
        "es-ar": function (dt) { return formatter.toTwoDigits(dt.Day) + "/" + formatter.toTwoDigits(dt.Month) + "/" + dt.Year; },
        "es-mx": function (dt) { return formatter.toTwoDigits(dt.Day) + "/" + formatter.toTwoDigits(dt.Month) + "/" + dt.Year; },
        "es-ve": function (dt) { return formatter.toTwoDigits(dt.Day) + "/" + formatter.toTwoDigits(dt.Month) + "/" + dt.Year; }
    };

    /* returns specific day/month/year type */
    this.dateValuesShort = function (dt) {
        return !dt ? "" : dateValuesShortFunctions[formatter.culture](dt);
    };

    this.dateValuesShortWithCulture = function (dt, culture) {
        return !dt ? "" : dateValuesShortFunctions[culture](dt);
    };

    var dateFormatFunctions = {
        "pt-br": function () { return 'DD-MM-YYYY'; },
        "en-us": function () { return 'MM-DD-YYYY'; },
        "es-ar": function () { return 'DD-MM-YYYY'; },
        "es-mx": function () { return 'DD-MM-YYYY'; },
        "es-ve": function () { return 'DD-MM-YYYY'; }
    };
    var slashDateFormatAbreviatedYearFunctions = {
        "pt-br": function () { return 'dd/mm/yy'; },
        "en-us": function () { return 'mm/dd/yy'; },
        "es-ar": function () { return 'dd/mm/yy'; },
        "es-mx": function () { return 'dd/mm/yy'; },
        "es-ve": function () { return 'dd/mm/yy'; }
    };
    var slashDateFormatYearFunctions = {
        "pt-br": function () { return 'dd/mm/yyyy'; },
        "en-us": function () { return 'mm/dd/yyyy'; },
        "es-ar": function () { return 'dd/mm/yyyy'; },
        "es-mx": function () { return 'dd/mm/yyyy'; },
        "es-ve": function () { return 'dd/mm/yyyy'; }
    };
    var dateFormatRegularExpressions = {
        "pt-br": function () { return /^((0[1-9]|[12]\d)\/(0[1-9]|1[0-2])|30\/(0[13-9]|1[0-2])|31\/(0[13578]|1[02]))\/\d{4}$/;/*29/02/2010*/ },
        "en-us": function () { return /(0[1-9]|1[012])[- \/.](0[1-9]|[12][0-9]|3[01])[- \/.](19|20)\d\d/; /*08/17/2015*/ },
        "es-ar": function () { return /^((0[1-9]|[12]\d)\/(0[1-9]|1[0-2])|30\/(0[13-9]|1[0-2])|31\/(0[13578]|1[02]))\/\d{4}$/;/*29/02/2010*/ },
        "es-mx": function () { return /^((0[1-9]|[12]\d)\/(0[1-9]|1[0-2])|30\/(0[13-9]|1[0-2])|31\/(0[13578]|1[02]))\/\d{4}$/;/*29/02/2010*/ },
        "es-ve": function () { return /^((0[1-9]|[12]\d)\/(0[1-9]|1[0-2])|30\/(0[13-9]|1[0-2])|31\/(0[13578]|1[02]))\/\d{4}$/;/*29/02/2010*/ }
    };

    this.dateFormatWithCulture = function () {
        return dateFormatFunctions[formatter.culture]();
    }
    this.slashDateFormatAbreviatedYearWithCulture = function () {
        return slashDateFormatAbreviatedYearFunctions[formatter.culture]();
    }
    this.slashDateFormatYearWithCulture = function () {
        return slashDateFormatYearFunctions[formatter.culture]();
    }
    this.dateFormatRegularExpression = function (argCulture) {
        var cult = (argCulture) ? argCulture : this.culture;
        return dateFormatRegularExpressions[cult]();
    }

    /* returns specific customize formatter date */
    this.dateValuesCustomizedShort = function (dt, customize) {
        switch (customize) {
            case 'dd/mm':
                return dateValuesShortFunctions[formatter.culture](dt).replace(/\/\d{4}/, '');
            case 'mm/yyyy':
                return dateValuesShortFunctions[formatter.culture](dt).replace(/\/\d{2}/, '');
        }

        return dateValuesShortFunctions[formatter.culture](dt);
    };

    /* returns specific day/month/year type */
    this.dateValuesShortWithCulture = function (dt, culture) {
        return dateValuesShortFunctions[culture](dt);
    };

    var dateValuesLongFunctions = {
        "pt-br": function (dt) { return formatter.dayOfWeek(dt.DayOfWeek) + ", " + dt.Day + " de " + formatter.monthName(dt.Month) + " de " + dt.Year; },
        "en-us": function (dt) { return formatter.dayOfWeek(dt.DayOfWeek) + ", " + formatter.monthName(dt.Month) + " " + dt.Day + ", " + dt.Year; },
        "es-ar": function (dt) { return formatter.dayOfWeek(dt.DayOfWeek) + ", " + dt.Day + " de " + formatter.monthName(dt.Month) + " de " + dt.Year; },
        "es-mx": function (dt) { return formatter.dayOfWeek(dt.DayOfWeek) + ", " + dt.Day + " de " + formatter.monthName(dt.Month) + " de " + dt.Year; },
        "es-ve": function (dt) { return formatter.dayOfWeek(dt.DayOfWeek) + ", " + dt.Day + " de " + formatter.monthName(dt.Month) + " de " + dt.Year; }
    };

    this.dateValuesLong = function (dt) {
        return dateValuesLongFunctions[formatter.culture](dt);
    };

    var dateValuesLongAbbreviatedFunctions = {
        "pt-br": function (dt) { return formatter.dayOfWeekShort(dt.DayOfWeek) + ", " + dt.Day + " " + formatter.monthName(dt.Month) + " " + dt.Year; },
        "en-us": function (dt) { return formatter.dayOfWeekShort(dt.DayOfWeek) + ", " + formatter.monthName(dt.Month) + " " + dt.Day + ", " + dt.Year; },
        "es-ar": function (dt) { return formatter.dayOfWeekShort(dt.DayOfWeek) + ", " + dt.Day + " " + formatter.monthName(dt.Month) + " " + dt.Year; },
        "es-mx": function (dt) { return formatter.dayOfWeekShort(dt.DayOfWeek) + ", " + dt.Day + " " + formatter.monthName(dt.Month) + " " + dt.Year; },
        "es-ve": function (dt) { return formatter.dayOfWeekShort(dt.DayOfWeek) + ", " + dt.Day + " " + formatter.monthName(dt.Month) + " " + dt.Year; }
    };

    this.dateValuesLongAbbreviated = function (dt) {
        return dateValuesLongAbbreviatedFunctions[formatter.culture](dt);
    };

    this.dateValuesToDate = function (dt) {
        if (dt.Year != undefined && dt.Month != undefined && dt.Day != undefined)
            return new Date(dt.Year, dt.Month - 1, dt.Day);

        return null;
    };

    this.timeValueCompleteShort = function (dt) {
        return this.timeValuesShort(dt) + ":" + (dt.Seconds < 10 ? "0" : "") + dt.Seconds;
    };

    var timeValuesShortFunctions = {
        "pt-br": function (dt) { return (dt.Hour.toString().length == 1 ? "0" : "") + dt.Hour + ":" + (dt.Minutes.toString().length == 1 ? "0" : "") + dt.Minutes; },
        "en-us": function (dt) { return ((dt.Hour > 12) ? (dt.Hour - 12).toString() : dt.Hour.toString()) + ':' + ((dt.Minutes < 10) ? '0' : '') + dt.Minutes.toString() + ' ' + ((dt.Hour > 11) ? 'pm' : 'am'); },
        "es-ar": function (dt) { return (dt.Hour.toString().length == 1 ? "0" : "") + dt.Hour + ":" + (dt.Minutes.toString().length == 1 ? "0" : "") + dt.Minutes; },
        "es-mx": function (dt) { return (dt.Hour.toString().length == 1 ? "0" : "") + dt.Hour + ":" + (dt.Minutes.toString().length == 1 ? "0" : "") + dt.Minutes; },
        "es-ve": function (dt) { return (dt.Hour.toString().length == 1 ? "0" : "") + dt.Hour + ":" + (dt.Minutes.toString().length == 1 ? "0" : "") + dt.Minutes; }
    };

    /* return 13:00 mode */
    this.timeValuesShort = function (dt) {
        if (dt)
            return timeValuesShortFunctions[formatter.culture](dt);
        else
            return null;
    };

    /* return 13:00 mode */
    this.intTimeValuesShort = function (dt) {

        if (dt >= 0) {
            var res = Util.IntTimeToDateTime(dt);
            if (res) {
                var hours = String(res.getHours());
                var minutes = String(res.getMinutes());
                return (hours.length == 1 ? "0" : "") + hours + ":" + (minutes.length == 1 ? "0" : "") + minutes;
            }
        }

        else
            return null;
    };

    this.timeValuesShortSimple = function (dt) {

        if (!isNaN(dt)) {
            var rest = dt % 60;
            var hours = (dt - rest) / 60;
            dt = { Hour: hours, Minutes: rest };
        }

        return (dt.Hour < 10 ? "0" : "") + dt.Hour + ":" + (dt.Minutes < 10 ? "0" : "") + dt.Minutes;
    };

    var timeValuesLongFunctions = {
        "pt-br": function (dt) { return (dt.Hour < 10 ? "0" : "") + dt.Hour + (dt.Hour > 1 ? " horas e " : " hora e ") + (dt.Minutes < 10 ? "0" : "") + dt.Minutes + (dt.Minutes > 1 ? " minutos" : " minuto"); },
        "en-us": function (dt) { return (dt.Hour < 10 ? "0" : "") + dt.Hour + (dt.Hour > 1 ? " hours and " : " hour and ") + (dt.Minutes < 10 ? "0" : "") + dt.Minutes + (dt.Minutes > 1 ? " minutes" : " minute"); },
        "es-ar": function (dt) { return (dt.Hour < 10 ? "0" : "") + dt.Hour + (dt.Hour > 1 ? " horas y " : " hora y ") + (dt.Minutes < 10 ? "0" : "") + dt.Minutes + (dt.Minutes > 1 ? " minutos" : " minuto"); },
        "es-mx": function (dt) { return (dt.Hour < 10 ? "0" : "") + dt.Hour + (dt.Hour > 1 ? " horas y " : " hora y ") + (dt.Minutes < 10 ? "0" : "") + dt.Minutes + (dt.Minutes > 1 ? " minutos" : " minuto"); },
        "es-ve": function (dt) { return (dt.Hour < 10 ? "0" : "") + dt.Hour + (dt.Hour > 1 ? " horas y " : " hora y ") + (dt.Minutes < 10 ? "0" : "") + dt.Minutes + (dt.Minutes > 1 ? " minutos" : " minuto"); }
    };

    this.dateMonthYearLong = function (dt) {
        return formatter.dayOfWeekShort[dt.DayOfWeek] + ", " + dt.Day + " " + formatter.monthName[dt.Month] + " " + dt.Year;
    };

    this.timeValuesLong = function (dt) {

        if (!isNaN(dt)) {
            var rest = dt % 60;
            var hours = (dt - rest) / 60;
            dt = { Hour: hours, Minutes: rest };
        }

        return timeValuesLongFunctions[formatter.culture](dt);
    };

    this.dateTimeValuesComplete = function (dt, full) {
        if (full)
            return dateValuesShortFunctions[formatter.culture](dt) + " " + formatter.timeValueCompleteShort(dt);
        else
            return dateValuesShortFunctions[formatter.culture](dt) + " " + formatter.timeValuesShort(dt);
    };

    this.currencyDefaults = {
        "BRL": { thousandSeparator: ".", decimalSeparator: ",", symbol: "R$" },
        "USD": { thousandSeparator: ",", decimalSeparator: ".", symbol: "US$" },
        "ARS": { thousandSeparator: ".", decimalSeparator: ",", symbol: "$" },
        "ENV": { thousandSeparator: ".", decimalSeparator: ",", symbol: "$" },
        "EUR": { thousandSeparator: ".", decimalSeparator: ",", symbol: "â¬" },
        "GBP": { thousandSeparator: ".", decimalSeparator: ",", symbol: "Â£" },
        "VEF": { thousandSeparator: ".", decimalSeparator: ",", symbol: "Bs." },
        "VES": { thousandSeparator: ".", decimalSeparator: ",", symbol: "Bs.S" },
    };

    this.currencyType = function () {
        if (Global && typeof (Global.CurrencyCode) !== "undefined" && Global.CurrencyCode.length === 3)
            return Global.CurrencyCode.toUpperCase();

        if (!formatter.culture)
            return "BRL";

        switch (formatter.culture.toLowerCase()) {
            case "pt-br":
                return "BRL"; break;
            case "en-us":
                return "USD"; break;
            case "es-ar":
                return "ARS"; break;
            case "es-ve":
                return "VEF"; break;
            default:
                return "BRL";
        }
    };

    this.currentCurrency = function () {
        return formatter.currencyDefaults[formatter.currencyType()];
    }

    /**
    * Decimal adjustment of a number. Source: Mozilla
    *
    * @param   {String}    type    The type of adjustment.
    * @param   {Number}    value   The number.
    * @param   {Integer}   exp     The exponent (the 10 logarithm of the adjustment base).
    * @returns {Number}            The adjusted value.
    */
    function decimalAdjust(type, value, exp) {
        // If the exp is undefined or zero...
        if (typeof exp === 'undefined' || +exp === 0) {
            return Math[type](value);
        }
        value = +value;
        exp = +exp;
        // If the value is not a number or the exp is not an integer...
        if (isNaN(value) || !(typeof exp === 'number' && exp % 1 === 0)) {
            return NaN;
        }
        exp *= -1;

        // Shift
        value = value.toString().split('e');
        value = Math[type](+(value[0] + 'e' + (value[1] ? (+value[1] - exp) : -exp)));
        // Shift back
        value = value.toString().split('e');
        return +(value[0] + 'e' + (value[1] ? (+value[1] + exp) : exp));
    }

    // Decimal round
    if (!Math.round10) {
        Math.round10 = function (value, exp) {
            return decimalAdjust('round', value, exp);
        };
    }
    // Decimal floor
    if (!Math.floor10) {
        Math.floor10 = function (value, exp) {
            return decimalAdjust('floor', value, exp);
        };
    }
    // Decimal ceil
    if (!Math.ceil10) {
        Math.ceil10 = function (value, exp) {
            return decimalAdjust('ceil', value, exp);
        };
    }

    this.currency = function (number, useCurrencySymbol, precision, currency, onlyDecimalSeparator) {

        try {
            if (isNaN(precision))
                precision = 0;
        } catch (e) {
            precision = 0;
        }

        number = Math.round10(number, precision);
        if (isNaN(number))
            return "NaN";

        var isNegativeValue = number < 0;

        if (isNegativeValue)
            number *= -1;

        var integerpart = '' + Math.floor(number);
        var decimalpart = (number - integerpart).toFixed(precision);

        if (precision == 0)
            integerpart = parseInt(integerpart) + parseInt(decimalpart) + '';

        for (var i = 0; i < precision; i++)
            decimalpart = decimalpart * 10;

        if (precision)
            decimalpart = parseInt(decimalpart.toFixed(0));

        var buff = [];

        if (!currency) {
            if (Global.UseCurrencyCode) {
                currency = Global.CurrencyCode;
            }
            else if (Global.UseSymbolsFromThisCulture) {
                var culture = formatter.culture;
                formatter.culture = Global.UseSymbolsFromThisCulture;
                currency = formatter.currencyType();
                formatter.culture = culture;
            } else {
                currency = formatter.currencyType();
            }
        }

        var buffFormater = formatter.currencyDefaults[currency] || formatter.currencyDefaults["ENV"];

        if (onlyDecimalSeparator) {
            buff.push(integerpart);
        } else {
            for (var j = -1, i = integerpart.length; i >= 0; i--, j++) {

                if ((j % 3) == 0 && j > 1)
                    buff.push(buffFormater.thousandSeparator);

                buff.push(integerpart.charAt(i));
            }
        }

        buff = buff.reverse();

        if (precision > 0) {

            buff.push(buffFormater.decimalSeparator);
            buff.push(formatter.padLeft(decimalpart, precision, "0"));
        }

        buff = buff.reverse();

        if (isNegativeValue)
            buff.push("-");

        if (useCurrencySymbol == undefined || useCurrencySymbol) {
            buff.push(" ");
            buff.push(Global.UseCurrencyCode ? currency : buffFormater.symbol);
        }

        return buff.reverse().join('');
    };

    this.toCurrencyUSD = function (number, useCurrencySymbol, precision) {
        if (number.trim().length == 0)
            number = "0";

        var currencyCode = Global.UseCurrencyCode ? Global.CurrencyCode : formatter.currencyType();

        if (currencyCode != "USD") {
            var buffFormater = formatter.currencyDefaults[currencyCode] || formatter.currencyDefaults["ENV"];

            var USDFormater = formatter.currencyDefaults["USD"];

            var regexThousandSeparator = new RegExp("[" + buffFormater.thousandSeparator + "]", "gi");

            var regexDecimalSeparator = new RegExp("[" + buffFormater.decimalSeparator + "]", "gi");

            number = number.replace(regexThousandSeparator, '');

            number = number.replace(regexDecimalSeparator, USDFormater.decimalSeparator);
        }

        return formatter.currency(number, useCurrencySymbol, precision, "USD");
    };

    this.currencyToDecimal = function (currency) {
        var reg = new RegExp("[^0-9" + formatter.currentCurrency().decimalSeparator + "]", "gi");

        var dec = currency.replace(reg, "");
        dec = dec.replace(formatter.currentCurrency().decimalSeparator, ".");

        return parseFloat(dec);
    }

    this.padLeft = function (value, length, charPad) {

        if (!charPad)
            charPad = "0";
        if (!value)
            value = "";
        if (!length)
            return value;
        if (length == 0)
            return value;

        var strValue = String(value);
        if (strValue.length >= length)
            return strValue;

        var valueWithPad = strValue;
        for (var i = 0; i < length && valueWithPad.length < length; i++) {
            valueWithPad = charPad + valueWithPad;
        }
        return valueWithPad;
    }

    /* DISTANCES */
    var kilometersToMiles = function (value) {
        return (value / 1.609).toFixed(2);
    };

    var formattedDistances = {
        "pt-br": function (distance) { return distance + " km"; },
        "en-us": function (distance) { return kilometersToMiles(distance) + " mi"; },
        "es-ar": function (distance) { return distance + " km"; },
        "es-mx": function (distance) { return distance + " km"; },
        "es-ve": function (distance) { return distance + " km"; }
    };

    this.distance = function (value) {
        value = parseFloat(parseFloat(value).toFixed(2));
        return formattedDistances[formatter.culture](value);
    };

    /* TIMES */
    this.numericTime = function (dt) {
        return parseFloat(dt.Hour + (dt.Minutes < 10 ? "0" : "") + dt.Minutes);
    };

    var zipCodeMasks = {
        "pt-br": "99999-999",
        "en-us": "",
        "es-ar": "",
        "es-mx": "",
        "es-ve": ""
    };

    this.zipCodeMask = function () {
        return zipCodeMasks[formatter.culture];
    };

    this.zipCode = function (zipCode) {
        var cultureMask = zipCodeMasks[formatter.culture];
        zipCode = zipCode.toString();
        var zipCodeFormatted = zipCode;

        if (cultureMask.length) {
            zipCodeFormatted = '';
            var zipCodePosition = zipCode.length - 1;
            var zipCodeMaskLength = cultureMask.length - 1;

            for (var i = 0; i < cultureMask.length; i++)
                if (!isNaN(cultureMask[i]))
                    zipCodeFormatted += '?';
                else
                    zipCodeFormatted += cultureMask[i];

            zipCodeFormatted = zipCodeFormatted.split('');

            for (var i = zipCodeMaskLength; i >= 0; i--) {
                if (zipCode[zipCodePosition] && zipCodeFormatted[i] == '?') {
                    zipCodeFormatted[i] = zipCode[zipCodePosition];
                    zipCodePosition--;
                }
            }

            var aux = '';
            for (var i = 0; i <= zipCodeMaskLength; i++)
                if (zipCodeFormatted[i] != '?')
                    aux += zipCodeFormatted[i];

            zipCodeFormatted = aux;
        }

        return zipCodeFormatted;
    }

    this.unmaskZipCode = function (zipcodemaked) {
        var zipcode = "";
        if (zipcodemaked) {
            for (var i = 0; i < zipcodemaked.length; i++) {
                if (!isNaN(zipcodemaked[i]))
                    zipcode += zipcodemaked[i];
            }
        }
        return zipcode;
    }

    var juridicalDocumentMasks = {
        "pt-br": "99.999.999/9999-99",
        "en-us": "",
        "es-ar": "",
        "es-mx": "",
        "es-ve": ""
    };

    this.juridicalDocumentMask = function () {
        return juridicalDocumentMasks[formatter.culture];
    }

    var phoneNumberMasks = {
        "pt-br": "9999-9999?9",
        "en-us": "",
        "es-ar": "",
        "es-mx": "",
        "es-ve": "999-99-99"
    };

    this.phoneNumberMask = function () {
        return phoneNumberMasks[formatter.culture];
    };

    var phonePrefixMasks = {
        "pt-br": "(99)",
        "en-us": "",
        "es-ar": "",
        "es-mx": "",
        "es-ve": "(999)"
    };

    this.phonePrefixMask = function () {
        return phonePrefixMasks[formatter.culture];
    };

    this.formatPhoneNumber = function (value) {

        var culturesFunction =
            {
                'pt-br': function (value) {
                    var mask = value.substring(0, 4);

                    if (value.length <= 4)
                        return mask;

                    mask += '-' + value.substring(4);

                    if (value.length <= 8)
                        return mask;

                    mask = value.substring(0, 5) + '-' + value.substring(5, 9);

                    return mask;
                },
                'en-us': function (value) {
                    return value;
                },
                'es-ar': function (value) {
                    return value;
                },
                'es-mx': function (value) {
                    return value;
                },
                'es-ve': function (value) {

                    var mask = value.substring(0, 3);

                    if (value.length <= 3)
                        return mask;

                    mask += '-' + value.substring(3, 5);

                    if (value.length <= 5)
                        return mask;

                    mask += '-' + value.substring(5, 7);

                    return mask
                }
            }

        var mask = culturesFunction[formatter.culture](value);

        return mask;

    }

    this.completePhoneNumberMask = function (value) {
        var mask = "";
        if (value.length > 0) {
            if (value.length <= 2)
                mask = '(' + value;
            if (value.length > 2 && value.length <= 6)
                mask = '(' + value.substring(0, 2) + ') ' + value.substring(2, value.length);
            if (value.length > 6 && value.length <= 10)
                mask = '(' + value.substring(0, 2) + ') ' + value.substring(2, 6) + '-' + value.substring(6, value.length);
            if (value.length > 10)
                mask = '(' + value.substring(0, 2) + ') ' + value.substring(2, 7) + '-' + value.substring(7, 11);
        }

        return mask;
    }

    this.completeCNPJMask = function (value) {
        var mask = "";
        if (value.length == 2)
            mask = value + '.';
        else if (value.length == 6)
            mask =  value + '.';
        else if (value.length == 10)
            mask = value + '/';
        else if (value.length == 15)
            mask = value + '-';        
        else
            mask = value;
      

        return mask;
    }

    this.numberUnmask = function (value) {
        var mask = "";
        for (var i = 0; i < value.length; i++) {
            if (value[i] != ' ' && !isNaN(value[i]))
                mask += value[i].toString();
        }

        return mask;
    }

    var documentMasks = {
        "pt-br": "999.999.999-99",
        "en-us": "",
        "es-ar": "",
        "es-mx": "",
        "es-ve": ""
    };

    this.documentMask = function () {
        return documentMasks[formatter.culture];
    }

    var zipCodeValidations = {
        "pt-br": function (cep) { return cep.length == 9; },
        "en-us": function (cep) { return true; },
        "es-ar": function (cep) { return true; },
        "es-mx": function (cep) { return true; },
        "es-ve": function (cep) { return true; }
    };

    this.zipCodeValidation = function (cep) {
        return zipCodeValidations[formatter.culture](cep);
    };

    var documentValidations = {
        "pt-br": function (document) { return document.isCPF(); },
        "en-us": function (document) { return true; },
        "es-ar": function (document) { return true; },
        "es-mx": function (document) { return true; },
        "es-ve": function (document) { return true; }
    };

    this.documentValidation = function (document) {
        return documentValidations[formatter.culture](document);
    };

    var phoneNumberValidations = {
        "pt-br": function (phoneNumber) { return phoneNumber.length == 8 || phoneNumber.length == 9; },
        "en-us": function (phoneNumber) { return true; },
        "es-ar": function (phoneNumber) { return true; },
        "es-mx": function (phoneNumber) { return true; },
        "es-ve": function (phoneNumber) { return true; }
    };

    this.phoneNumberValidation = function (phoneNumber) {
        return phoneNumberValidations[formatter.culture](phoneNumber);
    };

    var prefixNumberValidations = {
        "pt-br": function (prefixNumber) { return prefixNumber.length == 2; },
        "en-us": function (prefixNumber) { return true; },
        "es-ar": function (prefixNumber) { return true; },
        "es-mx": function (prefixNumber) { return true; },
        "es-ve": function (prefixNumber) { return true; }
    };

    this.prefixNumberValidation = function (prefixNumber) {
        return prefixNumberValidations[formatter.culture](prefixNumber);
    };

    var listOfStates = {
        "pt-br": ["AC", "AL", "AP", "AM", "BA", "CE", "DF", "ES", "GO", "MA", "MT", "MS", "MG", "PA", "PB", "PR", "PE", "PI", "RJ", "RN", "RS", "RO", "RR", "SC", "SP", "SE", "TO"],
        "en-us": [],
        "es-ar": ["C", "B", "K", "H", "U", "X", "W", "E", "P", "Y", "L", "F", "M", "N", "Q", "R", "A", "J", "D", "Z", "S", "G", "V", "T"],
        "es-mx": [],
        "es-ve": ["C", "B", "K", "H", "U", "X", "W", "E", "P", "Y", "L", "F", "M", "N", "Q", "R", "A", "J", "D", "Z", "S", "G", "V", "T"]
    };

    this.states = function () {
        return listOfStates[formatter.culture];
    };

    this.cpf = function (cpf) {
        var cpfFormatted = "";

        cpf = cpf.replace(/[^0-9]/gi, "");

        if (cpf.length == 11)
            cpf = cpf.substring(0, 3) + "." + cpf.substring(3, 6) + "." + cpf.substring(6, 9) + "-" + cpf.substring(9, 11);

        return cpf;
    };

    this.FormatPercentage = function (value, decimalHouses) {
        if (typeof decimalHouses === 'undefined')
            decimalHouses = 2;
        return (value.toFixed(decimalHouses) * 100).toFixed(decimalHouses) + '%';
    };

    this.formatMinutesInHours = function (_minutes) {
        var hours = Math.floor(_minutes / 60);
        var minutes = _minutes % 60;

        if (minutes > 9)
            return Util.StringFormat("{0}:{1}", hours, minutes);

        return Util.StringFormat("{0}:0{1}", hours, minutes);
    };

    this.currencyTranslate = function (currencyCode, cultureInfo) {
        var translate = Global.Currencies || {
            BRL: {
                'pt-br': 'Real',
                'en-us': 'Real',
                'es-ar': 'Real',
                'es-mx': 'Real',
                'es-ve': 'Real'
            },
            USD: {
                'pt-br': 'DÃ³lar',
                'en-us': 'Dollar',
                'es-ar': 'DÃ³lar',
                'es-mx': 'DÃ³lar',
                'es-ve': 'DÃ³lar'
            },
            VEF: {
                'pt-br': 'BolÃ­var',
                'en-us': 'Bolivar',
                'es-ar': 'BolÃ­var',
                'es-mx': 'BolÃ­var',
                'es-ve': 'BolÃ­var'
            },
            EUR: {
                'pt-br': 'Euro',
                'en-us': 'Euro',
                'es-ar': 'Euro',
                'es-mx': 'Euro',
                'es-ve': 'Euro'
            },
            JPY: {
                'pt-br': 'Iene',
                'en-us': 'Iene',
                'es-ar': 'Iene',
                'es-mx': 'Iene',
                'es-ve': 'Iene'
            }
        };

        return translate[currencyCode.toUpperCase()][cultureInfo.toLowerCase()];
    };

    this.PassengerTypeTranslate = function (passengerType, culture) {
        //Ref: EnumHelper.Passenger.PassengerTypeTranslate
        var passengerTranslate = {
            "pt-br": { 0: "Adulto", 1: "CrianÃ§a", 2: "BebÃª" },
            "es-ve": { 0: "Adulto", 1: "NinÃµ", 2: "BebÃ©" },
            "en-us": { 0: "Adult", 1: "Children", 2: "Baby" }
        };

        culture = culture.toLowerCase();
        var translated = passengerTranslate[culture][passengerType];

        return translated;
    };

    this.temp = {};
})();

function FormattedValue(value, currency, useCurrencySymbol, isDate) {
    var __this = this;
    __this.Value = value;
    __this.Formatted = '';
    __this.IsNegative = value < 0;

    if (value != undefined) {
        if (isDate)
            __this.Formatted = formatter.dateValuesShort(value);
        else
            __this.Formatted = formatter.currency(value, useCurrencySymbol, 2, currency);
    }

    return __this;
}


//#region MODULES FOR POINTS TEMPLATES
(function (f) {
    var module = {};
    var DEFAULTS = {
        name: 'Pontos',
        shortName: 'Pts',
        position: { 'left': 0, 'right': 1 },
        separator: ' ',
        precision: 0
    };
    var model = {
        type: DEFAULTS.type,
        symbol: {
            name: DEFAULTS.name,
            position: DEFAULTS.position.right,
            separator: DEFAULTS.separator
        }
    };

    function isSymbolRight(symbol) {
        return symbol.position === DEFAULTS.position.right;
    }
    function isSymbolLeft(symbol) {
        return symbol.position === DEFAULTS.position.left;
    }

    module.getSymbolName = function () {
        return model.symbol.name;
    }

    module.toFixed = function (value) {

        if (typeof value === 'string')
            value = parseFloat(value);

        return value.toFixed(DEFAULTS.precision);
    }
    module.toString = function (value) {
        var symbol = model.symbol;
        if (isSymbolRight(symbol))
            return module.toStringValue(value) + symbol.separator + symbol.name;

        if (isSymbolLeft(symbol))
            return symbol.name + symbol.separator + module.toStringValue(value);

        return undefined;
    }

    module.toShortString = function (value) {
        var symbol = model.symbol;
        if (isSymbolRight(symbol))
            return module.toStringValue(value) + symbol.separator + symbol.shortName;

        if (isSymbolLeft(symbol))
            return symbol.shortName + symbol.separator + module.toStringValue(value);

        return undefined;
    }

    module.toStringValue = function (value) {
        return f.currency(value, false, DEFAULTS.precision);
    }

    module.changeName = function (name) {
        model.symbol.name = name;
    }

    module.changeShortName = function (shortName) {
        model.symbol.shortName = shortName;
    }

    module.changePosition = function (name) {
        var candidate = DEFAULTS.position[name];

        if (typeof candidate === 'undefined')
            console.log('is not valid candidate: "' + name + '"');
        else {
            model.symbol.position = candidate;
        }
    }

    module.changeSeparator = function (name) {
        if (name !== undefined)
            model.symbol.separator = name;
    };

    module.switchPosition = function () {
        var symbol = model.symbol;
        if (isSymbolRight(symbol))
            symbol.position = DEFAULTS.position.left;
        else
            symbol.position = DEFAULTS.position.right;
    }

    //OBSOLETE: prefer "formatter.coins.getPoints().getSymbolName()"
    f.pointsUnits = module.getSymbolName();

    //OBSOLETE: prefer "formatter.coins.getPoints().toString(value)"
    f.Points = function (points) {
        return f.coins.getPoints().toString(points);
    };

    f.FormatToDisplay = function (points, Installments, InstallmentsPrice) {
        var pointsFormatted = (points && points > 0 ? f.coins.getPoints().toString(points) : "") + (points > 0 && InstallmentsPrice > 0 ? ' + ' : "") + (InstallmentsPrice > 0 ? ((Installments && Installments > 1 ? Installments + ' x ' : '') + f.currency(InstallmentsPrice, true, 2)) : '');
        return pointsFormatted;
    };

    f.temp.pointsCoin = module;
}(formatter));

(function (f) {
    var module = {};
    var points = f.temp.pointsCoin;

    var coins = [];
    coins.push({ key: 'points', value: points });
    coins.push({ key: 'currency', value: undefined });

    var getCoin = function (key) {
        var coin = coins.where(function (x) { return x.key === key }).first();

        if (!coin || !coin.value)
            throw key + ' is not a coin';

        return coin.value;
    }

    module.getPoints = function () {
        var points = getCoin('points');
        return points;
    }

    module.getCurrency = function () {
        var currency = getCoin('currency');
        return currency;
    }

    f.coins = module;
}(formatter));
//#region MODULES FOR POINTS TEMPLATES
delete formatter.temp;

ï»¿/// <reference path="../Libraries/EnumHelper.js" />

if (!CommonFunctions) var CommonFunctions = {};

CommonFunctions.GetSettings = function (settingName) {
    if (typeof (Ide) == 'undefined')
        return Global.Settings[settingName];
    else
        return Ide.applicationSettings[settingName];
};

CommonFunctions.PrepareHotel = function (hotel, settings) {

    settings.controllers.messagesController.notifyMessages(["AirFilter_NoPriceGroups"], EnumHelper.MessagesExhibitor.ExhibitionType.Inline);
};

CommonFunctions.debbugNewValuesHotel = function (hotel) {

    var days = Util.DateValuesDiff(
                hotel.Rooms[0].SelectedRoomOption.CheckInValues,
                hotel.Rooms[0].SelectedRoomOption.CheckOutValues,
                'd');

    var total1 = 0
    hotel.Rooms.forEach(function (r) {
        total1 += r.SelectedRoomOption.PromoDisplayDailyFare + (r.SelectedRoomOption.Board ? r.SelectedRoomOption.Board.EquivalentFareAmount : 0);
    });

    var total2 = 0
    hotel.Rooms.forEach(function (r) {
        total2 += r.SelectedRoomOption.TotalAmount;
    });

    /*
    console.log("PromoDisplayDailyFare");
    console.log("total1: " + total1);
    console.log("total1: " + total1 * days / hotel.TotalGuests);
    console.log("TotalAmount");
    console.log("total2: " + total2);
    console.log("total2: " + total2 / hotel.TotalGuests);
    */
};

CommonFunctions.getAirData = function (settings) {

    var resp = {};

    //Plugin de Pacote utiliza o filtro de preÃ§o pelo Hotel nÃ£o pelo preÃ§o da recomendaÃ§Ã£o
    resp.MinPrice = 0;
    resp.MaxPrice = 999999999;

    resp.RoundTripCiaCompany = Util.IsChecked(settings.components.checkboxes.sameCias);
    resp.RoundTripAirport = Util.IsChecked(settings.components.checkboxes.sameAirports);

    resp.MinOutboundTime = settings.components.departure.slider.slider("values", 0);
    if (isNaN(resp.MinOutboundTime))
        resp.MinOutboundTime = 0;

    resp.MaxOutboundTime = settings.components.departure.slider.slider("values", 1);
    if (isNaN(resp.MaxOutboundTime))
        resp.MaxOutboundTime = 999999;

    resp.MinInboundTime = settings.components.arrival.slider.slider("values", 0);
    if (isNaN(resp.MinInboundTime))
        resp.MinInboundTime = 0;

    resp.MaxInboundTime = settings.components.arrival.slider.slider("values", 1);
    if (isNaN(resp.MaxInboundTime))
        resp.MaxInboundTime = 999999;

    //Plugin de Pacote nÃ£o implementa filtro de DuraÃ§Ã£o de voÃ´
    resp.MinOutboundDuration = 0;
    resp.MaxOutboundDuration = 999999;

    //Plugin de Pacote nÃ£o implementa filtro de DuraÃ§Ã£o de voÃ´
    resp.MinInboundDuration = 0;
    resp.MaxInboundDuration = 999999;

    resp.AirCompanies = [];
    settings.components.checkboxes.airCompanies.each(function () {
        var ctrl = $(this);

        if (Util.IsChecked(ctrl))
            resp.AirCompanies.push({ 'CiaCode': Util.GetComponentValue(ctrl) });
    });

    resp.AirportsOutbound = [];
    settings.components.checkboxes.airportsOutbound.each(function () {
        var ctrl = $(this);

        if (Util.IsChecked(ctrl))
            resp.AirportsOutbound.push({ 'Iata': Util.GetComponentValue(ctrl) });
    });

    resp.HasInboundAirports = settings.components.checkboxes.airportsInbound.length > 0;

    resp.AirportsInbound = [];
    settings.components.checkboxes.airportsInbound.each(function () {
        var ctrl = $(this);

        if (Util.IsChecked(ctrl))
            resp.AirportsInbound.push({ 'Iata': Util.GetComponentValue(ctrl) });
    });

    resp.NumberOfStops = [];
    settings.components.checkboxes.stops.each(function () {
        var ctrl = $(this);

        if (Util.IsChecked(ctrl))
            resp.NumberOfStops.push({ 'Stops': Util.GetComponentValue(ctrl) });
    });

    resp.MultiDestination = false;

    return resp;
};

//Get the filterData to filter hotels
CommonFunctions.getHotelData = function (settings) {
    var resp = {}
    //get Hotel Price
    resp.MinPrice = 0;
    resp.MaxPrice = 999999999;
    if (settings.filters.hotelPrice && settings.components.price.slider.length && settings.components.price.slider.hasClass('ui-slider')) {
        resp.MinPrice = settings.components.price.slider.slider("values", 0);
        resp.MaxPrice = settings.components.price.slider.slider("values", 1);
    }

    //get Distance to Center City
    resp.MinDistanceToCenterCity = 0;
    resp.MaxDistanceToCenterCity = 99999999;
    if (settings.filters.hotelDistanceToCenterCity && settings.components.distances.centerCity.slider.length && settings.components.distances.centerCity.slider.hasClass('ui-slider')) {
        resp.MinDistanceToCenterCity = settings.components.distances.centerCity.slider.slider("values", 0);
        resp.MaxDistanceToCenterCity = settings.components.distances.centerCity.slider.slider("values", 1);
    }

    //get Distance to Airport
    resp.MinDistanceToNearestAirport = 0;
    resp.MaxDistanceToNearestAirport = 99999999;
    if (settings.filters.hotelDistanceToAirport && settings.components.distances.nearestAirport.slider.length && settings.components.distances.nearestAirport.slider.hasClass('ui-slider')) {
        resp.MinDistanceToNearestAirport = settings.components.distances.nearestAirport.slider.slider("values", 0);
        resp.MaxDistanceToNearestAirport = settings.components.distances.nearestAirport.slider.slider("values", 1);
    }

    //get the Name of Hotel
    resp.HotelName = "";
    if (settings.filters.hotelName)
        resp.HotelName = settings.components.hotelName.val().normalize();

    //get the Hotel Stars(Category of Hotel)
    resp.Stars = ["5", "4", "3", "2", "1", "0"];
    if (settings.filters.hotelStar) {
        var checkedStars = [];
        settings.components.stars.each(function () {
            if (Util.IsChecked($(this)))
                checkedStars.push($(this));
        });

        resp.Stars = $.map(checkedStars, function (control) { return Util.GetComponentValue($(control)); });
    }

    //get the Boards the Hotel (List the all boards the each room)
    resp.Boards = [];
    if (settings.filters.hotelBoards) {
        var checkedBoards = [];
        settings.components.boards.each(function () {
            var ctrl = $(this);
            if (Util.IsChecked(ctrl))
                checkedBoards.push(ctrl);
        });

        resp.Boards = $.map(checkedBoards, function (control) { return Util.GetComponentValue($(control)); });
    }

    resp.HotelTypes = ["Online", "Offline"];
    if (settings.filters.hotelTypes) {
        var checkedHotelTypes = [];
        settings.components.types.each(function () {
            if (Util.IsChecked($(this)))
                checkedHotelTypes.push($(this));
        });
        resp.HotelTypes = $.map(checkedHotelTypes, function (control) { return Util.GetComponentValue($(control)); });
    }

    resp.HotelComparativeFareTypes = [];
    if (settings.filters.hotelComparativeFareTypes) {
        var checkedComparativeFareTypes = [];
        settings.components.comparativeFareTypes.each(function () {
            if (Util.IsChecked($(this)))
                checkedComparativeFareTypes.push($(this));
        });
        resp.HotelComparativeFareTypes = $.map(checkedComparativeFareTypes, function (control) { return Util.GetComponentValue($(control)); });
    }

    resp.Sources = [];
    if (settings.filters.hotelSources) {
        var checkedSources = [];
        settings.components.sources.each(function () {
            if (Util.IsChecked($(this)))
                checkedSources.push($(this));
        });
        resp.Sources = $.map(checkedSources, function (control) { return Util.GetComponentValue($(control)); });
    }

    resp.Chains = [];
    if (settings.filters.hotelChains) {
        var checkedChains = [];
        settings.components.chains.each(function () {
            if (Util.IsChecked($(this)))
                checkedChains.push($(this));
        });
        resp.Chains = $.map(checkedChains, function (control) { return Util.GetComponentValue($(control)); });
    }

    if (settings.isItinerary) {
        resp.NightsQuantities = [];

        var checkedNights = [];
        settings.components.daysCount.each(function () {
            var ctrl = $(this);
            if (Util.IsChecked(ctrl))
                checkedNights.push(ctrl);
        });

        resp.NightsQuantities = $.map(checkedNights, function (control) { return parseInt(Util.GetComponentValue($(control))); });
    }

    return resp;
};

//Verify the error messages on the Air Filter
CommonFunctions.getAirFilterErrorMessages = function (data, ctrl, filters) {
    var resp = null;

    if (data.AirFiltersData)
        resp = data.AirFiltersData;

    var messages = [];

    if (resp) {

        if (filters.airStops && resp.NumberOfStops.length == 0)
            messages.push("OnAirFilter_SelectFlightStops");

        if (filters.airCia && resp.AirCompanies.length == 0) {
            messages.push("OnAirFilter_SelectOndeAirCompany");

            if ($(ctrl).hasClass("chkFilterAirCompany")) {

                var companies = $(".chkFilterAirCompany");

                var selectedCompanies = [];

                companies.each(function () {
                    if ($(ctrl).attr("checked") == "checked")
                        selectedCompanies.push(ctrl);
                });

                if (selectedCompanies.length == 0)
                    $(ctrl).attr("checked", true);
            }
        }

        if (filters.airAirport && resp.AirportsOutbound.length == 0)
            messages.push("OnAirFilter_SelectOneDepartureAirport");

        if (filters.airAirport && resp.HasInboundAirports && resp.AirportsInbound.length == 0)
            messages.push("OnAirFilter_SelectOneArrivalAirport");
    }

    return messages;
}

//#region SystemSettings
CommonFunctions.AllowViewSupplier = function (local) {

    function _getSetting(local) {

        var setting = "";

        switch (local) {
            case "AirSearchResult":
                setting = "ShowSupplier.AirSearchResult";
                break;
            case "HotelSearchResult":
                setting = "ShowSupplier.HotelSearchResult";
                break;
            case "ServiceSearchResult":
                setting = "ShowSupplier.ServiceSearchResult";
                break;
            case "Tray":
                setting = "ShowSupplier.Tray";
                break;
            case "Checkout":
                setting = "ShowSupplier.Checkout";
                break;
            case "OfflineView":
                setting = "ShowSupplier.OfflineView";
                break;
            case "OnlineView":
                setting = "ShowSupplier.OnlineView";
        }

        return setting;
    }

    var setting = _getSetting(local);

    return CommonFunctions.GetSettings(setting) != undefined ? CommonFunctions.GetSettings(setting) == "true" : true;
};

CommonFunctions.HideMaxCancellationDate = function () {
    return CommonFunctions.GetSettings("Workflow.ServiceItem.HideMaxCancellationDate") == "true";
};

CommonFunctions.ImmediateChargeOnHotelPenaltyPeriod = function (hotels) {

    var resp = false;

    if (hotels && hotels.length) {
        if (hotels.any(function (h) { return h.hasActiveCancellationPolicy(); }))
            resp = true;
    }

    return resp;
};

/*
* - Check if setting "OfflineItem.Edit" contains permission
* to manage the selected item.
* - Param category: air, hotel, car, service, penalty
* - Param subcategory: book, commission, proposal
*/
CommonFunctions.OfflineItemEdit = function (serviceType, isClosedOS, notify) {

    var blockEdit = SharedFunctions.SettingOfflineItemAction.ValidateAction(EnumHelper.OfflineItemActions.BlockEdit, serviceType);

    if (!blockEdit)
        blockEdit = (isClosedOS && CommonFunctions.OfflineItemBlockAllActionsWhenClosedOS(serviceType));

    var resp = !blockEdit;

    if (!resp && notify)
        _notifyWhenPermissionDenied();

    return resp;
};

/*
* - Check if setting "OfflineItem.View" contains permission
* to view the selected item.
* - Param category: air, hotel, car, service
* - Param subcategory: book, commission, proposal
*/
CommonFunctions.OfflineItemView = function (serviceType, isClosedOS, dontShowMessage) {

    var resp = !SharedFunctions.SettingOfflineItemAction.ValidateAction(EnumHelper.OfflineItemActions.BlockView, serviceType);

    if (!resp && !dontShowMessage)
        _notifyWhenPermissionDenied();

    return resp;
};

CommonFunctions.OfflineItemCreate = function (serviceType, isClosedOS) {

    var blockCreate = SharedFunctions.SettingOfflineItemAction.ValidateAction(EnumHelper.OfflineItemActions.BlockCreate, serviceType);

    if (!blockCreate)
        blockCreate = (isClosedOS && CommonFunctions.OfflineItemBlockAllActionsWhenClosedOS(serviceType));

    return !blockCreate;
};

CommonFunctions.OfflineItemBlockAllActionsWhenClosedOS = function (serviceType) {
    return SharedFunctions.SettingOfflineItemAction.ValidateAction(EnumHelper.OfflineItemActions.BlockAllActionsWhenClosedOS, serviceType);
};

CommonFunctions.ViewHotelCancellationPolicy = function () {
    return CommonFunctions.GetSettings("CancellationPolicy.EnableView.Hotel") != undefined ? CommonFunctions.GetSettings("CancellationPolicy.EnableView.Hotel") == "true" : true;
};

CommonFunctions.ViewCarCancellationPolicy = function () {
    return CommonFunctions.GetSettings("CancellationPolicy.EnableView.Car") != undefined ? CommonFunctions.GetSettings("CancellationPolicy.EnableView.Car") == "true" : true;
};


CommonFunctions.CanBecomeResponsible = function () {
    return CommonFunctions.GetSettings("Workflow.ServiceItem.CanBecomeResponsible") == "true";
};

CommonFunctions.CanUploadFilesOnServiceItem = function () {
    return CommonFunctions.GetSettings("Workflow.ServiceItem.CanUploadFiles") == "true";
};

CommonFunctions.CanUploadFilesOnServiceOrder = function () {
    return CommonFunctions.GetSettings("Workflow.ServiceOrder.CanUploadFiles") == "true";
};

CommonFunctions.CanRemoveResponsible = function () {
    return CommonFunctions.GetSettings("Workflow.ServiceItem.CanRemoveResponsible") == "true";
};

CommonFunctions.GetIFrameHomeTabUrl = function () {
    return CommonFunctions.GetSettings("TravelAgent.IframeHomeTabUrl");
};

CommonFunctions.ShowHotelTypesFilter = function () {
    return CommonFunctions.GetSettings("HotelFilter.ShowHotelTypesFilter") == "true";
};

CommonFunctions.CanCancelPayments = function () {
    return CommonFunctions.GetSettings("Billing.CanCancelPayments") && CommonFunctions.GetSettings("Billing.CanCancelPayments").toLowerCase() == "true";
};

CommonFunctions.CanConfirmPayments = function () {
    return CommonFunctions.GetSettings("Billing.CanConfirmPayments") && CommonFunctions.GetSettings("Billing.CanConfirmPayments").toLowerCase() == "true";
};

CommonFunctions.ShowFlightGroupHash = function () {
    var showFlightGroupHash = CommonFunctions.GetSettings("CheckOut.ShowFlightGroupHash");

    return showFlightGroupHash && showFlightGroupHash.toLowerCase() == "true";
};

CommonFunctions.CanEditPayments = function () {
    return CommonFunctions.GetSettings("Billing.CanEditPayments") && CommonFunctions.GetSettings("Billing.CanEditPayments").toLowerCase() == "true";
};

CommonFunctions.HideMarkup = function () {
    return CommonFunctions.GetSettings("HideMarkup") && CommonFunctions.GetSettings("HideMarkup").toLowerCase() == "true";
};

CommonFunctions.parsePassengerTypes = function (resp) {
    resp.Passengers = {
    };
    resp.Passengers.Adults = 0;
    resp.Passengers.Childrens = 0;
    resp.Passengers.Babies = 0;

    if (resp.Customers && resp.Customers.length) {
        resp.Customers.forEach(function (room) {
            room.Value.forEach(function (age) {
                var paxType = CommonFunctions.ResolvePaxTypeFromAge(age);

                if (paxType == EnumHelper.Passenger.PassengerType.Adult)
                    resp.Passengers.Adults++;
                else if (paxType == EnumHelper.Passenger.PassengerType.Child)
                    resp.Passengers.Childrens++;
                else
                    resp.Passengers.Babies++;
            })
        });
    }
};

CommonFunctions.ResolvePaxTypeFromAge = function (age) {
    if (age >= 12)
        return EnumHelper.Passenger.PassengerType.Adult;
    else if (age >= 2 && age < 12)
        return EnumHelper.Passenger.PassengerType.Child;
    else
        return EnumHelper.Passenger.PassengerType.Baby;
};

function _notifyWhenPermissionDenied() {
    Ide.notifyMessagesExhibitor("OnAccessDenied");
}

Global.ConfirmUnload = typeof Global.ConfirmUnload == 'undefined' || Global.ConfirmUnload;

CommonFunctions.BeforeLeaveSite = function (msg) {
    window.onbeforeunload = function () {
        if (Global.ConfirmUnload)
            return msg || Resources.translate({ code: "YouWillLostUnsavedDataMessage" });
    };
};

CommonFunctions.ShowHotelTypesFilter = function () {
    return CommonFunctions.GetSettings("HotelFilter.ShowHotelTypesFilter") == "true";
};

CommonFunctions.ShowHotelSourcesFilter = function () {
    return CommonFunctions.AllowViewSupplier("HotelSearchResult");
};

CommonFunctions.ShowRobotIssuer = function () {
    return CommonFunctions.GetSettings("WorkflowPayments.ShowRobotIssuer") == "true";
};

CommonFunctions.ShowSeatMapIcon = function () {
    var showSeatMapIcon = CommonFunctions.GetSettings("TravelEnginePnr.ShowSeatMapIcon");

    return typeof (showSeatMapIcon) == 'undefined' || showSeatMapIcon == "true";
};

CommonFunctions.OnlyRoomDefaultMessage = function () {
    var setting = CommonFunctions.GetSettings("Hotel.OnlyRoomDefaultMessage");

    return (typeof (setting) == 'undefined' || !setting) ? Resources.translate({ code: "SÃ APARTAMENTO" }) : setting;
};

CommonFunctions.ShowHotelComparativeFareTypesFilter = function () {
    var filter = CommonFunctions.GetSettings("HotelFilter.ShowHotelComparativeFareTypesFilter");

    return typeof (filter) == 'undefined' || filter == "true";
};

CommonFunctions.HideMaxCancellationDate = function () {
    return CommonFunctions.GetSettings("Workflow.ServiceItem.HideMaxCancellationDate") == "true";
};

CommonFunctions.ShowFlightGroupHash = function () {
    var showFlightGroupHash = CommonFunctions.GetSettings("CheckOut.ShowFlightGroupHash");

    return showFlightGroupHash && showFlightGroupHash.toLowerCase() == "true";
};

CommonFunctions.GetToolbarConfig = function () {
    var templateOptions = Util.GetSetting("fullToolbarConfiguration") ? JSON.parse(Util.GetSetting("fullToolbarConfiguration")) : {
        items: [
            {
                type: 'Tray',
                cssClass: 'tray toolbar_tray',
                title: 'Bandeja'
            }, {
                type: 'House',
                cssClass: 'buscar_hotel search search_house',
                title: 'Buscar Casas',
                gadgetOptions: {
                    title: 'Buscar Casas',
                    description: '<h2><font color=\"black\">MAGIC VILLAGE</font></h2>\n<table cellspacing=\"10\"><tbody><tr><td align=\"center\">\nCondomÃ­nio de luxo a menos de 2km do parque Disneyâs Animal Kingdom, permite que sua famÃ­lia e amigos aproveitem as fÃ©rias juntos. Oferece todos os serviÃ§os e amenidades de um resort, com o conforto e a privacidade de uma casa. A R11 Travel Ã© a Distribuidora Preferencial do Magic Village no Brasil.</td></tr></tbody></table>',
                    defaultSearchData: "{\"Hotel\":{\"RequestData\":{\"ChainCode\":\"MV\",\"Sources\":[\"HotelOffline\"]}}}",
                    componentsSettings: "{\"Destination\":{\t\"ComponentType\":\"Select\",\t\"FillSettings\": {\t\"Mode\":\"Before\",\t\"Sources\":[\"HotelOffline\"],\t\"ChainCode\":\"MV\"}}}"
                }
            }, {
                type: 'Cruise',
                cssClass: 'buscar_cruzeiro search search_cruise',
                title: 'Buscar Cruzeiro'
            }, {
                type: 'CruiseGroups',
                cssClass: 'buscar_cruzeiroGrupos search search_cruiseGroup',
                title: 'Cruzeiros - Grupo'
            }, {
                type: 'Air',
                cssClass: 'buscar_aereo search search_air',
                title: 'Buscar AÃ©reo'
            }, {
                type: 'Hotel',
                cssClass: 'buscar_hotel search search_hotel',
                title: 'Buscar Hotel'
            }, {
                type: 'Itinerary',
                cssClass: 'buscar_roteiro search search_itinerary',
                title: 'Buscar Roteiro'
            }, {
                type: 'Package',
                cssClass: 'buscar_pacote search search_package',
                title: 'Buscar Pacote'
            }, {
                type: 'Service',
                cssClass: 'search search_service',
                title: 'Buscar ServiÃ§o'
            }, {
                type: 'Tour',
                cssClass: 'search search_tour',
                title: 'Buscar Circuito'
            }, {
                type: 'Car',
                cssClass: 'buscar_carro search search_car',
                title: 'Buscar Carro'
            }, {
                type: 'Insurance',
                cssClass: 'buscar_seguro search search_insurance',
                title: 'Buscar Seguro Viagem'
            }, {
                type: "ImportantErrors",
                cssClass: 'searchTraces',
                title: 'Erros Importantes'
            }, {
                type: "CustomSalesReport",
                cssClass: 'customSalesReport',
                title: 'RelatÃ³rio de pedidos'
            }, {
                type: 'Workflow',
                cssClass: 'workflow',
                title: 'Workflow'
            }, {
                type: 'LatestBooks',
                cssClass: 'reservas',
                title: 'Reservas online'
            }, {
                type: 'Claim',
                cssClass: 'claim',
                title: 'Realizar Claim',
                gadgetOptions: true
            }, {
                type: 'Admin',
                cssClass: 'admin',
                title: 'Administrador'
            }, {
                type: 'Totalizer',
                cssClass: 'totalizer',
                title: 'Buscar OrÃ§amento'
            }, {
                type: 'WFSearch',
                cssClass: 'wfSearch',
                title: 'Busca AvanÃ§ada'
            }, {
                type: 'Reports',
                cssClass: 'report',
                title: 'RelatÃ³rios'
            }, {
                type: 'WorkflowGroupPage',
                cssClass: 'workflowGroupPage',
                title: 'Central de atendimento'
            }, {
                type: 'ABS',
                cssClass: 'abs',
                title: 'AutomaÃ§Ã£o Eventos'
            }, {
                type: 'Console',
                cssClass: 'console',
                title: 'Terminal'
            }
        ]
    }

    var iconsConfig = CommonFunctions.GetShowIconsConfig();
    
    if(!iconsConfig.showTrayIcon)
        templateOptions.items = templateOptions.items.removeAll(function(i) { return i.type == "Tray"; });

    if(!iconsConfig.showAirIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Air"; });

    if (!iconsConfig.showCruiseIcon) 
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Cruise"; });

    if (Ide.user.Username.toLowerCase() !== 'suporte.r11')
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "CruiseGroups"; });
    
    if(!iconsConfig.showHotelIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Hotel"; });

    if(!iconsConfig.showWorkflowIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Workflow"; });

    if(!iconsConfig.showLatestBooksIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "LatestBooks"; });

    if(!iconsConfig.showAdminIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Admin"; });

    if(!iconsConfig.showAdvancedWFSearch)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "WFSearch"; });

    if(!iconsConfig.showReports)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Reports"; });

    if(!iconsConfig.showServiceIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Service"; });

    if(!iconsConfig.showTourIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Tour"; });

    if(!iconsConfig.showCarIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Car"; });

    if(!iconsConfig.showWorkflowGroupIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "WorkflowGroupPage"; });

    if(!iconsConfig.showPackageIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Package"; });

    if(!iconsConfig.showABSIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "ABS"; });

    if (!iconsConfig.showImportantErrorIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "ImportantErrors"; });

    if (!iconsConfig.showEnvisionMonitoringCustomReport)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "CustomSalesReport"; });

    if(!iconsConfig.showClaimIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Claim"; });

    if(!iconsConfig.showInsuranceIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Insurance"; });

    if(!iconsConfig.showTotalizerIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Totalizer"; });

    if(!iconsConfig.showConsoleIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Console"; });

    if (!iconsConfig.showHouseIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "House"; });

    if (!iconsConfig.showCruiseContentIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "CruiseContent"; });
    else
        templateOptions.items.push(
            {
                type: 'CruiseContent',
                cssClass: 'cruiseContent',
                title: 'CruiseContent'
            });

    if (!iconsConfig.showItineraryIcon)
        templateOptions.items = templateOptions.items.removeAll(function (i) { return i.type == "Itinerary"; });

    return templateOptions;
}

CommonFunctions.GetShowIconsConfig = function () {
    return {
        showTrayIcon: Util.CompareSettingValue("showTrayIcon", "true"),
        showAirIcon: Util.CompareSettingValue("showAirIcon", "true"),
        showCruiseIcon: Util.CompareSettingValue("showCruiseIcon", "true"),
        showHotelIcon: Util.CompareSettingValue("showHotelIcon", "true"),
        showWorkflowIcon: Util.CompareSettingValue("showWorkflowIcon", "true"),
        showLatestBooksIcon: Util.CompareSettingValue("showLatestBooksIcon", "true"),
        showAdminIcon: Util.CompareSettingValue("showAdminIcon", "true"),
        showAdvancedWFSearch: Util.CompareSettingValue("ShowAdvancedWFSearch", "true"),
        showReports: Util.CompareSettingValue("showReports", "true"),
        showServiceIcon: Util.CompareSettingValue("showServiceIcon", "true"),
        showTourIcon: Util.CompareSettingValue("showTourIcon", "true"),
        showCarIcon: Util.CompareSettingValue("showCarIcon", "true"),
        showWorkflowGroupIcon: CommonFunctions.GetSettings("showWorkflowGroupIcon") != undefined ? CommonFunctions.GetSettings("showWorkflowGroupIcon") == 'true' : true,
        showPackageIcon: Util.CompareSettingValue("showPackageIcon", "true"),
        showABSIcon: Util.CompareSettingValue("showABSIcon", "true"),
        showImportantErrorIcon: Util.CompareSettingValue("showImportantErrorIcon", "true"),
        showClaimIcon: Util.CompareSettingValue("showClaimIcon", "true") && (Ide.SourceCapabilities || []).any(function (sc) { return sc.Claim; }),
        showInsuranceIcon: Util.CompareSettingValue("showInsuranceIcon", "true"),
        showPersonIcon: Util.CompareSettingValue("Person.Active", "true"),
        showProposalIcon: Util.ProposalIsActive(),
        showTotalizerIcon: Util.CompareSettingValue("showTotalizerIcon", "true"),
        showConsoleIcon: Util.CompareSettingValue("showConsoleIcon", "true"),
        showHouseIcon: Util.CompareSettingValue("showHouseIcon", "true"),
        showCruiseContentIcon: Util.CompareSettingValue("showCruiseContentIcon", "true"),
        showEnvisionMonitoringCustomReport: (Util.GetSetting("envisionMonitoringCustomReport")) ? true : false,
        showItineraryIcon: Util.CompareSettingValue("showItineraryIcon", "true")
    };
};

CommonFunctions.ShowOnlineButton = function (serviceItem) {
    if ((serviceItem.Category == EnumHelper.ServiceItemCategory.Hotel || serviceItem.Category == EnumHelper.ServiceItemCategory.Service) && serviceItem.SubCategory == EnumHelper.ServiceItemSubCategory.Book) {
        var showOnlineButton = serviceItem.Settings && serviceItem.Settings.first(function (s) { return s.Key == "showOnlineButtonInBook"; });

        if (showOnlineButton && showOnlineButton.Value.normalize() == "false") {
            var sourceTypeName = serviceItem.FieldValues.first(function (fv) { return fv.RefName == "OrderItem.SourceTypeName"; });
            sourceTypeName = sourceTypeName && sourceTypeName.PrimitiveValue.normalize()
            if (sourceTypeName && (sourceTypeName == 'hoteloffline' || sourceTypeName == "services"))
                return false;
        }
    }

    var closedOS = serviceItem.FieldValuesObj && serviceItem.FieldValuesObj.FinancialCloseDate;

    var blockOnlineView = SharedFunctions.SettingOfflineItemAction.ValidateAction(EnumHelper.OfflineItemActions.BlockOnlineView, serviceItem.ServiceTypeName);

    if (!blockOnlineView)
        blockOnlineView = closedOS && SharedFunctions.SettingOfflineItemAction.ValidateAction(EnumHelper.OfflineItemActions.BlockAllActionsWhenClosedOS, serviceItem.ServiceTypeName);

    if (blockOnlineView)
        return false;

    if (!serviceItem.FieldValuesObj.TravelEngineLocator || !(serviceItem.FieldValuesObj.TravelEngineLocator && serviceItem.FieldValuesObj.TravelEngineLocator.length))
        return false;

    if (serviceItem.FieldValuesObj.Pnrs &&
        serviceItem.FieldValuesObj.Pnrs.length &&
        Ide.companyContext.ConnectionContextSummary.BlockRetrieve(
            serviceItem.FieldValuesObj.Pnrs[0].SourceTypeName,
            serviceItem.FieldValuesObj.Pnrs[0].ConnectionId))
        return false;

    return Ide.applicationSettings.CanRetrieve == "true";
};

CommonFunctions.ShowUserRequester = function () {
    return CommonFunctions.GetSettings("Checkout.EnableRequestorAssign") != undefined && CommonFunctions.GetSettings("Checkout.EnableRequestorAssign") == 'true';
}

CommonFunctions.RequireReasonForDenyInsurance = function () {
    return CommonFunctions.GetSettings("Checkout.RequireReasonForDenyInsurance") != undefined && CommonFunctions.GetSettings("Checkout.RequireReasonForDenyInsurance") == 'true';
};

CommonFunctions.GetNoInsuranceReasonsFromSetting = function () {
    var settingValue = CommonFunctions.GetSettings("Checkout.NoInsuranceSelectionReason");
    if (settingValue)
        return settingValue.split(',');
    
    return undefined;
};

CommonFunctions.SendToTrayAir = function () {
    return CommonFunctions.GetSettings("SendToTray.Air") == "true";
};

CommonFunctions.SendToTrayHotel = function () {
    return CommonFunctions.GetSettings("SendToTray.Hotel") == "true";
};

CommonFunctions.TrayProductsValidation = function () {
    var trayProductsValidation = CommonFunctions.GetSettings("TrayProductsValidation");

    var _hotel = {
        validate: false,
        canAlone: false
    };

    var _air = {
        validate: false,
        canAlone: false
    };

    var _car = {
        validate: false,
        canAlone: false
    };

    var _service = {
        validate: false,
        canAlone: false
    };

    if (trayProductsValidation) {
        var validations = trayProductsValidation.toLowerCase().split(";");

        validations.forEach(function (product) {
            if (product.indexOf('hotel') >= 0) {
                _hotel.validate = true;
                _hotel.canAlone = product.indexOf('#') == 0;
            }
            else if (product.indexOf('air') >= 0) {
                _air.validate = true;
                _air.canAlone = product.indexOf('#') == 0;
            }
            else if (product.indexOf('service') >= 0) {
                _service.validate = true;
                _service.canAlone = product.indexOf('#') == 0;
            }
            else if (product.indexOf('car') >= 0) {
                _car.validate = true;
                _car.canAlone = product.indexOf('#') == 0;
            }
        });
    }

    return {
        Hotel: _hotel,
        Air: _air,
        Car: _car,
        Service: _service
    };
};

CommonFunctions.CheckOutRequiredPayment = function () {
    return CommonFunctions.GetSettings("CheckOut.RequiredPayment") == "true";
};

CommonFunctions.WorkFlowServiceItemHideCancelButton = function () {
    return CommonFunctions.GetSettings("WorkFlow.ServiceItem.HideCancelButton") == "true";
};

CommonFunctions.WorkFlowServiceItemHideSegmentButtons = function () {
    return CommonFunctions.GetSettings("WorkFlow.ServiceItem.HideSegmentButtons") == "true";
};

CommonFunctions.WorkFlowServiceItemHideFareAndRateButtons = function () {
    return CommonFunctions.GetSettings("WorkFlow.ServiceItem.HideFareAndRateButtons") == "true";
};

CommonFunctions.CheckOutRequiredSafeGuard = function () {
    return CommonFunctions.GetSettings("CheckOut.RequiredSafeGuard") == "true";
};

CommonFunctions.useSafeGuard = function () {
    return CommonFunctions.GetSettings("useSafeGuard") == "true"
    || CommonFunctions.GetSettings("IssueTickets.RequiredSafeGuard") == "true";
};

CommonFunctions.EnableResponsibleAssign = function () {
    return CommonFunctions.GetSettings("CheckOut.EnableResponsibleAssign") == "true";
};

CommonFunctions.EnableResponsibleAssignRequired = function () {
    return CommonFunctions.GetSettings("CheckOut.EnableResponsibleAssign.Required") == "true";
};

CommonFunctions.CheckOutShowPaymentSplit = function () {
    return CommonFunctions.GetSettings("CheckOut.ShowPaymentSplit") == "true";
};

CommonFunctions.CheckOutRequiredUserAndPasswordSafeGuard = function () {
    return CommonFunctions.GetSettings("CheckOut.RequiredUserAndPasswordSafeGuard") == "true";
};

CommonFunctions.IssueTicketsRequiredUserAndPasswordSafeGuard = function () {
    return CommonFunctions.GetSettings("IssueTickets.RequiredUserAndPasswordSafeGuard") == "true";
};

CommonFunctions.SafeGuardApplicationToken = function () {
    return CommonFunctions.GetSettings("safeGuardApplicationToken");
};

CommonFunctions.LockIndividualPayments = function () {
    return CommonFunctions.GetSettings("LockIndividualPayments") == "true";
};

CommonFunctions.CanSeeAgreementCode = function () {
    var settingValue = CommonFunctions.GetSettings("CommercialAgreement.CanSeeAgreementCode");

    return (typeof (settingValue) == "undefined") || settingValue == "true";
};

CommonFunctions.NeedAddressInPaymentForm = function () {
    return CommonFunctions.GetSettings("WorkflowPayment.NeedAddressInPaymentForm") && CommonFunctions.GetSettings("WorkflowPayment.NeedAddressInPaymentForm").toLowerCase() == "true";
};

CommonFunctions.ShowRequestor = function () {
    return CommonFunctions.GetSettings("Workflow.ServiceItem.ShowRequestor") && CommonFunctions.GetSettings("Workflow.ServiceItem.ShowRequestor").toLowerCase() == "true";
};

CommonFunctions.IsResponsibleManager = function () {
    return CommonFunctions.GetSettings("Workflow.ServiceOrder.IsResponsibleManager") && CommonFunctions.GetSettings("Workflow.ServiceOrder.IsResponsibleManager").toLowerCase() == "true";
};

CommonFunctions.IsHybridPackageNewFlow = function () {
    return Util.CompareSettingValue("HybridPackage.UseNewFlow", "true");
};

!Global.IsDebugContext && CommonFunctions.BeforeLeaveSite();

//#endregion

CommonFunctions.SetManagementFieldsBinding = function (collection, managementExternalFieldsContainer) {
    collection = (collection || []);

    if (collection.length && managementExternalFieldsContainer.containsPlugin("managementExternalFields")) {
        var managementFields = managementExternalFieldsContainer.managementExternalFields("getData");
        var referenceNames = managementFields.select(function (m) { return m.Reference; });

        var useCombo = collection.any(function (p) {
            for (var i = 0; i < referenceNames.length; i++) {
                if (p.hasOwnProperty(referenceNames[i])) {
                    return true;
                    break;
                }
            }
        });

        if (useCombo) {
            var availableOptions = collection.select(function (p) {
                return {
                    Key: p.Id,
                    Value: p[referenceNames[0]],
                    Data: p
                }
            });

            var onChangeOption = function () {
                var item = $(this);
                var option = availableOptions.first(function (a) {
                    return a.Key == item.val();
                });

                if (option) {
                    managementExternalFieldsContainer.managementExternalFields("setData", option.Data);
                }
                else {
                    managementExternalFieldsContainer.managementExternalFields("clear");
                }
            }

            managementExternalFieldsContainer.managementExternalFields("setBinding", availableOptions, onChangeOption);
        }
    }

}

CommonFunctions.ShowAdvancePaymentOption = function () {
    return (CommonFunctions.GetSettings("PaymentOptions.EnableAdvancePayment") || "").toLowerCase() == "true";
};

CommonFunctions.ShowDiscountPaymentOption = function () {
    return (CommonFunctions.GetSettings("PaymentOptions.EnableDiscountPayment") || "").toLowerCase() == "true";
};

CommonFunctions.ShowPayButton = function () {
    return ["true", ""].contains((CommonFunctions.GetSettings("PaymentOptions.EnablePay") || "").toLowerCase());
};

CommonFunctions.CanSendSaleReceipt = function () {
    return (CommonFunctions.GetSettings("PaymentOptions.CanSendSaleReceipt") || "").toLowerCase() == "true";
};

CommonFunctions.CanBreakSale = function () {
    return ["true", ""].contains((CommonFunctions.GetSettings("PaymentOptions.CanBreakSale") || "").toLowerCase());
};

CommonFunctions.ResolveDefaultHybridPackagePassengers = function () {
    var response = [{ PassengersAges: [] }];

    var quantity = parseInt(Util.GetSetting("HybridPackage.PassengersQuantity") || 2, 10);

    for (var i = 0; i < quantity; i++)
        response[0].PassengersAges.push(30);

    return response;
};

if (typeof SharedFunctions === 'undefined') { var SharedFunctions = {}; }

if (typeof SharedFunctions.SettingPaymentTypeAction === 'undefined') { SharedFunctions.SettingPaymentTypeAction = {}; }

if (typeof SharedFunctions.SettingCruisePnrLiveEdit === 'undefined') { SharedFunctions.SettingCruisePnrLiveEdit = {}; }

if (typeof SharedFunctions.SettingPaymentOptionByProduct === 'undefined') { SharedFunctions.SettingPaymentOptionByProduct = {}; }

if (typeof SharedFunctions.ResolveSearchRange === 'undefined') { SharedFunctions.ResolveSearchRange = {}; }

if (typeof SharedFunctions.SettingOfflineItemAction === 'undefined') { SharedFunctions.SettingOfflineItemAction = {}; }

/*FunÃ§Ãµes auxiliares do SearchEngine*/
SharedFunctions.DisplayDestinationDate = function (target) {
    var ctrl = $(target);

    var elementToToggle = ctrl.attr('elementToToggle');

    switch (elementToToggle) {
        case 'otherDates':
            ctrl.siblings().toggleClass('hide', ctrl.hasClass('current'));
            break;
        case 'otherDestinations':
            ctrl.siblings().toggleClass('hide', ctrl.hasClass('current'));
            break;
    }
};

SharedFunctions.DisplayChildrenAges = function () {
    $(".childrensQtdRoom").die('change').live('change', function () {
        var ctrl = $(this);

        var quantity = Util.GetComponentValue(ctrl);

        var ctrlChildAges = ctrl.parent().siblings('.child-ages');

        ctrlChildAges.addClass('hide');

        if (quantity > 0)
            ctrlChildAges.removeClass('hide');

        var childrensComponents = ctrlChildAges.children('div,label');

        childrensComponents.addClass('hide');

        for (var i = 0; i < quantity; i++)
            childrensComponents.eq(i).removeClass('hide');
    });
};

SharedFunctions.GetHotelGuestQuantities = function (adultsComponent, compChildrensComponent) {
    var parents = adultsComponent.eq(3).closest('ul').children('li:not(.hide)');

    var quantity = 0;

    parents.each(function () { quantity += parseInt(Util.GetComponentValue($($(this).find('.adultsQtdRoom'))), 10) + parseInt(Util.GetComponentValue($($(this).find('.childrensQtdRoom'))), 10); });

    return quantity;
};

SharedFunctions.SearchEngine = function (componentClick, searchEngineComponent, serviceOrderParams) {
    var valid = searchEngineComponent.searchEngine("validate");

    if (valid) {
        var searchType = componentClick.attr('searchType');

        searchEngineComponent.searchEngine('setOptions', { 'searchType': searchType });

        var data = searchEngineComponent.searchEngine("getData");

        data.ServiceOrderParams = serviceOrderParams;

        var manager = new SearchPageManager(data);

        manager.load();
    }

    return valid;
};
/*Fim das funÃ§Ãµes auxiliares do SearchEngine*/

/*Cria objeto TrayItem*/
SharedFunctions.CreateTrayItem = function (data, searchType, serviceType, searchController, checkOutController, passengers) {
    var trayItem = SharedFunctions.ContructTrayItem();

    trayItem.SearchType = searchType;
    trayItem.ServiceType = serviceType;
    trayItem.Services[EnumHelper.ServiceType.Plural[serviceType]].push(data);
    trayItem.Passengers = passengers ? passengers : SharedFunctions.GetPassengersByLastSearchParameters(data, searchType, searchController);

    if (serviceType == "Hotel") {
        var tAmount = 0;
        if (data.Rooms) {
            data.Rooms.forEach(function (r) {
                tAmount += r.getTotalAmount();
            });
        }

        trayItem.Values.totalAmount = tAmount;
    }
    else if (serviceType == "Recommendation") {
        var tAmount = data.MarkupedTotalAmount ? data.MarkupedTotalAmount : data.TotalAmount ? data.TotalAmount : 0;
        if (trayItem.Passengers && trayItem.Passengers.Adults) {
            var sum = trayItem.Passengers.Adults + (trayItem.Passengers.Children ? trayItem.Passengers.Children : 0);
            tAmount *= sum;
            trayItem.Values.totalAmount = tAmount;
        }
    }
    else {
        var total = 0;
        if (data) {
            if (data.DisplayTotalAmount) total = data.DisplayTotalAmount;
            else if (data.TotalAmount) total = data.TotalAmount;
            else if (data.totalAmount) total = data.totalAmount;
        }
        trayItem.Values.totalAmount = total;
    }

    if (searchController) {
        trayItem.SearchSummary = searchController.getData().SearchSummary;
        var lastSearchParameters = SharedFunctions.GetLastSearchParameters(searchController);

        if (lastSearchParameters.SearchDynamicPkgs)
            trayItem.SearchForPackageComposition = true;
        else
            trayItem.SearchForPackageComposition = lastSearchParameters ? lastSearchParameters.SearchForPackageComposition : false;
    }

    trayItem.SearchSummary = searchType != "Event" ? searchController.getData().SearchSummary : { Events: searchController.lastSearchParameters.Event };
    trayItem.SearchController = searchController;
    trayItem.CheckOutController = checkOutController;
    trayItem.ExternalProperties.OriginalPackage = SharedFunctions.CreateOriginalPackage(data, searchType);

    return trayItem;
};

SharedFunctions.ContructTrayItem = function (cssClass, title, composePackage, index) {
    var trayItem = {
        Services: {
            Hotels: [],
            Recommendations: [],
            Packages: [],
            Events: []
        },
        Passengers: {
            Adults: 0,
            Babies: 0,
            Childrens: 0
        },
        Values: {
            TotalAmount: 0,
            Currency: 'R$'
        },
        Tray: {
            CssClass: cssClass,
            Title: title,
            ComposePackage: composePackage,
            IsTrayItem: true
        },
        HashKeyList: [],
        Index: index,
        ExternalProperties: {}
    };

    return trayItem;
};

SharedFunctions.CreateOriginalPackage = function (data, searchType) {
    if (searchType == EnumHelper.SearchType.Package) {
        return data;
    }

    return null;
};

SharedFunctions.GetLastSearchParameters = function (searchController) {
    var resp = undefined;
    if (searchController)
        resp = searchController.lastSearchParameters;

    return resp;
};

SharedFunctions.GetPassengersByLastSearchParameters = function (data, searchType, searchController) {
    var rs = SharedFunctions.SetPassengers(data, searchType, searchController);

    return rs.Passengers;
};

SharedFunctions.SetPassengers = function (data, searchType, searchController) {
    if (!data) data = {};
    if (!data.Passengers) data.Passengers = {};

    var lastSearchParameters = SharedFunctions.GetLastSearchParameters(searchController);
    var sumAdult, sumBaby, sumChild;

    if (searchType == 'Air') {
        sumAdult = lastSearchParameters.Air.Adults;
        sumBaby = lastSearchParameters.Air.Babies;
        sumChild = lastSearchParameters.Air.Children;
    }
    else if (searchType == 'Hotel' || searchType == 'Package') {
        sumAdult = lastSearchParameters.Hotel.SumAdults;
        sumBaby = lastSearchParameters.Hotel.SumBaby;
        sumChild = lastSearchParameters.Hotel.SumChild;
    }
    else if (searchType == 'Event') {
        sumAdult = lastSearchParameters.Event.Adults
        sumBaby = lastSearchParameters.Event.Childrens
        sumChild = lastSearchParameters.Event.Babies
    }

    data.Passengers.Adults = sumAdult;
    data.Passengers.Babies = sumBaby;
    data.Passengers.Children = sumChild;
    data.Passengers.Total = sumAdult + sumChild + sumBaby;

    return data;
};
/*Fim das funÃ§Ãµes para criar objeto TrayItem*/

/*Cria Wizard*/
SharedFunctions.CloseWizard = function () {
    $('#wizard').dialog('close');
    $('#wizard').wizard("destroy");
}

SharedFunctions.CreateWizard = function (trayItem, serviceType, controllers) {
    var wizard = $('#wizard');

    var options = {
        templates: {
            struct: WizardTPL,
            plugins: WizardPluginsTPL,
            plugin: WizardPluginTPL,
            menuSteps: WizardStepsMenuTPL
        },
        containerWidth: 830,
        events: {
            onFinalize: SharedFunctions.OnFinalize
        },
        plugins: [{
            Name: 'PreOrder',
            PluginName: 'preOrder',
            Alias: 'Reserva',
            options: SharedFunctions.GetAggregateStepOneOptions(trayItem, serviceType, controllers)
        }],
        components: {
            finalize: '.buy'
        },
        setContainerWidth: false,
        resizeContainer: false
    };

    wizard.wizard(options);

    wizard.destroyDialog().dialog({
        width: 1024,
        modal: true,
        resizable: false,
        autoOpen: false,
        zIndex: 3001
    });

    return wizard;
};

SharedFunctions.GetAggregateStepOneOptions = function (trayItem, serviceType, controllers) {
    controllers.MessagesController = new MessagesController();

    return {
        events: {
            onClose: SharedFunctions.CloseWizard
        },
        controllers: {
            checkOutController: controllers.CheckOutController,
            messagesController: controllers.MessagesController,
            searchController: controllers.SearchController
        },
        trayItem: trayItem,
        priceAnimate: true
    };
};

SharedFunctions.GetHotelGuestsCount = function (roomsRequest, guestType) {
    var count = 0;

    if (EnumHelper.Passenger.PassengerType.Adult == guestType)
        $.each(roomsRequest, function () {
            count += parseInt(this.Adults);
        });
    else if (EnumHelper.Passenger.PassengerType.Child == guestType)
        $.each(roomsRequest, function () {
            for (var i = 0; i < this.ChildAges.length; i++) {
                var age = this.ChildAges[i];
                if (age >= 2)
                    count++;
            }
        });
    else if (EnumHelper.Passenger.PassengerType.Baby == guestType)
        $.each(roomsRequest, function () {
            for (var i = 0; i < this.ChildAges.length; i++) {
                var age = this.ChildAges[i];
                if (age < 2)
                    count++;
            }
        });

    return count;
}

SharedFunctions.NeedTSA = function (trayItem) {
    var needTSA = false;

    if (trayItem && trayItem.Services && trayItem.Services.Airs) {
        needTSA = trayItem.Services.Airs.any(function (rec) {
            return rec.FlightGroups.any(function (bcfg) {
                return bcfg.OriginalFlightGroup.NeedTSA;
            })
        });
    }

    return needTSA;
}

SharedFunctions.GetComponetAge = function (comp, componentAge) {
    return comp.parent().siblings().find(componentAge);
};

SharedFunctions.ChangeDocumentType = function (comp) {
    var siblings = comp.closest('.label').siblings();

    if (EnumHelper.DocumentType[comp.attr('value')] == EnumHelper.DocumentType.Passport) {
        siblings.filter('.divDrpGovernmentIssuingState').addClass('hide');
        siblings.find('.documentNumber').attr('documentTypeDependecy', 'Passport');
        siblings.find('.drpGovernmentIssuingState').attr('toValidate', 'false');
        siblings.find('.governmentIssuing').attr('toValidate', 'false').closest('label').addClass('hide');
        siblings.find('.passportCountry, .passportValidateDate').attr('toValidate', 'true').parent().removeClass('hide');
    }
    else if (EnumHelper.DocumentType[comp.attr('value')] == EnumHelper.DocumentType.Identity) {
        siblings.find('.documentNumber').attr('documentTypeDependecy', 'Identity');
        siblings.find('.passportCountry, .passportValidateDate').removeAttr('toValidate').parent().addClass('hide');
        siblings.find('.governmentIssuing').removeAttr('toValidate').closest('label').removeClass('hide');
        siblings.filter('.divDrpGovernmentIssuingState').removeClass('hide');
        siblings.find('.drpGovernmentIssuingState').removeAttr('toValidate');
    }
};

SharedFunctions.CalculateAge = function (comp) {
    if (comp.val().trim().length) {

        var age = comp.val().split('/');
        var arrDateToCompare = undefined;
        var dateToCompare = undefined;

        if (comp.attr('validations')) {
            arrDateToCompare = comp.attr('validations').split(',').last().split('/');
            dateToCompare = new Date(arrDateToCompare[2], arrDateToCompare[1] - 1, arrDateToCompare[0]);
        }

        return (new Date(age[2], age[1] - 1, age[0])).untilInYears(dateToCompare);
    }
};
/*Fim das funÃ§Ãµes para criar Wizard*/

/* Cria Request OrÃ§amento */
SharedFunctions.OnEstimate = function (trayItem) {

    var processOrderRQ = SharedFunctions.GetEstimateOrderRQ(trayItem);

    var manager = new ConfirmationPageManager({
        processOrderRQ: processOrderRQ,
        trayItem: trayItem
    });

    manager.load();

    SharedFunctions.TrayItem = trayItem;
}

SharedFunctions.GetEstimateOrderRQ = function (trayItem) {
    var processOrderRQ = undefined;

    if (trayItem && trayItem.Services) {
        var flightGroups = [];
        var hotels = undefined;
        var originalPackage = undefined;
        var events = undefined;

        flightGroups = SharedFunctions.GetFlightGroupsByTrayItem(trayItem);
        hotels = SharedFunctions.GetHotelsByTrayItem(trayItem);
        originalPackage = SharedFunctions.GetPackageByTraytItem(trayItem);
        events = SharedFunctions.GetEventsByTrayItem(trayItem);

        var numberOfADTs = 0;
        var numberOfCHDs = 0;
        var numberOfINFs = 0;

        if (trayItem.Passengers) {
            numberOfADTs = trayItem.Passengers.Adults ? trayItem.Passengers.Adults : 0;
            numberOfCHDs = trayItem.Passengers.Children ? trayItem.Passengers.Children : 0;
            numberOfINFs = trayItem.Passengers.Babies ? trayItem.Passengers.Babies : 0;
        }

        var additionalInfo = SharedFunctions.GetAdditionalInfo(trayItem);

        processOrderRQ = {
            Hotels: hotels,
            FlightGroups: flightGroups,
            Package: originalPackage,
            NumberOfADTs: numberOfADTs,
            NumberOfCHDs: numberOfCHDs,
            NumberOfINFs: numberOfINFs,
            Events: events,
            Settings: {
                AssessFare: true,
                BookAir: false,
                BookHotel: false,
                CallProcessUser: false
            },
            AdditionalInfo: additionalInfo,
            IsEstimate: true
        };
    }

    return processOrderRQ;
}

SharedFunctions.GetFlightGroupsByTrayItem = function (trayItem) {
    var trayItemFlightGroups = [];
    if (trayItem.Services.Airs && trayItem.Services.Airs.length) {
        var bestCombinationFlightGroups = trayItem.Services.Airs[0].FlightGroups;

        for (var i = 0; i < bestCombinationFlightGroups.length; i++) {
            trayItemFlightGroups.push(bestCombinationFlightGroups[i].OriginalFlightGroup);
        }
    }

    return trayItemFlightGroups;
}

SharedFunctions.GetHotelsByTrayItem = function (trayItem) {
    var trayItemHotel = undefined;
    if (trayItem.Services.Hotels && trayItem.Services.Hotels.length) {
        trayItemHotel = trayItem.Services.Hotels;
    }
    return trayItemHotel;
}

SharedFunctions.GetPackageByTraytItem = function (trayItem) {
    var trayItemPackage = undefined;

    if (trayItem && trayItem.ExternalProperties && trayItem.ExternalProperties.OriginalPackage)
        trayItemPackage = trayItem.ExternalProperties.OriginalPackage;

    return trayItemPackage;
}

SharedFunctions.GetEventsByTrayItem = function (trayItem) {
    var trayItemEvent = [];

    if (trayItem.Services.Events && trayItem.Services.Events.length) {
        for (var i = 0, len = trayItem.Services.Events.length; i < len; i++) {
            var event = trayItem.Services.Events[i];

            var selectedEvent = {
                SelectedEvent: event,
                UserName: Util.getDecodeUriCookie("UserName"),
                UserId: Util.getDecodeUriCookie("IdVendor")
            };

            trayItemEvent.push(selectedEvent);
        }
    }

    return trayItemEvent;
}

SharedFunctions.GetAdditionalInfo = function (trayItem) {
    return [{ Key: 'TrayItem', Value: Util.stringifyJSON(trayItem) }];
}
/*Fim das funÃ§Ãµes para criar Request OrÃ§amento*/

SharedFunctions.TrayItem = undefined;
SharedFunctions.PluginsData = undefined;

SharedFunctions.OnBook = function (trayItem) {
    var wizard = $('#wizard');

    var pluginContainer = wizard.wizard('getPluginContainer', 'PreOrder');

    if (pluginContainer) {
        pluginContainer.PreOrder.Container["preOrder"]('beforePreOrder', trayItem);

        wizard.dialog('open');
        //$('#wizard').modal();
    }

    SharedFunctions.TrayItem = trayItem;
};

///Coloca os mesmos passageiros em todos os quartos
SharedFunctions.FillHotelGuestsWithPassengers = function (pluginsData) {
    if (pluginsData && pluginsData.PreOrder &&
        pluginsData.PreOrder.passengerAdditionalData &&
        pluginsData.PreOrder.preOrderData && pluginsData.PreOrder.preOrderData.preOrderRS &&
        pluginsData.PreOrder.preOrderData.preOrderRS.Hotels) {

        if (pluginsData.PreOrder.preOrderData.preOrderRS.Hotels.length > 0) {
            var firstHotel = pluginsData.PreOrder.preOrderData.preOrderRS.Hotels[0];
            for (var r = 0; r < firstHotel.Rooms.length; r++) {
                var room = firstHotel.Rooms[r];
                for (var p = 0; p < pluginsData.PreOrder.passengerAdditionalData.Passengers.length; p++) {
                    if (pluginsData.PreOrder.passengerAdditionalData.Passengers[p].RoomHashKey == room.HashKey) {
                        var passenger = pluginsData.PreOrder.passengerAdditionalData.Passengers[p];
                        room.Guests.push(passenger);
                    }
                }
            }
            if (pluginsData.PreOrder.preOrderData.preOrderRS.Hotels.length > 1) {
                for (var h = 1; h < pluginsData.PreOrder.preOrderData.preOrderRS.Hotels.length; h++) {
                    for (var r = 0; r < pluginsData.PreOrder.preOrderData.preOrderRS.Hotels[h].Rooms.length; r++) {
                        if (r < firstHotel.Rooms.length)
                            pluginsData.PreOrder.preOrderData.preOrderRS.Hotels[h].Rooms[r].Guests = firstHotel.Rooms[r].Guests;
                    }
                }
            }
        }
    }
}

SharedFunctions.OnFinalize = function (pluginsData) {
    SharedFunctions.PluginsData = pluginsData;

    var processOrderRQ = SharedFunctions.GetProcessOrderRQ(pluginsData);

    if (SharedFunctions.HasCancellationPolicies(processOrderRQ))
        SharedFunctions.ShowCancellationPolicies(processOrderRQ, pluginsData);
    else
        SharedFunctions.CallConfirmationManager(processOrderRQ, pluginsData);
};

SharedFunctions.HasCancellationPolicies = function (processOrderRQ) {
    var hasCancellationPolicies = false;

    if (processOrderRQ.Hotel) {
        var hotel = processOrderRQ.Hotel;

        if (hotel.SourceOrigin && hotel.SourceOrigin.toUpperCase().trim() == 'CANGOOROO' && hotel.Rooms)
            hasCancellationPolicies = hotel.Rooms.any(function (r) { return r.CancellationPolicies && r.CancellationPolicies.length; });
    }

    return hasCancellationPolicies;
};

SharedFunctions.ShowCancellationPolicies = function (processOrderRQ, pluginsData) {
    $("#cancellationPolices").html(CancellationPoliciesTPL({ data: processOrderRQ.Hotel.Rooms }))

    $("#cancellationPolices").destroyDialog().dialog({
        modal: true,
        resizable: false,
        autoOpen: true,
        zIndex: 3002
    });

    $(".cancellation_policies_yes").die().live('click', function (e) {
        e.preventDefault();
        $("#cancellationPolices").dialog('close');
        SharedFunctions.CallConfirmationManager(SharedFunctions.GetProcessOrderRQ(SharedFunctions.PluginsData), SharedFunctions.PluginsData);
        SharedFunctions.CloseWizard();
    });

    $(".cancellation_policies_no").die().live('click', function (e) {
        e.preventDefault();
        $("#cancellationPolices").dialog('close');
    });
};

SharedFunctions.CallConfirmationManager = function (processOrderRQ, pluginsData) {
    var manager = new ConfirmationPageManager({
        processOrderRQ: processOrderRQ,
        trayItem: SharedFunctions.TrayItem,
        summary: pluginsData.PreOrder.preOrderData.preOrderRS.Summary
    });

    manager.load();

    SharedFunctions.CloseWizard();
};

SharedFunctions.GetProcessOrderRQ = function (pluginsData) {

    var preOrderRS = pluginsData.PreOrder.preOrderData.preOrderRS;

    var originalPackage = SharedFunctions.GetPackageByTraytItem(SharedFunctions.TrayItem);

    pluginsData.PreOrder.passengerAdditionalData.Passengers.forEach(function (p) { p.PassengerType = p.Type; p.Type = 0; });

    var processOrderRQ = {
        Passengers: pluginsData.PreOrder.passengerAdditionalData.Passengers,
        BookingFares: preOrderRS.BookingFares,
        Hotels: preOrderRS.Hotels,
        FlightGroups: preOrderRS.FlightGroups,
        Package: originalPackage,
        User: Ide.user,
        NumberOfADTs: preOrderRS.Summary.Adults,
        NumberOfCHDs: preOrderRS.Summary.Childs,
        NumberOfINFs: preOrderRS.Summary.Babies,
        CustomFieldValues: SharedFunctions.GetCustomFields(pluginsData),
        AdditionalInfo: [],
        SearchData: SharedFunctions.TrayItem.SearchController.getSearchData(),
        Events: pluginsData.PreOrder.preOrderData.preOrderRS.Events
    };

    for (var key in pluginsData.PreOrder.cvcOrderAdditionalData)
        processOrderRQ.AdditionalInfo.push({ Key: key, Value: pluginsData.PreOrder.cvcOrderAdditionalData[key] || "" });

    if (SharedFunctions.TrayItem.reservationCode)
        processOrderRQ.AdditionalInfo.push({ Key: "ReservationCode", Value: SharedFunctions.TrayItem.reservationCode });

    processOrderRQ.AdditionalInfo.push({ Key: "SearchForPackageComposition", Value: SharedFunctions.TrayItem.SearchForPackageComposition });

    return processOrderRQ;
};

SharedFunctions.GetCustomFields = function (pluginsData) {

    var customFieldValues = [];

    return customFieldValues;
};

SharedFunctions.RemoveTrayItem = function () {
    $('#gadgetTray').ToolbarTray('removeTrayItem', SharedFunctions.TrayItem);
};

SharedFunctions.SetHotelRoomsByComponent = function (hotel, component, closestComponentAttr) {
    var currentHotelBox = $(component).closest('[' + closestComponentAttr + ']');
    var roomsHashKeys = currentHotelBox.find(".room.current").map(function (i, e) { return e.getAttribute('roomhashkey') });

    if (roomsHashKeys && roomsHashKeys.length)
        SharedFunctions.SetHotelRooms(hotel, roomsHashKeys);
    else if (hotel.RoomsGroups)
        hotel.Rooms = hotel.RoomsGroups.select(function (rg) { return rg.Rooms.first(); });
}

SharedFunctions.GetHotelRooms = function (hotel, roomsHashKeys) {
    var rooms = [];

    if (roomsHashKeys.length == hotel.RoomsGroups.length) {
        for (var i = 0; i < roomsHashKeys.length; i++) {
            var room = hotel.RoomsGroups[i].Rooms.first(function (r) {
                return r.Id == roomsHashKeys[i];
            });

            if (room)
                rooms.push(room);
        }
    }

    return rooms;
};

SharedFunctions.SetHotelRooms = function (hotel, roomsHashKeys) {
    var rooms = SharedFunctions.GetHotelRooms(hotel, roomsHashKeys);

    hotel.Rooms = rooms;

    return hotel;
};

SharedFunctions.SetRecommToolTip = function (elem, settings) {
    var ctrl = $(elem);

    var flightGroupIndex = ctrl.attr('flightgroupindex');

    if (flightGroupIndex) {
        var recommendationIndex = ctrl.attr('recommendationindex');
        var data = settings.controllers.searchController.getData();
        var flightGroup = data.Recommendations.first(function (r) {
            return r.Index == recommendationIndex;
        }).FlightGroups.first(function (fg) { return fg.OriginalFlightGroup.Index == flightGroupIndex; });

        flightGroup.hideSource = settings.showStaticPkgs ? settings.showStaticPkgs : false;

        var html = settings.templates.FlightGroupInfosTPL({ FlightGroup: flightGroup });

        if (flightGroup.OriginalFlightGroup.AnacDetails && flightGroup.OriginalFlightGroup.AnacDetails.length)
            html += flightGroup.OriginalFlightGroup.AnacDetails;

        $(settings.components.infoContent.selector).html(html);
    }
}

/*FunÃ§Ãµes de Hotel*/

SharedFunctions.GetCVCAirCVCTotalGuests = function (hotel) {

    if (!hotel.SeparatedRooms || !hotel.SeparatedRooms.length)
        Util.SetSeparatedRooms(hotel);

    return hotel.SeparatedRooms.sum(function (sr) { return sr[0].GuestCount.Adults + sr[0].GuestCount.ChildAges.where(function (c) { return c >= 2; }).length; });
}

SharedFunctions.GetHotelBabiesCount = function (hotel) {

    if (!hotel.SeparatedRooms || !hotel.SeparatedRooms.length)
        Util.SetSeparatedRooms(hotel);

    return hotel.SeparatedRooms.sum(function (sr) { return sr[0].GuestCount.ChildAges.where(function (c) { return c < 2; }).length; });
}

SharedFunctions.GetHotel = function (hotelHashKey, hotels, searchController, summary) {
    var hotel = undefined;

    if (hotels && hotels.length)
        hotel = hotels[0];
    else
        hotel = searchController.getHotel(hotelHashKey, summary);

    return hotel;
};

SharedFunctions.GetHotelHashKey = function (comp) {
    return $(comp).closest('[HotelHashKey]').attr('HotelHashKey');
};

SharedFunctions.OrderByPreferential = function (component) {

    if (component) {
        $('[property*=Preferential]', component).trigger('click');
        setTimeout(function () {
            component.find('.multi_options').removeClass('clicked');
            component.find('.hotelSortCombo').hide();
        }, 50);
    }
    else {
        $('[property*=Preferential]').trigger('click');
        setTimeout(function () {
            $('.hotelSortingData').removeClass('clicked');

            $('.hotelSortingData').children('span').html('Preferenciais');

            $('.hotelSortingData').children('ul').children('li').children('a').removeClass('current');

            $('.hotelSortCombo').hide();
        }, 50);
    }
};

/*Fim das funÃ§Ãµes de Hotel*/

SharedFunctions.GetCurrentTabSummary = function () {
    var summary,
        currentTab = Ide.getCurrentTab();

    try {
        summary = currentTab.manager.SearchController.getData().SearchSummary;
    }
    catch (ex) {
        if (typeof console != "undefined")
            console.log("Falha ao recupear summary: " + ex);
    }

    return summary;
}

SharedFunctions.SetHotelOnMap = function (hotel, parent, searchController) {
    //Bugado...

    /*
    var hotelHashKey = SharedFunctions.GetHotelHashKey(parent);

    var selectedRoomsInHotel = searchController.getSelectedRoomsInHotel(hotel.Index);

    var hotelCopied = $.extend(false, hotel, {});

    hotelCopied.Rooms = hotelCopied.RoomsGroups.where(function (roomGroup) {
        return roomGroup.Rooms.where(function (r) {
            return selectedRoomsInHotel.RoomIndexes.any(function (ri) {
                return ri.RoomIndex == r.Index;
            });
        });
    });
    */
    /*hotelCopied.Rooms = hotelCopied.Rooms.where(function (r) {
        return selectedRoomsInHotel.RoomIndexes.any(function (ri) {
            return ri.RoomIndex == r.Index;
        });
    });*/
}

/* FunÃ§Ãµes de serviÃ§os locais */
SharedFunctions.SetEventTotalAmount = function (event) {
    var totalAmount = 0, value = 0;

    for (var i = 0, len = event.EventSectors.length; i < len; i++) {
        for (var j = 0, limit = event.EventSectors[i].SectorLots.length; j < limit; j++) {
            var currentSectorLot = event.EventSectors[i].SectorLots[j];
            totalAmount += (currentSectorLot.NormalPrice * currentSectorLot.NormalQuantity);
        }
    }

    event.TotalAmount = totalAmount;
}

SharedFunctions.ValidateEventsofPackage = function (package) {

    if (package.Events && package.Events.length) {
        if (!package.SelectedEvents || (package.SelectedEvents && !package.SelectedEvents.length))
            package.Events = [];
    }
}

SharedFunctions.SetPackageEventSearchSummary = function (package, searchController) {
    if (package.Events && package.Events.length) {
        var searchSummary = searchController.lastSearchParameters && searchController.lastSearchParameters.Event ? searchController.lastSearchParameters.Event : {};

        for (var i = 0, len = package.Events.length; i < len; i++) {
            package.Events[i].SearchSummary = searchSummary;
            package.Events[i].SearchParameters = searchController.lastSearchParameters;
        }
    }
}
/* Fim das funÃ§Ãµes de serviÃ§os locais */

/*FunÃ§Ãµes Ãteis do CVC FEU */
SharedFunctions.ShowHotelDescription = function (hotelDescriptionComponent) {
    hotelDescriptionComponent.die('click').live('click', function () {
        var $this = $(this);

        var completeDescription = $this.find('span.completeDescription');
        var cuttedDescription = $this.find('span.cuttedDescription');

        if (cuttedDescription.is(":visible")) {
            completeDescription.show();
            cuttedDescription.hide();
        } else {
            completeDescription.hide();
            cuttedDescription.show();
        }
    });
}
/*Fim das funÃ§Ãµes*/

SharedFunctions.FlightGroupIsBestBuy = function (flightGroup) {
    return flightGroup.Flights.any(function (f) { return f.ClassOfService == "$"; });
};

SharedFunctions.ResolverAirSumTaxes = function (value, sumDu, totalTaxes, step) {
    var sumFareTaxesDU = Util.GetSumFareTaxesDU(step);

    var resolvedAmounts = {
        FareAmount: 0,
        ServicesAmount: 0,
        TaxesAmount: 0
    };

    if (typeof sumDu == "undefined") {
        sumDu = 0;
    }

    if (typeof totalTaxes == "undefined")
        totalTaxes = 0;

    switch (sumFareTaxesDU) {
        case "fare+taxes":
            resolvedAmounts.FareAmount = (value + totalTaxes);
            resolvedAmounts.ServicesAmount = sumDu;
            break;
        case "fare+taxes+du":
            resolvedAmounts.FareAmount = (value + totalTaxes + sumDu);
            break;
        case "fare+du": {
            resolvedAmounts.FareAmount = (value + sumDu);
            resolvedAmounts.TaxesAmount = totalTaxes;
        }
            break;
        case "taxes+du":
            {
                resolvedAmounts.FareAmount = value;
                resolvedAmounts.TaxesAmount = totalTaxes + sumDu;
            }
            break;
        default:
            {
                resolvedAmounts.FareAmount = value;
                resolvedAmounts.TaxesAmount = totalTaxes;
                resolvedAmounts.ServicesAmount = sumDu;
            }
            break;
    }

    return resolvedAmounts;
};

SharedFunctions.ValidateContext = function (errors) {
    if (typeof (Ide) != 'undefined') {
        if (Ide.applicationSettings["NeedClientInSearchOrRetrieve"] != undefined && Ide.applicationSettings["NeedClientInSearchOrRetrieve"].toLowerCase() == "true") {
            if (!Ide.companyContext || Ide.companyContext.CustomerId == undefined || Ide.companyContext.CustomerId == '')
                if (errors)
                    errors.push("OnSearch_NoClientInContext");
                else
                    throw Ide.notifyMessagesExhibitor("OnRetrieve_NoClientInContext");
        }
    }
};

SharedFunctions.CanCancelAirBook = function (response) {
    var canCancelBook = response.AdditionalInfo && response.AdditionalInfo.first(function (a) { return a.Key == "allowCancellationJustInEmissionDay" });

    return !canCancelBook || (canCancelBook.Value && canCancelBook.Value.toLowerCase() == "true");
};

SharedFunctions.CanCancelHotelBook = function (response) {
    var canCancelBook = response.AdditionalInfo && response.AdditionalInfo.first(function (a) { return a.Key == "allowHotelCancellation" });

    return !canCancelBook || (canCancelBook.Value && canCancelBook.Value.toLowerCase() == "true");
};

SharedFunctions.CanCancelInsuranceBook = function (response) {
    return response.TravelEngineResponse.TravelEnginePnr.InsurancePnrs.any(function (insurancePnr) { return insurancePnr.Status == EnumHelper.PnrStatus.Booked });
};

SharedFunctions.CanCancelBook = function (response) {

    var tePnr = response.TravelEngineResponse.TravelEnginePnr;
    var canCancelBook = true;

    if (tePnr.HotelPnrs && tePnr.HotelPnrs.length)
        canCancelBook = SharedFunctions.CanCancelHotelBook(response);
    else if (tePnr.AirPnrs && tePnr.AirPnrs.length)
        canCancelBook = SharedFunctions.CanCancelAirBook(response);
    else if (tePnr.InsurancePnrs && tePnr.InsurancePnrs.length)
        canCancelBook = SharedFunctions.CanCancelInsuranceBook(response);

    return canCancelBook && !response.TravelEngineResponse.TravelEnginePnr.TravelEnginePnrCanceled;
};

SharedFunctions.ShowFlightGroupHash = function () {
    var canCancelBook = response.AdditionalInfo && response.AdditionalInfo.first(function (a) { return a.Key == "allowHotelCancellation" });

    return !canCancelBook || (canCancelBook.Value && canCancelBook.Value.toLowerCase() == "true");
};

SharedFunctions.PackageRoomsRequestToPassengers = function (packageRoomsRequest) {
    var passengers = SharedFunctions.PackageRoomsRequestToPassengersArray(packageRoomsRequest);

    var _passengers = {
        Adults: 0,
        Children: 0,
        Babies: 0
    };

    passengers.foreach(function (p) {
        _passengers.Adults += p.Adults;
        _passengers.Children += p.Children;
        _passengers.Babies += p.Babies;
    })

    return _passengers;
};

SharedFunctions.PackageRoomsRequestToPassengersArray = function (packageRoomsRequest) {

    var resp = [];

    packageRoomsRequest.forEach(function (pkgRoomReq) {

        var _passengers = {
            Adults: 0,
            Children: 0,
            Babies: 0
        };

        pkgRoomReq.PassengersAges.forEach(function (paxAge) {
            if (paxAge >= 12)
                _passengers.Adults = (_passengers.Adults + 1);
            else {
                if (paxAge >= 2)
                    _passengers.Children = (_passengers.Children + 1);
                else
                    _passengers.Babies = (_passengers.Babies + 1);
            }
        });

        resp.push(_passengers);
    });

    return resp;
};

SharedFunctions.PackageRoomsRequestToRoomsGroups = function (packageRoomsRequest) {
    var _roomsGroups = [];

    packageRoomsRequest.forEach(function (pkgRoomReq) {
        var _roomGroup = { Adults: 0, ChildAges: [] };
        pkgRoomReq.PassengersAges.forEach(function (paxAge) {
            if (paxAge >= 12)
                _roomGroup.Adults = (_roomGroup.Adults + 1);
            else
                _roomGroup.ChildAges.push(paxAge);
        });
        _roomsGroups.push(_roomGroup);
    });

    return _roomsGroups;
};

SharedFunctions.GetAirDetailedCosts = function (fare, taxes, fee, du, precision, useCurrency, currency) {
    var costs = {
        Fare: 0,
        Taxes: 0,
        Fee: 0,
        DU: 0,
        Total: 0,
    };

    costs.totalUnformatted = parseFloat(fare + taxes + fee + du).toFixed(precision);

    costs.Fare = formatter.currency(fare, useCurrency, precision, currency);
    costs.Taxes = formatter.currency(taxes, useCurrency, precision, currency);
    costs.Fee = formatter.currency(fee, useCurrency, precision, currency);
    costs.DU = formatter.currency(du, useCurrency, precision, currency);

    costs.Total = formatter.currency(costs.totalUnformatted, useCurrency, precision, currency);

    return costs;
};

//#region :: Apply Setting PaymentOptionByProduct
SharedFunctions.SettingPaymentOptionByProduct.Map = {};
SharedFunctions.SettingPaymentOptionByProduct.GetMap = function () {
    if ($.isEmptyObject(SharedFunctions.SettingPaymentOptionByProduct.Map)) {
        try {
            SharedFunctions.SettingPaymentOptionByProduct.Map = Util.JSONParse(Util.GetSetting("PaymentOptionByProduct"));
        }
        catch (exception) {
            SharedFunctions.SettingPaymentOptionByProduct.Map = {};
        }

        var allPaymentTypes = Object.keys(EnumHelper.PaymentType).where(function (h) { return isNaN(h); });

        for (var product in SharedFunctions.SettingPaymentOptionByProduct.Map) {
            if (SharedFunctions.SettingPaymentOptionByProduct.Map[product]) {
                var options = SharedFunctions.SettingPaymentOptionByProduct.Map[product];

                var missingTypes = allPaymentTypes.where(function (type) { return !options.any(function (o) { return o.key == type.toLowerCase(); }); });

                missingTypes.foreach(function (h) {
                    options.push({
                        key: h.toLowerCase(),
                        value: "true"
                    });
                })
            }
        }
    }

    return SharedFunctions.SettingPaymentOptionByProduct.Map;
};

/**
* productTypes  : []EnumHelper.ProductType
* paymentOptions
*/
SharedFunctions.SettingPaymentOptionByProduct.FilterPaymentOptions = function (productTypes, paymentOptions) {
    var mapper = SharedFunctions.SettingPaymentOptionByProduct.GetMap();

    if ($.isEmptyObject(mapper)) return paymentOptions;

    return paymentOptions.where(function (paymentOption) {
        if (typeof paymentOption.Type === "undefined") return true;

        return productTypes.all(function (productType) {
            return SharedFunctions.SettingPaymentOptionByProduct.ValidatePaymentOptionByProduct(productType, paymentOption);
        });
    });
};

/**
* productType: EnumHelper.ProductType 
*/
SharedFunctions.SettingPaymentOptionByProduct.FilterPaymentOptionsByProduct = function (productType, paymentOptions) {
    return paymentOptions.where(function (paymentOption) {
        if (typeof paymentOption.Type === "undefined") return true;

        return SharedFunctions.SettingPaymentOptionByProduct.ValidatePaymentTypeByProduct(productType, paymentOption.Type);
    });
};

/**
* productType: EnumHelper.ProductType 
* paymentOption
*/
SharedFunctions.SettingPaymentOptionByProduct.ValidatePaymentOptionByProduct = function (productType, paymentOption) {
    var paymentType = paymentOption.Type;

    if (paymentType == EnumHelper.PaymentType.Invoice && paymentOption.FlagName)
        paymentType = EnumHelper.PaymentType[paymentOption.FlagName];

    if (productType && paymentType)
        return SharedFunctions.SettingPaymentOptionByProduct.ValidatePaymentTypeByProduct(productType, paymentType);
    else
        return true;
};

/**
* productType: EnumHelper.ProductType 
* paymentType: EnumHelper.PaymentType
*/
SharedFunctions.SettingPaymentOptionByProduct.ValidatePaymentTypeByProduct = function (productType, paymentType) {
    var mapper = SharedFunctions.SettingPaymentOptionByProduct.GetMap();
    var productTypeName = EnumHelper.ProductType[productType].toLowerCase();
    var paymentTypeName = EnumHelper.PaymentType[paymentType].toLowerCase();

    return mapper[productTypeName].any(function (c) {
        var key = (c.key || c.Key);
        var value = (c.value || c.Value);
        return key == paymentTypeName && value == "true";
    })
};

//#endregion

//#region :: Apply Setting PaymentTypeAction
SharedFunctions.SettingPaymentTypeAction.Map = {};

SharedFunctions.SettingPaymentTypeAction.GetMap = function () {
    if ($.isEmptyObject(SharedFunctions.SettingPaymentTypeAction.Map)) {
        try {
            SharedFunctions.SettingPaymentTypeAction.Map = Util.JSONParse(Util.GetSetting("PaymentTypeAction"));
        }
        catch (exception) {
            SharedFunctions.SettingPaymentTypeAction.Map = {};
        }
    }

    return SharedFunctions.SettingPaymentTypeAction.Map;
};

/**
* action     : EnumHelper.PaymentTypeActions
* paymentType: EnumHelper.PaymentType
*/
SharedFunctions.SettingPaymentTypeAction.ValidateAction = function (action, paymentType) {
    var map = SharedFunctions.SettingPaymentTypeAction.GetMap();

    if ($.isEmptyObject(map))
        return EnumHelper.PaymentTypeActions.DefaultValues[action];

    if (map.hasOwnProperty(paymentType) && map[paymentType] != undefined && map[paymentType].hasOwnProperty(action) && map[paymentType][action] != undefined)
        return map[paymentType][action] == "1" || map[paymentType][action] == "true";

    return EnumHelper.PaymentTypeActions.DefaultValues[action] == "1" || EnumHelper.PaymentTypeActions.DefaultValues[action] == "true";
};

/**
* paymentType: []EnumHelper.PaymentType
* action     : EnumHelper.PaymentTypeActions
*/
SharedFunctions.SettingPaymentTypeAction.ValidatePaymentTypes = function (paymentTypes, action) {
    return paymentTypes.where(function (p) {
        return SharedFunctions.SettingPaymentTypeAction.ValidateAction(action, p);
    });
};
//#endregion

//#region :: Apply Setting CruisePnrLiveEdit
SharedFunctions.SettingCruisePnrLiveEdit.Map = {};

SharedFunctions.SettingCruisePnrLiveEdit.GetMap = function () {
    if ($.isEmptyObject(SharedFunctions.SettingCruisePnrLiveEdit.Map)) {
        try {
            SharedFunctions.SettingCruisePnrLiveEdit.Map = Util.JSONParse(Util.GetSetting("cruiseLiveEdit_ItensBehavior"));
        }
        catch (exception) {
            SharedFunctions.SettingCruisePnrLiveEdit.Map = {};
        }
    }

    return SharedFunctions.SettingCruisePnrLiveEdit.Map;
};

/**
* action    : EnumHelper.CruisePnrLiveEditActions
* item      : EnumHelper.CruisePnrLiveEditItems
*/
SharedFunctions.SettingCruisePnrLiveEdit.ValidateAction = function (action, item) {
    var map = SharedFunctions.SettingCruisePnrLiveEdit.GetMap();

    if ($.isEmptyObject(map))
        return EnumHelper.CruisePnrLiveEditActions.DefaultValues[action];

    if (map.hasOwnProperty(item) && map[item] != undefined && map[item].hasOwnProperty(action) && map[item][action] != undefined)
        return map[item][action] == "1" || map[item][action] == "true";

    return EnumHelper.CruisePnrLiveEditActions.DefaultValues[action] == "1" || EnumHelper.CruisePnrLiveEditActions.DefaultValues[action] == "true";
};

/**
* items     : []EnumHelper.CruisePnrLiveEditItems
* action    : EnumHelper.CruisePnrLiveEditActions
*/
SharedFunctions.SettingCruisePnrLiveEdit.ValidateLiveEditItems = function (items, action) {
    return items.where(function (p) {
        return SharedFunctions.SettingCruisePnrLiveEdit.ValidateAction(action, p);
    });
};
//#endregion

//#region :: Resolve SearchEngineDaysRange
SharedFunctions.ResolveSearchRange.GetMapper = function () {
    var settingsRepository = undefined;

    if (typeof Ide === "object" && Ide.hasOwnProperty("applicationSettings"))
        settingsRepository = Ide.applicationSettings;
    else if (typeof Global === "object" && Global.hasOwnProperty("Settings"))
        settingsRepository = Global.Settings;

    if (typeof settingsRepository !== "undefined") {
        try { return JSON.parse(Ide.applicationSettings["SearchRange"]); }
        catch (e) { }
    }

    return undefined;
};

SharedFunctions.ResolveSearchRange.GetProductConfig = function (productTypeName) {
    var searchRangeMapper = SharedFunctions.ResolveSearchRange.GetMapper();

    if (typeof searchRangeMapper !== "undefined") {
        for (var product in searchRangeMapper) {
            if (product.toLowerCase() === productTypeName.toLowerCase()) {
                return searchRangeMapper[product];
            }
        }
    }

    return undefined;
};

SharedFunctions.ResolveSearchRange.MinDays = function (productTypeName) {
    var defaultValue = 0;
    var config;

    if (typeof productTypeName === "undefined" || productTypeName === "")
        return defaultValue;

    config = SharedFunctions.ResolveSearchRange.GetProductConfig(productTypeName);

    if (typeof config !== "undefined") {
        if (typeof config.min !== "undefined")
            return config.min;
        else if (typeof config.Min !== "undefined")
            return config.Min;
        else
            return defaultValue;
    }

    return defaultValue;
};

SharedFunctions.ResolveSearchRange.MaxDays = function (productTypeName) {
    var defaultValue = 365;
    var config;

    if (typeof productTypeName === "undefined" || productTypeName === "")
        return defaultValue;

    config = SharedFunctions.ResolveSearchRange.GetProductConfig(productTypeName);

    return typeof config !== "undefined" ? (config.max || config.Max) : defaultValue;
};

//#endregion

//#region :: Apply Setting OfflineItemAction
SharedFunctions.SettingOfflineItemAction.Map = {};

SharedFunctions.SettingOfflineItemAction.GetMap = function () {
    if ($.isEmptyObject(SharedFunctions.SettingOfflineItemAction.Map)) {
        try {
            SharedFunctions.SettingOfflineItemAction.Map = Util.JSONParse(Util.GetSetting("OfflineItemAction"));
        }
        catch (exception) {
            SharedFunctions.SettingOfflineItemAction.Map = {};
        }
    }

    return SharedFunctions.SettingOfflineItemAction.Map;
};

/**
* action     : EnumHelper.OfflineItemActions
* serviceType: Ide.serviceTypes
*/
SharedFunctions.SettingOfflineItemAction.ValidateAction = function (action, serviceType) {
    var map = SharedFunctions.SettingOfflineItemAction.GetMap();

    if (serviceType)
        serviceType = serviceType.toLowerCase();

    if ($.isEmptyObject(map))
        return false;

    if (map.hasOwnProperty(serviceType) && map[serviceType] != undefined && map[serviceType].hasOwnProperty(action) && map[serviceType][action] != undefined)
        return map[serviceType][action] == "1";

    return false;
};

/**
* paymentType: []Ide.serviceTypes
* action     : EnumHelper.OfflineItemActions
*/
SharedFunctions.SettingOfflineItemAction.ValidatePaymentTypes = function (serviceTypes, action) {
    return paymentTypes.where(function (p) {
        return SharedFunctions.SettingOfflineItemAction.ValidateAction(action, p);
    });
};
//#endregion

SharedFunctions.ResolveServiceOrderPaymentType = function (paymentType) {

    if (Global.Culture.toLowerCase() == "es-ve" && paymentType == EnumHelper.PaymentType.Invoice) {
        return Util.CallResources("Credit");
    }

    return Util.CallResources(EnumHelper.PaymentType[paymentType]);
};

SharedFunctions.AssertSearchDataContainsProduct = function (searchData, propertieName, test) {
    var assert = (searchData.hasOwnProperty(propertieName) && !$.isEmptyObject(searchData[propertieName]));

    if (test)
        return assert;
    else
        return !assert;
};

SharedFunctions.SearchDataContainsOnlyAir = function (searchData) {

    return SharedFunctions.AssertSearchDataContainsProduct(searchData, "AirSearchData", true)
        && SharedFunctions.AssertSearchDataContainsProduct(searchData, "HotelSearchData", false)
        && SharedFunctions.AssertSearchDataContainsProduct(searchData, "InsuranceSearchData", false)
        && SharedFunctions.AssertSearchDataContainsProduct(searchData, "TicketsSearchData", false)
        && SharedFunctions.AssertSearchDataContainsProduct(searchData, "ServicesSearchData", false)
        && SharedFunctions.AssertSearchDataContainsProduct(searchData, "CarSearchData", false)
        && SharedFunctions.AssertSearchDataContainsProduct(searchData, "PackageSearchData", false);

};

SharedFunctions.PreOrderRequestContainsOnlyAir = function (preOrderRQ) {

    //TODO: Validar se contem carro.

    var containsAir = (preOrderRQ.hasOwnProperty("FlightGroups") && !$.isEmptyObject(preOrderRQ.FlightGroups));
    var containsHotel = (preOrderRQ.hasOwnProperty("Hotels") && !$.isEmptyObject(preOrderRQ.Hotels));
    var containsService = (preOrderRQ.hasOwnProperty("ServicesBookData") && !$.isEmptyObject(preOrderRQ.ServicesBookData));
    var containsCar;

    return containsAir
        && !containsHotel
        && !containsService;

};

SharedFunctions.PreOrderResponseContainsOnlyHotel = function (preOrderRS) {

    var containsAir = (preOrderRS.hasOwnProperty("FlightGroups") && !$.isEmptyObject(preOrderRS.FlightGroups) && preOrderRS.FlightGroups.length);
    var containsHotel = (preOrderRS.hasOwnProperty("Hotels") && !$.isEmptyObject(preOrderRS.Hotels) && preOrderRS.Hotels.length);
    var containsService = (preOrderRS.hasOwnProperty("Services") && !$.isEmptyObject(preOrderRS.Services) && preOrderRS.Services.length);
    var containsCar = (preOrderRS.hasOwnProperty("CarFares") && !$.isEmptyObject(preOrderRS.CarFares) && preOrderRS.CarFares.length);

    return containsHotel
        && !containsAir
        && !containsService
        && !containsCar;

};

SharedFunctions.GetBookingFareSequenceNumber = function (bookingFare) {

    var sequenceNumber = undefined;

    if (bookingFare.hasOwnProperty("ExternalProperties") && bookingFare.ExternalProperties instanceof Array) {
        var sequenceNumberObj = bookingFare.ExternalProperties.first(function (p) { return p.Key == "SequenceNumber"; });
        if (sequenceNumberObj != undefined) {
            sequenceNumber = sequenceNumberObj.Value;
        }
    }

    return sequenceNumber;
};

SharedFunctions.GetPreOrderProducts = function (preOrderResponse) {

    var products = [];

    if (preOrderResponse.BookingFares && preOrderResponse.BookingFares.length)
        products.push(EnumHelper.ProductType.Air);

    if (preOrderResponse.CarFares && preOrderResponse.CarFares.length)
        products.push(EnumHelper.ProductType.Car);

    if (preOrderResponse.Hotels && preOrderResponse.Hotels.length)
        products.push(EnumHelper.ProductType.Hotel);

    if (preOrderResponse.Services && preOrderResponse.Services.length)
        products.push(EnumHelper.ProductType.Service);

    return products;

};

SharedFunctions.GetServiceItemProductType = function (serviceItem) {
    if (serviceItem.ServiceTypeName.normalizedContains("air"))
        return EnumHelper.ProductType.Air;
    else if (serviceItem.ServiceTypeName.normalizedContains("car"))
        return EnumHelper.ProductType.Car;
    else if (serviceItem.ServiceTypeName.normalizedContains("hotel"))
        return EnumHelper.ProductType.Hotel;
    else if (serviceItem.ServiceTypeName.normalizedContains("service"))
        return EnumHelper.ProductType.Service;
    else if (serviceItem.ServiceTypeName.normalizedContains("advance"))
        return EnumHelper.ProductType.Advance;
};

SharedFunctions.CheckFlightGroupsWaitList = function (response) {
    var makeCheck = assertCheckWaitList(response);

    if (makeCheck) {
        var flightGroups = response.Request.FlightGroups;

        return flightGroups && flightGroups.any(function (fg) {
            return fg.Flights.any(function (f) {
                var flightClass = f.FlightClasses.first(function (fc) {
                    return fc.Class == f.ClassOfService
                });

                if (flightClass != undefined && flightClass.hasOwnProperty("Quantity"))
                    return flightClass.Quantity == 0;

                return false;
            });
        });
    }

    function assertCheckWaitList(response) {
        return response != undefined &&
            ((response.Request != undefined &&
                response.Request.SearchData != undefined &&
                response.Request.SearchData.AirSearchData != undefined &&
                response.Request.SearchData.AirSearchData.SearchType == EnumHelper.SearchMethodType.SearchBySchedule)
                ||
                (response.searchData != undefined &&
                    response.searchData.AirSearchData != undefined &&
                    response.searchData.AirSearchData.SearchType == EnumHelper.SearchMethodType.SearchBySchedule))
    }
};

SharedFunctions.CheckNumberFieldInfity = function (field, resetValue) {
    if (!isFinite(Util.RemoveCurrencyMask(field.val()))) {
        if (resetValue)
            field.val(CommonFunctionsTPL.ZeroValueFormatted);
        return true;
    }

    return false;
};

SharedFunctions.CheckNumberFieldInfity = function (field, resetValue) {
    if (!isFinite(Util.RemoveCurrencyMask(field.val()))) {
        if (resetValue)
            field.val(CommonFunctionsTPL.ZeroValueFormatted);
        return true;
    }

    return false;
};

SharedFunctions.GetFlightGroupsIataPairs = function (flightGroups) {
    var iatas = [];

    flightGroups.forEach(function (fg) {
        var flightGroup = fg.OriginalFlightGroup ? fg.OriginalFlightGroup : fg;
        flightGroup.Flights.forEach(function (f) {
            if (!iatas.any(function (x) { return x.Origin == f.Origin && x.Destination == f.Destination; }))
                iatas.push({ Origin: f.Origin, Destination: f.Destination });
        });
    });

    return iatas;
};

SharedFunctions.CreateFeeValues = function (prop, bookingFares) {
    var initialFeeValues = {
        Adult: 0,
        Child: 0,
        Baby: 0,
    };

    var minimunFeeValues = {
        Adult: 0,
        Child: 0,
        Baby: 0,
    };

    //Obtem os valores iniciais
    bookingFares = (bookingFares || []);

    var totalFeeIsTax = bookingFares.select(function (bf) {
        if (bf.Pricing && bf.Pricing.PricingsApplied && bf.Pricing.PricingsApplied.length)
            return bf.Pricing.PricingsApplied.where(function (pa) {
                return pa.IsTax
            }).sum(function (pa) {
                return pa[prop];
            });
    }).sum(function (arr) {
        return arr;
    });

    bookingFares.forEach(function (bookingFare) {
        var passengerType = bookingFare.Passengers.first().Type;
        var totalFeeIsNotTax = 0;
        if (bookingFare.Pricing && bookingFare.Pricing.PricingsApplied && bookingFare.Pricing.PricingsApplied.length)
            totalFeeIsNotTax = bookingFare.Pricing.PricingsApplied.where(function (pa) { return !pa.IsTax }).sum(function (pa) { return pa[prop]; });

        initialFeeValues[EnumHelper.Passenger.PassengerType[passengerType]] = totalFeeIsNotTax;
        minimunFeeValues[EnumHelper.Passenger.PassengerType[passengerType]] = totalFeeIsNotTax;
    });

    return {
        initialFeeValues: initialFeeValues,
        minimunFeeValues: minimunFeeValues,
        totalTax: totalFeeIsTax
    };
};

SharedFunctions.GenerateSearchEngineAvailableMonths = function (maxDaysToSearch) {
    var resp = [];
    var currentDate = new Date();
    var currentMonth = (currentDate.getMonth() + 1);
    var currentYear = currentDate.getFullYear();

    var availableOption = function (month, year) {
        return {
            Month: month,
            Year: year,
            Label: Util.StringFormat("{0}/{1}", formatter.monthName(month), year)
        };
    };

    for (var i = currentMonth; i <= 12; i++) {
        resp.push(availableOption(i, currentYear));
    }

    maxDaysToSearch = (maxDaysToSearch || 360);

    //#region :: Remaining months
    var remainingMonths = (Math.floor(maxDaysToSearch / 30) - (12 - currentMonth));
    var cMonth = 1;
    var cYear = (currentYear + 1);

    for (var i = 1; i <= remainingMonths; i++) {
        resp.push(availableOption(cMonth, cYear));

        cMonth += 1;

        if (cMonth > 12) {
            cMonth = 1;
            cYear += 1;
        }
    }
    //#endregion

    return resp;
};

SharedFunctions.GetClearSaleFingerPrintID = function () {
    return $("#clearSaleSessionIdentifier").val();
};

SharedFunctions.StartClearSale = function () {
    if (typeof ClearSale === "object") {
        if (ClearSale.IsInitialized) {
            ClearSale.Update();
        }
        else {
            ClearSale.Initialize(new InterfaceBuilderController(new ServiceCaller(Global.PathWebService)));
        }
    }
};

SharedFunctions.StartHotelChains = function () {
    if (typeof HotelChainsModel === "object") {
        if (HotelChainsModel.IsInitialized) {
            HotelChainsModel.Update();
        }
        else {
            HotelChainsModel.Initialize(new InterfaceBuilderController(new ServiceCaller(Global.PathWebService)));
        }
    }
};

SharedFunctions.PassengerTypeChangedDuringTheTravel = function (sourcePassengerType, birthDateOfPassenger, lastDateOfTravel) {

    var verifyAndNotificateByPassengerType = {
        0: function () { return false; },
        1: _childIsAdultOnLastDateTravel,
        2: _babyIsChildOnLastDateTravel,
        3: function () { return false; },
        Adult: function () { return false; },
        Baby: _babyIsChildOnLastDateTravel,
        Child: _childIsAdultOnLastDateTravel,
        Senior: function () { return false; }
    };

    function _childIsAdultOnLastDateTravel(lastDateOfTravel, birthDateOfPassenger) {
        var ageInTheLastDateOfTravel = Util.GetAge(birthDateOfPassenger, lastDateOfTravel);

        return ageInTheLastDateOfTravel >= 12;
    };

    function _babyIsChildOnLastDateTravel(lastDateOfTravel, birthDateOfPassenger) {
        var ageInTheLastDateOfTravel = Util.GetAge(birthDateOfPassenger, lastDateOfTravel);

        return ageInTheLastDateOfTravel >= 2;
    };

    return verifyAndNotificateByPassengerType[sourcePassengerType](lastDateOfTravel, birthDateOfPassenger);;
};

SharedFunctions.GetLastDateOfCityPairsRequested = function (searchData) {
    var ret = undefined;
    if (SharedFunctions.AssertSearchDataContainsProduct(searchData, "AirSearchData", true)) {
        if (searchData.AirSearchData.CityPairsRequest && searchData.AirSearchData.CityPairsRequest.length) {
            var lastCityPairRequested = searchData.AirSearchData.CityPairsRequest.last();

            ret = new Date(lastCityPairRequested.DepartureYear, lastCityPairRequested.DepartureMonth - 1, lastCityPairRequested.DepartureDay);
        }
        else if (searchData.BeginDepartureDateTime)
            ret = new Date(searchData.BeginDepartureDateTime.Year, searchData.BeginDepartureDateTime.Month - 1, searchData.BeginDepartureDateTime.Day);
    }


    return ret;
};

SharedFunctions.NotifyWhenPassengerChangeTypeDuringTheTravel = function (sourcePassengerType, nameOfPax, birthDateOfPassenger, searchData, funcToShowMessage) {
    var paxIsChildOrBaby = function (passengerType) {
        return [EnumHelper.Passenger.PassengerType.Child.toString(), EnumHelper.Passenger.PassengerType.Baby.toString()].any(passengerType);
    };

    if (birthDateOfPassenger &&
        paxIsChildOrBaby(sourcePassengerType) &&
        searchData.hasOwnProperty("AirSearchData") &&
        !$.isEmptyObject(searchData.AirSearchData)) {

        var lastDateOfTravel = SharedFunctions.GetLastDateOfCityPairsRequested(searchData);

        var changedPassengerType = SharedFunctions.PassengerTypeChangedDuringTheTravel(sourcePassengerType, birthDateOfPassenger, lastDateOfTravel);

        if (changedPassengerType) {
            if (funcToShowMessage && typeof (funcToShowMessage) == "function") {
                var msgToShow = Util.stringformat(
                    Util.GetInterfaceMessage("Notify_WhenPassengerTypeChangedDuringTheTravel"),
                    formatter.dateValuesShort(Util.DateToDateValues(lastDateOfTravel)),
                    nameOfPax,
                    Util.CallResources(EnumHelper.Passenger.PassengerType[sourcePassengerType]),
                    Util.GetAge(birthDateOfPassenger, lastDateOfTravel));
                funcToShowMessage(msgToShow);
            }
        }

    }
};

SharedFunctions.GetDifferenceToAddOrRemoveBaggage = function (selectedBrandedFare, otherBrandedFare) {
    var showPointsAndMoney = Util.GetExternalPropertieValue(selectedBrandedFare.ExternalProperties, "ShowPointsAndMoney");
    var difference = 0;
    var differenceFormatted = '';
    var moneyDifference = 0;
    var moneyDifferenceFormatted = '';
    var usePoints = otherBrandedFare.B2BExtension != null;

    if (usePoints) {
        difference = otherBrandedFare.B2BExtension.PointsValue - selectedBrandedFare.B2BExtension.PointsValue;
        differenceFormatted = formatter.coins.getPoints().toString(difference).replace('-', '');

        if (showPointsAndMoney && showPointsAndMoney === "true") {
            moneyDifference = otherBrandedFare.DisplayTotalAmount - selectedBrandedFare.DisplayTotalAmount;
            moneyDifferenceFormatted = formatter.currency(moneyDifference, true, 2).replace('-', '');
        }

    } else {
        difference = otherBrandedFare.DisplayTotalAmount - selectedBrandedFare.DisplayTotalAmount;
        differenceFormatted = formatter.currency(difference, true, 2).replace('-', '');
    }

    baggagesDifference = otherBrandedFare.BaggagesIncluded - selectedBrandedFare.BaggagesIncluded;

    return {
        "UsePoints": usePoints,
        "Value": difference,
        "ValueFormatted": differenceFormatted,
        "BaggagesIncluded": otherBrandedFare.BaggagesIncluded,
        "DifferenceQuantity": baggagesDifference,
        "MoneyValue": moneyDifference,
        "MoneyValueFormatted": moneyDifferenceFormatted
    };
};

SharedFunctions.GetUserTotalPoints = function () {
    var totalPoints = 0;
    if (window.loginbehaviour && window.loginbehaviour.ui && window.loginbehaviour.ui.memory && window.loginbehaviour.ui.memory.sessionJSON && window.loginbehaviour.ui.memory.sessionJSON.TotalPoints != undefined) {
        totalPoints += eval(window.loginbehaviour.ui.memory.sessionJSON.TotalPoints);

        //obter pontos "equivalentes" RDC
        if (window.loginbehaviour.ui.memory.sessionJSON.AdditionalInfo) {
            var infoName = window.loginbehaviour.ui.memory.sessionJSON.AdditionalInfo.first(function (info) { return info.Key == "ExtraFieldName2" && info.Value == "Equivalente" });
            var infoValue = window.loginbehaviour.ui.memory.sessionJSON.AdditionalInfo.first(function (info) { return info.Key == "ExtraFieldValue2" });

            if (infoName && infoValue)
                totalPoints += eval(infoValue.Value);
        }
    }
    return totalPoints;
};

SharedFunctions.GetUserTotalPointsByProduct = function (productType, destinations) {
    var req = loginbehaviour.balance.refreshBalanceEnvelope();
    req = req.req;

    var index = req.AdditionalInfo.length;
     
    req.AdditionalInfo[index] = { Key: 'ProductType', Value: productType };
    req.AdditionalInfo[index + 1] = { Key: 'Destinations', Value: destinations.join(',') };

    $.ajax({
        url: Global.PathWebService + 'GetAuthenticatedUserInformation',
        type: 'POST',
        async: false,
        dataType: 'json',
        contentType: 'application/json',
        headers: Global.Headers ? Global.Headers : {},
        data: JSON.stringify({ req }),
        success: function (data, status, xhr) {
            loginbehaviour.balance.on_response_balance(data);
        },
        error: function (xhr, textStatus) {
            _I.BlockInvoke = false;
            try {
                var message = undefined;

                if (textStatus != 'abort') {
                    if (Global.LoaderController)
                        Global.LoaderController.hideLoader();

                    if (waiting)
                        waiting.hide();

                    if (textStatus == "timeout")
                        message = "Tempo limite se esgotou para a operaÃ§Ã£o.";
                    else if (xhr.responseText && xhr.responseText.length) {

                        var ret = {
                            IsJSON: false,
                            JSONResponse: null,
                            HtmlResponse: null
                        }

                        var err;

                        try {
                            err = JSON2.parse(xhr.responseText);
                            ret.IsJSON = true;
                            ret.JSONResponse = err;
                        } catch (e) {
                            err = xhr.responseText;
                            ret.IsJSON = false;
                            ret.HtmlResponse = err;
                        }

                        message = ret;
                    }
                    else
                        message = "Problemas de processamento";

                    if (error) {
                        if (typeof message == 'string')
                            error(message);
                        else
                            error(message, callback);
                    } else if (Global.MessagesController && typeof message == 'string')
                        Global.MessagesController.notifyMessages([message], EnumHelper.MessagesExhibitor.ExhibitionType.Alert);
                }

                return;
            }
            catch (ex) {
                if (Global.LoaderController)
                    Global.LoaderController.hideLoader();

                if (error)
                    error(null);
            }
        }
    })

    return SharedFunctions.GetUserTotalPoints();
};

ï»¿if (typeof (TravelGo) == 'undefined')
    TravelGo = {};

if (typeof (Global) == 'undefined')
    Global = {};

Global.Options = {
    messagesController: {
        ShowOnlyFriendlyMessage: true
    },
    InterfaceEnvelopeStorageKey: "ienv_external_flow"
};

(function ($) {
    $(document).ready(function () {
        TravelGo.Functions = {
            CheckGlobal: function() {
                if (typeof (Global) == 'undefined') {
                    Global = {};
                }
            },
            ScrollTo: function (element) {
                if (element.offset())
                    $('body').animate({
                        scrollTop: element.offset().top
                    }, 500);
            },
            PriceGroups: {
                onAfterLiveEvents: function (data) {
                    $(data.settings.components.sortResults).on({
                        mouseenter: function () {
                            var ctrl = $(this);

                            if (!ctrl.hasClass("sorted"))
                                ctrl.addClass("sorted");
                        },
                        mouseleave: function () {
                            var ctrl = $(this);

                            if (!ctrl.attr("propertyName") || !(ctrl.attr("propertyName") == data.sortResult.ColumnName))
                                ctrl.removeClass("sorted");
                        }
                    });
                },
                onBeforeSendEmail: function () {
                    $(".modal.sendEmail").addClass("sendEmailLoading");
                },
            },
            ExchangeRates:  {
                exchangePrices: function (parent) {
                    var selectedCurrency = $("#selCurrencies option:selected").val();

                    var exchangeRate = 1;

                    if (selectedCurrency == "original")
                        selectedCurrency = "ARS";
                    else {
                        var exchangeRates = Global.SearchController.getExchangeRates();

                        if (exchangeRates) {
                            exchangeRate = exchangeRates.first(function (e) { return e.ExchangedCurrency == selectedCurrency });

                            exchangeRate = exchangeRate ? exchangeRate.Value : 1;
                        }
                    }

                    Global.selectedCurrency = selectedCurrency;
                    Global.CurrentExchangeRate = exchangeRate;

                    var prices = parent && parent.length ? $(".price", parent) : $(".price");

                    for (var i = 0, len = prices.length; i < len; i++) {
                        var ctrl = $(prices[i]);
                        var price = ctrl.attr("originalPrice");
                        if (price != undefined) {

                            if (ctrl.attr("points") === "true") {
                                ctrl.html(formatter.coins.getPoints().toString(price));
                            }else
                            {
                                ctrl.html(formatter.currency(price * exchangeRate, true, 2, selectedCurrency));
                            }

                        }
                    }
                }
            },
            ContinueForm: {
                SubmitForm: function () {
                    var form = $('#continueForm');
                    TravelGo.Functions.ContinueForm.SetFormAttributes();

                    form.submit();
                },
                SubmitWindowLocation : function(){
                    var form = $('#continueForm');
                    window.location.assign(form.attr('action'));
                },
                SetFormAttributes : function(){
                    ienv = Util.stringifyJSON(Global.InterfaceEnvelope);
                    ienv = ienv.replaceAll("'", "");
                    ienv = encodeURIComponent(ienv);

                    form.find('#InterfaceEnvelope').val(ienv);
                    form.find('#Culture').val(Global.Culture);
                    form.find('#SearchType').val(Global.SearchType);
                    form.find('#ExchangeRate').val(Global.ExchangeRate);
                    form.find('#SelectedCurrency').val(Global.selectedCurrency);
                    form.find('#QueryString').val(Global.QueryString);
                },
                SetAction: function (action) {
                    var form = TravelGo.Functions.ContinueForm.GetForm();

                    form.attr('action', action);

                    return TravelGo.Functions.ContinueForm;
                },
                GetForm: function () {
                    return $('#continueForm');
                },
                SetFormTarget: function (value) {
                    var form = $('#continueForm');

                    if (form)
                        form.attr("target", value);

                    return TravelGo.Functions.ContinueForm;
                },
                GetAction: function () {
                    var form = TravelGo.Functions.ContinueForm.GetForm();
                    return form.attr('action');
                },
                RedirectTo: function (action, targetType) {
                    var oldAction = TravelGo.Functions.ContinueForm.GetAction();

                    TravelGo.Functions.ContinueForm.SetAction(action)
                        .SetFormTarget(targetType || '')
                        .SubmitForm();

                    TravelGo.Functions.ContinueForm.SetFormTarget('')
                        .SetAction(oldAction);
                }
            },
            Hotel: {
                GetAdults: function (roomsRequest) {
                    return roomsRequest.select(function (r) { return r.Adults; }).join(",");
                },
                GetChildren: function (roomsRequest) {
                    return roomsRequest.select(function (r) { return r.ChildAges.length; }).join(",");
                },
                GetChildAges: function (roomsRequest) {
                    return roomsRequest.select(function (r) { return r.ChildAges.join(","); }).join(";");
                },
                GetDatePattern: function (date) {
                    return date.Day + '/' + date.Month + '/' + date.Year;
                }
            },
            QueryString: {
                requestQueryString: function (key) {
                    var match = RegExp('[?&]' + key + '=([^&]*)').exec(window.location.search);

                    var qryStrVal = match && decodeURIComponent(match[1].replace(/\+/g, ' '));

                    return qryStrVal;
                }
            },
            InterfaceEnvelope: {
                Initialize: function() {
                    TravelGo.Functions.CheckGlobal();

                    if (Global.InterfaceEnvelope == undefined) {
                        Global.InterfaceEnvelope = {};
                    }
                },
                CheckStorageKey: function (storageKey) {
                    if (storageKey == undefined || typeof (storageKey) !== 'string' || storageKey.length == 0) {
                        return Global != undefined && Global.Options != undefined && Global.Options.InterfaceEnvelopeStorageKey != undefined
                            ? Global.Options.InterfaceEnvelopeStorageKey
                            : 'ienv_external_flow';
                    } else {
                        return 'ienv_external_flow';
            }
                },
                Set: function (data, storageKey) {
                    TravelGo.Functions.InterfaceEnvelope.Initialize();

                    storageKey = TravelGo.Functions.InterfaceEnvelope.CheckStorageKey(storageKey);

                    if (Global.SessionStorage == undefined) {
                        Global.SessionStorage = [];
                    }

                    Global.InterfaceEnvelope = data;
                    Global.SessionStorage[storageKey] = data != undefined ? JSON.stringify(data) : undefined;
                },
                Merge: function (baseInterfaceEnvelope, dataToAddOrUpdate, storageKey) {
                    if (dataToAddOrUpdate != undefined) {
                        baseInterfaceEnvelope = $.extend(true, baseInterfaceEnvelope, dataToAddOrUpdate);
                    }

                    TravelGo.Functions.InterfaceEnvelope.Set(baseInterfaceEnvelope, storageKey);

                    return baseInterfaceEnvelope;
                },
                GetFromStorage: function (storageKey) {
                    storageKey = TravelGo.Functions.InterfaceEnvelope.CheckStorageKey(storageKey);

                    if (Global != undefined && Global.SessionStorage != undefined) {
                        return Global.SessionStorage[storageKey];
                    }

                    return undefined;
                },
                SetFromStorage: function (storageKey) {
                    Initialize();

                    Global.InterfaceEnvelope = TravelGo.Functions.InterfaceEnvelope.GetFromStorage(storageKey);
                },
                TrySetFromWindowHistory: function (storageKey) {
                    if (window.history.state && window.history.state.length) {
                        TravelGo.Functions.InterfaceEnvelope.Set(JSON2.parse(window.history.state), storageKey);
                    }
                },
                TrySetFromSessionStorageOrGlobalStorage: function (storageKey, updateGlobalStorage) {
                    if (updateGlobalStorage != undefined) {
                        updateGlobalStorage = false;
                    }

                    storageKey = TravelGo.Functions.InterfaceEnvelope.CheckStorageKey(storageKey);

                    // OBS: Safari (iOS) does not support localStorage or sessionStorage with private mode on
                    if (sessionStorage != undefined) {
                        try {
                            var sessionInterfaceEnvelope = sessionStorage.getItem(storageKey);

                            sessionStorage.removeItem(storageKey);

                            if (sessionInterfaceEnvelope != undefined && Util.isString(sessionInterfaceEnvelope)) {
                                if (updateGlobalStorage) {
                                    TravelGo.Functions.InterfaceEnvelope.Set(JSON.parse(sessionInterfaceEnvelope), storageKey);
                                } else {
                                    TravelGo.Functions.InterfaceEnvelope.Initialize();

                                    Global.InterfaceEnvelope = JSON.parse(sessionInterfaceEnvelope);
                                }
                            }
                        } catch (error) {
                            TravelGo.Functions.InterfaceEnvelope.SetFromStorage(storageKey);
                        }
                    } else {
                        TravelGo.Functions.InterfaceEnvelope.SetFromStorage(storageKey);
                    }
                },
                IsValidForPreOrder: function() {
                    return Global != undefined
                        && Global.InterfaceEnvelope != undefined 
                        && ( Global.InterfaceEnvelope.SearchData != undefined 
                        || Global.InterfaceEnvelope.SearchParameters != undefined)
                        && (
                            (
                                (Global.InterfaceEnvelope.numberOfADTs > 0 || Global.InterfaceEnvelope.numberOfCHDs > 0)
                                && Global.InterfaceEnvelope.flightGroups != undefined
                            )
                            || Global.InterfaceEnvelope.busTickets != null
                            || Global.InterfaceEnvelope.hotel != null
                            || Global.InterfaceEnvelope.ServicesBookData != null
                            || Global.InterfaceEnvelope.services != null
                            || Global.InterfaceEnvelope.cruiseDatas != null
                        );
                }
            },
            ComponentEvents: {
                assignScrollToBottomEvent: function (holder, content, triggerFunction) {
                    $(holder).on("scroll", function () {
                        var scrollHeight = $(content).height();
                        var scrollPosition = $(holder).height() + $(holder).scrollTop();
                        if ((scrollHeight - scrollPosition) / scrollHeight === 0) {
                            triggerFunction(holder, content);
                        }
                    });
                }
            }
        };

        var clientCookie = Util.getCookie('tg_client') ? unescape(Util.getCookie('tg_client')) : null;

        var affiliateHash = document.location.search.substring(1).split('&').filter(function (el) {
            return el.toLowerCase().indexOf('affiliateHash'.toLowerCase()) > -1;
        });

        var hash = affiliateHash.length > 0 ? affiliateHash[0] : '';

        Global.Headers = {
            b2c_u: Util.getCookie("b2c_user") || $('#tg_u').val(),
            b2c_p: $('#tg_p').val(),
            st: clientCookie ? JSON.parse(clientCookie).st : '',
            affiliate_u: affiliateHash.length > 0 ? hash.substring(hash.indexOf('AffiliateHash=') + 14, hash.indexOf('xSEPx')) : Util.getCookie('AffiliateUser'),
            affiliate_p: affiliateHash.length > 0 ? hash.split('xSEPx')[1] : Util.getCookie('AffiliatePassword')
        };

        if (affiliateHash.length > 0) {
            Util.setCookie('AffiliateUser', Global.Headers.affiliate_u);
            Util.setCookie('AffiliatePassword', Global.Headers.affiliate_p);
        }

        var form = $('#continueForm');

        TravelGo.Functions.InterfaceEnvelope.Initialize();

        if (form.length) {
            try {
                var interfaceEnvelope = JSON.parse(decodeURIComponent(form.find('#InterfaceEnvelope').val()).replaceAll('%20', ' '));

                TravelGo.Functions.InterfaceEnvelope.Set(interfaceEnvelope, Global.Options.InterfaceEnvelopeStorageKey || "ienv_external_flow");
            } catch (ex) { }

            Global.Culture = form.find('#Culture').val() && form.find('#Culture').val().length ? form.find('#Culture').val() : Global.Culture;
            Global.SearchType = form.find('#SearchType').val();
            Global.ExchangeRate = form.find('#ExchangeRate').val();
            Global.selectedCurrency = form.find('#SelectedCurrency').val();
            Global.QueryString = form.find('#QueryString').val();
        }

        if (Global.Hooks && Global.Hooks.AuxiliaryLoaded)
            Global.Hooks.AuxiliaryLoaded.notify();
    });
})(jQuery);

ï»¿
var pageManager = function(pageManagerInstance) {
    var _this = this;
    var _events = {
        onPageManagerRenderCompleted: new Event(),
    };
    var _functions = {
        initialize: function (pageManagerInstance) {
            if (!$)
                $ = jQuery;
            $.extend(true, _this, pageManagerInstance || {});
        },
        events: {
            attach: {
                onRenderCompleted: function (callback) {
                    _events.onPageManagerRenderCompleted['dettach'](callback);
                    _events.onPageManagerRenderCompleted['attach'](callback);
                }
            },
            notify: {
                renderCompleted: function (origin, data) {
                    _events.onPageManagerRenderCompleted.notify(origin, data);
                },
            },
        }
    }

    _this.attachOnRenderCompleted = _functions.events.attach.onRenderCompleted;
    _this.onRenderCompleted = _functions.events.notify.renderCompleted;

    _functions.initialize(pageManagerInstance);
    
    return _this;
};

if (typeof (PageManager) === 'undefined') {
    PageManager = new pageManager({});
} else {
    PageManager = new pageManager(PageManager);
}

var ViewBase = (function () {
    function ViewBase(component, args) {
        var options = args && args.length > 0 ? args[0] : undefined;
        this._component = component;
        if (typeof options == 'string') {
            return ViewBase._execPluginMethod(this._component, this.getPluginName(), args);
        }
        else {
            var _this_1 = this;
            if (_this_1._component) {
                return _this_1._component.each(function () {
                    var token = Util.GetPluginDataToken(_this_1.getPluginName());
                    var ctrl = $(this);
                    var obj = ctrl.data(token);
                    obj && ctrl.removeData(token);
                    ctrl.data(token, _this_1);
                    _this_1._initialize(options);
                    var instanceNames = ctrl.data(Util.PluginNamesToken);
                    if (instanceNames)
                        instanceNames.push(_this_1.getPluginName());
                    else
                        instanceNames = [_this_1.getPluginName()];
                    ctrl.data(Util.PluginNamesToken, instanceNames);
                });
            }
        }
    }
    ViewBase.prototype._initialize = function (options) {
        this._settings = Object.assign(this.getDefaultSettings(), options);
        this._detachControllersEvents();
        this._attachControllersEvents();
        this._afterInitialize();
    };
    ViewBase.prototype._selectComponents = function (components, context, forceContext) {
        if (forceContext === undefined)
            forceContext = true;
        if (components) {
            Util.SelectComponents(components, context || this._component, forceContext);
        }
        else if (this._settings.components) {
            if (!this._settings.components.alreadySelected) {
                this._settings.components["originalComponents"] = Util.Clone(this._settings.components);
            }
            else if (this._settings.components["originalComponents"]) {
                this._settings.components = Util.Clone(this._settings.components["originalComponents"]);
                this._settings.components["originalComponents"] = Util.Clone(this._settings.components);
            }
            Util.SelectComponents(this._settings.components, context || this._component, forceContext);
            this._settings.components.alreadySelected = true;
        }
    };
    ViewBase.prototype.destroy = function () {
        this._component.removeData(this.getPluginName());
        this._detachControllersEvents();
        this._detachComponentsEvents();
        this._component.empty();
    };
    ViewBase.prototype._attachControllersEvents = function () {
        this._setControllerEvents(ControllerEventActionType.attach);
    };
    ViewBase.prototype._detachControllersEvents = function () {
        this._setControllerEvents(ControllerEventActionType.dettach);
    };
    ViewBase.prototype._attachComponentsEvents = function () {
        this._setComponentsEvents(ComponentEventActionType.on);
    };
    ViewBase.prototype._detachComponentsEvents = function () {
        this._setComponentsEvents(ComponentEventActionType.off);
    };
    ViewBase.prototype._afterInitialize = function () {
    };
    ViewBase.prototype._setControllerEvents = function (action) { };
    ViewBase.prototype._setComponentsEvents = function (action) { };
    ViewBase._execPluginMethod = function (plugins, pluginName, args) {
        var options = args[0];
        var args = Array.prototype.slice.call(args, 1);
        if (typeof options == 'string') {
            var obj = undefined;
            if (plugins && plugins.length) {
                var ret = [];
                for (var i = 0; i < plugins.length; i++) {
                    var token = Util.GetPluginDataToken(pluginName);
                    obj = $(plugins[i]).data(token);
                    if (obj) {
                        if (obj[options]) {
                            ret.push(obj[options].apply(obj, args));
                        }
                        else if (typeof console != 'undefined') {
                            console.log("Unable to find method " + options + " in element " + pluginName);
                        }
                    }
                    else if (typeof console != 'undefined') {
                        console.log("Unable to find instance of " + pluginName);
                    }
                }
                if (plugins.length > 1) {
                    var ids = $.map(plugins, function (item) { return $(item).attr("id"); });
                    ids = ids.where(function (h) { return h.length; });
                    if (ids.distinct().length != ids.length) {
                        console.log("HÃ¡ Ids iguais na execuÃ§Ã£o do mÃ©todo do plugin: " + ids.join(", "));
                    }
                }
                return ret.length > 1 ? ret : ret[0];
            }
        }
    };
    return ViewBase;
}());


var Dettachable = (function () {
    function Dettachable() {
    }
    Dettachable.prototype.dettach = function () {
        var resp = {};
        var keys = Object.keys(this);
        for (var key = 0; key < keys.length; key++) {
            resp[keys[key]] = this[keys[key]];
        }
        return resp;
    };
    return Dettachable;
}());


var BaseSettings = (function () {
    function BaseSettings() {
        this.data = {};
        this.templates = {};
        this.components = {};
        this.controllers = {};
        this.events = {};
    }
    BaseSettings.prototype.setData = function (obj) {
        $.extend(true, this.data, obj || {});
        return this;
    };
    BaseSettings.prototype.setTemplates = function (obj) {
        $.extend(true, this.templates, obj || {});
        return this;
    };
    BaseSettings.prototype.setComponents = function (obj) {
        $.extend(true, this.components, obj || {});
        return this;
    };
    BaseSettings.prototype.setControllers = function (obj) {
        $.extend(true, this.controllers, obj || {});
        return this;
    };
    BaseSettings.prototype.setEvents = function (obj) {
        $.extend(true, this.events, obj || {});
        return this;
    };
    return BaseSettings;
}());


function registerView() {
    return function (target, propertyKey, descriptor) {
        window["typescriptPlugins"] = window["typescriptPlugins"] || {};
        var pluginName = new target().getPluginName();
        $.fn[pluginName] = new Function("return new window['typescriptPlugins']['{0}'](this, arguments);".format([pluginName]));
    };
}


var ComponentEventActionType;
(function (ComponentEventActionType) {
    ComponentEventActionType["die"] = "die";
    ComponentEventActionType["live"] = "live";
    ComponentEventActionType["on"] = "on";
    ComponentEventActionType["off"] = "off";
})(ComponentEventActionType || (ComponentEventActionType = {}));


var ControllerEventActionType;
(function (ControllerEventActionType) {
    ControllerEventActionType["attach"] = "attach";
    ControllerEventActionType["dettach"] = "dettach";
})(ControllerEventActionType || (ControllerEventActionType = {}));


ï»¿// *** Service Calling Proxy Class
if (typeof Global == 'undefined')
    Global = {};

function _getBlockInvokeMessage() {
    var defaultMessage = message = "Uma requisiÃ§Ã£o jÃ¡ estÃ¡ sendo processada, por favor aguarde o tÃ©rmino desta solicitaÃ§Ã£o e tente novamente.";

    if (Util && Util.GetInterfaceMessage) {
        message = Util.GetInterfaceMessage("OnInvoke_BlockProcess");

        if (!message || message == "")
            message = defaultMessage;
    }

    return message;
}

function ServiceCaller(serviceUrl) {

    var _I = this;
    var TimeOut = 600000;
    this.BlockInvoke = false;

    this.serviceUrl = serviceUrl;

    // *** Call a wrapped object
    this.invoke = function (method, data, callback, error, waiting, InvokeTimeOutParameter, blockProcess) {

        function _trySetPointOfEntrance() {
            try {
                if (typeof data === "object" && typeof data["req"] === "object") {
                    if (!data["req"]["PointOfEntrance"] || data["req"]["PointOfEntrance"].length == 0)
                        data["req"]["PointOfEntrance"] = method;
                }
            }
            catch (e) { }
        }

        function _considerSendGtagErrorEvent(result) {
            if (!Util.isTravelGo() && Ide && result.Errors && result.Errors.length) {
                for (var i = 0; i < result.Errors.length; i++) {
                    var error = result.Errors[i];
                    var errorMessage = error.FriendlyMessage || error.ErrorMessage;
                    var sourceLabelFragment = error.Source ? error.Source + ' - ' : '';
                    var action = sourceLabelFragment + errorMessage;

                    Util.SendGtagEvent(action, 'Erro', Util.GetRootSystemAccountInfo());
                }
            }
        }

        if (_I.BlockInvoke) {
            alert(_getBlockInvokeMessage());
            return;
        }
        //Verifica se existe beforeInvoke e se retorna que pode continuar.
        if (typeof (_I.BeforeInvoke) && typeof (_I.BeforeInvoke) == 'function' && !_I.BeforeInvoke.apply(_I, arguments))
            return;
        _I.BlockInvoke = blockProcess;

        //Define o ponto de entrada
        _trySetPointOfEntrance();

        // *** Convert input data into JSON - REQUIRES Json2.js
        var json = JSON2.stringifyWcf(data);


        var _ajaxSucessFull = function (res) {
            _I.BlockInvoke = false;

            if (waiting)
                waiting.hide();

            if (!res || !res.length || !callback) return;

            setTimeout(function () {
                var result = $.parseJSON(res);

                if (typeof result == "string") {
                    result = $.parseJSON(result);
                    result = Util.MinimumJSONDeserialize(result);
                }

                if (Global.storeServiceCallerCalls) {
                    if (!Global.serviceCallerCalls)
                        Global.serviceCallerCalls = [];

                    Global.serviceCallerCalls.push({
                        method: method,
                        request: data,
                        response: result
                    });
                }

                _considerSendGtagErrorEvent(result);

                callback(result);
            }, 0);

            return;
        }

        // *** The service endpoint URL        
        var url = _I.serviceUrl + method;

        if (InvokeTimeOutParameter)
            TimeOut = InvokeTimeOutParameter;

        if (waiting)
            waiting.show();

        var crossDomain = typeof (undefined) != "undefined" && Global.Crossdomain;
        var functionName = "";

        if (crossDomain) {
            url = url + "2?jsonObject=" + json;
            functionName = ((new Date()).toString() + Math.random(100)).replaceAll(" ", "_");
        }

        if (crossDomain && window.XDomainRequest) {
            _I.BlockInvoke = false;
            request = new window.XDomainRequest();
            window[functionName] = function () { _ajaxSucessFull(request.responseText); return window[functionName] = undefined; };
            request.onload = window[functionName];
            request.open("GET", url, true);
            return request.send();
        }
        else if (crossDomain) {
            _I.BlockInvoke = false;
            window[functionName] = function (jsonToParse) { _ajaxSucessFull(jsonToParse); return window[functionName] = undefined; };
            return $.getJSON(url, null, window[functionName]);
        }
        else {
            return $.ajax({
                url: url,
                data: json,
                type: "POST",
                processData: false,
                contentType: "application/json",
                timeout: TimeOut,
                dataType: "text",  // not "json" we'll parse
                success: _ajaxSucessFull,
                headers: Global.Headers ? Global.Headers : {},
                error:
                    function (xhr, textStatus) {
                        _I.BlockInvoke = false;
                        try {
                            var message = undefined;

                            if (textStatus != 'abort') {
                                if (Global.LoaderController)
                                    Global.LoaderController.hideLoader();

                                if (waiting)
                                    waiting.hide();

                                if (textStatus == "timeout")
                                    message = "Tempo limite se esgotou para a operaÃ§Ã£o.";
                                else if (xhr.responseText && xhr.responseText.length) {

                                    var ret = {
                                        IsJSON: false,
                                        JSONResponse: null,
                                        HtmlResponse: null
                                    }

                                    var err;

                                    try {
                                        err = JSON2.parse(xhr.responseText);
                                        ret.IsJSON = true;
                                        ret.JSONResponse = err;
                                    } catch (e) {
                                        err = xhr.responseText;
                                        ret.IsJSON = false;
                                        ret.HtmlResponse = err;
                                    }

                                    message = ret;
                                }
                                else
                                    message = "Problemas de processamento";

                                if (error) {
                                    if (typeof message == 'string')
                                        error(message);
                                    else
                                        error(message, callback);
                                } else if (Global.MessagesController && typeof message == 'string')
                                    Global.MessagesController.notifyMessages([message], EnumHelper.MessagesExhibitor.ExhibitionType.Alert);
                            }

                            return;
                        }
                        catch (ex) {
                            if (Global.LoaderController)
                                Global.LoaderController.hideLoader();

                            if (error)
                                error(null);
                        }
                    }
            });
        }

        // extented functionalities
        if (typeof (_I.AfterInvoke) && typeof (_I.AfterInvoke) == 'function')
            _I.AfterInvoke.apply(_I, arguments);

    }

    this.invokeGet = function (method, data, callback, error, waiting, InvokeTimeOutParameter, executeCallbackEvenEmpty) {

        var _ajaxSucessFull = function (res) {
            if (waiting)
                waiting.hide();

            if (!executeCallbackEvenEmpty || !callback) {
                if (!res || !res.length || !callback)
                    return;
            }

            setTimeout(function () {
                var result = res;

                if (typeof result == "string") {
                    result = $.parseJSON(result);
                    result = Util.MinimumJSONDeserialize(result);
                }

                result.reqData = data;

                if (Global.storeServiceCallerCalls) {
                    if (!Global.serviceCallerCalls)
                        Global.serviceCallerCalls = [];

                    Global.serviceCallerCalls.push({
                        method: method,
                        request: data,
                        response: result
                    });
                }

                callback(result);
            }, 0);

            return;
        }

        // *** The service endpoint URL        
        var url = _I.serviceUrl + method + '?' + data;

        if (waiting)
            waiting.show();


        return $.ajax({
            url: url,
            type: "GET",
            processData: false,
            contentType: "application/json",
            timeout: TimeOut,
            success: _ajaxSucessFull,
            headers: Global.Headers ? Global.Headers : {},
            error:
                function (xhr, textStatus) {
                    _I.BlockInvoke = false;
                    try {
                        var message = undefined;

                        if (textStatus != 'abort') {
                            if (Global.LoaderController)
                                Global.LoaderController.hideLoader();

                            if (waiting)
                                waiting.hide();

                            if (textStatus == "timeout")
                                message = "Tempo limite se esgotou para a operaÃ§Ã£o.";
                            else if (xhr.responseText && xhr.responseText.length) {

                                var ret = {
                                    IsJSON: false,
                                    JSONResponse: null,
                                    HtmlResponse: null
                                }

                                var err;

                                try {
                                    err = JSON2.parse(xhr.responseText);
                                    ret.IsJSON = true;
                                    ret.JSONResponse = err;
                                } catch (e) {
                                    err = xhr.responseText;
                                    ret.IsJSON = false;
                                    ret.HtmlResponse = err;
                                }

                                message = ret;
                            }
                            else
                                message = "Problemas de processamento";

                            if (error) {
                                if (typeof message == 'string')
                                    error(message);
                                else
                                    error(message, callback);
                            } else if (Global.MessagesController && typeof message == 'string')
                                Global.MessagesController.notifyMessages([message], EnumHelper.MessagesExhibitor.ExhibitionType.Alert);
                        }

                        return;
                    }
                    catch (ex) {
                        if (Global.LoaderController)
                            Global.LoaderController.hideLoader();

                        if (error)
                            error(null);
                    }
                }
        });
    }
}


ï»¿if (typeof EnumHelper == 'undefined') { var EnumHelper = {}; }
if (typeof EnumHelper.AirSearch == 'undefined') { EnumHelper.AirSearch = {}; }
if (typeof EnumHelper.BusSearch == 'undefined') { EnumHelper.BusSearch = {}; }
if (typeof EnumHelper.Book == 'undefined') { EnumHelper.Book = {}; }
if (typeof EnumHelper.Passenger == 'undefined') { EnumHelper.Passenger = {}; }
if (typeof EnumHelper.Connection == 'undefined') { EnumHelper.Connection = {}; }
if (typeof EnumHelper.Ticket == 'undefined') { EnumHelper.Ticket = {}; }
if (typeof EnumHelper.PageManager == 'undefined') { EnumHelper.PageManager = {}; }
if (typeof EnumHelper.Template == 'undefined') { EnumHelper.Template = {}; }
if (typeof EnumHelper.ServiceItem == 'undefined') { EnumHelper.ServiceItem = {}; }
if (typeof EnumHelper.ServiceDefinition == 'undefined') { EnumHelper.ServiceDefinition = {}; }
if (typeof EnumHelper.ActionRequired == 'undefined') { EnumHelper.ActionRequired = {}; }
if (typeof EnumHelper.ResultType == 'undefined') { EnumHelper.ResultType = {}; }
if (typeof EnumHelper.Foid == 'undefined') { EnumHelper.Foid = {}; }
if (typeof EnumHelper.SearchType == 'undefined') { EnumHelper.SearchType = {}; }
if (typeof EnumHelper.TimeLineType == 'undefined') { EnumHelper.TimeLineType = {}; }
if (typeof EnumHelper.Pricing == 'undefined') { EnumHelper.Pricing = {}; }
if (typeof EnumHelper.MessagesExhibitor == 'undefined') { EnumHelper.MessagesExhibitor = {}; }
if (typeof EnumHelper.ProcessFileStatus == 'undefined') { EnumHelper.ProcessFileStatus = {}; }
if (typeof EnumHelper.CRUD == 'undefined') { EnumHelper.CRUD = {}; }
if (typeof EnumHelper.Phone == 'undefined') { EnumHelper.Phone = {}; }
if (typeof EnumHelper.GuaranteeType == 'undefined') { EnumHelper.GuaranteeType = {}; }
if (typeof EnumHelper.GMap == 'undefined') { EnumHelper.GMap = {}; }
if (typeof EnumHelper.Filter == 'undefined') { EnumHelper.Filter = {}; }
if (typeof EnumHelper.PassengerTitle == 'undefined') { EnumHelper.PassengerTitle = {}; }
if (typeof EnumHelper.ServiceType == 'undefined') { EnumHelper.ServiceType = {}; }
if (typeof EnumHelper.FieldType == 'undefined') { EnumHelper.FieldType = {}; }
if (typeof EnumHelper.StatusExportation == 'undefined') { EnumHelper.StatusExportation = {}; }
if (typeof EnumHelper.ExportationFlow == 'undefined') { EnumHelper.ExportationFlow = {}; }
if (typeof EnumHelper.PnrStatus == 'undefined') { EnumHelper.PnrStatus = {}; }
if (typeof EnumHelper.CarCategory == 'undefined') { EnumHelper.CarCategory = {}; }
if (typeof EnumHelper.ContentLoadType == 'undefined') { EnumHelper.ContentLoadType = {}; }
if (typeof EnumHelper.CarTransmission == 'undefined') { EnumHelper.CarTransmission = {}; }
if (typeof EnumHelper.ServiceFareType == 'undefined') { EnumHelper.ServiceFareType = {}; }
if (typeof EnumHelper.ServiceSaleType == 'undefined') { EnumHelper.ServiceSaleType = {}; }
if (typeof EnumHelper.TemplateMode == 'undefined') { EnumHelper.TemplateMode = {}; }
if (typeof EnumHelper.SearchStatus == 'undefined') { EnumHelper.SearchStatus = {}; }
if (typeof EnumHelper.ManagementFields == 'undefined') { EnumHelper.ManagementFields = {}; }
if (typeof EnumHelper.ExternalFieldType == 'undefined') { EnumHelper.ExternalFieldType = {}; }
if (typeof EnumHelper.MappedTypeExternalFieldType == 'undefined') { EnumHelper.MappedTypeExternalFieldType = {}; }
if (typeof EnumHelper.ContactDataTo == 'undefined') { EnumHelper.ContactDataTo = {}; }
if (typeof EnumHelper.Wizard == 'undefined') { EnumHelper.Wizard = {}; }
if (typeof EnumHelper.BatchAction == 'undefined') { EnumHelper.BatchAction = {}; }
if (typeof EnumHelper.BatchRecordContentStatusMessage == 'undefined') { EnumHelper.BatchRecordContentStatusMessage = {}; }
if (typeof EnumHelper.InterfaceBuilder == 'undefined') { EnumHelper.InterfaceBuilder = {}; }
if (typeof EnumHelper.InterfaceBuilder.TextBoxEditorType == 'undefined') { EnumHelper.InterfaceBuilder.TextBoxEditorType = {}; }
if (typeof EnumHelper.MaskTypeExternalField == 'undefined') { EnumHelper.MaskTypeExternalField = {}; }
if (typeof EnumHelper.BookingType == 'undefined') { EnumHelper.BookingType = {}; }
if (typeof EnumHelper.Service == 'undefined') { EnumHelper.Service = {}; }
if (typeof EnumHelper.StatusFlowItemType == 'undefined') { EnumHelper.StatusFlowItemType = {}; }
if (typeof EnumHelper.WaitType == 'undefined') { EnumHelper.WaitType = {}; }
if (typeof EnumHelper.ConditionType == 'undefined') { EnumHelper.ConditionType = {}; }
if (typeof EnumHelper.PaymentTypeActions == 'undefined') { EnumHelper.PaymentTypeActions = {}; }
if (typeof EnumHelper.CruisePnrLiveEditActions == 'undefined') { EnumHelper.CruisePnrLiveEditActions = {}; }
if (typeof EnumHelper.OfflineItemActions == 'undefined') { EnumHelper.OfflineItemActions = {}; }
if (typeof EnumHelper.DiscountType == 'undefined') { EnumHelper.DiscountType = {}; }
if (typeof EnumHelper.DataSourceType == 'undefined') { EnumHelper.DataSourceType = {}; }
if (typeof EnumHelper.ActionMode == 'undefined') { EnumHelper.ActionMode = {}; }
if (typeof EnumHelper.PACLineModifyCommandType == 'undefined') { EnumHelper.PACLineModifyCommandType = {}; }
if (typeof EnumHelper.TrayItemType == 'undefined') { EnumHelper.TrayItemType = {}; }
if (typeof EnumHelper.ProposalType == 'undefined') { EnumHelper.ProposalType = {}; }
if (typeof EnumHelper.Services == 'undefined' || EnumHelper.Services.ServiceType == 'undefined') { EnumHelper.Services = {}; EnumHelper.Services.ServiceType = {}; }
if (typeof EnumHelper.Itinerary == 'undefined' || EnumHelper.Itinerary.ProductType == 'undefined') { EnumHelper.Itinerary = {}; EnumHelper.Itinerary.ProductType = {}; }
if (typeof EnumHelper.ProductTypeName === 'undefined') { EnumHelper.ProductTypeName = {}; }
if (typeof EnumHelper.DataGridColumnVisibility === 'undefined') { EnumHelper.DataGridColumnVisibility = {}; }
if (typeof EnumHelper.DiscountCouponStatus === 'undefined') { EnumHelper.DiscountCouponStatus = {}; }
if (typeof EnumHelper.ToolBarExtensionOpenMode === 'undefined') { EnumHelper.ToolBarExtensionOpenMode = {}; }
if (typeof EnumHelper.PaymentFormAdditionalFields === 'undefined') { EnumHelper.PaymentFormAdditionalFields = {}; }
if (typeof EnumHelper.PaymentFormAdditionalFieldsSettings === 'undefined') { EnumHelper.PaymentFormAdditionalFieldsSettings = {}; }
if (typeof EnumHelper.Fee === 'undefined') { EnumHelper.Fee = {}; }
if (typeof EnumHelper.MandatoryUserLogin === 'undefined') { EnumHelper.MandatoryUserLogin = {}; }
if (typeof EnumHelper.SaleItemType === 'undefined') { EnumHelper.SaleItemType = {}; }
if (typeof EnumHelper.SortBy === 'undefined') { EnumHelper.SortBy = { Hotel: {} }; }
if (typeof EnumHelper.DefinitionCategory === 'undefined') { EnumHelper.DefinitionCategory = {}; }
if (typeof EnumHelper.UserResolution === 'undefined') { EnumHelper.UserResolution = {}; }
if (typeof EnumHelper.Warning === 'undefined') { EnumHelper.Warning = {}; }

EnumHelper.SearchName = EnumHelper.SearchName || {}

EnumHelper.InputType = EnumHelper.InputType || {
    Text: 0,
    TextArea: 1,
    Select: 2,
    SelectOption: 3,
    Radio: 4,
    Hidden: 5
};


EnumHelper.ValueType = EnumHelper.ValueType || {
    String: 0,
    Number: 1,
    DateTime: 2,
    Currency: 3,
    Boolean: 4,
    Complex: 5
    //baseado no EntityFieldType do IB, utilizado no SettingsEditor
};

EnumHelper.GuaranteeType = {
    CreditCard: 0,
    Deposit: 1,
    ImmediateDeposit: 2,
    UntilXPM: 3,
    AgencyIata: 4,
    AgencyName: 5,
    DirectBill: 6,
    DailyBilled: 7,
    DailyBilledExtras: 8,
    0: 'CreditCard',
    1: 'Deposit',
    2: 'ImmediateDeposit',
    3: 'UntilXPM',
    4: 'AgencyIata',
    5: 'AgencyName',
    6: 'DirectBill',
    7: 'DailyBilled',
    8: 'DailyBilledExtras'
};

EnumHelper.PhoneTypeOP = {
    Business: "Business",
    Home: "Home",
    Mobile: "Mobile",
    Agency: "Agency"
};

EnumHelper.UserPhoneType = {
    Fixed: 0,
    Cellular: 1,
    Undefined: 2,
    Home: 3,
    Business: 4,
    ForMessages: 5,
    Billing: 6,
    Temporary: 7,
    Mobile: 8,
    0: "Fixed",
    1: "Cellular",
    2: "Undefined",
    3: "Home",
    4: "Business",
    5: "ForMessages",
    6: "Billing",
    7: "Temporary",
    8: "Mobile"
};

EnumHelper.ExchangeRateSource = {
    IATA: 0,
    Registered: 1,
    0: "IATA",
    1: "Registered"
}

EnumHelper.ContactPhoneType = {
    Business: 0,
    Home: 1,
    Mobile: 2,
    Agency: 3,
    0: "Business",
    1: "Home",
    2: "Mobile",
    3: "Agency"
};

EnumHelper.FeeGroupType = {
    Consolidator: 0,
    Agency: 1,
    0: "Consolidator",
    1: "Agency"
};

EnumHelper.CompanyType = {
    Agency: 0,
    Corporate: 1,
    Consolidator: 2,
    Operator: 3,
    Any: "",
    0: "Agency",
    1: "Corporate",
    2: "Consolidator",
    3: "Operator",
    "": "Any"
};

EnumHelper.AirSearch.TypeTrip = {
    OneWay: 1,
    RoundTrip: 2,
    MultiDestination: 3,
    1: "OneWay",
    2: "RoundTrip",
    3: 'MultiDestination'
};

EnumHelper.BusSearch.TypeTrip = {
    OneWay: 1,
    RoundTrip: 2,
    MultiDestination: 3,
    1: "OneWay",
    2: "RoundTrip",
    3: 'MultiDestination'
};

EnumHelper.TranslateTripType = function (param, opt_sb) {
    var output = opt_sb || "";
    if (param.tripType) {
        output.append(Resources.translate({ code: "stretch" + EnumHelper.AirSearch.TypeTrip[param.tripType] }));
    }
}

EnumHelper.GetAirSearchTripType = function (param, opt_sb) {
    var output = opt_sb || "";
    if (param.tripType) {
        output.append(EnumHelper.AirSearch.TypeTrip[param.tripType]);
    }
}


EnumHelper.SearchMethodType = {
    SearchPricedFlights: 0,
    SearchJourney: 1,
    SearchBySchedule: 2,
    SearchByRecommendation: 3,
    0: 'SearchPricedFlights',
    1: 'SearchJourney',
    2: 'SearchBySchedule',
    3: 'SearchByRecommendation'
};

EnumHelper.Book.Action = {
    BookPNR: 0,
    CancelPNR: 1,
    Retrieve: 2,
    Render: 3,
    0: "BookPNR",
    1: "CancelPNR",
    2: "Retrieve",
    3: 'Render'
};

EnumHelper.Connection.Mode = {
    None: 0,
    AddElements: 1,
    Close: 2,
    CloseAndRetrieve: 3,
    Ignore: 4,
    IgnoreAndRetrieve: 5,
    0: "None",
    1: "AddElements",
    2: "Close",
    3: "CloseAndRetrieve",
    4: "IgnoreAndRetrieve",
    5: "Ignore"
};

EnumHelper.Book.LoadTicketType = {
    AddElements: 0,
    Close: 1,
    LoadAndInferTickets: 2,
    0: "NoTickets",
    1: "LoadTickets",
    2: "LoadAndInferTickets"
};

EnumHelper.Gender = {
    Male: 0,
    Female: 1,
    0: "Male",
    1: "Female"
};

EnumHelper.BaggageAllowance = {
    Indifferent: 0,
    WithBaggage: 1,
    WithoutBaggage: 2,
    0: 'Indifferent',
    1: 'WithBaggage',
    2: 'WithoutBaggage'
};

EnumHelper.CabinType = {
    FirstClass: 0,
    Executive: 1,
    Economic: 2,
    PremiumEconomy: 3,
    0: 'FirstClass',
    1: 'Executive',
    2: 'Economic',
    3: 'PremiumEconomy'
};

EnumHelper.CruiseItineraryActivity = {
    Embark: 0,
    Docked: 1,
    Tendered: 2,
    Cruising: 3,
    Debark: 4,
    0: 'Embark',
    1: 'Docked',
    2: 'Tendered',
    3: 'Cruising',
    4: 'Debark'
};

EnumHelper.CruiseDiningTableSizes = {
    Small: 0,
    Large: 1,
    0: 'Small',
    1: 'Large'
}

EnumHelper.CruiseDiningSittingType = {
    Traditional: 0,
    Open: 1,
    Undecided: 2,
    0: 'Traditional',
    1: 'Open',
    2: 'Undecided'
}

EnumHelper.CruiseRoomConfiguration = {
    ApartBoth: 0,
    BothTogether: 1,
    Unknown: 2,
    0: 'ApartBoth',
    1: 'BothTogether',
    2: 'Unknown'
}

EnumHelper.CruiseReservationStatusCode = {
    OF: 42,
    BK: 49,
    CX: 16,
    WL: 46,
    Offer: 'OF',
    Booked: 'BK',
    Cancelled: 'CX',
    Waitlist: 'WL',
    0: 'OF',
    1: 'BK',
    2: 'CX',
    3: 'WL',
    42: 'OF',
    49: 'BK',
    16: 'CX',
    46: 'WL'
}

EnumHelper.MeasureTypes = {
    0: 'Feet',
    1: 'Knots',
    2: 'SquareFeet',
    3: 'Inches',
    4: 'Unit',
    5: 'Tons',
    6: 'Meters',
    7: 'KilometersPerHour',
    Feet: 0,
    Knots: 1,
    SquareFeet: 2,
    Inches: 3,
    Unit: 4,
    Tons: 5,
    Meters: 6,
    KilometersPerHour: 7
}

EnumHelper.UserType =
{
    Agency: 0,
    Corporate: 1,
    B2C: 2,
    Any: '',
    0: 'Agency',
    1: 'Corporate',
    2: 'B2C'
};

EnumHelper.ContactInformation = {
    BusinessPhone: 3,
    HomePhoneNumber: 4,
    MobilePhone: 5,
    TravelAgentPhoneNumber: 6,
    EmailAddress: 2, //P02 no amadeus
    ContactName: 7,
    NameAgency: 8,
    AddressName: 9,
    BillingAddress: 10,
    City: 11,
    State: 12,
    Zip: 13,
    Country: 14,
    3: "BusinessPhone",
    4: "HomePhoneNumber",
    5: "MobilePhone",
    6: "TravelAgentPhoneNumber",
    2: "EmailAddress", //P02 no amadeus
    7: "ContactName",
    8: "NameAgency",
    9: "AddressName",
    10: "BillingAddress",
    11: "City",
    12: "State",
    13: "Zip",
    14: "Country"
};

EnumHelper.ActionType = {
    ToInsert: 0,
    ToUpdate: 1,
    ToDelete: 2,
    Unknown: 3,
    0: "ToInsert",
    1: "ToUpdate",
    2: "ToDelete",
    3: "Unknown"
};

EnumHelper.Passenger.PassengerType = {
    Adult: 0,
    Child: 1,
    Baby: 2,
    Senior: 3,
    "0": "Adult",
    "1": "Child",
    "2": "Baby",
    "3": "Senior"
};

EnumHelper.Passenger.PassengerTypeTranslate = {
    Adulto: 0,
    CrianÃ§a: 1,
    BebÃª: 2,
    SÃªnior: 3,
    "0": "Adulto",
    "1": "CrianÃ§a",
    "2": "BebÃª",
    "3": "SÃªnior"
};

EnumHelper.Passenger.PassengerTypeShort = {
    ADT: 0,
    CHD: 1,
    INF: 2,
    SRC: 3,
    "0": "ADT",
    "1": "CHD",
    "2": "INF",
    "3": "SRC"
};

EnumHelper.Ticket.TicketStatus = {
    NotIssued: 0,
    Issued: 1,
    Pending: 2,
    WaitingForNumber: 3,
    Cancelled: 4,
    Replaced: 5,
    Refunded: 6,
    Flown: 7,
    0: "NotIssued",
    1: "Issued",
    2: "Pending",
    3: "WaitingForNumber",
    4: "Cancelled",
    5: "Replaced",
    6: "Refunded",
    7: "Flown"
};

EnumHelper.PageManager.Type = {
    Book: 0,
    Dashboard: 1,
    Query: 2,
    Search: 3,
    Workflow: 4,
    Admin: 5,
    ExternalPnr: 6,
    Proposal: 7,
    CruiseDetails: 8,
    0: "Book",
    1: "Dashboard",
    2: "Query",
    3: "Search",
    4: "Workflow",
    5: "Admin",
    6: "ExternalPnr",
    7: "Proposal",
    8: "CruiseDetails"
};

EnumHelper.Template.Budget = {
    PesquisaHorario: "PesquisaHorario",
    PesquisaPrecoHorario: "PesquisaPrecoHorario",
    PesquisaPreco: "PesquisaPreco",
    PesquisaHotel: "PesquisaHotel"
};

EnumHelper.Template.MediaType = {
    Html: 0,
    Text: 1,
    0: "Html",
    1: "Text"
};

EnumHelper.ServiceItem.RoleType = {
    ServiceOrder: 0,
    ServiceItem: 1,
    0: "ServiceOrder",
    1: "ServiceItem",
};

EnumHelper.ApprovalFlow = {
    Type: {
        Sequential: '0',
        Parallel: '1',
        Unique: '2',
        SequentialUnique: '3',
        0: 'Sequential',
        1: 'Parallel',
        2: 'Unique',
        3: 'SequentialUnique'
    }
};

EnumHelper.ActionRequired.Type = {
    SelectApprover: '0',
    Justify: '1',
    0: 'SelectApprover',
    1: 'Justify'
};

//Enum carregado com as informaÃ§Ãµes do banco.
EnumHelper.ServiceDefinition.Identifier = undefined;

EnumHelper.ActionRequired.Type = {
    SelectApprover: '0',
    Policy: '1',
    ChangeStatus: '2',
    ActionTips: '3',
    0: 'SelectApprover',
    1: 'Policy',
    2: 'ChangeStatus',
    3: 'ActionTips'
};

EnumHelper.Foid.Type = {
    CC: '0',
    FF: '1',
    PP: '2',
    DL: '3',
    TN: '4',
    ID: '5',
    CN: '6',
    0: 'CC',
    1: 'FF',
    2: 'PP',
    3: 'DL',
    4: 'TN',
    5: 'ID',
    6: 'CN'
};

EnumHelper.ResultType.Type = {
    Justify: '0',
    Notifies: '1',
    NoAction: '2',
    Block: '3',
    0: 'Justify',
    1: 'Notifies',
    2: 'NoAction',
    3: 'Block'
};

EnumHelper.CreditCardType = {
    'None': '0',
    'EBTA': '1',
    'CTA': '2',
    'VIRCC': '3',
    'CFC': '4',
    '0': 'None',
    '1': 'EBTA',
    '2': 'CTA',
    '3': 'VIRCC',
    '4': 'CFC'
};

EnumHelper.CreditCardProvider = {
    "VI": 0,
    "MC": 1,
    "AX": 2,
    "DC": 3,
    "DI": 3,
    "AURA": 4,
    "HP": 5,
    "HI": 6,
    "EL": 7,
    "TP": 8,
    "GE": 9,
    "0": "VI",
    "1": "MC",
    "2": "AX",
    "3": "DI",
    "4": "AURA",
    "5": "HP",
    "6": "HI",
    "7": "EL",
    "8": "TP",
    "9": "GE"
};

EnumHelper.CreditCardCodeName = {
    "VI": "Visa",
    "MC": "MasterCard",
    "AX": "American Express",
    "DI": "Diners",
    "DC": "Diners",
    "AURA": "Aura",
    "HP": "HyperCard",
    "HI": "HiperCard",
    "GE": "HiperCard",
    "EL": "Elo",
    "TP": "UATP",
    "GE": "GE"
};

EnumHelper.ProductType = {
    "Air": 0,
    "Hotel": 1,
    "AirHotel": 2,
    "Car": 3,
    "Service": 4,
    "Advance": 5,
    "Cruise": 6,
    "Insurance": 7,
    "PackageCustom": 8,
    0: "Air",
    1: "Hotel",
    2: "AirHotel",
    3: "Car",
    4: "Service",
    5: "Advance",
    6: "Cruise",
    7: "Insurance",
    8: "PackageCustom"
};

EnumHelper.ProductTypeName = {
    Air: "Air",
    Hotel: "Hotel",
    Car: "Car",
    Service: "Service",
    DynamicPackage: "DynamicPackage",
    HybridPackage: "HybridPackage",
    Tour: "Tour",
    Cruise: "Cruise",
    Insurance: "Insurance",
    PackageCustom: "PackageCustom",
    Itinerary: "Itinerary",
    Bus: "Bus",
};

EnumHelper.FrameworkProductType = {
    "Any": 0,
    "Air": 1,
    "Hotel": 2,
    "AirHotel": 3,
    "Car": 4,
    "Services": 5,
    "Insurance": 6,
    "Cruise": 8,
    "Itinerary": 9,
    0: "Any",
    1: "Air",
    2: "Hotel",
    3: "AirHotel",
    4: "Car",
    5: "Services",
    6: "Insurance",
    8: "Cruise",
    9: "Itinerary"
};

EnumHelper.SearchType = {
    Air: 'Air',
    Hotel: 'Hotel',
    Car: 'Car',
    Package: 'Package',
    Service: 'Service',
    Tour: 'Tour',
    DynamicPackage: 'DynamicPackage',
    Traces: 'Traces',
    Logs: 'Logs',
    Itinerary: 'Itinerary',
};

EnumHelper.TimeLineType = {
    "ChageFieldValue": 0,
    "SendEmail": 1,
    "Messages": 2,
    "ApprovalFlow": 3,
    "SubChangeFieldValue": 4,
    0: "ChageFieldValue",
    1: "SendEmail",
    2: "Messages",
    3: "ApprovalFlow",
    4: "SubChangeFieldValue"
};

EnumHelper.Pricing.Status = {
    "NotCharged": 0,
    "Charged": 1,
    "Exempted": 2,
    "ChargedBack": 3,
    0: "NotCharged",
    1: "Charged",
    2: "Exempted",
    3: "ChargedBack"
};

EnumHelper.StatusPriority = {
    'Low': 0,
    'Medium': 1,
    'High': 2,
    0: 'Low',
    1: 'Medium',
    2: 'High'
};

EnumHelper.MessagesExhibitor.ExhibitionType = {
    Dialog: 0,
    Slider: 1,
    Alert: 2,
    Inline: 3,
    Fixed: 4,
    0: "Dialog",
    1: "Slider",
    2: "Alert",
    3: "Inline",
    4: "Fixed"
};

EnumHelper.MessagesExhibitor.Type = {
    Message: 0,
    Error: 1,
    Warning: 2,
    Success: 3,
    Info: 4,
    Question: 5,
    0: "Message",
    1: "Error",
    2: "Warning",
    3: "Success",
    4: "Info",
    5: "Question"
};

EnumHelper.CRUD.Type = {
    Create: 0,
    Retrieve: 1,
    Update: 2,
    Delete: 3,
    0: "Create",
    1: "Retrieve",
    2: "Update",
    3: "Delete"
};

EnumHelper.PaymentType = {
    'CreditCard': 0,
    'Invoice': 1,
    'CreditCardInvoice': 2,
    'GovernmentAgency': 3,
    'Points': 5,
    'Replacement': 6,
    'CreditCardRegistered': 7,
    'Cash': 8,
    'Billet': 9,
    'Check': 10,
    'Stelo': 11,
    'DirectPayment': 12,
    'BankTransfer': 13,
    'PointOfSale': 14,
    'Financial': 15,
    'DiscountCoupon': 16,
    'MercantilBank': 17,
    'Credit': 18,
    'PayAndGo': 19,
    'DebitNote': 20,
    'GuaranteeReservation': 21,
    'ValueTransfer': 22,
    'Exchange': 23,
    'RetainedCommission': 24,
    'FranchiseDiscount': 25,
    'PayPal': 26,
    'PaymentLink': 27,
    'LetterOfCredit': 28,
    '0': 'CreditCard',
    '1': 'Invoice',
    '2': 'CreditCardInvoice',
    '3': 'GovernmentAgency',
    '5': 'Points',
    '6': 'Replacement',
    '7': 'CreditCardRegistered',
    '8': 'Cash',
    '9': 'Billet',
    '10': 'Check',
    '11': 'Stelo',
    '12': 'DirectPayment',
    '13': 'BankTransfer',
    '14': 'PointOfSale',
    '15': 'Financial',
    '16': 'DiscountCoupon',
    '17': 'MercantilBank',
    '18': 'Credit',
    '19': 'PayAndGo',
    '20': 'DebitNote',
    '21': 'GuaranteeReservation',
    '22': 'ValueTransfer',
    '23': 'Exchange',
    '24': 'RetainedCommission',
    '25': 'FranchiseDiscount',
    '26': 'PayPal',
    '27': 'PaymentLink',
    '28': 'LetterOfCredit'
};

EnumHelper.ProcessFileStatus = {
    Processing: 0,
    Completed: 1,
    CompletedWithError: 2,
    Canceled: 3,
    0: "Processing",
    1: "Completed",
    2: "CompletedWithError",
    3: "Canceled"
};

EnumHelper.Phone.Type = {
    'Fixed': 0,
    'Cellular': 1,
    0: 'Fixed',
    1: 'Cellular'
};

EnumHelper.Filter.Type = {
    Recommendation: 0,
    CityPair: 1,
    PriceGroup: 2,
    Hotel: 3,
    Service: 4,
    Package: 5,
    Detail: 6,
    Cruise: 7,
    Insurance: 8,
    0: 'Recommendation',
    1: 'CityPair',
    2: 'PriceGroup',
    3: 'Hotel',
    4: 'Service',
    5: 'Package',
    6: 'Detail',
    7: 'Cruise',
    8: 'Insurance',
};

EnumHelper.GMap.Type = {
    HYBRID: 'HYBRID',
    ROADMAP: 'ROADMAP',
    SATELLITE: 'SATELLITE',
    TERRAIN: 'TERRAIN'
};

EnumHelper.SearchDataType = {
    'Air': 'Recommendations',
    'Hotel': 'Hotels',
    'Service': 'Services'
};

EnumHelper.OrderType = {
    Descendent: 0,
    Ascendent: 1,
    0: 'Descendent',
    1: 'Ascendent'
};

EnumHelper.PassengerTitle = {
    MR: 0,
    MRS: 1,
    MSTR: 2,
    MISS: 3,
    INF: 4,
    0: 'MR',
    1: 'MRS',
    2: 'MSTR',
    3: 'MISS',
    4: 'INF'
};

EnumHelper.ServiceType = {
    Recommendation: 3,
    CityPair: 1,
    PriceGroup: 2,
    Hotel: 4,
    Package: 5,
    Service: 6,
    Car: 7,
    Insurance: 8,
    Tour: 9,
    Cruise: 10,
    3: 'Recommendation',
    1: 'CityPair',
    2: 'PriceGroup',
    4: 'Hotel',
    5: 'Package',
    6: 'Service',
    7: 'Car',
    8: 'Insurance',
    9: 'Tour',
    10: 'Cruise'
};

EnumHelper.ServiceType.Plural = {
    'Recommendation': 'Recommendations',
    'CityPair': 'CityPairs',
    'Hotel': 'Hotels',
    'Package': 'Packages',
    'Service': 'Services'
};

EnumHelper.DocumentType = {
    'Identity': 0,
    'Passport': 1,
    'CPF': 2,
    'DriverLicense': 3,
    'CNPJ': 4,
    'RNE': 5,
    0: 'Identity',
    1: 'Passport',
    2: 'CPF',
    3: 'DriverLicense',
    4: 'CNPJ',
    5: 'RNE'
};

EnumHelper.MCOType = {
    'Credit': 0,
    'Penalty': 1,
    0: 'Credit',
    1: 'Penalty'
};

EnumHelper.MCOStatus = {
    'Pending': 0,
    'Active': 1,
    'Canceled': 2,
    0: 'Pending',
    1: 'Active',
    2: 'Canceled'
};

EnumHelper.CrossSellingType = {
    0: 'Air',
    1: 'Hotel',
    'Air': 0,
    'Hotel': 1
};

EnumHelper.FieldType = {
    String: 0,
    Int: 1,
    Decimal: 2,
    Boolean: 3,
    DateTime: 4,
    Timestamp: 5,
    GlobalList: 6,
    Grid: 7,
    SubServiceTypeList: 8,
    LinkedField: 9,
    Passengers: 10,
    Services: 11,
    Messages: 12,
    Char: 13,
    PassengerList: 14,
    Money: 15,

    0: 'String',
    1: 'Int',
    2: 'Decimal',
    3: 'Boolean',
    4: 'DateTime',
    5: 'Timestamp',
    6: 'GlobalList',
    7: 'Grid',
    8: 'SubServiceTypeList',
    9: 'LinkedField',
    10: 'Passengers',
    11: 'Services',
    12: 'Messages',
    13: 'Char',
    14: 'PassengerList',
    15: 'Money'
};

//utilizado para configurar conteudo inicial do ServiceOrder.js
EnumHelper.ServiceOrderContent = {
    Summary: 'Summary',
    Passenger: 'Passenger',
    Air: 'Air',
    Hotel: 'Hotel',
    Billing: 'Billing',
    Message: 'Message'
};

EnumHelper.ServiceItemTemplate = {
    PaxGrid: 'PaxGrid',
    Summary: 'Summary',
    SummaryPax: 'SummaryPax',
    SummaryBilling: 'SummaryBilling',
    BillingDesc: 'BillingDesc'
};

EnumHelper.TypeProcessAction = {
    InsertUpdate: 0,
    Delete: 1,
    0: "InsertUpdate",
    1: "Delete"
}

EnumHelper.StatusExportation = {
    'Exporting': 0,
    'Exported': 1,
    'Canceling': 2,
    'Canceled': 3,
    'None': 4,
    0: 'Exporting',
    1: 'Exported',
    2: 'Canceling',
    3: 'Canceled',
    4: 'None'
};

EnumHelper.ExportationFlow = {
    'ExportationAll': 0,
    'AgencyForConsolidator': 1,
    'ClientCorpForAgency': 2,
    'AgencyForConsolidatorRAV': 3,
    'ClientCorpForAgencyRAV': 4,
    'AgencyForConsolidatorMCO': 5,
    'ClientCorpForAgencyMCO': 6,
    0: 'ExportationAll',
    1: 'AgencyForConsolidator',
    2: 'ClientCorpForAgency',
    3: 'AgencyForConsolidatorRAV',
    4: 'ClientCorpForAgencyRAV',
    5: 'AgencyForConsolidatorMCO',
    6: 'ClientCorpForAgencyMCO'
}

EnumHelper.NumberDirection = {
    Left: 0,
    Right: 1,
    0: "Left",
    1: "Right"
}

EnumHelper.ContactDataTo = {
    'BookPnr': 0,
    'ProcessOrder': 1,
    0: 'BookPnr',
    1: 'ProcessOrder'
};

EnumHelper.PnrAsServiceType = EnumHelper.PnrAsServiceType || {
    0: 'Book',
    1: 'Quotation',
    2: 'Proposal',
    'Book': 0,
    'Quotation': 1,
    'Proposal': 2
};

EnumHelper.ServiceItemCategory = {
    Advanced: "Advanced",
    Air: "Air",
    Car: "Car",
    Services: "Services",
    Service: "Service",
    Hotel: "Hotel",
    Other: "Other",
    Person: "Person",
    Refund: "Refund",
    Reimbursement: "Reimbursement",
    Workflow: "Workflow",
    Tour: "Tour",
    Cruise: "Cruise",
    Insurance: "Insurance"
};

EnumHelper.ServiceItemSubCategory = {
    Book: "Book",
    GiftList: "GiftList",
    Group: "Group",
    Insurance: "Insurance",
    Issue: "Issue",
    Item: "Item",
    MCO: "MCO",
    Order: "Order",
    OrderItem: "OrderItem",
    Payment: "Payment",
    Quotation: "Quotation",
    Request: "Request",
    RoomItem: "RoomItem",
    Solicitation: "Solicitation",
    TravelCard: "TravelCard",
    Proposal: "Proposal",
    ProposalOption: "ProposalOption",
    Commission: "Commission",
    PnrPayment: "PnrPayment"
};

EnumHelper.ServiceItemTools = {
    History: "History",
    Mail: "Mail",
    Print: "Print",
    Refresh: "Refresh",
    Edit: "Edit",
    OnlineOn: "OnlineOn",
    OnlineOff: "OnlineOff",
    Cancel: "Cancel",
    DownloadPDF: "DownloadPDF",
    PayMiscellaneousDocument: "PayMiscellaneousDocument",
    SendToTray: "SendToTray",
    DownloadTraces: "DownloadTraces",
    Inactivate: "Inactivate",
    Activate: "Activate",
    UploadFile: "UploadFile",
    MailHistory: "MailHistory",
    AssignResponsible: "AssignResponsible",
    SetResponsible: "SetResponsible",
    RemoveResponsible: "RemoveResponsible",
    AssignRequestingUser: "AssignRequestingUser",
    SetRequestingUser: "SetRequestingUser",
    RemoveRequestingUser: "RemoveRequestingUser",
    GenerateTickets: "GenerateTickets",
    IntegrateWithApp: "IntegrateWithApp",
};

EnumHelper.PnrStatus = {
    Booked: 0,
    Canceled: 1,
    BookPending: 2,
    Queued: 3,
    PendingCancellation: 4,
    Rejected: 5,
    TechnicalProblem: 6,
    0: 'Booked',
    1: 'Canceled',
    2: 'BookPending',
    3: 'Queued',
    4: 'PendingCancellation',
    5: 'Rejected',
    6: 'TechnicalProblem'
};

EnumHelper.ServiceItem.LinkType = {
    Parent: 0,
    Child: 1,
    Association: 2,
    GeneratedParent: 3,
    GeneratedChild: 4
};

EnumHelper.ServiceItem.PersonLinkType = {
    Parent: 0,
    Child: 1,
    Friend: 2,
    Partner: 3,
    StepChild: 4,
    StepParent: 5,
    Brother: 6,
    GrandChild: 7,
    GrandParent: 8,
    Uncle: 9,
    Nephew: 10,
    Employer: 11,
    Employee: 12,
    Nanny: 13,
    Charge: 14,
    Other: 15,
    0: 'Parent',
    1: 'Child',
    2: 'Friend',
    3: 'Partner',
    4: 'StepChild',
    5: 'StepParent',
    6: 'Brother',
    7: 'GrandChild',
    8: 'GrandParent',
    9: 'Uncle',
    10: 'Nephew',
    11: 'Employer',
    12: 'Employee',
    13: 'Nanny',
    14: 'Charge',
    15: 'Other'
};

EnumHelper.Pricing.FeeGroupType = {
    Consolidator: 0,
    Agency: 1
};

EnumHelper.PersonType = {
    Corporate: 0,
    Individual: 1,
    0: "Corporate",
    1: "Individual"
};

EnumHelper.LoadPersonRequiredFieldsFrom = {
    Template: 0,
    User: 1,
    0: "Template",
    1: "User"
};

EnumHelper.PnrStatus = EnumHelper.PnrStatus || {
    0: 'Booked',
    1: 'Canceled',
    2: 'BookPending',
    'Booked': 0,
    'Canceled': 1,
    'BookPending': 2
};

EnumHelper.BatchAction = {
    Search: 0,
    AnonymousSearch: 1,
    SearchNBook: 2,
    Issue: 3,
    Book: 4,
    BookNIssue: 5,
    Retrieve: 6,
    RevalidatePNR: 8,
    0: "Search",
    1: "AnonymousSearch",
    2: "SearchNBook",
    3: "Issue",
    4: "Book",
    5: "BookNIssue",
    6: "Retrieve",
    8: "RevalidatePNR"
};

EnumHelper.BatchRecordContentStatusMessage = {
    Error: 0,
    Warning: 1,
    Success: 2,
    0: "Error",
    1: "Warning",
    2: "Success"
};

EnumHelper.BatchStatus = {
    InWorking: 0,
    Error: 1,
    Complete: 2,
    CompleteWithError: 3,
    0: "InWorking",
    1: "Error",
    2: "Complete",
    3: "CompleteWithError"
};

EnumHelper.SortProperty = {
    FlightDuration: 0,
    Schedule: 1,
    Price: 2,
    0: "FlightDuration",
    1: "Schedule",
    2: "Price"
};

EnumHelper.VisualizationType = {
    Horizontal: 'horizontal',
    Vertical: 'vertical',
    Single: 'single',
    Price: 'price'
};

EnumHelper.EventPriority = EnumHelper.EventPriority || {
    0: "High",
    1: "Medium",
    2: "Low",
    "High": 0,
    "Medium": 1,
    "Low": 2
};

EnumHelper.WorkflowPaymentStatus = {
    None: 0,
    Pending: 1,
    Confirmed: 2,
    NotConfirmed: 3,
    Canceled: 4,
    PreAuthorized: 5,
    Reimbursed: 6,
    ReimbursementRequested: 7,
    0: "None",
    1: "Pending",
    2: "Confirmed",
    3: "NotConfirmed",
    4: "Canceled",
    5: "PreAuthorized",
    6: 'Reimbursed',
    7: 'ReimbursementRequested'
};

EnumHelper.BillingHistoryType = {
    None: 0,
    PaymentAdded: 1,
    PaymentCanceled: 2,
    PaymentAuthorized: 3,
    PaymentUnauthorized: 4,
    PaymentPending: 5,
    PaymentDisassociated: 6,
    BuyerAdded: 7,
    BuyerRemoved: 8,
    0: "None",
    1: "PaymentAdded",
    2: "PaymentCanceled",
    3: "PaymentAuthorized",
    4: "PaymentUnauthorized",
    5: "PaymentPending",
    6: "PaymentDisassociated",
    7: "BuyerAdded",
    8: "BuyerRemoved"
};


EnumHelper.WorkflowPaymentHolderType = {
    None: 0,
    Client: 1,
    Supplier: 2,
    ClientSupplier: 3,
    0: "None",
    1: "Client",
    2: "Supplier",
    3: "ClientSupplier"
};

EnumHelper.CarCategory = {
    0: "Unspecified",
    1: "Economy",
    2: "Compact",
    3: "CompactElite",
    4: "Fullsize",
    5: "FullsizeElite",
    6: "EconomyElite",
    7: "Intermediate",
    8: "IntermediateElite",
    9: "Luxury",
    10: "Mini",
    11: "MiniElite",
    12: "Oversize",
    13: "Premium",
    14: "StandardElite",
    15: "Standard",
    16: "PremiumElite",
    17: "LuxuryElite",
    18: "Special",
    19: "Minivan",
    "Unspecified": 0,
    "Economy": 1,
    "Compact": 2,
    "CompactElite": 3,
    "Fullsize": 4,
    "FullsizeElite": 5,
    "EconomyElite": 6,
    "Intermediate": 7,
    "IntermediateElite": 8,
    "Luxury": 9,
    "Mini": 10,
    "MiniElite": 11,
    "Oversize": 12,
    "Premium": 13,
    "StandardElite": 14,
    "Standard": 15,
    "PremiumElite": 16,
    "LuxuryElite": 17,
    "Special": 18,
    "Minivan": 19
};

EnumHelper.ContentLoadType = {
    Cars: 0,
    Groups: 1,
    Companies: 2,
    RentalLocations: 3,
    SpecialEquipments: 4
};

EnumHelper.CarTransmission = {
    0: "Unspecified",
    1: "Manual",
    2: "Automatic"
};

EnumHelper.CarRateType = {
    0: "Undefined",
    1: "Hourly",
    2: "Total",
    3: "Daily",
    4: "Monthly",
    5: "Weekend",
    6: "Weekly"
};

EnumHelper.CarType = {
    0: "Unspecified",
    1: "TwoOrThreeDoors",
    2: "TwoOrFourDoors",
    3: "FourOrFiveDoors",
    4: "Coupe",
    5: "Suv",
    6: "Crossover",
    7: "Motorhome",
    8: "OpenairAllTerrain",
    9: "CommercialVanOrTruck",
    10: "Limousine",
    11: "Monospace",
    12: "Roadster",
    13: "PickupRegularCab",
    14: "PickupExtendedCab",
    15: "RecreationalVehicle",
    16: "Sport",
    17: "Convertible",
    18: "PassengerVan",
    19: "WagonOrEstate",
    20: "Special",
    21: "TwoWheelVehicle",
    22: "SpecialOfferCar"
};

EnumHelper.CarAirConditioning = {
    'true': "WithAirConditioning",
    'false': "WithoutAirConditioning"
};

EnumHelper.CarRateQualifier = {
    1: "FullyQualified",
    2: "PartlyQualified",
    3: "OtherRates"
};

EnumHelper.ServiceSaleType = {
    0: "FreeSale",
    1: "OnRequest",
    2: "Inventory",
    "FreeSale": 0,
    "OnRequest": 1,
    "Inventory": 2
};

EnumHelper.HotelSaleType = {
    0: "Allotment",
    1: "FreeSale",
    2: "OnRequest",
    3: "Online",
    "Allotment": 0,
    "FreeSale": 1,
    "OnRequest": 2,
    "Online": 3
};

EnumHelper.TemplateMode = {
    Complete: "Complete",
    Summary: "Summary",
    ETicket: "E-Ticket",
    PaymentReceipt: "PaymentReceipt",
    PaymentLink: "PaymentLink"
};

EnumHelper.FileExtensionIcon = {
    "doc": "doc - icon.png",
    "docx": "docx-icon.png",
    "gif": "gif-icon.png",
    "htm": "htm-icon.png",
    "html": "html-icon.png",
    "jpeg": "jpeg-icon.png",
    "jpg": "jpg-icon.png",
    "pdf": "pdf-icon.png",
    "png": "png-icon.png",
    "pps": "pps-icon.png",
    "pst": "pst-icon.png",
    "rar": "rar-icon.png",
    "txt": "txt-icon.png",
    "unknown": "unknown-icon.png",
    "xsl": "xls-icon.png",
    "xslx": "xlsx-icon.png",
    "zip": "zip-icon.png",
    "confidential": "confidential-icon.png"
};

EnumHelper.SearchStatus = {
    Searching: 0,
    Completed: 1
};

EnumHelper.ManagementFields.SearchType = {
    0: 'Customer',
    1: 'Agency',
    'Customer': 0,
    'Agency': 1
};

EnumHelper.ExternalFieldType = {
    TextField: 0,
    DropDownField: 1,
    0: "TextField",
    1: "DropDownField"
};

EnumHelper.MappedTypeExternalFieldType = {
    NotMapped: 0,
    RequesterUser: 1,
    CostCenter: 2,
    0: "NotMapped",
    1: "RequesterUser",
    2: "CostCenter"
};

if (typeof Util == 'undefined')
    Util = {};

EnumHelper.SourceType = Util && Util.Sources;

EnumHelper.FareType = {
    0: 'Public',
    1: 'Operator',
    "Public": 0,
    "Operator": 1
};

if (typeof EnumHelper.Hotel == 'undefined')
    EnumHelper.Hotel = {};

EnumHelper.Hotel.FareType = {
    0: "Full",
    1: "Agreement",
    2: "Net",
    3: "Balcony",
    4: "Comissioned",
    5: "Package",
    "Full": 0,
    "Agreement": 1,
    "Net": 2,
    "Balcony": 3,
    "Comissioned": 4,
    "Package": 5

};

EnumHelper.Wizard.Step = {
    1: "AggregateStepOne",
    2: "AggregateStepTwo",
    3: "managementExternalFields",
    "AggregateStepOne": 1,
    "AggregateStepTwo": 2,
    "managementExternalFields": 3
};

EnumHelper.TrayBarItemType = {
    Air: 'Air',
    Hotel: 'Hotel',
    Service: 'Service',
    Insurance: 'Insurance',
    PreOrder: 'PreOrder',
    Cruise: 'Cruise'
};

EnumHelper.ServiceDefinition.FieldType = {
    String: 0,
    Int: 1,
    Decimal: 2,
    Boolean: 3,
    DateTime: 4,
    Timestamp: 5,
    GlobalList: 6,
    Grid: 7,
    SubServiceTypeList: 8,
    LinkedField: 9,
    Passengers: 10,
    Services: 11,
    Messages: 12,
    Char: 13,
    PassengerList: 14,
    Money: 15,
    0: 'String',
    1: 'Int',
    2: 'Decimal',
    3: 'Boolean',
    4: 'DateTime',
    5: 'Timestamp',
    6: 'GlobalList',
    7: 'Grid',
    8: 'SubServiceTypeList',
    9: 'LinkedField',
    10: 'Passengers',
    11: 'Services',
    12: 'Messages',
    13: 'Char',
    14: 'PassengerList',
    15: 'Money'
};

EnumHelper.ReturnMode = {
    0: 'Synchronous',
    1: 'Asynchronous',
    'Synchronous': 0,
    'Asynchronous': 1
};

EnumHelper.SegmentsChange = {
    'Alter': 'Alter',
    'Include': 'Include'
};

EnumHelper.InterfaceBuilder.TextBoxEditorType = {
    0: "Normal",
    1: "Xml",
    2: "Number",
    3: "Currency",
    4: "Phone",
    5: "Javascript",
    6: "RichText",
    7: "Color",
    "Normal": 0,
    "Xml": 1,
    "Number": 2,
    "Currency": 3,
    "Phone": 4,
    "Javascript": 5,
    "RichText": 6,
    "Color": 7
};

EnumHelper.MaskTypeExternalField = {
    0: "None",
    1: "FullDateYear",
    2: "OnlyNumber",
    3: "Alphanumeric",
    "None": 0,
    "FullDateYear": 1,
    "OnlyNumber": 2,
    "Alphanumeric": 3
};

EnumHelper.AcceptanceTermsDisplayMode = EnumHelper.AcceptanceTermsDisplayMode || {
    0: 'Full',
    1: 'Summary',
    'Summary': 1,
    'Full': 0
};

EnumHelper.AcceptanceTermsType = EnumHelper.AcceptanceTermsType || {
    0: 'Template',
    1: 'Link',
    'Link': 1,
    'Template': 0
};

EnumHelper.BookingType = {
    0: 'PriceBeforeBook',
    1: 'TryToPriceAfterBook',
    2: 'BookWithoutFare',
    'PriceBeforeBook': 0,
    'TryToPriceAfterBook': 1,
    'BookWithoutFare': 2
};

EnumHelper.AlaturWSTipoProcesso = {
    0: 'C'
    , 1: 'E'
    , 'C': 0
    , 'E': 1
}

EnumHelper.ExternalFieldType = {
    'TextField': 0
    , 'DropDownField': 1
    , 0: 'TextField'
    , 1: 'DropDownField'
}

EnumHelper.MappedTypeExternalFieldType = {
    'NotMapped': 0
    , 'RequesterUser': 1
    , 'CostCenter': 2
    , 'UserBackOfficeID': 3
    , 'DateField': 4
    , 'CityDropBox': 5
    , 0: 'NotMapped'
    , 1: 'RequesterUser'
    , 2: 'CostCenter'
    , 3: 'UserBackOfficeID'
    , 4: 'DateField'
    , 5: 'CityDropBox'
}

EnumHelper.Service.SaleMode = {
    0: 'Free',
    1: 'ByPerson',
    'Free': 0,
    'ByPerson': 1,
};

EnumHelper.StatusFlowItemType = {
    Action: 'Action',
    Condition: 'Condition',
    ActionTip: 'ActionTip'
};

EnumHelper.WaitType = {
    0: 'Approver',
    1: 'Requester',
    2: 'Consultant',
    'Approver': 0,
    'Requester': 1,
    'Consultant': 2
};

EnumHelper.ConditionType = {
    0: 'BeforeDisplay',
    1: 'AfterAction',
    2: 'None',
    'BeforeDisplay': 0,
    'AfterAction': 1,
    'None': 2
};

EnumHelper.PaymentTypeActions = {
    "1": "Edit",
    "2": "Confirm",
    "3": "Cancel",
    "View": "0",
    "Edit": "1",
    "Confirm": "2",
    "Cancel": "3"
};

EnumHelper.PaymentTypeActions.DefaultValues = {
    "1": "true",
    "2": "false",
    "3": "false"
};

EnumHelper.CruisePnrLiveEditItems = {
    "1": "FullPnrEdit",
    "2": "Passengers",
    "3": "CabinType",
    "4": "Cabin",
    "5": "DiningOption",
    "6": "CancelBook",
    "FullPnrEdit": "1",
    "Passengers": "2",
    "CabinType": "3",
    "Cabin": "4",
    "DiningOption": "5",
    "CancelBook": "6"
};

EnumHelper.CruisePnrLiveEditActions = {
    "1": "Show",
    "2": "DisableOnBooked",
    "Show": "1",
    "DisableOnBooked": "2"
};

EnumHelper.CruisePnrLiveEditActions.DefaultValues = {
    "1": "false",
    "2": "false"
};

EnumHelper.OfflineItemActions = {
    "1": "BlockView",
    "2": "BlockEdit",
    "3": "BlockCreate",
    "4": "BlockOnlineView",
    "5": "BlockAllActionsWhenClosedOS",
    "BlockView": "1",
    "BlockEdit": "2",
    "BlockCreate": "3",
    "BlockOnlineView": "4",
    "BlockAllActionsWhenClosedOS": "5"
};

EnumHelper.DiscountType = {
    "0": "Percentual",
    "1": "Absolute",
    "Percentual": "0",
    "Absolute": "1"
};

EnumHelper.DataSourceType = {
    GlobalList: "0",
    DataSource: "1"
};

EnumHelper.SearchResultStatus = {
    NoSuccess: 0
    , NoSucessWithExceptionOrFatalError: 1
    , SearchSuccessApplyingOutOfRangeFilter: 2
    , SearchSuccessNotApplyingOutOfRangeFilter: 3
    , SearchSuccessChangeOriginApplyingOutOfRangeFilter: 4
    , SearchSuccessChangeOriginNotApplyingOutOfRangeFilter: 5
    , SearchSuccessDifferentDateApplyingOutOfRangeFilter: 6
    , SearchSuccessDifferentDateNotApplyingOutOfRangeFilter: 7
    , SearchSuccessDifferentDateAndOriginApplyingOutOfRangeFilter: 8
    , SearchSuccessDifferentDateAndOriginNotApplyingOutOfRangeFilter: 9
    , SearchSuccessRemovingPartiallyRangeFilter: 10
    , SearchSuccessRemovingPartiallyAndNotApplyingOutOfRangeFilter: 11
    , 0: 'NoSuccess'
    , 1: 'NoSucessWithExceptionOrFatalError'
    , 2: 'SearchSuccessApplyingOutOfRangeFilter'
    , 3: 'SearchSuccessNotApplyingOutOfRangeFilter'
    , 4: 'SearchSuccessChangeOriginApplyingOutOfRangeFilter'
    , 5: 'SearchSuccessChangeOriginNotApplyingOutOfRangeFilter'
    , 6: 'SearchSuccessDifferentDateApplyingOutOfRangeFilter'
    , 7: 'SearchSuccessDifferentDateNotApplyingOutOfRangeFilter'
    , 8: 'SearchSuccessDifferentDateAndOriginApplyingOutOfRangeFilter'
    , 9: 'SearchSuccessDifferentDateAndOriginNotApplyingOutOfRangeFilter'
    , 10: 'SearchSuccessRemovingPartiallyRangeFilter'
    , 11: 'SearchSuccessRemovingPartiallyAndNotApplyingOutOfRangeFilter'
};

EnumHelper.HotelDetailsMode = EnumHelper.HotelDetailsMode ||
{
    0: "Normal",
    1: "IFrame",
    2: "ExternalPage",
    3: "TransactionPage",
    "Normal": 0,
    "IFrame": 1,
    "ExternalPage": 2,
    "TransactionPage": 3
};

EnumHelper.ActionMode = {
    "None": 0,
    "AddElements": 1,
    "Close": 2,
    "CloseAndRetrieve": 3,
    "Ignore": 4,
    "IgnoreAndRetrieve": 5,
    0: "None",
    1: "AddElements",
    2: "Close",
    3: "CloseAndRetrieve",
    4: "Ignore",
    5: "IgnoreAndRetrieve"
};

EnumHelper.SearchName = {
    Recommendation: 0,
    CityPairSchedule: 1,
    CityPairPriceSchedule: 2,
    Hotel: 3,
    Car: 4,
    Service: 5,
    Package: 6,
    Tour: 7,
    Cruise: 10,
    Insurance: 11,
    Itinerary: 12,
    0: "Recommendation",
    1: "CityPairSchedule",
    2: "CityPairPriceSchedule",
    3: "Hotel",
    4: "Car",
    5: "Service",
    6: "Package",
    7: "Tour",
    10: "Cruise",
    11: 'Insurance',
    12: 'Itinerary',
};

EnumHelper.TrayItemType = {
    Recommendation: 0,
    CityPairSchedule: 1,
    CityPairPriceSchedule: 2,
    Hotel: 3,
    Car: 4,
    Service: 5,
    Package: 6,
    Tour: 7,
    ServiceItem: 8,
    ServiceOrder: 9,
    Cruise: 10,
    Insurance: 11,
    Itinerary: 12,
    CruiseGroup: 13,
    0: "Recommendation",
    1: "CityPairSchedule",
    2: "CityPairPriceSchedule",
    3: "Hotel",
    4: "Car",
    5: "Service",
    6: "Package",
    7: "Tour",
    8: "ServiceItem",
    9: "ServiceOrder",
    10: "Cruise",
    11: "Insurance",
    12: "Itinerary",
    13: "CruiseGroup"
};

EnumHelper.HotelSummaryValuesType = {
    'Normal': 0,
    'ComparingWithSelected': 1,
    0: 'Normal',
    1: 'ComparingWithSelected'
};

EnumHelper.PACLineModifyCommandType = {
    0: 'AirLineCodeCommission',
    1: 'Commission',
    2: 'OptionalInformation',
    3: 'TicketNumberFreeText',
};

EnumHelper.PersonTypeMercantil = {
    0: 'Natural',
    1: 'Legal',
    2: 'CTA'
};

EnumHelper.ProposalType = {
    Analytical: 'Analytical',
    Synthetic: 'Synthetic'
};

EnumHelper.Services.ServiceType = {
    Other: 0,
    Tour: 1,
    Cruise: 2,
    Insurance: 3,
    0: "Other",
    1: "Tour",
    2: "Cruise",
    3: 'Insurance'
};

EnumHelper.Itinerary.ProductType = {
    Other: 0,
    Service: 1,
    Hotel: 2,
    Air: 3,
    0: "Other",
    1: "Service",
    2: "Hotel",
    3: 'Air'
};

EnumHelper.ReferenceIntervalType = {
    DayOfMonth: 0,
    Month: 1,
    WeekOfTheYear: 2,
    Date: 3,
    0: "DayOfMonth",
    1: "Month",
    2: "WeekOfTheYear",
    3: "Date"
};

EnumHelper.DatabaseModifier = {
    After: 0,
    Before: 1,
    FixedDateFromLastMonth: 2,
    FixedDate: 3,
    FixedDateFromNextMonth: 4,
    0: "After",
    1: "Before",
    2: "FixedDateFromLastMonth",
    3: "FixedDate",
    4: "FixedDateFromNextMonth"
};

EnumHelper.ReferencePeriodType = {
    Days: 0,
    Weeks: 1,
    Months: 2,
    DecendioCopet: 3,
    Fortnight: 4,
    IATAWeek: 5,
    0: "Days",
    1: "Weeks",
    2: "Months",
    3: "DecendioCopet",
    4: "Fortnight",
    5: "IATAWeek",
};

EnumHelper.CommissionRoles = {
    Manager: 0,
    Responsible: 1,
    Issuer: 2,
    CorporateClient: 3,
    Agency: 4,
    ConsolidatorOperator: 5,
    0: 'Manager',
    1: 'Responsible',
    2: 'Issuer',
    3: 'CorporateClient',
    4: 'Agency',
    5: 'ConsolidatorOperator'
};

EnumHelper.HybridPackageSalesFlowVersion = {
    'One': '1',
    'Two': '2',
    '1': 'One',
    '2': 'Two'
};

EnumHelper.PriceBlockMode = {
    Total: '1',
    ByPerson: '2',
    '1': 'Total',
    '2': 'ByPerson'
};

EnumHelper.DataGridColumnVisibility = {
    All: 0,
    GridOnly: 1,
    EditorOnly: 2
};

EnumHelper.DiscountCouponStatus = {
    none: 0,
    valid: 1,
    invalid: 2,
    '0': 'none',
    '1': 'valid',
    '2': 'invalid',
};

EnumHelper.ToolBarExtensionOpenMode = {
    IFrame: 0,
    NewWindow: 1
};

EnumHelper.PaymentFormAdditionalFields = {
    "PayerAddress": 0,
    "PayerData": 1,
    0: "PayerAddress",
    1: "PayerData",
};

EnumHelper.PaymentFormAdditionalFieldsSettings = {
    "Enabled": 0,
    "Required": 1,
    0: "Enabled",
    1: "Required"
};

EnumHelper.Fee.State = {
    "Original": 0,
    "Changed": 1,
    0: "Original",
    1: "Changed"
};

EnumHelper.TranslateCabinType = function (param, opt_sb) {
    var output = opt_sb || "";
    //Importante: vai falhar com o CabinType FirstClass se for somente if (param.cabinType)
    if (param.cabinType != undefined) {
        output.append(Resources.translateAirCabinType({ cabintype: EnumHelper.CabinType[param.cabinType] }));
    }
}

EnumHelper.TranslateCruiseItineraryActivity = function (param, opt_sb) {
    var output = opt_sb;
    if (param.itineraryActivity != null) {
        output.append(Resources.translate({ code: EnumHelper.CruiseItineraryActivity[param.itineraryActivity] }));
    }
}

EnumHelper.TranslateCruiseDiningTableSizes = function (param, opt_sb) {
    var output = opt_sb;
    if (param.tableSize != null) {
        var translated = Resources.translate({ code: EnumHelper.CruiseDiningTableSizes[param.tableSize] });
        if (translated == "Pequeno")
            translated = "Pequena";

        output.append(translated);
    }
}

EnumHelper.TranslateCruiseDiningSittingType = function (param, opt_sb) {
    var output = opt_sb;
    if (param.sittingType != null) {
        output.append(Resources.translate({ code: EnumHelper.CruiseDiningSittingType[param.sittingType] }));
    }
}

EnumHelper.TranslateCruiseRoomConfiguration = function (param, opt_sb) {
    var output = opt_sb;
    if (param.roomConfiguration != null) {
        output.append(Resources.translate({ code: EnumHelper.CruiseRoomConfiguration[param.roomConfiguration] }));
    }
}

EnumHelper.TranslateMeasureTypes = function (param, opt_sb) {
    var output = opt_sb;
    if (param.measureType != null) {
        output.append(Resources.translate({ code: EnumHelper.MeasureTypes[param.measureType] }));
    }
}

EnumHelper.InvoicePaymentType = {
    "Exchange": 0,
    "RetainedCommission": 1,
    "FranchiseDiscount": 2,
    0: "Exchange",
    1: "RetainedCommission",
    2: "FranchiseDiscount"
};

EnumHelper.ParseTravelAceBrokerCode = {
    BR: "TerritÃ³rio Nacional",
    X2: "AmÃ©rica Central e Caribe",
    X4: "AmÃ©rica do Norte",
    X3: "AmÃ©rica do Sul (menos Brasil)",
    X6: "Europa",
    X8: "Oceania",
    X7: "Ãsia",
    X5: "Ãfrica"
};

EnumHelper.MandatoryUserLogin = {
    No: 0,
    OnSearch: 1,
    OnOrder: 2,
    0: "No",
    1: "OnSearch",
    2: "OnOrder",
    "No": 0,
    "OnSearch": 1,
    "OnOrder": 2,
};

EnumHelper.DefinitionCategory = {
    Both: 0,
    ServiceOrder: 1,
    ServiceItem: 2,
    0: 'Both',
    1: 'ServiceOrder',
    2: 'ServiceItem'
};

EnumHelper.SaleItemType = {
    ServiceItem: 0,
    Fee: 1,
    0: "ServiceItem",
    1: "Fee"
};

EnumHelper.SortBy = {
    Hotel: {
        Price: 0,
        HotelName: 1,
        HotelStars: 2,
        PreferedHotel: 3,
        Custom: 4
    }
};

EnumHelper.LoginFormType = {
    1: 'login',
    2: 'logOut',
    3: 'loggedInUser',
    5: 'forgotPassword',
    6: 'changePassword',
    7: 'businessLogin',
    'login': 1,
    'logOut': 2,
    'loggedInUser': 3,
    'forgotPassword': 5,
    'changePassword': 6,
    'businessLogin': 7
};

EnumHelper.AuthenticationType = {
    0: 'Normal',
    1: 'BusinessAccess',
    'Normal': 0,
    'BusinessAccess': 1
};

EnumHelper.WizardFlowType = EnumHelper.WizardFlowType ||
{
    0: 'CheckoutWizard',
    1: 'ProposalWizard',
    'ProposalWizard': 0,
    'CheckoutWizard': 1
};

EnumHelper.ServiceOrder = EnumHelper.ServiceOrder || {};

EnumHelper.ServiceOrder.BehaviorMode = {
    "0": "Sale",
    "1": "Proposal",
    "Sale": "0",
    "Proposal": "1"
};

EnumHelper.UserResolution = {
    "0": "Mobile",
    "1": "Tablet",
    "2": "Desktop",
    "Mobile": "0",
    "Tablet": "1",
    "Desktop": "2"
};

EnumHelper.BaggagesIncluded = {
    0: 'Unknown',
    1: 'NoneAreIncluded',
    2: 'OneBaggage',
    3: 'TwoBaggages',
    4: 'ThreeBaggages',
    'Unknown': 0,
    'NoneAreIncluded': 1,
    'OneBaggage': 2,
    'TwoBaggages': 3,
    'ThreeBaggages': 4
};

EnumHelper.Warning.WarningSeverity = {
    0: 'Low',
    1: 'Medium',
    2: 'High',
    3: 'Critical',
    'Low': 0,
    'Medium': 1,
    'High': 2,
    'Critical': 3
};

EnumHelper.TranslateBaggagesIncluded = function (param, opt_sb) {
    if (typeof (param.baggagesIncluded) != undefined) {
        if (opt_sb != undefined
            && opt_sb.append != undefined)
            opt_sb.append(Resources.translate({ code: "BaggagesIncluded_" + EnumHelper.BaggagesIncluded[param.baggagesIncluded] }));
        else
            return Resources.translate({ code: "BaggagesIncluded_" + EnumHelper.BaggagesIncluded[param.baggagesIncluded] });
    }
};

EnumHelper.TranslateAddRemoveBaggages = function (param, opt_sb) {
    if (typeof (param.baggagesIncluded) != undefined) {
        if (opt_sb != undefined
            && opt_sb.append != undefined)
            opt_sb.append(Resources.translate({ code: "AddRemoveBaggages_" + EnumHelper.BaggagesIncluded[param.baggagesIncluded] }));
        else
            return Resources.translate({ code: "AddRemoveBaggages_" + EnumHelper.BaggagesIncluded[param.baggagesIncluded] });
    }
};

EnumHelper.CheckoutTranslateBaggagesOptions = function (param, opt_sb) {
    if (typeof (param.baggagesIncluded) != undefined) {
        if (opt_sb != undefined
            && opt_sb.append != undefined)
            opt_sb.append(Resources.translate({ code: "CheckoutBaggagesOption_" + EnumHelper.BaggagesIncluded[param.baggagesIncluded] }));
        else
            return Resources.translate({ code: "CheckoutBaggagesOption_" + EnumHelper.BaggagesIncluded[param.baggagesIncluded] });
    }
};

EnumHelper.PaymentStatus = {
    'None': 0,
    'InvoicePaid': 1,
    'CreditCardPaid': 2,
    0: 'None',
    1: 'InvoicePaid',
    2: 'CreditCardPaid'
}

EnumHelper.LocationType = {
    'World': 0,
    'Continent': 1,
    'Country': 2,
    'State': 3,
    'City': 4,
    'Airport': 5,
    'Region': 6,
    'Spot': 7,
    'Port': 8,
    'BusStation': 9,
    'Hotel': 10,
    0: 'World',
    1: 'Continent',
    2: 'Country',
    3: 'State',
    4: 'City',
    5: 'Airport',
    6: 'Region',
    7: 'Spot',
    8: 'Port',
    9: 'BusStation',
    10: 'Hotel',
}


var EnumHelper;
(function (EnumHelper) {
    var FieldType;
    (function (FieldType) {
        FieldType[FieldType["String"] = 0] = "String";
        FieldType[FieldType["Int"] = 1] = "Int";
        FieldType[FieldType["Decimal"] = 2] = "Decimal";
        FieldType[FieldType["Boolean"] = 3] = "Boolean";
        FieldType[FieldType["DateTime"] = 4] = "DateTime";
        FieldType[FieldType["Timestamp"] = 5] = "Timestamp";
        FieldType[FieldType["GlobalList"] = 6] = "GlobalList";
        FieldType[FieldType["Grid"] = 7] = "Grid";
        FieldType[FieldType["SubServiceTypeList"] = 8] = "SubServiceTypeList";
        FieldType[FieldType["LinkedField"] = 9] = "LinkedField";
        FieldType[FieldType["Passengers"] = 10] = "Passengers";
        FieldType[FieldType["Services"] = 11] = "Services";
        FieldType[FieldType["Messages"] = 12] = "Messages";
        FieldType[FieldType["Char"] = 13] = "Char";
        FieldType[FieldType["PassengerList"] = 14] = "PassengerList";
        FieldType[FieldType["Money"] = 15] = "Money";
        FieldType[FieldType["Outro"] = 16] = "Outro";
    })(FieldType = EnumHelper.FieldType || (EnumHelper.FieldType = {}));
    var ExchangeRateSource;
    (function (ExchangeRateSource) {
        ExchangeRateSource[ExchangeRateSource["IATA"] = 0] = "IATA";
        ExchangeRateSource[ExchangeRateSource["Registered"] = 1] = "Registered";
    })(ExchangeRateSource = EnumHelper.ExchangeRateSource || (EnumHelper.ExchangeRateSource = {}));
    var ServiceItemLinkType;
    (function (ServiceItemLinkType) {
        ServiceItemLinkType[ServiceItemLinkType["Parent"] = 0] = "Parent";
        ServiceItemLinkType[ServiceItemLinkType["Child"] = 1] = "Child";
        ServiceItemLinkType[ServiceItemLinkType["Association"] = 2] = "Association";
        ServiceItemLinkType[ServiceItemLinkType["GeneratedParent"] = 3] = "GeneratedParent";
        ServiceItemLinkType[ServiceItemLinkType["GeneratedChild"] = 4] = "GeneratedChild";
    })(ServiceItemLinkType = EnumHelper.ServiceItemLinkType || (EnumHelper.ServiceItemLinkType = {}));
    var TypeProcessAction;
    (function (TypeProcessAction) {
        TypeProcessAction[TypeProcessAction["InsertUpdate"] = 0] = "InsertUpdate";
        TypeProcessAction[TypeProcessAction["Delete"] = 1] = "Delete";
    })(TypeProcessAction = EnumHelper.TypeProcessAction || (EnumHelper.TypeProcessAction = {}));
    var AddressType;
    (function (AddressType) {
        AddressType[AddressType["Home"] = 0] = "Home";
        AddressType[AddressType["Billing"] = 1] = "Billing";
        AddressType[AddressType["Business"] = 2] = "Business";
    })(AddressType = EnumHelper.AddressType || (EnumHelper.AddressType = {}));
    ;
    var Filter;
    (function (Filter) {
        Filter[Filter["Cruise"] = 7] = "Cruise";
    })(Filter = EnumHelper.Filter || (EnumHelper.Filter = {}));
    var CruiseFareStatus;
    (function (CruiseFareStatus) {
        CruiseFareStatus[CruiseFareStatus["Available"] = 0] = "Available";
        CruiseFareStatus[CruiseFareStatus["WaitList"] = 1] = "WaitList";
        CruiseFareStatus[CruiseFareStatus["Guaranteed"] = 2] = "Guaranteed";
        CruiseFareStatus[CruiseFareStatus["Closed"] = 3] = "Closed";
    })(CruiseFareStatus = EnumHelper.CruiseFareStatus || (EnumHelper.CruiseFareStatus = {}));
    var CruiseDiningSittingStatus;
    (function (CruiseDiningSittingStatus) {
        CruiseDiningSittingStatus[CruiseDiningSittingStatus["Unavailable"] = 0] = "Unavailable";
        CruiseDiningSittingStatus[CruiseDiningSittingStatus["Available"] = 1] = "Available";
        CruiseDiningSittingStatus[CruiseDiningSittingStatus["Waitlist"] = 2] = "Waitlist";
    })(CruiseDiningSittingStatus = EnumHelper.CruiseDiningSittingStatus || (EnumHelper.CruiseDiningSittingStatus = {}));
    var CruiseDiningSittingType;
    (function (CruiseDiningSittingType) {
        CruiseDiningSittingType[CruiseDiningSittingType["Traditional"] = 0] = "Traditional";
        CruiseDiningSittingType[CruiseDiningSittingType["Open"] = 1] = "Open";
        CruiseDiningSittingType[CruiseDiningSittingType["Undecided"] = 2] = "Undecided";
    })(CruiseDiningSittingType = EnumHelper.CruiseDiningSittingType || (EnumHelper.CruiseDiningSittingType = {}));
    var CruiseDiningTableSizes;
    (function (CruiseDiningTableSizes) {
        CruiseDiningTableSizes[CruiseDiningTableSizes["Small"] = 0] = "Small";
        CruiseDiningTableSizes[CruiseDiningTableSizes["Large"] = 1] = "Large";
    })(CruiseDiningTableSizes = EnumHelper.CruiseDiningTableSizes || (EnumHelper.CruiseDiningTableSizes = {}));
    var CruiseRoomConfigurations;
    (function (CruiseRoomConfigurations) {
        CruiseRoomConfigurations[CruiseRoomConfigurations["ApartBoth"] = 0] = "ApartBoth";
        CruiseRoomConfigurations[CruiseRoomConfigurations["OneSetTogether"] = 1] = "OneSetTogether";
        CruiseRoomConfigurations[CruiseRoomConfigurations["BothTogether"] = 2] = "BothTogether";
        CruiseRoomConfigurations[CruiseRoomConfigurations["Unknown"] = 3] = "Unknown";
    })(CruiseRoomConfigurations = EnumHelper.CruiseRoomConfigurations || (EnumHelper.CruiseRoomConfigurations = {}));
    var CruiseItineraryActivity;
    (function (CruiseItineraryActivity) {
        CruiseItineraryActivity[CruiseItineraryActivity["Embark"] = 0] = "Embark";
        CruiseItineraryActivity[CruiseItineraryActivity["Docked"] = 1] = "Docked";
        CruiseItineraryActivity[CruiseItineraryActivity["Tendered"] = 2] = "Tendered";
        CruiseItineraryActivity[CruiseItineraryActivity["Cruising"] = 3] = "Cruising";
        CruiseItineraryActivity[CruiseItineraryActivity["Debark"] = 4] = "Debark";
    })(CruiseItineraryActivity = EnumHelper.CruiseItineraryActivity || (EnumHelper.CruiseItineraryActivity = {}));
    var CruiseReservationStatusCode;
    (function (CruiseReservationStatusCode) {
        CruiseReservationStatusCode[CruiseReservationStatusCode["OF"] = 42] = "OF";
        CruiseReservationStatusCode[CruiseReservationStatusCode["BK"] = 49] = "BK";
        CruiseReservationStatusCode[CruiseReservationStatusCode["CX"] = 16] = "CX";
        CruiseReservationStatusCode[CruiseReservationStatusCode["WL"] = 46] = "WL";
    })(CruiseReservationStatusCode = EnumHelper.CruiseReservationStatusCode || (EnumHelper.CruiseReservationStatusCode = {}));
    var CruiseShipPosition;
    (function (CruiseShipPosition) {
        CruiseShipPosition[CruiseShipPosition["Unknown"] = 0] = "Unknown";
        CruiseShipPosition[CruiseShipPosition["Aft"] = 1] = "Aft";
        CruiseShipPosition[CruiseShipPosition["Forward"] = 2] = "Forward";
        CruiseShipPosition[CruiseShipPosition["Midship"] = 3] = "Midship";
    })(CruiseShipPosition = EnumHelper.CruiseShipPosition || (EnumHelper.CruiseShipPosition = {}));
    var UserResolution;
    (function (UserResolution) {
        UserResolution[UserResolution["Mobile"] = 0] = "Mobile";
        UserResolution[UserResolution["Tablet"] = 1] = "Tablet";
        UserResolution[UserResolution["Desktop"] = 2] = "Desktop";
    })(UserResolution = EnumHelper.UserResolution || (EnumHelper.UserResolution = {}));
    var CruiseComponentsVersion;
    (function (CruiseComponentsVersion) {
        CruiseComponentsVersion[CruiseComponentsVersion["V1"] = 1] = "V1";
        CruiseComponentsVersion[CruiseComponentsVersion["V2"] = 2] = "V2";
    })(CruiseComponentsVersion = EnumHelper.CruiseComponentsVersion || (EnumHelper.CruiseComponentsVersion = {}));
})(EnumHelper || (EnumHelper = {}));


ï»¿/// <reference path="Formatters.js" />

/* ORDENAÃÃO ALFABÃTICA DAS PROTOTYPES. MANTENHAM! */

/* ***** ARRAY PROTOTYPES ****** */

Array.prototype.all = function (test) {
    var newArgs = Array.prototype.slice.call(arguments, 1);

    for (var i = 0, len = this.length; i < len; i++) {
        if (!test.apply(this[i], [this[i]].concat(newArgs)))
            return false;
    }

    return true;
};

Array.prototype.Add = Array.prototype.add = function (item) {
    this.push(item);
};

Array.prototype.AddRange = Array.prototype.addRange = function (items) {

    return items.reduce(function (poll, item) {
        poll.push(item);
        return poll;
    }, this);
};

Array.prototype.UpsertRange = Array.prototype.upsertRange = function (items) {

    return items.reduce(function (poll, item) {

        var existentItem = poll.first(function (po) { return po.Key == item.Key });

        if (existentItem)
            existentItem.Value = item.Value;
        else
            poll.push(item);

        return poll;
    }, this);
};

Array.prototype.any = function (test) {
    if (!arguments.length)
        return !!this.length;

    var args = Array.prototype.slice.call(arguments, 1);
    var functionTest = typeof test == "function" ? test : function (x) { return x == test; };

    for (var i = 0, len = this.length; i < len; i++)
        if (functionTest.apply(this[i], [this[i]].concat(args)))
            return true;

    return false;
};

Array.prototype.average = function () {
    return this.Sum() / this.length;
};

Array.prototype.binarySearch = function binarySearch(find, comparator) {
    var low = 0, high = this.length - 1, i, comparison;
    var ret = -1;
    while (low <= high) {
        i = parseInt((low + high) / 2, 10);
        comparison = comparator(this[i], find);
        if (comparison > 0)
            low = i + 1;
        else if (comparison < 0)
            high = i - 1;
        else {
            ret = i;
            break;
        }
    }
    if (ret < 0)
        ret = undefined;

    return ret;
};

Array.prototype.chunk = function (chunkSize) {
    var response = [];

    var copy = this;

    while (copy.length) {
        response.push(copy.take(chunkSize));
        copy = copy.skip(chunkSize);
    }

    return response;
};

Array.prototype.clearUndefined = function () {
    for (var i = 0; i < this.length; i++) {
        if (this[i] == undefined) {
            this.remove(i);
            i--;
        }
    }

    return false;
};

Array.prototype.clearEmptyString = function () {
    for (var i = 0; i < this.length; i++) {
        if (this[i] == "" || this[i] == null || this[i] == undefined) {
            this.remove(i);
            i--;
        }
    }

    return false;
};

Array.prototype.contains = function (value) {
    return $.inArray(value, this) > -1;
};

Array.prototype.count = function (test) {
    var count = 0;

    for (var i = 0, len = this.length; i < len; i++)
        if (test(this[i]))
            count++;

    return count;
};

Array.prototype.equals = function (array) {
    if (!array)
        return false;

    if (this.length != array.length)
        return false;

    for (var i = 0, l = this.length; i < l; i++) {
        if (this[i] instanceof Array && array[i] instanceof Array) {
            if (!this[i].equals(array[i]))
                return false;
        }
        else if (this[i] != array[i])
            return false;
    }

    return true;
};

Array.prototype.except = function (targetArray) {
    var newArray = [];

    if (targetArray && targetArray.length && this.length)
        for (var i = 0, l = this.length; i < l; i++)
            if (!targetArray.contains(this[i]))
                newArray.push(this[i]);

    return newArray;
};

Array.prototype.distinct = function (test) {
    var elements = {};
    var resp = [];

    if (!test)
        test = function (x) { return x; }

    for (var i = 0, len = this.length; i < len; i++) {
        var result = test(this[i]);
        if (!elements[result]) {
            elements[result] = true;
            resp.push(this[i])
        }
    }

    return resp;
};

Array.prototype.first = function (test) {

    var len = this.length;

    if (!test && len)
        return this[0];

    for (var i = 0; i < len; i++)
        if (test(this[i]))
            return this[i];

    return undefined;
};

if (Array.prototype.forEach == 'undefined')
    Array.prototype.forEach = function (exec) {
        if (!exec) return;

        for (var i = 0, len = this.length; i < len; i++)
            exec(this[i], i);
    };

Array.prototype.foreach = Array.prototype.forEach;

Array.prototype.groupBy = function (test) {
    if (!test) test = function (x) { return x; };

    var resp = {};

    for (var i = 0, len = this.length; i < len; i++) {
        var con = test(this[i]);

        if (con != undefined) {
            !resp[con] ? resp[con] = [this[i]] : resp[con].push(this[i]);
        }
    }

    return resp;
};

Array.prototype.groupByWithoutKey = function (test) {
    var resp = [];

    var grouped = this.groupBy(test);

    for (var i in grouped)
        if (grouped.hasOwnProperty(i))
            resp.push(grouped[i]);

    return resp;
};

Array.prototype.hasCount = function () {
    return this.length > 0;
};

Array.prototype.insert = function (index, item) {
    this.splice(index, 0, item);
}

var intersectionComparerWrapper = new (function () {
    var _this = this;
    this.item = {};
    this.comparer = function () { };
    this.exec = function (t) { return _this.comparer(_this.item, t); };
})();

Array.prototype.intersection = function (array2, comparer) {
    var intersec = [];
    comparer = comparer ? comparer : function (x, y) { return x == y; };

    if (!array2 || !array2.length)
        return intersec;

    intersectionComparerWrapper.comparer = comparer;
    for (var i = 0; i < this.length; i++) {
        intersectionComparerWrapper.item = this[i];
        if (array2.any(intersectionComparerWrapper.exec) && !intersec.any(this[i]))
            intersec.push(this[i]);
    }

    return intersec;
};

Array.prototype.isEmpty = function () {
    return this.length == 0;
};

Array.prototype.join = function (separator, selector) {

    var leng = this.length;
    var resp = "";

    if (leng) {
        selector = selector || function (x) { return x };
        resp = selector(this[0]);
        for (var i = 1; i < leng; i++)
            resp += separator + selector(this[i]);
    }

    return resp;
};

Array.prototype.last = function (test) {

    var thisLen = this.length;

    if (!test && thisLen)
        return this[this.length - 1];

    for (var i = thisLen - 1; i >= 0; i--)
        if (test(this[i]))
            return this[i];

    return undefined;
};

Array.prototype.max = function (test) {

    if (!test)
        test = function (x) { return x; };

    var maxValue = undefined;

    for (var i = 0; i < this.length; i++) {
        var iValue = test(this[i]);
        if (maxValue === undefined || iValue > maxValue)
            maxValue = iValue;
    }

    return maxValue;
};

Array.prototype.getItemByMax = function (test) {

    if (!test)
        test = function (x) { return x; };

    var maxValue = undefined;

    for (var i = 0; i < this.length; i++)
        if (!maxValue || test(this[i]) > test(maxValue))
            maxValue = this[i];

    return maxValue;
};

Array.prototype.min = function (test) {

    if (!test)
        test = function (x) { return x; };

    var minValue = undefined;

    for (var i = 0; i < this.length; i++) {
        var iValue = test(this[i]);
        if (minValue === undefined || iValue < minValue)
            minValue = iValue;
    }

    return minValue;
}

Array.prototype.getItemByMin = function (test) {
    if (!test)
        test = function (x) { return x; };

    var minValue = undefined;

    for (var i = 0, len = this.length; i < len; i++)
        if (!minValue || test(this[i]) < test(minValue))
            minValue = this[i];

    return minValue;
};

Array.prototype.mostCommon = function () {
    var count = 0, max = 0, num = 0, mode = 0;
    this.sort();
    this.ForEach(function (v) {

        if (num != v) {
            num = v;
            count = 1;
        } else {
            count++;
        }

        if (count > max) {
            max = count;
            mode = num;
        }
    });
    if (max == 1) { mode = false; }
    return mode;
};

Array.prototype.move = function (old_index, new_index) {
    if (new_index >= this.length) {
        var k = new_index - this.length;
        while ((k--) + 1) {
            this.push(undefined);
        }
    }
    this.splice(new_index, 0, this.splice(old_index, 1)[0]);
};

Array.prototype.orderBy = function () {
    function _simpleSortFunction(a, b) {
        return (a < b && -1) || (a > b && 1) || 0;
    }

    function _sortfunction(a, b) {
        for (var i = 1; a.length == b.length && i < a.length; i++) {
            var resp = _simpleSortFunction(a[i], b[i]);
            if (resp)
                return resp;
        }

        return 0;
    }

    if (this.length > 0) {

        var tests = arguments;

        if (!tests.length)
            tests = [function (x) { return x; }];

        var arrayToSort = this.select(function (o) {
            var resp = [o];

            for (var i = 0, len = tests.length; i < len; i++) {
                var value = tests[i](o);
                if (value && typeof (value) == 'string')
                    value = value.toLowerCase().removeDiacritics();
                else if (value && typeof (value) == 'number')
                    value = parseFloat(parseFloat(value).toFixed(2));
                resp.push(value);
            }

            return resp;
        });

        arrayToSort.sort(_sortfunction);

        for (var i = 0; i < arrayToSort.length; i++)
            this[i] = arrayToSort[i][0];
    }

    return this;
};

Array.prototype.getOrderedBy = function (test) {
    function _sortfunction(a, b) {
        if (a[1] < b[1])
            return -1;
        else if (a[1] == b[1])
            return 0;
        else
            return 1;
    }

    if (!test)
        test = function (x) { return x; };

    var arrayToSort = this.select(function (o) { return [o, test(o)] });

    arrayToSort.sort(_sortfunction);

    var orderedArray = [];

    for (var i = 0; i < arrayToSort.length; i++)
        orderedArray.push(arrayToSort[i][0]);

    return orderedArray;
};

Array.prototype.orderByDescending = function (test) {
    this.orderBy(test);
    this.reverse();

    return this;
};

Array.prototype.permute = function (maxLength) {

    maxLength = maxLength || 0;

    var usedChars = [], permArr = [];

    var permute = function (input) {
        var ch, chars = input.toString().split('');
        for (var i = 0; i < chars.length; i++) {
            ch = chars.splice(i, 1);
            usedChars.push(ch);
            !chars.length && (permArr[permArr.length] = usedChars.join(""));
            permute(chars.join(""));
            chars.splice(i, 0, ch);
            usedChars.pop();
        }
    }

    permute(this.join(""));

    permArr.orderBy();

    if (maxLength) {
        permArr = permArr.select(function (item) { return item.substring(0, maxLength); });
    }

    return permArr.distinct();
};

Array.prototype.remove = function (from, to) {
    var rest = this.slice((to || from) + 1 || this.length);
    this.length = from < 0 ? this.length + from : from;
    return this.push.apply(this, rest);
};

Array.prototype.removeItem = function (itemToRemove) {
    for (var j = 0; j < this.length; j++) {
        if (this[j] == itemToRemove) {
            this.splice(j, 1);
            j--;
        }
    }
}

Array.prototype.removeAll = function (test) {
    var newArray = [];

    if (test) {
        var newArgs = Array.prototype.slice.call(arguments, 1);
        var functionTest = typeof test == "function" ? test : function (x) { return x == test; };

        for (var i = 0; i < this.length; i++) {
            if (!functionTest.apply(this[i], [this[i]].concat(newArgs)))
                newArray.push(this[i]);
        }
    } else {
        newArray = this;
    }

    return newArray;
};

Array.prototype.removeAt = function (index) {
    var newArray = [];

    if (index != undefined && index != null) {
        for (var i = 0; i < this.length; i++) {
            if (i != index) {
                newArray.push(this[i]);
            }
        }
    }

    return newArray;
};

Array.prototype.select = function (selector) {
    var isFunction = typeof (selector) === 'function';

    var resp = [];

    for (var i = 0, len = this.length; i < len; i++) {
        var item = null;
        if (isFunction)
            item = selector(this[i], i);
        else
            item = this[i][selector];

        if (item != null)
            resp.push(item);
    }

    return resp;
};

Array.prototype.selectMany = function (selector) {
    var resp = [];

    for (var i = 0, len = this.length; i < len; i++)
        resp.addRange(selector(this[i], i));

    return resp;
};

Array.prototype.getRange = function (startIndex, length) {
    return this.slice(startIndex, startIndex + length);
};

Array.prototype.sum = function (func) {

    if (func == undefined)
        func = function (r) { return r; };

    var sumValues = 0;

    for (var i = 0; i < this.length; i++) {
        sumValues += func(this[i]);
    }

    return sumValues;
};

Array.prototype.toDictionary = function (test) {
    if (!test) test = function (x) { return x; };

    var resp = {};

    for (var i = 0, len = this.length; i < len; i++) {
        var con = test(this[i]);

        if (con != undefined)
            resp[con] = this[i];
    }

    return resp;
}

Array.prototype.toString = function () {
    return this.join("");
};

Array.prototype.where = function (test) {
    var resp = [];

    for (var i = 0, len = this.length; i < len; i++)
        if (test(this[i]))
            resp.push(this[i]);

    return resp;
};

Array.prototype.firstIndexOf = function (func) {

    var functionTest = typeof func == "function" ? func : function (x) { return x == func; };

    var resp = -1;
    for (var i = 0, len = this.length; i < len; i++) {
        if (functionTest(this[i])) {
            resp = i;
            break;
        }
    }

    return resp;

};

Array.prototype.lastIndexOf = function (func) {

    var functionTest = typeof func == "function" ? func : function (x) { return x == func; };

    var resp = -1;
    for (var i = 0, len = this.length; i < len; i++)
        if (functionTest(this[i]))
            resp = i;

    return resp;

};

Array.prototype.take = function (i) {
    return this.slice(0, i);
};

Array.prototype.skip = function (i) {
    return this.slice(i, this.length);
};

if (!Array.prototype.push) {
    Array.prototype.push = function (x) {
        this[this.length] = x;
        return true;
    }
};

if (!Array.prototype.pop) {
    Array.prototype.pop = function () {
        var response = this[this.length - 1];
        this.length--;
        return response;
    }
};

if (!Array.prototype.indexOf) {
    Array.prototype.indexOf = function (obj, start) {
        for (var i = (start || 0), j = this.length; i < j; i++) {
            if (this[i] === obj) { return i; }
        }
        return -1;
    }
};

if (!Array.prototype.hasCount) {
    Array.prototype.hasCount = function () {
        return (this && this.length && this.length > 0);
    };
}

/* ***** DATE PROTOTYPES ******** */

var dateFormat = function () {
    var token = /d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,
		timezone = /\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,
		timezoneClip = /[^-+\dA-Z]/g,
		pad = function (val, len) {
		    val = String(val);
		    len = len || 2;
		    while (val.length < len) val = "0" + val;
		    return val;
		};

    // Regexes and supporting functions are cached through closure
    return function (date, mask, utc) {
        var dF = dateFormat;

        // You can't provide utc if you skip other args (use the "UTC:" mask prefix)
        if (arguments.length == 1 && Object.prototype.toString.call(date) == "[object String]" && !/\d/.test(date)) {
            mask = date;
            date = undefined;
        }

        // Passing date through Date applies Date.parse, if necessary
        date = date ? new Date(date) : new Date;
        if (isNaN(date)) throw SyntaxError("invalid date");

        mask = String(dF.masks[mask] || mask || dF.masks["default"]);

        // Allow setting the utc argument via the mask
        if (mask.slice(0, 4) == "UTC:") {
            mask = mask.slice(4);
            utc = true;
        }

        var _ = utc ? "getUTC" : "get",
			d = date[_ + "Date"](),
			D = date[_ + "Day"](),
			m = date[_ + "Month"](),
			y = date[_ + "FullYear"](),
			H = date[_ + "Hours"](),
			M = date[_ + "Minutes"](),
			s = date[_ + "Seconds"](),
			L = date[_ + "Milliseconds"](),
			o = utc ? 0 : date.getTimezoneOffset(),
			flags = {
			    d: d,
			    dd: pad(d),
			    ddd: dF.i18n.dayNames[D],
			    dddd: dF.i18n.dayNames[D + 7],
			    m: m + 1,
			    mm: pad(m + 1),
			    mmm: dF.i18n.monthNames[m],
			    mmmm: dF.i18n.monthNames[m + 12],
			    yy: String(y).slice(2),
			    yyyy: y,
			    h: H % 12 || 12,
			    hh: pad(H % 12 || 12),
			    H: H,
			    HH: pad(H),
			    M: M,
			    MM: pad(M),
			    s: s,
			    ss: pad(s),
			    l: pad(L, 3),
			    L: pad(L > 99 ? Math.round(L / 10) : L),
			    t: H < 12 ? "a" : "p",
			    tt: H < 12 ? "am" : "pm",
			    T: H < 12 ? "A" : "P",
			    TT: H < 12 ? "AM" : "PM",
			    Z: utc ? "UTC" : (String(date).match(timezone) || [""]).pop().replace(timezoneClip, ""),
			    o: (o > 0 ? "-" : "+") + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4),
			    S: ["th", "st", "nd", "rd"][d % 10 > 3 ? 0 : (d % 100 - d % 10 != 10) * d % 10]
			};

        return mask.replace(token, function ($0) {
            return $0 in flags ? flags[$0] : $0.slice(1, $0.length - 1);
        });
    };
};

// Some common format strings
dateFormat.masks = {
    "default": "ddd mmm dd yyyy HH:MM:ss",
    shortDate: "m/d/yy",
    commonDate: "mm/dd/yyyy",
    mediumDate: "mmm d, yyyy",
    longDate: "mmmm d, yyyy",
    fullDate: "dddd, mmmm d, yyyy",
    shortTime: "h:MM TT",
    mediumTime: "h:MM:ss TT",
    longTime: "h:MM:ss TT Z",
    isoDate: "yyyy-mm-dd",
    isoTime: "HH:MM:ss",
    isoDateTime: "yyyy-mm-dd'T'HH:MM:ss",
    isoUtcDateTime: "UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"
};

// Internationalization strings
dateFormat.i18n = {
    dayNames: [
		"dom", "seg", "ter", "qua", "qui", "sex", "sab",
		"Domingo", "Segunda", "TerÃ§a", "Quarta", "Quinta", "Sexta", "Sabado"
    ],
    monthNames: [
		"Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec",
		"Janeiro", "Fevereiro", "MarÃ§o", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"
    ]
};

numberOfDays = function (month, year) {
    if ((month < 8 && month % 2 == 1) || (month > 7 && month % 2 == 0)) return 31;
    if (month != 2) return 30;
    if (year % 4 == 0) return 29;
    return 28;
}

Date.prototype.dateDiff = function (strInterval, dtEnd) {
    var dtStart = this;
    switch (strInterval) {
        case 's': return Math.round((dtEnd - dtStart) / 1000);
        case 'm': return Math.round((dtEnd - dtStart) / 60000);
        case 'h': return Math.round((dtEnd - dtStart) / 3600000);
        case 'd': return Math.round((dtEnd - dtStart) / 86400000);
        case 'w': return Math.round((dtEnd - dtStart) / (86400000 * 7));
        case 'm': return (dtEnd.getMonth() + 1) + ((dtEnd.getFullYear() - dtStart.getFullYear()) * 12) - (dtStart.getMonth() + 1);
        case 'y': return dtEnd.getFullYear() - dtStart.getFullYear();
    }
}

Date.prototype.isSameDate = function (otherDate) {
    return this.getDate() == otherDate.getDate()
        && this.getMonth() == otherDate.getMonth()
        && this.getFullYear() == otherDate.getFullYear();
}

Date.prototype.addDays = function (days) {

    if (isNaN(days))
        return this;
    else if (typeof (days) == 'string')
        days = parseInt(days, 10);

    var day = this.getDate() + days;
    var month = this.getMonth() + 1;
    var year = this.getFullYear();

    var _numberOfDays = function (month, year) {
        if ((month < 8 && month % 2 == 1) || (month > 7 && month % 2 == 0)) return 31;
        if (month != 2) return 30;
        if (year % 4 == 0) return 29;
        return 28;
    }

    var numberOfDays = _numberOfDays(month, year);

    while (day > numberOfDays) {
        day -= _numberOfDays(month, year);
        month++;

        if (month > 12) {
            month = 1;
            year++;
        }
    }


    return (new Date(year, (month - 1), day, this.getHours()));
}

Date.prototype.getDaysInMonth = function () {
    var _numberOfDays = function (month, year) {
        if ((month < 8 && month % 2 == 1) || (month > 7 && month % 2 == 0)) return 31;
        if (month != 2) return 30;
        if (year % 4 == 0) return 29;
        return 28;
    }

    return _numberOfDays(this.getMonth() + 1, this.getFullYear());
}

Date.prototype.addDaysSafe = function (days) {

    if (isNaN(days))
        return this;

    if (typeof (days) == 'string')
        days = parseInt(days, 10);

    this.setDate(this.getDate() + days);

    return this;
};

Date.prototype.addMinutes = function (minutes) {
    return new Date(this.getTime() + minutes * 60000);
};

Date.prototype.decreaseMinutes = function (minutes) {
    return new Date(this.getTime() - minutes * 60000);
};

Date.prototype.addYears = function (years) {
    return (new Date(this.getFullYear() + years, this.getMonth(), this.getDate(), this.getHours()));
}

Date.prototype.dayBreaks = function (date) {
    var days = this.completeUntilInDays(date);

    var exactly = parseInt(days);

    if ((this.getHours() + (24 * (days - exactly))) > 24)
        exactly++;

    return exactly;
};

Date.prototype.format = function (mask, utc) {
    return dateFormat(this, mask, utc);
};

Date.prototype.completeUntilInDays = function (date) {
    return (date - this) / (24 * 60 * 60 * 1000);
}

Date.prototype.untilInDays = function (date) {
    return this.completeUntilInDays(date).toFixed(0);
};

Date.prototype.untilInYears = function (date) {
    date = date || new Date();

    var age = date.getFullYear() - this.getFullYear();
    var m = date.getMonth() - this.getMonth();

    if (m < 0 || (m === 0 && date.getDate() < this.getDate()))
        age--;

    return age;
};

Date.prototype.toDateValues = function () {
    return { Year: this.getFullYear(), Month: this.getMonth() + 1, Day: this.getDate(), Hour: this.getHours(), Minutes: this.getMinutes(), Seconds: this.getSeconds(), isValid: true, DayOfWeek: this.getDay() };
}

Date.prototype.isAdult = function () {
    var TwelveYearsAgo = new Date().addYears(-12);

    if (TwelveYearsAgo.untilInDays(this) < 0)
        return true;
    else
        return false;
}

Date.prototype.isChild = function (hasInfant) {
    var TwelveYearsAgo = new Date().addYears(-12);
    var TwoYearsAgo = new Date().addYears(-2);

    var ret = false;

    if (hasInfant)
        if (TwoYearsAgo.untilInDays(this) < 0)
            ret = true;

    ret = TwelveYearsAgo.untilInDays(this) >= 0;

    return ret;
}

Date.prototype.isInfant = function () {
    var TwoYearsAgo = new Date().addYears(-2);

    return this <= TwoYearsAgo;
};

Date.prototype.min = function (secondDate) {
    if (this <= secondDate)
        return this;

    return secondDate;
};

Date.prototype.max = function (secondDate) {
    if (this >= secondDate)
        return this;

    return secondDate;
};


/* ***** DATE VALUES PROTOTYPES ****** */


/* ***** NUMBER PROTOTYPES ****** */
Number.prototype.calculateFlightDuration = function () {
    var res = "";
    var hs = "";
    var min = this;

    if (min > 60) {
        hs = parseInt(min / 60);
        min = min % 60;

        res += hs + (hs > 1 ? " hs " : " h ");

        res += (min > 9 ? "" : "0") + min + " min";
    }
    else {
        res = min + " min";
    }

    return res;
};

Number.prototype.containedIn = function (arr) {
    if (!$.isArray(arr)) {
        for (var i = 0; i < arguments.length; i++)
            if (arguments[i] == this)
                return true;

        return false;
    }
    else
        return arr.any(this);
};

Number.prototype.formatCurrency = function () {

    if (formatter)
        return formatter.currency(this);

    var i = parseFloat(this);

    if (isNaN(i)) { i = 0.00; }
    var minus = '';
    if (i < 0) { minus = '-'; }
    i = Math.abs(i);
    i = parseInt((i + .005) * 100);
    i = i / 100;
    var str = new String(i);
    var indexOfDot = str.indexOf('.');
    if (indexOfDot < 0) { str += '.00'; }
    if (indexOfDot == (str.length - 2)) { str += '0'; }
    str = minus + str;

    return str.replace(".", ",");
};

Number.prototype.formatMinutesInHourMinuteLong = function () {

    if (formatter)
        return formatter.timeValuesLong(this);

    var rest = this % 60;
    var hours = (this - rest) / 60;

    var hoursString = hours.toString();
    var minutesString = rest.toString();

    return (hours > 0 ? hoursString + (hours > 1 ? " horas" : " hora") : "") + (rest > 0 ? minutesString + (rest > 1 ? " minutos" : " minuto") : "");
};

Number.prototype.formatMinutesInHourMinuteShort = function () {
    var rest = this % 60;
    var hours = (this - rest) / 60;

    var hoursString = hours.toString();
    var minutesString = Math.round(rest).toString();

    return (hours < 10 ? "0" : "") + hoursString + ":" + (rest < 10 ? "0" : "") + minutesString;
};

Number.prototype.formatTimeSlider = function () {
    var hr = Math.round(this).toString();
    var res = "";
    var Hour;
    var Minute;

    if (hr.length == 4) {
        Hour = hr.substr(0, 2);
        Minute = hr.substr(2, 2);
    }
    else if (hr.length == 3) {
        Hour = hr.substr(0, 1);
        Minute = hr.substr(1, 2);
    }
    else if (hr.length == 2) {
        Hour = 0;
        Minute = hr;
    }

    if (Hour > 24)
        Hour = 24;

    if (Minute > 59)
        Minute = 59;

    if (isNaN(Hour))
        Hour = 0;

    if (isNaN(Minute))
        Minute = 0;

    return Hour + ":" + Minute;
};

Number.prototype.normalize = function () {
    return parseFloat(parseFloat(this.toFixed(3)).toFixed(2));
};

Number.prototype.normalizeUp = function () {
    var stringNumber = this.toString().split(".")[1];

    if (stringNumber && stringNumber.length > 2) {
        if (parseInt(stringNumber.charAt(2)) == 5)
            return parseFloat((this + 0.005).toFixed(2));
        else
            return parseFloat(this.toFixed(2));
    }
    else
        return parseFloat(this);
};

Number.prototype.integerPart = function () {
    return '' + ((this < 0) ? Math.ceil(this) : Math.floor(this));
}

Number.prototype.precision = function () {
    var value = this.toString();
    var precision = 0;

    if (value.split('.').length > 1) {
        var decimalPart = value.split('.')[1];

        precision = decimalPart.length;
    }

    return precision;
}



/* ***** OBJECT PROTOTYPES ******* */
//if (false || !!document.documentMode) {
//    Object.prototype.assign = function (target, origin) {
//        var objs = [{ Name: "ABC" }, { Roll: 123 }],
//         result = objs.reduce(function (r, o) {
//             Object.keys(o).forEach(function (k) {
//                 r[k] = o[k];
//             });
//             return r;
//         }, {});

//        return result;
//    };
//}

if (!Object.assign) {
    Object.defineProperty(Object, 'assign', {
        enumerable: false,
        configurable: true,
        writable: true,
        value: function (target) {
            'use strict';
            if (target === undefined || target === null) {
                throw new TypeError('Cannot convert first argument to object');
            }

            var to = Object(target);
            for (var i = 1; i < arguments.length; i++) {
                var nextSource = arguments[i];
                if (nextSource === undefined || nextSource === null) {
                    continue;
                }
                nextSource = Object(nextSource);

                var keysArray = Object.keys(Object(nextSource));
                for (var nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {
                    var nextKey = keysArray[nextIndex];
                    var desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);
                    if (desc !== undefined && desc.enumerable) {
                        to[nextKey] = nextSource[nextKey];
                    }
                }
            }
            return to;
        }
    });
}

if (typeof Object.keys == 'undefined') {
    Object.keys = function (obj) {
        var retKeys = [];
        for (p in obj) {
            retKeys.push(p);
        }
        return retKeys;
    }
}

/* ***** STRING PROTOTYPES ******* */
String.prototype.adjustIATA = function () {
    return this.replaceAll("---", ")").replaceAll("--", "(");
};

String.prototype.capitalize = function (maintaingRestOf) {
    return this.replace(/\S+/g, function (a) {
        return a.charAt(0).toUpperCase() + (maintaingRestOf ? a.slice(1) : a.slice(1).toLowerCase());
    });
};

String.prototype.contains = function (str) {
    return str ? this.indexOf(str) != -1 : false;
};

String.prototype.endsWith = function (str) {
    return (this.match(str + "$") == str);
};

String.prototype.format = function () {
    var formatted = this;

    var values = [];

    if (arguments.length > 0 && arguments[0].length)
        arguments = arguments[0];

    for (var i = 0; i < arguments.length; i++) {
        var regexp = new RegExp('\\{' + i + '\\}', 'gi');
        formatted = formatted.replace(regexp, arguments[i]);
    }
    return formatted;
};

String.prototype.justDigits = function () {
    for (var i = 0, len = this.length; i < len; i++) {
        var char = this.charAt(i);
        if (!(char >= "0" && char <= "9"))
            return false;
    }

    return true;
};

String.prototype.isIn = function (arr) {
    return arr && this.length && arr.any(this);
};

String.prototype.isCNPJ = function () {
    var cnpj = "";

    for (iCont = 0; iCont < this.length; iCont++) {
        if (this.charAt(iCont) != '.' && this.charAt(iCont) != '-' && this.charAt(iCont) != '/') {
            cnpj += this.charAt(iCont);
        }
    }

    cnpj = cnpj.trim().replace(/[^0-9]/g, '');

    if (cnpj == "" || cnpj.length < 14) {
        return false;
    }

    var numeros, digitos, soma, i, resultado, pos, tamanho, digitos_iguais;
    digitos_iguais = 1;
    if (cnpj.length < 14 && cnpj.length < 15)
        return false;
    for (i = 0; i < cnpj.length - 1; i++)
        if (cnpj.charAt(i) != cnpj.charAt(i + 1)) {
            digitos_iguais = 0;
            break;
        }
    if (!digitos_iguais) {
        tamanho = cnpj.length - 2
        numeros = cnpj.substring(0, tamanho);
        digitos = cnpj.substring(tamanho);
        soma = 0;
        pos = tamanho - 7;
        for (i = tamanho; i >= 1; i--) {
            soma += numeros.charAt(tamanho - i) * pos--;
            if (pos < 2)
                pos = 9;
        }
        resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;
        if (resultado != digitos.charAt(0))
            return false;
        tamanho = tamanho + 1;
        numeros = cnpj.substring(0, tamanho);
        soma = 0;
        pos = tamanho - 7;
        for (i = tamanho; i >= 1; i--) {
            soma += numeros.charAt(tamanho - i) * pos--;
            if (pos < 2)
                pos = 9;
        }
        resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;
        if (resultado != digitos.charAt(1))
            return false;
        return true;
    }
    else
        return false;
}

String.prototype.isCPF = function () {

    var cpf = "";

    for (iCont = 0; iCont < this.length; iCont++) {
        if (this.charAt(iCont) != '.' && this.charAt(iCont) != '-' && this.charAt(iCont) != '/') {
            cpf += this.charAt(iCont);
        }
    }

    cpf = cpf.trim().replace(/[^0-9]/g, '');

    if (cpf == "") {
        return false;
    }
    if (((cpf.length == 11) && (cpf == 11111111111) || (cpf == 22222222222) || (cpf == 33333333333) || (cpf == 44444444444) || (cpf == 55555555555) || (cpf == 66666666666) || (cpf == 77777777777) || (cpf == 88888888888) || (cpf == 99999999999) || (cpf == 00000000000))) {
        return false;
    }

    if (!((cpf.length == 11) || (cpf.length == 14))) {
        return false;
    }

    var checkOK = "0123456789";
    var checkStr = cpf;
    var allValid = true;
    var allNum = "";
    for (i = 0; i < checkStr.length; i++) {
        ch = checkStr.charAt(i);
        for (j = 0; j < checkOK.length; j++)
            if (ch == checkOK.charAt(j))
                break;
        if (j == checkOK.length) {
            allValid = false;
            break;
        }
        allNum += ch;
    }

    if (!allValid) {
        return (false);
    }

    var chkVal = allNum;
    var prsVal = parseFloat(allNum);
    if (chkVal != "" && !(prsVal > "0")) {
        return (false);
    }

    if (cpf.length == 11) {
        var tot = 0;

        for (i = 2; i <= 10; i++)
            tot += i * parseFloat(checkStr.charAt(10 - i));

        if ((tot * 10 % 11 % 10) != parseFloat(checkStr.charAt(9))) {
            return (false);
        }

        tot = 0;

        for (i = 2; i <= 11; i++)
            tot += i * parseFloat(checkStr.charAt(11 - i));

        if ((tot * 10 % 11 % 10) != parseFloat(checkStr.charAt(10))) {
            return (false);
        }
    }
    else {
        var tot = 0;
        var peso = 2;

        for (i = 0; i <= 11; i++) {
            tot += peso * parseFloat(checkStr.charAt(11 - i));
            peso++;
            if (peso == 10) {
                peso = 2;
            }
        }

        if ((tot * 10 % 11 % 10) != parseFloat(checkStr.charAt(12))) {
            return (false);
        }

        tot = 0;
        peso = 2;

        for (i = 0; i <= 12; i++) {
            tot += peso * parseFloat(checkStr.charAt(12 - i));
            peso++;
            if (peso == 10) {
                peso = 2;
            }
        }

        if ((tot * 10 % 11 % 10) != parseFloat(checkStr.charAt(13))) {
            return (false);
        }
    }
    return (true);

};

String.prototype.isDateYY = function () {
    var valid = true;

    var regex = /^((0[1-9]|[12]\d)\/(0[1-9]|1[0-2])|30\/(0[13-9]|1[0-2])|31\/(0[13578]|1[02]))\/\d{2}$/; /*29/02/10*/

    var values = this.split("/");

    if (values.length == 3) {
        var day = values[0];
        var month = values[1];
        var year = values[2];

        /*Valida ano Bissexto*/
        if (month == 2)
            if (!((year % 4 == 0) || (year % 100 == 0) || (year % 400 == 0)))
                if (day == 29)
                    valid = false;
    }

    return valid && regex.test(this);
};

String.prototype.isDate = function () {
    var valid = true;

    var regexNormal = formatter.dateFormatRegularExpression('pt-br');/*29/02/2010*/
    var regexInverted = formatter.dateFormatRegularExpression('en-us');/*08/17/2015*/

    var isInvertDayByMonth = formatter.culture.contains("en");
    var regex = (isInvertDayByMonth) ? regexInverted : regexNormal;

    var values = this.split("/");

    if (values.length == 3) {
        var day = (isInvertDayByMonth) ? values[1] : values[0];
        var month = (isInvertDayByMonth) ? values[0] : values[1];
        var year = values[2];

        /*Valida ano Bissexto*/
        if (month == 2)
            if (!((year % 4 == 0) || (year % 100 == 0) || (year % 400 == 0)))
                if (day == 29)
                    valid = false;
    }

    return valid && regex.test(this);
};

String.prototype.isDNI = function () {

    // ?? checks if the code is the right length, needs to be 8 chars long, or 9 if there is an extra W
    if (this.length == 9 || this.length == 10) {

        var letter = this.charAt(this.length - 1).toUpperCase();

        try {
            var numbers = parseInt(this.substring(0, 8), 10);

            var modulus = numbers % 23;

            return letter == ["T", "R", "W", "A", "G", "M", "Y", "F", "P", "D", "X", "B", "N", "J", "Z", "S", "Q", "V", "H", "L", "C", "K", "E"][modulus];
        }
        catch (err) {
            return false;
        }
    }

    return false;
}

String.prototype.isEmail = function () {
    var emailDetector = new RegExp(/^[\d\w_.+-]+@([\d\w_-]+\.){1,}[\w\d]+$/);
    return emailDetector.test(this);
};

String.prototype.isAlpha = function () {
    var alphaDetect = new RegExp(/[^A-Z a-z]/);
    return !alphaDetect.test(this);
};

String.prototype.isAlphaWihtAccentuation = function () {
    var alphaDetect = new RegExp(/[^a-zA-ZÃ¢ÃÃ£ÃÃ¡ÃÃ ÃÃªÃÃ©ÃÃ¨ÃÃ­ÃÃ¬ÃÃ®ÃÃ´ÃÃµÃÃ³ÃÃ²ÃÃºÃÃ¹ÃÃ»ÃÃ§Ã\s]/);
    return !alphaDetect.test(this);
};

String.prototype.isAlphaWihtAccentuationOrNumber = function () {
    var alphaDetect = new RegExp(/[^a-zA-Z0-9Ã¢ÃÃ£ÃÃ¡ÃÃ ÃÃªÃÃ©ÃÃ¨ÃÃ­ÃÃ¬ÃÃ®ÃÃ´ÃÃµÃÃ³ÃÃ²ÃÃºÃÃ¹ÃÃ»ÃÃ§Ã\s]/);
    return !alphaDetect.test(this);
};

String.prototype.isAlphaWihtAccentuationOrNumberOrPoint = function () {
    var alphaDetect = new RegExp(/[^a-zA-Z0-9Ã¢ÃÃ£ÃÃ¡ÃÃ ÃÃªÃÃ©ÃÃ¨ÃÃ­ÃÃ¬ÃÃ®ÃÃ´ÃÃµÃÃ³ÃÃ²ÃÃºÃÃ¹ÃÃ»ÃÃ§Ã.,\s]/);
    return !alphaDetect.test(this);
};

String.prototype.isEmpty = function () {
    return this.length == 0;
};

String.prototype.isNumber = function () {
    var regex = /^\d+$/;

    return regex.test(this);
};

String.prototype.isPassword = function () {
    var regex = /(?=^.{8,}$)(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[~!@#$%^&*()_\-+=\.<>{}\[\];:,\\/|])(?!.*\s).*$/;

    return regex.test(this);
};

String.prototype.isWeakPassword = function () {
    var validWeakPassword = new RegExp(/^(.^|[\S]){4,8}$/);
    return validWeakPassword.test(this);
};

String.prototype.isPhone = function (culture) {
    var regex = {
        //'pt-br': /^(\d{4}|\d{5})-\d{4}$/,
        'pt-br': /^((\d{4}|\d{5})-\d{4})|(\d{8}|\d{9})$/,
        'en-us': /^(\d{4}|\d{5})\d{4}$/,
        'es-ve': /^[2-9]{3}-[0-9]{2}-[2-9]{2}$/
    };

    return regex[culture && culture.trim().length > 0 ? culture.toLowerCase() : 'pt-br'].test(this);
};

String.prototype.isMonth = function () {
    var regex = /^(0?[1-9]|1[0-2])$/;

    return regex.test(this);
};

String.prototype.isCompletePhone = function (culture) {
    var regex = {
        'pt-br': /^\(10|[1-9][1-9]\) ([2-9][0-9]{4}|[2-9][0-9]{3})-([0-9]{4}|[0-9]{5})$/,
        'en-us': /^\(10|[1-9][1-9]\) ([2-9][0-9]{4}|[2-9][0-9]{3})-([0-9]{4}|[0-9]{5})$/,
        'es-ve': /^\([0-9]{3}\) [0-9]{3}-[0-9]{2}-[0-9]{2}$/
    };

    return regex[culture && culture.trim().length > 0 ? culture.toLowerCase() : 'pt-br'].test(this);
};

String.prototype.isNotNullOrWhiteSpace = function () {
    var stringToCheck = this;

    if (stringToCheck != undefined && typeof stringToCheck === 'string') {
        var trimmedString = stringToCheck.trim();

        if (trimmedString.length > 0) {
            return trimmedString.replace(' ', '').length > 0;
        }
    }

    return false;
};

//Ex: 2019-01-01
String.prototype.isISODate = function () {
    var stringToValidate = this;
    var isStringValid = stringToValidate.isNotNullOrWhiteSpace();
    var stringMatchLength = isStringValid && stringToValidate.length == 10;

    if (stringMatchLength) {
        var splittedStr = stringToValidate.trim().split('-');

        if (splittedStr.length == 3) {
            var date = new Date(splittedStr[0], splittedStr[1], splittedStr[2]);

            return date != undefined && date.Year != undefined;
        }
    }

    return false;
};

String.prototype.hashCode = function () {
    var value = this.toString();
    var hash = 0;
    if (value.length == 0) return hash;

    for (i = 0; i < value.length; i++) {
        char = value.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash = hash & hash; // Convert to 32bit integer
    }
    return hash;
}

String.prototype.precision = function () {
    var value = this.toString();
    var precision = 0;

    var splitted = this.split('.');

    if (splitted.length > 1) {
        precision = splitted[1].length;
    }

    return precision;
}

String.prototype.toJquery = function () {
    return $ && $(this.toString()) || this.toString();
};

String.prototype.leftTrim = function () {
    var str = this;
    l = new Number(str.length);
    if (l > 0) {
        while (str.charAt(0) == " " || str.charAt(0) == "\t")
            str = str.substr(1, l - 1);
    }

    return str;
};

String.prototype.toValidNumberFormat = function () {
    var value = this;
    if (isNaN(value)) {
        // Vai cair aqui se for "," como separador de milhar e "." como separador de centavos ex: 1,000.00
        if (value.contains(',') && value.indexOf(',') < value.indexOf('.'))
        {
            value = value.toString().replaceAll(',', '');
        }
        else
        {
            value = value.toString().replaceAll('.', '');
            value = value.replaceAll(',', '.');
        }

        if (isNaN(value))
            value = "NaN";
    }

    return value;
};

String.prototype.toTimeValues = function () {
    var values = this.split(':');

    if (values.length < 2)
        return undefined;

    var timeValues = {
        Hour: values[0],
        Minutes: values[1]
    };

    return timeValues;
};

String.prototype.normalize = function () {
    return this.replaceAll(' ', '').removeDiacritics().toLowerCase();
};

String.prototype.normalizedContains = function (str) {
    return this.length && str.length && this.normalize().contains(str.normalize());
};

String.prototype.normalizedEquals = function (str) {
    return this.length && str && str.length && this.normalize() == str.normalize();
};

String.prototype.removeDiacritics = function () {
    var Acentos = "Ã¡Ã Ã£Ã¢Ã¢ÃÃÃÃÃ©ÃªÃÃÃ­ÃÃ³ÃµÃ´ÃÃÃÃºÃ¼ÃÃÃ§ÃabcdefghijklmnopqrstuvxwyzABCDEFGHIJKLMNOPQRSTUVXWYZÃ±Ã²Ã®Ã";
    var Traducao = "aaaaaAAAAeeEEiIoooOOOuuUUcCabcdefghijklmnopqrstuvxwyzABCDEFGHIJKLMNOPQRSTUVXWYZnoiI";
    var Posic, Carac;
    var TempLog = "";
    var value = this;

    for (var i = 0, len = this.length; i < len; i++) {

        Carac = value.charAt(i);
        Posic = Acentos.indexOf(Carac);

        TempLog += Posic > -1 ? Traducao.charAt(Posic) : Carac;
    }

    return TempLog;
}

String.prototype.removeSpecialCharacter = function () {
    return this.replace(/[^A-Z0-9a-z]/gim, '');
};

String.prototype.replaceAll = function (find, replace) {
    if (!replace)
        replace = "";

    if (find instanceof RegExp)
        return this.replace(find, replace);
    else
        return this.replace(new RegExp(find.replace(/[.*+\-?^${}()|[\]\\]/g, '\\$&'), 'g'), replace);
};

String.prototype.reverse = function () {
    var str = "";

    for (var i = this.length - 1; i >= 0; i--)
        str += this.charAt(i);

    return str;
};

String.prototype.rightTrim = function () {
    var str = this;
    l = new Number(str.length);
    if (l > 0) {
        while (str.charAt(l - 1) == " " || str.charAt(l - 1) == "\t") {
            str = str.substr(0, l - 1);
            l = str.length;
        }
    }

    return str;
};

String.prototype.startsWith = function (str) {
    return this.indexOf(str) == 0;
};

String.prototype.trim = function () {
    return (this == undefined || this == null) ? "" : this.replace(/^\s+|\s+$/g, "");
};


String.prototype.toDateValues = function (language) {
    var whiteSpaceIndex = this.indexOf(' ');

    var splitted = [];

    var separator = this.indexOf("-") > -1 ? "-" : "/";

    if (whiteSpaceIndex == -1)
        splitted = this.split(separator);
    else
        splitted = this.substr(0, whiteSpaceIndex).split(separator);

    var firstValue = splitted[0];
    var secondValue = splitted[1];
    var thirdValue = splitted[2];
    var globalLanguage = (Global && Global.Culture) ? Global.Culture.substr(0, 2) : "pt";
    var isInvertedDayByMonth = ((language && language.toLowerCase().contains("en")) || (!language && (globalLanguage.toLowerCase().contains("en"))));

    var date = {};
    if (Global && Global.Culture)
        date.Culture = Global.Culture;

    String.prototype.parseDate(date, whiteSpaceIndex, splitted, firstValue, secondValue, thirdValue, isInvertedDayByMonth);

    if (whiteSpaceIndex >= 0) {
        var hourPart = this.substr(whiteSpaceIndex, this.length - 1).split(":");

        if (hourPart.length > 1)
            String.prototype.parseDateTime(date, hourPart[0], hourPart[1], hourPart[2]);
    }

    return date;
};

String.prototype.parseDate = function (date, whiteSpaceIndex, splitted, firstValue, secondValue, thirdValue, isInvertedDayByMonth) {
    if (splitted.length == 3 && !(isNaN(parseInt(thirdValue)) && isNaN(parseInt(secondValue)) && isNaN(parseInt(firstValue)))) {
        var day = (isInvertedDayByMonth) ? parseInt(secondValue) : parseInt(firstValue);
        var month = (isInvertedDayByMonth) ? parseInt(firstValue) : parseInt(secondValue);
        var year = parseInt(thirdValue);

        var isValid = !((day > 31 || day < 0) || (month < 0 || month > 12) || (month == 2 && day > 30));

        date.Year = year;
        date.Month = month;
        date.Day = day;
        date.isValid = isValid;
    }
    else {
        date.Year = 1;
        date.Month = 1;
        date.Day = 1;
        date.isValid = false;
    }
};

String.prototype.parseDateTime = function (date, firstValue, secondValue, thirdValue) {
    if (isNaN(parseInt(secondValue)))
        secondValue = "0";

    if (isNaN(parseInt(firstValue)))
        firstValue = "0";

    if (isNaN(parseInt(thirdValue)))
        thirdValue = "0";

    var hour = parseInt(firstValue);
    var minutes = parseInt(secondValue);
    var seconds = parseInt(thirdValue);

    var isValid = hour > -1 && hour < 24 && minutes < 60 && minutes > -1;

    date.Minutes = minutes;
    date.Hour = hour;
    date.Seconds = seconds
    date.isValid = (typeof (date.isValid) == 'undefined' || date.isValid) && isValid;
};

String.prototype.toDateTime = function () {
    var splitted = this.split("/");
    var date = new Date();

    if (splitted.length == 3 && !(isNaN(parseInt(splitted[2])) && isNaN(parseInt(splitted[1])) && isNaN(parseInt(splitted[0])))) {
        date = new Date(splitted[2], splitted[1] - 1, splitted[0], 0, 0, 0, 0);
    }

    return date;
};

String.prototype.toArray = function () {
    var arr = [];

    for (var i = 0; i < this.length; i++)
        arr.push(this[i]);

    return arr;
};


//Funcao auxiliar para funcionamento do padStart no Internet Explorer
// https://github.com/uxitten/polyfill/blob/master/string.polyfill.js
// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/padStart
if (!String.prototype.padStart) {
    String.prototype.padStart = function padStart(targetLength, padString) {
        targetLength = targetLength >> 0; //truncate if number or convert non-number to 0;
        padString = String((typeof padString !== 'undefined' ? padString : ' '));
        if (this.length > targetLength) {
            return String(this);
        }
        else {
            targetLength = targetLength - this.length;
            if (targetLength > padString.length) {
                padString += padString.repeat(targetLength / padString.length); //append to original to ensure we are longer than needed
            }
            return padString.slice(0, targetLength) + String(this);
        }
    };
};

(function ($) {
    $.fn.getSelector = function () {
        var selector = $(this).parents()
                .map(function () { return this.tagName; })
        .get().reverse().join(" ");

        if (selector) {
            selector += " " + $(this)[0].nodeName;
        }

        var id = $(this).attr("id");
        if (id) {
            selector += "#" + id;
        }

        var classNames = $(this).attr("class");
        if (classNames) {
            selector += "." + $.trim(classNames).replace(/\s/gi, ".");
        }

        return selector;
    }



    $.fn.enableOrDisable = function () {
        var enable = arguments[0];

        if (enable)
            this.enable();
        else
            this.disable();
    }

    $.fn.enable = function () {
        return this.each(function () {
            $(this).removeAttr('disabled').removeClass("disable");
        });
    }

    $.fn.disable = function () {
        return this.each(function () {
            $(this).attr('disabled', 'disabled').addClass("disable");
        });
    }

    $.fn.getAttributes = function () {
        var _this = this;
        var attributes = [];

        if (_this.length) $.each(_this.get(0).attributes, function (v, n) {
            n = n.nodeName || n.name;
            v = _this.attr(n); // relay on $.fn.attr, it makes some filtering and checks
            if (v != undefined && v !== false)
                attributes.push({ name: n, value: v });
        })

        return attributes
    }

    $.fn.getPeriod = function () {
        var $component = $(this);
        var rs = {
            StartTime: 0, EndTime: 0
        };
        var isCustomElement = $component.hasClass("multi_options") ? true : false;
        var componentValue = isCustomElement ? $component.getSelectedValue() : $component.val();

        if (!componentValue) {
            return rs;
        }

        var timeValues = {
            Morning: {
                StartTime: 6, EndTime: 12
            },
            Afternoon: {
                StartTime: 12, EndTime: 18
            },
            Night: {
                StartTime: 18, EndTime: 24
            },
            Dawn: {
                StartTime: 0, EndTime: 6
            }
        };

        switch (componentValue) {
            case "Morning":
            case "Afternoon":
            case "Night":
            case "Dawn":
                rs = timeValues[componentValue];
                break;
            case "0":
                rs.StartTime = 0;
                rs.EndTime = 1;
                break;
            default:
                componentValue = parseInt(componentValue);
                rs.StartTime = componentValue - 1;
                rs.EndTime = componentValue + 1;
        }
        return rs;
    };

    $.fn.outerHTML = function (s) {
        return s
            ? this.before(s).remove()
            : jQuery("<p>").append(this.eq(0).clone()).html();
    };


    $.expr[':'].startWith = function (obj, index, meta) {

        var text = meta[3].toLowerCase();
        var objText = $(obj).text();
        var isValid = false;
        if (objText.length >= text.length) {
            if (objText.toLowerCase().substring(0, text.length) == text)
                isValid = true;
        }

        return isValid;

    }

    $.expr[':'].containsInvariantCase = function (obj, index, meta) {

        var text = meta[3].toLowerCase();
        var objText = $(obj).text().toLowerCase();
        var isValid = false;
        if (objText.length >= text.length)
            isValid = objText.contains(text);

        return isValid;
    }

    $.fn.isBound = function (type, fn) {
        var events = this.data('events');
        if (!events)
            return false;

        var data = events[type];

        if (data === undefined || data.length === 0) {
            return false;
        }

        var handlers = data.select(function (i) { return i.handler; });
        return (-1 !== $.inArray(fn, handlers ));
    };

    $.fn.attachOnce = function (type, fn) {
        if (!this.isBound(type, fn))
            this['on'](type, fn);
    };

    $.fn.attachOnceGeneral = function (type, fn) {
        this.off(type).on(type, fn);
    };

    $.fn.isFocused = function () {
        return document.activeElement === this;
    };

    $.fn.showWithCssClass = function () {
        var hideClass = 'hide';
        this.removeClass(hideClass);
    }

    $.fn.hideWithCssClass = function () {
        var hideClass = 'hide';
        this
            .removeClass(hideClass)
            .addClass(hideClass);
    }
})(jQuery);



ï»¿/// <reference path="../../Scripts/Libraries/Formatters.js" />
/// <reference path="../../Scripts/Libraries/Util.js" />

function DatePickerOption(options) {

    var initSettings = options;

    var settings = {
        'numberOfMonths': 2
        , 'dateFormat': formatter.slashDateFormatAbreviatedYearWithCulture()
        ,'minDate': new Date() //Seta como data mÃ­nima a data atual
        ,'maxDate': (new Date()).addDays(365) //Seta como data mÃ¡xima a data atual no ano seguinte
        , 'onClose': function () {  }
        , 'showOn': 'focus'
        , 'buttonImage': ''
        , 'buttonImageOnly': false
        , 'altField': ''
        , 'altFormat': undefined
        , 'currentText': undefined
        , 'onChangeMonthYear': undefined
        , 'changeMonth': false
        , 'changeYear': false
        , 'onSelect': undefined
        , 'beforeShowDay': undefined
        , 'defaultDate': new Date()
    };

    var nextText = {
        'en-us': 'Next',
        'pt-br': 'PrÃ³ximo',
        'es-ar': 'PrÃ³ximo',
        'es-mx': 'PrÃ³ximo',
        'es-ve': 'PrÃ³ximo'
    };

    var prevText = {
        'en-us': 'Previous',
        'pt-br': 'Anterior',
        'es-ar': 'Anterior',
        'es-mx': 'Anterior',
        'es-ve': 'Anterior'
    };

    var closeText = {
        'en-us': 'Close',
        'pt-br': 'Fechar',
        'es-ar': 'Cerrar',
        'es-mx': 'Cerrar',
        'es-ve': 'Cerrar'
    };

    var currentText = {
        'en-us': 'Current Month',
        'pt-br': 'MÃªs Atual',
        'es-ar': 'Mes en Curso',
        'es-mx': 'Mes en Curso',
        'es-ve': 'Mes en Curso'
    };


    if (initSettings)
        $.fn.extend(settings, initSettings);

    return {
        showAnim: '',
        numberOfMonths: settings.numberOfMonths,
        showButtonPanel: true,
        dateFormat: settings.dateFormat,
        minDate: settings.minDate,
        maxDate: settings.maxDate,
        hideIfNoPrevNext: settings.hideIfNoPrevNext,
        dayNames: formatter.daysOfWeek[formatter.culture],
        dayNamesMin: formatter.daysOfWeekMin[formatter.culture],
        dayNamesShort: formatter.daysOfWeekShort[formatter.culture],
        monthNames: formatter.monthNames[formatter.culture],
        monthNamesShort: formatter.monthNamesShort[formatter.culture],
        nextText: nextText[formatter.culture],
        prevText: prevText[formatter.culture],
        closeText: closeText[formatter.culture],
        timeText: formatter.timeText[formatter.culture],
        hourText: formatter.hourText[formatter.culture],
        minuteText: formatter.minuteText[formatter.culture],
        currentText: settings.currentText ? settings.currentText : currentText[formatter.culture],
        ShowCurrentRule: function (drawDates, inst) {

            var currentMonth = (new Date()).getMonth() + 1;
            var currentYear = (new Date()).getFullYear();

            return !(drawDates.any(currentMonth + "/" + currentYear));
        },
        beforeShow: function (input, inst) { $('.ui-datepicker').css('z-index', 1000); },
        beforeShowDay: settings.beforeShowDay,
        onClose: settings.onClose,
        showOn: settings.showOn,
        buttonImage: settings.buttonImage,
        buttonImageOnly: settings.buttonImageOnly,
        altField: settings.altField,
        altFormat: settings.altFormat ? settings.altFormat : settings.dateFormat,
        onChangeMonthYear: settings.onChangeMonthYear,
        onSelect: settings.onSelect,
        defaultDate: settings.defaultDate
    };
};


function DateRangePickerOption(options) {

    var initSettings = options;

    var settings = {
            autoApply: true,
            dateLimit: {
                days: 7
            },
            locale: {
                format: formatter.slashDateFormatYearWithCulture().toUpperCase(),
                separator: " - ",
                applyLabel: "Ok",
                cancelLabel: "Cancelar",
                fromLabel: "De",
                toLabel: "AtÃ©",
                customRangeLabel: "Custom",
                daysOfWeek: [
                    formatter.dayOfWeekShort(0),
                    formatter.dayOfWeekShort(1),
                    formatter.dayOfWeekShort(2),
                    formatter.dayOfWeekShort(3),
                    formatter.dayOfWeekShort(4),
                    formatter.dayOfWeekShort(5),
                    formatter.dayOfWeekShort(6)
                ],
                monthNames: [
                    formatter.monthName(1),
                    formatter.monthName(2),
                    formatter.monthName(3),
                    formatter.monthName(4),
                    formatter.monthName(5),
                    formatter.monthName(6),
                    formatter.monthName(7),
                    formatter.monthName(8),
                    formatter.monthName(9),
                    formatter.monthName(10),
                    formatter.monthName(11),
                    formatter.monthName(12)
                ],
                firstDay: 0
            }
        };


    if (initSettings)
        $.fn.extend(settings, initSettings);

    return settings;
};

function DestroyDatePicker(element) {
    element.off();
    $(".daterangepicker").remove();
}



ï»¿!function (a, b) { "object" == typeof exports && "undefined" != typeof module ? module.exports = b() : "function" == typeof define && define.amd ? define(b) : a.moment = b() }(this, function () {
    "use strict"; function a() { return Rd.apply(null, arguments) } function b(a) { Rd = a } function c(a) { return "[object Array]" === Object.prototype.toString.call(a) } function d(a) { return a instanceof Date || "[object Date]" === Object.prototype.toString.call(a) } function e(a, b) { var c, d = []; for (c = 0; c < a.length; ++c) d.push(b(a[c], c)); return d } function f(a, b) { return Object.prototype.hasOwnProperty.call(a, b) } function g(a, b) { for (var c in b) f(b, c) && (a[c] = b[c]); return f(b, "toString") && (a.toString = b.toString), f(b, "valueOf") && (a.valueOf = b.valueOf), a } function h(a, b, c, d) { return Da(a, b, c, d, !0).utc() } function i() { return { empty: !1, unusedTokens: [], unusedInput: [], overflow: -2, charsLeftOver: 0, nullInput: !1, invalidMonth: null, invalidFormat: !1, userInvalidated: !1, iso: !1 } } function j(a) { return null == a._pf && (a._pf = i()), a._pf } function k(a) { if (null == a._isValid) { var b = j(a); a._isValid = !(isNaN(a._d.getTime()) || !(b.overflow < 0) || b.empty || b.invalidMonth || b.invalidWeekday || b.nullInput || b.invalidFormat || b.userInvalidated), a._strict && (a._isValid = a._isValid && 0 === b.charsLeftOver && 0 === b.unusedTokens.length && void 0 === b.bigHour) } return a._isValid } function l(a) { var b = h(NaN); return null != a ? g(j(b), a) : j(b).userInvalidated = !0, b } function m(a) { return void 0 === a } function n(a, b) { var c, d, e; if (m(b._isAMomentObject) || (a._isAMomentObject = b._isAMomentObject), m(b._i) || (a._i = b._i), m(b._f) || (a._f = b._f), m(b._l) || (a._l = b._l), m(b._strict) || (a._strict = b._strict), m(b._tzm) || (a._tzm = b._tzm), m(b._isUTC) || (a._isUTC = b._isUTC), m(b._offset) || (a._offset = b._offset), m(b._pf) || (a._pf = j(b)), m(b._locale) || (a._locale = b._locale), Td.length > 0) for (c in Td) d = Td[c], e = b[d], m(e) || (a[d] = e); return a } function o(b) { n(this, b), this._d = new Date(null != b._d ? b._d.getTime() : NaN), Ud === !1 && (Ud = !0, a.updateOffset(this), Ud = !1) } function p(a) { return a instanceof o || null != a && null != a._isAMomentObject } function q(a) { return 0 > a ? Math.ceil(a) : Math.floor(a) } function r(a) { var b = +a, c = 0; return 0 !== b && isFinite(b) && (c = q(b)), c } function s(a, b, c) { var d, e = Math.min(a.length, b.length), f = Math.abs(a.length - b.length), g = 0; for (d = 0; e > d; d++) (c && a[d] !== b[d] || !c && r(a[d]) !== r(b[d])) && g++; return g + f } function t() { } function u(a) { return a ? a.toLowerCase().replace("_", "-") : a } function v(a) { for (var b, c, d, e, f = 0; f < a.length;) { for (e = u(a[f]).split("-"), b = e.length, c = u(a[f + 1]), c = c ? c.split("-") : null; b > 0;) { if (d = w(e.slice(0, b).join("-"))) return d; if (c && c.length >= b && s(e, c, !0) >= b - 1) break; b-- } f++ } return null } function w(a) { var b = null; if (!Vd[a] && "undefined" != typeof module && module && module.exports) try { b = Sd._abbr, require("./locale/" + a), x(b) } catch (c) { } return Vd[a] } function x(a, b) { var c; return a && (c = m(b) ? z(a) : y(a, b), c && (Sd = c)), Sd._abbr } function y(a, b) { return null !== b ? (b.abbr = a, Vd[a] = Vd[a] || new t, Vd[a].set(b), x(a), Vd[a]) : (delete Vd[a], null) } function z(a) { var b; if (a && a._locale && a._locale._abbr && (a = a._locale._abbr), !a) return Sd; if (!c(a)) { if (b = w(a)) return b; a = [a] } return v(a) } function A(a, b) { var c = a.toLowerCase(); Wd[c] = Wd[c + "s"] = Wd[b] = a } function B(a) { return "string" == typeof a ? Wd[a] || Wd[a.toLowerCase()] : void 0 } function C(a) { var b, c, d = {}; for (c in a) f(a, c) && (b = B(c), b && (d[b] = a[c])); return d } function D(a) { return a instanceof Function || "[object Function]" === Object.prototype.toString.call(a) } function E(b, c) { return function (d) { return null != d ? (G(this, b, d), a.updateOffset(this, c), this) : F(this, b) } } function F(a, b) { return a.isValid() ? a._d["get" + (a._isUTC ? "UTC" : "") + b]() : NaN } function G(a, b, c) { a.isValid() && a._d["set" + (a._isUTC ? "UTC" : "") + b](c) } function H(a, b) { var c; if ("object" == typeof a) for (c in a) this.set(c, a[c]); else if (a = B(a), D(this[a])) return this[a](b); return this } function I(a, b, c) { var d = "" + Math.abs(a), e = b - d.length, f = a >= 0; return (f ? c ? "+" : "" : "-") + Math.pow(10, Math.max(0, e)).toString().substr(1) + d } function J(a, b, c, d) { var e = d; "string" == typeof d && (e = function () { return this[d]() }), a && ($d[a] = e), b && ($d[b[0]] = function () { return I(e.apply(this, arguments), b[1], b[2]) }), c && ($d[c] = function () { return this.localeData().ordinal(e.apply(this, arguments), a) }) } function K(a) { return a.match(/\[[\s\S]/) ? a.replace(/^\[|\]$/g, "") : a.replace(/\\/g, "") } function L(a) { var b, c, d = a.match(Xd); for (b = 0, c = d.length; c > b; b++) $d[d[b]] ? d[b] = $d[d[b]] : d[b] = K(d[b]); return function (e) { var f = ""; for (b = 0; c > b; b++) f += d[b] instanceof Function ? d[b].call(e, a) : d[b]; return f } } function M(a, b) { return a.isValid() ? (b = N(b, a.localeData()), Zd[b] = Zd[b] || L(b), Zd[b](a)) : a.localeData().invalidDate() } function N(a, b) { function c(a) { return b.longDateFormat(a) || a } var d = 5; for (Yd.lastIndex = 0; d >= 0 && Yd.test(a) ;) a = a.replace(Yd, c), Yd.lastIndex = 0, d -= 1; return a } function O(a, b, c) { qe[a] = D(b) ? b : function (a, d) { return a && c ? c : b } } function P(a, b) { return f(qe, a) ? qe[a](b._strict, b._locale) : new RegExp(Q(a)) } function Q(a) { return R(a.replace("\\", "").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (a, b, c, d, e) { return b || c || d || e })) } function R(a) { return a.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&") } function S(a, b) { var c, d = b; for ("string" == typeof a && (a = [a]), "number" == typeof b && (d = function (a, c) { c[b] = r(a) }), c = 0; c < a.length; c++) re[a[c]] = d } function T(a, b) { S(a, function (a, c, d, e) { d._w = d._w || {}, b(a, d._w, d, e) }) } function U(a, b, c) { null != b && f(re, a) && re[a](b, c._a, c, a) } function V(a, b) { return new Date(Date.UTC(a, b + 1, 0)).getUTCDate() } function W(a, b) { return c(this._months) ? this._months[a.month()] : this._months[Be.test(b) ? "format" : "standalone"][a.month()] } function X(a, b) { return c(this._monthsShort) ? this._monthsShort[a.month()] : this._monthsShort[Be.test(b) ? "format" : "standalone"][a.month()] } function Y(a, b, c) { var d, e, f; for (this._monthsParse || (this._monthsParse = [], this._longMonthsParse = [], this._shortMonthsParse = []), d = 0; 12 > d; d++) { if (e = h([2e3, d]), c && !this._longMonthsParse[d] && (this._longMonthsParse[d] = new RegExp("^" + this.months(e, "").replace(".", "") + "$", "i"), this._shortMonthsParse[d] = new RegExp("^" + this.monthsShort(e, "").replace(".", "") + "$", "i")), c || this._monthsParse[d] || (f = "^" + this.months(e, "") + "|^" + this.monthsShort(e, ""), this._monthsParse[d] = new RegExp(f.replace(".", ""), "i")), c && "MMMM" === b && this._longMonthsParse[d].test(a)) return d; if (c && "MMM" === b && this._shortMonthsParse[d].test(a)) return d; if (!c && this._monthsParse[d].test(a)) return d } } function Z(a, b) { var c; return a.isValid() ? "string" == typeof b && (b = a.localeData().monthsParse(b), "number" != typeof b) ? a : (c = Math.min(a.date(), V(a.year(), b)), a._d["set" + (a._isUTC ? "UTC" : "") + "Month"](b, c), a) : a } function $(b) { return null != b ? (Z(this, b), a.updateOffset(this, !0), this) : F(this, "Month") } function _() { return V(this.year(), this.month()) } function aa(a) { return this._monthsParseExact ? (f(this, "_monthsRegex") || ca.call(this), a ? this._monthsShortStrictRegex : this._monthsShortRegex) : this._monthsShortStrictRegex && a ? this._monthsShortStrictRegex : this._monthsShortRegex } function ba(a) { return this._monthsParseExact ? (f(this, "_monthsRegex") || ca.call(this), a ? this._monthsStrictRegex : this._monthsRegex) : this._monthsStrictRegex && a ? this._monthsStrictRegex : this._monthsRegex } function ca() { function a(a, b) { return b.length - a.length } var b, c, d = [], e = [], f = []; for (b = 0; 12 > b; b++) c = h([2e3, b]), d.push(this.monthsShort(c, "")), e.push(this.months(c, "")), f.push(this.months(c, "")), f.push(this.monthsShort(c, "")); for (d.sort(a), e.sort(a), f.sort(a), b = 0; 12 > b; b++) d[b] = R(d[b]), e[b] = R(e[b]), f[b] = R(f[b]); this._monthsRegex = new RegExp("^(" + f.join("|") + ")", "i"), this._monthsShortRegex = this._monthsRegex, this._monthsStrictRegex = new RegExp("^(" + e.join("|") + ")$", "i"), this._monthsShortStrictRegex = new RegExp("^(" + d.join("|") + ")$", "i") } function da(a) { var b, c = a._a; return c && -2 === j(a).overflow && (b = c[te] < 0 || c[te] > 11 ? te : c[ue] < 1 || c[ue] > V(c[se], c[te]) ? ue : c[ve] < 0 || c[ve] > 24 || 24 === c[ve] && (0 !== c[we] || 0 !== c[xe] || 0 !== c[ye]) ? ve : c[we] < 0 || c[we] > 59 ? we : c[xe] < 0 || c[xe] > 59 ? xe : c[ye] < 0 || c[ye] > 999 ? ye : -1, j(a)._overflowDayOfYear && (se > b || b > ue) && (b = ue), j(a)._overflowWeeks && -1 === b && (b = ze), j(a)._overflowWeekday && -1 === b && (b = Ae), j(a).overflow = b), a } function ea(b) { a.suppressDeprecationWarnings === !1 && "undefined" != typeof console && console.warn && console.warn("Deprecation warning: " + b) } function fa(a, b) { var c = !0; return g(function () { return c && (ea(a + "\nArguments: " + Array.prototype.slice.call(arguments).join(", ") + "\n" + (new Error).stack), c = !1), b.apply(this, arguments) }, b) } function ga(a, b) { Ge[a] || (ea(b), Ge[a] = !0) } function ha(a) { var b, c, d, e, f, g, h = a._i, i = He.exec(h) || Ie.exec(h); if (i) { for (j(a).iso = !0, b = 0, c = Ke.length; c > b; b++) if (Ke[b][1].exec(i[1])) { e = Ke[b][0], d = Ke[b][2] !== !1; break } if (null == e) return void (a._isValid = !1); if (i[3]) { for (b = 0, c = Le.length; c > b; b++) if (Le[b][1].exec(i[3])) { f = (i[2] || " ") + Le[b][0]; break } if (null == f) return void (a._isValid = !1) } if (!d && null != f) return void (a._isValid = !1); if (i[4]) { if (!Je.exec(i[4])) return void (a._isValid = !1); g = "Z" } a._f = e + (f || "") + (g || ""), wa(a) } else a._isValid = !1 } function ia(b) { var c = Me.exec(b._i); return null !== c ? void (b._d = new Date(+c[1])) : (ha(b), void (b._isValid === !1 && (delete b._isValid, a.createFromInputFallback(b)))) } function ja(a, b, c, d, e, f, g) { var h = new Date(a, b, c, d, e, f, g); return 100 > a && a >= 0 && isFinite(h.getFullYear()) && h.setFullYear(a), h } function ka(a) { var b = new Date(Date.UTC.apply(null, arguments)); return 100 > a && a >= 0 && isFinite(b.getUTCFullYear()) && b.setUTCFullYear(a), b } function la(a) { return ma(a) ? 366 : 365 } function ma(a) { return a % 4 === 0 && a % 100 !== 0 || a % 400 === 0 } function na() { return ma(this.year()) } function oa(a, b, c) { var d = 7 + b - c, e = (7 + ka(a, 0, d).getUTCDay() - b) % 7; return -e + d - 1 } function pa(a, b, c, d, e) { var f, g, h = (7 + c - d) % 7, i = oa(a, d, e), j = 1 + 7 * (b - 1) + h + i; return 0 >= j ? (f = a - 1, g = la(f) + j) : j > la(a) ? (f = a + 1, g = j - la(a)) : (f = a, g = j), { year: f, dayOfYear: g } } function qa(a, b, c) { var d, e, f = oa(a.year(), b, c), g = Math.floor((a.dayOfYear() - f - 1) / 7) + 1; return 1 > g ? (e = a.year() - 1, d = g + ra(e, b, c)) : g > ra(a.year(), b, c) ? (d = g - ra(a.year(), b, c), e = a.year() + 1) : (e = a.year(), d = g), { week: d, year: e } } function ra(a, b, c) { var d = oa(a, b, c), e = oa(a + 1, b, c); return (la(a) - d + e) / 7 } function sa(a, b, c) { return null != a ? a : null != b ? b : c } function ta(b) { var c = new Date(a.now()); return b._useUTC ? [c.getUTCFullYear(), c.getUTCMonth(), c.getUTCDate()] : [c.getFullYear(), c.getMonth(), c.getDate()] } function ua(a) { var b, c, d, e, f = []; if (!a._d) { for (d = ta(a), a._w && null == a._a[ue] && null == a._a[te] && va(a), a._dayOfYear && (e = sa(a._a[se], d[se]), a._dayOfYear > la(e) && (j(a)._overflowDayOfYear = !0), c = ka(e, 0, a._dayOfYear), a._a[te] = c.getUTCMonth(), a._a[ue] = c.getUTCDate()), b = 0; 3 > b && null == a._a[b]; ++b) a._a[b] = f[b] = d[b]; for (; 7 > b; b++) a._a[b] = f[b] = null == a._a[b] ? 2 === b ? 1 : 0 : a._a[b]; 24 === a._a[ve] && 0 === a._a[we] && 0 === a._a[xe] && 0 === a._a[ye] && (a._nextDay = !0, a._a[ve] = 0), a._d = (a._useUTC ? ka : ja).apply(null, f), null != a._tzm && a._d.setUTCMinutes(a._d.getUTCMinutes() - a._tzm), a._nextDay && (a._a[ve] = 24) } } function va(a) { var b, c, d, e, f, g, h, i; b = a._w, null != b.GG || null != b.W || null != b.E ? (f = 1, g = 4, c = sa(b.GG, a._a[se], qa(Ea(), 1, 4).year), d = sa(b.W, 1), e = sa(b.E, 1), (1 > e || e > 7) && (i = !0)) : (f = a._locale._week.dow, g = a._locale._week.doy, c = sa(b.gg, a._a[se], qa(Ea(), f, g).year), d = sa(b.w, 1), null != b.d ? (e = b.d, (0 > e || e > 6) && (i = !0)) : null != b.e ? (e = b.e + f, (b.e < 0 || b.e > 6) && (i = !0)) : e = f), 1 > d || d > ra(c, f, g) ? j(a)._overflowWeeks = !0 : null != i ? j(a)._overflowWeekday = !0 : (h = pa(c, d, e, f, g), a._a[se] = h.year, a._dayOfYear = h.dayOfYear) } function wa(b) { if (b._f === a.ISO_8601) return void ha(b); b._a = [], j(b).empty = !0; var c, d, e, f, g, h = "" + b._i, i = h.length, k = 0; for (e = N(b._f, b._locale).match(Xd) || [], c = 0; c < e.length; c++) f = e[c], d = (h.match(P(f, b)) || [])[0], d && (g = h.substr(0, h.indexOf(d)), g.length > 0 && j(b).unusedInput.push(g), h = h.slice(h.indexOf(d) + d.length), k += d.length), $d[f] ? (d ? j(b).empty = !1 : j(b).unusedTokens.push(f), U(f, d, b)) : b._strict && !d && j(b).unusedTokens.push(f); j(b).charsLeftOver = i - k, h.length > 0 && j(b).unusedInput.push(h), j(b).bigHour === !0 && b._a[ve] <= 12 && b._a[ve] > 0 && (j(b).bigHour = void 0), b._a[ve] = xa(b._locale, b._a[ve], b._meridiem), ua(b), da(b) } function xa(a, b, c) { var d; return null == c ? b : null != a.meridiemHour ? a.meridiemHour(b, c) : null != a.isPM ? (d = a.isPM(c), d && 12 > b && (b += 12), d || 12 !== b || (b = 0), b) : b } function ya(a) { var b, c, d, e, f; if (0 === a._f.length) return j(a).invalidFormat = !0, void (a._d = new Date(NaN)); for (e = 0; e < a._f.length; e++) f = 0, b = n({}, a), null != a._useUTC && (b._useUTC = a._useUTC), b._f = a._f[e], wa(b), k(b) && (f += j(b).charsLeftOver, f += 10 * j(b).unusedTokens.length, j(b).score = f, (null == d || d > f) && (d = f, c = b)); g(a, c || b) } function za(a) { if (!a._d) { var b = C(a._i); a._a = e([b.year, b.month, b.day || b.date, b.hour, b.minute, b.second, b.millisecond], function (a) { return a && parseInt(a, 10) }), ua(a) } } function Aa(a) { var b = new o(da(Ba(a))); return b._nextDay && (b.add(1, "d"), b._nextDay = void 0), b } function Ba(a) { var b = a._i, e = a._f; return a._locale = a._locale || z(a._l), null === b || void 0 === e && "" === b ? l({ nullInput: !0 }) : ("string" == typeof b && (a._i = b = a._locale.preparse(b)), p(b) ? new o(da(b)) : (c(e) ? ya(a) : e ? wa(a) : d(b) ? a._d = b : Ca(a), k(a) || (a._d = null), a)) } function Ca(b) { var f = b._i; void 0 === f ? b._d = new Date(a.now()) : d(f) ? b._d = new Date(+f) : "string" == typeof f ? ia(b) : c(f) ? (b._a = e(f.slice(0), function (a) { return parseInt(a, 10) }), ua(b)) : "object" == typeof f ? za(b) : "number" == typeof f ? b._d = new Date(f) : a.createFromInputFallback(b) } function Da(a, b, c, d, e) { var f = {}; return "boolean" == typeof c && (d = c, c = void 0), f._isAMomentObject = !0, f._useUTC = f._isUTC = e, f._l = c, f._i = a, f._f = b, f._strict = d, Aa(f) } function Ea(a, b, c, d) { return Da(a, b, c, d, !1) } function Fa(a, b) { var d, e; if (1 === b.length && c(b[0]) && (b = b[0]), !b.length) return Ea(); for (d = b[0], e = 1; e < b.length; ++e) (!b[e].isValid() || b[e][a](d)) && (d = b[e]); return d } function Ga() { var a = [].slice.call(arguments, 0); return Fa("isBefore", a) } function Ha() { var a = [].slice.call(arguments, 0); return Fa("isAfter", a) } function Ia(a) { var b = C(a), c = b.year || 0, d = b.quarter || 0, e = b.month || 0, f = b.week || 0, g = b.day || 0, h = b.hour || 0, i = b.minute || 0, j = b.second || 0, k = b.millisecond || 0; this._milliseconds = +k + 1e3 * j + 6e4 * i + 36e5 * h, this._days = +g + 7 * f, this._months = +e + 3 * d + 12 * c, this._data = {}, this._locale = z(), this._bubble() } function Ja(a) { return a instanceof Ia } function Ka(a, b) { J(a, 0, 0, function () { var a = this.utcOffset(), c = "+"; return 0 > a && (a = -a, c = "-"), c + I(~~(a / 60), 2) + b + I(~~a % 60, 2) }) } function La(a, b) { var c = (b || "").match(a) || [], d = c[c.length - 1] || [], e = (d + "").match(Re) || ["-", 0, 0], f = +(60 * e[1]) + r(e[2]); return "+" === e[0] ? f : -f } function Ma(b, c) { var e, f; return c._isUTC ? (e = c.clone(), f = (p(b) || d(b) ? +b : +Ea(b)) - +e, e._d.setTime(+e._d + f), a.updateOffset(e, !1), e) : Ea(b).local() } function Na(a) { return 15 * -Math.round(a._d.getTimezoneOffset() / 15) } function Oa(b, c) { var d, e = this._offset || 0; return this.isValid() ? null != b ? ("string" == typeof b ? b = La(ne, b) : Math.abs(b) < 16 && (b = 60 * b), !this._isUTC && c && (d = Na(this)), this._offset = b, this._isUTC = !0, null != d && this.add(d, "m"), e !== b && (!c || this._changeInProgress ? cb(this, Za(b - e, "m"), 1, !1) : this._changeInProgress || (this._changeInProgress = !0, a.updateOffset(this, !0), this._changeInProgress = null)), this) : this._isUTC ? e : Na(this) : null != b ? this : NaN } function Pa(a, b) { return null != a ? ("string" != typeof a && (a = -a), this.utcOffset(a, b), this) : -this.utcOffset() } function Qa(a) { return this.utcOffset(0, a) } function Ra(a) { return this._isUTC && (this.utcOffset(0, a), this._isUTC = !1, a && this.subtract(Na(this), "m")), this } function Sa() { return this._tzm ? this.utcOffset(this._tzm) : "string" == typeof this._i && this.utcOffset(La(me, this._i)), this } function Ta(a) { return this.isValid() ? (a = a ? Ea(a).utcOffset() : 0, (this.utcOffset() - a) % 60 === 0) : !1 } function Ua() { return this.utcOffset() > this.clone().month(0).utcOffset() || this.utcOffset() > this.clone().month(5).utcOffset() } function Va() { if (!m(this._isDSTShifted)) return this._isDSTShifted; var a = {}; if (n(a, this), a = Ba(a), a._a) { var b = a._isUTC ? h(a._a) : Ea(a._a); this._isDSTShifted = this.isValid() && s(a._a, b.toArray()) > 0 } else this._isDSTShifted = !1; return this._isDSTShifted } function Wa() { return this.isValid() ? !this._isUTC : !1 } function Xa() { return this.isValid() ? this._isUTC : !1 } function Ya() { return this.isValid() ? this._isUTC && 0 === this._offset : !1 } function Za(a, b) { var c, d, e, g = a, h = null; return Ja(a) ? g = { ms: a._milliseconds, d: a._days, M: a._months } : "number" == typeof a ? (g = {}, b ? g[b] = a : g.milliseconds = a) : (h = Se.exec(a)) ? (c = "-" === h[1] ? -1 : 1, g = { y: 0, d: r(h[ue]) * c, h: r(h[ve]) * c, m: r(h[we]) * c, s: r(h[xe]) * c, ms: r(h[ye]) * c }) : (h = Te.exec(a)) ? (c = "-" === h[1] ? -1 : 1, g = { y: $a(h[2], c), M: $a(h[3], c), d: $a(h[4], c), h: $a(h[5], c), m: $a(h[6], c), s: $a(h[7], c), w: $a(h[8], c) }) : null == g ? g = {} : "object" == typeof g && ("from" in g || "to" in g) && (e = ab(Ea(g.from), Ea(g.to)), g = {}, g.ms = e.milliseconds, g.M = e.months), d = new Ia(g), Ja(a) && f(a, "_locale") && (d._locale = a._locale), d } function $a(a, b) { var c = a && parseFloat(a.replace(",", ".")); return (isNaN(c) ? 0 : c) * b } function _a(a, b) { var c = { milliseconds: 0, months: 0 }; return c.months = b.month() - a.month() + 12 * (b.year() - a.year()), a.clone().add(c.months, "M").isAfter(b) && --c.months, c.milliseconds = +b - +a.clone().add(c.months, "M"), c } function ab(a, b) { var c; return a.isValid() && b.isValid() ? (b = Ma(b, a), a.isBefore(b) ? c = _a(a, b) : (c = _a(b, a), c.milliseconds = -c.milliseconds, c.months = -c.months), c) : { milliseconds: 0, months: 0 } } function bb(a, b) { return function (c, d) { var e, f; return null === d || isNaN(+d) || (ga(b, "moment()." + b + "(period, number) is deprecated. Please use moment()." + b + "(number, period)."), f = c, c = d, d = f), c = "string" == typeof c ? +c : c, e = Za(c, d), cb(this, e, a), this } } function cb(b, c, d, e) { var f = c._milliseconds, g = c._days, h = c._months; b.isValid() && (e = null == e ? !0 : e, f && b._d.setTime(+b._d + f * d), g && G(b, "Date", F(b, "Date") + g * d), h && Z(b, F(b, "Month") + h * d), e && a.updateOffset(b, g || h)) } function db(a, b) { var c = a || Ea(), d = Ma(c, this).startOf("day"), e = this.diff(d, "days", !0), f = -6 > e ? "sameElse" : -1 > e ? "lastWeek" : 0 > e ? "lastDay" : 1 > e ? "sameDay" : 2 > e ? "nextDay" : 7 > e ? "nextWeek" : "sameElse", g = b && (D(b[f]) ? b[f]() : b[f]); return this.format(g || this.localeData().calendar(f, this, Ea(c))) } function eb() { return new o(this) } function fb(a, b) { var c = p(a) ? a : Ea(a); return this.isValid() && c.isValid() ? (b = B(m(b) ? "millisecond" : b), "millisecond" === b ? +this > +c : +c < +this.clone().startOf(b)) : !1 } function gb(a, b) { var c = p(a) ? a : Ea(a); return this.isValid() && c.isValid() ? (b = B(m(b) ? "millisecond" : b), "millisecond" === b ? +c > +this : +this.clone().endOf(b) < +c) : !1 } function hb(a, b, c) { return this.isAfter(a, c) && this.isBefore(b, c) } function ib(a, b) { var c, d = p(a) ? a : Ea(a); return this.isValid() && d.isValid() ? (b = B(b || "millisecond"), "millisecond" === b ? +this === +d : (c = +d, +this.clone().startOf(b) <= c && c <= +this.clone().endOf(b))) : !1 } function jb(a, b) { return this.isSame(a, b) || this.isAfter(a, b) } function kb(a, b) { return this.isSame(a, b) || this.isBefore(a, b) } function lb(a, b, c) { var d, e, f, g; return this.isValid() ? (d = Ma(a, this), d.isValid() ? (e = 6e4 * (d.utcOffset() - this.utcOffset()), b = B(b), "year" === b || "month" === b || "quarter" === b ? (g = mb(this, d), "quarter" === b ? g /= 3 : "year" === b && (g /= 12)) : (f = this - d, g = "second" === b ? f / 1e3 : "minute" === b ? f / 6e4 : "hour" === b ? f / 36e5 : "day" === b ? (f - e) / 864e5 : "week" === b ? (f - e) / 6048e5 : f), c ? g : q(g)) : NaN) : NaN } function mb(a, b) { var c, d, e = 12 * (b.year() - a.year()) + (b.month() - a.month()), f = a.clone().add(e, "months"); return 0 > b - f ? (c = a.clone().add(e - 1, "months"), d = (b - f) / (f - c)) : (c = a.clone().add(e + 1, "months"), d = (b - f) / (c - f)), -(e + d) } function nb() { return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ") } function ob() { var a = this.clone().utc(); return 0 < a.year() && a.year() <= 9999 ? D(Date.prototype.toISOString) ? this.toDate().toISOString() : M(a, "YYYY-MM-DD[T]HH:mm:ss.SSS[Z]") : M(a, "YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]") } function pb(b) { var c = M(this, b || a.defaultFormat); return this.localeData().postformat(c) } function qb(a, b) { return this.isValid() && (p(a) && a.isValid() || Ea(a).isValid()) ? Za({ to: this, from: a }).locale(this.locale()).humanize(!b) : this.localeData().invalidDate() } function rb(a) { return this.from(Ea(), a) } function sb(a, b) { return this.isValid() && (p(a) && a.isValid() || Ea(a).isValid()) ? Za({ from: this, to: a }).locale(this.locale()).humanize(!b) : this.localeData().invalidDate() } function tb(a) { return this.to(Ea(), a) } function ub(a) { var b; return void 0 === a ? this._locale._abbr : (b = z(a), null != b && (this._locale = b), this) } function vb() { return this._locale } function wb(a) { switch (a = B(a)) { case "year": this.month(0); case "quarter": case "month": this.date(1); case "week": case "isoWeek": case "day": this.hours(0); case "hour": this.minutes(0); case "minute": this.seconds(0); case "second": this.milliseconds(0) } return "week" === a && this.weekday(0), "isoWeek" === a && this.isoWeekday(1), "quarter" === a && this.month(3 * Math.floor(this.month() / 3)), this } function xb(a) { return a = B(a), void 0 === a || "millisecond" === a ? this : this.startOf(a).add(1, "isoWeek" === a ? "week" : a).subtract(1, "ms") } function yb() { return +this._d - 6e4 * (this._offset || 0) } function zb() { return Math.floor(+this / 1e3) } function Ab() { return this._offset ? new Date(+this) : this._d } function Bb() { var a = this; return [a.year(), a.month(), a.date(), a.hour(), a.minute(), a.second(), a.millisecond()] } function Cb() { var a = this; return { years: a.year(), months: a.month(), date: a.date(), hours: a.hours(), minutes: a.minutes(), seconds: a.seconds(), milliseconds: a.milliseconds() } } function Db() { return this.isValid() ? this.toISOString() : "null" } function Eb() { return k(this) } function Fb() { return g({}, j(this)) } function Gb() { return j(this).overflow } function Hb() { return { input: this._i, format: this._f, locale: this._locale, isUTC: this._isUTC, strict: this._strict } } function Ib(a, b) { J(0, [a, a.length], 0, b) } function Jb(a) { return Nb.call(this, a, this.week(), this.weekday(), this.localeData()._week.dow, this.localeData()._week.doy) } function Kb(a) { return Nb.call(this, a, this.isoWeek(), this.isoWeekday(), 1, 4) } function Lb() { return ra(this.year(), 1, 4) } function Mb() { var a = this.localeData()._week; return ra(this.year(), a.dow, a.doy) } function Nb(a, b, c, d, e) { var f; return null == a ? qa(this, d, e).year : (f = ra(a, d, e), b > f && (b = f), Ob.call(this, a, b, c, d, e)) } function Ob(a, b, c, d, e) { var f = pa(a, b, c, d, e), g = ka(f.year, 0, f.dayOfYear); return this.year(g.getUTCFullYear()), this.month(g.getUTCMonth()), this.date(g.getUTCDate()), this } function Pb(a) { return null == a ? Math.ceil((this.month() + 1) / 3) : this.month(3 * (a - 1) + this.month() % 3) } function Qb(a) { return qa(a, this._week.dow, this._week.doy).week } function Rb() { return this._week.dow } function Sb() { return this._week.doy } function Tb(a) { var b = this.localeData().week(this); return null == a ? b : this.add(7 * (a - b), "d") } function Ub(a) { var b = qa(this, 1, 4).week; return null == a ? b : this.add(7 * (a - b), "d") } function Vb(a, b) { return "string" != typeof a ? a : isNaN(a) ? (a = b.weekdaysParse(a), "number" == typeof a ? a : null) : parseInt(a, 10) } function Wb(a, b) { return c(this._weekdays) ? this._weekdays[a.day()] : this._weekdays[this._weekdays.isFormat.test(b) ? "format" : "standalone"][a.day()] } function Xb(a) { return this._weekdaysShort[a.day()] } function Yb(a) { return this._weekdaysMin[a.day()] } function Zb(a, b, c) { var d, e, f; for (this._weekdaysParse || (this._weekdaysParse = [], this._minWeekdaysParse = [], this._shortWeekdaysParse = [], this._fullWeekdaysParse = []), d = 0; 7 > d; d++) { if (e = Ea([2e3, 1]).day(d), c && !this._fullWeekdaysParse[d] && (this._fullWeekdaysParse[d] = new RegExp("^" + this.weekdays(e, "").replace(".", ".?") + "$", "i"), this._shortWeekdaysParse[d] = new RegExp("^" + this.weekdaysShort(e, "").replace(".", ".?") + "$", "i"), this._minWeekdaysParse[d] = new RegExp("^" + this.weekdaysMin(e, "").replace(".", ".?") + "$", "i")), this._weekdaysParse[d] || (f = "^" + this.weekdays(e, "") + "|^" + this.weekdaysShort(e, "") + "|^" + this.weekdaysMin(e, ""), this._weekdaysParse[d] = new RegExp(f.replace(".", ""), "i")), c && "dddd" === b && this._fullWeekdaysParse[d].test(a)) return d; if (c && "ddd" === b && this._shortWeekdaysParse[d].test(a)) return d; if (c && "dd" === b && this._minWeekdaysParse[d].test(a)) return d; if (!c && this._weekdaysParse[d].test(a)) return d } } function $b(a) { if (!this.isValid()) return null != a ? this : NaN; var b = this._isUTC ? this._d.getUTCDay() : this._d.getDay(); return null != a ? (a = Vb(a, this.localeData()), this.add(a - b, "d")) : b } function _b(a) { if (!this.isValid()) return null != a ? this : NaN; var b = (this.day() + 7 - this.localeData()._week.dow) % 7; return null == a ? b : this.add(a - b, "d") } function ac(a) { return this.isValid() ? null == a ? this.day() || 7 : this.day(this.day() % 7 ? a : a - 7) : null != a ? this : NaN } function bc(a) { var b = Math.round((this.clone().startOf("day") - this.clone().startOf("year")) / 864e5) + 1; return null == a ? b : this.add(a - b, "d") } function cc() { return this.hours() % 12 || 12 } function dc(a, b) { J(a, 0, 0, function () { return this.localeData().meridiem(this.hours(), this.minutes(), b) }) } function ec(a, b) { return b._meridiemParse } function fc(a) { return "p" === (a + "").toLowerCase().charAt(0) } function gc(a, b, c) { return a > 11 ? c ? "pm" : "PM" : c ? "am" : "AM" } function hc(a, b) { b[ye] = r(1e3 * ("0." + a)) } function ic() { return this._isUTC ? "UTC" : "" } function jc() { return this._isUTC ? "Coordinated Universal Time" : "" } function kc(a) { return Ea(1e3 * a) } function lc() { return Ea.apply(null, arguments).parseZone() } function mc(a, b, c) { var d = this._calendar[a]; return D(d) ? d.call(b, c) : d } function nc(a) { var b = this._longDateFormat[a], c = this._longDateFormat[a.toUpperCase()]; return b || !c ? b : (this._longDateFormat[a] = c.replace(/MMMM|MM|DD|dddd/g, function (a) { return a.slice(1) }), this._longDateFormat[a]) } function oc() { return this._invalidDate } function pc(a) { return this._ordinal.replace("%d", a) } function qc(a) { return a } function rc(a, b, c, d) { var e = this._relativeTime[c]; return D(e) ? e(a, b, c, d) : e.replace(/%d/i, a) } function sc(a, b) { var c = this._relativeTime[a > 0 ? "future" : "past"]; return D(c) ? c(b) : c.replace(/%s/i, b) } function tc(a) { var b, c; for (c in a) b = a[c], D(b) ? this[c] = b : this["_" + c] = b; this._ordinalParseLenient = new RegExp(this._ordinalParse.source + "|" + /\d{1,2}/.source) } function uc(a, b, c, d) { var e = z(), f = h().set(d, b); return e[c](f, a) } function vc(a, b, c, d, e) { if ("number" == typeof a && (b = a, a = void 0), a = a || "", null != b) return uc(a, b, c, e); var f, g = []; for (f = 0; d > f; f++) g[f] = uc(a, f, c, e); return g } function wc(a, b) { return vc(a, b, "months", 12, "month") } function xc(a, b) { return vc(a, b, "monthsShort", 12, "month") } function yc(a, b) { return vc(a, b, "weekdays", 7, "day") } function zc(a, b) { return vc(a, b, "weekdaysShort", 7, "day") } function Ac(a, b) { return vc(a, b, "weekdaysMin", 7, "day") } function Bc() { var a = this._data; return this._milliseconds = qf(this._milliseconds), this._days = qf(this._days), this._months = qf(this._months), a.milliseconds = qf(a.milliseconds), a.seconds = qf(a.seconds), a.minutes = qf(a.minutes), a.hours = qf(a.hours), a.months = qf(a.months), a.years = qf(a.years), this } function Cc(a, b, c, d) { var e = Za(b, c); return a._milliseconds += d * e._milliseconds, a._days += d * e._days, a._months += d * e._months, a._bubble() } function Dc(a, b) { return Cc(this, a, b, 1) } function Ec(a, b) { return Cc(this, a, b, -1) } function Fc(a) { return 0 > a ? Math.floor(a) : Math.ceil(a) } function Gc() { var a, b, c, d, e, f = this._milliseconds, g = this._days, h = this._months, i = this._data; return f >= 0 && g >= 0 && h >= 0 || 0 >= f && 0 >= g && 0 >= h || (f += 864e5 * Fc(Ic(h) + g), g = 0, h = 0), i.milliseconds = f % 1e3, a = q(f / 1e3), i.seconds = a % 60, b = q(a / 60), i.minutes = b % 60, c = q(b / 60), i.hours = c % 24, g += q(c / 24), e = q(Hc(g)), h += e, g -= Fc(Ic(e)), d = q(h / 12), h %= 12, i.days = g, i.months = h, i.years = d, this } function Hc(a) { return 4800 * a / 146097 } function Ic(a) { return 146097 * a / 4800 } function Jc(a) { var b, c, d = this._milliseconds; if (a = B(a), "month" === a || "year" === a) return b = this._days + d / 864e5, c = this._months + Hc(b), "month" === a ? c : c / 12; switch (b = this._days + Math.round(Ic(this._months)), a) { case "week": return b / 7 + d / 6048e5; case "day": return b + d / 864e5; case "hour": return 24 * b + d / 36e5; case "minute": return 1440 * b + d / 6e4; case "second": return 86400 * b + d / 1e3; case "millisecond": return Math.floor(864e5 * b) + d; default: throw new Error("Unknown unit " + a) } } function Kc() { return this._milliseconds + 864e5 * this._days + this._months % 12 * 2592e6 + 31536e6 * r(this._months / 12) } function Lc(a) { return function () { return this.as(a) } } function Mc(a) { return a = B(a), this[a + "s"]() } function Nc(a) { return function () { return this._data[a] } } function Oc() { return q(this.days() / 7) } function Pc(a, b, c, d, e) { return e.relativeTime(b || 1, !!c, a, d) } function Qc(a, b, c) { var d = Za(a).abs(), e = Gf(d.as("s")), f = Gf(d.as("m")), g = Gf(d.as("h")), h = Gf(d.as("d")), i = Gf(d.as("M")), j = Gf(d.as("y")), k = e < Hf.s && ["s", e] || 1 >= f && ["m"] || f < Hf.m && ["mm", f] || 1 >= g && ["h"] || g < Hf.h && ["hh", g] || 1 >= h && ["d"] || h < Hf.d && ["dd", h] || 1 >= i && ["M"] || i < Hf.M && ["MM", i] || 1 >= j && ["y"] || ["yy", j]; return k[2] = b, k[3] = +a > 0, k[4] = c, Pc.apply(null, k) } function Rc(a, b) { return void 0 === Hf[a] ? !1 : void 0 === b ? Hf[a] : (Hf[a] = b, !0) } function Sc(a) { var b = this.localeData(), c = Qc(this, !a, b); return a && (c = b.pastFuture(+this, c)), b.postformat(c) } function Tc() { var a, b, c, d = If(this._milliseconds) / 1e3, e = If(this._days), f = If(this._months); a = q(d / 60), b = q(a / 60), d %= 60, a %= 60, c = q(f / 12), f %= 12; var g = c, h = f, i = e, j = b, k = a, l = d, m = this.asSeconds(); return m ? (0 > m ? "-" : "") + "P" + (g ? g + "Y" : "") + (h ? h + "M" : "") + (i ? i + "D" : "") + (j || k || l ? "T" : "") + (j ? j + "H" : "") + (k ? k + "M" : "") + (l ? l + "S" : "") : "P0D" }
    //! moment.js locale configuration
    //! locale : belarusian (be)
    //! author : Dmitry Demidov : https://github.com/demidov91
    //! author: Praleska: http://praleska.pro/
    //! Author : Menelion ElensÃºle : https://github.com/Oire
    function Uc(a, b) { var c = a.split("_"); return b % 10 === 1 && b % 100 !== 11 ? c[0] : b % 10 >= 2 && 4 >= b % 10 && (10 > b % 100 || b % 100 >= 20) ? c[1] : c[2] } function Vc(a, b, c) { var d = { mm: b ? "ÑÐ²ÑÐ»ÑÐ½Ð°_ÑÐ²ÑÐ»ÑÐ½Ñ_ÑÐ²ÑÐ»ÑÐ½" : "ÑÐ²ÑÐ»ÑÐ½Ñ_ÑÐ²ÑÐ»ÑÐ½Ñ_ÑÐ²ÑÐ»ÑÐ½", hh: b ? "Ð³Ð°Ð´Ð·ÑÐ½Ð°_Ð³Ð°Ð´Ð·ÑÐ½Ñ_Ð³Ð°Ð´Ð·ÑÐ½" : "Ð³Ð°Ð´Ð·ÑÐ½Ñ_Ð³Ð°Ð´Ð·ÑÐ½Ñ_Ð³Ð°Ð´Ð·ÑÐ½", dd: "Ð´Ð·ÐµÐ½Ñ_Ð´Ð½Ñ_Ð´Ð·ÑÐ½", MM: "Ð¼ÐµÑÑÑ_Ð¼ÐµÑÑÑÑ_Ð¼ÐµÑÑÑÐ°Ñ", yy: "Ð³Ð¾Ð´_Ð³Ð°Ð´Ñ_Ð³Ð°Ð´Ð¾Ñ" }; return "m" === c ? b ? "ÑÐ²ÑÐ»ÑÐ½Ð°" : "ÑÐ²ÑÐ»ÑÐ½Ñ" : "h" === c ? b ? "Ð³Ð°Ð´Ð·ÑÐ½Ð°" : "Ð³Ð°Ð´Ð·ÑÐ½Ñ" : a + " " + Uc(d[c], +a) }
    //! moment.js locale configuration
    //! locale : breton (br)
    //! author : Jean-Baptiste Le Duigou : https://github.com/jbleduigou
    function Wc(a, b, c) { var d = { mm: "munutenn", MM: "miz", dd: "devezh" }; return a + " " + Zc(d[c], a) } function Xc(a) { switch (Yc(a)) { case 1: case 3: case 4: case 5: case 9: return a + " bloaz"; default: return a + " vloaz" } } function Yc(a) { return a > 9 ? Yc(a % 10) : a } function Zc(a, b) { return 2 === b ? $c(a) : a } function $c(a) { var b = { m: "v", b: "v", d: "z" }; return void 0 === b[a.charAt(0)] ? a : b[a.charAt(0)] + a.substring(1) }
    //! moment.js locale configuration
    //! locale : bosnian (bs)
    //! author : Nedim Cholich : https://github.com/frontyard
    //! based on (hr) translation by Bojan MarkoviÄ
    function _c(a, b, c) { var d = a + " "; switch (c) { case "m": return b ? "jedna minuta" : "jedne minute"; case "mm": return d += 1 === a ? "minuta" : 2 === a || 3 === a || 4 === a ? "minute" : "minuta"; case "h": return b ? "jedan sat" : "jednog sata"; case "hh": return d += 1 === a ? "sat" : 2 === a || 3 === a || 4 === a ? "sata" : "sati"; case "dd": return d += 1 === a ? "dan" : "dana"; case "MM": return d += 1 === a ? "mjesec" : 2 === a || 3 === a || 4 === a ? "mjeseca" : "mjeseci"; case "yy": return d += 1 === a ? "godina" : 2 === a || 3 === a || 4 === a ? "godine" : "godina" } } function ad(a) { return a > 1 && 5 > a && 1 !== ~~(a / 10) } function bd(a, b, c, d) { var e = a + " "; switch (c) { case "s": return b || d ? "pÃ¡r sekund" : "pÃ¡r sekundami"; case "m": return b ? "minuta" : d ? "minutu" : "minutou"; case "mm": return b || d ? e + (ad(a) ? "minuty" : "minut") : e + "minutami"; break; case "h": return b ? "hodina" : d ? "hodinu" : "hodinou"; case "hh": return b || d ? e + (ad(a) ? "hodiny" : "hodin") : e + "hodinami"; break; case "d": return b || d ? "den" : "dnem"; case "dd": return b || d ? e + (ad(a) ? "dny" : "dnÃ­") : e + "dny"; break; case "M": return b || d ? "mÄsÃ­c" : "mÄsÃ­cem"; case "MM": return b || d ? e + (ad(a) ? "mÄsÃ­ce" : "mÄsÃ­cÅ¯") : e + "mÄsÃ­ci"; break; case "y": return b || d ? "rok" : "rokem"; case "yy": return b || d ? e + (ad(a) ? "roky" : "let") : e + "lety" } }
    //! moment.js locale configuration
    //! locale : austrian german (de-at)
    //! author : lluchs : https://github.com/lluchs
    //! author: Menelion ElensÃºle: https://github.com/Oire
    //! author : Martin Groller : https://github.com/MadMG
    //! author : Mikolaj Dadela : https://github.com/mik01aj
    function cd(a, b, c, d) { var e = { m: ["eine Minute", "einer Minute"], h: ["eine Stunde", "einer Stunde"], d: ["ein Tag", "einem Tag"], dd: [a + " Tage", a + " Tagen"], M: ["ein Monat", "einem Monat"], MM: [a + " Monate", a + " Monaten"], y: ["ein Jahr", "einem Jahr"], yy: [a + " Jahre", a + " Jahren"] }; return b ? e[c][0] : e[c][1] }
    //! moment.js locale configuration
    //! locale : german (de)
    //! author : lluchs : https://github.com/lluchs
    //! author: Menelion ElensÃºle: https://github.com/Oire
    //! author : Mikolaj Dadela : https://github.com/mik01aj
    function dd(a, b, c, d) { var e = { m: ["eine Minute", "einer Minute"], h: ["eine Stunde", "einer Stunde"], d: ["ein Tag", "einem Tag"], dd: [a + " Tage", a + " Tagen"], M: ["ein Monat", "einem Monat"], MM: [a + " Monate", a + " Monaten"], y: ["ein Jahr", "einem Jahr"], yy: [a + " Jahre", a + " Jahren"] }; return b ? e[c][0] : e[c][1] }
    //! moment.js locale configuration
    //! locale : estonian (et)
    //! author : Henry Kehlmann : https://github.com/madhenry
    //! improvements : Illimar Tambek : https://github.com/ragulka
    function ed(a, b, c, d) { var e = { s: ["mÃµne sekundi", "mÃµni sekund", "paar sekundit"], m: ["Ã¼he minuti", "Ã¼ks minut"], mm: [a + " minuti", a + " minutit"], h: ["Ã¼he tunni", "tund aega", "Ã¼ks tund"], hh: [a + " tunni", a + " tundi"], d: ["Ã¼he pÃ¤eva", "Ã¼ks pÃ¤ev"], M: ["kuu aja", "kuu aega", "Ã¼ks kuu"], MM: [a + " kuu", a + " kuud"], y: ["Ã¼he aasta", "aasta", "Ã¼ks aasta"], yy: [a + " aasta", a + " aastat"] }; return b ? e[c][2] ? e[c][2] : e[c][1] : d ? e[c][0] : e[c][1] } function fd(a, b, c, d) { var e = ""; switch (c) { case "s": return d ? "muutaman sekunnin" : "muutama sekunti"; case "m": return d ? "minuutin" : "minuutti"; case "mm": e = d ? "minuutin" : "minuuttia"; break; case "h": return d ? "tunnin" : "tunti"; case "hh": e = d ? "tunnin" : "tuntia"; break; case "d": return d ? "pÃ¤ivÃ¤n" : "pÃ¤ivÃ¤"; case "dd": e = d ? "pÃ¤ivÃ¤n" : "pÃ¤ivÃ¤Ã¤"; break; case "M": return d ? "kuukauden" : "kuukausi"; case "MM": e = d ? "kuukauden" : "kuukautta"; break; case "y": return d ? "vuoden" : "vuosi"; case "yy": e = d ? "vuoden" : "vuotta" } return e = gd(a, d) + " " + e } function gd(a, b) { return 10 > a ? b ? fg[a] : eg[a] : a }
    //! moment.js locale configuration
    //! locale : hrvatski (hr)
    //! author : Bojan MarkoviÄ : https://github.com/bmarkovic
    function hd(a, b, c) { var d = a + " "; switch (c) { case "m": return b ? "jedna minuta" : "jedne minute"; case "mm": return d += 1 === a ? "minuta" : 2 === a || 3 === a || 4 === a ? "minute" : "minuta"; case "h": return b ? "jedan sat" : "jednog sata"; case "hh": return d += 1 === a ? "sat" : 2 === a || 3 === a || 4 === a ? "sata" : "sati"; case "dd": return d += 1 === a ? "dan" : "dana"; case "MM": return d += 1 === a ? "mjesec" : 2 === a || 3 === a || 4 === a ? "mjeseca" : "mjeseci"; case "yy": return d += 1 === a ? "godina" : 2 === a || 3 === a || 4 === a ? "godine" : "godina" } } function id(a, b, c, d) { var e = a; switch (c) { case "s": return d || b ? "nÃ©hÃ¡ny mÃ¡sodperc" : "nÃ©hÃ¡ny mÃ¡sodperce"; case "m": return "egy" + (d || b ? " perc" : " perce"); case "mm": return e + (d || b ? " perc" : " perce"); case "h": return "egy" + (d || b ? " Ã³ra" : " Ã³rÃ¡ja"); case "hh": return e + (d || b ? " Ã³ra" : " Ã³rÃ¡ja"); case "d": return "egy" + (d || b ? " nap" : " napja"); case "dd": return e + (d || b ? " nap" : " napja"); case "M": return "egy" + (d || b ? " hÃ³nap" : " hÃ³napja"); case "MM": return e + (d || b ? " hÃ³nap" : " hÃ³napja"); case "y": return "egy" + (d || b ? " Ã©v" : " Ã©ve"); case "yy": return e + (d || b ? " Ã©v" : " Ã©ve") } return "" } function jd(a) { return (a ? "" : "[mÃºlt] ") + "[" + pg[this.day()] + "] LT[-kor]" }
    //! moment.js locale configuration
    //! locale : icelandic (is)
    //! author : Hinrik Ãrn SigurÃ°sson : https://github.com/hinrik
    function kd(a) { return a % 100 === 11 ? !0 : a % 10 === 1 ? !1 : !0 } function ld(a, b, c, d) { var e = a + " "; switch (c) { case "s": return b || d ? "nokkrar sekÃºndur" : "nokkrum sekÃºndum"; case "m": return b ? "mÃ­nÃºta" : "mÃ­nÃºtu"; case "mm": return kd(a) ? e + (b || d ? "mÃ­nÃºtur" : "mÃ­nÃºtum") : b ? e + "mÃ­nÃºta" : e + "mÃ­nÃºtu"; case "hh": return kd(a) ? e + (b || d ? "klukkustundir" : "klukkustundum") : e + "klukkustund"; case "d": return b ? "dagur" : d ? "dag" : "degi"; case "dd": return kd(a) ? b ? e + "dagar" : e + (d ? "daga" : "dÃ¶gum") : b ? e + "dagur" : e + (d ? "dag" : "degi"); case "M": return b ? "mÃ¡nuÃ°ur" : d ? "mÃ¡nuÃ°" : "mÃ¡nuÃ°i"; case "MM": return kd(a) ? b ? e + "mÃ¡nuÃ°ir" : e + (d ? "mÃ¡nuÃ°i" : "mÃ¡nuÃ°um") : b ? e + "mÃ¡nuÃ°ur" : e + (d ? "mÃ¡nuÃ°" : "mÃ¡nuÃ°i"); case "y": return b || d ? "Ã¡r" : "Ã¡ri"; case "yy": return kd(a) ? e + (b || d ? "Ã¡r" : "Ã¡rum") : e + (b || d ? "Ã¡r" : "Ã¡ri") } }
    //! moment.js locale configuration
    //! locale : Luxembourgish (lb)
    //! author : mweimerskirch : https://github.com/mweimerskirch, David Raison : https://github.com/kwisatz
    function md(a, b, c, d) { var e = { m: ["eng Minutt", "enger Minutt"], h: ["eng Stonn", "enger Stonn"], d: ["een Dag", "engem Dag"], M: ["ee Mount", "engem Mount"], y: ["ee Joer", "engem Joer"] }; return b ? e[c][0] : e[c][1] } function nd(a) { var b = a.substr(0, a.indexOf(" ")); return pd(b) ? "a " + a : "an " + a } function od(a) { var b = a.substr(0, a.indexOf(" ")); return pd(b) ? "viru " + a : "virun " + a } function pd(a) { if (a = parseInt(a, 10), isNaN(a)) return !1; if (0 > a) return !0; if (10 > a) return a >= 4 && 7 >= a ? !0 : !1; if (100 > a) { var b = a % 10, c = a / 10; return pd(0 === b ? c : b) } if (1e4 > a) { for (; a >= 10;) a /= 10; return pd(a) } return a /= 1e3, pd(a) } function qd(a, b, c, d) { return b ? "kelios sekundÄs" : d ? "keliÅ³ sekundÅ¾iÅ³" : "kelias sekundes" } function rd(a, b, c, d) { return b ? td(c)[0] : d ? td(c)[1] : td(c)[2] } function sd(a) { return a % 10 === 0 || a > 10 && 20 > a } function td(a) { return rg[a].split("_") } function ud(a, b, c, d) { var e = a + " "; return 1 === a ? e + rd(a, b, c[0], d) : b ? e + (sd(a) ? td(c)[1] : td(c)[0]) : d ? e + td(c)[1] : e + (sd(a) ? td(c)[1] : td(c)[2]) } function vd(a, b, c) { return c ? b % 10 === 1 && 11 !== b ? a[2] : a[3] : b % 10 === 1 && 11 !== b ? a[0] : a[1] } function wd(a, b, c) { return a + " " + vd(sg[c], a, b) } function xd(a, b, c) { return vd(sg[c], a, b) } function yd(a, b) { return b ? "daÅ¾as sekundes" : "daÅ¾Äm sekundÄm" } function zd(a, b, c, d) { var e = ""; if (b) switch (c) { case "s": e = "à¤à¤¾à¤¹à¥ à¤¸à¥à¤à¤à¤¦"; break; case "m": e = "à¤à¤ à¤®à¤¿à¤¨à¤¿à¤"; break; case "mm": e = "%d à¤®à¤¿à¤¨à¤¿à¤à¥"; break; case "h": e = "à¤à¤ à¤¤à¤¾à¤¸"; break; case "hh": e = "%d à¤¤à¤¾à¤¸"; break; case "d": e = "à¤à¤ à¤¦à¤¿à¤µà¤¸"; break; case "dd": e = "%d à¤¦à¤¿à¤µà¤¸"; break; case "M": e = "à¤à¤ à¤®à¤¹à¤¿à¤¨à¤¾"; break; case "MM": e = "%d à¤®à¤¹à¤¿à¤¨à¥"; break; case "y": e = "à¤à¤ à¤µà¤°à¥à¤·"; break; case "yy": e = "%d à¤µà¤°à¥à¤·à¥" } else switch (c) { case "s": e = "à¤à¤¾à¤¹à¥ à¤¸à¥à¤à¤à¤¦à¤¾à¤"; break; case "m": e = "à¤à¤à¤¾ à¤®à¤¿à¤¨à¤¿à¤à¤¾"; break; case "mm": e = "%d à¤®à¤¿à¤¨à¤¿à¤à¤¾à¤"; break; case "h": e = "à¤à¤à¤¾ à¤¤à¤¾à¤¸à¤¾"; break; case "hh": e = "%d à¤¤à¤¾à¤¸à¤¾à¤"; break; case "d": e = "à¤à¤à¤¾ à¤¦à¤¿à¤µà¤¸à¤¾"; break; case "dd": e = "%d à¤¦à¤¿à¤µà¤¸à¤¾à¤"; break; case "M": e = "à¤à¤à¤¾ à¤®à¤¹à¤¿à¤¨à¥à¤¯à¤¾"; break; case "MM": e = "%d à¤®à¤¹à¤¿à¤¨à¥à¤¯à¤¾à¤"; break; case "y": e = "à¤à¤à¤¾ à¤µà¤°à¥à¤·à¤¾"; break; case "yy": e = "%d à¤µà¤°à¥à¤·à¤¾à¤" } return e.replace(/%d/i, a) } function Ad(a) { return 5 > a % 10 && a % 10 > 1 && ~~(a / 10) % 10 !== 1 } function Bd(a, b, c) { var d = a + " "; switch (c) { case "m": return b ? "minuta" : "minutÄ"; case "mm": return d + (Ad(a) ? "minuty" : "minut"); case "h": return b ? "godzina" : "godzinÄ"; case "hh": return d + (Ad(a) ? "godziny" : "godzin"); case "MM": return d + (Ad(a) ? "miesiÄce" : "miesiÄcy"); case "yy": return d + (Ad(a) ? "lata" : "lat") } }
    //! moment.js locale configuration
    //! locale : romanian (ro)
    //! author : Vlad Gurdiga : https://github.com/gurdiga
    //! author : Valentin Agachi : https://github.com/avaly
    function Cd(a, b, c) { var d = { mm: "minute", hh: "ore", dd: "zile", MM: "luni", yy: "ani" }, e = " "; return (a % 100 >= 20 || a >= 100 && a % 100 === 0) && (e = " de "), a + e + d[c] }
    //! moment.js locale configuration
    //! locale : russian (ru)
    //! author : Viktorminator : https://github.com/Viktorminator
    //! Author : Menelion ElensÃºle : https://github.com/Oire
    function Dd(a, b) { var c = a.split("_"); return b % 10 === 1 && b % 100 !== 11 ? c[0] : b % 10 >= 2 && 4 >= b % 10 && (10 > b % 100 || b % 100 >= 20) ? c[1] : c[2] } function Ed(a, b, c) { var d = { mm: b ? "Ð¼Ð¸Ð½ÑÑÐ°_Ð¼Ð¸Ð½ÑÑÑ_Ð¼Ð¸Ð½ÑÑ" : "Ð¼Ð¸Ð½ÑÑÑ_Ð¼Ð¸Ð½ÑÑÑ_Ð¼Ð¸Ð½ÑÑ", hh: "ÑÐ°Ñ_ÑÐ°ÑÐ°_ÑÐ°ÑÐ¾Ð²", dd: "Ð´ÐµÐ½Ñ_Ð´Ð½Ñ_Ð´Ð½ÐµÐ¹", MM: "Ð¼ÐµÑÑÑ_Ð¼ÐµÑÑÑÐ°_Ð¼ÐµÑÑÑÐµÐ²", yy: "Ð³Ð¾Ð´_Ð³Ð¾Ð´Ð°_Ð»ÐµÑ" }; return "m" === c ? b ? "Ð¼Ð¸Ð½ÑÑÐ°" : "Ð¼Ð¸Ð½ÑÑÑ" : a + " " + Dd(d[c], +a) } function Fd(a) { return a > 1 && 5 > a } function Gd(a, b, c, d) { var e = a + " "; switch (c) { case "s": return b || d ? "pÃ¡r sekÃºnd" : "pÃ¡r sekundami"; case "m": return b ? "minÃºta" : d ? "minÃºtu" : "minÃºtou"; case "mm": return b || d ? e + (Fd(a) ? "minÃºty" : "minÃºt") : e + "minÃºtami"; break; case "h": return b ? "hodina" : d ? "hodinu" : "hodinou"; case "hh": return b || d ? e + (Fd(a) ? "hodiny" : "hodÃ­n") : e + "hodinami"; break; case "d": return b || d ? "deÅ" : "dÅom"; case "dd": return b || d ? e + (Fd(a) ? "dni" : "dnÃ­") : e + "dÅami"; break; case "M": return b || d ? "mesiac" : "mesiacom"; case "MM": return b || d ? e + (Fd(a) ? "mesiace" : "mesiacov") : e + "mesiacmi"; break; case "y": return b || d ? "rok" : "rokom"; case "yy": return b || d ? e + (Fd(a) ? "roky" : "rokov") : e + "rokmi" } }
    //! moment.js locale configuration
    //! locale : slovenian (sl)
    //! author : Robert SedovÅ¡ek : https://github.com/sedovsek
    function Hd(a, b, c, d) { var e = a + " "; switch (c) { case "s": return b || d ? "nekaj sekund" : "nekaj sekundami"; case "m": return b ? "ena minuta" : "eno minuto"; case "mm": return e += 1 === a ? b ? "minuta" : "minuto" : 2 === a ? b || d ? "minuti" : "minutama" : 5 > a ? b || d ? "minute" : "minutami" : b || d ? "minut" : "minutami"; case "h": return b ? "ena ura" : "eno uro"; case "hh": return e += 1 === a ? b ? "ura" : "uro" : 2 === a ? b || d ? "uri" : "urama" : 5 > a ? b || d ? "ure" : "urami" : b || d ? "ur" : "urami"; case "d": return b || d ? "en dan" : "enim dnem"; case "dd": return e += 1 === a ? b || d ? "dan" : "dnem" : 2 === a ? b || d ? "dni" : "dnevoma" : b || d ? "dni" : "dnevi"; case "M": return b || d ? "en mesec" : "enim mesecem"; case "MM": return e += 1 === a ? b || d ? "mesec" : "mesecem" : 2 === a ? b || d ? "meseca" : "mesecema" : 5 > a ? b || d ? "mesece" : "meseci" : b || d ? "mesecev" : "meseci"; case "y": return b || d ? "eno leto" : "enim letom"; case "yy": return e += 1 === a ? b || d ? "leto" : "letom" : 2 === a ? b || d ? "leti" : "letoma" : 5 > a ? b || d ? "leta" : "leti" : b || d ? "let" : "leti" } } function Id(a) { var b = a; return b = -1 !== a.indexOf("jaj") ? b.slice(0, -3) + "leS" : -1 !== a.indexOf("jar") ? b.slice(0, -3) + "waQ" : -1 !== a.indexOf("DIS") ? b.slice(0, -3) + "nem" : b + " pIq" } function Jd(a) { var b = a; return b = -1 !== a.indexOf("jaj") ? b.slice(0, -3) + "Huâ" : -1 !== a.indexOf("jar") ? b.slice(0, -3) + "wen" : -1 !== a.indexOf("DIS") ? b.slice(0, -3) + "ben" : b + " ret" } function Kd(a, b, c, d) { var e = Ld(a); switch (c) { case "mm": return e + " tup"; case "hh": return e + " rep"; case "dd": return e + " jaj"; case "MM": return e + " jar"; case "yy": return e + " DIS" } } function Ld(a) { var b = Math.floor(a % 1e3 / 100), c = Math.floor(a % 100 / 10), d = a % 10, e = ""; return b > 0 && (e += Lg[b] + "vatlh"), c > 0 && (e += ("" !== e ? " " : "") + Lg[c] + "maH"), d > 0 && (e += ("" !== e ? " " : "") + Lg[d]), "" === e ? "pagh" : e } function Md(a, b, c, d) { var e = { s: ["viensas secunds", "'iensas secunds"], m: ["'n mÃ­ut", "'iens mÃ­ut"], mm: [a + " mÃ­uts", "" + a + " mÃ­uts"], h: ["'n Ã¾ora", "'iensa Ã¾ora"], hh: [a + " Ã¾oras", "" + a + " Ã¾oras"], d: ["'n ziua", "'iensa ziua"], dd: [a + " ziuas", "" + a + " ziuas"], M: ["'n mes", "'iens mes"], MM: [a + " mesen", "" + a + " mesen"], y: ["'n ar", "'iens ar"], yy: [a + " ars", "" + a + " ars"] }; return d ? e[c][0] : b ? e[c][0] : e[c][1] }
    //! moment.js locale configuration
    //! locale : ukrainian (uk)
    //! author : zemlanin : https://github.com/zemlanin
    //! Author : Menelion ElensÃºle : https://github.com/Oire
    function Nd(a, b) { var c = a.split("_"); return b % 10 === 1 && b % 100 !== 11 ? c[0] : b % 10 >= 2 && 4 >= b % 10 && (10 > b % 100 || b % 100 >= 20) ? c[1] : c[2] } function Od(a, b, c) { var d = { mm: b ? "ÑÐ²Ð¸Ð»Ð¸Ð½Ð°_ÑÐ²Ð¸Ð»Ð¸Ð½Ð¸_ÑÐ²Ð¸Ð»Ð¸Ð½" : "ÑÐ²Ð¸Ð»Ð¸Ð½Ñ_ÑÐ²Ð¸Ð»Ð¸Ð½Ð¸_ÑÐ²Ð¸Ð»Ð¸Ð½", hh: b ? "Ð³Ð¾Ð´Ð¸Ð½Ð°_Ð³Ð¾Ð´Ð¸Ð½Ð¸_Ð³Ð¾Ð´Ð¸Ð½" : "Ð³Ð¾Ð´Ð¸Ð½Ñ_Ð³Ð¾Ð´Ð¸Ð½Ð¸_Ð³Ð¾Ð´Ð¸Ð½", dd: "Ð´ÐµÐ½Ñ_Ð´Ð½Ñ_Ð´Ð½ÑÐ²", MM: "Ð¼ÑÑÑÑÑ_Ð¼ÑÑÑÑÑ_Ð¼ÑÑÑÑÑÐ²", yy: "ÑÑÐº_ÑÐ¾ÐºÐ¸_ÑÐ¾ÐºÑÐ²" }; return "m" === c ? b ? "ÑÐ²Ð¸Ð»Ð¸Ð½Ð°" : "ÑÐ²Ð¸Ð»Ð¸Ð½Ñ" : "h" === c ? b ? "Ð³Ð¾Ð´Ð¸Ð½Ð°" : "Ð³Ð¾Ð´Ð¸Ð½Ñ" : a + " " + Nd(d[c], +a) } function Pd(a, b) { var c = { nominative: "Ð½ÐµÐ´ÑÐ»Ñ_Ð¿Ð¾Ð½ÐµÐ´ÑÐ»Ð¾Ðº_Ð²ÑÐ²ÑÐ¾ÑÐ¾Ðº_ÑÐµÑÐµÐ´Ð°_ÑÐµÑÐ²ÐµÑ_Ð¿âÑÑÐ½Ð¸ÑÑ_ÑÑÐ±Ð¾ÑÐ°".split("_"), accusative: "Ð½ÐµÐ´ÑÐ»Ñ_Ð¿Ð¾Ð½ÐµÐ´ÑÐ»Ð¾Ðº_Ð²ÑÐ²ÑÐ¾ÑÐ¾Ðº_ÑÐµÑÐµÐ´Ñ_ÑÐµÑÐ²ÐµÑ_Ð¿âÑÑÐ½Ð¸ÑÑ_ÑÑÐ±Ð¾ÑÑ".split("_"), genitive: "Ð½ÐµÐ´ÑÐ»Ñ_Ð¿Ð¾Ð½ÐµÐ´ÑÐ»ÐºÐ°_Ð²ÑÐ²ÑÐ¾ÑÐºÐ°_ÑÐµÑÐµÐ´Ð¸_ÑÐµÑÐ²ÐµÑÐ³Ð°_Ð¿âÑÑÐ½Ð¸ÑÑ_ÑÑÐ±Ð¾ÑÐ¸".split("_") }, d = /(\[[ÐÐ²Ð£Ñ]\]) ?dddd/.test(b) ? "accusative" : /\[?(?:Ð¼Ð¸Ð½ÑÐ»Ð¾Ñ|Ð½Ð°ÑÑÑÐ¿Ð½Ð¾Ñ)? ?\] ?dddd/.test(b) ? "genitive" : "nominative"; return c[d][a.day()] } function Qd(a) { return function () { return a + "Ð¾" + (11 === this.hours() ? "Ð±" : "") + "] LT" } } var Rd, Sd, Td = a.momentProperties = [], Ud = !1, Vd = {}, Wd = {}, Xd = /(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g, Yd = /(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g, Zd = {}, $d = {}, _d = /\d/, ae = /\d\d/, be = /\d{3}/, ce = /\d{4}/, de = /[+-]?\d{6}/, ee = /\d\d?/, fe = /\d\d\d\d?/, ge = /\d\d\d\d\d\d?/, he = /\d{1,3}/, ie = /\d{1,4}/, je = /[+-]?\d{1,6}/, ke = /\d+/, le = /[+-]?\d+/, me = /Z|[+-]\d\d:?\d\d/gi, ne = /Z|[+-]\d\d(?::?\d\d)?/gi, oe = /[+-]?\d+(\.\d{1,3})?/, pe = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i, qe = {}, re = {}, se = 0, te = 1, ue = 2, ve = 3, we = 4, xe = 5, ye = 6, ze = 7, Ae = 8; J("M", ["MM", 2], "Mo", function () { return this.month() + 1 }), J("MMM", 0, 0, function (a) { return this.localeData().monthsShort(this, a) }), J("MMMM", 0, 0, function (a) { return this.localeData().months(this, a) }), A("month", "M"), O("M", ee), O("MM", ee, ae), O("MMM", function (a, b) { return b.monthsShortRegex(a) }), O("MMMM", function (a, b) { return b.monthsRegex(a) }), S(["M", "MM"], function (a, b) { b[te] = r(a) - 1 }), S(["MMM", "MMMM"], function (a, b, c, d) { var e = c._locale.monthsParse(a, d, c._strict); null != e ? b[te] = e : j(c).invalidMonth = a }); var Be = /D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/, Ce = "January_February_March_April_May_June_July_August_September_October_November_December".split("_"), De = "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"), Ee = pe, Fe = pe, Ge = {}; a.suppressDeprecationWarnings = !1; var He = /^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/, Ie = /^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/, Je = /Z|[+-]\d\d(?::?\d\d)?/, Ke = [["YYYYYY-MM-DD", /[+-]\d{6}-\d\d-\d\d/], ["YYYY-MM-DD", /\d{4}-\d\d-\d\d/], ["GGGG-[W]WW-E", /\d{4}-W\d\d-\d/], ["GGGG-[W]WW", /\d{4}-W\d\d/, !1], ["YYYY-DDD", /\d{4}-\d{3}/], ["YYYY-MM", /\d{4}-\d\d/, !1], ["YYYYYYMMDD", /[+-]\d{10}/], ["YYYYMMDD", /\d{8}/], ["GGGG[W]WWE", /\d{4}W\d{3}/], ["GGGG[W]WW", /\d{4}W\d{2}/, !1], ["YYYYDDD", /\d{7}/]], Le = [["HH:mm:ss.SSSS", /\d\d:\d\d:\d\d\.\d+/], ["HH:mm:ss,SSSS", /\d\d:\d\d:\d\d,\d+/], ["HH:mm:ss", /\d\d:\d\d:\d\d/], ["HH:mm", /\d\d:\d\d/], ["HHmmss.SSSS", /\d\d\d\d\d\d\.\d+/], ["HHmmss,SSSS", /\d\d\d\d\d\d,\d+/], ["HHmmss", /\d\d\d\d\d\d/], ["HHmm", /\d\d\d\d/], ["HH", /\d\d/]], Me = /^\/?Date\((\-?\d+)/i; a.createFromInputFallback = fa("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.", function (a) { a._d = new Date(a._i + (a._useUTC ? " UTC" : "")) }), J("Y", 0, 0, function () { var a = this.year(); return 9999 >= a ? "" + a : "+" + a }), J(0, ["YY", 2], 0, function () { return this.year() % 100 }), J(0, ["YYYY", 4], 0, "year"), J(0, ["YYYYY", 5], 0, "year"), J(0, ["YYYYYY", 6, !0], 0, "year"), A("year", "y"), O("Y", le), O("YY", ee, ae), O("YYYY", ie, ce), O("YYYYY", je, de), O("YYYYYY", je, de), S(["YYYYY", "YYYYYY"], se), S("YYYY", function (b, c) { c[se] = 2 === b.length ? a.parseTwoDigitYear(b) : r(b) }), S("YY", function (b, c) { c[se] = a.parseTwoDigitYear(b) }), S("Y", function (a, b) { b[se] = parseInt(a, 10) }), a.parseTwoDigitYear = function (a) { return r(a) + (r(a) > 68 ? 1900 : 2e3) }; var Ne = E("FullYear", !1); a.ISO_8601 = function () { }; var Oe = fa("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548", function () { var a = Ea.apply(null, arguments); return this.isValid() && a.isValid() ? this > a ? this : a : l() }), Pe = fa("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548", function () { var a = Ea.apply(null, arguments); return this.isValid() && a.isValid() ? a > this ? this : a : l() }), Qe = function () { return Date.now ? Date.now() : +new Date }; Ka("Z", ":"), Ka("ZZ", ""), O("Z", ne), O("ZZ", ne), S(["Z", "ZZ"], function (a, b, c) { c._useUTC = !0, c._tzm = La(ne, a) }); var Re = /([\+\-]|\d\d)/gi; a.updateOffset = function () { }; var Se = /(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/, Te = /^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/; Za.fn = Ia.prototype; var Ue = bb(1, "add"), Ve = bb(-1, "subtract"); a.defaultFormat = "YYYY-MM-DDTHH:mm:ssZ"; var We = fa("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.", function (a) { return void 0 === a ? this.localeData() : this.locale(a) }); J(0, ["gg", 2], 0, function () { return this.weekYear() % 100 }), J(0, ["GG", 2], 0, function () { return this.isoWeekYear() % 100 }), Ib("gggg", "weekYear"), Ib("ggggg", "weekYear"), Ib("GGGG", "isoWeekYear"), Ib("GGGGG", "isoWeekYear"), A("weekYear", "gg"), A("isoWeekYear", "GG"), O("G", le), O("g", le), O("GG", ee, ae), O("gg", ee, ae), O("GGGG", ie, ce), O("gggg", ie, ce), O("GGGGG", je, de), O("ggggg", je, de), T(["gggg", "ggggg", "GGGG", "GGGGG"], function (a, b, c, d) { b[d.substr(0, 2)] = r(a) }), T(["gg", "GG"], function (b, c, d, e) { c[e] = a.parseTwoDigitYear(b) }), J("Q", 0, "Qo", "quarter"), A("quarter", "Q"), O("Q", _d), S("Q", function (a, b) { b[te] = 3 * (r(a) - 1) }), J("w", ["ww", 2], "wo", "week"), J("W", ["WW", 2], "Wo", "isoWeek"), A("week", "w"), A("isoWeek", "W"), O("w", ee), O("ww", ee, ae), O("W", ee), O("WW", ee, ae), T(["w", "ww", "W", "WW"], function (a, b, c, d) { b[d.substr(0, 1)] = r(a) }); var Xe = { dow: 0, doy: 6 }; J("D", ["DD", 2], "Do", "date"), A("date", "D"), O("D", ee), O("DD", ee, ae), O("Do", function (a, b) { return a ? b._ordinalParse : b._ordinalParseLenient }), S(["D", "DD"], ue), S("Do", function (a, b) { b[ue] = r(a.match(ee)[0], 10) }); var Ye = E("Date", !0); J("d", 0, "do", "day"), J("dd", 0, 0, function (a) { return this.localeData().weekdaysMin(this, a) }), J("ddd", 0, 0, function (a) { return this.localeData().weekdaysShort(this, a) }), J("dddd", 0, 0, function (a) { return this.localeData().weekdays(this, a) }), J("e", 0, 0, "weekday"), J("E", 0, 0, "isoWeekday"), A("day", "d"), A("weekday", "e"), A("isoWeekday", "E"), O("d", ee), O("e", ee), O("E", ee), O("dd", pe), O("ddd", pe), O("dddd", pe), T(["dd", "ddd", "dddd"], function (a, b, c, d) { var e = c._locale.weekdaysParse(a, d, c._strict); null != e ? b.d = e : j(c).invalidWeekday = a }), T(["d", "e", "E"], function (a, b, c, d) { b[d] = r(a) }); var Ze = "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), $e = "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), _e = "Su_Mo_Tu_We_Th_Fr_Sa".split("_"); J("DDD", ["DDDD", 3], "DDDo", "dayOfYear"), A("dayOfYear", "DDD"), O("DDD", he), O("DDDD", be), S(["DDD", "DDDD"], function (a, b, c) { c._dayOfYear = r(a) }), J("H", ["HH", 2], 0, "hour"), J("h", ["hh", 2], 0, cc), J("hmm", 0, 0, function () { return "" + cc.apply(this) + I(this.minutes(), 2) }), J("hmmss", 0, 0, function () { return "" + cc.apply(this) + I(this.minutes(), 2) + I(this.seconds(), 2) }), J("Hmm", 0, 0, function () { return "" + this.hours() + I(this.minutes(), 2) }), J("Hmmss", 0, 0, function () { return "" + this.hours() + I(this.minutes(), 2) + I(this.seconds(), 2) }), dc("a", !0), dc("A", !1), A("hour", "h"), O("a", ec), O("A", ec), O("H", ee), O("h", ee), O("HH", ee, ae), O("hh", ee, ae), O("hmm", fe), O("hmmss", ge), O("Hmm", fe), O("Hmmss", ge), S(["H", "HH"], ve), S(["a", "A"], function (a, b, c) { c._isPm = c._locale.isPM(a), c._meridiem = a }), S(["h", "hh"], function (a, b, c) { b[ve] = r(a), j(c).bigHour = !0 }), S("hmm", function (a, b, c) { var d = a.length - 2; b[ve] = r(a.substr(0, d)), b[we] = r(a.substr(d)), j(c).bigHour = !0 }), S("hmmss", function (a, b, c) { var d = a.length - 4, e = a.length - 2; b[ve] = r(a.substr(0, d)), b[we] = r(a.substr(d, 2)), b[xe] = r(a.substr(e)), j(c).bigHour = !0 }), S("Hmm", function (a, b, c) { var d = a.length - 2; b[ve] = r(a.substr(0, d)), b[we] = r(a.substr(d)) }), S("Hmmss", function (a, b, c) { var d = a.length - 4, e = a.length - 2; b[ve] = r(a.substr(0, d)), b[we] = r(a.substr(d, 2)), b[xe] = r(a.substr(e)) }); var af = /[ap]\.?m?\.?/i, bf = E("Hours", !0); J("m", ["mm", 2], 0, "minute"), A("minute", "m"), O("m", ee), O("mm", ee, ae), S(["m", "mm"], we); var cf = E("Minutes", !1); J("s", ["ss", 2], 0, "second"), A("second", "s"), O("s", ee), O("ss", ee, ae), S(["s", "ss"], xe); var df = E("Seconds", !1); J("S", 0, 0, function () { return ~~(this.millisecond() / 100) }), J(0, ["SS", 2], 0, function () { return ~~(this.millisecond() / 10) }), J(0, ["SSS", 3], 0, "millisecond"), J(0, ["SSSS", 4], 0, function () { return 10 * this.millisecond() }), J(0, ["SSSSS", 5], 0, function () { return 100 * this.millisecond() }), J(0, ["SSSSSS", 6], 0, function () { return 1e3 * this.millisecond() }), J(0, ["SSSSSSS", 7], 0, function () { return 1e4 * this.millisecond() }), J(0, ["SSSSSSSS", 8], 0, function () { return 1e5 * this.millisecond() }), J(0, ["SSSSSSSSS", 9], 0, function () { return 1e6 * this.millisecond() }), A("millisecond", "ms"), O("S", he, _d), O("SS", he, ae), O("SSS", he, be); var ef; for (ef = "SSSS"; ef.length <= 9; ef += "S") O(ef, ke); for (ef = "S"; ef.length <= 9; ef += "S") S(ef, hc); var ff = E("Milliseconds", !1); J("z", 0, 0, "zoneAbbr"), J("zz", 0, 0, "zoneName"); var gf = o.prototype; gf.add = Ue, gf.calendar = db, gf.clone = eb, gf.diff = lb, gf.endOf = xb, gf.format = pb, gf.from = qb, gf.fromNow = rb, gf.to = sb, gf.toNow = tb, gf.get = H, gf.invalidAt = Gb, gf.isAfter = fb, gf.isBefore = gb, gf.isBetween = hb, gf.isSame = ib, gf.isSameOrAfter = jb, gf.isSameOrBefore = kb, gf.isValid = Eb, gf.lang = We, gf.locale = ub, gf.localeData = vb, gf.max = Pe, gf.min = Oe, gf.parsingFlags = Fb, gf.set = H, gf.startOf = wb, gf.subtract = Ve, gf.toArray = Bb, gf.toObject = Cb, gf.toDate = Ab, gf.toISOString = ob, gf.toJSON = Db, gf.toString = nb, gf.unix = zb, gf.valueOf = yb, gf.creationData = Hb, gf.year = Ne, gf.isLeapYear = na, gf.weekYear = Jb, gf.isoWeekYear = Kb, gf.quarter = gf.quarters = Pb, gf.month = $, gf.daysInMonth = _, gf.week = gf.weeks = Tb, gf.isoWeek = gf.isoWeeks = Ub, gf.weeksInYear = Mb, gf.isoWeeksInYear = Lb, gf.date = Ye, gf.day = gf.days = $b, gf.weekday = _b, gf.isoWeekday = ac, gf.dayOfYear = bc, gf.hour = gf.hours = bf, gf.minute = gf.minutes = cf, gf.second = gf.seconds = df, gf.millisecond = gf.milliseconds = ff, gf.utcOffset = Oa, gf.utc = Qa, gf.local = Ra, gf.parseZone = Sa, gf.hasAlignedHourOffset = Ta, gf.isDST = Ua, gf.isDSTShifted = Va, gf.isLocal = Wa, gf.isUtcOffset = Xa, gf.isUtc = Ya, gf.isUTC = Ya, gf.zoneAbbr = ic, gf.zoneName = jc, gf.dates = fa("dates accessor is deprecated. Use date instead.", Ye), gf.months = fa("months accessor is deprecated. Use month instead", $), gf.years = fa("years accessor is deprecated. Use year instead", Ne), gf.zone = fa("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779", Pa); var hf = gf, jf = { sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L" }, kf = { LTS: "h:mm:ss A", LT: "h:mm A", L: "MM/DD/YYYY", LL: "MMMM D, YYYY", LLL: "MMMM D, YYYY h:mm A", LLLL: "dddd, MMMM D, YYYY h:mm A" }, lf = "Invalid date", mf = "%d", nf = /\d{1,2}/, of = { future: "in %s", past: "%s ago", s: "a few seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years" }, pf = t.prototype; pf._calendar = jf, pf.calendar = mc, pf._longDateFormat = kf, pf.longDateFormat = nc, pf._invalidDate = lf, pf.invalidDate = oc, pf._ordinal = mf, pf.ordinal = pc, pf._ordinalParse = nf, pf.preparse = qc, pf.postformat = qc, pf._relativeTime = of, pf.relativeTime = rc, pf.pastFuture = sc, pf.set = tc, pf.months = W, pf._months = Ce, pf.monthsShort = X, pf._monthsShort = De, pf.monthsParse = Y, pf._monthsRegex = Fe, pf.monthsRegex = ba, pf._monthsShortRegex = Ee, pf.monthsShortRegex = aa, pf.week = Qb, pf._week = Xe, pf.firstDayOfYear = Sb, pf.firstDayOfWeek = Rb, pf.weekdays = Wb, pf._weekdays = Ze, pf.weekdaysMin = Yb, pf._weekdaysMin = _e, pf.weekdaysShort = Xb, pf._weekdaysShort = $e, pf.weekdaysParse = Zb, pf.isPM = fc, pf._meridiemParse = af, pf.meridiem = gc, x("en", { ordinalParse: /\d{1,2}(th|st|nd|rd)/, ordinal: function (a) { var b = a % 10, c = 1 === r(a % 100 / 10) ? "th" : 1 === b ? "st" : 2 === b ? "nd" : 3 === b ? "rd" : "th"; return a + c } }), a.lang = fa("moment.lang is deprecated. Use moment.locale instead.", x), a.langData = fa("moment.langData is deprecated. Use moment.localeData instead.", z); var qf = Math.abs, rf = Lc("ms"), sf = Lc("s"), tf = Lc("m"), uf = Lc("h"), vf = Lc("d"), wf = Lc("w"), xf = Lc("M"), yf = Lc("y"), zf = Nc("milliseconds"), Af = Nc("seconds"), Bf = Nc("minutes"), Cf = Nc("hours"), Df = Nc("days"), Ef = Nc("months"), Ff = Nc("years"), Gf = Math.round, Hf = { s: 45, m: 45, h: 22, d: 26, M: 11 }, If = Math.abs, Jf = Ia.prototype; Jf.abs = Bc, Jf.add = Dc, Jf.subtract = Ec, Jf.as = Jc, Jf.asMilliseconds = rf, Jf.asSeconds = sf, Jf.asMinutes = tf, Jf.asHours = uf, Jf.asDays = vf, Jf.asWeeks = wf, Jf.asMonths = xf, Jf.asYears = yf, Jf.valueOf = Kc, Jf._bubble = Gc, Jf.get = Mc, Jf.milliseconds = zf, Jf.seconds = Af, Jf.minutes = Bf, Jf.hours = Cf, Jf.days = Df, Jf.weeks = Oc, Jf.months = Ef, Jf.years = Ff, Jf.humanize = Sc, Jf.toISOString = Tc, Jf.toString = Tc, Jf.toJSON = Tc, Jf.locale = ub, Jf.localeData = vb, Jf.toIsoString = fa("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)", Tc), Jf.lang = We, J("X", 0, 0, "unix"), J("x", 0, 0, "valueOf"), O("x", le), O("X", oe), S("X", function (a, b, c) { c._d = new Date(1e3 * parseFloat(a, 10)) }), S("x", function (a, b, c) { c._d = new Date(r(a)) }),
    //! moment.js
    //! version : 2.11.1
    //! authors : Tim Wood, Iskren Chernev, Moment.js contributors
    //! license : MIT
    //! momentjs.com
    a.version = "2.11.1", b(Ea), a.fn = hf, a.min = Ga, a.max = Ha, a.now = Qe, a.utc = h, a.unix = kc, a.months = wc, a.isDate = d, a.locale = x, a.invalid = l, a.duration = Za, a.isMoment = p, a.weekdays = yc, a.parseZone = lc, a.localeData = z, a.isDuration = Ja, a.monthsShort = xc, a.weekdaysMin = Ac, a.defineLocale = y, a.weekdaysShort = zc, a.normalizeUnits = B, a.relativeTimeThreshold = Rc, a.prototype = hf; var Kf = a, Lf = (Kf.defineLocale("af", { months: "Januarie_Februarie_Maart_April_Mei_Junie_Julie_Augustus_September_Oktober_November_Desember".split("_"), monthsShort: "Jan_Feb_Mar_Apr_Mei_Jun_Jul_Aug_Sep_Okt_Nov_Des".split("_"), weekdays: "Sondag_Maandag_Dinsdag_Woensdag_Donderdag_Vrydag_Saterdag".split("_"), weekdaysShort: "Son_Maa_Din_Woe_Don_Vry_Sat".split("_"), weekdaysMin: "So_Ma_Di_Wo_Do_Vr_Sa".split("_"), meridiemParse: /vm|nm/i, isPM: function (a) { return /^nm$/i.test(a) }, meridiem: function (a, b, c) { return 12 > a ? c ? "vm" : "VM" : c ? "nm" : "NM" }, longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Vandag om] LT", nextDay: "[MÃ´re om] LT", nextWeek: "dddd [om] LT", lastDay: "[Gister om] LT", lastWeek: "[Laas] dddd [om] LT", sameElse: "L" }, relativeTime: { future: "oor %s", past: "%s gelede", s: "'n paar sekondes", m: "'n minuut", mm: "%d minute", h: "'n uur", hh: "%d ure", d: "'n dag", dd: "%d dae", M: "'n maand", MM: "%d maande", y: "'n jaar", yy: "%d jaar" }, ordinalParse: /\d{1,2}(ste|de)/, ordinal: function (a) { return a + (1 === a || 8 === a || a >= 20 ? "ste" : "de") }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("ar-ma", { months: "ÙÙØ§ÙØ±_ÙØ¨Ø±Ø§ÙØ±_ÙØ§Ø±Ø³_Ø£Ø¨Ø±ÙÙ_ÙØ§Ù_ÙÙÙÙÙ_ÙÙÙÙÙØ²_ØºØ´Øª_Ø´ØªÙØ¨Ø±_Ø£ÙØªÙØ¨Ø±_ÙÙÙØ¨Ø±_Ø¯Ø¬ÙØ¨Ø±".split("_"), monthsShort: "ÙÙØ§ÙØ±_ÙØ¨Ø±Ø§ÙØ±_ÙØ§Ø±Ø³_Ø£Ø¨Ø±ÙÙ_ÙØ§Ù_ÙÙÙÙÙ_ÙÙÙÙÙØ²_ØºØ´Øª_Ø´ØªÙØ¨Ø±_Ø£ÙØªÙØ¨Ø±_ÙÙÙØ¨Ø±_Ø¯Ø¬ÙØ¨Ø±".split("_"), weekdays: "Ø§ÙØ£Ø­Ø¯_Ø§ÙØ¥ØªÙÙÙ_Ø§ÙØ«ÙØ§Ø«Ø§Ø¡_Ø§ÙØ£Ø±Ø¨Ø¹Ø§Ø¡_Ø§ÙØ®ÙÙØ³_Ø§ÙØ¬ÙØ¹Ø©_Ø§ÙØ³Ø¨Øª".split("_"), weekdaysShort: "Ø§Ø­Ø¯_Ø§ØªÙÙÙ_Ø«ÙØ§Ø«Ø§Ø¡_Ø§Ø±Ø¨Ø¹Ø§Ø¡_Ø®ÙÙØ³_Ø¬ÙØ¹Ø©_Ø³Ø¨Øª".split("_"), weekdaysMin: "Ø­_Ù_Ø«_Ø±_Ø®_Ø¬_Ø³".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Ø§ÙÙÙÙ Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", nextDay: "[ØºØ¯Ø§ Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", nextWeek: "dddd [Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", lastDay: "[Ø£ÙØ³ Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", lastWeek: "dddd [Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", sameElse: "L" }, relativeTime: { future: "ÙÙ %s", past: "ÙÙØ° %s", s: "Ø«ÙØ§Ù", m: "Ø¯ÙÙÙØ©", mm: "%d Ø¯ÙØ§Ø¦Ù", h: "Ø³Ø§Ø¹Ø©", hh: "%d Ø³Ø§Ø¹Ø§Øª", d: "ÙÙÙ", dd: "%d Ø£ÙØ§Ù", M: "Ø´ÙØ±", MM: "%d Ø£Ø´ÙØ±", y: "Ø³ÙØ©", yy: "%d Ø³ÙÙØ§Øª" }, week: { dow: 6, doy: 12 } }), { 1: "Ù¡", 2: "Ù¢", 3: "Ù£", 4: "Ù¤", 5: "Ù¥", 6: "Ù¦", 7: "Ù§", 8: "Ù¨", 9: "Ù©", 0: "Ù " }), Mf = { "Ù¡": "1", "Ù¢": "2", "Ù£": "3", "Ù¤": "4", "Ù¥": "5", "Ù¦": "6", "Ù§": "7", "Ù¨": "8", "Ù©": "9", "Ù ": "0" }, Nf = (Kf.defineLocale("ar-sa", { months: "ÙÙØ§ÙØ±_ÙØ¨Ø±Ø§ÙØ±_ÙØ§Ø±Ø³_Ø£Ø¨Ø±ÙÙ_ÙØ§ÙÙ_ÙÙÙÙÙ_ÙÙÙÙÙ_Ø£ØºØ³Ø·Ø³_Ø³Ø¨ØªÙØ¨Ø±_Ø£ÙØªÙØ¨Ø±_ÙÙÙÙØ¨Ø±_Ø¯ÙØ³ÙØ¨Ø±".split("_"), monthsShort: "ÙÙØ§ÙØ±_ÙØ¨Ø±Ø§ÙØ±_ÙØ§Ø±Ø³_Ø£Ø¨Ø±ÙÙ_ÙØ§ÙÙ_ÙÙÙÙÙ_ÙÙÙÙÙ_Ø£ØºØ³Ø·Ø³_Ø³Ø¨ØªÙØ¨Ø±_Ø£ÙØªÙØ¨Ø±_ÙÙÙÙØ¨Ø±_Ø¯ÙØ³ÙØ¨Ø±".split("_"), weekdays: "Ø§ÙØ£Ø­Ø¯_Ø§ÙØ¥Ø«ÙÙÙ_Ø§ÙØ«ÙØ§Ø«Ø§Ø¡_Ø§ÙØ£Ø±Ø¨Ø¹Ø§Ø¡_Ø§ÙØ®ÙÙØ³_Ø§ÙØ¬ÙØ¹Ø©_Ø§ÙØ³Ø¨Øª".split("_"), weekdaysShort: "Ø£Ø­Ø¯_Ø¥Ø«ÙÙÙ_Ø«ÙØ§Ø«Ø§Ø¡_Ø£Ø±Ø¨Ø¹Ø§Ø¡_Ø®ÙÙØ³_Ø¬ÙØ¹Ø©_Ø³Ø¨Øª".split("_"), weekdaysMin: "Ø­_Ù_Ø«_Ø±_Ø®_Ø¬_Ø³".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, meridiemParse: /Øµ|Ù/, isPM: function (a) { return "Ù" === a }, meridiem: function (a, b, c) { return 12 > a ? "Øµ" : "Ù" }, calendar: { sameDay: "[Ø§ÙÙÙÙ Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", nextDay: "[ØºØ¯Ø§ Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", nextWeek: "dddd [Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", lastDay: "[Ø£ÙØ³ Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", lastWeek: "dddd [Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", sameElse: "L" }, relativeTime: { future: "ÙÙ %s", past: "ÙÙØ° %s", s: "Ø«ÙØ§Ù", m: "Ø¯ÙÙÙØ©", mm: "%d Ø¯ÙØ§Ø¦Ù", h: "Ø³Ø§Ø¹Ø©", hh: "%d Ø³Ø§Ø¹Ø§Øª", d: "ÙÙÙ", dd: "%d Ø£ÙØ§Ù", M: "Ø´ÙØ±", MM: "%d Ø£Ø´ÙØ±", y: "Ø³ÙØ©", yy: "%d Ø³ÙÙØ§Øª" }, preparse: function (a) { return a.replace(/[Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©Ù ]/g, function (a) { return Mf[a] }).replace(/Ø/g, ",") }, postformat: function (a) { return a.replace(/\d/g, function (a) { return Lf[a] }).replace(/,/g, "Ø") }, week: { dow: 6, doy: 12 } }), Kf.defineLocale("ar-tn", { months: "Ø¬Ø§ÙÙÙ_ÙÙÙØ±Ù_ÙØ§Ø±Ø³_Ø£ÙØ±ÙÙ_ÙØ§Ù_Ø¬ÙØ§Ù_Ø¬ÙÙÙÙØ©_Ø£ÙØª_Ø³Ø¨ØªÙØ¨Ø±_Ø£ÙØªÙØ¨Ø±_ÙÙÙÙØ¨Ø±_Ø¯ÙØ³ÙØ¨Ø±".split("_"), monthsShort: "Ø¬Ø§ÙÙÙ_ÙÙÙØ±Ù_ÙØ§Ø±Ø³_Ø£ÙØ±ÙÙ_ÙØ§Ù_Ø¬ÙØ§Ù_Ø¬ÙÙÙÙØ©_Ø£ÙØª_Ø³Ø¨ØªÙØ¨Ø±_Ø£ÙØªÙØ¨Ø±_ÙÙÙÙØ¨Ø±_Ø¯ÙØ³ÙØ¨Ø±".split("_"), weekdays: "Ø§ÙØ£Ø­Ø¯_Ø§ÙØ¥Ø«ÙÙÙ_Ø§ÙØ«ÙØ§Ø«Ø§Ø¡_Ø§ÙØ£Ø±Ø¨Ø¹Ø§Ø¡_Ø§ÙØ®ÙÙØ³_Ø§ÙØ¬ÙØ¹Ø©_Ø§ÙØ³Ø¨Øª".split("_"), weekdaysShort: "Ø£Ø­Ø¯_Ø¥Ø«ÙÙÙ_Ø«ÙØ§Ø«Ø§Ø¡_Ø£Ø±Ø¨Ø¹Ø§Ø¡_Ø®ÙÙØ³_Ø¬ÙØ¹Ø©_Ø³Ø¨Øª".split("_"), weekdaysMin: "Ø­_Ù_Ø«_Ø±_Ø®_Ø¬_Ø³".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Ø§ÙÙÙÙ Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", nextDay: "[ØºØ¯Ø§ Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", nextWeek: "dddd [Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", lastDay: "[Ø£ÙØ³ Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", lastWeek: "dddd [Ø¹ÙÙ Ø§ÙØ³Ø§Ø¹Ø©] LT", sameElse: "L" }, relativeTime: { future: "ÙÙ %s", past: "ÙÙØ° %s", s: "Ø«ÙØ§Ù", m: "Ø¯ÙÙÙØ©", mm: "%d Ø¯ÙØ§Ø¦Ù", h: "Ø³Ø§Ø¹Ø©", hh: "%d Ø³Ø§Ø¹Ø§Øª", d: "ÙÙÙ", dd: "%d Ø£ÙØ§Ù", M: "Ø´ÙØ±", MM: "%d Ø£Ø´ÙØ±", y: "Ø³ÙØ©", yy: "%d Ø³ÙÙØ§Øª" }, week: { dow: 1, doy: 4 } }), { 1: "Ù¡", 2: "Ù¢", 3: "Ù£", 4: "Ù¤", 5: "Ù¥", 6: "Ù¦", 7: "Ù§", 8: "Ù¨", 9: "Ù©", 0: "Ù " }), Of = { "Ù¡": "1", "Ù¢": "2", "Ù£": "3", "Ù¤": "4", "Ù¥": "5", "Ù¦": "6", "Ù§": "7", "Ù¨": "8", "Ù©": "9", "Ù ": "0" }, Pf = function (a) { return 0 === a ? 0 : 1 === a ? 1 : 2 === a ? 2 : a % 100 >= 3 && 10 >= a % 100 ? 3 : a % 100 >= 11 ? 4 : 5 }, Qf = { s: ["Ø£ÙÙ ÙÙ Ø«Ø§ÙÙØ©", "Ø«Ø§ÙÙØ© ÙØ§Ø­Ø¯Ø©", ["Ø«Ø§ÙÙØªØ§Ù", "Ø«Ø§ÙÙØªÙÙ"], "%d Ø«ÙØ§Ù", "%d Ø«Ø§ÙÙØ©", "%d Ø«Ø§ÙÙØ©"], m: ["Ø£ÙÙ ÙÙ Ø¯ÙÙÙØ©", "Ø¯ÙÙÙØ© ÙØ§Ø­Ø¯Ø©", ["Ø¯ÙÙÙØªØ§Ù", "Ø¯ÙÙÙØªÙÙ"], "%d Ø¯ÙØ§Ø¦Ù", "%d Ø¯ÙÙÙØ©", "%d Ø¯ÙÙÙØ©"], h: ["Ø£ÙÙ ÙÙ Ø³Ø§Ø¹Ø©", "Ø³Ø§Ø¹Ø© ÙØ§Ø­Ø¯Ø©", ["Ø³Ø§Ø¹ØªØ§Ù", "Ø³Ø§Ø¹ØªÙÙ"], "%d Ø³Ø§Ø¹Ø§Øª", "%d Ø³Ø§Ø¹Ø©", "%d Ø³Ø§Ø¹Ø©"], d: ["Ø£ÙÙ ÙÙ ÙÙÙ", "ÙÙÙ ÙØ§Ø­Ø¯", ["ÙÙÙØ§Ù", "ÙÙÙÙÙ"], "%d Ø£ÙØ§Ù", "%d ÙÙÙÙØ§", "%d ÙÙÙ"], M: ["Ø£ÙÙ ÙÙ Ø´ÙØ±", "Ø´ÙØ± ÙØ§Ø­Ø¯", ["Ø´ÙØ±Ø§Ù", "Ø´ÙØ±ÙÙ"], "%d Ø£Ø´ÙØ±", "%d Ø´ÙØ±Ø§", "%d Ø´ÙØ±"], y: ["Ø£ÙÙ ÙÙ Ø¹Ø§Ù", "Ø¹Ø§Ù ÙØ§Ø­Ø¯", ["Ø¹Ø§ÙØ§Ù", "Ø¹Ø§ÙÙÙ"], "%d Ø£Ø¹ÙØ§Ù", "%d Ø¹Ø§ÙÙØ§", "%d Ø¹Ø§Ù"] }, Rf = function (a) { return function (b, c, d, e) { var f = Pf(b), g = Qf[a][Pf(b)]; return 2 === f && (g = g[c ? 0 : 1]), g.replace(/%d/i, b) } }, Sf = ["ÙØ§ÙÙÙ Ø§ÙØ«Ø§ÙÙ ÙÙØ§ÙØ±", "Ø´Ø¨Ø§Ø· ÙØ¨Ø±Ø§ÙØ±", "Ø¢Ø°Ø§Ø± ÙØ§Ø±Ø³", "ÙÙØ³Ø§Ù Ø£Ø¨Ø±ÙÙ", "Ø£ÙØ§Ø± ÙØ§ÙÙ", "Ø­Ø²ÙØ±Ø§Ù ÙÙÙÙÙ", "ØªÙÙØ² ÙÙÙÙÙ", "Ø¢Ø¨ Ø£ØºØ³Ø·Ø³", "Ø£ÙÙÙÙ Ø³Ø¨ØªÙØ¨Ø±", "ØªØ´Ø±ÙÙ Ø§ÙØ£ÙÙ Ø£ÙØªÙØ¨Ø±", "ØªØ´Ø±ÙÙ Ø§ÙØ«Ø§ÙÙ ÙÙÙÙØ¨Ø±", "ÙØ§ÙÙÙ Ø§ÙØ£ÙÙ Ø¯ÙØ³ÙØ¨Ø±"], Tf = (Kf.defineLocale("ar", { months: Sf, monthsShort: Sf, weekdays: "Ø§ÙØ£Ø­Ø¯_Ø§ÙØ¥Ø«ÙÙÙ_Ø§ÙØ«ÙØ§Ø«Ø§Ø¡_Ø§ÙØ£Ø±Ø¨Ø¹Ø§Ø¡_Ø§ÙØ®ÙÙØ³_Ø§ÙØ¬ÙØ¹Ø©_Ø§ÙØ³Ø¨Øª".split("_"), weekdaysShort: "Ø£Ø­Ø¯_Ø¥Ø«ÙÙÙ_Ø«ÙØ§Ø«Ø§Ø¡_Ø£Ø±Ø¨Ø¹Ø§Ø¡_Ø®ÙÙØ³_Ø¬ÙØ¹Ø©_Ø³Ø¨Øª".split("_"), weekdaysMin: "Ø­_Ù_Ø«_Ø±_Ø®_Ø¬_Ø³".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "D/âM/âYYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, meridiemParse: /Øµ|Ù/, isPM: function (a) { return "Ù" === a }, meridiem: function (a, b, c) { return 12 > a ? "Øµ" : "Ù" }, calendar: { sameDay: "[Ø§ÙÙÙÙ Ø¹ÙØ¯ Ø§ÙØ³Ø§Ø¹Ø©] LT", nextDay: "[ØºØ¯ÙØ§ Ø¹ÙØ¯ Ø§ÙØ³Ø§Ø¹Ø©] LT", nextWeek: "dddd [Ø¹ÙØ¯ Ø§ÙØ³Ø§Ø¹Ø©] LT", lastDay: "[Ø£ÙØ³ Ø¹ÙØ¯ Ø§ÙØ³Ø§Ø¹Ø©] LT", lastWeek: "dddd [Ø¹ÙØ¯ Ø§ÙØ³Ø§Ø¹Ø©] LT", sameElse: "L" }, relativeTime: { future: "Ø¨Ø¹Ø¯ %s", past: "ÙÙØ° %s", s: Rf("s"), m: Rf("m"), mm: Rf("m"), h: Rf("h"), hh: Rf("h"), d: Rf("d"), dd: Rf("d"), M: Rf("M"), MM: Rf("M"), y: Rf("y"), yy: Rf("y") }, preparse: function (a) { return a.replace(/\u200f/g, "").replace(/[Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©Ù ]/g, function (a) { return Of[a] }).replace(/Ø/g, ",") }, postformat: function (a) { return a.replace(/\d/g, function (a) { return Nf[a] }).replace(/,/g, "Ø") }, week: { dow: 6, doy: 12 } }), { 1: "-inci", 5: "-inci", 8: "-inci", 70: "-inci", 80: "-inci", 2: "-nci", 7: "-nci", 20: "-nci", 50: "-nci", 3: "-Ã¼ncÃ¼", 4: "-Ã¼ncÃ¼", 100: "-Ã¼ncÃ¼", 6: "-ncÄ±", 9: "-uncu", 10: "-uncu", 30: "-uncu", 60: "-Ä±ncÄ±", 90: "-Ä±ncÄ±" }), Uf = (Kf.defineLocale("az", { months: "yanvar_fevral_mart_aprel_may_iyun_iyul_avqust_sentyabr_oktyabr_noyabr_dekabr".split("_"), monthsShort: "yan_fev_mar_apr_may_iyn_iyl_avq_sen_okt_noy_dek".split("_"), weekdays: "Bazar_Bazar ertÉsi_ÃÉrÅÉnbÉ axÅamÄ±_ÃÉrÅÉnbÉ_CÃ¼mÉ axÅamÄ±_CÃ¼mÉ_ÅÉnbÉ".split("_"), weekdaysShort: "Baz_BzE_ÃAx_ÃÉr_CAx_CÃ¼m_ÅÉn".split("_"), weekdaysMin: "Bz_BE_ÃA_ÃÉ_CA_CÃ¼_ÅÉ".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[bugÃ¼n saat] LT", nextDay: "[sabah saat] LT", nextWeek: "[gÉlÉn hÉftÉ] dddd [saat] LT", lastDay: "[dÃ¼nÉn] LT", lastWeek: "[keÃ§Én hÉftÉ] dddd [saat] LT", sameElse: "L" }, relativeTime: { future: "%s sonra", past: "%s ÉvvÉl", s: "birneÃ§É saniyyÉ", m: "bir dÉqiqÉ", mm: "%d dÉqiqÉ", h: "bir saat", hh: "%d saat", d: "bir gÃ¼n", dd: "%d gÃ¼n", M: "bir ay", MM: "%d ay", y: "bir il", yy: "%d il" }, meridiemParse: /gecÉ|sÉhÉr|gÃ¼ndÃ¼z|axÅam/, isPM: function (a) { return /^(gÃ¼ndÃ¼z|axÅam)$/.test(a) }, meridiem: function (a, b, c) { return 4 > a ? "gecÉ" : 12 > a ? "sÉhÉr" : 17 > a ? "gÃ¼ndÃ¼z" : "axÅam" }, ordinalParse: /\d{1,2}-(Ä±ncÄ±|inci|nci|Ã¼ncÃ¼|ncÄ±|uncu)/, ordinal: function (a) { if (0 === a) return a + "-Ä±ncÄ±"; var b = a % 10, c = a % 100 - b, d = a >= 100 ? 100 : null; return a + (Tf[b] || Tf[c] || Tf[d]) }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("be", { months: { format: "ÑÑÑÐ´Ð·ÐµÐ½Ñ_Ð»ÑÑÐ°Ð³Ð°_ÑÐ°ÐºÐ°Ð²ÑÐºÐ°_ÐºÑÐ°ÑÐ°Ð²ÑÐºÐ°_ÑÑÐ°ÑÐ½Ñ_ÑÑÑÐ²ÐµÐ½Ñ_Ð»ÑÐ¿ÐµÐ½Ñ_Ð¶Ð½ÑÑÐ½Ñ_Ð²ÐµÑÐ°ÑÐ½Ñ_ÐºÐ°ÑÑÑÑÑÐ½ÑÐºÐ°_Ð»ÑÑÑÐ°Ð¿Ð°Ð´Ð°_ÑÐ½ÐµÐ¶Ð½Ñ".split("_"), standalone: "ÑÑÑÐ´Ð·ÐµÐ½Ñ_Ð»ÑÑÑ_ÑÐ°ÐºÐ°Ð²ÑÐº_ÐºÑÐ°ÑÐ°Ð²ÑÐº_ÑÑÐ°Ð²ÐµÐ½Ñ_ÑÑÑÐ²ÐµÐ½Ñ_Ð»ÑÐ¿ÐµÐ½Ñ_Ð¶Ð½ÑÐ²ÐµÐ½Ñ_Ð²ÐµÑÐ°ÑÐµÐ½Ñ_ÐºÐ°ÑÑÑÑÑÐ½ÑÐº_Ð»ÑÑÑÐ°Ð¿Ð°Ð´_ÑÐ½ÐµÐ¶Ð°Ð½Ñ".split("_") }, monthsShort: "ÑÑÑÐ´_Ð»ÑÑ_ÑÐ°Ðº_ÐºÑÐ°Ñ_ÑÑÐ°Ð²_ÑÑÑÐ²_Ð»ÑÐ¿_Ð¶Ð½ÑÐ²_Ð²ÐµÑ_ÐºÐ°ÑÑ_Ð»ÑÑÑ_ÑÐ½ÐµÐ¶".split("_"), weekdays: { format: "Ð½ÑÐ´Ð·ÐµÐ»Ñ_Ð¿Ð°Ð½ÑÐ´Ð·ÐµÐ»Ð°Ðº_Ð°ÑÑÐ¾ÑÐ°Ðº_ÑÐµÑÐ°Ð´Ñ_ÑÐ°ÑÐ²ÐµÑ_Ð¿ÑÑÐ½ÑÑÑ_ÑÑÐ±Ð¾ÑÑ".split("_"), standalone: "Ð½ÑÐ´Ð·ÐµÐ»Ñ_Ð¿Ð°Ð½ÑÐ´Ð·ÐµÐ»Ð°Ðº_Ð°ÑÑÐ¾ÑÐ°Ðº_ÑÐµÑÐ°Ð´Ð°_ÑÐ°ÑÐ²ÐµÑ_Ð¿ÑÑÐ½ÑÑÐ°_ÑÑÐ±Ð¾ÑÐ°".split("_"), isFormat: /\[ ?[ÐÐ²] ?(?:Ð¼ÑÐ½ÑÐ»ÑÑ|Ð½Ð°ÑÑÑÐ¿Ð½ÑÑ)? ?\] ?dddd/ }, weekdaysShort: "Ð½Ð´_Ð¿Ð½_Ð°Ñ_ÑÑ_ÑÑ_Ð¿Ñ_ÑÐ±".split("_"), weekdaysMin: "Ð½Ð´_Ð¿Ð½_Ð°Ñ_ÑÑ_ÑÑ_Ð¿Ñ_ÑÐ±".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY Ð³.", LLL: "D MMMM YYYY Ð³., HH:mm", LLLL: "dddd, D MMMM YYYY Ð³., HH:mm" }, calendar: { sameDay: "[Ð¡ÑÐ½Ð½Ñ Ñ] LT", nextDay: "[ÐÐ°ÑÑÑÐ° Ñ] LT", lastDay: "[Ð£ÑÐ¾ÑÐ° Ñ] LT", nextWeek: function () { return "[Ð£] dddd [Ñ] LT" }, lastWeek: function () { switch (this.day()) { case 0: case 3: case 5: case 6: return "[Ð£ Ð¼ÑÐ½ÑÐ»ÑÑ] dddd [Ñ] LT"; case 1: case 2: case 4: return "[Ð£ Ð¼ÑÐ½ÑÐ»Ñ] dddd [Ñ] LT" } }, sameElse: "L" }, relativeTime: { future: "Ð¿ÑÐ°Ð· %s", past: "%s ÑÐ°Ð¼Ñ", s: "Ð½ÐµÐºÐ°Ð»ÑÐºÑ ÑÐµÐºÑÐ½Ð´", m: Vc, mm: Vc, h: Vc, hh: Vc, d: "Ð´Ð·ÐµÐ½Ñ", dd: Vc, M: "Ð¼ÐµÑÑÑ", MM: Vc, y: "Ð³Ð¾Ð´", yy: Vc }, meridiemParse: /Ð½Ð¾ÑÑ|ÑÐ°Ð½ÑÑÑ|Ð´Ð½Ñ|Ð²ÐµÑÐ°ÑÐ°/, isPM: function (a) { return /^(Ð´Ð½Ñ|Ð²ÐµÑÐ°ÑÐ°)$/.test(a) }, meridiem: function (a, b, c) { return 4 > a ? "Ð½Ð¾ÑÑ" : 12 > a ? "ÑÐ°Ð½ÑÑÑ" : 17 > a ? "Ð´Ð½Ñ" : "Ð²ÐµÑÐ°ÑÐ°" }, ordinalParse: /\d{1,2}-(Ñ|Ñ|Ð³Ð°)/, ordinal: function (a, b) { switch (b) { case "M": case "d": case "DDD": case "w": case "W": return a % 10 !== 2 && a % 10 !== 3 || a % 100 === 12 || a % 100 === 13 ? a + "-Ñ" : a + "-Ñ"; case "D": return a + "-Ð³Ð°"; default: return a } }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("bg", { months: "ÑÐ½ÑÐ°ÑÐ¸_ÑÐµÐ²ÑÑÐ°ÑÐ¸_Ð¼Ð°ÑÑ_Ð°Ð¿ÑÐ¸Ð»_Ð¼Ð°Ð¹_ÑÐ½Ð¸_ÑÐ»Ð¸_Ð°Ð²Ð³ÑÑÑ_ÑÐµÐ¿ÑÐµÐ¼Ð²ÑÐ¸_Ð¾ÐºÑÐ¾Ð¼Ð²ÑÐ¸_Ð½Ð¾ÐµÐ¼Ð²ÑÐ¸_Ð´ÐµÐºÐµÐ¼Ð²ÑÐ¸".split("_"), monthsShort: "ÑÐ½Ñ_ÑÐµÐ²_Ð¼Ð°Ñ_Ð°Ð¿Ñ_Ð¼Ð°Ð¹_ÑÐ½Ð¸_ÑÐ»Ð¸_Ð°Ð²Ð³_ÑÐµÐ¿_Ð¾ÐºÑ_Ð½Ð¾Ðµ_Ð´ÐµÐº".split("_"), weekdays: "Ð½ÐµÐ´ÐµÐ»Ñ_Ð¿Ð¾Ð½ÐµÐ´ÐµÐ»Ð½Ð¸Ðº_Ð²ÑÐ¾ÑÐ½Ð¸Ðº_ÑÑÑÐ´Ð°_ÑÐµÑÐ²ÑÑÑÑÐº_Ð¿ÐµÑÑÐº_ÑÑÐ±Ð¾ÑÐ°".split("_"), weekdaysShort: "Ð½ÐµÐ´_Ð¿Ð¾Ð½_Ð²ÑÐ¾_ÑÑÑ_ÑÐµÑ_Ð¿ÐµÑ_ÑÑÐ±".split("_"), weekdaysMin: "Ð½Ð´_Ð¿Ð½_Ð²Ñ_ÑÑ_ÑÑ_Ð¿Ñ_ÑÐ±".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "D.MM.YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY H:mm", LLLL: "dddd, D MMMM YYYY H:mm" }, calendar: { sameDay: "[ÐÐ½ÐµÑ Ð²] LT", nextDay: "[Ð£ÑÑÐµ Ð²] LT", nextWeek: "dddd [Ð²] LT", lastDay: "[ÐÑÐµÑÐ° Ð²] LT", lastWeek: function () { switch (this.day()) { case 0: case 3: case 6: return "[Ð Ð¸Ð·Ð¼Ð¸Ð½Ð°Ð»Ð°ÑÐ°] dddd [Ð²] LT"; case 1: case 2: case 4: case 5: return "[Ð Ð¸Ð·Ð¼Ð¸Ð½Ð°Ð»Ð¸Ñ] dddd [Ð²] LT" } }, sameElse: "L" }, relativeTime: { future: "ÑÐ»ÐµÐ´ %s", past: "Ð¿ÑÐµÐ´Ð¸ %s", s: "Ð½ÑÐºÐ¾Ð»ÐºÐ¾ ÑÐµÐºÑÐ½Ð´Ð¸", m: "Ð¼Ð¸Ð½ÑÑÐ°", mm: "%d Ð¼Ð¸Ð½ÑÑÐ¸", h: "ÑÐ°Ñ", hh: "%d ÑÐ°ÑÐ°", d: "Ð´ÐµÐ½", dd: "%d Ð´Ð½Ð¸", M: "Ð¼ÐµÑÐµÑ", MM: "%d Ð¼ÐµÑÐµÑÐ°", y: "Ð³Ð¾Ð´Ð¸Ð½Ð°", yy: "%d Ð³Ð¾Ð´Ð¸Ð½Ð¸" }, ordinalParse: /\d{1,2}-(ÐµÐ²|ÐµÐ½|ÑÐ¸|Ð²Ð¸|ÑÐ¸|Ð¼Ð¸)/, ordinal: function (a) { var b = a % 10, c = a % 100; return 0 === a ? a + "-ÐµÐ²" : 0 === c ? a + "-ÐµÐ½" : c > 10 && 20 > c ? a + "-ÑÐ¸" : 1 === b ? a + "-Ð²Ð¸" : 2 === b ? a + "-ÑÐ¸" : 7 === b || 8 === b ? a + "-Ð¼Ð¸" : a + "-ÑÐ¸" }, week: { dow: 1, doy: 7 } }), { 1: "à§§", 2: "à§¨", 3: "à§©", 4: "à§ª", 5: "à§«", 6: "à§¬", 7: "à§­", 8: "à§®", 9: "à§¯", 0: "à§¦" }), Vf = { "à§§": "1", "à§¨": "2", "à§©": "3", "à§ª": "4", "à§«": "5", "à§¬": "6", "à§­": "7", "à§®": "8", "à§¯": "9", "à§¦": "0" }, Wf = (Kf.defineLocale("bn", { months: "à¦à¦¾à¦¨à§à§à¦¾à¦°à§_à¦«à§à¦¬à§à§à¦¾à¦°à§_à¦®à¦¾à¦°à§à¦_à¦à¦ªà§à¦°à¦¿à¦²_à¦®à§_à¦à§à¦¨_à¦à§à¦²à¦¾à¦_à¦à¦à¦¾à¦¸à§à¦_à¦¸à§à¦ªà§à¦à§à¦®à§à¦¬à¦°_à¦à¦à§à¦à§à¦¬à¦°_à¦¨à¦­à§à¦®à§à¦¬à¦°_à¦¡à¦¿à¦¸à§à¦®à§à¦¬à¦°".split("_"), monthsShort: "à¦à¦¾à¦¨à§_à¦«à§à¦¬_à¦®à¦¾à¦°à§à¦_à¦à¦ªà¦°_à¦®à§_à¦à§à¦¨_à¦à§à¦²_à¦à¦_à¦¸à§à¦ªà§à¦_à¦à¦à§à¦à§_à¦¨à¦­_à¦¡à¦¿à¦¸à§à¦®à§".split("_"), weekdays: "à¦°à¦¬à¦¿à¦¬à¦¾à¦°_à¦¸à§à¦®à¦¬à¦¾à¦°_à¦®à¦à§à¦à¦²à¦¬à¦¾à¦°_à¦¬à§à¦§à¦¬à¦¾à¦°_à¦¬à§à¦¹à¦¸à§à¦ªà¦¤à§à¦¤à¦¿à¦¬à¦¾à¦°_à¦¶à§à¦à§à¦°à¦¬à¦¾à¦°_à¦¶à¦¨à¦¿à¦¬à¦¾à¦°".split("_"), weekdaysShort: "à¦°à¦¬à¦¿_à¦¸à§à¦®_à¦®à¦à§à¦à¦²_à¦¬à§à¦§_à¦¬à§à¦¹à¦¸à§à¦ªà¦¤à§à¦¤à¦¿_à¦¶à§à¦à§à¦°_à¦¶à¦¨à¦¿".split("_"), weekdaysMin: "à¦°à¦¬_à¦¸à¦®_à¦®à¦à§à¦_à¦¬à§_à¦¬à§à¦°à¦¿à¦¹_à¦¶à§_à¦¶à¦¨à¦¿".split("_"), longDateFormat: { LT: "A h:mm à¦¸à¦®à§", LTS: "A h:mm:ss à¦¸à¦®à§", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY, A h:mm à¦¸à¦®à§", LLLL: "dddd, D MMMM YYYY, A h:mm à¦¸à¦®à§" }, calendar: { sameDay: "[à¦à¦] LT", nextDay: "[à¦à¦à¦¾à¦®à§à¦à¦¾à¦²] LT", nextWeek: "dddd, LT", lastDay: "[à¦à¦¤à¦à¦¾à¦²] LT", lastWeek: "[à¦à¦¤] dddd, LT", sameElse: "L" }, relativeTime: { future: "%s à¦ªà¦°à§", past: "%s à¦à¦à§", s: "à¦à§à§à¦ à¦¸à§à¦à§à¦¨à§à¦¡", m: "à¦à¦ à¦®à¦¿à¦¨à¦¿à¦", mm: "%d à¦®à¦¿à¦¨à¦¿à¦", h: "à¦à¦ à¦à¦¨à§à¦à¦¾", hh: "%d à¦à¦¨à§à¦à¦¾", d: "à¦à¦ à¦¦à¦¿à¦¨", dd: "%d à¦¦à¦¿à¦¨", M: "à¦à¦ à¦®à¦¾à¦¸", MM: "%d à¦®à¦¾à¦¸", y: "à¦à¦ à¦¬à¦à¦°", yy: "%d à¦¬à¦à¦°" }, preparse: function (a) { return a.replace(/[à§§à§¨à§©à§ªà§«à§¬à§­à§®à§¯à§¦]/g, function (a) { return Vf[a] }) }, postformat: function (a) { return a.replace(/\d/g, function (a) { return Uf[a] }) }, meridiemParse: /à¦°à¦¾à¦¤|à¦¸à¦à¦¾à¦²|à¦¦à§à¦ªà§à¦°|à¦¬à¦¿à¦à¦¾à¦²|à¦°à¦¾à¦¤/, isPM: function (a) { return /^(à¦¦à§à¦ªà§à¦°|à¦¬à¦¿à¦à¦¾à¦²|à¦°à¦¾à¦¤)$/.test(a) }, meridiem: function (a, b, c) { return 4 > a ? "à¦°à¦¾à¦¤" : 10 > a ? "à¦¸à¦à¦¾à¦²" : 17 > a ? "à¦¦à§à¦ªà§à¦°" : 20 > a ? "à¦¬à¦¿à¦à¦¾à¦²" : "à¦°à¦¾à¦¤" }, week: { dow: 0, doy: 6 } }), { 1: "à¼¡", 2: "à¼¢", 3: "à¼£", 4: "à¼¤", 5: "à¼¥", 6: "à¼¦", 7: "à¼§", 8: "à¼¨", 9: "à¼©", 0: "à¼ " }), Xf = { "à¼¡": "1", "à¼¢": "2", "à¼£": "3", "à¼¤": "4", "à¼¥": "5", "à¼¦": "6", "à¼§": "7", "à¼¨": "8", "à¼©": "9", "à¼ ": "0" }, Yf = (Kf.defineLocale("bo", { months: "à½à¾³à¼à½à¼à½à½à¼à½à½¼_à½à¾³à¼à½à¼à½à½à½²à½¦à¼à½_à½à¾³à¼à½à¼à½à½¦à½´à½à¼à½_à½à¾³à¼à½à¼à½à½à½²à¼à½_à½à¾³à¼à½à¼à½£à¾à¼à½_à½à¾³à¼à½à¼à½à¾²à½´à½à¼à½_à½à¾³à¼à½à¼à½à½à½´à½à¼à½_à½à¾³à¼à½à¼à½à½¢à¾à¾±à½à¼à½_à½à¾³à¼à½à¼à½à½à½´à¼à½_à½à¾³à¼à½à¼à½à½à½´à¼à½_à½à¾³à¼à½à¼à½à½à½´à¼à½à½à½²à½à¼à½_à½à¾³à¼à½à¼à½à½à½´à¼à½à½à½²à½¦à¼à½".split("_"), monthsShort: "à½à¾³à¼à½à¼à½à½à¼à½à½¼_à½à¾³à¼à½à¼à½à½à½²à½¦à¼à½_à½à¾³à¼à½à¼à½à½¦à½´à½à¼à½_à½à¾³à¼à½à¼à½à½à½²à¼à½_à½à¾³à¼à½à¼à½£à¾à¼à½_à½à¾³à¼à½à¼à½à¾²à½´à½à¼à½_à½à¾³à¼à½à¼à½à½à½´à½à¼à½_à½à¾³à¼à½à¼à½à½¢à¾à¾±à½à¼à½_à½à¾³à¼à½à¼à½à½à½´à¼à½_à½à¾³à¼à½à¼à½à½à½´à¼à½_à½à¾³à¼à½à¼à½à½à½´à¼à½à½à½²à½à¼à½_à½à¾³à¼à½à¼à½à½à½´à¼à½à½à½²à½¦à¼à½".split("_"), weekdays: "à½à½à½ à¼à½à½²à¼à½à¼_à½à½à½ à¼à½à¾³à¼à½à¼_à½à½à½ à¼à½à½²à½à¼à½à½à½¢à¼_à½à½à½ à¼à½£à¾·à½à¼à½à¼_à½à½à½ à¼à½à½´à½¢à¼à½à½´_à½à½à½ à¼à½à¼à½¦à½à½¦à¼_à½à½à½ à¼à½¦à¾¤à½ºà½à¼à½à¼".split("_"), weekdaysShort: "à½à½²à¼à½à¼_à½à¾³à¼à½à¼_à½à½²à½à¼à½à½à½¢à¼_à½£à¾·à½à¼à½à¼_à½à½´à½¢à¼à½à½´_à½à¼à½¦à½à½¦à¼_à½¦à¾¤à½ºà½à¼à½à¼".split("_"), weekdaysMin: "à½à½²à¼à½à¼_à½à¾³à¼à½à¼_à½à½²à½à¼à½à½à½¢à¼_à½£à¾·à½à¼à½à¼_à½à½´à½¢à¼à½à½´_à½à¼à½¦à½à½¦à¼_à½¦à¾¤à½ºà½à¼à½à¼".split("_"), longDateFormat: { LT: "A h:mm", LTS: "A h:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY, A h:mm", LLLL: "dddd, D MMMM YYYY, A h:mm" }, calendar: { sameDay: "[à½à½²à¼à½¢à½²à½] LT", nextDay: "[à½¦à½à¼à½à½²à½] LT", nextWeek: "[à½à½à½´à½à¼à½à¾²à½à¼à½¢à¾à½ºà½¦à¼à½], LT", lastDay: "[à½à¼à½¦à½] LT", lastWeek: "[à½à½à½´à½à¼à½à¾²à½à¼à½à½à½ à¼à½] dddd, LT", sameElse: "L" }, relativeTime: { future: "%s à½£à¼", past: "%s à½¦à¾à½à¼à½£", s: "à½£à½à¼à½¦à½", m: "à½¦à¾à½¢à¼à½à¼à½à½à½²à½", mm: "%d à½¦à¾à½¢à¼à½", h: "à½à½´à¼à½à½¼à½à¼à½à½à½²à½", hh: "%d à½à½´à¼à½à½¼à½", d: "à½à½²à½à¼à½à½à½²à½", dd: "%d à½à½²à½à¼", M: "à½à¾³à¼à½à¼à½à½à½²à½", MM: "%d à½à¾³à¼à½", y: "à½£à½¼à¼à½à½à½²à½", yy: "%d à½£à½¼" }, preparse: function (a) { return a.replace(/[à¼¡à¼¢à¼£à¼¤à¼¥à¼¦à¼§à¼¨à¼©à¼ ]/g, function (a) { return Xf[a] }) }, postformat: function (a) { return a.replace(/\d/g, function (a) { return Wf[a] }) }, meridiemParse: /à½à½à½à¼à½à½¼|à½à½¼à½à½¦à¼à½à½¦|à½à½²à½à¼à½à½´à½|à½à½à½¼à½à¼à½à½|à½à½à½à¼à½à½¼/, isPM: function (a) { return /^(à½à½²à½à¼à½à½´à½|à½à½à½¼à½à¼à½à½|à½à½à½à¼à½à½¼)$/.test(a) }, meridiem: function (a, b, c) { return 4 > a ? "à½à½à½à¼à½à½¼" : 10 > a ? "à½à½¼à½à½¦à¼à½à½¦" : 17 > a ? "à½à½²à½à¼à½à½´à½" : 20 > a ? "à½à½à½¼à½à¼à½à½" : "à½à½à½à¼à½à½¼" }, week: { dow: 0, doy: 6 } }), Kf.defineLocale("br", { months: "Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"), monthsShort: "Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"), weekdays: "Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"), weekdaysShort: "Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"), weekdaysMin: "Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"), longDateFormat: { LT: "h[e]mm A", LTS: "h[e]mm:ss A", L: "DD/MM/YYYY", LL: "D [a viz] MMMM YYYY", LLL: "D [a viz] MMMM YYYY h[e]mm A", LLLL: "dddd, D [a viz] MMMM YYYY h[e]mm A" }, calendar: { sameDay: "[Hiziv da] LT", nextDay: "[Warc'hoazh da] LT", nextWeek: "dddd [da] LT", lastDay: "[Dec'h da] LT", lastWeek: "dddd [paset da] LT", sameElse: "L" }, relativeTime: { future: "a-benn %s", past: "%s 'zo", s: "un nebeud segondennoÃ¹", m: "ur vunutenn", mm: Wc, h: "un eur", hh: "%d eur", d: "un devezh", dd: Wc, M: "ur miz", MM: Wc, y: "ur bloaz", yy: Xc }, ordinalParse: /\d{1,2}(aÃ±|vet)/, ordinal: function (a) { var b = 1 === a ? "aÃ±" : "vet"; return a + b }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("bs", { months: "januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"), monthsShort: "jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"), weekdays: "nedjelja_ponedjeljak_utorak_srijeda_Äetvrtak_petak_subota".split("_"), weekdaysShort: "ned._pon._uto._sri._Äet._pet._sub.".split("_"), weekdaysMin: "ne_po_ut_sr_Äe_pe_su".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD. MM. YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY H:mm", LLLL: "dddd, D. MMMM YYYY H:mm" }, calendar: { sameDay: "[danas u] LT", nextDay: "[sutra u] LT", nextWeek: function () { switch (this.day()) { case 0: return "[u] [nedjelju] [u] LT"; case 3: return "[u] [srijedu] [u] LT"; case 6: return "[u] [subotu] [u] LT"; case 1: case 2: case 4: case 5: return "[u] dddd [u] LT" } }, lastDay: "[juÄer u] LT", lastWeek: function () { switch (this.day()) { case 0: case 3: return "[proÅ¡lu] dddd [u] LT"; case 6: return "[proÅ¡le] [subote] [u] LT"; case 1: case 2: case 4: case 5: return "[proÅ¡li] dddd [u] LT" } }, sameElse: "L" }, relativeTime: { future: "za %s", past: "prije %s", s: "par sekundi", m: _c, mm: _c, h: _c, hh: _c, d: "dan", dd: _c, M: "mjesec", MM: _c, y: "godinu", yy: _c }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 7 } }), Kf.defineLocale("ca", { months: "gener_febrer_marÃ§_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"), monthsShort: "gen._febr._mar._abr._mai._jun._jul._ag._set._oct._nov._des.".split("_"), weekdays: "diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"), weekdaysShort: "dg._dl._dt._dc._dj._dv._ds.".split("_"), weekdaysMin: "Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY H:mm", LLLL: "dddd D MMMM YYYY H:mm" }, calendar: { sameDay: function () { return "[avui a " + (1 !== this.hours() ? "les" : "la") + "] LT" }, nextDay: function () { return "[demÃ  a " + (1 !== this.hours() ? "les" : "la") + "] LT" }, nextWeek: function () { return "dddd [a " + (1 !== this.hours() ? "les" : "la") + "] LT" }, lastDay: function () { return "[ahir a " + (1 !== this.hours() ? "les" : "la") + "] LT" }, lastWeek: function () { return "[el] dddd [passat a " + (1 !== this.hours() ? "les" : "la") + "] LT" }, sameElse: "L" }, relativeTime: { future: "en %s", past: "fa %s", s: "uns segons", m: "un minut", mm: "%d minuts", h: "una hora", hh: "%d hores", d: "un dia", dd: "%d dies", M: "un mes", MM: "%d mesos", y: "un any", yy: "%d anys" }, ordinalParse: /\d{1,2}(r|n|t|Ã¨|a)/, ordinal: function (a, b) { var c = 1 === a ? "r" : 2 === a ? "n" : 3 === a ? "r" : 4 === a ? "t" : "Ã¨"; return ("w" === b || "W" === b) && (c = "a"), a + c }, week: { dow: 1, doy: 4 } }), "leden_Ãºnor_bÅezen_duben_kvÄten_Äerven_Äervenec_srpen_zÃ¡ÅÃ­_ÅÃ­jen_listopad_prosinec".split("_")), Zf = "led_Ãºno_bÅe_dub_kvÄ_Ävn_Ävc_srp_zÃ¡Å_ÅÃ­j_lis_pro".split("_"), $f = (Kf.defineLocale("cs", { months: Yf, monthsShort: Zf, monthsParse: function (a, b) { var c, d = []; for (c = 0; 12 > c; c++) d[c] = new RegExp("^" + a[c] + "$|^" + b[c] + "$", "i"); return d }(Yf, Zf), shortMonthsParse: function (a) { var b, c = []; for (b = 0; 12 > b; b++) c[b] = new RegExp("^" + a[b] + "$", "i"); return c }(Zf), longMonthsParse: function (a) { var b, c = []; for (b = 0; 12 > b; b++) c[b] = new RegExp("^" + a[b] + "$", "i"); return c }(Yf), weekdays: "nedÄle_pondÄlÃ­_ÃºterÃ½_stÅeda_Ätvrtek_pÃ¡tek_sobota".split("_"), weekdaysShort: "ne_po_Ãºt_st_Ät_pÃ¡_so".split("_"), weekdaysMin: "ne_po_Ãºt_st_Ät_pÃ¡_so".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD.MM.YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY H:mm", LLLL: "dddd D. MMMM YYYY H:mm" }, calendar: { sameDay: "[dnes v] LT", nextDay: "[zÃ­tra v] LT", nextWeek: function () { switch (this.day()) { case 0: return "[v nedÄli v] LT"; case 1: case 2: return "[v] dddd [v] LT"; case 3: return "[ve stÅedu v] LT"; case 4: return "[ve Ätvrtek v] LT"; case 5: return "[v pÃ¡tek v] LT"; case 6: return "[v sobotu v] LT" } }, lastDay: "[vÄera v] LT", lastWeek: function () { switch (this.day()) { case 0: return "[minulou nedÄli v] LT"; case 1: case 2: return "[minulÃ©] dddd [v] LT"; case 3: return "[minulou stÅedu v] LT"; case 4: case 5: return "[minulÃ½] dddd [v] LT"; case 6: return "[minulou sobotu v] LT" } }, sameElse: "L" }, relativeTime: { future: "za %s", past: "pÅed %s", s: bd, m: bd, mm: bd, h: bd, hh: bd, d: bd, dd: bd, M: bd, MM: bd, y: bd, yy: bd }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("cv", { months: "ÐºÓÑÐ»Ð°Ñ_Ð½Ð°ÑÓÑ_Ð¿ÑÑ_Ð°ÐºÐ°_Ð¼Ð°Ð¹_Ò«ÓÑÑÐ¼Ðµ_ÑÑÓ_Ò«ÑÑÐ»Ð°_Ð°Ð²ÓÐ½_ÑÐ¿Ð°_ÑÓ³Ðº_ÑÐ°ÑÑÐ°Ð²".split("_"), monthsShort: "ÐºÓÑ_Ð½Ð°Ñ_Ð¿ÑÑ_Ð°ÐºÐ°_Ð¼Ð°Ð¹_Ò«ÓÑ_ÑÑÓ_Ò«ÑÑ_Ð°Ð²Ð½_ÑÐ¿Ð°_ÑÓ³Ðº_ÑÐ°Ñ".split("_"), weekdays: "Ð²ÑÑÑÐ°ÑÐ½Ð¸ÐºÑÐ½_ÑÑÐ½ÑÐ¸ÐºÑÐ½_ÑÑÐ»Ð°ÑÐ¸ÐºÑÐ½_ÑÐ½ÐºÑÐ½_ÐºÓÒ«Ð½ÐµÑÐ½Ð¸ÐºÑÐ½_ÑÑÐ½ÐµÐºÑÐ½_ÑÓÐ¼Ð°ÑÐºÑÐ½".split("_"), weekdaysShort: "Ð²ÑÑ_ÑÑÐ½_ÑÑÐ»_ÑÐ½_ÐºÓÒ«_ÑÑÐ½_ÑÓÐ¼".split("_"), weekdaysMin: "Ð²Ñ_ÑÐ½_ÑÑ_ÑÐ½_ÐºÒ«_ÑÑ_ÑÐ¼".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD-MM-YYYY", LL: "YYYY [Ò«ÑÐ»ÑÐ¸] MMMM [ÑÐ¹ÓÑÓÐ½] D[-Ð¼ÓÑÓ]", LLL: "YYYY [Ò«ÑÐ»ÑÐ¸] MMMM [ÑÐ¹ÓÑÓÐ½] D[-Ð¼ÓÑÓ], HH:mm", LLLL: "dddd, YYYY [Ò«ÑÐ»ÑÐ¸] MMMM [ÑÐ¹ÓÑÓÐ½] D[-Ð¼ÓÑÓ], HH:mm" }, calendar: { sameDay: "[ÐÐ°ÑÐ½] LT [ÑÐµÑÐµÑÑÐµ]", nextDay: "[Ð«ÑÐ°Ð½] LT [ÑÐµÑÐµÑÑÐµ]", lastDay: "[ÓÐ½ÐµÑ] LT [ÑÐµÑÐµÑÑÐµ]", nextWeek: "[ÒªÐ¸ÑÐµÑ] dddd LT [ÑÐµÑÐµÑÑÐµ]", lastWeek: "[ÐÑÑÐ½Ó] dddd LT [ÑÐµÑÐµÑÑÐµ]", sameElse: "L" }, relativeTime: { future: function (a) { var b = /ÑÐµÑÐµÑ$/i.exec(a) ? "ÑÐµÐ½" : /Ò«ÑÐ»$/i.exec(a) ? "ÑÐ°Ð½" : "ÑÐ°Ð½"; return a + b }, past: "%s ÐºÐ°ÑÐ»Ð»Ð°", s: "Ð¿ÓÑ-Ð¸Ðº Ò«ÐµÐºÐºÑÐ½Ñ", m: "Ð¿ÓÑ Ð¼Ð¸Ð½ÑÑ", mm: "%d Ð¼Ð¸Ð½ÑÑ", h: "Ð¿ÓÑ ÑÐµÑÐµÑ", hh: "%d ÑÐµÑÐµÑ", d: "Ð¿ÓÑ ÐºÑÐ½", dd: "%d ÐºÑÐ½", M: "Ð¿ÓÑ ÑÐ¹ÓÑ", MM: "%d ÑÐ¹ÓÑ", y: "Ð¿ÓÑ Ò«ÑÐ»", yy: "%d Ò«ÑÐ»" }, ordinalParse: /\d{1,2}-Ð¼ÓÑ/, ordinal: "%d-Ð¼ÓÑ", week: { dow: 1, doy: 7 } }), Kf.defineLocale("cy", { months: "Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"), monthsShort: "Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"), weekdays: "Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"), weekdaysShort: "Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"), weekdaysMin: "Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Heddiw am] LT", nextDay: "[Yfory am] LT", nextWeek: "dddd [am] LT", lastDay: "[Ddoe am] LT", lastWeek: "dddd [diwethaf am] LT", sameElse: "L" }, relativeTime: { future: "mewn %s", past: "%s yn Ã´l", s: "ychydig eiliadau", m: "munud", mm: "%d munud", h: "awr", hh: "%d awr", d: "diwrnod", dd: "%d diwrnod", M: "mis", MM: "%d mis", y: "blwyddyn", yy: "%d flynedd" }, ordinalParse: /\d{1,2}(fed|ain|af|il|ydd|ed|eg)/, ordinal: function (a) { var b = a, c = "", d = ["", "af", "il", "ydd", "ydd", "ed", "ed", "ed", "fed", "fed", "fed", "eg", "fed", "eg", "eg", "fed", "eg", "eg", "fed", "eg", "fed"]; return b > 20 ? c = 40 === b || 50 === b || 60 === b || 80 === b || 100 === b ? "fed" : "ain" : b > 0 && (c = d[b]), a + c }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("da", { months: "januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"), monthsShort: "jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"), weekdays: "sÃ¸ndag_mandag_tirsdag_onsdag_torsdag_fredag_lÃ¸rdag".split("_"), weekdaysShort: "sÃ¸n_man_tir_ons_tor_fre_lÃ¸r".split("_"), weekdaysMin: "sÃ¸_ma_ti_on_to_fr_lÃ¸".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY HH:mm", LLLL: "dddd [d.] D. MMMM YYYY HH:mm" }, calendar: { sameDay: "[I dag kl.] LT", nextDay: "[I morgen kl.] LT", nextWeek: "dddd [kl.] LT", lastDay: "[I gÃ¥r kl.] LT", lastWeek: "[sidste] dddd [kl] LT", sameElse: "L" }, relativeTime: { future: "om %s", past: "%s siden", s: "fÃ¥ sekunder", m: "et minut", mm: "%d minutter", h: "en time", hh: "%d timer", d: "en dag", dd: "%d dage", M: "en mÃ¥ned", MM: "%d mÃ¥neder", y: "et Ã¥r", yy: "%d Ã¥r" }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("de-at", { months: "JÃ¤nner_Februar_MÃ¤rz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"), monthsShort: "JÃ¤n._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"), weekdays: "Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"), weekdaysShort: "So._Mo._Di._Mi._Do._Fr._Sa.".split("_"), weekdaysMin: "So_Mo_Di_Mi_Do_Fr_Sa".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY HH:mm", LLLL: "dddd, D. MMMM YYYY HH:mm" }, calendar: { sameDay: "[heute um] LT [Uhr]", sameElse: "L", nextDay: "[morgen um] LT [Uhr]", nextWeek: "dddd [um] LT [Uhr]", lastDay: "[gestern um] LT [Uhr]", lastWeek: "[letzten] dddd [um] LT [Uhr]" }, relativeTime: { future: "in %s", past: "vor %s", s: "ein paar Sekunden", m: cd, mm: "%d Minuten", h: cd, hh: "%d Stunden", d: cd, dd: cd, M: cd, MM: cd, y: cd, yy: cd }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("de", { months: "Januar_Februar_MÃ¤rz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"), monthsShort: "Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"), weekdays: "Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"), weekdaysShort: "So._Mo._Di._Mi._Do._Fr._Sa.".split("_"), weekdaysMin: "So_Mo_Di_Mi_Do_Fr_Sa".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY HH:mm", LLLL: "dddd, D. MMMM YYYY HH:mm" }, calendar: { sameDay: "[heute um] LT [Uhr]", sameElse: "L", nextDay: "[morgen um] LT [Uhr]", nextWeek: "dddd [um] LT [Uhr]", lastDay: "[gestern um] LT [Uhr]", lastWeek: "[letzten] dddd [um] LT [Uhr]" }, relativeTime: { future: "in %s", past: "vor %s", s: "ein paar Sekunden", m: dd, mm: "%d Minuten", h: dd, hh: "%d Stunden", d: dd, dd: dd, M: dd, MM: dd, y: dd, yy: dd }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), ["ÞÞ¬ÞÞªÞÞ¦ÞÞ©", "ÞÞ¬ÞÞ°ÞÞªÞÞ¦ÞÞ©", "ÞÞ§ÞÞ¨ÞÞª", "ÞÞ­ÞÞ°ÞÞ©ÞÞª", "ÞÞ­", "ÞÞ«ÞÞ°", "ÞÞªÞÞ¦ÞÞ¨", "ÞÞ¯ÞÞ¦ÞÞ°ÞÞª", "ÞÞ¬ÞÞ°ÞÞ¬ÞÞ°ÞÞ¦ÞÞª", "ÞÞ®ÞÞ°ÞÞ¯ÞÞ¦ÞÞª", "ÞÞ®ÞÞ¬ÞÞ°ÞÞ¦ÞÞª", "ÞÞ¨ÞÞ¬ÞÞ°ÞÞ¦ÞÞª"]), _f = ["ÞÞ§ÞÞ¨ÞÞ°ÞÞ¦", "ÞÞ¯ÞÞ¦", "ÞÞ¦ÞÞ°ÞÞ§ÞÞ¦", "ÞÞªÞÞ¦", "ÞÞªÞÞ§ÞÞ°ÞÞ¦ÞÞ¨", "ÞÞªÞÞªÞÞª", "ÞÞ®ÞÞ¨ÞÞ¨ÞÞª"], ag = (Kf.defineLocale("dv", { months: $f, monthsShort: $f, weekdays: _f, weekdaysShort: _f, weekdaysMin: "ÞÞ§ÞÞ¨_ÞÞ¯ÞÞ¦_ÞÞ¦ÞÞ°_ÞÞªÞÞ¦_ÞÞªÞÞ§_ÞÞªÞÞª_ÞÞ®ÞÞ¨".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "D/M/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, meridiemParse: /ÞÞ|ÞÞ/, isPM: function (a) { return "" === a }, meridiem: function (a, b, c) { return 12 > a ? "ÞÞ" : "ÞÞ" }, calendar: { sameDay: "[ÞÞ¨ÞÞ¦ÞÞª] LT", nextDay: "[ÞÞ§ÞÞ¦ÞÞ§] LT", nextWeek: "dddd LT", lastDay: "[ÞÞ¨ÞÞ°ÞÞ¬] LT", lastWeek: "[ÞÞ§ÞÞ¨ÞÞªÞÞ¨] dddd LT", sameElse: "L" }, relativeTime: { future: "ÞÞ¬ÞÞ­ÞÞ¦ÞÞ¨ %s", past: "ÞÞªÞÞ¨ÞÞ° %s", s: "ÞÞ¨ÞÞªÞÞ°ÞÞªÞÞ®ÞÞ¬ÞÞ°", m: "ÞÞ¨ÞÞ¨ÞÞ¬ÞÞ°", mm: "ÞÞ¨ÞÞ¨ÞÞª %d", h: "ÞÞ¦ÞÞ¨ÞÞ¨ÞÞ¬ÞÞ°", hh: "ÞÞ¦ÞÞ¨ÞÞ¨ÞÞª %d", d: "ÞÞªÞÞ¦ÞÞ¬ÞÞ°", dd: "ÞÞªÞÞ¦ÞÞ° %d", M: "ÞÞ¦ÞÞ¬ÞÞ°", MM: "ÞÞ¦ÞÞ° %d", y: "ÞÞ¦ÞÞ¦ÞÞ¬ÞÞ°", yy: "ÞÞ¦ÞÞ¦ÞÞª %d" }, preparse: function (a) { return a.replace(/Ø/g, ",") }, postformat: function (a) { return a.replace(/,/g, "Ø") }, week: { dow: 7, doy: 12 } }), Kf.defineLocale("el", { monthsNominativeEl: "ÎÎ±Î½Î¿ÏÎ¬ÏÎ¹Î¿Ï_Î¦ÎµÎ²ÏÎ¿ÏÎ¬ÏÎ¹Î¿Ï_ÎÎ¬ÏÏÎ¹Î¿Ï_ÎÏÏÎ¯Î»Î¹Î¿Ï_ÎÎ¬Î¹Î¿Ï_ÎÎ¿ÏÎ½Î¹Î¿Ï_ÎÎ¿ÏÎ»Î¹Î¿Ï_ÎÏÎ³Î¿ÏÏÏÎ¿Ï_Î£ÎµÏÏÎ­Î¼Î²ÏÎ¹Î¿Ï_ÎÎºÏÏÎ²ÏÎ¹Î¿Ï_ÎÎ¿Î­Î¼Î²ÏÎ¹Î¿Ï_ÎÎµÎºÎ­Î¼Î²ÏÎ¹Î¿Ï".split("_"), monthsGenitiveEl: "ÎÎ±Î½Î¿ÏÎ±ÏÎ¯Î¿Ï_Î¦ÎµÎ²ÏÎ¿ÏÎ±ÏÎ¯Î¿Ï_ÎÎ±ÏÏÎ¯Î¿Ï_ÎÏÏÎ¹Î»Î¯Î¿Ï_ÎÎ±ÎÎ¿Ï_ÎÎ¿ÏÎ½Î¯Î¿Ï_ÎÎ¿ÏÎ»Î¯Î¿Ï_ÎÏÎ³Î¿ÏÏÏÎ¿Ï_Î£ÎµÏÏÎµÎ¼Î²ÏÎ¯Î¿Ï_ÎÎºÏÏÎ²ÏÎ¯Î¿Ï_ÎÎ¿ÎµÎ¼Î²ÏÎ¯Î¿Ï_ÎÎµÎºÎµÎ¼Î²ÏÎ¯Î¿Ï".split("_"), months: function (a, b) { return /D/.test(b.substring(0, b.indexOf("MMMM"))) ? this._monthsGenitiveEl[a.month()] : this._monthsNominativeEl[a.month()] }, monthsShort: "ÎÎ±Î½_Î¦ÎµÎ²_ÎÎ±Ï_ÎÏÏ_ÎÎ±Ï_ÎÎ¿ÏÎ½_ÎÎ¿ÏÎ»_ÎÏÎ³_Î£ÎµÏ_ÎÎºÏ_ÎÎ¿Îµ_ÎÎµÎº".split("_"), weekdays: "ÎÏÏÎ¹Î±ÎºÎ®_ÎÎµÏÏÎ­ÏÎ±_Î¤ÏÎ¯ÏÎ·_Î¤ÎµÏÎ¬ÏÏÎ·_Î Î­Î¼ÏÏÎ·_Î Î±ÏÎ±ÏÎºÎµÏÎ®_Î£Î¬Î²Î²Î±ÏÎ¿".split("_"), weekdaysShort: "ÎÏÏ_ÎÎµÏ_Î¤ÏÎ¹_Î¤ÎµÏ_Î ÎµÎ¼_Î Î±Ï_Î£Î±Î²".split("_"), weekdaysMin: "ÎÏ_ÎÎµ_Î¤Ï_Î¤Îµ_Î Îµ_Î Î±_Î£Î±".split("_"), meridiem: function (a, b, c) { return a > 11 ? c ? "Î¼Î¼" : "ÎÎ" : c ? "ÏÎ¼" : "Î Î" }, isPM: function (a) { return "Î¼" === (a + "").toLowerCase()[0] }, meridiemParse: /[Î Î]\.?Î?\.?/i, longDateFormat: { LT: "h:mm A", LTS: "h:mm:ss A", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY h:mm A", LLLL: "dddd, D MMMM YYYY h:mm A" }, calendarEl: { sameDay: "[Î£Î®Î¼ÎµÏÎ± {}] LT", nextDay: "[ÎÏÏÎ¹Î¿ {}] LT", nextWeek: "dddd [{}] LT", lastDay: "[Î§Î¸ÎµÏ {}] LT", lastWeek: function () { switch (this.day()) { case 6: return "[ÏÎ¿ ÏÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿] dddd [{}] LT"; default: return "[ÏÎ·Î½ ÏÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î·] dddd [{}] LT" } }, sameElse: "L" }, calendar: function (a, b) { var c = this._calendarEl[a], d = b && b.hours(); return D(c) && (c = c.apply(b)), c.replace("{}", d % 12 === 1 ? "ÏÏÎ·" : "ÏÏÎ¹Ï") }, relativeTime: { future: "ÏÎµ %s", past: "%s ÏÏÎ¹Î½", s: "Î»Î¯Î³Î± Î´ÎµÏÏÎµÏÏÎ»ÎµÏÏÎ±", m: "Î­Î½Î± Î»ÎµÏÏÏ", mm: "%d Î»ÎµÏÏÎ¬", h: "Î¼Î¯Î± ÏÏÎ±", hh: "%d ÏÏÎµÏ", d: "Î¼Î¯Î± Î¼Î­ÏÎ±", dd: "%d Î¼Î­ÏÎµÏ", M: "Î­Î½Î±Ï Î¼Î®Î½Î±Ï", MM: "%d Î¼Î®Î½ÎµÏ", y: "Î­Î½Î±Ï ÏÏÏÎ½Î¿Ï", yy: "%d ÏÏÏÎ½Î¹Î±" }, ordinalParse: /\d{1,2}Î·/, ordinal: "%dÎ·", week: { dow: 1, doy: 4 } }), Kf.defineLocale("en-au", { months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"), monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"), weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"), longDateFormat: { LT: "h:mm A", LTS: "h:mm:ss A", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY h:mm A", LLLL: "dddd, D MMMM YYYY h:mm A" }, calendar: { sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L" }, relativeTime: { future: "in %s", past: "%s ago", s: "a few seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years" }, ordinalParse: /\d{1,2}(st|nd|rd|th)/, ordinal: function (a) { var b = a % 10, c = 1 === ~~(a % 100 / 10) ? "th" : 1 === b ? "st" : 2 === b ? "nd" : 3 === b ? "rd" : "th"; return a + c }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("en-ca", { months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"), monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"), weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"), longDateFormat: { LT: "h:mm A", LTS: "h:mm:ss A", L: "YYYY-MM-DD", LL: "D MMMM, YYYY", LLL: "D MMMM, YYYY h:mm A", LLLL: "dddd, D MMMM, YYYY h:mm A" }, calendar: { sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L" }, relativeTime: { future: "in %s", past: "%s ago", s: "a few seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years" }, ordinalParse: /\d{1,2}(st|nd|rd|th)/, ordinal: function (a) { var b = a % 10, c = 1 === ~~(a % 100 / 10) ? "th" : 1 === b ? "st" : 2 === b ? "nd" : 3 === b ? "rd" : "th"; return a + c } }), Kf.defineLocale("en-gb", { months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"), monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"), weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L" }, relativeTime: { future: "in %s", past: "%s ago", s: "a few seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years" }, ordinalParse: /\d{1,2}(st|nd|rd|th)/, ordinal: function (a) { var b = a % 10, c = 1 === ~~(a % 100 / 10) ? "th" : 1 === b ? "st" : 2 === b ? "nd" : 3 === b ? "rd" : "th"; return a + c }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("en-ie", { months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"), monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"), weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD-MM-YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L" }, relativeTime: { future: "in %s", past: "%s ago", s: "a few seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years" }, ordinalParse: /\d{1,2}(st|nd|rd|th)/, ordinal: function (a) { var b = a % 10, c = 1 === ~~(a % 100 / 10) ? "th" : 1 === b ? "st" : 2 === b ? "nd" : 3 === b ? "rd" : "th"; return a + c }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("en-nz", { months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"), monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"), weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"), longDateFormat: { LT: "h:mm A", LTS: "h:mm:ss A", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY h:mm A", LLLL: "dddd, D MMMM YYYY h:mm A" }, calendar: { sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L" }, relativeTime: { future: "in %s", past: "%s ago", s: "a few seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years" }, ordinalParse: /\d{1,2}(st|nd|rd|th)/, ordinal: function (a) { var b = a % 10, c = 1 === ~~(a % 100 / 10) ? "th" : 1 === b ? "st" : 2 === b ? "nd" : 3 === b ? "rd" : "th"; return a + c }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("eo", {
        months: "januaro_februaro_marto_aprilo_majo_junio_julio_aÅ­gusto_septembro_oktobro_novembro_decembro".split("_"), monthsShort: "jan_feb_mar_apr_maj_jun_jul_aÅ­g_sep_okt_nov_dec".split("_"), weekdays: "DimanÄo_Lundo_Mardo_Merkredo_Ä´aÅ­do_Vendredo_Sabato".split("_"),
        weekdaysShort: "Dim_Lun_Mard_Merk_Ä´aÅ­_Ven_Sab".split("_"), weekdaysMin: "Di_Lu_Ma_Me_Ä´a_Ve_Sa".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "YYYY-MM-DD", LL: "D[-an de] MMMM, YYYY", LLL: "D[-an de] MMMM, YYYY HH:mm", LLLL: "dddd, [la] D[-an de] MMMM, YYYY HH:mm" }, meridiemParse: /[ap]\.t\.m/i, isPM: function (a) { return "p" === a.charAt(0).toLowerCase() }, meridiem: function (a, b, c) { return a > 11 ? c ? "p.t.m." : "P.T.M." : c ? "a.t.m." : "A.T.M." }, calendar: { sameDay: "[HodiaÅ­ je] LT", nextDay: "[MorgaÅ­ je] LT", nextWeek: "dddd [je] LT", lastDay: "[HieraÅ­ je] LT", lastWeek: "[pasinta] dddd [je] LT", sameElse: "L" }, relativeTime: { future: "je %s", past: "antaÅ­ %s", s: "sekundoj", m: "minuto", mm: "%d minutoj", h: "horo", hh: "%d horoj", d: "tago", dd: "%d tagoj", M: "monato", MM: "%d monatoj", y: "jaro", yy: "%d jaroj" }, ordinalParse: /\d{1,2}a/, ordinal: "%da", week: { dow: 1, doy: 7 }
    }), "ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_")), bg = "ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"), cg = (Kf.defineLocale("es", { months: "enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"), monthsShort: function (a, b) { return /-MMM-/.test(b) ? bg[a.month()] : ag[a.month()] }, weekdays: "domingo_lunes_martes_miÃ©rcoles_jueves_viernes_sÃ¡bado".split("_"), weekdaysShort: "dom._lun._mar._miÃ©._jue._vie._sÃ¡b.".split("_"), weekdaysMin: "do_lu_ma_mi_ju_vi_sÃ¡".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD/MM/YYYY", LL: "D [de] MMMM [de] YYYY", LLL: "D [de] MMMM [de] YYYY H:mm", LLLL: "dddd, D [de] MMMM [de] YYYY H:mm" }, calendar: { sameDay: function () { return "[hoy a la" + (1 !== this.hours() ? "s" : "") + "] LT" }, nextDay: function () { return "[maÃ±ana a la" + (1 !== this.hours() ? "s" : "") + "] LT" }, nextWeek: function () { return "dddd [a la" + (1 !== this.hours() ? "s" : "") + "] LT" }, lastDay: function () { return "[ayer a la" + (1 !== this.hours() ? "s" : "") + "] LT" }, lastWeek: function () { return "[el] dddd [pasado a la" + (1 !== this.hours() ? "s" : "") + "] LT" }, sameElse: "L" }, relativeTime: { future: "en %s", past: "hace %s", s: "unos segundos", m: "un minuto", mm: "%d minutos", h: "una hora", hh: "%d horas", d: "un dÃ­a", dd: "%d dÃ­as", M: "un mes", MM: "%d meses", y: "un aÃ±o", yy: "%d aÃ±os" }, ordinalParse: /\d{1,2}Âº/, ordinal: "%dÂº", week: { dow: 1, doy: 4 } }), Kf.defineLocale("et", { months: "jaanuar_veebruar_mÃ¤rts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"), monthsShort: "jaan_veebr_mÃ¤rts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"), weekdays: "pÃ¼hapÃ¤ev_esmaspÃ¤ev_teisipÃ¤ev_kolmapÃ¤ev_neljapÃ¤ev_reede_laupÃ¤ev".split("_"), weekdaysShort: "P_E_T_K_N_R_L".split("_"), weekdaysMin: "P_E_T_K_N_R_L".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD.MM.YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY H:mm", LLLL: "dddd, D. MMMM YYYY H:mm" }, calendar: { sameDay: "[TÃ¤na,] LT", nextDay: "[Homme,] LT", nextWeek: "[JÃ¤rgmine] dddd LT", lastDay: "[Eile,] LT", lastWeek: "[Eelmine] dddd LT", sameElse: "L" }, relativeTime: { future: "%s pÃ¤rast", past: "%s tagasi", s: ed, m: ed, mm: ed, h: ed, hh: ed, d: ed, dd: "%d pÃ¤eva", M: ed, MM: ed, y: ed, yy: ed }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("eu", { months: "urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"), monthsShort: "urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"), weekdays: "igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"), weekdaysShort: "ig._al._ar._az._og._ol._lr.".split("_"), weekdaysMin: "ig_al_ar_az_og_ol_lr".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "YYYY-MM-DD", LL: "YYYY[ko] MMMM[ren] D[a]", LLL: "YYYY[ko] MMMM[ren] D[a] HH:mm", LLLL: "dddd, YYYY[ko] MMMM[ren] D[a] HH:mm", l: "YYYY-M-D", ll: "YYYY[ko] MMM D[a]", lll: "YYYY[ko] MMM D[a] HH:mm", llll: "ddd, YYYY[ko] MMM D[a] HH:mm" }, calendar: { sameDay: "[gaur] LT[etan]", nextDay: "[bihar] LT[etan]", nextWeek: "dddd LT[etan]", lastDay: "[atzo] LT[etan]", lastWeek: "[aurreko] dddd LT[etan]", sameElse: "L" }, relativeTime: { future: "%s barru", past: "duela %s", s: "segundo batzuk", m: "minutu bat", mm: "%d minutu", h: "ordu bat", hh: "%d ordu", d: "egun bat", dd: "%d egun", M: "hilabete bat", MM: "%d hilabete", y: "urte bat", yy: "%d urte" }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 7 } }), { 1: "Û±", 2: "Û²", 3: "Û³", 4: "Û´", 5: "Ûµ", 6: "Û¶", 7: "Û·", 8: "Û¸", 9: "Û¹", 0: "Û°" }), dg = { "Û±": "1", "Û²": "2", "Û³": "3", "Û´": "4", "Ûµ": "5", "Û¶": "6", "Û·": "7", "Û¸": "8", "Û¹": "9", "Û°": "0" }, eg = (Kf.defineLocale("fa", { months: "ÚØ§ÙÙÛÙ_ÙÙØ±ÛÙ_ÙØ§Ø±Ø³_Ø¢ÙØ±ÛÙ_ÙÙ_ÚÙØ¦Ù_ÚÙØ¦ÛÙ_Ø§ÙØª_Ø³Ù¾ØªØ§ÙØ¨Ø±_Ø§Ú©ØªØ¨Ø±_ÙÙØ§ÙØ¨Ø±_Ø¯Ø³Ø§ÙØ¨Ø±".split("_"), monthsShort: "ÚØ§ÙÙÛÙ_ÙÙØ±ÛÙ_ÙØ§Ø±Ø³_Ø¢ÙØ±ÛÙ_ÙÙ_ÚÙØ¦Ù_ÚÙØ¦ÛÙ_Ø§ÙØª_Ø³Ù¾ØªØ§ÙØ¨Ø±_Ø§Ú©ØªØ¨Ø±_ÙÙØ§ÙØ¨Ø±_Ø¯Ø³Ø§ÙØ¨Ø±".split("_"), weekdays: "ÛÚ©âØ´ÙØ¨Ù_Ø¯ÙØ´ÙØ¨Ù_Ø³ÙâØ´ÙØ¨Ù_ÚÙØ§Ø±Ø´ÙØ¨Ù_Ù¾ÙØ¬âØ´ÙØ¨Ù_Ø¬ÙØ¹Ù_Ø´ÙØ¨Ù".split("_"), weekdaysShort: "ÛÚ©âØ´ÙØ¨Ù_Ø¯ÙØ´ÙØ¨Ù_Ø³ÙâØ´ÙØ¨Ù_ÚÙØ§Ø±Ø´ÙØ¨Ù_Ù¾ÙØ¬âØ´ÙØ¨Ù_Ø¬ÙØ¹Ù_Ø´ÙØ¨Ù".split("_"), weekdaysMin: "Û_Ø¯_Ø³_Ú_Ù¾_Ø¬_Ø´".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, meridiemParse: /ÙØ¨Ù Ø§Ø² Ø¸ÙØ±|Ø¨Ø¹Ø¯ Ø§Ø² Ø¸ÙØ±/, isPM: function (a) { return /Ø¨Ø¹Ø¯ Ø§Ø² Ø¸ÙØ±/.test(a) }, meridiem: function (a, b, c) { return 12 > a ? "ÙØ¨Ù Ø§Ø² Ø¸ÙØ±" : "Ø¨Ø¹Ø¯ Ø§Ø² Ø¸ÙØ±" }, calendar: { sameDay: "[Ø§ÙØ±ÙØ² Ø³Ø§Ø¹Øª] LT", nextDay: "[ÙØ±Ø¯Ø§ Ø³Ø§Ø¹Øª] LT", nextWeek: "dddd [Ø³Ø§Ø¹Øª] LT", lastDay: "[Ø¯ÛØ±ÙØ² Ø³Ø§Ø¹Øª] LT", lastWeek: "dddd [Ù¾ÛØ´] [Ø³Ø§Ø¹Øª] LT", sameElse: "L" }, relativeTime: { future: "Ø¯Ø± %s", past: "%s Ù¾ÛØ´", s: "ÚÙØ¯ÛÙ Ø«Ø§ÙÛÙ", m: "ÛÚ© Ø¯ÙÛÙÙ", mm: "%d Ø¯ÙÛÙÙ", h: "ÛÚ© Ø³Ø§Ø¹Øª", hh: "%d Ø³Ø§Ø¹Øª", d: "ÛÚ© Ø±ÙØ²", dd: "%d Ø±ÙØ²", M: "ÛÚ© ÙØ§Ù", MM: "%d ÙØ§Ù", y: "ÛÚ© Ø³Ø§Ù", yy: "%d Ø³Ø§Ù" }, preparse: function (a) { return a.replace(/[Û°-Û¹]/g, function (a) { return dg[a] }).replace(/Ø/g, ",") }, postformat: function (a) { return a.replace(/\d/g, function (a) { return cg[a] }).replace(/,/g, "Ø") }, ordinalParse: /\d{1,2}Ù/, ordinal: "%dÙ", week: { dow: 6, doy: 12 } }), "nolla yksi kaksi kolme neljÃ¤ viisi kuusi seitsemÃ¤n kahdeksan yhdeksÃ¤n".split(" ")), fg = ["nolla", "yhden", "kahden", "kolmen", "neljÃ¤n", "viiden", "kuuden", eg[7], eg[8], eg[9]], gg = (Kf.defineLocale("fi", { months: "tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_kesÃ¤kuu_heinÃ¤kuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"), monthsShort: "tammi_helmi_maalis_huhti_touko_kesÃ¤_heinÃ¤_elo_syys_loka_marras_joulu".split("_"), weekdays: "sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"), weekdaysShort: "su_ma_ti_ke_to_pe_la".split("_"), weekdaysMin: "su_ma_ti_ke_to_pe_la".split("_"), longDateFormat: { LT: "HH.mm", LTS: "HH.mm.ss", L: "DD.MM.YYYY", LL: "Do MMMM[ta] YYYY", LLL: "Do MMMM[ta] YYYY, [klo] HH.mm", LLLL: "dddd, Do MMMM[ta] YYYY, [klo] HH.mm", l: "D.M.YYYY", ll: "Do MMM YYYY", lll: "Do MMM YYYY, [klo] HH.mm", llll: "ddd, Do MMM YYYY, [klo] HH.mm" }, calendar: { sameDay: "[tÃ¤nÃ¤Ã¤n] [klo] LT", nextDay: "[huomenna] [klo] LT", nextWeek: "dddd [klo] LT", lastDay: "[eilen] [klo] LT", lastWeek: "[viime] dddd[na] [klo] LT", sameElse: "L" }, relativeTime: { future: "%s pÃ¤Ã¤stÃ¤", past: "%s sitten", s: fd, m: fd, mm: fd, h: fd, hh: fd, d: fd, dd: fd, M: fd, MM: fd, y: fd, yy: fd }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("fo", { months: "januar_februar_mars_aprÃ­l_mai_juni_juli_august_september_oktober_november_desember".split("_"), monthsShort: "jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"), weekdays: "sunnudagur_mÃ¡nadagur_tÃ½sdagur_mikudagur_hÃ³sdagur_frÃ­ggjadagur_leygardagur".split("_"), weekdaysShort: "sun_mÃ¡n_tÃ½s_mik_hÃ³s_frÃ­_ley".split("_"), weekdaysMin: "su_mÃ¡_tÃ½_mi_hÃ³_fr_le".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D. MMMM, YYYY HH:mm" }, calendar: { sameDay: "[Ã dag kl.] LT", nextDay: "[Ã morgin kl.] LT", nextWeek: "dddd [kl.] LT", lastDay: "[Ã gjÃ¡r kl.] LT", lastWeek: "[sÃ­Ã°stu] dddd [kl] LT", sameElse: "L" }, relativeTime: { future: "um %s", past: "%s sÃ­Ã°ani", s: "fÃ¡ sekund", m: "ein minutt", mm: "%d minuttir", h: "ein tÃ­mi", hh: "%d tÃ­mar", d: "ein dagur", dd: "%d dagar", M: "ein mÃ¡naÃ°i", MM: "%d mÃ¡naÃ°ir", y: "eitt Ã¡r", yy: "%d Ã¡r" }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("fr-ca", { months: "janvier_fÃ©vrier_mars_avril_mai_juin_juillet_aoÃ»t_septembre_octobre_novembre_dÃ©cembre".split("_"), monthsShort: "janv._fÃ©vr._mars_avr._mai_juin_juil._aoÃ»t_sept._oct._nov._dÃ©c.".split("_"), weekdays: "dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"), weekdaysShort: "dim._lun._mar._mer._jeu._ven._sam.".split("_"), weekdaysMin: "Di_Lu_Ma_Me_Je_Ve_Sa".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "YYYY-MM-DD", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Aujourd'hui Ã ] LT", nextDay: "[Demain Ã ] LT", nextWeek: "dddd [Ã ] LT", lastDay: "[Hier Ã ] LT", lastWeek: "dddd [dernier Ã ] LT", sameElse: "L" }, relativeTime: { future: "dans %s", past: "il y a %s", s: "quelques secondes", m: "une minute", mm: "%d minutes", h: "une heure", hh: "%d heures", d: "un jour", dd: "%d jours", M: "un mois", MM: "%d mois", y: "un an", yy: "%d ans" }, ordinalParse: /\d{1,2}(er|e)/, ordinal: function (a) { return a + (1 === a ? "er" : "e") } }), Kf.defineLocale("fr-ch", { months: "janvier_fÃ©vrier_mars_avril_mai_juin_juillet_aoÃ»t_septembre_octobre_novembre_dÃ©cembre".split("_"), monthsShort: "janv._fÃ©vr._mars_avr._mai_juin_juil._aoÃ»t_sept._oct._nov._dÃ©c.".split("_"), weekdays: "dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"), weekdaysShort: "dim._lun._mar._mer._jeu._ven._sam.".split("_"), weekdaysMin: "Di_Lu_Ma_Me_Je_Ve_Sa".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Aujourd'hui Ã ] LT", nextDay: "[Demain Ã ] LT", nextWeek: "dddd [Ã ] LT", lastDay: "[Hier Ã ] LT", lastWeek: "dddd [dernier Ã ] LT", sameElse: "L" }, relativeTime: { future: "dans %s", past: "il y a %s", s: "quelques secondes", m: "une minute", mm: "%d minutes", h: "une heure", hh: "%d heures", d: "un jour", dd: "%d jours", M: "un mois", MM: "%d mois", y: "un an", yy: "%d ans" }, ordinalParse: /\d{1,2}(er|e)/, ordinal: function (a) { return a + (1 === a ? "er" : "e") }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("fr", { months: "janvier_fÃ©vrier_mars_avril_mai_juin_juillet_aoÃ»t_septembre_octobre_novembre_dÃ©cembre".split("_"), monthsShort: "janv._fÃ©vr._mars_avr._mai_juin_juil._aoÃ»t_sept._oct._nov._dÃ©c.".split("_"), weekdays: "dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"), weekdaysShort: "dim._lun._mar._mer._jeu._ven._sam.".split("_"), weekdaysMin: "Di_Lu_Ma_Me_Je_Ve_Sa".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Aujourd'hui Ã ] LT", nextDay: "[Demain Ã ] LT", nextWeek: "dddd [Ã ] LT", lastDay: "[Hier Ã ] LT", lastWeek: "dddd [dernier Ã ] LT", sameElse: "L" }, relativeTime: { future: "dans %s", past: "il y a %s", s: "quelques secondes", m: "une minute", mm: "%d minutes", h: "une heure", hh: "%d heures", d: "un jour", dd: "%d jours", M: "un mois", MM: "%d mois", y: "un an", yy: "%d ans" }, ordinalParse: /\d{1,2}(er|)/, ordinal: function (a) { return a + (1 === a ? "er" : "") }, week: { dow: 1, doy: 4 } }), "jan._feb._mrt._apr._mai_jun._jul._aug._sep._okt._nov._des.".split("_")), hg = "jan_feb_mrt_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"), ig = (Kf.defineLocale("fy", { months: "jannewaris_febrewaris_maart_april_maaie_juny_july_augustus_septimber_oktober_novimber_desimber".split("_"), monthsShort: function (a, b) { return /-MMM-/.test(b) ? hg[a.month()] : gg[a.month()] }, weekdays: "snein_moandei_tiisdei_woansdei_tongersdei_freed_sneon".split("_"), weekdaysShort: "si._mo._ti._wo._to._fr._so.".split("_"), weekdaysMin: "Si_Mo_Ti_Wo_To_Fr_So".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD-MM-YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[hjoed om] LT", nextDay: "[moarn om] LT", nextWeek: "dddd [om] LT", lastDay: "[juster om] LT", lastWeek: "[Ã´frÃ»ne] dddd [om] LT", sameElse: "L" }, relativeTime: { future: "oer %s", past: "%s lyn", s: "in pear sekonden", m: "ien minÃºt", mm: "%d minuten", h: "ien oere", hh: "%d oeren", d: "ien dei", dd: "%d dagen", M: "ien moanne", MM: "%d moannen", y: "ien jier", yy: "%d jierren" }, ordinalParse: /\d{1,2}(ste|de)/, ordinal: function (a) { return a + (1 === a || 8 === a || a >= 20 ? "ste" : "de") }, week: { dow: 1, doy: 4 } }), ["Am Faoilleach", "An Gearran", "Am MÃ rt", "An Giblean", "An CÃ¨itean", "An t-Ãgmhios", "An t-Iuchar", "An LÃ¹nastal", "An t-Sultain", "An DÃ mhair", "An t-Samhain", "An DÃ¹bhlachd"]), jg = ["Faoi", "Gear", "MÃ rt", "Gibl", "CÃ¨it", "Ãgmh", "Iuch", "LÃ¹n", "Sult", "DÃ mh", "Samh", "DÃ¹bh"], kg = ["DidÃ²mhnaich", "Diluain", "DimÃ irt", "Diciadain", "Diardaoin", "Dihaoine", "Disathairne"], lg = ["Did", "Dil", "Dim", "Dic", "Dia", "Dih", "Dis"], mg = ["DÃ²", "Lu", "MÃ ", "Ci", "Ar", "Ha", "Sa"], ng = (Kf.defineLocale("gd", { months: ig, monthsShort: jg, monthsParseExact: !0, weekdays: kg, weekdaysShort: lg, weekdaysMin: mg, longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[An-diugh aig] LT", nextDay: "[A-mÃ ireach aig] LT", nextWeek: "dddd [aig] LT", lastDay: "[An-dÃ¨ aig] LT", lastWeek: "dddd [seo chaidh] [aig] LT", sameElse: "L" }, relativeTime: { future: "ann an %s", past: "bho chionn %s", s: "beagan diogan", m: "mionaid", mm: "%d mionaidean", h: "uair", hh: "%d uairean", d: "latha", dd: "%d latha", M: "mÃ¬os", MM: "%d mÃ¬osan", y: "bliadhna", yy: "%d bliadhna" }, ordinalParse: /\d{1,2}(d|na|mh)/, ordinal: function (a) { var b = 1 === a ? "d" : a % 10 === 2 ? "na" : "mh"; return a + b }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("gl", { months: "Xaneiro_Febreiro_Marzo_Abril_Maio_XuÃ±o_Xullo_Agosto_Setembro_Outubro_Novembro_Decembro".split("_"), monthsShort: "Xan._Feb._Mar._Abr._Mai._XuÃ±._Xul._Ago._Set._Out._Nov._Dec.".split("_"), weekdays: "Domingo_Luns_Martes_MÃ©rcores_Xoves_Venres_SÃ¡bado".split("_"), weekdaysShort: "Dom._Lun._Mar._MÃ©r._Xov._Ven._SÃ¡b.".split("_"), weekdaysMin: "Do_Lu_Ma_MÃ©_Xo_Ve_SÃ¡".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY H:mm", LLLL: "dddd D MMMM YYYY H:mm" }, calendar: { sameDay: function () { return "[hoxe " + (1 !== this.hours() ? "Ã¡s" : "Ã¡") + "] LT" }, nextDay: function () { return "[maÃ±Ã¡ " + (1 !== this.hours() ? "Ã¡s" : "Ã¡") + "] LT" }, nextWeek: function () { return "dddd [" + (1 !== this.hours() ? "Ã¡s" : "a") + "] LT" }, lastDay: function () { return "[onte " + (1 !== this.hours() ? "Ã¡" : "a") + "] LT" }, lastWeek: function () { return "[o] dddd [pasado " + (1 !== this.hours() ? "Ã¡s" : "a") + "] LT" }, sameElse: "L" }, relativeTime: { future: function (a) { return "uns segundos" === a ? "nuns segundos" : "en " + a }, past: "hai %s", s: "uns segundos", m: "un minuto", mm: "%d minutos", h: "unha hora", hh: "%d horas", d: "un dÃ­a", dd: "%d dÃ­as", M: "un mes", MM: "%d meses", y: "un ano", yy: "%d anos" }, ordinalParse: /\d{1,2}Âº/, ordinal: "%dÂº", week: { dow: 1, doy: 7 } }), Kf.defineLocale("he", { months: "×× ×××¨_×¤××¨×××¨_××¨×¥_××¤×¨××_×××_××× ×_××××_×××××¡×_×¡×¤××××¨_×××§××××¨_× ×××××¨_××¦×××¨".split("_"), monthsShort: "×× ××³_×¤××¨×³_××¨×¥_××¤×¨×³_×××_××× ×_××××_××××³_×¡×¤××³_×××§×³_× ×××³_××¦××³".split("_"), weekdays: "×¨××©××_×©× ×_×©×××©×_×¨×××¢×_××××©×_×©××©×_×©××ª".split("_"), weekdaysShort: "××³_××³_××³_××³_××³_××³_×©×³".split("_"), weekdaysMin: "×_×_×_×_×_×_×©".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D [×]MMMM YYYY", LLL: "D [×]MMMM YYYY HH:mm", LLLL: "dddd, D [×]MMMM YYYY HH:mm", l: "D/M/YYYY", ll: "D MMM YYYY", lll: "D MMM YYYY HH:mm", llll: "ddd, D MMM YYYY HH:mm" }, calendar: { sameDay: "[×××× ×Ö¾]LT", nextDay: "[×××¨ ×Ö¾]LT", nextWeek: "dddd [××©×¢×] LT", lastDay: "[××ª××× ×Ö¾]LT", lastWeek: "[××××] dddd [××××¨×× ××©×¢×] LT", sameElse: "L" }, relativeTime: { future: "××¢×× %s", past: "××¤× × %s", s: "××¡×¤×¨ ×©× ×××ª", m: "××§×", mm: "%d ××§××ª", h: "×©×¢×", hh: function (a) { return 2 === a ? "×©×¢×ª×××" : a + " ×©×¢××ª" }, d: "×××", dd: function (a) { return 2 === a ? "××××××" : a + " ××××" }, M: "××××©", MM: function (a) { return 2 === a ? "××××©×××" : a + " ××××©××" }, y: "×©× ×", yy: function (a) { return 2 === a ? "×©× ×ª×××" : a % 10 === 0 && 10 !== a ? a + " ×©× ×" : a + " ×©× ××" } } }), { 1: "à¥§", 2: "à¥¨", 3: "à¥©", 4: "à¥ª", 5: "à¥«", 6: "à¥¬", 7: "à¥­", 8: "à¥®", 9: "à¥¯", 0: "à¥¦" }), og = { "à¥§": "1", "à¥¨": "2", "à¥©": "3", "à¥ª": "4", "à¥«": "5", "à¥¬": "6", "à¥­": "7", "à¥®": "8", "à¥¯": "9", "à¥¦": "0" }, pg = (Kf.defineLocale("hi", { months: "à¤à¤¨à¤µà¤°à¥_à¤«à¤¼à¤°à¤µà¤°à¥_à¤®à¤¾à¤°à¥à¤_à¤à¤ªà¥à¤°à¥à¤²_à¤®à¤_à¤à¥à¤¨_à¤à¥à¤²à¤¾à¤_à¤à¤à¤¸à¥à¤¤_à¤¸à¤¿à¤¤à¤®à¥à¤¬à¤°_à¤à¤à¥à¤à¥à¤¬à¤°_à¤¨à¤µà¤®à¥à¤¬à¤°_à¤¦à¤¿à¤¸à¤®à¥à¤¬à¤°".split("_"), monthsShort: "à¤à¤¨._à¤«à¤¼à¤°._à¤®à¤¾à¤°à¥à¤_à¤à¤ªà¥à¤°à¥._à¤®à¤_à¤à¥à¤¨_à¤à¥à¤²._à¤à¤._à¤¸à¤¿à¤¤._à¤à¤à¥à¤à¥._à¤¨à¤µ._à¤¦à¤¿à¤¸.".split("_"), weekdays: "à¤°à¤µà¤¿à¤µà¤¾à¤°_à¤¸à¥à¤®à¤µà¤¾à¤°_à¤®à¤à¤à¤²à¤µà¤¾à¤°_à¤¬à¥à¤§à¤µà¤¾à¤°_à¤à¥à¤°à¥à¤µà¤¾à¤°_à¤¶à¥à¤à¥à¤°à¤µà¤¾à¤°_à¤¶à¤¨à¤¿à¤µà¤¾à¤°".split("_"), weekdaysShort: "à¤°à¤µà¤¿_à¤¸à¥à¤®_à¤®à¤à¤à¤²_à¤¬à¥à¤§_à¤à¥à¤°à¥_à¤¶à¥à¤à¥à¤°_à¤¶à¤¨à¤¿".split("_"), weekdaysMin: "à¤°_à¤¸à¥_à¤®à¤_à¤¬à¥_à¤à¥_à¤¶à¥_à¤¶".split("_"), longDateFormat: { LT: "A h:mm à¤¬à¤à¥", LTS: "A h:mm:ss à¤¬à¤à¥", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY, A h:mm à¤¬à¤à¥", LLLL: "dddd, D MMMM YYYY, A h:mm à¤¬à¤à¥" }, calendar: { sameDay: "[à¤à¤] LT", nextDay: "[à¤à¤²] LT", nextWeek: "dddd, LT", lastDay: "[à¤à¤²] LT", lastWeek: "[à¤ªà¤¿à¤à¤²à¥] dddd, LT", sameElse: "L" }, relativeTime: { future: "%s à¤®à¥à¤", past: "%s à¤ªà¤¹à¤²à¥", s: "à¤à¥à¤ à¤¹à¥ à¤à¥à¤·à¤£", m: "à¤à¤ à¤®à¤¿à¤¨à¤", mm: "%d à¤®à¤¿à¤¨à¤", h: "à¤à¤ à¤à¤à¤à¤¾", hh: "%d à¤à¤à¤à¥", d: "à¤à¤ à¤¦à¤¿à¤¨", dd: "%d à¤¦à¤¿à¤¨", M: "à¤à¤ à¤®à¤¹à¥à¤¨à¥", MM: "%d à¤®à¤¹à¥à¤¨à¥", y: "à¤à¤ à¤µà¤°à¥à¤·", yy: "%d à¤µà¤°à¥à¤·" }, preparse: function (a) { return a.replace(/[à¥§à¥¨à¥©à¥ªà¥«à¥¬à¥­à¥®à¥¯à¥¦]/g, function (a) { return og[a] }) }, postformat: function (a) { return a.replace(/\d/g, function (a) { return ng[a] }) }, meridiemParse: /à¤°à¤¾à¤¤|à¤¸à¥à¤¬à¤¹|à¤¦à¥à¤ªà¤¹à¤°|à¤¶à¤¾à¤®/, meridiemHour: function (a, b) { return 12 === a && (a = 0), "à¤°à¤¾à¤¤" === b ? 4 > a ? a : a + 12 : "à¤¸à¥à¤¬à¤¹" === b ? a : "à¤¦à¥à¤ªà¤¹à¤°" === b ? a >= 10 ? a : a + 12 : "à¤¶à¤¾à¤®" === b ? a + 12 : void 0 }, meridiem: function (a, b, c) { return 4 > a ? "à¤°à¤¾à¤¤" : 10 > a ? "à¤¸à¥à¤¬à¤¹" : 17 > a ? "à¤¦à¥à¤ªà¤¹à¤°" : 20 > a ? "à¤¶à¤¾à¤®" : "à¤°à¤¾à¤¤" }, week: { dow: 0, doy: 6 } }), Kf.defineLocale("hr", { months: { format: "sijeÄnja_veljaÄe_oÅ¾ujka_travnja_svibnja_lipnja_srpnja_kolovoza_rujna_listopada_studenoga_prosinca".split("_"), standalone: "sijeÄanj_veljaÄa_oÅ¾ujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_") }, monthsShort: "sij._velj._oÅ¾u._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"), weekdays: "nedjelja_ponedjeljak_utorak_srijeda_Äetvrtak_petak_subota".split("_"), weekdaysShort: "ned._pon._uto._sri._Äet._pet._sub.".split("_"), weekdaysMin: "ne_po_ut_sr_Äe_pe_su".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD. MM. YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY H:mm", LLLL: "dddd, D. MMMM YYYY H:mm" }, calendar: { sameDay: "[danas u] LT", nextDay: "[sutra u] LT", nextWeek: function () { switch (this.day()) { case 0: return "[u] [nedjelju] [u] LT"; case 3: return "[u] [srijedu] [u] LT"; case 6: return "[u] [subotu] [u] LT"; case 1: case 2: case 4: case 5: return "[u] dddd [u] LT" } }, lastDay: "[juÄer u] LT", lastWeek: function () { switch (this.day()) { case 0: case 3: return "[proÅ¡lu] dddd [u] LT"; case 6: return "[proÅ¡le] [subote] [u] LT"; case 1: case 2: case 4: case 5: return "[proÅ¡li] dddd [u] LT" } }, sameElse: "L" }, relativeTime: { future: "za %s", past: "prije %s", s: "par sekundi", m: hd, mm: hd, h: hd, hh: hd, d: "dan", dd: hd, M: "mjesec", MM: hd, y: "godinu", yy: hd }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 7 } }), "vasÃ¡rnap hÃ©tfÅn kedden szerdÃ¡n csÃ¼tÃ¶rtÃ¶kÃ¶n pÃ©nteken szombaton".split(" ")), qg = (Kf.defineLocale("hu", { months: "januÃ¡r_februÃ¡r_mÃ¡rcius_Ã¡prilis_mÃ¡jus_jÃºnius_jÃºlius_augusztus_szeptember_oktÃ³ber_november_december".split("_"), monthsShort: "jan_feb_mÃ¡rc_Ã¡pr_mÃ¡j_jÃºn_jÃºl_aug_szept_okt_nov_dec".split("_"), weekdays: "vasÃ¡rnap_hÃ©tfÅ_kedd_szerda_csÃ¼tÃ¶rtÃ¶k_pÃ©ntek_szombat".split("_"), weekdaysShort: "vas_hÃ©t_kedd_sze_csÃ¼t_pÃ©n_szo".split("_"), weekdaysMin: "v_h_k_sze_cs_p_szo".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "YYYY.MM.DD.", LL: "YYYY. MMMM D.", LLL: "YYYY. MMMM D. H:mm", LLLL: "YYYY. MMMM D., dddd H:mm" }, meridiemParse: /de|du/i, isPM: function (a) { return "u" === a.charAt(1).toLowerCase() }, meridiem: function (a, b, c) { return 12 > a ? c === !0 ? "de" : "DE" : c === !0 ? "du" : "DU" }, calendar: { sameDay: "[ma] LT[-kor]", nextDay: "[holnap] LT[-kor]", nextWeek: function () { return jd.call(this, !0) }, lastDay: "[tegnap] LT[-kor]", lastWeek: function () { return jd.call(this, !1) }, sameElse: "L" }, relativeTime: { future: "%s mÃºlva", past: "%s", s: id, m: id, mm: id, h: id, hh: id, d: id, dd: id, M: id, MM: id, y: id, yy: id }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 7 } }), Kf.defineLocale("hy-am", { months: { format: "Õ°Õ¸ÖÕ¶Õ¾Õ¡ÖÕ«_ÖÕ¥Õ¿ÖÕ¾Õ¡ÖÕ«_Õ´Õ¡ÖÕ¿Õ«_Õ¡ÕºÖÕ«Õ¬Õ«_Õ´Õ¡ÕµÕ«Õ½Õ«_Õ°Õ¸ÖÕ¶Õ«Õ½Õ«_Õ°Õ¸ÖÕ¬Õ«Õ½Õ«_ÖÕ£Õ¸Õ½Õ¿Õ¸Õ½Õ«_Õ½Õ¥ÕºÕ¿Õ¥Õ´Õ¢Õ¥ÖÕ«_Õ°Õ¸Õ¯Õ¿Õ¥Õ´Õ¢Õ¥ÖÕ«_Õ¶Õ¸ÕµÕ¥Õ´Õ¢Õ¥ÖÕ«_Õ¤Õ¥Õ¯Õ¿Õ¥Õ´Õ¢Õ¥ÖÕ«".split("_"), standalone: "Õ°Õ¸ÖÕ¶Õ¾Õ¡Ö_ÖÕ¥Õ¿ÖÕ¾Õ¡Ö_Õ´Õ¡ÖÕ¿_Õ¡ÕºÖÕ«Õ¬_Õ´Õ¡ÕµÕ«Õ½_Õ°Õ¸ÖÕ¶Õ«Õ½_Õ°Õ¸ÖÕ¬Õ«Õ½_ÖÕ£Õ¸Õ½Õ¿Õ¸Õ½_Õ½Õ¥ÕºÕ¿Õ¥Õ´Õ¢Õ¥Ö_Õ°Õ¸Õ¯Õ¿Õ¥Õ´Õ¢Õ¥Ö_Õ¶Õ¸ÕµÕ¥Õ´Õ¢Õ¥Ö_Õ¤Õ¥Õ¯Õ¿Õ¥Õ´Õ¢Õ¥Ö".split("_") }, monthsShort: "Õ°Õ¶Õ¾_ÖÕ¿Ö_Õ´ÖÕ¿_Õ¡ÕºÖ_Õ´ÕµÕ½_Õ°Õ¶Õ½_Õ°Õ¬Õ½_ÖÕ£Õ½_Õ½ÕºÕ¿_Õ°Õ¯Õ¿_Õ¶Õ´Õ¢_Õ¤Õ¯Õ¿".split("_"), weekdays: "Õ¯Õ«ÖÕ¡Õ¯Õ«_Õ¥ÖÕ¯Õ¸ÖÕ·Õ¡Õ¢Õ©Õ«_Õ¥ÖÕ¥ÖÕ·Õ¡Õ¢Õ©Õ«_Õ¹Õ¸ÖÕ¥ÖÕ·Õ¡Õ¢Õ©Õ«_Õ°Õ«Õ¶Õ£Õ·Õ¡Õ¢Õ©Õ«_Õ¸ÖÖÕ¢Õ¡Õ©_Õ·Õ¡Õ¢Õ¡Õ©".split("_"), weekdaysShort: "Õ¯ÖÕ¯_Õ¥ÖÕ¯_Õ¥ÖÖ_Õ¹ÖÖ_Õ°Õ¶Õ£_Õ¸ÖÖÕ¢_Õ·Õ¢Õ©".split("_"), weekdaysMin: "Õ¯ÖÕ¯_Õ¥ÖÕ¯_Õ¥ÖÖ_Õ¹ÖÖ_Õ°Õ¶Õ£_Õ¸ÖÖÕ¢_Õ·Õ¢Õ©".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY Õ©.", LLL: "D MMMM YYYY Õ©., HH:mm", LLLL: "dddd, D MMMM YYYY Õ©., HH:mm" }, calendar: { sameDay: "[Õ¡ÕµÕ½ÖÖ] LT", nextDay: "[Õ¾Õ¡Õ²Õ¨] LT", lastDay: "[Õ¥ÖÕ¥Õ¯] LT", nextWeek: function () { return "dddd [ÖÖÕ¨ ÕªÕ¡Õ´Õ¨] LT" }, lastWeek: function () { return "[Õ¡Õ¶ÖÕ¡Õ®] dddd [ÖÖÕ¨ ÕªÕ¡Õ´Õ¨] LT" }, sameElse: "L" }, relativeTime: { future: "%s Õ°Õ¥Õ¿Õ¸", past: "%s Õ¡Õ¼Õ¡Õ»", s: "Õ´Õ« ÖÕ¡Õ¶Õ« Õ¾Õ¡ÕµÖÕ¯ÕµÕ¡Õ¶", m: "ÖÕ¸ÕºÕ¥", mm: "%d ÖÕ¸ÕºÕ¥", h: "ÕªÕ¡Õ´", hh: "%d ÕªÕ¡Õ´", d: "ÖÖ", dd: "%d ÖÖ", M: "Õ¡Õ´Õ«Õ½", MM: "%d Õ¡Õ´Õ«Õ½", y: "Õ¿Õ¡ÖÕ«", yy: "%d Õ¿Õ¡ÖÕ«" }, meridiemParse: /Õ£Õ«Õ·Õ¥ÖÕ¾Õ¡|Õ¡Õ¼Õ¡Õ¾Õ¸Õ¿Õ¾Õ¡|ÖÕ¥ÖÕ¥Õ¯Õ¾Õ¡|Õ¥ÖÕ¥Õ¯Õ¸ÕµÕ¡Õ¶/, isPM: function (a) { return /^(ÖÕ¥ÖÕ¥Õ¯Õ¾Õ¡|Õ¥ÖÕ¥Õ¯Õ¸ÕµÕ¡Õ¶)$/.test(a) }, meridiem: function (a) { return 4 > a ? "Õ£Õ«Õ·Õ¥ÖÕ¾Õ¡" : 12 > a ? "Õ¡Õ¼Õ¡Õ¾Õ¸Õ¿Õ¾Õ¡" : 17 > a ? "ÖÕ¥ÖÕ¥Õ¯Õ¾Õ¡" : "Õ¥ÖÕ¥Õ¯Õ¸ÕµÕ¡Õ¶" }, ordinalParse: /\d{1,2}|\d{1,2}-(Õ«Õ¶|ÖÕ¤)/, ordinal: function (a, b) { switch (b) { case "DDD": case "w": case "W": case "DDDo": return 1 === a ? a + "-Õ«Õ¶" : a + "-ÖÕ¤"; default: return a } }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("id", { months: "Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"), monthsShort: "Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nov_Des".split("_"), weekdays: "Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"), weekdaysShort: "Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"), weekdaysMin: "Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"), longDateFormat: { LT: "HH.mm", LTS: "HH.mm.ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY [pukul] HH.mm", LLLL: "dddd, D MMMM YYYY [pukul] HH.mm" }, meridiemParse: /pagi|siang|sore|malam/, meridiemHour: function (a, b) { return 12 === a && (a = 0), "pagi" === b ? a : "siang" === b ? a >= 11 ? a : a + 12 : "sore" === b || "malam" === b ? a + 12 : void 0 }, meridiem: function (a, b, c) { return 11 > a ? "pagi" : 15 > a ? "siang" : 19 > a ? "sore" : "malam" }, calendar: { sameDay: "[Hari ini pukul] LT", nextDay: "[Besok pukul] LT", nextWeek: "dddd [pukul] LT", lastDay: "[Kemarin pukul] LT", lastWeek: "dddd [lalu pukul] LT", sameElse: "L" }, relativeTime: { future: "dalam %s", past: "%s yang lalu", s: "beberapa detik", m: "semenit", mm: "%d menit", h: "sejam", hh: "%d jam", d: "sehari", dd: "%d hari", M: "sebulan", MM: "%d bulan", y: "setahun", yy: "%d tahun" }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("is", { months: "janÃºar_febrÃºar_mars_aprÃ­l_maÃ­_jÃºnÃ­_jÃºlÃ­_Ã¡gÃºst_september_oktÃ³ber_nÃ³vember_desember".split("_"), monthsShort: "jan_feb_mar_apr_maÃ­_jÃºn_jÃºl_Ã¡gÃº_sep_okt_nÃ³v_des".split("_"), weekdays: "sunnudagur_mÃ¡nudagur_Ã¾riÃ°judagur_miÃ°vikudagur_fimmtudagur_fÃ¶studagur_laugardagur".split("_"), weekdaysShort: "sun_mÃ¡n_Ã¾ri_miÃ°_fim_fÃ¶s_lau".split("_"), weekdaysMin: "Su_MÃ¡_Ãr_Mi_Fi_FÃ¶_La".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD/MM/YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY [kl.] H:mm", LLLL: "dddd, D. MMMM YYYY [kl.] H:mm" }, calendar: { sameDay: "[Ã­ dag kl.] LT", nextDay: "[Ã¡ morgun kl.] LT", nextWeek: "dddd [kl.] LT", lastDay: "[Ã­ gÃ¦r kl.] LT", lastWeek: "[sÃ­Ã°asta] dddd [kl.] LT", sameElse: "L" }, relativeTime: { future: "eftir %s", past: "fyrir %s sÃ­Ã°an", s: ld, m: ld, mm: ld, h: "klukkustund", hh: ld, d: ld, dd: ld, M: ld, MM: ld, y: ld, yy: ld }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("it", { months: "gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"), monthsShort: "gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"), weekdays: "Domenica_LunedÃ¬_MartedÃ¬_MercoledÃ¬_GiovedÃ¬_VenerdÃ¬_Sabato".split("_"), weekdaysShort: "Dom_Lun_Mar_Mer_Gio_Ven_Sab".split("_"), weekdaysMin: "Do_Lu_Ma_Me_Gi_Ve_Sa".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Oggi alle] LT", nextDay: "[Domani alle] LT", nextWeek: "dddd [alle] LT", lastDay: "[Ieri alle] LT", lastWeek: function () { switch (this.day()) { case 0: return "[la scorsa] dddd [alle] LT"; default: return "[lo scorso] dddd [alle] LT" } }, sameElse: "L" }, relativeTime: { future: function (a) { return (/^[0-9].+$/.test(a) ? "tra" : "in") + " " + a }, past: "%s fa", s: "alcuni secondi", m: "un minuto", mm: "%d minuti", h: "un'ora", hh: "%d ore", d: "un giorno", dd: "%d giorni", M: "un mese", MM: "%d mesi", y: "un anno", yy: "%d anni" }, ordinalParse: /\d{1,2}Âº/, ordinal: "%dÂº", week: { dow: 1, doy: 4 } }), Kf.defineLocale("ja", { months: "1æ_2æ_3æ_4æ_5æ_6æ_7æ_8æ_9æ_10æ_11æ_12æ".split("_"), monthsShort: "1æ_2æ_3æ_4æ_5æ_6æ_7æ_8æ_9æ_10æ_11æ_12æ".split("_"), weekdays: "æ¥ææ¥_æææ¥_ç«ææ¥_æ°´ææ¥_æ¨ææ¥_éææ¥_åææ¥".split("_"), weekdaysShort: "æ¥_æ_ç«_æ°´_æ¨_é_å".split("_"), weekdaysMin: "æ¥_æ_ç«_æ°´_æ¨_é_å".split("_"), longDateFormat: { LT: "Ahæmå", LTS: "Ahæmåsç§", L: "YYYY/MM/DD", LL: "YYYYå¹´MæDæ¥", LLL: "YYYYå¹´MæDæ¥Ahæmå", LLLL: "YYYYå¹´MæDæ¥Ahæmå dddd" }, meridiemParse: /åå|åå¾/i, isPM: function (a) { return "åå¾" === a }, meridiem: function (a, b, c) { return 12 > a ? "åå" : "åå¾" }, calendar: { sameDay: "[ä»æ¥] LT", nextDay: "[ææ¥] LT", nextWeek: "[æ¥é±]dddd LT", lastDay: "[æ¨æ¥] LT", lastWeek: "[åé±]dddd LT", sameElse: "L" }, relativeTime: { future: "%så¾", past: "%så", s: "æ°ç§", m: "1å", mm: "%då", h: "1æé", hh: "%dæé", d: "1æ¥", dd: "%dæ¥", M: "1ã¶æ", MM: "%dã¶æ", y: "1å¹´", yy: "%då¹´" } }), Kf.defineLocale("jv", { months: "Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_Nopember_Desember".split("_"), monthsShort: "Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nop_Des".split("_"), weekdays: "Minggu_Senen_Seloso_Rebu_Kemis_Jemuwah_Septu".split("_"), weekdaysShort: "Min_Sen_Sel_Reb_Kem_Jem_Sep".split("_"), weekdaysMin: "Mg_Sn_Sl_Rb_Km_Jm_Sp".split("_"), longDateFormat: { LT: "HH.mm", LTS: "HH.mm.ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY [pukul] HH.mm", LLLL: "dddd, D MMMM YYYY [pukul] HH.mm" }, meridiemParse: /enjing|siyang|sonten|ndalu/, meridiemHour: function (a, b) { return 12 === a && (a = 0), "enjing" === b ? a : "siyang" === b ? a >= 11 ? a : a + 12 : "sonten" === b || "ndalu" === b ? a + 12 : void 0 }, meridiem: function (a, b, c) { return 11 > a ? "enjing" : 15 > a ? "siyang" : 19 > a ? "sonten" : "ndalu" }, calendar: { sameDay: "[Dinten puniko pukul] LT", nextDay: "[Mbenjang pukul] LT", nextWeek: "dddd [pukul] LT", lastDay: "[Kala wingi pukul] LT", lastWeek: "dddd [kepengker pukul] LT", sameElse: "L" }, relativeTime: { future: "wonten ing %s", past: "%s ingkang kepengker", s: "sawetawis detik", m: "setunggal menit", mm: "%d menit", h: "setunggal jam", hh: "%d jam", d: "sedinten", dd: "%d dinten", M: "sewulan", MM: "%d wulan", y: "setaun", yy: "%d taun" }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("ka", { months: { standalone: "áááááá á_ááááá áááá_ááá á¢á_ááá ááá_áááá¡á_ááááá¡á_ááááá¡á_ááááá¡á¢á_á¡áá¥á¢ááááá á_áá¥á¢ááááá á_ááááááá á_áááááááá á".split("_"), format: "áááááá á¡_ááááá áááá¡_ááá á¢á¡_ááá áááá¡_áááá¡á¡_ááááá¡á¡_ááááá¡á¡_ááááá¡á¢á¡_á¡áá¥á¢ááááá á¡_áá¥á¢ááááá á¡_ááááááá á¡_áááááááá á¡".split("_") }, monthsShort: "ááá_ááá_ááá _ááá _ááá_ááá_ááá_ááá_á¡áá¥_áá¥á¢_ááá_ááá".split("_"), weekdays: { standalone: "áááá á_áá á¨ááááá_á¡ááá¨ááááá_ááá®á¨ááááá_á®á£áá¨ááááá_ááá áá¡áááá_á¨ááááá".split("_"), format: "áááá áá¡_áá á¨ááááá¡_á¡ááá¨ááááá¡_ááá®á¨ááááá¡_á®á£áá¨ááááá¡_ááá áá¡áááá¡_á¨ááááá¡".split("_"), isFormat: /(á¬ááá|á¨ááááá)/ }, weekdaysShort: "ááá_áá á¨_á¡áá_ááá®_á®á£á_ááá _á¨áá".split("_"), weekdaysMin: "áá_áá _á¡á_áá_á®á£_áá_á¨á".split("_"), longDateFormat: { LT: "h:mm A", LTS: "h:mm:ss A", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY h:mm A", LLLL: "dddd, D MMMM YYYY h:mm A" }, calendar: { sameDay: "[áá¦áá¡] LT[-áá]", nextDay: "[á®ááá] LT[-áá]", lastDay: "[áá£á¨áá] LT[-áá]", nextWeek: "[á¨ááááá] dddd LT[-áá]", lastWeek: "[á¬ááá] dddd LT-áá", sameElse: "L" }, relativeTime: { future: function (a) { return /(á¬ááá|á¬á£áá|á¡áááá|á¬ááá)/.test(a) ? a.replace(/á$/, "á¨á") : a + "á¨á" }, past: function (a) { return /(á¬ááá|á¬á£áá|á¡áááá|áá¦á|ááá)/.test(a) ? a.replace(/(á|á)$/, "áá¡ á¬áá") : /á¬ááá/.test(a) ? a.replace(/á¬ááá$/, "á¬ááá¡ á¬áá") : void 0 }, s: "á áááááááá á¬ááá", m: "á¬á£áá", mm: "%d á¬á£áá", h: "á¡áááá", hh: "%d á¡áááá", d: "áá¦á", dd: "%d áá¦á", M: "ááá", MM: "%d ááá", y: "á¬ááá", yy: "%d á¬ááá" }, ordinalParse: /0|1-áá|áá-\d{1,2}|\d{1,2}-á/, ordinal: function (a) { return 0 === a ? a : 1 === a ? a + "-áá" : 20 > a || 100 >= a && a % 20 === 0 || a % 100 === 0 ? "áá-" + a : a + "-á" }, week: { dow: 1, doy: 7 } }), { 0: "-ÑÑ", 1: "-ÑÑ", 2: "-ÑÑ", 3: "-ÑÑ", 4: "-ÑÑ", 5: "-ÑÑ", 6: "-ÑÑ", 7: "-ÑÑ", 8: "-ÑÑ", 9: "-ÑÑ", 10: "-ÑÑ", 20: "-ÑÑ", 30: "-ÑÑ", 40: "-ÑÑ", 50: "-ÑÑ", 60: "-ÑÑ", 70: "-ÑÑ", 80: "-ÑÑ", 90: "-ÑÑ", 100: "-ÑÑ" }), rg = (Kf.defineLocale("kk", { months: "ÒÐ°Ò£ÑÐ°Ñ_ÐÒÐ¿Ð°Ð½_ÐÐ°ÑÑÑÐ·_Ð¡ÓÑÑÑ_ÐÐ°Ð¼ÑÑ_ÐÐ°ÑÑÑÐ¼_Ð¨ÑÐ»Ð´Ðµ_Ð¢Ð°Ð¼ÑÐ·_ÒÑÑÐºÒ¯Ð¹ÐµÐº_ÒÐ°Ð·Ð°Ð½_ÒÐ°ÑÐ°ÑÐ°_ÐÐµÐ»ÑÐ¾ÒÑÐ°Ð½".split("_"), monthsShort: "ÒÐ°Ò£_ÐÒÐ¿_ÐÐ°Ñ_Ð¡ÓÑ_ÐÐ°Ð¼_ÐÐ°Ñ_Ð¨ÑÐ»_Ð¢Ð°Ð¼_ÒÑÑ_ÒÐ°Ð·_ÒÐ°Ñ_ÐÐµÐ»".split("_"), weekdays: "ÐÐµÐºÑÐµÐ½Ð±Ñ_ÐÒ¯Ð¹ÑÐµÐ½Ð±Ñ_Ð¡ÐµÐ¹ÑÐµÐ½Ð±Ñ_Ð¡ÓÑÑÐµÐ½Ð±Ñ_ÐÐµÐ¹ÑÐµÐ½Ð±Ñ_ÐÒ±Ð¼Ð°_Ð¡ÐµÐ½Ð±Ñ".split("_"), weekdaysShort: "ÐÐµÐº_ÐÒ¯Ð¹_Ð¡ÐµÐ¹_Ð¡ÓÑ_ÐÐµÐ¹_ÐÒ±Ð¼_Ð¡ÐµÐ½".split("_"), weekdaysMin: "ÐÐº_ÐÐ¹_Ð¡Ð¹_Ð¡Ñ_ÐÐ¹_ÐÐ¼_Ð¡Ð½".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[ÐÒ¯Ð³ÑÐ½ ÑÐ°ÒÐ°Ñ] LT", nextDay: "[ÐÑÑÐµÒ£ ÑÐ°ÒÐ°Ñ] LT", nextWeek: "dddd [ÑÐ°ÒÐ°Ñ] LT", lastDay: "[ÐÐµÑÐµ ÑÐ°ÒÐ°Ñ] LT", lastWeek: "[Ó¨ÑÐºÐµÐ½ Ð°Ð¿ÑÐ°Ð½ÑÒ£] dddd [ÑÐ°ÒÐ°Ñ] LT", sameElse: "L" }, relativeTime: { future: "%s ÑÑÑÐ½Ð´Ðµ", past: "%s Ð±Ò±ÑÑÐ½", s: "Ð±ÑÑÐ½ÐµÑÐµ ÑÐµÐºÑÐ½Ð´", m: "Ð±ÑÑ Ð¼Ð¸Ð½ÑÑ", mm: "%d Ð¼Ð¸Ð½ÑÑ", h: "Ð±ÑÑ ÑÐ°ÒÐ°Ñ", hh: "%d ÑÐ°ÒÐ°Ñ", d: "Ð±ÑÑ ÐºÒ¯Ð½", dd: "%d ÐºÒ¯Ð½", M: "Ð±ÑÑ Ð°Ð¹", MM: "%d Ð°Ð¹", y: "Ð±ÑÑ Ð¶ÑÐ»", yy: "%d Ð¶ÑÐ»" }, ordinalParse: /\d{1,2}-(ÑÑ|ÑÑ)/, ordinal: function (a) { var b = a % 10, c = a >= 100 ? 100 : null; return a + (qg[a] || qg[b] || qg[c]) }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("km", { months: "áááá¶_áá»áááá_áá·áá¶_áááá¶_á§ááá¶_áá·áá»áá¶_áááááá¶_áá¸á á¶_ááááá¶_áá»áá¶_áá·áááá·áá¶_áááá¼".split("_"), monthsShort: "áááá¶_áá»áááá_áá·áá¶_áááá¶_á§ááá¶_áá·áá»áá¶_áááááá¶_áá¸á á¶_ááááá¶_áá»áá¶_áá·áááá·áá¶_áááá¼".split("_"), weekdays: "á¢á¶áá·ááá_ááááá_á¢áááá¶á_áá»á_áááá ááááá·á_áá»ááá_áááá".split("_"), weekdaysShort: "á¢á¶áá·ááá_ááááá_á¢áááá¶á_áá»á_áááá ááááá·á_áá»ááá_áááá".split("_"), weekdaysMin: "á¢á¶áá·ááá_ááááá_á¢áááá¶á_áá»á_áááá ááááá·á_áá»ááá_áááá".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[ááááááá áááá] LT", nextDay: "[ááá¢áá áááá] LT", nextWeek: "dddd [áááá] LT", lastDay: "[áááá·ááá·á áááá] LT", lastWeek: "dddd [ááááá¶á ááá»á] [áááá] LT", sameElse: "L" }, relativeTime: { future: "%sááá", past: "%sáá»á", s: "ááá»áááá¶ááá·áá¶áá¸", m: "áá½ááá¶áá¸", mm: "%d áá¶áá¸", h: "áá½ááááá", hh: "%d áááá", d: "áá½ááááá", dd: "%d áááá", M: "áá½ááá", MM: "%d áá", y: "áá½ááááá¶á", yy: "%d áááá¶á" }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("ko", { months: "1ì_2ì_3ì_4ì_5ì_6ì_7ì_8ì_9ì_10ì_11ì_12ì".split("_"), monthsShort: "1ì_2ì_3ì_4ì_5ì_6ì_7ì_8ì_9ì_10ì_11ì_12ì".split("_"), weekdays: "ì¼ìì¼_ììì¼_íìì¼_ììì¼_ëª©ìì¼_ê¸ìì¼_í ìì¼".split("_"), weekdaysShort: "ì¼_ì_í_ì_ëª©_ê¸_í ".split("_"), weekdaysMin: "ì¼_ì_í_ì_ëª©_ê¸_í ".split("_"), longDateFormat: { LT: "A hì më¶", LTS: "A hì më¶ sì´", L: "YYYY.MM.DD", LL: "YYYYë MMMM Dì¼", LLL: "YYYYë MMMM Dì¼ A hì më¶", LLLL: "YYYYë MMMM Dì¼ dddd A hì më¶" }, calendar: { sameDay: "ì¤ë LT", nextDay: "ë´ì¼ LT", nextWeek: "dddd LT", lastDay: "ì´ì  LT", lastWeek: "ì§ëì£¼ dddd LT", sameElse: "L" }, relativeTime: { future: "%s í", past: "%s ì ", s: "ëªì´", ss: "%dì´", m: "ì¼ë¶", mm: "%dë¶", h: "íìê°", hh: "%dìê°", d: "íë£¨", dd: "%dì¼", M: "íë¬", MM: "%dë¬", y: "ì¼ë", yy: "%dë" }, ordinalParse: /\d{1,2}ì¼/, ordinal: "%dì¼", meridiemParse: /ì¤ì |ì¤í/, isPM: function (a) { return "ì¤í" === a }, meridiem: function (a, b, c) { return 12 > a ? "ì¤ì " : "ì¤í" } }), Kf.defineLocale("lb", { months: "Januar_Februar_MÃ¤erz_AbrÃ«ll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"), monthsShort: "Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"), weekdays: "Sonndeg_MÃ©indeg_DÃ«nschdeg_MÃ«ttwoch_Donneschdeg_Freideg_Samschdeg".split("_"), weekdaysShort: "So._MÃ©._DÃ«._MÃ«._Do._Fr._Sa.".split("_"), weekdaysMin: "So_MÃ©_DÃ«_MÃ«_Do_Fr_Sa".split("_"), longDateFormat: { LT: "H:mm [Auer]", LTS: "H:mm:ss [Auer]", L: "DD.MM.YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY H:mm [Auer]", LLLL: "dddd, D. MMMM YYYY H:mm [Auer]" }, calendar: { sameDay: "[Haut um] LT", sameElse: "L", nextDay: "[Muer um] LT", nextWeek: "dddd [um] LT", lastDay: "[GÃ«schter um] LT", lastWeek: function () { switch (this.day()) { case 2: case 4: return "[Leschten] dddd [um] LT"; default: return "[Leschte] dddd [um] LT" } } }, relativeTime: { future: nd, past: od, s: "e puer Sekonnen", m: md, mm: "%d Minutten", h: md, hh: "%d Stonnen", d: md, dd: "%d Deeg", M: md, MM: "%d MÃ©int", y: md, yy: "%d Joer" }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("lo", {
        months: "àº¡àº±àºàºàº­àº_àºàº¸àº¡àºàº²_àº¡àºµàºàº²_à»àº¡àºªàº²_àºàº¶àºàºªàº°àºàº²_àº¡àº´àºàº¸àºàº²_àºà»àº¥àº°àºàº»àº_àºªàº´àºàº«àº²_àºàº±àºàºàº²_àºàº¸àº¥àº²_àºàº°àºàº´àº_àºàº±àºàº§àº²".split("_"), monthsShort: "àº¡àº±àºàºàº­àº_àºàº¸àº¡àºàº²_àº¡àºµàºàº²_à»àº¡àºªàº²_àºàº¶àºàºªàº°àºàº²_àº¡àº´àºàº¸àºàº²_àºà»àº¥àº°àºàº»àº_àºªàº´àºàº«àº²_àºàº±àºàºàº²_àºàº¸àº¥àº²_àºàº°àºàº´àº_àºàº±àºàº§àº²".split("_"), weekdays: "àº­àº²àºàº´àº_àºàº±àº_àº­àº±àºàºàº²àº_àºàº¸àº_àºàº°àº«àº±àº_àºªàº¸àº_à»àºªàº»àº²".split("_"), weekdaysShort: "àºàº´àº_àºàº±àº_àº­àº±àºàºàº²àº_àºàº¸àº_àºàº°àº«àº±àº_àºªàº¸àº_à»àºªàº»àº²".split("_"), weekdaysMin: "àº_àº_àº­àº_àº_àºàº«_àºªàº_àºª".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "àº§àº±àºdddd D MMMM YYYY HH:mm" }, meridiemParse: /àºàº­àºà»àºàº»à»àº²|àºàº­àºà»àº¥àº/, isPM: function (a) { return "àºàº­àºà»àº¥àº" === a }, meridiem: function (a, b, c) { return 12 > a ? "àºàº­àºà»àºàº»à»àº²" : "àºàº­àºà»àº¥àº" }, calendar: { sameDay: "[àº¡àº·à»àºàºµà»à»àº§àº¥àº²] LT", nextDay: "[àº¡àº·à»àº­àº·à»àºà»àº§àº¥àº²] LT", nextWeek: "[àº§àº±àº]dddd[à»à»àº²à»àº§àº¥àº²] LT", lastDay: "[àº¡àº·à»àº§àº²àºàºàºµà»à»àº§àº¥àº²] LT", lastWeek: "[àº§àº±àº]dddd[à»àº¥à»àº§àºàºµà»à»àº§àº¥àº²] LT", sameElse: "L" }, relativeTime: { future: "àº­àºµàº %s", past: "%sàºà»àº²àºàº¡àº²", s: "àºà»à»à»àºàº»à»àº²à»àºàº§àº´àºàº²àºàºµ", m: "1 àºàº²àºàºµ", mm: "%d àºàº²àºàºµ", h: "1 àºàº»à»àº§à»àº¡àº", hh: "%d àºàº»à»àº§à»àº¡àº", d: "1 àº¡àº·à»", dd: "%d àº¡àº·à»", M: "1 à»àºàº·àº­àº", MM: "%d à»àºàº·àº­àº", y: "1 àºàºµ", yy: "%d àºàºµ" }, ordinalParse: /(àºàºµà»)\d{1,2}/, ordinal: function (a) {
            return "àºàºµà»" + a
        }
    }), { m: "minutÄ_minutÄs_minutÄ", mm: "minutÄs_minuÄiÅ³_minutes", h: "valanda_valandos_valandÄ", hh: "valandos_valandÅ³_valandas", d: "diena_dienos_dienÄ", dd: "dienos_dienÅ³_dienas", M: "mÄnuo_mÄnesio_mÄnesÄ¯", MM: "mÄnesiai_mÄnesiÅ³_mÄnesius", y: "metai_metÅ³_metus", yy: "metai_metÅ³_metus" }), sg = (Kf.defineLocale("lt", { months: { format: "sausio_vasario_kovo_balandÅ¾io_geguÅ¾Äs_birÅ¾elio_liepos_rugpjÅ«Äio_rugsÄjo_spalio_lapkriÄio_gruodÅ¾io".split("_"), standalone: "sausis_vasaris_kovas_balandis_geguÅ¾Ä_birÅ¾elis_liepa_rugpjÅ«tis_rugsÄjis_spalis_lapkritis_gruodis".split("_") }, monthsShort: "sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"), weekdays: { format: "sekmadienÄ¯_pirmadienÄ¯_antradienÄ¯_treÄiadienÄ¯_ketvirtadienÄ¯_penktadienÄ¯_Å¡eÅ¡tadienÄ¯".split("_"), standalone: "sekmadienis_pirmadienis_antradienis_treÄiadienis_ketvirtadienis_penktadienis_Å¡eÅ¡tadienis".split("_"), isFormat: /dddd HH:mm/ }, weekdaysShort: "Sek_Pir_Ant_Tre_Ket_Pen_Å eÅ¡".split("_"), weekdaysMin: "S_P_A_T_K_Pn_Å ".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "YYYY-MM-DD", LL: "YYYY [m.] MMMM D [d.]", LLL: "YYYY [m.] MMMM D [d.], HH:mm [val.]", LLLL: "YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]", l: "YYYY-MM-DD", ll: "YYYY [m.] MMMM D [d.]", lll: "YYYY [m.] MMMM D [d.], HH:mm [val.]", llll: "YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]" }, calendar: { sameDay: "[Å iandien] LT", nextDay: "[Rytoj] LT", nextWeek: "dddd LT", lastDay: "[Vakar] LT", lastWeek: "[PraÄjusÄ¯] dddd LT", sameElse: "L" }, relativeTime: { future: "po %s", past: "prieÅ¡ %s", s: qd, m: rd, mm: ud, h: rd, hh: ud, d: rd, dd: ud, M: rd, MM: ud, y: rd, yy: ud }, ordinalParse: /\d{1,2}-oji/, ordinal: function (a) { return a + "-oji" }, week: { dow: 1, doy: 4 } }), { m: "minÅ«tes_minÅ«tÄm_minÅ«te_minÅ«tes".split("_"), mm: "minÅ«tes_minÅ«tÄm_minÅ«te_minÅ«tes".split("_"), h: "stundas_stundÄm_stunda_stundas".split("_"), hh: "stundas_stundÄm_stunda_stundas".split("_"), d: "dienas_dienÄm_diena_dienas".split("_"), dd: "dienas_dienÄm_diena_dienas".split("_"), M: "mÄneÅ¡a_mÄneÅ¡iem_mÄnesis_mÄneÅ¡i".split("_"), MM: "mÄneÅ¡a_mÄneÅ¡iem_mÄnesis_mÄneÅ¡i".split("_"), y: "gada_gadiem_gads_gadi".split("_"), yy: "gada_gadiem_gads_gadi".split("_") }), tg = (Kf.defineLocale("lv", { months: "janvÄris_februÄris_marts_aprÄ«lis_maijs_jÅ«nijs_jÅ«lijs_augusts_septembris_oktobris_novembris_decembris".split("_"), monthsShort: "jan_feb_mar_apr_mai_jÅ«n_jÅ«l_aug_sep_okt_nov_dec".split("_"), weekdays: "svÄtdiena_pirmdiena_otrdiena_treÅ¡diena_ceturtdiena_piektdiena_sestdiena".split("_"), weekdaysShort: "Sv_P_O_T_C_Pk_S".split("_"), weekdaysMin: "Sv_P_O_T_C_Pk_S".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY.", LL: "YYYY. [gada] D. MMMM", LLL: "YYYY. [gada] D. MMMM, HH:mm", LLLL: "YYYY. [gada] D. MMMM, dddd, HH:mm" }, calendar: { sameDay: "[Å odien pulksten] LT", nextDay: "[RÄ«t pulksten] LT", nextWeek: "dddd [pulksten] LT", lastDay: "[Vakar pulksten] LT", lastWeek: "[PagÄjuÅ¡Ä] dddd [pulksten] LT", sameElse: "L" }, relativeTime: { future: "pÄc %s", past: "pirms %s", s: yd, m: xd, mm: wd, h: xd, hh: wd, d: xd, dd: wd, M: xd, MM: wd, y: xd, yy: wd }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), { words: { m: ["jedan minut", "jednog minuta"], mm: ["minut", "minuta", "minuta"], h: ["jedan sat", "jednog sata"], hh: ["sat", "sata", "sati"], dd: ["dan", "dana", "dana"], MM: ["mjesec", "mjeseca", "mjeseci"], yy: ["godina", "godine", "godina"] }, correctGrammaticalCase: function (a, b) { return 1 === a ? b[0] : a >= 2 && 4 >= a ? b[1] : b[2] }, translate: function (a, b, c) { var d = tg.words[c]; return 1 === c.length ? b ? d[0] : d[1] : a + " " + tg.correctGrammaticalCase(a, d) } }), ug = (Kf.defineLocale("me", { months: ["januar", "februar", "mart", "april", "maj", "jun", "jul", "avgust", "septembar", "oktobar", "novembar", "decembar"], monthsShort: ["jan.", "feb.", "mar.", "apr.", "maj", "jun", "jul", "avg.", "sep.", "okt.", "nov.", "dec."], weekdays: ["nedjelja", "ponedjeljak", "utorak", "srijeda", "Äetvrtak", "petak", "subota"], weekdaysShort: ["ned.", "pon.", "uto.", "sri.", "Äet.", "pet.", "sub."], weekdaysMin: ["ne", "po", "ut", "sr", "Äe", "pe", "su"], longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD. MM. YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY H:mm", LLLL: "dddd, D. MMMM YYYY H:mm" }, calendar: { sameDay: "[danas u] LT", nextDay: "[sjutra u] LT", nextWeek: function () { switch (this.day()) { case 0: return "[u] [nedjelju] [u] LT"; case 3: return "[u] [srijedu] [u] LT"; case 6: return "[u] [subotu] [u] LT"; case 1: case 2: case 4: case 5: return "[u] dddd [u] LT" } }, lastDay: "[juÄe u] LT", lastWeek: function () { var a = ["[proÅ¡le] [nedjelje] [u] LT", "[proÅ¡log] [ponedjeljka] [u] LT", "[proÅ¡log] [utorka] [u] LT", "[proÅ¡le] [srijede] [u] LT", "[proÅ¡log] [Äetvrtka] [u] LT", "[proÅ¡log] [petka] [u] LT", "[proÅ¡le] [subote] [u] LT"]; return a[this.day()] }, sameElse: "L" }, relativeTime: { future: "za %s", past: "prije %s", s: "nekoliko sekundi", m: tg.translate, mm: tg.translate, h: tg.translate, hh: tg.translate, d: "dan", dd: tg.translate, M: "mjesec", MM: tg.translate, y: "godinu", yy: tg.translate }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 7 } }), Kf.defineLocale("mk", { months: "ÑÐ°Ð½ÑÐ°ÑÐ¸_ÑÐµÐ²ÑÑÐ°ÑÐ¸_Ð¼Ð°ÑÑ_Ð°Ð¿ÑÐ¸Ð»_Ð¼Ð°Ñ_ÑÑÐ½Ð¸_ÑÑÐ»Ð¸_Ð°Ð²Ð³ÑÑÑ_ÑÐµÐ¿ÑÐµÐ¼Ð²ÑÐ¸_Ð¾ÐºÑÐ¾Ð¼Ð²ÑÐ¸_Ð½Ð¾ÐµÐ¼Ð²ÑÐ¸_Ð´ÐµÐºÐµÐ¼Ð²ÑÐ¸".split("_"), monthsShort: "ÑÐ°Ð½_ÑÐµÐ²_Ð¼Ð°Ñ_Ð°Ð¿Ñ_Ð¼Ð°Ñ_ÑÑÐ½_ÑÑÐ»_Ð°Ð²Ð³_ÑÐµÐ¿_Ð¾ÐºÑ_Ð½Ð¾Ðµ_Ð´ÐµÐº".split("_"), weekdays: "Ð½ÐµÐ´ÐµÐ»Ð°_Ð¿Ð¾Ð½ÐµÐ´ÐµÐ»Ð½Ð¸Ðº_Ð²ÑÐ¾ÑÐ½Ð¸Ðº_ÑÑÐµÐ´Ð°_ÑÐµÑÐ²ÑÑÐ¾Ðº_Ð¿ÐµÑÐ¾Ðº_ÑÐ°Ð±Ð¾ÑÐ°".split("_"), weekdaysShort: "Ð½ÐµÐ´_Ð¿Ð¾Ð½_Ð²ÑÐ¾_ÑÑÐµ_ÑÐµÑ_Ð¿ÐµÑ_ÑÐ°Ð±".split("_"), weekdaysMin: "Ð½e_Ð¿o_Ð²Ñ_ÑÑ_ÑÐµ_Ð¿Ðµ_Ña".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "D.MM.YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY H:mm", LLLL: "dddd, D MMMM YYYY H:mm" }, calendar: { sameDay: "[ÐÐµÐ½ÐµÑ Ð²Ð¾] LT", nextDay: "[Ð£ÑÑÐµ Ð²Ð¾] LT", nextWeek: "[ÐÐ¾] dddd [Ð²Ð¾] LT", lastDay: "[ÐÑÐµÑÐ° Ð²Ð¾] LT", lastWeek: function () { switch (this.day()) { case 0: case 3: case 6: return "[ÐÐ·Ð¼Ð¸Ð½Ð°ÑÐ°ÑÐ°] dddd [Ð²Ð¾] LT"; case 1: case 2: case 4: case 5: return "[ÐÐ·Ð¼Ð¸Ð½Ð°ÑÐ¸Ð¾Ñ] dddd [Ð²Ð¾] LT" } }, sameElse: "L" }, relativeTime: { future: "Ð¿Ð¾ÑÐ»Ðµ %s", past: "Ð¿ÑÐµÐ´ %s", s: "Ð½ÐµÐºÐ¾Ð»ÐºÑ ÑÐµÐºÑÐ½Ð´Ð¸", m: "Ð¼Ð¸Ð½ÑÑÐ°", mm: "%d Ð¼Ð¸Ð½ÑÑÐ¸", h: "ÑÐ°Ñ", hh: "%d ÑÐ°ÑÐ°", d: "Ð´ÐµÐ½", dd: "%d Ð´ÐµÐ½Ð°", M: "Ð¼ÐµÑÐµÑ", MM: "%d Ð¼ÐµÑÐµÑÐ¸", y: "Ð³Ð¾Ð´Ð¸Ð½Ð°", yy: "%d Ð³Ð¾Ð´Ð¸Ð½Ð¸" }, ordinalParse: /\d{1,2}-(ÐµÐ²|ÐµÐ½|ÑÐ¸|Ð²Ð¸|ÑÐ¸|Ð¼Ð¸)/, ordinal: function (a) { var b = a % 10, c = a % 100; return 0 === a ? a + "-ÐµÐ²" : 0 === c ? a + "-ÐµÐ½" : c > 10 && 20 > c ? a + "-ÑÐ¸" : 1 === b ? a + "-Ð²Ð¸" : 2 === b ? a + "-ÑÐ¸" : 7 === b || 8 === b ? a + "-Ð¼Ð¸" : a + "-ÑÐ¸" }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("ml", { months: "à´à´¨àµà´µà´°à´¿_à´«àµà´¬àµà´°àµà´µà´°à´¿_à´®à´¾àµ¼à´àµà´àµ_à´à´ªàµà´°à´¿àµ½_à´®àµà´¯àµ_à´àµàµº_à´àµà´²àµ_à´à´à´¸àµà´±àµà´±àµ_à´¸àµà´ªàµà´±àµà´±à´à´¬àµ¼_à´à´àµà´àµà´¬àµ¼_à´¨à´µà´à´¬àµ¼_à´¡à´¿à´¸à´à´¬àµ¼".split("_"), monthsShort: "à´à´¨àµ._à´«àµà´¬àµà´°àµ._à´®à´¾àµ¼._à´à´ªàµà´°à´¿._à´®àµà´¯àµ_à´àµàµº_à´àµà´²àµ._à´à´._à´¸àµà´ªàµà´±àµà´±._à´à´àµà´àµ._à´¨à´µà´._à´¡à´¿à´¸à´.".split("_"), weekdays: "à´à´¾à´¯à´±à´¾à´´àµà´_à´¤à´¿à´àµà´à´³à´¾à´´àµà´_à´àµà´µàµà´µà´¾à´´àµà´_à´¬àµà´§à´¨à´¾à´´àµà´_à´µàµà´¯à´¾à´´à´¾à´´àµà´_à´µàµà´³àµà´³à´¿à´¯à´¾à´´àµà´_à´¶à´¨à´¿à´¯à´¾à´´àµà´".split("_"), weekdaysShort: "à´à´¾à´¯àµ¼_à´¤à´¿à´àµà´àµ¾_à´àµà´µàµà´µ_à´¬àµà´§àµ»_à´µàµà´¯à´¾à´´à´_à´µàµà´³àµà´³à´¿_à´¶à´¨à´¿".split("_"), weekdaysMin: "à´à´¾_à´¤à´¿_à´àµ_à´¬àµ_à´µàµà´¯à´¾_à´µàµ_à´¶".split("_"), longDateFormat: { LT: "A h:mm -à´¨àµ", LTS: "A h:mm:ss -à´¨àµ", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY, A h:mm -à´¨àµ", LLLL: "dddd, D MMMM YYYY, A h:mm -à´¨àµ" }, calendar: { sameDay: "[à´à´¨àµà´¨àµ] LT", nextDay: "[à´¨à´¾à´³àµ] LT", nextWeek: "dddd, LT", lastDay: "[à´à´¨àµà´¨à´²àµ] LT", lastWeek: "[à´à´´à´¿à´àµà´] dddd, LT", sameElse: "L" }, relativeTime: { future: "%s à´à´´à´¿à´àµà´àµ", past: "%s à´®àµàµ»à´ªàµ", s: "à´àµ½à´ª à´¨à´¿à´®à´¿à´·à´àµà´àµ¾", m: "à´à´°àµ à´®à´¿à´¨à´¿à´±àµà´±àµ", mm: "%d à´®à´¿à´¨à´¿à´±àµà´±àµ", h: "à´à´°àµ à´®à´£à´¿à´àµà´àµàµ¼", hh: "%d à´®à´£à´¿à´àµà´àµàµ¼", d: "à´à´°àµ à´¦à´¿à´µà´¸à´", dd: "%d à´¦à´¿à´µà´¸à´", M: "à´à´°àµ à´®à´¾à´¸à´", MM: "%d à´®à´¾à´¸à´", y: "à´à´°àµ à´µàµ¼à´·à´", yy: "%d à´µàµ¼à´·à´" }, meridiemParse: /à´°à´¾à´¤àµà´°à´¿|à´°à´¾à´µà´¿à´²àµ|à´à´àµà´ à´à´´à´¿à´àµà´àµ|à´µàµà´àµà´¨àµà´¨àµà´°à´|à´°à´¾à´¤àµà´°à´¿/i, isPM: function (a) { return /^(à´à´àµà´ à´à´´à´¿à´àµà´àµ|à´µàµà´àµà´¨àµà´¨àµà´°à´|à´°à´¾à´¤àµà´°à´¿)$/.test(a) }, meridiem: function (a, b, c) { return 4 > a ? "à´°à´¾à´¤àµà´°à´¿" : 12 > a ? "à´°à´¾à´µà´¿à´²àµ" : 17 > a ? "à´à´àµà´ à´à´´à´¿à´àµà´àµ" : 20 > a ? "à´µàµà´àµà´¨àµà´¨àµà´°à´" : "à´°à´¾à´¤àµà´°à´¿" } }), { 1: "à¥§", 2: "à¥¨", 3: "à¥©", 4: "à¥ª", 5: "à¥«", 6: "à¥¬", 7: "à¥­", 8: "à¥®", 9: "à¥¯", 0: "à¥¦" }), vg = { "à¥§": "1", "à¥¨": "2", "à¥©": "3", "à¥ª": "4", "à¥«": "5", "à¥¬": "6", "à¥­": "7", "à¥®": "8", "à¥¯": "9", "à¥¦": "0" }, wg = (Kf.defineLocale("mr", { months: "à¤à¤¾à¤¨à¥à¤µà¤¾à¤°à¥_à¤«à¥à¤¬à¥à¤°à¥à¤µà¤¾à¤°à¥_à¤®à¤¾à¤°à¥à¤_à¤à¤ªà¥à¤°à¤¿à¤²_à¤®à¥_à¤à¥à¤¨_à¤à¥à¤²à¥_à¤à¤à¤¸à¥à¤_à¤¸à¤ªà¥à¤à¥à¤à¤¬à¤°_à¤à¤à¥à¤à¥à¤¬à¤°_à¤¨à¥à¤µà¥à¤¹à¥à¤à¤¬à¤°_à¤¡à¤¿à¤¸à¥à¤à¤¬à¤°".split("_"), monthsShort: "à¤à¤¾à¤¨à¥._à¤«à¥à¤¬à¥à¤°à¥._à¤®à¤¾à¤°à¥à¤._à¤à¤ªà¥à¤°à¤¿._à¤®à¥._à¤à¥à¤¨._à¤à¥à¤²à¥._à¤à¤._à¤¸à¤ªà¥à¤à¥à¤._à¤à¤à¥à¤à¥._à¤¨à¥à¤µà¥à¤¹à¥à¤._à¤¡à¤¿à¤¸à¥à¤.".split("_"), weekdays: "à¤°à¤µà¤¿à¤µà¤¾à¤°_à¤¸à¥à¤®à¤µà¤¾à¤°_à¤®à¤à¤à¤³à¤µà¤¾à¤°_à¤¬à¥à¤§à¤µà¤¾à¤°_à¤à¥à¤°à¥à¤µà¤¾à¤°_à¤¶à¥à¤à¥à¤°à¤µà¤¾à¤°_à¤¶à¤¨à¤¿à¤µà¤¾à¤°".split("_"), weekdaysShort: "à¤°à¤µà¤¿_à¤¸à¥à¤®_à¤®à¤à¤à¤³_à¤¬à¥à¤§_à¤à¥à¤°à¥_à¤¶à¥à¤à¥à¤°_à¤¶à¤¨à¤¿".split("_"), weekdaysMin: "à¤°_à¤¸à¥_à¤®à¤_à¤¬à¥_à¤à¥_à¤¶à¥_à¤¶".split("_"), longDateFormat: { LT: "A h:mm à¤µà¤¾à¤à¤¤à¤¾", LTS: "A h:mm:ss à¤µà¤¾à¤à¤¤à¤¾", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY, A h:mm à¤µà¤¾à¤à¤¤à¤¾", LLLL: "dddd, D MMMM YYYY, A h:mm à¤µà¤¾à¤à¤¤à¤¾" }, calendar: { sameDay: "[à¤à¤] LT", nextDay: "[à¤à¤¦à¥à¤¯à¤¾] LT", nextWeek: "dddd, LT", lastDay: "[à¤à¤¾à¤²] LT", lastWeek: "[à¤®à¤¾à¤à¥à¤²] dddd, LT", sameElse: "L" }, relativeTime: { future: "%sà¤®à¤§à¥à¤¯à¥", past: "%sà¤ªà¥à¤°à¥à¤µà¥", s: zd, m: zd, mm: zd, h: zd, hh: zd, d: zd, dd: zd, M: zd, MM: zd, y: zd, yy: zd }, preparse: function (a) { return a.replace(/[à¥§à¥¨à¥©à¥ªà¥«à¥¬à¥­à¥®à¥¯à¥¦]/g, function (a) { return vg[a] }) }, postformat: function (a) { return a.replace(/\d/g, function (a) { return ug[a] }) }, meridiemParse: /à¤°à¤¾à¤¤à¥à¤°à¥|à¤¸à¤à¤¾à¤³à¥|à¤¦à¥à¤ªà¤¾à¤°à¥|à¤¸à¤¾à¤¯à¤à¤à¤¾à¤³à¥/, meridiemHour: function (a, b) { return 12 === a && (a = 0), "à¤°à¤¾à¤¤à¥à¤°à¥" === b ? 4 > a ? a : a + 12 : "à¤¸à¤à¤¾à¤³à¥" === b ? a : "à¤¦à¥à¤ªà¤¾à¤°à¥" === b ? a >= 10 ? a : a + 12 : "à¤¸à¤¾à¤¯à¤à¤à¤¾à¤³à¥" === b ? a + 12 : void 0 }, meridiem: function (a, b, c) { return 4 > a ? "à¤°à¤¾à¤¤à¥à¤°à¥" : 10 > a ? "à¤¸à¤à¤¾à¤³à¥" : 17 > a ? "à¤¦à¥à¤ªà¤¾à¤°à¥" : 20 > a ? "à¤¸à¤¾à¤¯à¤à¤à¤¾à¤³à¥" : "à¤°à¤¾à¤¤à¥à¤°à¥" }, week: { dow: 0, doy: 6 } }), Kf.defineLocale("ms-my", { months: "Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"), monthsShort: "Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"), weekdays: "Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"), weekdaysShort: "Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"), weekdaysMin: "Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"), longDateFormat: { LT: "HH.mm", LTS: "HH.mm.ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY [pukul] HH.mm", LLLL: "dddd, D MMMM YYYY [pukul] HH.mm" }, meridiemParse: /pagi|tengahari|petang|malam/, meridiemHour: function (a, b) { return 12 === a && (a = 0), "pagi" === b ? a : "tengahari" === b ? a >= 11 ? a : a + 12 : "petang" === b || "malam" === b ? a + 12 : void 0 }, meridiem: function (a, b, c) { return 11 > a ? "pagi" : 15 > a ? "tengahari" : 19 > a ? "petang" : "malam" }, calendar: { sameDay: "[Hari ini pukul] LT", nextDay: "[Esok pukul] LT", nextWeek: "dddd [pukul] LT", lastDay: "[Kelmarin pukul] LT", lastWeek: "dddd [lepas pukul] LT", sameElse: "L" }, relativeTime: { future: "dalam %s", past: "%s yang lepas", s: "beberapa saat", m: "seminit", mm: "%d minit", h: "sejam", hh: "%d jam", d: "sehari", dd: "%d hari", M: "sebulan", MM: "%d bulan", y: "setahun", yy: "%d tahun" }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("ms", { months: "Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"), monthsShort: "Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"), weekdays: "Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"), weekdaysShort: "Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"), weekdaysMin: "Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"), longDateFormat: { LT: "HH.mm", LTS: "HH.mm.ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY [pukul] HH.mm", LLLL: "dddd, D MMMM YYYY [pukul] HH.mm" }, meridiemParse: /pagi|tengahari|petang|malam/, meridiemHour: function (a, b) { return 12 === a && (a = 0), "pagi" === b ? a : "tengahari" === b ? a >= 11 ? a : a + 12 : "petang" === b || "malam" === b ? a + 12 : void 0 }, meridiem: function (a, b, c) { return 11 > a ? "pagi" : 15 > a ? "tengahari" : 19 > a ? "petang" : "malam" }, calendar: { sameDay: "[Hari ini pukul] LT", nextDay: "[Esok pukul] LT", nextWeek: "dddd [pukul] LT", lastDay: "[Kelmarin pukul] LT", lastWeek: "dddd [lepas pukul] LT", sameElse: "L" }, relativeTime: { future: "dalam %s", past: "%s yang lepas", s: "beberapa saat", m: "seminit", mm: "%d minit", h: "sejam", hh: "%d jam", d: "sehari", dd: "%d hari", M: "sebulan", MM: "%d bulan", y: "setahun", yy: "%d tahun" }, week: { dow: 1, doy: 7 } }), { 1: "á", 2: "á", 3: "á", 4: "á", 5: "á", 6: "á", 7: "á", 8: "á", 9: "á", 0: "á" }), xg = { "á": "1", "á": "2", "á": "3", "á": "4", "á": "5", "á": "6", "á": "7", "á": "8", "á": "9", "á": "0" }, yg = (Kf.defineLocale("my", { months: "áááºááá«áá®_áá±áá±á¬áºáá«áá®_áááº_á§áá¼á®_áá±_áá½ááº_áá°áá­á¯ááº_áá¼áá¯ááº_áááºáááºáá¬_á¡á±á¬ááºáá­á¯áá¬_áá­á¯áááºáá¬_áá®áááºáá¬".split("_"), monthsShort: "áááº_áá±_áááº_áá¼á®_áá±_áá½ááº_áá­á¯ááº_áá¼_áááº_á¡á±á¬ááº_áá­á¯_áá®".split("_"), weekdays: "ááááºá¹ááá½á±_ááááºá¹áá¬_á¡ááºá¹áá«_áá¯áá¹ááá°á¸_áá¼á¬áááá±á¸_áá±á¬áá¼á¬_ááá±".split("_"), weekdaysShort: "áá½á±_áá¬_áá«_áá°á¸_áá¼á¬_áá±á¬_áá±".split("_"), weekdaysMin: "áá½á±_áá¬_áá«_áá°á¸_áá¼á¬_áá±á¬_áá±".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[ááá±.] LT [áá¾á¬]", nextDay: "[ááááºáá¼ááº] LT [áá¾á¬]", nextWeek: "dddd LT [áá¾á¬]", lastDay: "[ááá±.á] LT [áá¾á¬]", lastWeek: "[áá¼á®á¸áá²á·áá±á¬] dddd LT [áá¾á¬]", sameElse: "L" }, relativeTime: { future: "áá¬áááºá· %s áá¾á¬", past: "áá½ááºáá²á·áá±á¬ %s á", s: "ááá¹áááº.á¡áááºá¸áááº", m: "áááºáá­áááº", mm: "%d áá­áááº", h: "áááºáá¬áá®", hh: "%d áá¬áá®", d: "áááºáááº", dd: "%d áááº", M: "áááºá", MM: "%d á", y: "áááºáá¾ááº", yy: "%d áá¾ááº" }, preparse: function (a) { return a.replace(/[áááááááááá]/g, function (a) { return xg[a] }) }, postformat: function (a) { return a.replace(/\d/g, function (a) { return wg[a] }) }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("nb", { months: "januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"), monthsShort: "jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"), weekdays: "sÃ¸ndag_mandag_tirsdag_onsdag_torsdag_fredag_lÃ¸rdag".split("_"), weekdaysShort: "sÃ¸._ma._ti._on._to._fr._lÃ¸.".split("_"), weekdaysMin: "sÃ¸_ma_ti_on_to_fr_lÃ¸".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY [kl.] HH:mm", LLLL: "dddd D. MMMM YYYY [kl.] HH:mm" }, calendar: { sameDay: "[i dag kl.] LT", nextDay: "[i morgen kl.] LT", nextWeek: "dddd [kl.] LT", lastDay: "[i gÃ¥r kl.] LT", lastWeek: "[forrige] dddd [kl.] LT", sameElse: "L" }, relativeTime: { future: "om %s", past: "for %s siden", s: "noen sekunder", m: "ett minutt", mm: "%d minutter", h: "en time", hh: "%d timer", d: "en dag", dd: "%d dager", M: "en mÃ¥ned", MM: "%d mÃ¥neder", y: "ett Ã¥r", yy: "%d Ã¥r" }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), { 1: "à¥§", 2: "à¥¨", 3: "à¥©", 4: "à¥ª", 5: "à¥«", 6: "à¥¬", 7: "à¥­", 8: "à¥®", 9: "à¥¯", 0: "à¥¦" }), zg = { "à¥§": "1", "à¥¨": "2", "à¥©": "3", "à¥ª": "4", "à¥«": "5", "à¥¬": "6", "à¥­": "7", "à¥®": "8", "à¥¯": "9", "à¥¦": "0" }, Ag = (Kf.defineLocale("ne", { months: "à¤à¤¨à¤µà¤°à¥_à¤«à¥à¤¬à¥à¤°à¥à¤µà¤°à¥_à¤®à¤¾à¤°à¥à¤_à¤à¤ªà¥à¤°à¤¿à¤²_à¤®à¤_à¤à¥à¤¨_à¤à¥à¤²à¤¾à¤_à¤à¤à¤·à¥à¤_à¤¸à¥à¤ªà¥à¤à¥à¤®à¥à¤¬à¤°_à¤à¤à¥à¤à¥à¤¬à¤°_à¤¨à¥à¤­à¥à¤®à¥à¤¬à¤°_à¤¡à¤¿à¤¸à¥à¤®à¥à¤¬à¤°".split("_"), monthsShort: "à¤à¤¨._à¤«à¥à¤¬à¥à¤°à¥._à¤®à¤¾à¤°à¥à¤_à¤à¤ªà¥à¤°à¤¿._à¤®à¤_à¤à¥à¤¨_à¤à¥à¤²à¤¾à¤._à¤à¤._à¤¸à¥à¤ªà¥à¤._à¤à¤à¥à¤à¥._à¤¨à¥à¤­à¥._à¤¡à¤¿à¤¸à¥.".split("_"), weekdays: "à¤à¤à¤¤à¤¬à¤¾à¤°_à¤¸à¥à¤®à¤¬à¤¾à¤°_à¤®à¤à¥à¤à¤²à¤¬à¤¾à¤°_à¤¬à¥à¤§à¤¬à¤¾à¤°_à¤¬à¤¿à¤¹à¤¿à¤¬à¤¾à¤°_à¤¶à¥à¤à¥à¤°à¤¬à¤¾à¤°_à¤¶à¤¨à¤¿à¤¬à¤¾à¤°".split("_"), weekdaysShort: "à¤à¤à¤¤._à¤¸à¥à¤®._à¤®à¤à¥à¤à¤²._à¤¬à¥à¤§._à¤¬à¤¿à¤¹à¤¿._à¤¶à¥à¤à¥à¤°._à¤¶à¤¨à¤¿.".split("_"), weekdaysMin: "à¤._à¤¸à¥._à¤®à¤._à¤¬à¥._à¤¬à¤¿._à¤¶à¥._à¤¶.".split("_"), longDateFormat: { LT: "Aà¤à¥ h:mm à¤¬à¤à¥", LTS: "Aà¤à¥ h:mm:ss à¤¬à¤à¥", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY, Aà¤à¥ h:mm à¤¬à¤à¥", LLLL: "dddd, D MMMM YYYY, Aà¤à¥ h:mm à¤¬à¤à¥" }, preparse: function (a) { return a.replace(/[à¥§à¥¨à¥©à¥ªà¥«à¥¬à¥­à¥®à¥¯à¥¦]/g, function (a) { return zg[a] }) }, postformat: function (a) { return a.replace(/\d/g, function (a) { return yg[a] }) }, meridiemParse: /à¤°à¤¾à¤¤à¤¿|à¤¬à¤¿à¤¹à¤¾à¤¨|à¤¦à¤¿à¤à¤à¤¸à¥|à¤¸à¤¾à¤à¤/, meridiemHour: function (a, b) { return 12 === a && (a = 0), "à¤°à¤¾à¤¤à¤¿" === b ? 4 > a ? a : a + 12 : "à¤¬à¤¿à¤¹à¤¾à¤¨" === b ? a : "à¤¦à¤¿à¤à¤à¤¸à¥" === b ? a >= 10 ? a : a + 12 : "à¤¸à¤¾à¤à¤" === b ? a + 12 : void 0 }, meridiem: function (a, b, c) { return 3 > a ? "à¤°à¤¾à¤¤à¤¿" : 12 > a ? "à¤¬à¤¿à¤¹à¤¾à¤¨" : 16 > a ? "à¤¦à¤¿à¤à¤à¤¸à¥" : 20 > a ? "à¤¸à¤¾à¤à¤" : "à¤°à¤¾à¤¤à¤¿" }, calendar: { sameDay: "[à¤à¤] LT", nextDay: "[à¤­à¥à¤²à¤¿] LT", nextWeek: "[à¤à¤à¤à¤¦à¥] dddd[,] LT", lastDay: "[à¤¹à¤¿à¤à¥] LT", lastWeek: "[à¤à¤à¤à¥] dddd[,] LT", sameElse: "L" }, relativeTime: { future: "%sà¤®à¤¾", past: "%s à¤à¤à¤¾à¤¡à¤¿", s: "à¤à¥à¤¹à¥ à¤à¥à¤·à¤£", m: "à¤à¤ à¤®à¤¿à¤¨à¥à¤", mm: "%d à¤®à¤¿à¤¨à¥à¤", h: "à¤à¤ à¤à¤£à¥à¤à¤¾", hh: "%d à¤à¤£à¥à¤à¤¾", d: "à¤à¤ à¤¦à¤¿à¤¨", dd: "%d à¤¦à¤¿à¤¨", M: "à¤à¤ à¤®à¤¹à¤¿à¤¨à¤¾", MM: "%d à¤®à¤¹à¤¿à¤¨à¤¾", y: "à¤à¤ à¤¬à¤°à¥à¤·", yy: "%d à¤¬à¤°à¥à¤·" }, week: { dow: 0, doy: 6 } }), "jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_")), Bg = "jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"), Cg = (Kf.defineLocale("nl", { months: "januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"), monthsShort: function (a, b) { return /-MMM-/.test(b) ? Bg[a.month()] : Ag[a.month()] }, weekdays: "zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"), weekdaysShort: "zo._ma._di._wo._do._vr._za.".split("_"), weekdaysMin: "Zo_Ma_Di_Wo_Do_Vr_Za".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD-MM-YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[vandaag om] LT", nextDay: "[morgen om] LT", nextWeek: "dddd [om] LT", lastDay: "[gisteren om] LT", lastWeek: "[afgelopen] dddd [om] LT", sameElse: "L" }, relativeTime: { future: "over %s", past: "%s geleden", s: "een paar seconden", m: "Ã©Ã©n minuut", mm: "%d minuten", h: "Ã©Ã©n uur", hh: "%d uur", d: "Ã©Ã©n dag", dd: "%d dagen", M: "Ã©Ã©n maand", MM: "%d maanden", y: "Ã©Ã©n jaar", yy: "%d jaar" }, ordinalParse: /\d{1,2}(ste|de)/, ordinal: function (a) { return a + (1 === a || 8 === a || a >= 20 ? "ste" : "de") }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("nn", { months: "januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"), monthsShort: "jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"), weekdays: "sundag_mÃ¥ndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"), weekdaysShort: "sun_mÃ¥n_tys_ons_tor_fre_lau".split("_"), weekdaysMin: "su_mÃ¥_ty_on_to_fr_lÃ¸".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY [kl.] H:mm", LLLL: "dddd D. MMMM YYYY [kl.] HH:mm" }, calendar: { sameDay: "[I dag klokka] LT", nextDay: "[I morgon klokka] LT", nextWeek: "dddd [klokka] LT", lastDay: "[I gÃ¥r klokka] LT", lastWeek: "[FÃ¸regÃ¥ande] dddd [klokka] LT", sameElse: "L" }, relativeTime: { future: "om %s", past: "for %s sidan", s: "nokre sekund", m: "eit minutt", mm: "%d minutt", h: "ein time", hh: "%d timar", d: "ein dag", dd: "%d dagar", M: "ein mÃ¥nad", MM: "%d mÃ¥nader", y: "eit Ã¥r", yy: "%d Ã¥r" }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), "styczeÅ_luty_marzec_kwiecieÅ_maj_czerwiec_lipiec_sierpieÅ_wrzesieÅ_paÅºdziernik_listopad_grudzieÅ".split("_")), Dg = "stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzeÅnia_paÅºdziernika_listopada_grudnia".split("_"), Eg = (Kf.defineLocale("pl", { months: function (a, b) { return "" === b ? "(" + Dg[a.month()] + "|" + Cg[a.month()] + ")" : /D MMMM/.test(b) ? Dg[a.month()] : Cg[a.month()] }, monthsShort: "sty_lut_mar_kwi_maj_cze_lip_sie_wrz_paÅº_lis_gru".split("_"), weekdays: "niedziela_poniedziaÅek_wtorek_Åroda_czwartek_piÄtek_sobota".split("_"), weekdaysShort: "nie_pon_wt_År_czw_pt_sb".split("_"), weekdaysMin: "Nd_Pn_Wt_År_Cz_Pt_So".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[DziÅ o] LT", nextDay: "[Jutro o] LT", nextWeek: "[W] dddd [o] LT", lastDay: "[Wczoraj o] LT", lastWeek: function () { switch (this.day()) { case 0: return "[W zeszÅÄ niedzielÄ o] LT"; case 3: return "[W zeszÅÄ ÅrodÄ o] LT"; case 6: return "[W zeszÅÄ sobotÄ o] LT"; default: return "[W zeszÅy] dddd [o] LT" } }, sameElse: "L" }, relativeTime: { future: "za %s", past: "%s temu", s: "kilka sekund", m: Bd, mm: Bd, h: Bd, hh: Bd, d: "1 dzieÅ", dd: "%d dni", M: "miesiÄc", MM: Bd, y: "rok", yy: Bd }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("pt-br", { months: "Janeiro_Fevereiro_MarÃ§o_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"), monthsShort: "Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"), weekdays: "Domingo_Segunda-Feira_TerÃ§a-Feira_Quarta-Feira_Quinta-Feira_Sexta-Feira_SÃ¡bado".split("_"), weekdaysShort: "Dom_Seg_Ter_Qua_Qui_Sex_SÃ¡b".split("_"), weekdaysMin: "Dom_2Âª_3Âª_4Âª_5Âª_6Âª_SÃ¡b".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D [de] MMMM [de] YYYY", LLL: "D [de] MMMM [de] YYYY [Ã s] HH:mm", LLLL: "dddd, D [de] MMMM [de] YYYY [Ã s] HH:mm" }, calendar: { sameDay: "[Hoje Ã s] LT", nextDay: "[AmanhÃ£ Ã s] LT", nextWeek: "dddd [Ã s] LT", lastDay: "[Ontem Ã s] LT", lastWeek: function () { return 0 === this.day() || 6 === this.day() ? "[Ãltimo] dddd [Ã s] LT" : "[Ãltima] dddd [Ã s] LT" }, sameElse: "L" }, relativeTime: { future: "em %s", past: "%s atrÃ¡s", s: "poucos segundos", m: "um minuto", mm: "%d minutos", h: "uma hora", hh: "%d horas", d: "um dia", dd: "%d dias", M: "um mÃªs", MM: "%d meses", y: "um ano", yy: "%d anos" }, ordinalParse: /\d{1,2}Âº/, ordinal: "%dÂº" }), Kf.defineLocale("pt", { months: "Janeiro_Fevereiro_MarÃ§o_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"), monthsShort: "Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"), weekdays: "Domingo_Segunda-Feira_TerÃ§a-Feira_Quarta-Feira_Quinta-Feira_Sexta-Feira_SÃ¡bado".split("_"), weekdaysShort: "Dom_Seg_Ter_Qua_Qui_Sex_SÃ¡b".split("_"), weekdaysMin: "Dom_2Âª_3Âª_4Âª_5Âª_6Âª_SÃ¡b".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D [de] MMMM [de] YYYY", LLL: "D [de] MMMM [de] YYYY HH:mm", LLLL: "dddd, D [de] MMMM [de] YYYY HH:mm" }, calendar: { sameDay: "[Hoje Ã s] LT", nextDay: "[AmanhÃ£ Ã s] LT", nextWeek: "dddd [Ã s] LT", lastDay: "[Ontem Ã s] LT", lastWeek: function () { return 0 === this.day() || 6 === this.day() ? "[Ãltimo] dddd [Ã s] LT" : "[Ãltima] dddd [Ã s] LT" }, sameElse: "L" }, relativeTime: { future: "em %s", past: "hÃ¡ %s", s: "segundos", m: "um minuto", mm: "%d minutos", h: "uma hora", hh: "%d horas", d: "um dia", dd: "%d dias", M: "um mÃªs", MM: "%d meses", y: "um ano", yy: "%d anos" }, ordinalParse: /\d{1,2}Âº/, ordinal: "%dÂº", week: { dow: 1, doy: 4 } }), Kf.defineLocale("ro", { months: "ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"), monthsShort: "ian._febr._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"), weekdays: "duminicÄ_luni_marÈi_miercuri_joi_vineri_sÃ¢mbÄtÄ".split("_"), weekdaysShort: "Dum_Lun_Mar_Mie_Joi_Vin_SÃ¢m".split("_"), weekdaysMin: "Du_Lu_Ma_Mi_Jo_Vi_SÃ¢".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY H:mm", LLLL: "dddd, D MMMM YYYY H:mm" }, calendar: { sameDay: "[azi la] LT", nextDay: "[mÃ¢ine la] LT", nextWeek: "dddd [la] LT", lastDay: "[ieri la] LT", lastWeek: "[fosta] dddd [la] LT", sameElse: "L" }, relativeTime: { future: "peste %s", past: "%s Ã®n urmÄ", s: "cÃ¢teva secunde", m: "un minut", mm: Cd, h: "o orÄ", hh: Cd, d: "o zi", dd: Cd, M: "o lunÄ", MM: Cd, y: "un an", yy: Cd }, week: { dow: 1, doy: 7 } }), [/^ÑÐ½Ð²/i, /^ÑÐµÐ²/i, /^Ð¼Ð°Ñ/i, /^Ð°Ð¿Ñ/i, /^Ð¼Ð°[Ð¹|Ñ]/i, /^Ð¸ÑÐ½/i, /^Ð¸ÑÐ»/i, /^Ð°Ð²Ð³/i, /^ÑÐµÐ½/i, /^Ð¾ÐºÑ/i, /^Ð½Ð¾Ñ/i, /^Ð´ÐµÐº/i]), Fg = (Kf.defineLocale("ru", { months: { format: "Ð¯Ð½Ð²Ð°ÑÑ_Ð¤ÐµÐ²ÑÐ°Ð»Ñ_ÐÐ°ÑÑÐ°_ÐÐ¿ÑÐµÐ»Ñ_ÐÐ°Ñ_ÐÑÐ½Ñ_ÐÑÐ»Ñ_ÐÐ²Ð³ÑÑÑÐ°_Ð¡ÐµÐ½ÑÑÐ±ÑÑ_ÐÐºÑÑÐ±ÑÑ_ÐÐ¾ÑÐ±ÑÑ_ÐÐµÐºÐ°Ð±ÑÑ".split("_"), standalone: "Ð¯Ð½Ð²Ð°ÑÑ_Ð¤ÐµÐ²ÑÐ°Ð»Ñ_ÐÐ°ÑÑ_ÐÐ¿ÑÐµÐ»Ñ_ÐÐ°Ð¹_ÐÑÐ½Ñ_ÐÑÐ»Ñ_ÐÐ²Ð³ÑÑÑ_Ð¡ÐµÐ½ÑÑÐ±ÑÑ_ÐÐºÑÑÐ±ÑÑ_ÐÐ¾ÑÐ±ÑÑ_ÐÐµÐºÐ°Ð±ÑÑ".split("_") }, monthsShort: { format: "ÑÐ½Ð²_ÑÐµÐ²_Ð¼Ð°Ñ_Ð°Ð¿Ñ_Ð¼Ð°Ñ_Ð¸ÑÐ½Ñ_Ð¸ÑÐ»Ñ_Ð°Ð²Ð³_ÑÐµÐ½_Ð¾ÐºÑ_Ð½Ð¾Ñ_Ð´ÐµÐº".split("_"), standalone: "ÑÐ½Ð²_ÑÐµÐ²_Ð¼Ð°ÑÑ_Ð°Ð¿Ñ_Ð¼Ð°Ð¹_Ð¸ÑÐ½Ñ_Ð¸ÑÐ»Ñ_Ð°Ð²Ð³_ÑÐµÐ½_Ð¾ÐºÑ_Ð½Ð¾Ñ_Ð´ÐµÐº".split("_") }, weekdays: { standalone: "ÐÐ¾ÑÐºÑÐµÑÐµÐ½ÑÐµ_ÐÐ¾Ð½ÐµÐ´ÐµÐ»ÑÐ½Ð¸Ðº_ÐÑÐ¾ÑÐ½Ð¸Ðº_Ð¡ÑÐµÐ´Ð°_Ð§ÐµÑÐ²ÐµÑÐ³_ÐÑÑÐ½Ð¸ÑÐ°_Ð¡ÑÐ±Ð±Ð¾ÑÐ°".split("_"), format: "ÐÐ¾ÑÐºÑÐµÑÐµÐ½ÑÐµ_ÐÐ¾Ð½ÐµÐ´ÐµÐ»ÑÐ½Ð¸Ðº_ÐÑÐ¾ÑÐ½Ð¸Ðº_Ð¡ÑÐµÐ´Ñ_Ð§ÐµÑÐ²ÐµÑÐ³_ÐÑÑÐ½Ð¸ÑÑ_Ð¡ÑÐ±Ð±Ð¾ÑÑ".split("_"), isFormat: /\[ ?[ÐÐ²] ?(?:Ð¿ÑÐ¾ÑÐ»ÑÑ|ÑÐ»ÐµÐ´ÑÑÑÑÑ|ÑÑÑ)? ?\] ?dddd/ }, weekdaysShort: "ÐÑ_ÐÐ½_ÐÑ_Ð¡Ñ_Ð§Ñ_ÐÑ_Ð¡Ð±".split("_"), weekdaysMin: "ÐÑ_ÐÐ½_ÐÑ_Ð¡Ñ_Ð§Ñ_ÐÑ_Ð¡Ð±".split("_"), monthsParse: Eg, longMonthsParse: Eg, shortMonthsParse: Eg, longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY Ð³.", LLL: "D MMMM YYYY Ð³., HH:mm", LLLL: "dddd, D MMMM YYYY Ð³., HH:mm" }, calendar: { sameDay: "[Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ Ð²] LT", nextDay: "[ÐÐ°Ð²ÑÑÐ° Ð²] LT", lastDay: "[ÐÑÐµÑÐ° Ð²] LT", nextWeek: function (a) { if (a.week() === this.week()) return 2 === this.day() ? "[ÐÐ¾] dddd [Ð²] LT" : "[Ð] dddd [Ð²] LT"; switch (this.day()) { case 0: return "[Ð ÑÐ»ÐµÐ´ÑÑÑÐµÐµ] dddd [Ð²] LT"; case 1: case 2: case 4: return "[Ð ÑÐ»ÐµÐ´ÑÑÑÐ¸Ð¹] dddd [Ð²] LT"; case 3: case 5: case 6: return "[Ð ÑÐ»ÐµÐ´ÑÑÑÑÑ] dddd [Ð²] LT" } }, lastWeek: function (a) { if (a.week() === this.week()) return 2 === this.day() ? "[ÐÐ¾] dddd [Ð²] LT" : "[Ð] dddd [Ð²] LT"; switch (this.day()) { case 0: return "[Ð Ð¿ÑÐ¾ÑÐ»Ð¾Ðµ] dddd [Ð²] LT"; case 1: case 2: case 4: return "[Ð Ð¿ÑÐ¾ÑÐ»ÑÐ¹] dddd [Ð²] LT"; case 3: case 5: case 6: return "[Ð Ð¿ÑÐ¾ÑÐ»ÑÑ] dddd [Ð²] LT" } }, sameElse: "L" }, relativeTime: { future: "ÑÐµÑÐµÐ· %s", past: "%s Ð½Ð°Ð·Ð°Ð´", s: "Ð½ÐµÑÐºÐ¾Ð»ÑÐºÐ¾ ÑÐµÐºÑÐ½Ð´", m: Ed, mm: Ed, h: "ÑÐ°Ñ", hh: Ed, d: "Ð´ÐµÐ½Ñ", dd: Ed, M: "Ð¼ÐµÑÑÑ", MM: Ed, y: "Ð³Ð¾Ð´", yy: Ed }, meridiemParse: /Ð½Ð¾ÑÐ¸|ÑÑÑÐ°|Ð´Ð½Ñ|Ð²ÐµÑÐµÑÐ°/i, isPM: function (a) { return /^(Ð´Ð½Ñ|Ð²ÐµÑÐµÑÐ°)$/.test(a) }, meridiem: function (a, b, c) { return 4 > a ? "Ð½Ð¾ÑÐ¸" : 12 > a ? "ÑÑÑÐ°" : 17 > a ? "Ð´Ð½Ñ" : "Ð²ÐµÑÐµÑÐ°" }, ordinalParse: /\d{1,2}-(Ð¹|Ð³Ð¾|Ñ)/, ordinal: function (a, b) { switch (b) { case "M": case "d": case "DDD": return a + "-Ð¹"; case "D": return a + "-Ð³Ð¾"; case "w": case "W": return a + "-Ñ"; default: return a } }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("se", { months: "oÄÄajagemÃ¡nnu_guovvamÃ¡nnu_njukÄamÃ¡nnu_cuoÅomÃ¡nnu_miessemÃ¡nnu_geassemÃ¡nnu_suoidnemÃ¡nnu_borgemÃ¡nnu_ÄakÄamÃ¡nnu_golggotmÃ¡nnu_skÃ¡bmamÃ¡nnu_juovlamÃ¡nnu".split("_"), monthsShort: "oÄÄj_guov_njuk_cuo_mies_geas_suoi_borg_ÄakÄ_golg_skÃ¡b_juov".split("_"), weekdays: "sotnabeaivi_vuossÃ¡rga_maÅÅebÃ¡rga_gaskavahkku_duorastat_bearjadat_lÃ¡vvardat".split("_"), weekdaysShort: "sotn_vuos_maÅ_gask_duor_bear_lÃ¡v".split("_"), weekdaysMin: "s_v_m_g_d_b_L".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "MMMM D. [b.] YYYY", LLL: "MMMM D. [b.] YYYY [ti.] HH:mm", LLLL: "dddd, MMMM D. [b.] YYYY [ti.] HH:mm" }, calendar: { sameDay: "[otne ti] LT", nextDay: "[ihttin ti] LT", nextWeek: "dddd [ti] LT", lastDay: "[ikte ti] LT", lastWeek: "[ovddit] dddd [ti] LT", sameElse: "L" }, relativeTime: { future: "%s geaÅ¾es", past: "maÅit %s", s: "moadde sekunddat", m: "okta minuhta", mm: "%d minuhtat", h: "okta diimmu", hh: "%d diimmut", d: "okta beaivi", dd: "%d beaivvit", M: "okta mÃ¡nnu", MM: "%d mÃ¡nut", y: "okta jahki", yy: "%d jagit" }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("si", { months: "à¶¢à¶±à·à·à¶»à·_à¶´à·à¶¶à¶»à·à·à¶»à·_à¶¸à·à¶»à·à¶­à·_à¶à¶´à·âà¶»à·à¶½à·_à¶¸à·à¶ºà·_à¶¢à·à¶±à·_à¶¢à·à¶½à·_à¶à¶à·à·à·à¶­à·_à·à·à¶´à·à¶­à·à¶¸à·à¶¶à¶»à·_à¶à¶à·à¶­à·à¶¶à¶»à·_à¶±à·à·à·à¶¸à·à¶¶à¶»à·_à¶¯à·à·à·à¶¸à·à¶¶à¶»à·".split("_"), monthsShort: "à¶¢à¶±_à¶´à·à¶¶_à¶¸à·à¶»à·_à¶à¶´à·_à¶¸à·à¶ºà·_à¶¢à·à¶±à·_à¶¢à·à¶½à·_à¶à¶à·_à·à·à¶´à·_à¶à¶à·_à¶±à·à·à·_à¶¯à·à·à·".split("_"), weekdays: "à¶à¶»à·à¶¯à·_à·à¶³à·à¶¯à·_à¶à¶à·à¶»à·à·à·à¶¯à·_à¶¶à¶¯à·à¶¯à·_à¶¶à·âà¶»à·à·à·à¶´à¶­à·à¶±à·à¶¯à·_à·à·à¶à·à¶»à·à¶¯à·_à·à·à¶±à·à·à¶»à·à¶¯à·".split("_"), weekdaysShort: "à¶à¶»à·_à·à¶³à·_à¶à¶_à¶¶à¶¯à·_à¶¶à·âà¶»à·_à·à·à¶à·_à·à·à¶±".split("_"), weekdaysMin: "à¶_à·_à¶_à¶¶_à¶¶à·âà¶»_à·à·_à·à·".split("_"), longDateFormat: { LT: "a h:mm", LTS: "a h:mm:ss", L: "YYYY/MM/DD", LL: "YYYY MMMM D", LLL: "YYYY MMMM D, a h:mm", LLLL: "YYYY MMMM D [à·à·à¶±à·] dddd, a h:mm:ss" }, calendar: { sameDay: "[à¶à¶¯] LT[à¶§]", nextDay: "[à·à·à¶§] LT[à¶§]", nextWeek: "dddd LT[à¶§]", lastDay: "[à¶à¶ºà·] LT[à¶§]", lastWeek: "[à¶´à·à·à¶à·à¶º] dddd LT[à¶§]", sameElse: "L" }, relativeTime: { future: "%sà¶à·à¶±à·", past: "%sà¶à¶§ à¶´à·à¶»", s: "à¶­à¶­à·à¶´à¶» à¶à·à·à·à¶´à¶º", m: "à¶¸à·à¶±à·à¶­à·à¶­à·à·", mm: "à¶¸à·à¶±à·à¶­à·à¶­à· %d", h: "à¶´à·à¶º", hh: "à¶´à·à¶º %d", d: "à¶¯à·à¶±à¶º", dd: "à¶¯à·à¶± %d", M: "à¶¸à·à·à¶º", MM: "à¶¸à·à· %d", y: "à·à·à¶»", yy: "à·à·à¶» %d" }, ordinalParse: /\d{1,2} à·à·à¶±à·/, ordinal: function (a) { return a + " à·à·à¶±à·" }, meridiem: function (a, b, c) { return a > 11 ? c ? "à¶´.à·." : "à¶´à·à· à·à¶»à·" : c ? "à¶´à·.à·." : "à¶´à·à¶» à·à¶»à·" } }), "januÃ¡r_februÃ¡r_marec_aprÃ­l_mÃ¡j_jÃºn_jÃºl_august_september_oktÃ³ber_november_december".split("_")), Gg = "jan_feb_mar_apr_mÃ¡j_jÃºn_jÃºl_aug_sep_okt_nov_dec".split("_"), Hg = (Kf.defineLocale("sk", { months: Fg, monthsShort: Gg, weekdays: "nedeÄ¾a_pondelok_utorok_streda_Å¡tvrtok_piatok_sobota".split("_"), weekdaysShort: "ne_po_ut_st_Å¡t_pi_so".split("_"), weekdaysMin: "ne_po_ut_st_Å¡t_pi_so".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD.MM.YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY H:mm", LLLL: "dddd D. MMMM YYYY H:mm" }, calendar: { sameDay: "[dnes o] LT", nextDay: "[zajtra o] LT", nextWeek: function () { switch (this.day()) { case 0: return "[v nedeÄ¾u o] LT"; case 1: case 2: return "[v] dddd [o] LT"; case 3: return "[v stredu o] LT"; case 4: return "[vo Å¡tvrtok o] LT"; case 5: return "[v piatok o] LT"; case 6: return "[v sobotu o] LT" } }, lastDay: "[vÄera o] LT", lastWeek: function () { switch (this.day()) { case 0: return "[minulÃº nedeÄ¾u o] LT"; case 1: case 2: return "[minulÃ½] dddd [o] LT"; case 3: return "[minulÃº stredu o] LT"; case 4: case 5: return "[minulÃ½] dddd [o] LT"; case 6: return "[minulÃº sobotu o] LT" } }, sameElse: "L" }, relativeTime: { future: "za %s", past: "pred %s", s: Gd, m: Gd, mm: Gd, h: Gd, hh: Gd, d: Gd, dd: Gd, M: Gd, MM: Gd, y: Gd, yy: Gd }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("sl", { months: "januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"), monthsShort: "jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"), weekdays: "nedelja_ponedeljek_torek_sreda_Äetrtek_petek_sobota".split("_"), weekdaysShort: "ned._pon._tor._sre._Äet._pet._sob.".split("_"), weekdaysMin: "ne_po_to_sr_Äe_pe_so".split("_"), longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD. MM. YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY H:mm", LLLL: "dddd, D. MMMM YYYY H:mm" }, calendar: { sameDay: "[danes ob] LT", nextDay: "[jutri ob] LT", nextWeek: function () { switch (this.day()) { case 0: return "[v] [nedeljo] [ob] LT"; case 3: return "[v] [sredo] [ob] LT"; case 6: return "[v] [soboto] [ob] LT"; case 1: case 2: case 4: case 5: return "[v] dddd [ob] LT" } }, lastDay: "[vÄeraj ob] LT", lastWeek: function () { switch (this.day()) { case 0: return "[prejÅ¡njo] [nedeljo] [ob] LT"; case 3: return "[prejÅ¡njo] [sredo] [ob] LT"; case 6: return "[prejÅ¡njo] [soboto] [ob] LT"; case 1: case 2: case 4: case 5: return "[prejÅ¡nji] dddd [ob] LT" } }, sameElse: "L" }, relativeTime: { future: "Äez %s", past: "pred %s", s: Hd, m: Hd, mm: Hd, h: Hd, hh: Hd, d: Hd, dd: Hd, M: Hd, MM: Hd, y: Hd, yy: Hd }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 7 } }), Kf.defineLocale("sq", { months: "Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_NÃ«ntor_Dhjetor".split("_"), monthsShort: "Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_NÃ«n_Dhj".split("_"), weekdays: "E Diel_E HÃ«nÃ«_E MartÃ«_E MÃ«rkurÃ«_E Enjte_E Premte_E ShtunÃ«".split("_"), weekdaysShort: "Die_HÃ«n_Mar_MÃ«r_Enj_Pre_Sht".split("_"), weekdaysMin: "D_H_Ma_MÃ«_E_P_Sh".split("_"), meridiemParse: /PD|MD/, isPM: function (a) { return "M" === a.charAt(0) }, meridiem: function (a, b, c) { return 12 > a ? "PD" : "MD" }, longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Sot nÃ«] LT", nextDay: "[NesÃ«r nÃ«] LT", nextWeek: "dddd [nÃ«] LT", lastDay: "[Dje nÃ«] LT", lastWeek: "dddd [e kaluar nÃ«] LT", sameElse: "L" }, relativeTime: { future: "nÃ« %s", past: "%s mÃ« parÃ«", s: "disa sekonda", m: "njÃ« minutÃ«", mm: "%d minuta", h: "njÃ« orÃ«", hh: "%d orÃ«", d: "njÃ« ditÃ«", dd: "%d ditÃ«", M: "njÃ« muaj", MM: "%d muaj", y: "njÃ« vit", yy: "%d vite" }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), { words: { m: ["ÑÐµÐ´Ð°Ð½ Ð¼Ð¸Ð½ÑÑ", "ÑÐµÐ´Ð½Ðµ Ð¼Ð¸Ð½ÑÑÐµ"], mm: ["Ð¼Ð¸Ð½ÑÑ", "Ð¼Ð¸Ð½ÑÑÐµ", "Ð¼Ð¸Ð½ÑÑÐ°"], h: ["ÑÐµÐ´Ð°Ð½ ÑÐ°Ñ", "ÑÐµÐ´Ð½Ð¾Ð³ ÑÐ°ÑÐ°"], hh: ["ÑÐ°Ñ", "ÑÐ°ÑÐ°", "ÑÐ°ÑÐ¸"], dd: ["Ð´Ð°Ð½", "Ð´Ð°Ð½Ð°", "Ð´Ð°Ð½Ð°"], MM: ["Ð¼ÐµÑÐµÑ", "Ð¼ÐµÑÐµÑÐ°", "Ð¼ÐµÑÐµÑÐ¸"], yy: ["Ð³Ð¾Ð´Ð¸Ð½Ð°", "Ð³Ð¾Ð´Ð¸Ð½Ðµ", "Ð³Ð¾Ð´Ð¸Ð½Ð°"] }, correctGrammaticalCase: function (a, b) { return 1 === a ? b[0] : a >= 2 && 4 >= a ? b[1] : b[2] }, translate: function (a, b, c) { var d = Hg.words[c]; return 1 === c.length ? b ? d[0] : d[1] : a + " " + Hg.correctGrammaticalCase(a, d) } }), Ig = (Kf.defineLocale("sr-cyrl", { months: ["ÑÐ°Ð½ÑÐ°Ñ", "ÑÐµÐ±ÑÑÐ°Ñ", "Ð¼Ð°ÑÑ", "Ð°Ð¿ÑÐ¸Ð»", "Ð¼Ð°Ñ", "ÑÑÐ½", "ÑÑÐ»", "Ð°Ð²Ð³ÑÑÑ", "ÑÐµÐ¿ÑÐµÐ¼Ð±Ð°Ñ", "Ð¾ÐºÑÐ¾Ð±Ð°Ñ", "Ð½Ð¾Ð²ÐµÐ¼Ð±Ð°Ñ", "Ð´ÐµÑÐµÐ¼Ð±Ð°Ñ"], monthsShort: ["ÑÐ°Ð½.", "ÑÐµÐ±.", "Ð¼Ð°Ñ.", "Ð°Ð¿Ñ.", "Ð¼Ð°Ñ", "ÑÑÐ½", "ÑÑÐ»", "Ð°Ð²Ð³.", "ÑÐµÐ¿.", "Ð¾ÐºÑ.", "Ð½Ð¾Ð².", "Ð´ÐµÑ."], weekdays: ["Ð½ÐµÐ´ÐµÑÐ°", "Ð¿Ð¾Ð½ÐµÐ´ÐµÑÐ°Ðº", "ÑÑÐ¾ÑÐ°Ðº", "ÑÑÐµÐ´Ð°", "ÑÐµÑÐ²ÑÑÐ°Ðº", "Ð¿ÐµÑÐ°Ðº", "ÑÑÐ±Ð¾ÑÐ°"], weekdaysShort: ["Ð½ÐµÐ´.", "Ð¿Ð¾Ð½.", "ÑÑÐ¾.", "ÑÑÐµ.", "ÑÐµÑ.", "Ð¿ÐµÑ.", "ÑÑÐ±."], weekdaysMin: ["Ð½Ðµ", "Ð¿Ð¾", "ÑÑ", "ÑÑ", "ÑÐµ", "Ð¿Ðµ", "ÑÑ"], longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD. MM. YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY H:mm", LLLL: "dddd, D. MMMM YYYY H:mm" }, calendar: { sameDay: "[Ð´Ð°Ð½Ð°Ñ Ñ] LT", nextDay: "[ÑÑÑÑÐ° Ñ] LT", nextWeek: function () { switch (this.day()) { case 0: return "[Ñ] [Ð½ÐµÐ´ÐµÑÑ] [Ñ] LT"; case 3: return "[Ñ] [ÑÑÐµÐ´Ñ] [Ñ] LT"; case 6: return "[Ñ] [ÑÑÐ±Ð¾ÑÑ] [Ñ] LT"; case 1: case 2: case 4: case 5: return "[Ñ] dddd [Ñ] LT" } }, lastDay: "[ÑÑÑÐµ Ñ] LT", lastWeek: function () { var a = ["[Ð¿ÑÐ¾ÑÐ»Ðµ] [Ð½ÐµÐ´ÐµÑÐµ] [Ñ] LT", "[Ð¿ÑÐ¾ÑÐ»Ð¾Ð³] [Ð¿Ð¾Ð½ÐµÐ´ÐµÑÐºÐ°] [Ñ] LT", "[Ð¿ÑÐ¾ÑÐ»Ð¾Ð³] [ÑÑÐ¾ÑÐºÐ°] [Ñ] LT", "[Ð¿ÑÐ¾ÑÐ»Ðµ] [ÑÑÐµÐ´Ðµ] [Ñ] LT", "[Ð¿ÑÐ¾ÑÐ»Ð¾Ð³] [ÑÐµÑÐ²ÑÑÐºÐ°] [Ñ] LT", "[Ð¿ÑÐ¾ÑÐ»Ð¾Ð³] [Ð¿ÐµÑÐºÐ°] [Ñ] LT", "[Ð¿ÑÐ¾ÑÐ»Ðµ] [ÑÑÐ±Ð¾ÑÐµ] [Ñ] LT"]; return a[this.day()] }, sameElse: "L" }, relativeTime: { future: "Ð·Ð° %s", past: "Ð¿ÑÐµ %s", s: "Ð½ÐµÐºÐ¾Ð»Ð¸ÐºÐ¾ ÑÐµÐºÑÐ½Ð´Ð¸", m: Hg.translate, mm: Hg.translate, h: Hg.translate, hh: Hg.translate, d: "Ð´Ð°Ð½", dd: Hg.translate, M: "Ð¼ÐµÑÐµÑ", MM: Hg.translate, y: "Ð³Ð¾Ð´Ð¸Ð½Ñ", yy: Hg.translate }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 7 } }), { words: { m: ["jedan minut", "jedne minute"], mm: ["minut", "minute", "minuta"], h: ["jedan sat", "jednog sata"], hh: ["sat", "sata", "sati"], dd: ["dan", "dana", "dana"], MM: ["mesec", "meseca", "meseci"], yy: ["godina", "godine", "godina"] }, correctGrammaticalCase: function (a, b) { return 1 === a ? b[0] : a >= 2 && 4 >= a ? b[1] : b[2] }, translate: function (a, b, c) { var d = Ig.words[c]; return 1 === c.length ? b ? d[0] : d[1] : a + " " + Ig.correctGrammaticalCase(a, d) } }), Jg = (Kf.defineLocale("sr", {
        months: ["januar", "februar", "mart", "april", "maj", "jun", "jul", "avgust", "septembar", "oktobar", "novembar", "decembar"], monthsShort: ["jan.", "feb.", "mar.", "apr.", "maj", "jun", "jul", "avg.", "sep.", "okt.", "nov.", "dec."], weekdays: ["nedelja", "ponedeljak", "utorak", "sreda", "Äetvrtak", "petak", "subota"], weekdaysShort: ["ned.", "pon.", "uto.", "sre.", "Äet.", "pet.", "sub."], weekdaysMin: ["ne", "po", "ut", "sr", "Äe", "pe", "su"], longDateFormat: { LT: "H:mm", LTS: "H:mm:ss", L: "DD. MM. YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY H:mm", LLLL: "dddd, D. MMMM YYYY H:mm" }, calendar: { sameDay: "[danas u] LT", nextDay: "[sutra u] LT", nextWeek: function () { switch (this.day()) { case 0: return "[u] [nedelju] [u] LT"; case 3: return "[u] [sredu] [u] LT"; case 6: return "[u] [subotu] [u] LT"; case 1: case 2: case 4: case 5: return "[u] dddd [u] LT" } }, lastDay: "[juÄe u] LT", lastWeek: function () { var a = ["[proÅ¡le] [nedelje] [u] LT", "[proÅ¡log] [ponedeljka] [u] LT", "[proÅ¡log] [utorka] [u] LT", "[proÅ¡le] [srede] [u] LT", "[proÅ¡log] [Äetvrtka] [u] LT", "[proÅ¡log] [petka] [u] LT", "[proÅ¡le] [subote] [u] LT"]; return a[this.day()] }, sameElse: "L" }, relativeTime: {
            future: "za %s", past: "pre %s", s: "nekoliko sekundi", m: Ig.translate, mm: Ig.translate, h: Ig.translate, hh: Ig.translate, d: "dan", dd: Ig.translate, M: "mesec", MM: Ig.translate, y: "godinu", yy: Ig.translate
        }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 7 }
    }), Kf.defineLocale("sv", { months: "januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"), monthsShort: "jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"), weekdays: "sÃ¶ndag_mÃ¥ndag_tisdag_onsdag_torsdag_fredag_lÃ¶rdag".split("_"), weekdaysShort: "sÃ¶n_mÃ¥n_tis_ons_tor_fre_lÃ¶r".split("_"), weekdaysMin: "sÃ¶_mÃ¥_ti_on_to_fr_lÃ¶".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "YYYY-MM-DD", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[Idag] LT", nextDay: "[Imorgon] LT", lastDay: "[IgÃ¥r] LT", nextWeek: "[PÃ¥] dddd LT", lastWeek: "[I] dddd[s] LT", sameElse: "L" }, relativeTime: { future: "om %s", past: "fÃ¶r %s sedan", s: "nÃ¥gra sekunder", m: "en minut", mm: "%d minuter", h: "en timme", hh: "%d timmar", d: "en dag", dd: "%d dagar", M: "en mÃ¥nad", MM: "%d mÃ¥nader", y: "ett Ã¥r", yy: "%d Ã¥r" }, ordinalParse: /\d{1,2}(e|a)/, ordinal: function (a) { var b = a % 10, c = 1 === ~~(a % 100 / 10) ? "e" : 1 === b ? "a" : 2 === b ? "a" : "e"; return a + c }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("sw", { months: "Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"), monthsShort: "Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"), weekdays: "Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"), weekdaysShort: "Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"), weekdaysMin: "J2_J3_J4_J5_Al_Ij_J1".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[leo saa] LT", nextDay: "[kesho saa] LT", nextWeek: "[wiki ijayo] dddd [saat] LT", lastDay: "[jana] LT", lastWeek: "[wiki iliyopita] dddd [saat] LT", sameElse: "L" }, relativeTime: { future: "%s baadaye", past: "tokea %s", s: "hivi punde", m: "dakika moja", mm: "dakika %d", h: "saa limoja", hh: "masaa %d", d: "siku moja", dd: "masiku %d", M: "mwezi mmoja", MM: "miezi %d", y: "mwaka mmoja", yy: "miaka %d" }, week: { dow: 1, doy: 7 } }), { 1: "à¯§", 2: "à¯¨", 3: "à¯©", 4: "à¯ª", 5: "à¯«", 6: "à¯¬", 7: "à¯­", 8: "à¯®", 9: "à¯¯", 0: "à¯¦" }), Kg = { "à¯§": "1", "à¯¨": "2", "à¯©": "3", "à¯ª": "4", "à¯«": "5", "à¯¬": "6", "à¯­": "7", "à¯®": "8", "à¯¯": "9", "à¯¦": "0" }, Lg = (Kf.defineLocale("ta", { months: "à®à®©à®µà®°à®¿_à®ªà®¿à®ªà¯à®°à®µà®°à®¿_à®®à®¾à®°à¯à®à¯_à®à®ªà¯à®°à®²à¯_à®®à¯_à®à¯à®©à¯_à®à¯à®²à¯_à®à®à®¸à¯à®à¯_à®à¯à®ªà¯à®à¯à®®à¯à®ªà®°à¯_à®à®à¯à®à¯à®¾à®ªà®°à¯_à®¨à®µà®®à¯à®ªà®°à¯_à®à®¿à®à®®à¯à®ªà®°à¯".split("_"), monthsShort: "à®à®©à®µà®°à®¿_à®ªà®¿à®ªà¯à®°à®µà®°à®¿_à®®à®¾à®°à¯à®à¯_à®à®ªà¯à®°à®²à¯_à®®à¯_à®à¯à®©à¯_à®à¯à®²à¯_à®à®à®¸à¯à®à¯_à®à¯à®ªà¯à®à¯à®®à¯à®ªà®°à¯_à®à®à¯à®à¯à®¾à®ªà®°à¯_à®¨à®µà®®à¯à®ªà®°à¯_à®à®¿à®à®®à¯à®ªà®°à¯".split("_"), weekdays: "à®à®¾à®¯à®¿à®±à¯à®±à¯à®à¯à®à®¿à®´à®®à¯_à®¤à®¿à®à¯à®à®à¯à®à®¿à®´à®®à¯_à®à¯à®µà¯à®µà®¾à®¯à¯à®à®¿à®´à®®à¯_à®ªà¯à®¤à®©à¯à®à®¿à®´à®®à¯_à®µà®¿à®¯à®¾à®´à®à¯à®à®¿à®´à®®à¯_à®µà¯à®³à¯à®³à®¿à®à¯à®à®¿à®´à®®à¯_à®à®©à®¿à®à¯à®à®¿à®´à®®à¯".split("_"), weekdaysShort: "à®à®¾à®¯à®¿à®±à¯_à®¤à®¿à®à¯à®à®³à¯_à®à¯à®µà¯à®µà®¾à®¯à¯_à®ªà¯à®¤à®©à¯_à®µà®¿à®¯à®¾à®´à®©à¯_à®µà¯à®³à¯à®³à®¿_à®à®©à®¿".split("_"), weekdaysMin: "à®à®¾_à®¤à®¿_à®à¯_à®ªà¯_à®µà®¿_à®µà¯_à®".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY, HH:mm", LLLL: "dddd, D MMMM YYYY, HH:mm" }, calendar: { sameDay: "[à®à®©à¯à®±à¯] LT", nextDay: "[à®¨à®¾à®³à¯] LT", nextWeek: "dddd, LT", lastDay: "[à®¨à¯à®±à¯à®±à¯] LT", lastWeek: "[à®à®à®¨à¯à®¤ à®µà®¾à®°à®®à¯] dddd, LT", sameElse: "L" }, relativeTime: { future: "%s à®à®²à¯", past: "%s à®®à¯à®©à¯", s: "à®à®°à¯ à®à®¿à®² à®µà®¿à®¨à®¾à®à®¿à®à®³à¯", m: "à®à®°à¯ à®¨à®¿à®®à®¿à®à®®à¯", mm: "%d à®¨à®¿à®®à®¿à®à®à¯à®à®³à¯", h: "à®à®°à¯ à®®à®£à®¿ à®¨à¯à®°à®®à¯", hh: "%d à®®à®£à®¿ à®¨à¯à®°à®®à¯", d: "à®à®°à¯ à®¨à®¾à®³à¯", dd: "%d à®¨à®¾à®à¯à®à®³à¯", M: "à®à®°à¯ à®®à®¾à®¤à®®à¯", MM: "%d à®®à®¾à®¤à®à¯à®à®³à¯", y: "à®à®°à¯ à®µà®°à¯à®à®®à¯", yy: "%d à®à®£à¯à®à¯à®à®³à¯" }, ordinalParse: /\d{1,2}à®µà®¤à¯/, ordinal: function (a) { return a + "à®µà®¤à¯" }, preparse: function (a) { return a.replace(/[à¯§à¯¨à¯©à¯ªà¯«à¯¬à¯­à¯®à¯¯à¯¦]/g, function (a) { return Kg[a] }) }, postformat: function (a) { return a.replace(/\d/g, function (a) { return Jg[a] }) }, meridiemParse: /à®¯à®¾à®®à®®à¯|à®µà¯à®à®±à¯|à®à®¾à®²à¯|à®¨à®£à¯à®ªà®à®²à¯|à®à®±à¯à®ªà®¾à®à¯|à®®à®¾à®²à¯/, meridiem: function (a, b, c) { return 2 > a ? " à®¯à®¾à®®à®®à¯" : 6 > a ? " à®µà¯à®à®±à¯" : 10 > a ? " à®à®¾à®²à¯" : 14 > a ? " à®¨à®£à¯à®ªà®à®²à¯" : 18 > a ? " à®à®±à¯à®ªà®¾à®à¯" : 22 > a ? " à®®à®¾à®²à¯" : " à®¯à®¾à®®à®®à¯" }, meridiemHour: function (a, b) { return 12 === a && (a = 0), "à®¯à®¾à®®à®®à¯" === b ? 2 > a ? a : a + 12 : "à®µà¯à®à®±à¯" === b || "à®à®¾à®²à¯" === b ? a : "à®¨à®£à¯à®ªà®à®²à¯" === b && a >= 10 ? a : a + 12 }, week: { dow: 0, doy: 6 } }), Kf.defineLocale("te", { months: "à°à°¨à°µà°°à°¿_à°«à°¿à°¬à±à°°à°µà°°à°¿_à°®à°¾à°°à±à°à°¿_à°à°ªà±à°°à°¿à°²à±_à°®à±_à°à±à°¨à±_à°à±à°²à±à±_à°à°à°¸à±à°à±_à°¸à±à°ªà±à°à±à°à°¬à°°à±_à°à°à±à°à±à°¬à°°à±_à°¨à°µà°à°¬à°°à±_à°¡à°¿à°¸à±à°à°¬à°°à±".split("_"), monthsShort: "à°à°¨._à°«à°¿à°¬à±à°°._à°®à°¾à°°à±à°à°¿_à°à°ªà±à°°à°¿._à°®à±_à°à±à°¨à±_à°à±à°²à±à±_à°à°._à°¸à±à°ªà±._à°à°à±à°à±._à°¨à°µ._à°¡à°¿à°¸à±.".split("_"), weekdays: "à°à°¦à°¿à°µà°¾à°°à°_à°¸à±à°®à°µà°¾à°°à°_à°®à°à°à°³à°µà°¾à°°à°_à°¬à±à°§à°µà°¾à°°à°_à°à±à°°à±à°µà°¾à°°à°_à°¶à±à°à±à°°à°µà°¾à°°à°_à°¶à°¨à°¿à°µà°¾à°°à°".split("_"), weekdaysShort: "à°à°¦à°¿_à°¸à±à°®_à°®à°à°à°³_à°¬à±à°§_à°à±à°°à±_à°¶à±à°à±à°°_à°¶à°¨à°¿".split("_"), weekdaysMin: "à°_à°¸à±_à°®à°_à°¬à±_à°à±_à°¶à±_à°¶".split("_"), longDateFormat: { LT: "A h:mm", LTS: "A h:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY, A h:mm", LLLL: "dddd, D MMMM YYYY, A h:mm" }, calendar: { sameDay: "[à°¨à±à°¡à±] LT", nextDay: "[à°°à±à°ªà±] LT", nextWeek: "dddd, LT", lastDay: "[à°¨à°¿à°¨à±à°¨] LT", lastWeek: "[à°à°¤] dddd, LT", sameElse: "L" }, relativeTime: { future: "%s à°²à±", past: "%s à°à±à°°à°¿à°¤à°", s: "à°à±à°¨à±à°¨à°¿ à°à±à°·à°£à°¾à°²à±", m: "à°à° à°¨à°¿à°®à°¿à°·à°", mm: "%d à°¨à°¿à°®à°¿à°·à°¾à°²à±", h: "à°à° à°à°à°", hh: "%d à°à°à°à°²à±", d: "à°à° à°°à±à°à±", dd: "%d à°°à±à°à±à°²à±", M: "à°à° à°¨à±à°²", MM: "%d à°¨à±à°²à°²à±", y: "à°à° à°¸à°à°µà°¤à±à°¸à°°à°", yy: "%d à°¸à°à°µà°¤à±à°¸à°°à°¾à°²à±" }, ordinalParse: /\d{1,2}à°µ/, ordinal: "%dà°µ", meridiemParse: /à°°à°¾à°¤à±à°°à°¿|à°à°¦à°¯à°|à°®à°§à±à°¯à°¾à°¹à±à°¨à°|à°¸à°¾à°¯à°à°¤à±à°°à°/, meridiemHour: function (a, b) { return 12 === a && (a = 0), "à°°à°¾à°¤à±à°°à°¿" === b ? 4 > a ? a : a + 12 : "à°à°¦à°¯à°" === b ? a : "à°®à°§à±à°¯à°¾à°¹à±à°¨à°" === b ? a >= 10 ? a : a + 12 : "à°¸à°¾à°¯à°à°¤à±à°°à°" === b ? a + 12 : void 0 }, meridiem: function (a, b, c) { return 4 > a ? "à°°à°¾à°¤à±à°°à°¿" : 10 > a ? "à°à°¦à°¯à°" : 17 > a ? "à°®à°§à±à°¯à°¾à°¹à±à°¨à°" : 20 > a ? "à°¸à°¾à°¯à°à°¤à±à°°à°" : "à°°à°¾à°¤à±à°°à°¿" }, week: { dow: 0, doy: 6 } }), Kf.defineLocale("th", { months: "à¸¡à¸à¸£à¸²à¸à¸¡_à¸à¸¸à¸¡à¸ à¸²à¸à¸±à¸à¸à¹_à¸¡à¸µà¸à¸²à¸à¸¡_à¹à¸¡à¸©à¸²à¸¢à¸_à¸à¸¤à¸©à¸ à¸²à¸à¸¡_à¸¡à¸´à¸à¸¸à¸à¸²à¸¢à¸_à¸à¸£à¸à¸à¸²à¸à¸¡_à¸ªà¸´à¸à¸«à¸²à¸à¸¡_à¸à¸±à¸à¸¢à¸²à¸¢à¸_à¸à¸¸à¸¥à¸²à¸à¸¡_à¸à¸¤à¸¨à¸à¸´à¸à¸²à¸¢à¸_à¸à¸±à¸à¸§à¸²à¸à¸¡".split("_"), monthsShort: "à¸¡à¸à¸£à¸²_à¸à¸¸à¸¡à¸ à¸²_à¸¡à¸µà¸à¸²_à¹à¸¡à¸©à¸²_à¸à¸¤à¸©à¸ à¸²_à¸¡à¸´à¸à¸¸à¸à¸²_à¸à¸£à¸à¸à¸²_à¸ªà¸´à¸à¸«à¸²_à¸à¸±à¸à¸¢à¸²_à¸à¸¸à¸¥à¸²_à¸à¸¤à¸¨à¸à¸´à¸à¸²_à¸à¸±à¸à¸§à¸²".split("_"), weekdays: "à¸­à¸²à¸à¸´à¸à¸¢à¹_à¸à¸±à¸à¸à¸£à¹_à¸­à¸±à¸à¸à¸²à¸£_à¸à¸¸à¸_à¸à¸¤à¸«à¸±à¸ªà¸à¸à¸µ_à¸¨à¸¸à¸à¸£à¹_à¹à¸ªà¸²à¸£à¹".split("_"), weekdaysShort: "à¸­à¸²à¸à¸´à¸à¸¢à¹_à¸à¸±à¸à¸à¸£à¹_à¸­à¸±à¸à¸à¸²à¸£_à¸à¸¸à¸_à¸à¸¤à¸«à¸±à¸ª_à¸¨à¸¸à¸à¸£à¹_à¹à¸ªà¸²à¸£à¹".split("_"), weekdaysMin: "à¸­à¸²._à¸._à¸­._à¸._à¸à¸¤._à¸¨._à¸ª.".split("_"), longDateFormat: { LT: "H à¸à¸²à¸¬à¸´à¸à¸² m à¸à¸²à¸à¸µ", LTS: "H à¸à¸²à¸¬à¸´à¸à¸² m à¸à¸²à¸à¸µ s à¸§à¸´à¸à¸²à¸à¸µ", L: "YYYY/MM/DD", LL: "D MMMM YYYY", LLL: "D MMMM YYYY à¹à¸§à¸¥à¸² H à¸à¸²à¸¬à¸´à¸à¸² m à¸à¸²à¸à¸µ", LLLL: "à¸§à¸±à¸ddddà¸à¸µà¹ D MMMM YYYY à¹à¸§à¸¥à¸² H à¸à¸²à¸¬à¸´à¸à¸² m à¸à¸²à¸à¸µ" }, meridiemParse: /à¸à¹à¸­à¸à¹à¸à¸µà¹à¸¢à¸|à¸«à¸¥à¸±à¸à¹à¸à¸µà¹à¸¢à¸/, isPM: function (a) { return "à¸«à¸¥à¸±à¸à¹à¸à¸µà¹à¸¢à¸" === a }, meridiem: function (a, b, c) { return 12 > a ? "à¸à¹à¸­à¸à¹à¸à¸µà¹à¸¢à¸" : "à¸«à¸¥à¸±à¸à¹à¸à¸µà¹à¸¢à¸" }, calendar: { sameDay: "[à¸§à¸±à¸à¸à¸µà¹ à¹à¸§à¸¥à¸²] LT", nextDay: "[à¸à¸£à¸¸à¹à¸à¸à¸µà¹ à¹à¸§à¸¥à¸²] LT", nextWeek: "dddd[à¸«à¸à¹à¸² à¹à¸§à¸¥à¸²] LT", lastDay: "[à¹à¸¡à¸·à¹à¸­à¸§à¸²à¸à¸à¸µà¹ à¹à¸§à¸¥à¸²] LT", lastWeek: "[à¸§à¸±à¸]dddd[à¸à¸µà¹à¹à¸¥à¹à¸§ à¹à¸§à¸¥à¸²] LT", sameElse: "L" }, relativeTime: { future: "à¸­à¸µà¸ %s", past: "%sà¸à¸µà¹à¹à¸¥à¹à¸§", s: "à¹à¸¡à¹à¸à¸µà¹à¸§à¸´à¸à¸²à¸à¸µ", m: "1 à¸à¸²à¸à¸µ", mm: "%d à¸à¸²à¸à¸µ", h: "1 à¸à¸±à¹à¸§à¹à¸¡à¸", hh: "%d à¸à¸±à¹à¸§à¹à¸¡à¸", d: "1 à¸§à¸±à¸", dd: "%d à¸§à¸±à¸", M: "1 à¹à¸à¸·à¸­à¸", MM: "%d à¹à¸à¸·à¸­à¸", y: "1 à¸à¸µ", yy: "%d à¸à¸µ" } }), Kf.defineLocale("tl-ph", { months: "Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"), monthsShort: "Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"), weekdays: "Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"), weekdaysShort: "Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"), weekdaysMin: "Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "MM/D/YYYY", LL: "MMMM D, YYYY", LLL: "MMMM D, YYYY HH:mm", LLLL: "dddd, MMMM DD, YYYY HH:mm" }, calendar: { sameDay: "[Ngayon sa] LT", nextDay: "[Bukas sa] LT", nextWeek: "dddd [sa] LT", lastDay: "[Kahapon sa] LT", lastWeek: "dddd [huling linggo] LT", sameElse: "L" }, relativeTime: { future: "sa loob ng %s", past: "%s ang nakalipas", s: "ilang segundo", m: "isang minuto", mm: "%d minuto", h: "isang oras", hh: "%d oras", d: "isang araw", dd: "%d araw", M: "isang buwan", MM: "%d buwan", y: "isang taon", yy: "%d taon" }, ordinalParse: /\d{1,2}/, ordinal: function (a) { return a }, week: { dow: 1, doy: 4 } }), "pagh_waâ_chaâ_wej_loS_vagh_jav_Soch_chorgh_Hut".split("_")), Mg = (Kf.defineLocale("tlh", { months: "teraâ jar waâ_teraâ jar chaâ_teraâ jar wej_teraâ jar loS_teraâ jar vagh_teraâ jar jav_teraâ jar Soch_teraâ jar chorgh_teraâ jar Hut_teraâ jar waâmaH_teraâ jar waâmaH waâ_teraâ jar waâmaH chaâ".split("_"), monthsShort: "jar waâ_jar chaâ_jar wej_jar loS_jar vagh_jar jav_jar Soch_jar chorgh_jar Hut_jar waâmaH_jar waâmaH waâ_jar waâmaH chaâ".split("_"), weekdays: "lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"), weekdaysShort: "lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"), weekdaysMin: "lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[DaHjaj] LT", nextDay: "[waâleS] LT", nextWeek: "LLL", lastDay: "[waâHuâ] LT", lastWeek: "LLL", sameElse: "L" }, relativeTime: { future: Id, past: Jd, s: "puS lup", m: "waâ tup", mm: Kd, h: "waâ rep", hh: Kd, d: "waâ jaj", dd: Kd, M: "waâ jar", MM: Kd, y: "waâ DIS", yy: Kd }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), { 1: "'inci", 5: "'inci", 8: "'inci", 70: "'inci", 80: "'inci", 2: "'nci", 7: "'nci", 20: "'nci", 50: "'nci", 3: "'Ã¼ncÃ¼", 4: "'Ã¼ncÃ¼", 100: "'Ã¼ncÃ¼", 6: "'ncÄ±", 9: "'uncu", 10: "'uncu", 30: "'uncu", 60: "'Ä±ncÄ±", 90: "'Ä±ncÄ±" }), Ng = (Kf.defineLocale("tr", { months: "Ocak_Åubat_Mart_Nisan_MayÄ±s_Haziran_Temmuz_AÄustos_EylÃ¼l_Ekim_KasÄ±m_AralÄ±k".split("_"), monthsShort: "Oca_Åub_Mar_Nis_May_Haz_Tem_AÄu_Eyl_Eki_Kas_Ara".split("_"), weekdays: "Pazar_Pazartesi_SalÄ±_ÃarÅamba_PerÅembe_Cuma_Cumartesi".split("_"), weekdaysShort: "Paz_Pts_Sal_Ãar_Per_Cum_Cts".split("_"), weekdaysMin: "Pz_Pt_Sa_Ãa_Pe_Cu_Ct".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd, D MMMM YYYY HH:mm" }, calendar: { sameDay: "[bugÃ¼n saat] LT", nextDay: "[yarÄ±n saat] LT", nextWeek: "[haftaya] dddd [saat] LT", lastDay: "[dÃ¼n] LT", lastWeek: "[geÃ§en hafta] dddd [saat] LT", sameElse: "L" }, relativeTime: { future: "%s sonra", past: "%s Ã¶nce", s: "birkaÃ§ saniye", m: "bir dakika", mm: "%d dakika", h: "bir saat", hh: "%d saat", d: "bir gÃ¼n", dd: "%d gÃ¼n", M: "bir ay", MM: "%d ay", y: "bir yÄ±l", yy: "%d yÄ±l" }, ordinalParse: /\d{1,2}'(inci|nci|Ã¼ncÃ¼|ncÄ±|uncu|Ä±ncÄ±)/, ordinal: function (a) { if (0 === a) return a + "'Ä±ncÄ±"; var b = a % 10, c = a % 100 - b, d = a >= 100 ? 100 : null; return a + (Mg[b] || Mg[c] || Mg[d]) }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("tzl", { months: "Januar_Fevraglh_MarÃ§_AvrÃ¯u_Mai_GÃ¼n_Julia_Guscht_Setemvar_ListopÃ¤ts_Noemvar_Zecemvar".split("_"), monthsShort: "Jan_Fev_Mar_Avr_Mai_GÃ¼n_Jul_Gus_Set_Lis_Noe_Zec".split("_"), weekdays: "SÃºladi_LÃºneÃ§i_Maitzi_MÃ¡rcuri_XhÃºadi_ViÃ©nerÃ§i_SÃ¡turi".split("_"), weekdaysShort: "SÃºl_LÃºn_Mai_MÃ¡r_XhÃº_ViÃ©_SÃ¡t".split("_"), weekdaysMin: "SÃº_LÃº_Ma_MÃ¡_Xh_Vi_SÃ¡".split("_"), longDateFormat: { LT: "HH.mm", LTS: "HH.mm.ss", L: "DD.MM.YYYY", LL: "D. MMMM [dallas] YYYY", LLL: "D. MMMM [dallas] YYYY HH.mm", LLLL: "dddd, [li] D. MMMM [dallas] YYYY HH.mm" }, meridiem: function (a, b, c) { return a > 11 ? c ? "d'o" : "D'O" : c ? "d'a" : "D'A" }, calendar: { sameDay: "[oxhi Ã ] LT", nextDay: "[demÃ  Ã ] LT", nextWeek: "dddd [Ã ] LT", lastDay: "[ieiri Ã ] LT", lastWeek: "[sÃ¼r el] dddd [lasteu Ã ] LT", sameElse: "L" }, relativeTime: { future: "osprei %s", past: "ja%s", s: Md, m: Md, mm: Md, h: Md, hh: Md, d: Md, dd: Md, M: Md, MM: Md, y: Md, yy: Md }, ordinalParse: /\d{1,2}\./, ordinal: "%d.", week: { dow: 1, doy: 4 } }), Kf.defineLocale("tzm-latn", { months: "innayr_brË¤ayrË¤_marË¤sË¤_ibrir_mayyw_ywnyw_ywlywz_É£wÅ¡t_Å¡wtanbir_ktË¤wbrË¤_nwwanbir_dwjnbir".split("_"), monthsShort: "innayr_brË¤ayrË¤_marË¤sË¤_ibrir_mayyw_ywnyw_ywlywz_É£wÅ¡t_Å¡wtanbir_ktË¤wbrË¤_nwwanbir_dwjnbir".split("_"), weekdays: "asamas_aynas_asinas_akras_akwas_asimwas_asiá¸yas".split("_"), weekdaysShort: "asamas_aynas_asinas_akras_akwas_asimwas_asiá¸yas".split("_"), weekdaysMin: "asamas_aynas_asinas_akras_akwas_asimwas_asiá¸yas".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[asdkh g] LT", nextDay: "[aska g] LT", nextWeek: "dddd [g] LT", lastDay: "[assant g] LT", lastWeek: "dddd [g] LT", sameElse: "L" }, relativeTime: { future: "dadkh s yan %s", past: "yan %s", s: "imik", m: "minuá¸", mm: "%d minuá¸", h: "saÉa", hh: "%d tassaÉin", d: "ass", dd: "%d ossan", M: "ayowr", MM: "%d iyyirn", y: "asgas", yy: "%d isgasn" }, week: { dow: 6, doy: 12 } }), Kf.defineLocale("tzm", { months: "âµâµâµâ´°âµ¢âµ_â´±âµâ´°âµ¢âµ_âµâ´°âµâµ_âµâ´±âµâµâµ_âµâ´°âµ¢âµ¢âµ_âµ¢âµâµâµ¢âµ_âµ¢âµâµâµ¢âµâµ£_âµâµâµâµ_âµâµâµâ´°âµâ´±âµâµ_â´½âµâµâ´±âµ_âµâµâµ¡â´°âµâ´±âµâµ_â´·âµâµâµâ´±âµâµ".split("_"), monthsShort: "âµâµâµâ´°âµ¢âµ_â´±âµâ´°âµ¢âµ_âµâ´°âµâµ_âµâ´±âµâµâµ_âµâ´°âµ¢âµ¢âµ_âµ¢âµâµâµ¢âµ_âµ¢âµâµâµ¢âµâµ£_âµâµâµâµ_âµâµâµâ´°âµâ´±âµâµ_â´½âµâµâ´±âµ_âµâµâµ¡â´°âµâ´±âµâµ_â´·âµâµâµâ´±âµâµ".split("_"), weekdays: "â´°âµâ´°âµâ´°âµ_â´°âµ¢âµâ´°âµ_â´°âµâµâµâ´°âµ_â´°â´½âµâ´°âµ_â´°â´½âµ¡â´°âµ_â´°âµâµâµâµ¡â´°âµ_â´°âµâµâ´¹âµ¢â´°âµ".split("_"), weekdaysShort: "â´°âµâ´°âµâ´°âµ_â´°âµ¢âµâ´°âµ_â´°âµâµâµâ´°âµ_â´°â´½âµâ´°âµ_â´°â´½âµ¡â´°âµ_â´°âµâµâµâµ¡â´°âµ_â´°âµâµâ´¹âµ¢â´°âµ".split("_"), weekdaysMin: "â´°âµâ´°âµâ´°âµ_â´°âµ¢âµâ´°âµ_â´°âµâµâµâ´°âµ_â´°â´½âµâ´°âµ_â´°â´½âµ¡â´°âµ_â´°âµâµâµâµ¡â´°âµ_â´°âµâµâ´¹âµ¢â´°âµ".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "dddd D MMMM YYYY HH:mm" }, calendar: { sameDay: "[â´°âµâ´·âµ â´´] LT", nextDay: "[â´°âµâ´½â´° â´´] LT", nextWeek: "dddd [â´´] LT", lastDay: "[â´°âµâ´°âµâµ â´´] LT", lastWeek: "dddd [â´´] LT", sameElse: "L" }, relativeTime: { future: "â´·â´°â´·âµ âµ âµ¢â´°âµ %s", past: "âµ¢â´°âµ %s", s: "âµâµâµâ´½", m: "âµâµâµâµâ´º", mm: "%d âµâµâµâµâ´º", h: "âµâ´°âµâ´°", hh: "%d âµâ´°âµâµâ´°âµâµâµ", d: "â´°âµâµ", dd: "%d oâµâµâ´°âµ", M: "â´°âµ¢oâµâµ", MM: "%d âµâµ¢âµ¢âµâµâµ", y: "â´°âµâ´³â´°âµ", yy: "%d âµâµâ´³â´°âµâµ" }, week: { dow: 6, doy: 12 } }), Kf.defineLocale("uk", { months: { format: "ÑÑÑÐ½Ñ_Ð»ÑÑÐ¾Ð³Ð¾_Ð±ÐµÑÐµÐ·Ð½Ñ_ÐºÐ²ÑÑÐ½Ñ_ÑÑÐ°Ð²Ð½Ñ_ÑÐµÑÐ²Ð½Ñ_Ð»Ð¸Ð¿Ð½Ñ_ÑÐµÑÐ¿Ð½Ñ_Ð²ÐµÑÐµÑÐ½Ñ_Ð¶Ð¾Ð²ÑÐ½Ñ_Ð»Ð¸ÑÑÐ¾Ð¿Ð°Ð´Ð°_Ð³ÑÑÐ´Ð½Ñ".split("_"), standalone: "ÑÑÑÐµÐ½Ñ_Ð»ÑÑÐ¸Ð¹_Ð±ÐµÑÐµÐ·ÐµÐ½Ñ_ÐºÐ²ÑÑÐµÐ½Ñ_ÑÑÐ°Ð²ÐµÐ½Ñ_ÑÐµÑÐ²ÐµÐ½Ñ_Ð»Ð¸Ð¿ÐµÐ½Ñ_ÑÐµÑÐ¿ÐµÐ½Ñ_Ð²ÐµÑÐµÑÐµÐ½Ñ_Ð¶Ð¾Ð²ÑÐµÐ½Ñ_Ð»Ð¸ÑÑÐ¾Ð¿Ð°Ð´_Ð³ÑÑÐ´ÐµÐ½Ñ".split("_") }, monthsShort: "ÑÑÑ_Ð»ÑÑ_Ð±ÐµÑ_ÐºÐ²ÑÑ_ÑÑÐ°Ð²_ÑÐµÑÐ²_Ð»Ð¸Ð¿_ÑÐµÑÐ¿_Ð²ÐµÑ_Ð¶Ð¾Ð²Ñ_Ð»Ð¸ÑÑ_Ð³ÑÑÐ´".split("_"), weekdays: Pd, weekdaysShort: "Ð½Ð´_Ð¿Ð½_Ð²Ñ_ÑÑ_ÑÑ_Ð¿Ñ_ÑÐ±".split("_"), weekdaysMin: "Ð½Ð´_Ð¿Ð½_Ð²Ñ_ÑÑ_ÑÑ_Ð¿Ñ_ÑÐ±".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD.MM.YYYY", LL: "D MMMM YYYY Ñ.", LLL: "D MMMM YYYY Ñ., HH:mm", LLLL: "dddd, D MMMM YYYY Ñ., HH:mm" }, calendar: { sameDay: Qd("[Ð¡ÑÐ¾Ð³Ð¾Ð´Ð½Ñ "), nextDay: Qd("[ÐÐ°Ð²ÑÑÐ° "), lastDay: Qd("[ÐÑÐ¾ÑÐ° "), nextWeek: Qd("[Ð£] dddd ["), lastWeek: function () { switch (this.day()) { case 0: case 3: case 5: case 6: return Qd("[ÐÐ¸Ð½ÑÐ»Ð¾Ñ] dddd [").call(this); case 1: case 2: case 4: return Qd("[ÐÐ¸Ð½ÑÐ»Ð¾Ð³Ð¾] dddd [").call(this) } }, sameElse: "L" }, relativeTime: { future: "Ð·Ð° %s", past: "%s ÑÐ¾Ð¼Ñ", s: "Ð´ÐµÐºÑÐ»ÑÐºÐ° ÑÐµÐºÑÐ½Ð´", m: Od, mm: Od, h: "Ð³Ð¾Ð´Ð¸Ð½Ñ", hh: Od, d: "Ð´ÐµÐ½Ñ", dd: Od, M: "Ð¼ÑÑÑÑÑ", MM: Od, y: "ÑÑÐº", yy: Od }, meridiemParse: /Ð½Ð¾ÑÑ|ÑÐ°Ð½ÐºÑ|Ð´Ð½Ñ|Ð²ÐµÑÐ¾ÑÐ°/, isPM: function (a) { return /^(Ð´Ð½Ñ|Ð²ÐµÑÐ¾ÑÐ°)$/.test(a) }, meridiem: function (a, b, c) { return 4 > a ? "Ð½Ð¾ÑÑ" : 12 > a ? "ÑÐ°Ð½ÐºÑ" : 17 > a ? "Ð´Ð½Ñ" : "Ð²ÐµÑÐ¾ÑÐ°" }, ordinalParse: /\d{1,2}-(Ð¹|Ð³Ð¾)/, ordinal: function (a, b) { switch (b) { case "M": case "d": case "DDD": case "w": case "W": return a + "-Ð¹"; case "D": return a + "-Ð³Ð¾"; default: return a } }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("uz", { months: "ÑÐ½Ð²Ð°Ñ_ÑÐµÐ²ÑÐ°Ð»_Ð¼Ð°ÑÑ_Ð°Ð¿ÑÐµÐ»_Ð¼Ð°Ð¹_Ð¸ÑÐ½_Ð¸ÑÐ»_Ð°Ð²Ð³ÑÑÑ_ÑÐµÐ½ÑÑÐ±Ñ_Ð¾ÐºÑÑÐ±Ñ_Ð½Ð¾ÑÐ±Ñ_Ð´ÐµÐºÐ°Ð±Ñ".split("_"), monthsShort: "ÑÐ½Ð²_ÑÐµÐ²_Ð¼Ð°Ñ_Ð°Ð¿Ñ_Ð¼Ð°Ð¹_Ð¸ÑÐ½_Ð¸ÑÐ»_Ð°Ð²Ð³_ÑÐµÐ½_Ð¾ÐºÑ_Ð½Ð¾Ñ_Ð´ÐµÐº".split("_"), weekdays: "Ð¯ÐºÑÐ°Ð½Ð±Ð°_ÐÑÑÐ°Ð½Ð±Ð°_Ð¡ÐµÑÐ°Ð½Ð±Ð°_Ð§Ð¾ÑÑÐ°Ð½Ð±Ð°_ÐÐ°Ð¹ÑÐ°Ð½Ð±Ð°_ÐÑÐ¼Ð°_Ð¨Ð°Ð½Ð±Ð°".split("_"), weekdaysShort: "Ð¯ÐºÑ_ÐÑÑ_Ð¡ÐµÑ_Ð§Ð¾Ñ_ÐÐ°Ð¹_ÐÑÐ¼_Ð¨Ð°Ð½".split("_"), weekdaysMin: "Ð¯Ðº_ÐÑ_Ð¡Ðµ_Ð§Ð¾_ÐÐ°_ÐÑ_Ð¨Ð°".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY HH:mm", LLLL: "D MMMM YYYY, dddd HH:mm" }, calendar: { sameDay: "[ÐÑÐ³ÑÐ½ ÑÐ¾Ð°Ñ] LT [Ð´Ð°]", nextDay: "[Ð­ÑÑÐ°Ð³Ð°] LT [Ð´Ð°]", nextWeek: "dddd [ÐºÑÐ½Ð¸ ÑÐ¾Ð°Ñ] LT [Ð´Ð°]", lastDay: "[ÐÐµÑÐ° ÑÐ¾Ð°Ñ] LT [Ð´Ð°]", lastWeek: "[Ð£ÑÐ³Ð°Ð½] dddd [ÐºÑÐ½Ð¸ ÑÐ¾Ð°Ñ] LT [Ð´Ð°]", sameElse: "L" }, relativeTime: { future: "Ð¯ÐºÐ¸Ð½ %s Ð¸ÑÐ¸Ð´Ð°", past: "ÐÐ¸Ñ Ð½ÐµÑÐ° %s Ð¾Ð»Ð´Ð¸Ð½", s: "ÑÑÑÑÐ°Ñ", m: "Ð±Ð¸Ñ Ð´Ð°ÐºÐ¸ÐºÐ°", mm: "%d Ð´Ð°ÐºÐ¸ÐºÐ°", h: "Ð±Ð¸Ñ ÑÐ¾Ð°Ñ", hh: "%d ÑÐ¾Ð°Ñ", d: "Ð±Ð¸Ñ ÐºÑÐ½", dd: "%d ÐºÑÐ½", M: "Ð±Ð¸Ñ Ð¾Ð¹", MM: "%d Ð¾Ð¹", y: "Ð±Ð¸Ñ Ð¹Ð¸Ð»", yy: "%d Ð¹Ð¸Ð»" }, week: { dow: 1, doy: 7 } }), Kf.defineLocale("vi", { months: "thÃ¡ng 1_thÃ¡ng 2_thÃ¡ng 3_thÃ¡ng 4_thÃ¡ng 5_thÃ¡ng 6_thÃ¡ng 7_thÃ¡ng 8_thÃ¡ng 9_thÃ¡ng 10_thÃ¡ng 11_thÃ¡ng 12".split("_"), monthsShort: "Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"), weekdays: "chá»§ nháº­t_thá»© hai_thá»© ba_thá»© tÆ°_thá»© nÄm_thá»© sÃ¡u_thá»© báº£y".split("_"), weekdaysShort: "CN_T2_T3_T4_T5_T6_T7".split("_"), weekdaysMin: "CN_T2_T3_T4_T5_T6_T7".split("_"), longDateFormat: { LT: "HH:mm", LTS: "HH:mm:ss", L: "DD/MM/YYYY", LL: "D MMMM [nÄm] YYYY", LLL: "D MMMM [nÄm] YYYY HH:mm", LLLL: "dddd, D MMMM [nÄm] YYYY HH:mm", l: "DD/M/YYYY", ll: "D MMM YYYY", lll: "D MMM YYYY HH:mm", llll: "ddd, D MMM YYYY HH:mm" }, calendar: { sameDay: "[HÃ´m nay lÃºc] LT", nextDay: "[NgÃ y mai lÃºc] LT", nextWeek: "dddd [tuáº§n tá»i lÃºc] LT", lastDay: "[HÃ´m qua lÃºc] LT", lastWeek: "dddd [tuáº§n rá»i lÃºc] LT", sameElse: "L" }, relativeTime: { future: "%s tá»i", past: "%s trÆ°á»c", s: "vÃ i giÃ¢y", m: "má»t phÃºt", mm: "%d phÃºt", h: "má»t giá»", hh: "%d giá»", d: "má»t ngÃ y", dd: "%d ngÃ y", M: "má»t thÃ¡ng", MM: "%d thÃ¡ng", y: "má»t nÄm", yy: "%d nÄm" }, ordinalParse: /\d{1,2}/, ordinal: function (a) { return a }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("zh-cn", { months: "ä¸æ_äºæ_ä¸æ_åæ_äºæ_å­æ_ä¸æ_å«æ_ä¹æ_åæ_åä¸æ_åäºæ".split("_"), monthsShort: "1æ_2æ_3æ_4æ_5æ_6æ_7æ_8æ_9æ_10æ_11æ_12æ".split("_"), weekdays: "æææ¥_ææä¸_ææäº_ææä¸_ææå_ææäº_ææå­".split("_"), weekdaysShort: "å¨æ¥_å¨ä¸_å¨äº_å¨ä¸_å¨å_å¨äº_å¨å­".split("_"), weekdaysMin: "æ¥_ä¸_äº_ä¸_å_äº_å­".split("_"), longDateFormat: { LT: "Ahç¹mmå", LTS: "Ahç¹måsç§", L: "YYYY-MM-DD", LL: "YYYYå¹´MMMDæ¥", LLL: "YYYYå¹´MMMDæ¥Ahç¹mmå", LLLL: "YYYYå¹´MMMDæ¥ddddAhç¹mmå", l: "YYYY-MM-DD", ll: "YYYYå¹´MMMDæ¥", lll: "YYYYå¹´MMMDæ¥Ahç¹mmå", llll: "YYYYå¹´MMMDæ¥ddddAhç¹mmå" }, meridiemParse: /åæ¨|æ©ä¸|ä¸å|ä¸­å|ä¸å|æä¸/, meridiemHour: function (a, b) { return 12 === a && (a = 0), "åæ¨" === b || "æ©ä¸" === b || "ä¸å" === b ? a : "ä¸å" === b || "æä¸" === b ? a + 12 : a >= 11 ? a : a + 12 }, meridiem: function (a, b, c) { var d = 100 * a + b; return 600 > d ? "åæ¨" : 900 > d ? "æ©ä¸" : 1130 > d ? "ä¸å" : 1230 > d ? "ä¸­å" : 1800 > d ? "ä¸å" : "æä¸" }, calendar: { sameDay: function () { return 0 === this.minutes() ? "[ä»å¤©]Ah[ç¹æ´]" : "[ä»å¤©]LT" }, nextDay: function () { return 0 === this.minutes() ? "[æå¤©]Ah[ç¹æ´]" : "[æå¤©]LT" }, lastDay: function () { return 0 === this.minutes() ? "[æ¨å¤©]Ah[ç¹æ´]" : "[æ¨å¤©]LT" }, nextWeek: function () { var a, b; return a = Kf().startOf("week"), b = this.unix() - a.unix() >= 604800 ? "[ä¸]" : "[æ¬]", 0 === this.minutes() ? b + "dddAhç¹æ´" : b + "dddAhç¹mm" }, lastWeek: function () { var a, b; return a = Kf().startOf("week"), b = this.unix() < a.unix() ? "[ä¸]" : "[æ¬]", 0 === this.minutes() ? b + "dddAhç¹æ´" : b + "dddAhç¹mm" }, sameElse: "LL" }, ordinalParse: /\d{1,2}(æ¥|æ|å¨)/, ordinal: function (a, b) { switch (b) { case "d": case "D": case "DDD": return a + "æ¥"; case "M": return a + "æ"; case "w": case "W": return a + "å¨"; default: return a } }, relativeTime: { future: "%så", past: "%så", s: "å ç§", m: "1 åé", mm: "%d åé", h: "1 å°æ¶", hh: "%d å°æ¶", d: "1 å¤©", dd: "%d å¤©", M: "1 ä¸ªæ", MM: "%d ä¸ªæ", y: "1 å¹´", yy: "%d å¹´" }, week: { dow: 1, doy: 4 } }), Kf.defineLocale("zh-tw", { months: "ä¸æ_äºæ_ä¸æ_åæ_äºæ_å­æ_ä¸æ_å«æ_ä¹æ_åæ_åä¸æ_åäºæ".split("_"), monthsShort: "1æ_2æ_3æ_4æ_5æ_6æ_7æ_8æ_9æ_10æ_11æ_12æ".split("_"), weekdays: "æææ¥_ææä¸_ææäº_ææä¸_ææå_ææäº_ææå­".split("_"), weekdaysShort: "é±æ¥_é±ä¸_é±äº_é±ä¸_é±å_é±äº_é±å­".split("_"), weekdaysMin: "æ¥_ä¸_äº_ä¸_å_äº_å­".split("_"), longDateFormat: { LT: "Ahé»mmå", LTS: "Ahé»måsç§", L: "YYYYå¹´MMMDæ¥", LL: "YYYYå¹´MMMDæ¥", LLL: "YYYYå¹´MMMDæ¥Ahé»mmå", LLLL: "YYYYå¹´MMMDæ¥ddddAhé»mmå", l: "YYYYå¹´MMMDæ¥", ll: "YYYYå¹´MMMDæ¥", lll: "YYYYå¹´MMMDæ¥Ahé»mmå", llll: "YYYYå¹´MMMDæ¥ddddAhé»mmå" }, meridiemParse: /æ©ä¸|ä¸å|ä¸­å|ä¸å|æä¸/, meridiemHour: function (a, b) { return 12 === a && (a = 0), "æ©ä¸" === b || "ä¸å" === b ? a : "ä¸­å" === b ? a >= 11 ? a : a + 12 : "ä¸å" === b || "æä¸" === b ? a + 12 : void 0 }, meridiem: function (a, b, c) { var d = 100 * a + b; return 900 > d ? "æ©ä¸" : 1130 > d ? "ä¸å" : 1230 > d ? "ä¸­å" : 1800 > d ? "ä¸å" : "æä¸" }, calendar: { sameDay: "[ä»å¤©]LT", nextDay: "[æå¤©]LT", nextWeek: "[ä¸]ddddLT", lastDay: "[æ¨å¤©]LT", lastWeek: "[ä¸]ddddLT", sameElse: "L" }, ordinalParse: /\d{1,2}(æ¥|æ|é±)/, ordinal: function (a, b) { switch (b) { case "d": case "D": case "DDD": return a + "æ¥"; case "M": return a + "æ"; case "w": case "W": return a + "é±"; default: return a } }, relativeTime: { future: "%så§", past: "%så", s: "å¹¾ç§", m: "ä¸åé", mm: "%dåé", h: "ä¸å°æ", hh: "%då°æ", d: "ä¸å¤©", dd: "%då¤©", M: "ä¸åæ", MM: "%dåæ", y: "ä¸å¹´", yy: "%då¹´" } }), Kf); return Ng.locale("en"), Ng
});

/**
* @version: 2.1.17
* @author: Dan Grossman http://www.dangrossman.info/
* @copyright: Copyright (c) 2012-2015 Dan Grossman. All rights reserved.
* @license: Licensed under the MIT license. See http://www.opensource.org/licenses/mit-license.php
* @website: https://www.improvely.com/
*/

(function(root, factory) {

  if (typeof define === 'function' && define.amd) {
    define(['moment', 'jquery', 'exports'], function(momentjs, $, exports) {
      root.daterangepicker = factory(root, exports, momentjs, $);
    });

  } else if (typeof exports !== 'undefined') {
      var momentjs = require('moment');
      var jQuery = (typeof window != 'undefined') ? window.jQuery : undefined;  //isomorphic issue
      if (!jQuery) {
          try {
              jQuery = require('jquery');
              if (!jQuery.fn) jQuery.fn = {}; //isomorphic issue
          } catch (err) {
              if (!jQuery) throw new Error('jQuery dependency not found');
          }
      }

    factory(root, exports, momentjs, jQuery);

  // Finally, as a browser global.
  } else {
    root.daterangepicker = factory(root, {}, root.moment || moment, (root.jQuery || root.Zepto || root.ender || root.$));
  }

}(this || {}, function(root, daterangepicker, moment, $) { // 'this' doesn't exist on a server

    var DateRangePicker = function(element, options, cb) {

        //default settings for options
        this.parentEl = 'body';
        this.element = $(element);
        this.startDate = moment.utc().startOf('day');
        this.endDate = moment.utc().endOf('day');
        this.minDate = false;
        this.maxDate = false;
        this.dateLimit = false;
        this.autoApply = false;
        this.singleDatePicker = false;
        this.showDropdowns = false;
        this.showWeekNumbers = false;
        this.timePicker = false;
        this.timePicker24Hour = false;
        this.timePickerIncrement = 1;
        this.timePickerSeconds = false;
        this.linkedCalendars = true;
        this.autoUpdateInput = true;
        this.ranges = {};

        this.opens = 'right';
        if (this.element.hasClass('pull-right'))
            this.opens = 'left';

        this.drops = 'down';
        if (this.element.hasClass('dropup'))
            this.drops = 'up';

        this.buttonClasses = 'btn btn-sm';
        this.applyClass = 'btn-success';
        this.cancelClass = 'btn-default';

        this.locale = {
            format: 'MM/DD/YYYY',
            separator: ' - ',
            applyLabel: 'Apply',
            cancelLabel: 'Cancel',
            weekLabel: 'W',
            customRangeLabel: 'Custom Range',
            daysOfWeek: moment.weekdaysMin(),
            monthNames: moment.monthsShort(),
            firstDay: moment.localeData().firstDayOfWeek()
        };

        this.callback = function() { };

        //some state information
        this.isShowing = false;
        this.leftCalendar = {};
        this.rightCalendar = {};

        //custom options from user
        if (typeof options !== 'object' || options === null)
            options = {};

        //allow setting options with data attributes
        //data-api options will be overwritten with custom javascript options
        options = $.extend(this.element.data(), options);

        //html template for the picker UI
        if (typeof options.template !== 'string')
            options.template = '<div class="daterangepicker dropdown-menu">' +
                '<div class="calendar left">' +
                    '<div class="daterangepicker_input">' +
                      '<input class="input-mini" type="text" name="daterangepicker_start" value="" />' +
                      '<i class="fa fa-calendar glyphicon glyphicon-calendar"></i>' +
                      '<div class="calendar-time">' +
                        '<div></div>' +
                        '<i class="fa fa-clock-o glyphicon glyphicon-time"></i>' +
                      '</div>' +
                    '</div>' +
                    '<div class="calendar-table"></div>' +
                '</div>' +
                '<div class="calendar right">' +
                    '<div class="daterangepicker_input">' +
                      '<input class="input-mini" type="text" name="daterangepicker_end" value="" />' +
                      '<i class="fa fa-calendar glyphicon glyphicon-calendar"></i>' +
                      '<div class="calendar-time">' +
                        '<div></div>' +
                        '<i class="fa fa-clock-o glyphicon glyphicon-time"></i>' +
                      '</div>' +
                    '</div>' +
                    '<div class="calendar-table"></div>' +
                '</div>' +
                '<div class="ranges">' +
                    '<div class="range_inputs">' +
                        '<button class="applyBtn" disabled="disabled" type="button"></button> ' +
                        '<button class="cancelBtn" type="button"></button>' +
                    '</div>' +
                '</div>' +
            '</div>';

        this.parentEl = (options.parentEl && $(options.parentEl).length) ? $(options.parentEl) : $(this.parentEl);
        this.container = $(options.template).appendTo(this.parentEl);

        //
        // handle all the possible options overriding defaults
        //

        if (typeof options.locale === 'object') {

            if (typeof options.locale.format === 'string')
                this.locale.format = options.locale.format;

            if (typeof options.locale.separator === 'string')
                this.locale.separator = options.locale.separator;

            if (typeof options.locale.daysOfWeek === 'object')
                this.locale.daysOfWeek = options.locale.daysOfWeek.slice();

            if (typeof options.locale.monthNames === 'object')
              this.locale.monthNames = options.locale.monthNames.slice();

            if (typeof options.locale.firstDay === 'number')
              this.locale.firstDay = options.locale.firstDay;

            if (typeof options.locale.applyLabel === 'string')
              this.locale.applyLabel = options.locale.applyLabel;

            if (typeof options.locale.cancelLabel === 'string')
              this.locale.cancelLabel = options.locale.cancelLabel;

            if (typeof options.locale.weekLabel === 'string')
              this.locale.weekLabel = options.locale.weekLabel;

            if (typeof options.locale.customRangeLabel === 'string')
              this.locale.customRangeLabel = options.locale.customRangeLabel;

        }

        if (typeof options.startDate === 'string')
            this.startDate = moment.utc(options.startDate, this.locale.format);

        if (typeof options.endDate === 'string')
            this.endDate = moment.utc(options.endDate, this.locale.format);

        if (typeof options.minDate === 'string')
            this.minDate = moment.utc(options.minDate, this.locale.format);

        if (typeof options.maxDate === 'string')
            this.maxDate = moment.utc(options.maxDate, this.locale.format);

        if (typeof options.startDate === 'object')
            this.startDate = moment.utc(options.startDate);

        if (typeof options.endDate === 'object')
            this.endDate = moment.utc(options.endDate);

        if (typeof options.minDate === 'object')
            this.minDate = moment.utc(options.minDate);

        if (typeof options.maxDate === 'object')
            this.maxDate = moment.utc(options.maxDate);

        // sanity check for bad options
        if (this.minDate && this.startDate.isBefore(this.minDate))
            this.startDate = this.minDate.clone();

        // sanity check for bad options
        if (this.maxDate && this.endDate.isAfter(this.maxDate))
            this.endDate = this.maxDate.clone();

        if (typeof options.applyClass === 'string')
            this.applyClass = options.applyClass;

        if (typeof options.cancelClass === 'string')
            this.cancelClass = options.cancelClass;

        if (typeof options.dateLimit === 'object')
            this.dateLimit = options.dateLimit;

        if (typeof options.opens === 'string')
            this.opens = options.opens;

        if (typeof options.drops === 'string')
            this.drops = options.drops;

        if (typeof options.showWeekNumbers === 'boolean')
            this.showWeekNumbers = options.showWeekNumbers;

        if (typeof options.buttonClasses === 'string')
            this.buttonClasses = options.buttonClasses;

        if (typeof options.buttonClasses === 'object')
            this.buttonClasses = options.buttonClasses.join(' ');

        if (typeof options.showDropdowns === 'boolean')
            this.showDropdowns = options.showDropdowns;

        if (typeof options.singleDatePicker === 'boolean') {
            this.singleDatePicker = options.singleDatePicker;
            if (this.singleDatePicker)
                this.endDate = this.startDate.clone();
        }

        if (typeof options.timePicker === 'boolean')
            this.timePicker = options.timePicker;

        if (typeof options.timePickerSeconds === 'boolean')
            this.timePickerSeconds = options.timePickerSeconds;

        if (typeof options.timePickerIncrement === 'number')
            this.timePickerIncrement = options.timePickerIncrement;

        if (typeof options.timePicker24Hour === 'boolean')
            this.timePicker24Hour = options.timePicker24Hour;

        if (typeof options.autoApply === 'boolean')
            this.autoApply = options.autoApply;

        if (typeof options.autoUpdateInput === 'boolean')
            this.autoUpdateInput = options.autoUpdateInput;

        if (typeof options.linkedCalendars === 'boolean')
            this.linkedCalendars = options.linkedCalendars;

        if (typeof options.isInvalidDate === 'function')
            this.isInvalidDate = options.isInvalidDate;

        // update day names order to firstDay
        if (this.locale.firstDay != 0) {
            var iterator = this.locale.firstDay;
            while (iterator > 0) {
                this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift());
                iterator--;
            }
        }

        var start, end, range;

        //if no start/end dates set, check if an input element contains initial values
        if (typeof options.startDate === 'undefined' && typeof options.endDate === 'undefined') {
            if ($(this.element).is('input[type=text]')) {
                var val = $(this.element).val(),
                    split = val.split(this.locale.separator);

                start = end = null;

                if (split.length == 2) {
                    start = moment.utc(split[0], this.locale.format);
                    end = moment.utc(split[1], this.locale.format);
                } else if (this.singleDatePicker && val !== "") {
                    start = moment.utc(val, this.locale.format);
                    end = moment.utc(val, this.locale.format);
                }
                if (start !== null && end !== null) {
                    this.setStartDate(start);
                    this.setEndDate(end);
                }
            }
        }

        if (typeof options.ranges === 'object') {
            for (range in options.ranges) {

                if (typeof options.ranges[range][0] === 'string')
                    start = moment.utc(options.ranges[range][0], this.locale.format);
                else
                    start = moment.utc(options.ranges[range][0]);

                if (typeof options.ranges[range][1] === 'string')
                    end = moment.utc(options.ranges[range][1], this.locale.format);
                else
                    end = moment.utc(options.ranges[range][1]);

                // If the start or end date exceed those allowed by the minDate or dateLimit
                // options, shorten the range to the allowable period.
                if (this.minDate && start.isBefore(this.minDate))
                    start = this.minDate.clone();

                var maxDate = this.maxDate;
                if (this.dateLimit && start.clone().add(this.dateLimit).isAfter(maxDate))
                    maxDate = start.clone().add(this.dateLimit);
                if (maxDate && end.isAfter(maxDate))
                    end = maxDate.clone();

                // If the end of the range is before the minimum or the start of the range is
                // after the maximum, don't display this range option at all.
                if ((this.minDate && end.isBefore(this.minDate)) || (maxDate && start.isAfter(maxDate)))
                    continue;
                
                //Support unicode chars in the range names.
                var elem = document.createElement('textarea');
                elem.innerHTML = range;
                var rangeHtml = elem.value;

                this.ranges[rangeHtml] = [start, end];
            }

            var list = '<ul>';
            for (range in this.ranges) {
                list += '<li>' + range + '</li>';
            }
            list += '<li>' + this.locale.customRangeLabel + '</li>';
            list += '</ul>';
            this.container.find('.ranges').prepend(list);
        }

        if (typeof cb === 'function') {
            this.callback = cb;
        }

        if (!this.timePicker) {
            this.startDate = this.startDate.startOf('day');
            this.endDate = this.endDate.endOf('day');
            this.container.find('.calendar-time').hide();
        }

        //can't be used together for now
        if (this.timePicker && this.autoApply)
            this.autoApply = false;

        if (this.autoApply && typeof options.ranges !== 'object') {
            this.container.find('.ranges').hide();
        } else if (this.autoApply) {
            this.container.find('.applyBtn, .cancelBtn').addClass('hide');
        }

        if (this.singleDatePicker) {
            this.container.addClass('single');
            this.container.find('.calendar.left').addClass('single');
            this.container.find('.calendar.left').show();
            this.container.find('.calendar.right').hide();
            this.container.find('.daterangepicker_input input, .daterangepicker_input i').hide();
            if (!this.timePicker) {
                this.container.find('.ranges').hide();
            }
        }

        if (typeof options.ranges === 'undefined' && !this.singleDatePicker) {
            this.container.addClass('show-calendar');
        }

        this.container.addClass('opens' + this.opens);

        //swap the position of the predefined ranges if opens right
        if (typeof options.ranges !== 'undefined' && this.opens == 'right') {
            var ranges = this.container.find('.ranges');
            var html = ranges.clone();
            ranges.remove();
            this.container.find('.calendar.left').parent().prepend(html);
        }

        //apply CSS classes and labels to buttons
        this.container.find('.applyBtn, .cancelBtn').addClass(this.buttonClasses);
        if (this.applyClass.length)
            this.container.find('.applyBtn').addClass(this.applyClass);
        if (this.cancelClass.length)
            this.container.find('.cancelBtn').addClass(this.cancelClass);
        this.container.find('.applyBtn').html(this.locale.applyLabel);
        this.container.find('.cancelBtn').html(this.locale.cancelLabel);

        //
        // event listeners
        //

        this.container.find('.calendar')
            .on('click.daterangepicker', '.prev', $.proxy(this.clickPrev, this))
            .on('click.daterangepicker', '.next', $.proxy(this.clickNext, this))
            .on('click.daterangepicker', 'td.available', $.proxy(this.clickDate, this))
            .on('mouseenter.daterangepicker', 'td.available', $.proxy(this.hoverDate, this))
            .on('mouseleave.daterangepicker', 'td.available', $.proxy(this.updateFormInputs, this))
            .on('change.daterangepicker', 'select.yearselect', $.proxy(this.monthOrYearChanged, this))
            .on('change.daterangepicker', 'select.monthselect', $.proxy(this.monthOrYearChanged, this))
            .on('change.daterangepicker', 'select.hourselect,select.minuteselect,select.secondselect,select.ampmselect', $.proxy(this.timeChanged, this))
            .on('click.daterangepicker', '.daterangepicker_input input', $.proxy(this.showCalendars, this))
            //.on('keyup.daterangepicker', '.daterangepicker_input input', $.proxy(this.formInputsChanged, this))
            .on('change.daterangepicker', '.daterangepicker_input input', $.proxy(this.formInputsChanged, this));

        this.container.find('.ranges')
            .on('click.daterangepicker', 'button.applyBtn', $.proxy(this.clickApply, this))
            .on('click.daterangepicker', 'button.cancelBtn', $.proxy(this.clickCancel, this))
            .on('click.daterangepicker', 'li', $.proxy(this.clickRange, this))
            .on('mouseenter.daterangepicker', 'li', $.proxy(this.hoverRange, this))
            .on('mouseleave.daterangepicker', 'li', $.proxy(this.updateFormInputs, this));

        if (this.element.is('input')) {
            this.element.on({
                'click.daterangepicker': $.proxy(this.show, this),
                'focus.daterangepicker': $.proxy(this.show, this),
                'keyup.daterangepicker': $.proxy(this.elementChanged, this),
                'keydown.daterangepicker': $.proxy(this.keydown, this)
            });
        } else {
            this.element.on('click.daterangepicker', $.proxy(this.toggle, this));
        }

        //
        // if attached to a text input, set the initial value
        //

        if (this.element.is('input') && !this.singleDatePicker && this.autoUpdateInput) {
            this.element.val(this.startDate.format(this.locale.format) + this.locale.separator + this.endDate.format(this.locale.format));
            this.element.trigger('change');
        } else if (this.element.is('input') && this.autoUpdateInput) {
            this.element.val(this.startDate.format(this.locale.format));
            this.element.trigger('change');
        }

    };

    DateRangePicker.prototype = {

        constructor: DateRangePicker,

        setStartDate: function(startDate) {
            if (typeof startDate === 'string')
                this.startDate = moment.utc(startDate, this.locale.format);

            if (typeof startDate === 'object')
                this.startDate = moment.utc(startDate);

            if (!this.timePicker)
                this.startDate = this.startDate.startOf('day');

            if (this.timePicker && this.timePickerIncrement)
                this.startDate.minute(Math.round(this.startDate.minute() / this.timePickerIncrement) * this.timePickerIncrement);

            if (this.minDate && this.startDate.isBefore(this.minDate))
                this.startDate = this.minDate;

            if (this.maxDate && this.startDate.isAfter(this.maxDate))
                this.startDate = this.maxDate;

            if (!this.isShowing)
                this.updateElement();

            this.updateMonthsInView();
        },

        setEndDate: function(endDate) {
            if (typeof endDate === 'string')
                this.endDate = moment.utc(endDate, this.locale.format);

            if (typeof endDate === 'object')
                this.endDate = moment.utc(endDate);

            if (!this.timePicker)
                this.endDate = this.endDate.endOf('day');

            if (this.timePicker && this.timePickerIncrement)
                this.endDate.minute(Math.round(this.endDate.minute() / this.timePickerIncrement) * this.timePickerIncrement);

            if (this.endDate.isBefore(this.startDate))
                this.endDate = this.startDate.clone();

            if (this.maxDate && this.endDate.isAfter(this.maxDate))
                this.endDate = this.maxDate;

            if (this.dateLimit && this.startDate.clone().add(this.dateLimit).isBefore(this.endDate))
                this.endDate = this.startDate.clone().add(this.dateLimit);

            this.previousRightTime = this.endDate.clone();

            if (!this.isShowing)
                this.updateElement();

            this.updateMonthsInView();
        },

        isInvalidDate: function() {
            return false;
        },

        updateView: function() {
            if (this.timePicker) {
                this.renderTimePicker('left');
                this.renderTimePicker('right');
                if (!this.endDate) {
                    this.container.find('.right .calendar-time select').attr('disabled', 'disabled').addClass('disabled');
                } else {
                    this.container.find('.right .calendar-time select').removeAttr('disabled').removeClass('disabled');
                }
            }
            if (this.endDate) {
                this.container.find('input[name="daterangepicker_end"]').removeClass('active');
                this.container.find('input[name="daterangepicker_start"]').addClass('active');
            } else {
                this.container.find('input[name="daterangepicker_end"]').addClass('active');
                this.container.find('input[name="daterangepicker_start"]').removeClass('active');
            }
            this.updateMonthsInView();
            this.updateCalendars();
            this.updateFormInputs();
        },

        updateMonthsInView: function() {
            if (this.endDate) {

                //if both dates are visible already, do nothing
                if (!this.singleDatePicker && this.leftCalendar.month && this.rightCalendar.month &&
                    (this.startDate.format('YYYY-MM') == this.leftCalendar.month.format('YYYY-MM') || this.startDate.format('YYYY-MM') == this.rightCalendar.month.format('YYYY-MM'))
                    &&
                    (this.endDate.format('YYYY-MM') == this.leftCalendar.month.format('YYYY-MM') || this.endDate.format('YYYY-MM') == this.rightCalendar.month.format('YYYY-MM'))
                    ) {
                    return;
                }

                this.leftCalendar.month = this.startDate.clone().date(2);
                if (!this.linkedCalendars && (this.endDate.month() != this.startDate.month() || this.endDate.year() != this.startDate.year())) {
                    this.rightCalendar.month = this.endDate.clone().date(2);
                } else {
                    this.rightCalendar.month = this.startDate.clone().date(2).add(1, 'month');
                }
                
            } else {
                if (this.leftCalendar.month.format('YYYY-MM') != this.startDate.format('YYYY-MM') && this.rightCalendar.month.format('YYYY-MM') != this.startDate.format('YYYY-MM')) {
                    this.leftCalendar.month = this.startDate.clone().date(2);
                    this.rightCalendar.month = this.startDate.clone().date(2).add(1, 'month');
                }
            }
        },

        updateCalendars: function() {

            if (this.timePicker) {
                var hour, minute, second;
                if (this.endDate) {
                    hour = parseInt(this.container.find('.left .hourselect').val(), 10);
                    minute = parseInt(this.container.find('.left .minuteselect').val(), 10);
                    second = this.timePickerSeconds ? parseInt(this.container.find('.left .secondselect').val(), 10) : 0;
                    if (!this.timePicker24Hour) {
                        var ampm = this.container.find('.left .ampmselect').val();
                        if (ampm === 'PM' && hour < 12)
                            hour += 12;
                        if (ampm === 'AM' && hour === 12)
                            hour = 0;
                    }
                } else {
                    hour = parseInt(this.container.find('.right .hourselect').val(), 10);
                    minute = parseInt(this.container.find('.right .minuteselect').val(), 10);
                    second = this.timePickerSeconds ? parseInt(this.container.find('.right .secondselect').val(), 10) : 0;
                    if (!this.timePicker24Hour) {
                        var ampm = this.container.find('.right .ampmselect').val();
                        if (ampm === 'PM' && hour < 12)
                            hour += 12;
                        if (ampm === 'AM' && hour === 12)
                            hour = 0;
                    }
                }
                this.leftCalendar.month.hour(hour).minute(minute).second(second);
                this.rightCalendar.month.hour(hour).minute(minute).second(second);
            }

            this.renderCalendar('left');
            this.renderCalendar('right');

            //highlight any predefined range matching the current start and end dates
            this.container.find('.ranges li').removeClass('active');
            if (this.endDate == null) return;

            var customRange = true;
            var i = 0;
            for (var range in this.ranges) {
                if (this.timePicker) {
                    if (this.startDate.isSame(this.ranges[range][0]) && this.endDate.isSame(this.ranges[range][1])) {
                        customRange = false;
                        this.chosenLabel = this.container.find('.ranges li:eq(' + i + ')').addClass('active').html();
                        break;
                    }
                } else {
                    //ignore times when comparing dates if time picker is not enabled
                    if (this.startDate.format('YYYY-MM-DD') == this.ranges[range][0].format('YYYY-MM-DD') && this.endDate.format('YYYY-MM-DD') == this.ranges[range][1].format('YYYY-MM-DD')) {
                        customRange = false;
                        this.chosenLabel = this.container.find('.ranges li:eq(' + i + ')').addClass('active').html();
                        break;
                    }
                }
                i++;
            }
            if (customRange) {
                this.chosenLabel = this.container.find('.ranges li:last').addClass('active').html();
                this.showCalendars();
            }

        },

        renderCalendar: function(side) {

            //
            // Build the matrix of dates that will populate the calendar
            //

            var calendar = side == 'left' ? this.leftCalendar : this.rightCalendar;
            var month = calendar.month.month();
            var year = calendar.month.year();
            var hour = calendar.month.hour();
            var minute = calendar.month.minute();
            var second = calendar.month.second();
            var daysInMonth = moment.utc([year, month]).daysInMonth();
            var firstDay = moment.utc([year, month, 1]);
            var lastDay = moment.utc([year, month, daysInMonth]);
            var lastMonth = moment.utc(firstDay).subtract(1, 'month').month();
            var lastYear = moment.utc(firstDay).subtract(1, 'month').year();
            var daysInLastMonth = moment.utc([lastYear, lastMonth]).daysInMonth();
            var dayOfWeek = firstDay.day();

            //initialize a 6 rows x 7 columns array for the calendar
            var calendar = [];
            calendar.firstDay = firstDay;
            calendar.lastDay = lastDay;

            for (var i = 0; i < 6; i++) {
                calendar[i] = [];
            }

            //populate the calendar with date objects
            var startDay = daysInLastMonth - dayOfWeek + this.locale.firstDay + 1;
            if (startDay > daysInLastMonth)
                startDay -= 7;

            if (dayOfWeek == this.locale.firstDay)
                startDay = daysInLastMonth - 6;

            var curDate = moment.utc([lastYear, lastMonth, startDay, 12, minute, second]);

            var col, row;
            for (var i = 0, col = 0, row = 0; i < 42; i++, col++, curDate = moment.utc(curDate).add(24, 'hour')) {
                if (i > 0 && col % 7 === 0) {
                    col = 0;
                    row++;
                }
                calendar[row][col] = curDate.clone().hour(hour).minute(minute).second(second);
                curDate.hour(12);

                if (this.minDate && calendar[row][col].format('YYYY-MM-DD') == this.minDate.format('YYYY-MM-DD') && calendar[row][col].isBefore(this.minDate) && side == 'left') {
                    calendar[row][col] = this.minDate.clone();
                }

                if (this.maxDate && calendar[row][col].format('YYYY-MM-DD') == this.maxDate.format('YYYY-MM-DD') && calendar[row][col].isAfter(this.maxDate) && side == 'right') {
                    calendar[row][col] = this.maxDate.clone();
                }

            }

            //make the calendar object available to hoverDate/clickDate
            if (side == 'left') {
                this.leftCalendar.calendar = calendar;
            } else {
                this.rightCalendar.calendar = calendar;
            }

            //
            // Display the calendar
            //

            var minDate = side == 'left' ? this.minDate : this.startDate;
            var maxDate = this.maxDate;
            var selected = side == 'left' ? this.startDate : this.endDate;

            var html = '<table class="table-condensed">';
            html += '<thead>';
            html += '<tr>';

            // add empty cell for week number
            if (this.showWeekNumbers)
                html += '<th></th>';

            if ((!minDate || minDate.isBefore(calendar.firstDay)) && (!this.linkedCalendars || side == 'left')) {
                html += '<th class="prev available"><i class="fa fa-chevron-left glyphicon glyphicon-chevron-left"></i></th>';
            } else {
                html += '<th></th>';
            }

            var dateHtml = this.locale.monthNames[calendar[1][1].month()] + calendar[1][1].format(" YYYY");

            if (this.showDropdowns) {
                var currentMonth = calendar[1][1].month();
                var currentYear = calendar[1][1].year();
                var maxYear = (maxDate && maxDate.year()) || (currentYear + 5);
                var minYear = (minDate && minDate.year()) || (currentYear - 50);
                var inMinYear = currentYear == minYear;
                var inMaxYear = currentYear == maxYear;

                var monthHtml = '<select class="monthselect">';
                for (var m = 0; m < 12; m++) {
                    if ((!inMinYear || m >= minDate.month()) && (!inMaxYear || m <= maxDate.month())) {
                        monthHtml += "<option value='" + m + "'" +
                            (m === currentMonth ? " selected='selected'" : "") +
                            ">" + this.locale.monthNames[m] + "</option>";
                    } else {
                        monthHtml += "<option value='" + m + "'" +
                            (m === currentMonth ? " selected='selected'" : "") +
                            " disabled='disabled'>" + this.locale.monthNames[m] + "</option>";
                    }
                }
                monthHtml += "</select>";

                var yearHtml = '<select class="yearselect">';
                for (var y = minYear; y <= maxYear; y++) {
                    yearHtml += '<option value="' + y + '"' +
                        (y === currentYear ? ' selected="selected"' : '') +
                        '>' + y + '</option>';
                }
                yearHtml += '</select>';

                dateHtml = monthHtml + yearHtml;
            }

            html += '<th colspan="5" class="month">' + dateHtml + '</th>';
            if ((!maxDate || maxDate.isAfter(calendar.lastDay)) && (!this.linkedCalendars || side == 'right' || this.singleDatePicker)) {
                html += '<th class="next available"><i class="fa fa-chevron-right glyphicon glyphicon-chevron-right"></i></th>';
            } else {
                html += '<th></th>';
            }

            html += '</tr>';
            html += '<tr>';

            // add week number label
            if (this.showWeekNumbers)
                html += '<th class="week">' + this.locale.weekLabel + '</th>';

            $.each(this.locale.daysOfWeek, function(index, dayOfWeek) {
                html += '<th>' + dayOfWeek + '</th>';
            });

            html += '</tr>';
            html += '</thead>';
            html += '<tbody>';

            //adjust maxDate to reflect the dateLimit setting in order to
            //grey out end dates beyond the dateLimit
            if (this.endDate == null && this.dateLimit) {
                var maxLimit = this.startDate.clone().add(this.dateLimit).endOf('day');
                if (!maxDate || maxLimit.isBefore(maxDate)) {
                    maxDate = maxLimit;
                }
            }

            for (var row = 0; row < 6; row++) {
                html += '<tr>';

                // add week number
                if (this.showWeekNumbers)
                    html += '<td class="week">' + calendar[row][0].week() + '</td>';

                for (var col = 0; col < 7; col++) {

                    var classes = [];

                    //highlight today's date
                    if (calendar[row][col].isSame(new Date(), "day"))
                        classes.push('today');

                    //highlight weekends
                    if (calendar[row][col].isoWeekday() > 5)
                        classes.push('weekend');

                    //grey out the dates in other months displayed at beginning and end of this calendar
                    if (calendar[row][col].month() != calendar[1][1].month())
                        classes.push('off');

                    //don't allow selection of dates before the minimum date
                    if (this.minDate && calendar[row][col].isBefore(this.minDate, 'day'))
                        classes.push('off', 'disabled');

                    //don't allow selection of dates after the maximum date
                    if (maxDate && calendar[row][col].isAfter(maxDate, 'day'))
                        classes.push('off', 'disabled');

                    //don't allow selection of date if a custom function decides it's invalid
                    if (this.isInvalidDate(calendar[row][col]))
                        classes.push('off', 'disabled');

                    //highlight the currently selected start date
                    if (calendar[row][col].format('YYYY-MM-DD') == this.startDate.format('YYYY-MM-DD'))
                        classes.push('active', 'start-date');

                    //highlight the currently selected end date
                    if (this.endDate != null && calendar[row][col].format('YYYY-MM-DD') == this.endDate.format('YYYY-MM-DD'))
                        classes.push('active', 'end-date');

                    //highlight dates in-between the selected dates
                    if (this.endDate != null && calendar[row][col] > this.startDate && calendar[row][col] < this.endDate)
                        classes.push('in-range');

                    var cname = '', disabled = false;
                    for (var i = 0; i < classes.length; i++) {
                        cname += classes[i] + ' ';
                        if (classes[i] == 'disabled')
                            disabled = true;
                    }
                    if (!disabled)
                        cname += 'available';

                    html += '<td class="' + cname.replace(/^\s+|\s+$/g, '') + '" data-title="' + 'r' + row + 'c' + col + '">' + calendar[row][col].date() + '</td>';

                }
                html += '</tr>';
            }

            html += '</tbody>';
            html += '</table>';

            this.container.find('.calendar.' + side + ' .calendar-table').html(html);

        },

        renderTimePicker: function(side) {

            var html, selected, minDate, maxDate = this.maxDate;

            if (this.dateLimit && (!this.maxDate || this.startDate.clone().add(this.dateLimit).isAfter(this.maxDate)))
                maxDate = this.startDate.clone().add(this.dateLimit);

            if (side == 'left') {
                selected = this.startDate.clone();
                minDate = this.minDate;
            } else if (side == 'right') {
                selected = this.endDate ? this.endDate.clone() : this.previousRightTime.clone();
                minDate = this.startDate;

                //Preserve the time already selected
                var timeSelector = this.container.find('.calendar.right .calendar-time div');
                if (timeSelector.html() != '') {

                    selected.hour(timeSelector.find('.hourselect option:selected').val() || selected.hour());
                    selected.minute(timeSelector.find('.minuteselect option:selected').val() || selected.minute());
                    selected.second(timeSelector.find('.secondselect option:selected').val() || selected.second());

                    if (!this.timePicker24Hour) {
                        var ampm = timeSelector.find('.ampmselect option:selected').val();
                        if (ampm === 'PM' && selected.hour() < 12)
                            selected.hour(selected.hour() + 12);
                        if (ampm === 'AM' && selected.hour() === 12)
                            selected.hour(0);
                    }

                    if (selected.isBefore(this.startDate))
                        selected = this.startDate.clone();

                    if (selected.isAfter(maxDate))
                        selected = maxDate.clone();

                }
            }

            //
            // hours
            //

            html = '<select class="hourselect">';

            var start = this.timePicker24Hour ? 0 : 1;
            var end = this.timePicker24Hour ? 23 : 12;

            for (var i = start; i <= end; i++) {
                var i_in_24 = i;
                if (!this.timePicker24Hour)
                    i_in_24 = selected.hour() >= 12 ? (i == 12 ? 12 : i + 12) : (i == 12 ? 0 : i);

                var time = selected.clone().hour(i_in_24);
                var disabled = false;
                if (minDate && time.minute(59).isBefore(minDate))
                    disabled = true;
                if (maxDate && time.minute(0).isAfter(maxDate))
                    disabled = true;

                if (i_in_24 == selected.hour() && !disabled) {
                    html += '<option value="' + i + '" selected="selected">' + i + '</option>';
                } else if (disabled) {
                    html += '<option value="' + i + '" disabled="disabled" class="disabled">' + i + '</option>';
                } else {
                    html += '<option value="' + i + '">' + i + '</option>';
                }
            }

            html += '</select> ';

            //
            // minutes
            //

            html += ': <select class="minuteselect">';

            for (var i = 0; i < 60; i += this.timePickerIncrement) {
                var padded = i < 10 ? '0' + i : i;
                var time = selected.clone().minute(i);

                var disabled = false;
                if (minDate && time.second(59).isBefore(minDate))
                    disabled = true;
                if (maxDate && time.second(0).isAfter(maxDate))
                    disabled = true;

                if (selected.minute() == i && !disabled) {
                    html += '<option value="' + i + '" selected="selected">' + padded + '</option>';
                } else if (disabled) {
                    html += '<option value="' + i + '" disabled="disabled" class="disabled">' + padded + '</option>';
                } else {
                    html += '<option value="' + i + '">' + padded + '</option>';
                }
            }

            html += '</select> ';

            //
            // seconds
            //

            if (this.timePickerSeconds) {
                html += ': <select class="secondselect">';

                for (var i = 0; i < 60; i++) {
                    var padded = i < 10 ? '0' + i : i;
                    var time = selected.clone().second(i);

                    var disabled = false;
                    if (minDate && time.isBefore(minDate))
                        disabled = true;
                    if (maxDate && time.isAfter(maxDate))
                        disabled = true;

                    if (selected.second() == i && !disabled) {
                        html += '<option value="' + i + '" selected="selected">' + padded + '</option>';
                    } else if (disabled) {
                        html += '<option value="' + i + '" disabled="disabled" class="disabled">' + padded + '</option>';
                    } else {
                        html += '<option value="' + i + '">' + padded + '</option>';
                    }
                }

                html += '</select> ';
            }

            //
            // AM/PM
            //

            if (!this.timePicker24Hour) {
                html += '<select class="ampmselect">';

                var am_html = '';
                var pm_html = '';

                if (minDate && selected.clone().hour(12).minute(0).second(0).isBefore(minDate))
                    am_html = ' disabled="disabled" class="disabled"';

                if (maxDate && selected.clone().hour(0).minute(0).second(0).isAfter(maxDate))
                    pm_html = ' disabled="disabled" class="disabled"';

                if (selected.hour() >= 12) {
                    html += '<option value="AM"' + am_html + '>AM</option><option value="PM" selected="selected"' + pm_html + '>PM</option>';
                } else {
                    html += '<option value="AM" selected="selected"' + am_html + '>AM</option><option value="PM"' + pm_html + '>PM</option>';
                }

                html += '</select>';
            }

            this.container.find('.calendar.' + side + ' .calendar-time div').html(html);

        },

        updateFormInputs: function() {

            //ignore mouse movements while an above-calendar text input has focus
            if (this.container.find('input[name=daterangepicker_start]').is(":focus") || this.container.find('input[name=daterangepicker_end]').is(":focus"))
                return;

            this.container.find('input[name=daterangepicker_start]').val(this.startDate.format(this.locale.format));
            if (this.endDate)
                this.container.find('input[name=daterangepicker_end]').val(this.endDate.format(this.locale.format));

            if (this.singleDatePicker || (this.endDate && (this.startDate.isBefore(this.endDate) || this.startDate.isSame(this.endDate)))) {
                this.container.find('button.applyBtn').removeAttr('disabled');
            } else {
                this.container.find('button.applyBtn').attr('disabled', 'disabled');
            }

        },

        move: function() {
            var parentOffset = { top: 0, left: 0 },
                containerTop;
            var parentRightEdge = $(window).width();
            if (!this.parentEl.is('body')) {
                parentOffset = {
                    top: this.parentEl.offset().top - this.parentEl.scrollTop(),
                    left: this.parentEl.offset().left - this.parentEl.scrollLeft()
                };
                parentRightEdge = this.parentEl[0].clientWidth + this.parentEl.offset().left;
            }

            if (this.drops == 'up')
                containerTop = this.element.offset().top - this.container.outerHeight() - parentOffset.top;
            else
                containerTop = this.element.offset().top + this.element.outerHeight() - parentOffset.top;
            this.container[this.drops == 'up' ? 'addClass' : 'removeClass']('dropup');

            if (this.opens == 'left') {
                this.container.css({
                    top: containerTop,
                    right: parentRightEdge - this.element.offset().left - this.element.outerWidth(),
                    left: 'auto'
                });
                if (this.container.offset().left < 0) {
                    this.container.css({
                        right: 'auto',
                        left: 9
                    });
                }
            } else if (this.opens == 'center') {
                this.container.css({
                    top: containerTop,
                    left: this.element.offset().left - parentOffset.left + this.element.outerWidth() / 2
                            - this.container.outerWidth() / 2,
                    right: 'auto'
                });
                if (this.container.offset().left < 0) {
                    this.container.css({
                        right: 'auto',
                        left: 9
                    });
                }
            } else {
                this.container.css({
                    top: containerTop,
                    left: this.element.offset().left - parentOffset.left,
                    right: 'auto'
                });
                if (this.container.offset().left + this.container.outerWidth() > $(window).width()) {
                    this.container.css({
                        left: 'auto',
                        right: 0
                    });
                }
            }
        },

        show: function(e) {
            if (this.isShowing) return;

            // Create a click proxy that is private to this instance of datepicker, for unbinding
            this._outsideClickProxy = $.proxy(function(e) { this.outsideClick(e); }, this);

            // Bind global datepicker mousedown for hiding and
            $(document)
              .on('mousedown.daterangepicker', this._outsideClickProxy)
              // also support mobile devices
              .on('touchend.daterangepicker', this._outsideClickProxy)
              // also explicitly play nice with Bootstrap dropdowns, which stopPropagation when clicking them
              .on('click.daterangepicker', '[data-toggle=dropdown]', this._outsideClickProxy)
              // and also close when focus changes to outside the picker (eg. tabbing between controls)
              .on('focusin.daterangepicker', this._outsideClickProxy);

            // Reposition the picker if the window is resized while it's open
            $(window).on('resize.daterangepicker', $.proxy(function(e) { this.move(e); }, this));

            this.oldStartDate = this.startDate.clone();
            this.oldEndDate = this.endDate.clone();
            this.previousRightTime = this.endDate.clone();

            this.updateView();
            this.container.show();
            this.move();
            this.element.trigger('show.daterangepicker', this);
            this.isShowing = true;
        },

        hide: function(e) {
            if (!this.isShowing) return;

            //incomplete date selection, revert to last values
            if (!this.endDate) {
                this.startDate = this.oldStartDate.clone();
                this.endDate = this.oldEndDate.clone();
            }

            //if a new date range was selected, invoke the user callback function
            if (!this.startDate.isSame(this.oldStartDate) || !this.endDate.isSame(this.oldEndDate))
                this.callback(this.startDate, this.endDate, this.chosenLabel);

            //if picker is attached to a text input, update it
            this.updateElement();

            $(document).off('.daterangepicker');
            $(window).off('.daterangepicker');
            this.container.hide();
            this.element.trigger('hide.daterangepicker', this);
            this.isShowing = false;
        },

        toggle: function(e) {
            if (this.isShowing) {
                this.hide();
            } else {
                this.show();
            }
        },

        outsideClick: function(e) {
            var target = $(e.target);
            // if the page is clicked anywhere except within the daterangerpicker/button
            // itself then call this.hide()
            if (
                // ie modal dialog fix
                e.type == "focusin" ||
                target.closest(this.element).length ||
                target.closest(this.container).length ||
                target.closest('.calendar-table').length
                ) return;
            this.hide();
        },

        showCalendars: function() {
            this.container.addClass('show-calendar');
            this.move();
            this.element.trigger('showCalendar.daterangepicker', this);
        },

        hideCalendars: function() {
            this.container.removeClass('show-calendar');
            this.element.trigger('hideCalendar.daterangepicker', this);
        },

        hoverRange: function(e) {

            //ignore mouse movements while an above-calendar text input has focus
            if (this.container.find('input[name=daterangepicker_start]').is(":focus") || this.container.find('input[name=daterangepicker_end]').is(":focus"))
                return;

            var label = e.target.innerHTML;
            if (label == this.locale.customRangeLabel) {
                this.updateView();
            } else {
                var dates = this.ranges[label];
                this.container.find('input[name=daterangepicker_start]').val(dates[0].format(this.locale.format));
                this.container.find('input[name=daterangepicker_end]').val(dates[1].format(this.locale.format));
            }
            
        },

        clickRange: function(e) {
            var label = e.target.innerHTML;
            this.chosenLabel = label;
            if (label == this.locale.customRangeLabel) {
                this.showCalendars();
            } else {
                var dates = this.ranges[label];
                this.startDate = dates[0];
                this.endDate = dates[1];

                if (!this.timePicker) {
                    this.startDate.startOf('day');
                    this.endDate.endOf('day');
                }

                this.hideCalendars();
                this.clickApply();
            }
        },

        clickPrev: function(e) {
            var cal = $(e.target).parents('.calendar');
            if (cal.hasClass('left')) {
                this.leftCalendar.month.subtract(1, 'month');
                if (this.linkedCalendars)
                    this.rightCalendar.month.subtract(1, 'month');
            } else {
                this.rightCalendar.month.subtract(1, 'month');
            }
            this.updateCalendars();
        },

        clickNext: function(e) {
            var cal = $(e.target).parents('.calendar');
            if (cal.hasClass('left')) {
                this.leftCalendar.month.add(1, 'month');
            } else {
                this.rightCalendar.month.add(1, 'month');
                if (this.linkedCalendars)
                    this.leftCalendar.month.add(1, 'month');
            }
            this.updateCalendars();
        },

        hoverDate: function(e) {

            //ignore mouse movements while an above-calendar text input has focus
            if (this.container.find('input[name=daterangepicker_start]').is(":focus") || this.container.find('input[name=daterangepicker_end]').is(":focus"))
                return;

            //ignore dates that can't be selected
            if (!$(e.target).hasClass('available')) return;

            //have the text inputs above calendars reflect the date being hovered over
            var title = $(e.target).attr('data-title');
            var row = title.substr(1, 1);
            var col = title.substr(3, 1);
            var cal = $(e.target).parents('.calendar');
            var date = cal.hasClass('left') ? this.leftCalendar.calendar[row][col] : this.rightCalendar.calendar[row][col];

            if (this.endDate) {
                this.container.find('input[name=daterangepicker_start]').val(date.format(this.locale.format));
            } else {
                this.container.find('input[name=daterangepicker_end]').val(date.format(this.locale.format));
            }

            //highlight the dates between the start date and the date being hovered as a potential end date
            var leftCalendar = this.leftCalendar;
            var rightCalendar = this.rightCalendar;
            var startDate = this.startDate;
            if (!this.endDate) {
                this.container.find('.calendar td').each(function(index, el) {

                    //skip week numbers, only look at dates
                    if ($(el).hasClass('week')) return;

                    var title = $(el).attr('data-title');
                    var row = title.substr(1, 1);
                    var col = title.substr(3, 1);
                    var cal = $(el).parents('.calendar');
                    var dt = cal.hasClass('left') ? leftCalendar.calendar[row][col] : rightCalendar.calendar[row][col];

                    if (dt.isAfter(startDate) && dt.isBefore(date)) {
                        $(el).addClass('in-range');
                    } else {
                        $(el).removeClass('in-range');
                    }

                });
            }

        },

        clickDate: function(e) {

            if (!$(e.target).hasClass('available')) return;

            var title = $(e.target).attr('data-title');
            var row = title.substr(1, 1);
            var col = title.substr(3, 1);
            var cal = $(e.target).parents('.calendar');
            var date = cal.hasClass('left') ? this.leftCalendar.calendar[row][col] : this.rightCalendar.calendar[row][col];

            //
            // this function needs to do a few things:
            // * alternate between selecting a start and end date for the range,
            // * if the time picker is enabled, apply the hour/minute/second from the select boxes to the clicked date
            // * if autoapply is enabled, and an end date was chosen, apply the selection
            // * if single date picker mode, and time picker isn't enabled, apply the selection immediately
            //

            if (this.endDate || date.isBefore(this.startDate, 'day')) {
                if (this.timePicker) {
                    var hour = parseInt(this.container.find('.left .hourselect').val(), 10);
                    if (!this.timePicker24Hour) {
                        var ampm = this.container.find('.left .ampmselect').val();
                        if (ampm === 'PM' && hour < 12)
                            hour += 12;
                        if (ampm === 'AM' && hour === 12)
                            hour = 0;
                    }
                    var minute = parseInt(this.container.find('.left .minuteselect').val(), 10);
                    var second = this.timePickerSeconds ? parseInt(this.container.find('.left .secondselect').val(), 10) : 0;
                    date = date.clone().hour(hour).minute(minute).second(second);
                }
                this.endDate = null;
                this.setStartDate(date.clone());
            } else if (!this.endDate && date.isBefore(this.startDate)) {
                //special case: clicking the same date for start/end, 
                //but the time of the end date is before the start date
                this.setEndDate(this.startDate.clone());
            } else {
                if (this.timePicker) {
                    var hour = parseInt(this.container.find('.right .hourselect').val(), 10);
                    if (!this.timePicker24Hour) {
                        var ampm = this.container.find('.right .ampmselect').val();
                        if (ampm === 'PM' && hour < 12)
                            hour += 12;
                        if (ampm === 'AM' && hour === 12)
                            hour = 0;
                    }
                    var minute = parseInt(this.container.find('.right .minuteselect').val(), 10);
                    var second = this.timePickerSeconds ? parseInt(this.container.find('.right .secondselect').val(), 10) : 0;
                    date = date.clone().hour(hour).minute(minute).second(second);
                }
                this.setEndDate(date.clone());
                if (this.autoApply)
                    this.clickApply();
            }

            if (this.singleDatePicker) {
                this.setEndDate(this.startDate);
                if (!this.timePicker)
                    this.clickApply();
            }

            this.updateView();

        },

        clickApply: function(e) {
            this.hide();
            this.element.trigger('apply.daterangepicker', this);
        },

        clickCancel: function(e) {
            this.startDate = this.oldStartDate;
            this.endDate = this.oldEndDate;
            this.hide();
            this.element.trigger('cancel.daterangepicker', this);
        },

        monthOrYearChanged: function(e) {
            var isLeft = $(e.target).closest('.calendar').hasClass('left'),
                leftOrRight = isLeft ? 'left' : 'right',
                cal = this.container.find('.calendar.'+leftOrRight);

            // Month must be Number for new moment versions
            var month = parseInt(cal.find('.monthselect').val(), 10);
            var year = cal.find('.yearselect').val();

            if (!isLeft) {
                if (year < this.startDate.year() || (year == this.startDate.year() && month < this.startDate.month())) {
                    month = this.startDate.month();
                    year = this.startDate.year();
                }
            }

            if (this.minDate) {
                if (year < this.minDate.year() || (year == this.minDate.year() && month < this.minDate.month())) {
                    month = this.minDate.month();
                    year = this.minDate.year();
                }
            }

            if (this.maxDate) {
                if (year > this.maxDate.year() || (year == this.maxDate.year() && month > this.maxDate.month())) {
                    month = this.maxDate.month();
                    year = this.maxDate.year();
                }
            }

            if (isLeft) {
                this.leftCalendar.month.month(month).year(year);
                if (this.linkedCalendars)
                    this.rightCalendar.month = this.leftCalendar.month.clone().add(1, 'month');
            } else {
                this.rightCalendar.month.month(month).year(year);
                if (this.linkedCalendars)
                    this.leftCalendar.month = this.rightCalendar.month.clone().subtract(1, 'month');
            }
            this.updateCalendars();
        },

        timeChanged: function(e) {

            var cal = $(e.target).closest('.calendar'),
                isLeft = cal.hasClass('left');

            var hour = parseInt(cal.find('.hourselect').val(), 10);
            var minute = parseInt(cal.find('.minuteselect').val(), 10);
            var second = this.timePickerSeconds ? parseInt(cal.find('.secondselect').val(), 10) : 0;

            if (!this.timePicker24Hour) {
                var ampm = cal.find('.ampmselect').val();
                if (ampm === 'PM' && hour < 12)
                    hour += 12;
                if (ampm === 'AM' && hour === 12)
                    hour = 0;
            }

            if (isLeft) {
                var start = this.startDate.clone();
                start.hour(hour);
                start.minute(minute);
                start.second(second);
                this.setStartDate(start);
                if (this.singleDatePicker) {
                    this.endDate = this.startDate.clone();
                } else if (this.endDate && this.endDate.format('YYYY-MM-DD') == start.format('YYYY-MM-DD') && this.endDate.isBefore(start)) {
                    this.setEndDate(start.clone());
                }
            } else if (this.endDate) {
                var end = this.endDate.clone();
                end.hour(hour);
                end.minute(minute);
                end.second(second);
                this.setEndDate(end);
            }

            //update the calendars so all clickable dates reflect the new time component
            this.updateCalendars();

            //update the form inputs above the calendars with the new time
            this.updateFormInputs();

            //re-render the time pickers because changing one selection can affect what's enabled in another
            this.renderTimePicker('left');
            this.renderTimePicker('right');

        },

        formInputsChanged: function(e) {
            var isRight = $(e.target).closest('.calendar').hasClass('right');
            var start = moment.utc(this.container.find('input[name="daterangepicker_start"]').val(), this.locale.format);
            var end = moment.utc(this.container.find('input[name="daterangepicker_end"]').val(), this.locale.format);

            if (start.isValid() && end.isValid()) {

                if (isRight && end.isBefore(start))
                    start = end.clone();

                this.setStartDate(start);
                this.setEndDate(end);

                if (isRight) {
                    this.container.find('input[name="daterangepicker_start"]').val(this.startDate.format(this.locale.format));
                } else {
                    this.container.find('input[name="daterangepicker_end"]').val(this.endDate.format(this.locale.format));
                }

            }

            this.updateCalendars();
            if (this.timePicker) {
                this.renderTimePicker('left');
                this.renderTimePicker('right');
            }
        },

        elementChanged: function() {
            if (!this.element.is('input')) return;
            if (!this.element.val().length) return;
            if (this.element.val().length < this.locale.format.length) return;

            var dateString = this.element.val().split(this.locale.separator),
                start = null,
                end = null;

            if (dateString.length === 2) {
                start = moment.utc(dateString[0], this.locale.format);
                end = moment.utc(dateString[1], this.locale.format);
            }

            if (this.singleDatePicker || start === null || end === null) {
                start = moment.utc(this.element.val(), this.locale.format);
                end = start;
            }

            if (!start.isValid() || !end.isValid()) return;

            this.setStartDate(start);
            this.setEndDate(end);
            this.updateView();
        },

        keydown: function(e) {
            //hide on tab or enter
            if ((e.keyCode === 9) || (e.keyCode === 13)) {
                this.hide();
            }
        },

        updateElement: function() {
            if (this.element.is('input') && !this.singleDatePicker && this.autoUpdateInput) {
                this.element.val(this.startDate.format(this.locale.format) + this.locale.separator + this.endDate.format(this.locale.format));
                this.element.trigger('change');
            } else if (this.element.is('input') && this.autoUpdateInput) {
                this.element.val(this.startDate.format(this.locale.format));
                this.element.trigger('change');
            }
        },

        remove: function() {
            this.container.remove();
            this.element.off('.daterangepicker');
            this.element.removeData();
        }

    };

    $.fn.daterangepicker = function(options, callback) {
        this.each(function() {
            var el = $(this);
            if (el.data('daterangepicker'))
                el.data('daterangepicker').remove();
            el.data('daterangepicker', new DateRangePicker(el, options, callback));
        });
        return this;
    };
    
    return DateRangePicker;

}));


/// <reference path="jquery-1.4.2" />
/// <reference path="Scripts/dev/Util.js" />

(function ($) {

    $.fn.dropBox = function (options) {
        return Util.pluginDefaultBehavior(this, "dropBox", arguments, function () { return new DropBox() });
    }

    function DropBox() {
        var ctrl;
        var ctrlParent;
        var hideTimeout;
        var searchTimeout;
        var currentRow;
        var lastRow;
        var outerDiv;
        var columns = [];
        var itemsAdded = [];
        var first;
        var table;
        var maxResults;
        var thisDropbox = this;
        var applyStatusClasses;
        var tabKeyPressed = false;
        var shiftKeyPressed = false;


        var settings = {
            'lineHeight': 'auto'
            , 'showHeader': true
			, 'highlightMatchText': true
			, 'boxWidth': 'auto'
            , 'fixedWidth': false
            , 'boxHeight': 200
			, 'maxResultsServer': 100
            , 'maxResultsClient': 10
			, 'minSearchLength': 1
			, 'highlightMatchTextMinLen': 1
            , 'linesByPaging': 5
            , 'digitInterval': 300
            , 'items': []
			, 'columns': []
			, 'searchColumn': undefined
			, 'searchClientColumn': undefined
			, 'onSearchClient': undefined
			, 'onSearchClientParams': undefined
			, 'onSearch': undefined
            , 'onSearchParams': {}
			, 'waitElement': undefined
            , 'onDrawLine': undefined
			, 'onSelect': undefined
            , 'onNewSearchTerm': undefined
            , 'onNewSearchTermParams': undefined
            , 'uniqueColumn': undefined
            , 'moreResultsMessage': undefined
            , 'useMoreResults': true
            , 'cacheEnhancer': undefined
            , 'useScroll': false
            , 'applyStatusClasses': true
            , 'applyFixedClass': false
            , 'legend': undefined
            , 'selectOnTab': true
        };

        var KEYS = {
            UP: 38
			, DOWN: 40
			, ENTER: 13
			, ESC: 27
			, BACKSPACE: 8
            , PAGEUP: 33
            , PAGEDOWN: 34
            , TAB: 9
			, IGNORED: [37, 39, 16, 20, 17, 18, 35, 36, 188, 17, 255]
			, IsIgnore: function (x) {
			    return KEYS.IGNORED.any(x);
			}
        }

        function resolvePos(element) {
            var ret = {};

            ret.top = $(element).offset().top + $(element).height() + 5;
            ret.left = $(element).offset().left;

            if (settings.applyFixedClass) {
                ret.top -= $('body').scrollTop();
                ret.left -= $('body').scrollLeft();
            }

            return ret;
        }

        function showDropBox(ctrl, dropBox) {
            if (ctrl.data('items') != 0) {
                _removeLegend();
                var pos = resolvePos(ctrl);
                dropBox.css({ top: pos.top, left: pos.left, 'z-index': Util.GetMaxZIndex(dropBox.selector) + 1 });
                dropBox.show();
            }
            else {
                ctrl.hideDropBox();
            }
        }

        function moveDown(dropBox) {
            var row = $(currentRow).next();
            setCurrentRow(row, dropBox);
        }

        function moveUp(dropBox) {
            var row = $(currentRow).prev();
            setCurrentRow(row, dropBox);
        }

        function pageDown(dropBox) {
            for (var i = 0; i < settings.linesByPaging; i++)
                moveDown(dropBox);
        }

        function pageUp(dropBox) {
            for (var i = 0; i < settings.linesByPaging; i++)
                moveUp(dropBox);
        }

        function enter(event) {
            if (currentRow) {
                $(currentRow).trigger("click");
            }
            event.preventDefault();
        }

        function tab(event) {
            tabKeyPressed = true;
            if (currentRow) {
                $(currentRow).trigger("click");
            }
        }

        function focus(event) {
            if (settings.legend) {
                // Isso não estava funcionando na tela da checkout, por isso comentei
                //if (outerDiv && outerDiv.find('tr').length == 1) {
                //    if (!$('.dropbox-legend', outerDiv).length) {
                //        var legend = $('<p>').addClass('dropbox-legend');
                //        legend.text(settings.legend);
                //        $(outerDiv).append(legend);
                //    }

                //    var pos = resolvePos(ctrl);
                //    outerDiv.css({ top: pos.top, left: pos.left });

                //    outerDiv.fadeIn('fast');
                //}
            }
        }

        function _removeLegend() {
            $('.dropbox-legend', outerDiv).remove();
        }

        function getMoreResults(keyword) {
            ctrl.data('focus', true);

            if (!table) {
                var dropBox = ctrl.data('dropBox');
                table = $(".dbTbBody", dropBox);
            }

            var rowCount = $('tbody >tr', table).length;
            var max = (settings.useMoreResults) ? settings.maxResultsServer : settings.maxResultsClient;

            if (settings.onSearch && rowCount < max) {

                if (settings.waitElement) {
                    var left = ctrl.offset().left + ctrl.width() + 5;
                    var top = ctrl.offset().top;

                    settings.waitElement.css({ top: top, left: left });
                    settings.waitElement.fadeIn(300);
                }

                if (keyword.length > 0) {
                    settings.onSearchParams['keyword'] = jQuery.trim(keyword);

                    if (applyStatusClasses)
                        ctrl.addClass('autocomplete_loading');

                    settings.onSearch(ctrl, settings.onSearchParams, Math.max(max, 8));
                }
            }
        }

        function newSearchParameter() {

            var previousSelection = thisDropbox.dropBoxGetSelection();

            ctrl.data("sel", null);

            if (previousSelection && settings.onSelect)
                settings.onSelect(ctrl, null);

            if (searchTimeout)
                clearTimeout(searchTimeout);

            if (applyStatusClasses)
                ctrl.addClass('active');

            searchTimeout = setTimeout(function () {
                if (table)
                    table.empty();

                hideDropBox();
                var keyword = ctrl.val();
                ctrl.data('keyword', keyword);
                ctrl.data('items', 0);
                itemsAdded = [];

                if (settings.onNewSearchTerm) {
                    settings.onNewSearchTermParams['keyword'] = keyword;
                    settings.onNewSearchTerm(ctrl, settings.onNewSearchTermParams);
                }

                if (settings.onSearchClient && settings.items) {
                    settings.onSearchClientParams['keyword'] = keyword;
                    settings.onSearchClient(ctrl, settings.onSearchClientParams);
                }

                if (!settings.useMoreResults)
                    getMoreResults(keyword);

            }, settings.digitInterval);
        }

        function setCurrentRow(row, dropBox) {
            if (row && row.length > 0) {
                lastRow = currentRow;
                currentRow = row;
                highlighCurrent();

                ajustScroll(dropBox);
            }
        }

        function highlighCurrent() {
            if (lastRow)
                $(lastRow).removeClass("selectedRow");

            $(currentRow).addClass("selectedRow");
        }

        function ajustScroll(dropBox) {
            var divBody = $(".dbBody", dropBox);
            var beginWindow = divBody.scrollTop();
            var endWindow = divBody.scrollTop() + divBody.height();
            var currentPos = divBody.scrollTop() + currentRow.position().top;
            var toScroll = -1;
            var offSet = 0;
            if (currentPos < beginWindow || currentPos >= endWindow) {
                if (currentPos >= endWindow)
                    offSet = -divBody.height();
                else
                    offSet = -(currentRow.height());

                toScroll = currentPos + offSet;
                if (toScroll < 0)
                    toScroll = 0;
            }

            if (toScroll >= 0) {
                var lineHeight = parseInt(settings.lineHeight);
                if (!isNaN(lineHeight))
                    toScroll += lineHeight;

                divBody.scrollTop(toScroll);
            }   
        }

        function cacheEnhancerHandler(items) {
            if (settings.cacheEnhancer)
                settings.cacheEnhancer(items);
        }

        function alreadyAdded(uniqueColumn) {
            if (uniqueColumn) {
                for (var i = 0, len = itemsAdded.length; i < len; i++)
                    if (itemsAdded[i] == uniqueColumn || itemsAdded[i][settings.uniqueColumn] == uniqueColumn[settings.uniqueColumn])
                        return true;

                itemsAdded.push(uniqueColumn);
            }

            return false;
        }

        function addItems(field, dropBox, items, isClientCall, options) {
            table = $(".dbTbBody", dropBox);
            var firstRow = undefined;
            var empty = table.children().length == 0;
            _removeLegend();
            var str;
            var currentItem;

            if (!isClientCall) {
                var continueTyping = $("tr.continue-typing", table);

                if (continueTyping && continueTyping.length > 0) {
                    continueTyping.remove();
                    empty = true;
                }
            }

            var currentMax = (settings.useMoreResults) ? ((isClientCall) ? settings.maxResultsClient : settings.maxResultsServer) : settings.maxResultsClient;

            for (var i = 0; i < items.length && i < currentMax; i++) {
                currentItem = items[i];

                if (settings.uniqueColumn)
                    if (alreadyAdded(currentItem))
                        continue;

                var continueTyping = (currentItem.continueTyping) ? " class='continue-typing'" : "";

                str = "<tr" + continueTyping + ">";

                for (j = 0; j < columns.length; j++) {

                    var tdContent = (columns[j].onDraw ? columns[j].onDraw(currentItem) : currentItem[columns[j].name]);
                    var ctrlData = ctrl.data('keyword');
                    var highlightThisColumn = settings.highlightMatchText && columns[j].name == settings.searchColumn && ctrlData && ctrlData.length >= settings.highlightMatchTextMinLen;

                    if (highlightThisColumn) {

                        var pattern = "(" + ctrl.data('keyword').replace("[^\w]", "").replace("\(", "").replace("\)", "") + "){1}";

                        var regex = new RegExp(pattern, "i");

                        var match = tdContent.removeDiacritics().match(regex);

                        if (match != null && match.length) {

                            var indexOf = tdContent.removeDiacritics().indexOf(match[0]);

                            tdContent = tdContent.substring(0, indexOf) + "<span class='dbMathResult'>" + tdContent.substring(indexOf, indexOf + match[0].length) + "</span>" + tdContent.substr(indexOf + match[0].length, tdContent.length - 1);
                        }
                    }

                    str += "<td col='" + columns[j].name + "' width='" + columns[j].width + "px' " + "title='" + currentItem[columns[j].name] + "'>" + tdContent + "</td>";
                }
                str += "</tr>";

                var line = $(str);

                line.css('height', settings.lineHeight);

                line.appendTo(table);

                if (!currentItem.continueTyping) {
                    line.bind("click", { field: field, item: currentItem, dropBox: dropBox, options: options }, lineClick);
                    line.mouseover(function () {
                        setCurrentRow($(this), dropBox);
                    });
                }

                if (options.onDrawLine)
                    options.onDrawLine(i + 1, currentItem, line);

                if (i == 0)
                    firstRow = line;
            }

            field.data('items', field.data('items') + items.length);

            if (empty) {
                currentRow = firstRow;
                highlighCurrent();
            }

            if (items.length)
                showDropBox(ctrl, dropBox);

            appendMoreResultsRow(dropBox, items.length, options);
        }

        function appendMoreResultsRow(dropBox, itemsLength, options) {
            if (options.useMoreResults) {
                table = $(".dbTbBody", dropBox);

                $(".moreResults", table).remove();
                moreResultsRow = $("<tr class='moreResults'><td><strong>" + options.moreResultsMessage + "<strong></td></tr>");
                moreResultsRow.bind("click", { keyword: ctrl.data('keyword') }, moreResultsClick);
                moreResultsRow.mouseover(function () { setCurrentRow($(this), dropBox); });
                moreResultsRow.appendTo("tbody", table);

                if (itemsLength == 0)
                    moreResultsRow.trigger("click");
            }
        }

        function moreResultsClick(event) {
            ctrl.focus();
            $(".moreResults", table).remove();
            getMoreResults(event.data.keyword);
        }

        function lineClick(event) {
            var info = event.data;

            info.field.data("sel", info.item);
            info.field.val(info.item[info.options.searchColumn]);

            hideDropBox();

            if (applyStatusClasses)
                ctrl.removeClass('autocomplete_empty').addClass('autocomplete_completed');

            var thiscomponent = $(info.field);
            var nextElement = thiscomponent.attr('nextelem');

            if (nextElement && !shiftKeyPressed && !tabKeyPressed) {
                var contextForNextElem = thiscomponent.attr('nextelemcontext');
                if (contextForNextElem && contextForNextElem.length > 0) {
                    thiscomponent.closest(contextForNextElem).find(nextElement).focus();
                }
                else {
                    $(nextElement).focus();
                }
            }
            else
                info.field.focus();

            if (info.options.onSelect)
                info.options.onSelect(info.field, info.item);
        }

        function updateColumns() {
            var fixedClass = settings.applyFixedClass ? " fixed" : "";
            var html = '<div class="dropBox' + fixedClass + '">'
            if (settings.showHeader) {
                html += '<div class="dbHeader">';

                html += '<table class="dbTbHeader"><tr>';
                var c;
                for (var i = 0; i < columns.length; i++) {
                    c = columns[i];
                    html += "<td style='text-align:right; overflow: hidden; display: inline-block; white-space: nowrap;' col='header_" + c.name + "' width='" + c.width + "px'>" + c.title + "</td>";
                }
                html += '</tr></table>';
                html += '</div>';
            }
            html += '<div class="dbBody">' +
                '<table class="dbTbBody">' +
                '</table>' +
            '</div>' +
            '</div>';

            if (outerDiv == undefined) {
                outerDiv = $(html);
            } else {
                outerDiv.html(html);
            }

            if (settings.fixedWidth) {
                $(".dbTbBody", outerDiv).css({
                    width: settings.boxWidth == 'auto' ? 'auto' : settings.boxWidth.indexOf && settings.boxWidth.indexOf('%') > -1 ? settings.boxWidth : settings.boxWidth + "px",
                    "table-layout": "fixed"
                });
            }
        }

        function buildDropBox(input, options) {
            updateColumns();

            $(outerDiv).css({
                width: options.boxWidth == 'auto' ? 'auto' : options.boxWidth.indexOf && options.boxWidth.indexOf('%') > -1 ? options.boxWidth : options.boxWidth + "px",
                position: "absolute",
                display: "none"
            });

            $(".dbHeader", outerDiv).css({
                overflow: "hidden",
                display: options.showHeader ? "" : "none"
            });

            if (options.fixedWidth) {
                $(".dbTbBody", outerDiv).css({
                    width: options.boxWidth == 'auto' ? 'auto' : options.boxWidth.indexOf && options.boxWidth.indexOf('%') > -1 ? options.boxWidth : options.boxWidth + "px",
                    "table-layout": "fixed"
                });
            }

            var dbBody = $(".dbBody", outerDiv);
            dbBody.css({
                maxHeight: options.boxHeight + "px",
                "overflow-y": (settings.useMoreResults || settings.useScroll) ? "auto" : "hidden",
                "overflow-x": "hidden"
            });

            dbBody.bind("mousedown", function (event) {
                clearTimeout(hideTimeout);
            })
            .bind("scroll", function (event) {
                clearTimeout(hideTimeout);
                input.focus();
            })
            .bind("keydown", function (event) {
                alert(event.key);
            });

            return outerDiv;
        }

        function hideDropBox(dropBox) {

            if (!dropBox)
                dropBox = ctrl.data('dropBox');

            if (dropBox) {
                dropBox.hide();
                ctrl.data('keyword', undefined);
                itemsAdded = [];
            }

            if (settings.applyStatusClasses && ctrl.val() == '')
                ctrl.removeClass('autocomplete_completed').addClass('autocomplete_empty');
        }

        function setCustomIgnoredKey() {
            if (!settings.selectOnTab &&
                KEYS && KEYS.IGNORED &&
                KEYS.IGNORED.length) {
                KEYS.IGNORED.push(KEYS.TAB);
            }

        }

        this.dropBoxGetSelection = function () {
            if (ctrl.length != 1)
                throw "O metodo getSelection é aplicado a apenas um elemento. Utilize um selector que se aplique a apenas 1 elemento.";
            else {
                var ret = ctrl.data("sel");
                if (ret == null) {
                    ret = undefined;
                }

                return ret;
            }
        };

        this.initialize = function (input, options) {
            ctrl = $(input);

            //options.items é o cache de localidades. O $.extend travava quando mergeava os objetos.

            var items = options.items || [];

            options.items = [];

            $.extend(true, settings, options || {});

            settings.items = items;

            if (settings.waitElement) {
                settings.waitElement.css({
                    position: "absolute",
                    display: "none"
                });
            }

            if (settings.columns != undefined)
                columns = settings.columns;

            maxResults = (settings.maxResults != undefined) ? settings.maxResults : 10;

            applyStatusClasses = settings.applyStatusClasses;

            if (applyStatusClasses)
                ctrl.addClass('autocomplete_empty');

            if (ctrl.is("input[type='text']")) {

                //Desliga o autocomplete default do browser...
                ctrl.attr("autocomplete", "off");
                ctrl.data('options', settings);

                if (settings.legend) {
                    ctrl.unbind('focus');
                    ctrl.focus(focus);
                }

                ctrl.data('focus', true);

                ctrl.blur(function (event) {
                    ctrl.data('focus', true);
                });

                if (!ctrl.data('dropBox')) {
                    instantiateDropbox(ctrl, settings);
                }

                ctrl.unbind("keydown").keydown(function (event) {

                    dropBox = ctrl.data('dropBox');

                    shiftKeyPressed = event.shiftKey;
                    tabKeyPressed = false;
                    if (!event.ctrlKey) {
                        var val = (ctrl.attr("value") != null) ? ctrl.attr("value") : ctrl.val();
                        if (settings.minSearchLength <= val.length + 1) {

                            _removeLegend();
                            var key = event.keyCode;

                            if (!KEYS.IsIgnore(key)) {
                                switch (key) {
                                    case KEYS.UP: moveUp(dropBox); break;
                                    case KEYS.DOWN: moveDown(dropBox); break;
                                    case KEYS.PAGEUP: pageUp(dropBox); break;
                                    case KEYS.PAGEDOWN: pageDown(dropBox); break;
                                    case KEYS.ENTER: enter(event); break;
                                    case KEYS.TAB: tab(event); break;
                                    case KEYS.ESC: hideDropBox(); break;
                                    default: newSearchParameter();
                                }
                            }
                        }
                    }
                });

                setCustomIgnoredKey();
            }
        };

        function instantiateDropbox(ctrl, settings) {

            if (!ctrl.data('dropBox')) {
                var dropBox = buildDropBox(ctrl, settings);

                dropBox.appendTo($("body"));
                table = $(".dbTbBody", dropBox);

                ctrl.data('dropBox', dropBox);
                ctrl.data('focus', true);

                ctrl.on('remove', function () {
                    ctrl.removeData('dropBox');
                    dropBox.remove();
                });

                ctrl.on('hide', function () {
                    dropBox.hide();
                });
            }

        }

        this.dropBoxUpdateColumns = function (_columns) {
            if (_columns) {
                columns = _columns;
            }
            updateColumns();
        };

        this.hideDropBox = function () {
            hideDropBox();
        };

        this.destroy = function () {
            var component = ctrl.data("dropBox");

            if (component)
                component.remove();
        };

        this.dropBoxAddItems = function (items, keyword, isClientCall) {

            if (applyStatusClasses)
                ctrl.removeClass('autocomplete_loading');

            var actualKeyword = ctrl.data('keyword');
            var dropBox = ctrl.data('dropBox');
            var settings = ctrl.data('options');

            cacheEnhancerHandler(items);

            if (dropBox && settings) {
                if (ctrl.data('focus') == true && items && items.length > 0) {
                    addItems(ctrl, dropBox, items, isClientCall, settings);
                    showDropBox(ctrl, dropBox);
                }

                if (settings.waitElement)
                    settings.waitElement.hide();
            }

            appendMoreResultsRow(dropBox, items.length, settings);

            if (applyStatusClasses)
                ctrl.removeClass('active');
        };

        this.dropBoxSetSelected = function (item) {
            var settingsComponent = settings;

            if (!settingsComponent)
                settingsComponent = ctrl.data('options');

            if (settingsComponent) {
                ctrl.val(item[settingsComponent.searchColumn]).text(item[settingsComponent.searchColumn]).data("sel", item);
            } else if (item.i) {
                ctrl.val(item.i.toLowerCase() + "-azul");
            }
        };

        this.dropBoxClearOnlyItemSelected = function () {
            ctrl.removeData("sel");
        };

        this.dropBoxClearSelected = function () {
            ctrl.val("").removeData("sel");
        };

        this.changeHeaderUsage = function (enable) {
            settings.showHeader = enable;
        };
    }
})(jQuery);


ï»¿if (typeof CustomElements == 'undefined') { var CustomElements = {}; }

CustomElements.CustomCheck = new (function () {

    jQuery.expr[':'].ischecked = function (element) {
        var checked = false;
        if ($(element).hasClass('customcheck') || $(element).hasClass('customradio'))
            checked = $(element).hasClass('current');
        else if ('checkbox' === element.type || 'radio' === element.type)
            checked = element.checked;

        return checked;
    };

    jQuery.fn.setCheck = function (boolean) {
        if (typeof boolean == "string")
            boolean = boolean.toLowerCase() == "true";

        return this.each(function () {
            var $this = $(this);
            if ($this.hasClass('customcheck') || $this.hasClass('customradio'))
                boolean ? $this.addClass('current') : $this.removeClass('current');
            else if ('checkbox' === this.type || 'radio' === this.type)
                this.checked = boolean;
        });
    }

    jQuery.fn.uncheck = function () {
        return this.each(function () {
            var $this = $(this);
            if ($this.hasClass('customcheck') || $this.hasClass('customradio'))
                $this.removeClass('current');
            else if ('checkbox' === this.type || 'radio' === this.type)
                $this.prop('checked', false);
        });
    }

    jQuery.fn.check = function () {
        return this.each(function () {
            var $this = $(this);
            if ($this.hasClass('customcheck') || $this.hasClass('customradio'))
                $this.addClass('current');
            else if ('checkbox' === this.type || 'radio' === this.type)
                $this.prop('checked', true);
        });
    }

    function isCustomCheck(obj) {
        return obj.jquery && (obj.hasClass('customcheck') || obj.hasClass('customradio'));
    }
});

CustomElements.MultiOptions = new (function () {
    jQuery.fn.getSelectedValue = function () {
        var $this = isMultiOptions($(this));
        if ($this)
            return $this.find('ul li a.current').attr('value');
        else if ($(this).filter('select').length)
            return $(this).find('option:selected').val();
        else
            return $(this).val();
    }

    jQuery.fn.setSelectedValue = function (value) {
        return this.each(function () {
            var obj = isMultiOptions($(this));
            if (obj) {
                obj.find('ul li a:[value=' + value + ']').each(function () {
                    var current = $(this);
                    current.addClass('current');
                    current.parents('.multi_options').find('span').text(current.text());
                    var thisList = current.parent().parent();

                    thisList.find('li a').not(current).removeClass('current');

                });
            } else if ($(this).filter('select').length)
                $(this).val(value);
        });
    }

    jQuery.fn.enabled = function () {
        $(this).removeClass('disabled');
    }

    jQuery.fn.disabled = function () {
        $(this).addClass('disabled');
    }

    jQuery.fn.isDisabled = function () {
        return $(this).hasClass('disabled');
    }

    jQuery.fn.getSelectedOption = function () {
        var obj = $(this);
        if (isMultiOptions(obj) || obj.filter('select').length) {
            var ret = { Value: '', Description: '' };
            if (isMultiOptions(obj)) {
                ret.Value = obj.attr('value');
                ret.Description = obj.text();
            } else if (obj.filter('select').length) {
                ret.Value = obj.find('option:selected').val();
                ret.Description = obj.find('option:selected').text();
            }
            return ret;
        }
    }

    jQuery.fn.getSelectedText = function () {
        var $this = isMultiOptions($(this));
        if ($this)
            return $this.find('ul li a.current').text();
        else if ($(this).filter('select').length)
            return $(this).find('option:selected').text();
    }

    jQuery.fn.setChangeEvent = function (func) {
        var changeEvent = function (e) {
            e.preventDefault();
            var $this = this;
            setTimeout(function () { func.call($this); }, 50);
        };

        var setOnMultiOptions = function (dom) {
            dom.find('ul li a').live('click', changeEvent);
        };

        if (typeof func == 'function')
            if (this.length)
                this.each(function () {
                    var obj = $(this);
                    if (isMultiOptions(obj))
                        setOnMultiOptions(obj);
                    else if (obj.is('select'))
                        obj.live('change', func);
                });
            else
                setOnMultiOptions($(this));

        return this;
    }


    function isMultiOptions(obj) {
        if (obj.jquery)
            if (obj.hasClass('multi_options') || obj.parents('div').hasClass('multi_options'))
                return obj.hasClass('multi_options') ? obj : obj.parents('div.multi_options');
    }
});

CustomElements.Events = new (function () {
    this.Init = function () {
        $('.customcheck').live('click', OnCheckClick);
        $('.customradio').live('click', OnRadioClick);

        var multiOptions = $('.multi_options')
            .live('keyup', MultiOptionsOnKeyPress)
            .live('click', OnMultiOptionsClick)
            .live('focusout', CloseMultiOptions)
            .attr('tabindex', '-1');

        multiOptions.find('span').attr('tabindex', '0');

        if ($.fn.livequery)
            $("div.multi_options:not([tabindex='-1'])").livequery(onMultiOptionsLive);
        else
            setInterval(onMultiOptionsLiveTimeOut, 500);

        var multiOptionsItems = $('.multi_options ul li a')
            .attr('tabindex', '-1')
            .live('click', OnSelectMultiOptionsItem);
    }

    function onMultiOptionsLiveTimeOut() {
        $('.multi_options:not([tabindex=-1])').each(onMultiOptionsLive);
    }

    function onMultiOptionsLive() {
        var $this = $(this);

        $this.attr('tabindex', '-1').find('span').attr('tabindex', '0');

        $this.find('ul').attr('tabindex', '-1').find('li').attr('tabindex', '-1').find('a').attr('tabindex', '-1');
    }

    this.setChangeEvent = function (obj, func) {
        if (obj.jquery) {
            if (typeof func == 'function') {
                obj.find('ul li a').live('click',
                        function (e) {
                            e.preventDefault();
                            setTimeout('func(e)', 50);
                        });
            }
        }
    }

    var multiOptionsToSearch = '';

    function MultiOptionsOnKeyPress(e) {
        if (e) {
            multiOptionsToSearch += String.fromCharCode(e.keyCode);

            if (multiOptionsToSearch) {
                if ($.fn.scrollTo) {
                    for (var i = 0; i < $(this).find('ul li a').length; i++) {

                    }
                    if ($(this).find('ul li a:startWith(' + multiOptionsToSearch + ')').length) {
                        $(this).find('ul').scrollTo($(this).find('ul li a:startWith(' + multiOptionsToSearch + ')').focus());
                    }
                }
            }
            setTimeout(function () {
                multiOptionsToSearch = '';
            }, 1000);
        }
    }

    function OnCheckClick(e) {
        e.preventDefault();

        if (!$(this).hasClass("disabled") && !$(this).hasClass("disable")) {
            $(this).toggleClass('current');

            $(this).trigger("change");
        }
    }

    function OnRadioClick(e) {
        e.preventDefault();

        var name = $(this).attr('name');

        var radios = $('.customradio', $(this).parent().parent());

        var radioFamily = radios.filter(function () { return $(this).attr('name') == name; });

        radioFamily.each(function () { $(this).removeClass('current'); });

        $(this).addClass('current').trigger("change");
    }

    function OnMultiOptionsClick(e) {
        if (!e.OnSelectMultiOptionsItem) {
            e.preventDefault();

            if ($(this).hasClass('clicked')) {
                CloseAllMultiOptions();
            } else {
                ShowMultiOptions($(this));
                $(this).addClass('clicked');
            }
        }
    }

    function OnSelectMultiOptionsItem(e) {
        e.OnSelectMultiOptionsItem = true;

        var disabled = $(this).attr('isdisabled');
        disabled = disabled == "true" ? true : false;

        if (!disabled && !$(this).closest('.multi_options').isDisabled()) {
            e.preventDefault();

            $(this).closest('.multi_options').find('span').text($(this).text());
            var thisList = $('div.multi_options ul').containerOf(this);

            thisList.find('li a').removeClass('current');
            $(this).addClass('current');

            $(this).parents('.multi_options').change().blur();
            CloseAllMultiOptions();
        }
    }

    function ShowMultiOptions(dom) {
        if (!dom.isDisabled()) {
            CloseAllMultiOptions(dom);

            var list = dom.find('ul');
            if (!list.is(":visible") && list.find('li').length)
                list.slideDown('fast');
        }
    }

    this.closeAllMultiOptions = CloseAllMultiOptions;

    function CloseAllMultiOptions(selector) {
        if (selector) {
            $('.multi_options').not(selector).find('ul').slideUp();
        } else {
            $('.multi_options ul').slideUp();
            $('.multi_options').removeClass('clicked');
        }
    }

    function CloseMultiOptions() {
        var _this = this;
        setTimeout(function () {
            if ($(_this)[0] != document.activeElement && $(_this).find(document.activeElement).length == 0)
                $(_this).removeClass('clicked').find('ul').slideUp();
        }, 100);
    }
});


// This file was automatically generated from Resources.soy.
// Please don't edit this file by hand.

if (typeof Resources == 'undefined') { var Resources = {}; }


Resources.translate = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  switch (opt_data.code) {
    case 'AdditionalTaxes':
      output.append('Taxas adicionais');
      break;
    case 'busCompany':
    case 'BusCompany':
      output.append('Cia de Ãnibus');
      break;
    case 'busStops':
    case 'BusStops':
      output.append('Trocas de Ãnibus');
      break;
    case 'FerryTaxes':
      output.append('Taxa de balsa');
      break;
    case 'Hide When Booked':
      output.append('Esconder Quando Booked');
      break;
    case 'InsuranceTaxes':
      output.append('Taxa de seguro');
      break;
    case 'Stretches':
      output.append('Trechos');
      break;
    case 'TollTaxes':
      output.append('Taxa de pedÃ¡gio');
      break;
    case 'TravelNumber':
      output.append('NÃºmero da Viagem');
      break;
    case 'TravelStatus':
      output.append('Status da Viagem');
      break;
    case 'DiningOption':
      output.append('Turno de Jantar');
      break;
    case 'FullPnrEdit':
      output.append('Reserva Completa');
      break;
    case 'DontShareText':
      output.append('NÃ£o Dividir');
      break;
    case 'HotelSpecialInformationText':
      output.append('InformaÃ§Ãµes especiais para o Hotel');
      break;
    case 'above':
      output.append('acima de');
      break;
    case 'Account':
      output.append('Conta');
      break;
    case 'account':
      output.append('conta');
      break;
    case 'address':
      output.append('EndereÃ§o');
      break;
    case 'Addresses':
      output.append('EndereÃ§os');
      break;
    case 'AddressType':
      output.append('Tipo do EndereÃ§o');
      break;
    case 'add':
      output.append('adicionar');
      break;
    case 'Add':
      output.append('Adicionar');
      break;
    case 'Add another person':
      output.append('Adicionar outra pessoa');
      break;
    case 'CarRateCode':
      output.append('Rate Code do VeÃ­culo');
      break;
    case 'CarRental':
      output.append('Locadora de VeÃ­culo');
      break;
    case 'CarPickUpDate':
      output.append('Data de Retirada do Veiculo');
      break;
    case 'CarReturnDate':
      output.append('Data de DevoluÃ§Ã£o do Veiculo');
      break;
    case 'CarPickUpPlace':
      output.append('Local de Retirada do Veiculo');
      break;
    case 'CarReturnPlace':
      output.append('Local de DevoluÃ§Ã£o do Veiculo');
      break;
    case 'Petrol':
      output.append('Gasolina');
      break;
    case 'FullyQualified':
      output.append('Totalmente Qualificado');
      break;
    case 'PartlyQualified':
      output.append('Parcialmente Qualificado ');
      break;
    case 'OtherRates':
      output.append('Outras Taxas');
      break;
    case 'WithAirConditioning':
      output.append('Com Ar Condicionado');
      break;
    case 'WithoutAirConditioning':
      output.append('Sem Ar Condicionado');
      break;
    case 'Administrator':
      output.append('Administrador');
      break;
    case 'Add segment':
      output.append('AdiÃ§Ã£o de segmento');
      break;
    case 'Associated Persons':
      output.append('Pessoas Associadas');
      break;
    case 'Exchange segments':
      output.append('Troca de segmentos');
      break;
    case 'Adult':
      output.append('Adulto');
      break;
    case 'Adults':
      output.append('Adultos');
      break;
    case 'Advanced':
      output.append('Adiantamento');
      break;
    case 'advance':
      output.append('Sinal');
      break;
    case 'afternoon':
    case 'Afternoon':
      output.append('Tarde');
      break;
    case 'airport':
    case 'Airport':
      output.append('Aeroporto');
      break;
    case 'airCompany':
    case 'AirCompany':
      output.append('Cia AÃ©rea');
      break;
    case 'AirCompanies':
      output.append('Cias AÃ©reas');
      break;
    case 'Air':
      output.append('AÃ©reo');
      break;
    case 'BankAccounts':
      output.append('Contas BancÃ¡rias');
      break;
    case 'Identifier':
      output.append('Identificador');
      break;
    case 'BankName':
      output.append('Nome do Banco');
      break;
    case 'AgencyNumber':
      output.append('AgÃªncia');
      break;
    case 'AccountNumber':
      output.append('Conta');
      break;
    case 'air':
      output.append('AÃ©reo');
      break;
    case 'Cruise':
      output.append('Cruzeiro');
      break;
    case 'cruise':
      output.append('Cruzeiro');
      break;
    case 'AirBook':
      output.append('Reserva de AÃ©reo');
      break;
    case 'allAirCias':
      output.append('Todas as Cias AÃ©reas');
      break;
    case 'allPeriod':
      output.append('Qualquer PerÃ­odo');
      break;
    case 'Alter':
      output.append('Alterar');
      break;
    case 'Any':
      output.append('Qualquer');
      break;
    case 'any':
      output.append('qualquer');
      break;
    case 'and':
      output.append('e');
      break;
    case 'Agency':
      output.append('AgÃªncia');
      break;
    case 'as':
      output.append('como');
      break;
    case 'Address':
      output.append('EndereÃ§o');
      break;
    case 'Arrival':
      output.append('Chegada');
      break;
    case 'ArrivalDate':
      output.append('Data da chegada');
      break;
    case 'AssessFareBestPrice':
      output.append('Tarifar Melhor PreÃ§o');
      break;
    case 'AssessFareAll':
      output.append('Tarifar Tudo');
      break;
    case 'AssessFare':
      output.append('Tarifar');
      break;
    case 'Associated':
      output.append('Associada');
      break;
    case 'approvers':
      output.append('Aprovadores');
      break;
    case 'Approver':
      output.append('Aprovador');
      break;
    case 'AssociatedItens':
      output.append('Itens Associados');
      break;
    case 'Benefits':
      output.append('BenefÃ­cios');
      break;
    case 'beneficiaries':
    case 'Beneficiaries':
      output.append('BeneficiÃ¡rios');
      break;
    case 'BookWithPointsSuccess':
      output.append('SolicitaÃ§Ã£o de troca em processamento');
      break;
    case 'Buyer':
      output.append('Contratante');
      break;
    case 'Creator':
      output.append('Criador');
      break;
    case 'Cruising Speed':
      output.append('Velocidade de cruzeiro');
      break;
    case 'Max Beam':
      output.append('Largura mÃ¡xima do casco');
      break;
    case 'Draft':
      output.append('Calado');
      break;
    case 'Width':
      output.append('Largura');
      break;
    case 'Height':
      output.append('Altura');
      break;
    case 'Length':
      output.append('Comprimento');
      break;
    case 'Gross Tonnage':
      output.append('Tonelagem Bruta');
      break;
    case 'Ship Informations':
      output.append('InformaÃ§Ãµes do Navio');
      break;
    case 'Cruise':
      output.append('Cruzeiro');
      break;
    case 'Cruising':
    case 'cruising':
      output.append('Navegando');
      break;
    case 'ClosingInvoiceDay':
      output.append('Dia de Fechamento da Fatura');
      break;
    case 'MaturityInvoiceDay':
      output.append('Dia de Vencimento da Fatura');
      break;
    case 'Consultant':
      output.append('Consultor');
      break;
    case 'CommissionRole':
      output.append('FunÃ§Ã£o do Comissionado');
      break;
    case 'CommissionedName':
      output.append('Nome Comissionado');
      break;
    case 'CommissionGroupName':
      output.append('Grupo de ComissÃ£o');
      break;
    case 'CommissionRangePercent':
      output.append('Porcentagem de ComissÃ£o');
      break;
    case 'Commission':
      output.append('ComissÃ£o');
      break;
    case 'AutomaticCancellationDate':
      output.append('Data Limite');
      break;
    case 'AutomaticCancellationDates':
      output.append('Prazo de Cancelamento no Broker');
      break;
    case 'ApprovedBySystem':
      output.append('Aprovado pelo Sistema');
      break;
    case 'Baby':
      output.append('BebÃª');
      break;
    case 'Babies':
      output.append('BebÃªs');
      break;
    case 'basic':
    case 'Basic':
      output.append('BÃ¡sico');
      break;
    case 'BalancetoPay':
      output.append('Saldo Ã  Pagar');
      break;
    case 'bedType':
      output.append('Tipo cama');
      break;
    case 'BedType':
      output.append('Tipo cama');
      break;
    case 'bestFare':
      output.append('Melhor Tarifa');
      break;
    case 'bestPrice':
      output.append('Melhor PreÃ§o');
      break;
    case 'BillingAddress':
      output.append('EndereÃ§o de CobranÃ§a');
      break;
    case 'birth':
      output.append('nascimento');
      break;
    case 'Birth':
      output.append('Nascimento');
      break;
    case 'BirthDate':
      output.append('Data de Nascimento');
      break;
    case 'Board':
      output.append('Regime');
      break;
    case 'BoardingTax':
      output.append('Taxa de Embarque');
      break;
    case 'book':
      output.append('reserva');
      break;
    case 'Book':
      output.append('Reserva');
      break;
    case 'Booked':
      output.append('Reservado');
      break;
    case 'BookPending':
      output.append('Reserva Pendente');
      break;
    case 'CancelBook':
      output.append('Cancelar Reserva');
      break;
    case 'Queued':
      output.append('Em fila de espera');
      break;
    case 'PendingCancellation':
      output.append('Cancelamento Pendente');
      break;
    case 'Rejected':
      output.append('Rejeitado');
      break;
    case 'TechnicalProblem':
      output.append('Problema TÃ©cnico');
      break;
    case 'advance-payment':
      output.append('Sinal');
      break;
    case 'BookInformations':
      output.append('InformaÃ§Ãµes da Reserva');
      break;
    case 'ItineraryInformations':
      output.append('InformaÃ§Ãµes do Roteiro');
      break;
    case 'bookExpirationDate':
      output.append('Prazo Reserva');
      break;
    case 'Booked':
      output.append('Reservado');
      break;
    case 'BookCreateDate':
      output.append('Data de criaÃ§Ã£o da reserva');
      break;
    case 'BookNumber':
      output.append('NÃºmero da Reserva');
      break;
    case 'Budget':
      output.append('OrÃ§amento');
      break;
    case 'Bus':
      output.append('Ãnibus');
      break;
    case 'budget':
      output.append('orÃ§amento');
      break;
    case 'byPerson':
      output.append('por Pessoa');
      break;
    case 'byperson':
      output.append('por pessoa');
      break;
    case 'BrokenPolicy':
      output.append('PolÃ­tica Quebrada');
      break;
    case 'cabin':
      output.append('cabine');
      break;
    case 'Cabin':
      output.append('Cabine');
      break;
    case 'CabinFare':
      output.append('Valor da cabine');
      break;
    case 'CabinType':
      output.append('Tipo de cabine');
      break;
    case 'CancelationCode':
      output.append('NÃºmero do Cancelamento');
      break;
    case 'CloseDetails':
      output.append('Fechar Detalhes');
      break;
    case 'CNPJOrCPF':
      output.append('CNPJ ou CPF');
      break;
    case 'Equipment':
      output.append('Equipamento');
      break;
    case 'ExchangedCabinFare':
      output.append('Valor da cabine (R$)');
      break;
    case 'Quayage':
      output.append('Taxa portuÃ¡ria');
      break;
    case 'ExchangedQuayage':
      output.append('Taxa portuÃ¡ria (R$)');
      break;
    case 'ServiceTaxesAmount':
      output.append('Taxa de serviÃ§o');
      break;
    case 'ExchangedServiceTaxesAmount':
      output.append('Taxa de serviÃ§o (R$)');
      break;
    case 'GovernamentalTaxesAmount':
      output.append('Taxa governamental');
      break;
    case 'ExchangedGovernamentalTaxesAmount':
      output.append('Taxa governamental (R$)');
      break;
    case 'AmbientalTaxesAmount':
      output.append('Taxa ambiental');
      break;
    case 'ExchangedAmbientalTaxesAmount':
      output.append('Taxa ambiental (R$)');
      break;
    case 'Cancel':
      output.append('Cancelar');
      break;
    case 'cancel':
      output.append('cancelar');
      break;
    case 'Canceled':
    case 'Cancelled':
      output.append('Cancelado');
      break;
    case 'canceled':
    case 'cancelled':
      output.append('cancelado');
      break;
    case 'CancellationRules':
      output.append('Regras de cancelamento');
      break;
    case 'Car':
      output.append('Carro');
      break;
    case 'CarBook':
      output.append('Reserva de Carro');
      break;
    case 'CarCategory':
      output.append('Categoria do Carro');
      break;
    case 'car':
      output.append('carro');
      break;
    case 'Category':
      output.append('Categoria');
      break;
    case 'carType':
      output.append('Tipo de carro');
      break;
    case 'cellphone':
    case 'CellPhone':
      output.append('Celular');
      break;
    case 'cep':
    case 'CEP':
      output.append('CEP');
      break;
    case 'certificate':
    case 'Certificate':
      output.append('Certificado');
      break;
    case 'chainCode':
      output.append('CÃ³digo da Cadeia');
      break;
    case 'Chain':
      output.append('Cadeia');
      break;
    case 'Children':
      output.append('CrianÃ§as');
      break;
    case 'Child':
      output.append('CrianÃ§a');
      break;
    case 'checkInDate':
      output.append('Data Ida');
      break;
    case 'checkOutDate':
      output.append('Data Volta');
      break;
    case 'CheckInDate':
      output.append('Check In');
      break;
    case 'CheckOutDate':
      output.append('Check Out');
      break;
    case 'CheckInTime':
      output.append('HorÃ¡rio CheckIn');
      break;
    case 'CheckOutTime':
      output.append('HorÃ¡rio CheckOut');
      break;
    case 'city':
      output.append('cidade');
      break;
    case 'City':
      output.append('Cidade');
      break;
    case 'Close':
      output.append('Fechar');
      break;
    case 'Client':
      output.append('Cliente');
      break;
    case 'client':
      output.append('cliente');
      break;
    case 'ClientArea':
      output.append('Ãrea do Cliente');
      break;
    case 'ClientType':
      output.append('Tipo do Cliente');
      break;
    case 'ConcatenatedPassportNumbers':
      output.append('Passportes');
      break;
    case 'Contact':
      output.append('Contato');
      break;
    case 'contact':
      output.append('contato');
      break;
    case 'contactInformation':
      output.append('InformaÃ§Ãµes de contato');
      break;
    case 'corporate':
      output.append('Pessoa JurÃ­dica');
      break;
    case 'ConfirmBeforeExclude':
      output.append('Deseja realmente excluir este registro?');
      break;
    case 'Copy':
      output.append('Copiar');
      break;
    case 'Copy to my account':
      output.append('Copiar Para Minha Conta');
      break;
    case 'currency':
      output.append('Moeda');
      break;
    case 'code':
      output.append('CÃ³digo');
      break;
    case 'Currency':
      output.append('Moeda');
      break;
    case 'currency':
      output.append('moeda');
      break;
    case 'Comments':
      output.append('ComentÃ¡rios');
      break;
    case 'CommercialAgrement':
      output.append('Acordo Comercial');
      break;
    case 'InsuranceCompany':
      output.append('Seguradora');
      break;
    case 'Company':
      output.append('Empresa');
      break;
    case 'company':
      output.append('empresa');
      break;
    case 'companyContext':
      output.append('Contexto da companhia');
      break;
    case 'CompanyDirectory':
      output.append('DiretÃ³ria da Empresa');
      break;
    case 'Complement':
      output.append('Complemento');
      break;
    case 'ConfirmationDate':
      output.append('Data da confirmaÃ§Ã£o');
      break;
    case 'Consolidator(fem)':
      output.append('Consolidadora');
      break;
    case 'consolidator(fem)':
      output.append('consolidadora');
      break;
    case 'ContactName':
      output.append('Nome para contato');
      break;
    case 'Context':
      output.append('Contexto');
      break;
    case 'CostCenter':
      output.append('Centro de Custo');
      break;
    case 'Costcenter':
      output.append('Centro de custo');
      break;
    case 'Corporate':
      output.append('Corporativo');
      break;
    case 'Country':
      output.append('PaÃ­s');
      break;
    case 'couple':
      output.append('Casal');
      break;
    case 'Create':
      output.append('Criar');
      break;
    case 'create':
      output.append('criar');
      break;
    case 'CreateInsurancePolicy':
      output.append('Gerar ApÃ³lice');
      break;
    case 'daily':
      output.append('DiÃ¡ria');
      break;
    case 'Dailies':
      output.append('DiÃ¡rias');
      break;
    case 'DailyFare':
      output.append('DiÃ¡ria');
      break;
    case 'DailyFares':
      output.append('DiÃ¡rias');
      break;
    case 'DailyTax':
      output.append('Taxa');
      break;
    case 'DailyTaxes':
      output.append('Taxas');
      break;
    case 'Day':
      output.append('Dia');
      break;
    case 'Days':
      output.append('Dias');
      break;
    case 'Debark':
    case 'debark':
      output.append('Desembarque');
      break;
    case 'DaysCount':
      output.append('Qtd. de DiÃ¡rias');
      break;
    case 'DeckNumber':
      output.append('NÃºmero do deck');
      break;
    case 'Description':
      output.append('DescriÃ§Ã£o');
      break;
    case 'dawn':
    case 'Dawn':
      output.append('Madrugada');
      break;
    case 'DelayInformation':
      output.append('Info. Atrasos');
      break;
    case 'deleteAll':
      output.append('Deletar todos');
      break;
    case 'Departure':
      output.append('SaÃ­da');
      break;
    case 'Destination':
      output.append('Destino');
      break;
    case 'destination':
      output.append('destino');
      break;
    case 'Destinations':
      output.append('Destinos');
      break;
    case 'Details':
      output.append('Detalhes');
      break;
    case 'devolution':
      output.append('DevoluÃ§Ã£o');
      break;
    case 'Devolution':
      output.append('DevoluÃ§Ã£o');
      break;
    case 'devolutionCity':
      output.append('Cidade de DevoluÃ§Ã£o');
      break;
    case 'DevolutionCity':
      output.append('Cidade de DevoluÃ§Ã£o');
      break;
    case 'devolutionDate':
      output.append('Data DevoluÃ§Ã£o');
      break;
    case 'DevolutionDate':
      output.append('Data DevoluÃ§Ã£o');
      break;
    case 'devolutionSpot':
      output.append('Local de DevoluÃ§Ã£o');
      break;
    case 'DevolutionSpot':
      output.append('Local de DevoluÃ§Ã£o');
      break;
    case 'devolutionPeriod':
      output.append('PerÃ­odo DevoluÃ§Ã£o');
      break;
    case 'DevolutionPeriod':
      output.append('PerÃ­odo DevoluÃ§Ã£o');
      break;
    case 'directFligth':
      output.append('Voo Direto');
      break;
    case 'Discount':
    case 'discount':
      output.append('Desconto');
      break;
    case 'DiscountCoupon':
      output.append('Desconto');
      break;
    case 'discountCoupon':
      output.append('Desconto');
      break;
    case 'discountcoupon':
      output.append('Desconto');
      break;
    case 'district':
    case 'District':
      output.append('Bairro');
      break;
    case 'doubleBed':
      output.append('Casal');
      break;
    case 'Docked':
    case 'docked':
      output.append('Ancorado');
      break;
    case 'Du':
      output.append('Rep. a terceiros');
      break;
    case 'Duration':
      output.append('DuraÃ§Ã£o');
      break;
    case 'DynamicPackage':
      output.append('Pacotes');
      break;
    case 'Economic':
    case 'economic':
      output.append('EconÃ´mica');
      break;
    case 'EconomicCar':
    case 'economicCar':
      output.append('EconÃ´mico');
      break;
    case 'PremiumEconomy':
      output.append('EconÃ´mica Premium');
      break;
    case 'edit':
      output.append('editar');
      break;
    case 'Edit':
    case 'Edit ':
      output.append('Editar');
      break;
    case 'EmergencyContactDDD':
    case 'emergencycontactDDD':
      output.append('DDD do contato de emergÃªncia');
      break;
    case 'EmergencyContactName':
    case 'emergencycontactname':
      output.append('Nome do contato de emergÃªncia');
      break;
    case 'EmergencyContactPhoneNumber':
    case 'emergencycontactphonenumber':
      output.append('Telefone do contato de emergÃªncia');
      break;
    case 'EmissionDate':
    case 'emissiondate ':
      output.append('Data de emissÃ£o');
      break;
    case 'Embark':
    case 'embark':
      output.append('Embarque');
      break;
    case 'eTicket':
      output.append('E-ticket');
      break;
    case 'EventualTraveller':
      output.append('Viajante Eventual');
      break;
    case 'save':
      output.append('salvar');
      break;
    case 'Save':
      output.append('Salvar');
      break;
    case 'Exchange':
      output.append('Permuta');
      break;
    case 'ExchangeCurrency':
      output.append('CÃ¢mbio');
      break;
    case 'ExchangeRate':
      output.append('Valor cÃ¢mbio');
      break;
    case 'ExchangeRate':
      output.append('Valor convertido');
      break;
    case 'Exclude':
      output.append('Excluir');
      break;
    case 'exclude':
      output.append('excluir');
      break;
    case 'Executive':
      output.append('Executiva ***');
      break;
    case 'Business_Class':
      output.append('Business');
      break;
    case 'executive':
      output.append('executiva');
      break;
    case 'ExecutiveCar':
    case 'executiveCar':
      output.append('Executivo');
      break;
    case 'external':
      output.append('externo');
      break;
    case 'External':
      output.append('Externo');
      break;
    case 'ExternalId':
      output.append('Id Externo');
      break;
    case 'fare':
      output.append('tarifa');
      break;
    case 'Fare':
      output.append('Tarifa');
      break;
    case 'FareDetails':
      output.append('Detalhes das Tarifa');
      break;
    case 'fares':
      output.append('tarifa');
      break;
    case 'Fares':
      output.append('Tarifa');
      break;
    case 'female':
      output.append('feminino');
      break;
    case 'Female':
      output.append('Feminino');
      break;
    case 'FileName':
      output.append('Nome Arquivo');
      break;
    case 'FiltersApplied':
      output.append('Filtros Aplicados');
      break;
    case 'Finalize':
      output.append('Finalizar');
      break;
    case 'First':
      output.append('Primeiro');
      break;
    case 'First(fem)':
      output.append('Primeira');
      break;
    case 'FirstClass':
    case 'firstClass':
      output.append('1Âª Classe');
      break;
    case 'FirstName':
    case 'firstName':
      output.append('Nome');
      break;
    case 'Flights':
      output.append('Voos');
      break;
    case 'Flight':
      output.append('Voo');
      break;
    case 'FlightNumber':
      output.append('NÃºmero Voo');
      break;
    case 'flightSelected':
      output.append('voo selecionado');
      break;
    case 'flightsSelecteds':
      output.append('voos selecionados');
      break;
    case 'FlightStop':
      output.append('Escala');
      break;
    case 'FlightStops':
      output.append('Escalas');
      break;
    case 'FlightTicket':
      output.append('Passagem AÃ©rea');
      break;
    case 'Franchised(fem)':
      output.append('Franquiada');
      break;
    case 'FreeNightPromoCodes':
      output.append('CÃ³digos de FreeNight');
      break;
    case 'FrequentFlyerCards':
      output.append('Programa de milhagem');
      break;
    case 'from':
      output.append('de');
      break;
    case 'From':
      output.append('De');
      break;
    case 'Gender':
      output.append('Sexo');
      break;
    case 'Gear':
      output.append('Equipamento');
      break;
    case 'Getpayments':
      output.append('Buscar pagamentos');
      break;
    case 'GetPaymentForms':
      output.append('Buscar formas de pagamento');
      break;
    case 'going':
      output.append('Ida');
      break;
    case 'Guarantee':
      output.append('Garantia');
      break;
    case 'Guests':
      output.append('HÃ³spedes');
      break;
    case 'guests':
      output.append('hÃ³spedes');
      break;
    case 'Guest':
      output.append('HÃ³spede');
      break;
    case 'guest':
      output.append('hÃ³spede');
      break;
    case 'oftheguest':
      output.append(' do hÃ³spede ');
      break;
    case 'hasVip':
      output.append('Possui Passageiro Vip');
      break;
    case 'Hide':
      output.append('Esconder');
      break;
    case 'HideRooms':
      output.append('Esconder Quartos');
      break;
    case 'horizontalPlural':
      output.append('Horizontais');
      break;
    case 'hotel':
      output.append('hotel');
      break;
    case 'Hotel':
      output.append('Hotel');
      break;
    case 'HotelBook':
      output.append('Reserva de Hotel');
      break;
    case 'Hotels':
      output.append('HotÃ©is');
      break;
    case 'hotelName':
      output.append('Nome do Hotel');
      break;
    case 'hotelGuarantee':
      output.append('Tipo Garantia');
      break;
    case 'Id':
    case 'id':
      output.append('Id');
      break;
    case 'Identificator':
      output.append('Identificador');
      break;
    case 'Inbound terminal':
      output.append('Terminal de chegada');
      break;
    case 'IncludedIn':
      output.append('IncluÃ­do');
      break;
    case 'IncludeSelectedInsurance':
      output.append('Incluir este seguro na reserva');
      break;
    case 'individual':
      output.append('Pessoa FÃ­sica');
      break;
    case 'individuallPlural':
      output.append('Individuais');
      break;
    case 'integrationProperties':
    case 'IntegrationProperties':
      output.append('Dados de IntegraÃ§Ã£o');
      break;
    case 'intermediary':
    case 'Intermediary':
      output.append('IntermediÃ¡rio');
      break;
    case 'Insert':
      output.append('Inserir');
      break;
    case 'insurance':
    case 'Insurance':
      output.append('Seguro');
      break;
    case 'map':
    case 'Map':
      output.append('Mapa');
      break;
    case 'calendar':
    case 'Calendar':
      output.append('CalendÃ¡rio');
      break;
    case 'Issued':
    case 'issued':
      output.append('Emitido');
      break;
    case 'Refunded':
    case 'refunded':
      output.append('Reembolsado');
      break;
    case 'Flown':
    case 'flown':
      output.append('Voado');
      break;
    case 'Item':
      output.append('Item');
      break;
    case 'Last':
      output.append('Ãltimo');
      break;
    case 'Last(fem)':
      output.append('Ãltima');
      break;
    case 'LastInterationDate':
      output.append('Data Ãltima InteraÃ§Ã£o');
      break;
    case 'AssignedTo':
      output.append('Atribuido Ã ');
      break;
    case 'Interations':
      output.append('InteraÃ§Ãµes');
      break;
    case 'Priority':
      output.append('Prioridade');
      break;
    case 'ActivityPriority_Emergency':
      output.append('Emergencial');
      break;
    case 'ActivityPriority_High':
      output.append('Alto');
      break;
    case 'ActivityPriority_Medium':
      output.append('MÃ©dio');
      break;
    case 'ActivityPriority_Low':
      output.append('Baixo');
      break;
    case 'DeadLine':
      output.append('Prazo');
      break;
    case 'EndedDate':
      output.append('Finalizado Em');
      break;
    case 'LastName':
      output.append('Ãltimo Nome');
      break;
    case 'BookingName':
      output.append('Nome da Reserva no Fornecedor');
      break;
    case 'level':
      output.append('NÃ­vel');
      break;
    case 'Loading':
      output.append('Carregando');
      break;
    case 'male':
      output.append('masculino');
      break;
    case 'Male':
      output.append('Masculino');
      break;
    case 'MaritalStatus':
    case 'maritalstatus':
      output.append('Estado civil');
      break;
    case 'MealPlan':
      output.append('Plano de refeiÃ§Ã£o');
      break;
    case 'ManagementFields':
      output.append('Campos Gerenciais');
      break;
    case 'ManagementFields_NotFound':
      output.append('Campos Gerenciais nÃ£o encontrados!');
      break;
    case 'Mstr':
      output.append('Sr');
      break;
    case 'Miss':
    case 'MISS':
      output.append('Srta');
      break;
    case 'middlename':
      output.append('nome do meio');
      break;
    case 'Middlename':
    case 'MiddleName':
      output.append('Nome do meio');
      break;
    case 'monthlyincome':
    case 'MonthlyIncome':
      output.append('Renda mensal');
      break;
    case 'mr':
    case 'MR':
      output.append('Sr');
      break;
    case 'mrs':
    case 'MRS':
      output.append('Sra');
      break;
    case 'moreFlights':
      output.append('Mais Voos');
      break;
    case 'morning':
    case 'Morning':
      output.append('ManhÃ£');
      break;
    case 'MyOrders':
      output.append('Meus Pedidos');
      break;
    case 'OrderNumber':
      output.append('NÃºmero do pedido');
      break;
    case 'Name':
      output.append('Nome');
      break;
    case 'Neighborhood':
      output.append('Bairro');
      break;
    case 'Next':
      output.append('PrÃ³ximo');
      break;
    case 'Next(fem)':
      output.append('PrÃ³xima');
      break;
    case 'next':
      output.append('prÃ³ximo');
      break;
    case 'NewServiceItem':
      output.append('Novo item de serviÃ§o');
      break;
    case 'night':
    case 'Night':
      output.append('Noite');
      break;
    case 'DoNoGroup':
      output.append('NÃ£o Agrupar');
      break;
    case 'NoHotelSelected':
      output.append('Nenhum hotel selecionado');
      break;
    case 'Not':
      output.append('NÃ£o');
      break;
    case 'NotInformed':
      output.append('NÃ£o Informado');
      break;
    case 'noSelection':
      output.append('Nenhuma SeleÃ§Ã£o');
      break;
    case 'NoFlightSelected':
      output.append('Nenhum voo selecionado');
      break;
    case 'notChoiceMyair':
      output.append('NÃO QUERO ESCOLHER MEU VOO');
      break;
    case 'notChoiceMyhotel':
      output.append('NÃO QUERO ESCOLHER MEU HOTEL');
      break;
    case 'notChoiceMyFlight':
      output.append('NÃO QUERO ESCOLHER MEU VOO');
      break;
    case 'NotIncluded':
      output.append('NÃ£o incluÃ­do');
      break;
    case 'NotFound':
      output.append('Nenhum resultado encontrado');
      break;
    case 'Number':
    case 'number':
      output.append('NÃºmero');
      break;
    case 'NumberSymbol':
      output.append('NÂº');
      break;
    case 'NumberOfStops':
      output.append('Escalas');
      break;
    case 'NumberOfDays':
      output.append('Noites');
      break;
    case 'NoPaymentAutomaticCancellationDate':
      output.append('Sem Pagamentos');
      break;
    case 'NoStops':
      output.append('Sem Escalas');
      break;
    case 'Observation':
      output.append('ObservaÃ§Ã£o');
      break;
    case 'Observations':
      output.append('ObservaÃ§Ãµes');
      break;
    case 'occupation':
    case 'Occupation':
      output.append('ProfissÃ£o');
      break;
    case 'of':
      output.append('de');
      break;
    case 'years':
      output.append('anos');
      break;
    case 'ofthe(fem)':
      output.append('da');
      break;
    case 'onlyDirectFlights':
      output.append('Somente voos diretos');
      break;
    case 'OpenRooms':
      output.append('Ver quartos');
      break;
    case 'Operator':
      output.append('Operador(a)');
      break;
    case 'orderBy':
      output.append('ordenar Por');
      break;
    case 'OrderBy':
      output.append('Ordenar Por');
      break;
    case 'OrderDetails':
      output.append('Detalhes do Pedido');
      break;
    case 'Origin':
      output.append('Origem');
      break;
    case 'origin':
      output.append('origem');
      break;
    case 'Other':
      output.append('Outro');
      break;
    case 'other':
      output.append('outro');
      break;
    case 'Other options':
      output.append('Outras opÃ§Ãµes');
      break;
    case 'ofthepassenger':
      output.append(' do passageiro ');
      break;
    case 'Outbound terminal':
      output.append('Terminal de saÃ­da');
      break;
    case 'Package':
      output.append('Pacote');
      break;
    case 'Pages':
      output.append('PÃ¡ginas');
      break;
    case 'passenger':
      output.append('passageiro');
      break;
    case 'Passenger':
      output.append('Passageiro');
      break;
    case 'Passengers':
      output.append('Passageiros');
      break;
    case 'passengerAdditionalData':
      output.append('InformaÃ§Ãµes dos Passageiros');
      break;
    case 'Password':
      output.append('Senha');
      break;
    case 'Pasture':
      output.append('Logradouro');
      break;
    case 'Payment':
      output.append('Pagamento');
      break;
    case 'payment':
      output.append('pagamento');
      break;
    case 'Payments':
      output.append('Pagamentos');
      break;
    case 'payment':
      output.append('pagamentos');
      break;
    case 'passengers':
      output.append('passageiros');
      break;
    case 'period':
      output.append('perÃ­odo');
      break;
    case 'Period':
      output.append('PerÃ­odo');
      break;
    case 'PermissionGroup':
      output.append('Grupo de PermissÃ£o');
      break;
    case 'PendingPayment':
    case 'pendingPayment':
    case 'pendingpayment':
      output.append('Pagamento Pendente');
      break;
    case 'Person':
      output.append('Pessoa');
      break;
    case 'People':
      output.append('Pessoas');
      break;
    case 'Phone':
      output.append('Telefone');
      break;
    case 'phone':
      output.append('telefone');
      break;
    case 'Plan':
      output.append('Plano');
      break;
    case 'plan':
      output.append('Plano');
      break;
    case 'Prefered':
      output.append('Preferencial');
      break;
    case 'Previous':
      output.append('Anterior');
      break;
    case 'previous':
      output.append('anterior');
      break;
    case 'Time':
      output.append('HorÃ¡rio');
      break;
    case 'Price':
      output.append('PreÃ§o');
      break;
    case 'PriceByPerson':
      output.append('PreÃ§o por Pessoa');
      break;
    case 'Search price':
    case 'Search Price':
      output.append('Buscar PreÃ§o');
      break;
    case 'Print':
      output.append('Imprimir');
      break;
    case 'ViewPrint':
      output.append('Visualizar ImpressÃ£o');
      break;
    case 'print':
      output.append('imprimir');
      break;
    case 'Policy':
      output.append('PolÃ­tica');
      break;
    case 'PolicyId':
      output.append('Identificador da PolÃ­tica');
      break;
    case 'PolicyCode':
      output.append('CÃ³digo da PolÃ­tica');
      break;
    case 'PolicyName':
      output.append('Nome da PolÃ­tica');
      break;
    case 'PolicyDescription':
      output.append('DescriÃ§Ã£o da PolÃ­tica');
      break;
    case 'PolicyIdentification':
      output.append('ApÃ³lice de seguro');
      break;
    case 'PolicyReasonDescription':
      output.append('DescriÃ§Ã£o da Justificativa');
      break;
    case 'ProductCode':
      output.append('CÃ³digo do Produto');
      break;
    case 'ProductName':
      output.append('Nome do produto');
      break;
    case 'Quotation':
      output.append('CotaÃ§Ã£o');
      break;
    case 'quotation':
      output.append('cotaÃ§Ã£o');
      break;
    case 'qtdofparcels':
    case 'QtdOfParcels':
      output.append('Qtde. de parcelas');
      break;
    case 'ReassessFare':
      output.append('Retarifar');
      break;
    case 'Reason':
      output.append('Justificativa');
      break;
    case 'ReasonCodeId':
      output.append('Identificador da Justificativa');
      break;
    case 'Record':
      output.append('Cadastro');
      break;
    case 'RemoveFile':
      output.append('Remover Arquivo');
      break;
    case 'Request':
      output.append('Solicitar');
      break;
    case 'Requester':
      output.append('Solicitante');
      break;
    case 'requester':
      output.append('solicitante');
      break;
    case 'Register':
      output.append('Cadastrar');
      break;
    case 'RegisteredTraveller':
      output.append('Viajante Cadastrado');
      break;
    case 'removal':
      output.append('Retirada');
      break;
    case 'removalCity':
      output.append('Cidade de Retirada');
      break;
    case 'RemovalCity':
      output.append('Cidade de Retirada');
      break;
    case 'removalDate':
      output.append('Data Retirada');
      break;
    case 'RemovalDate':
      output.append('Data Retirada');
      break;
    case 'removalSpot':
      output.append('Local de Retirada');
      break;
    case 'RemovalSpot':
      output.append('Local de Retirada');
      break;
    case 'removalPeriod':
      output.append('PerÃ­odo Retirada');
      break;
    case 'replaced':
    case 'Replaced':
      output.append('SubstituÃ­do');
      break;
    case 'rental':
      output.append('locadora');
      break;
    case 'RentalName':
      output.append('Nome Locadora');
      break;
    case 'Rental':
      output.append('Locadora');
      break;
    case 'Resolve':
      output.append('Resolver');
      break;
    case 'Responsible':
      output.append('ResponsÃ¡vel');
      break;
    case 'ResultType':
      output.append('Tipo de Resultado');
      break;
    case 'RetainedCommission':
      output.append('ComissÃ£o Retida');
      break;
    case 'Retract':
      output.append('Recolher');
      break;
    case 'FranchiseDiscount':
      output.append('Desconto Franquia');
      break;
    case 'franchisediscount':
      output.append('Desconto Franquia');
      break;
    case 'LetterOfCredit':
      output.append('Carta de crÃ©dito');
      break;
    case 'letterOfCredit':
      output.append('Carta de crÃ©dito');
      break;
    case 'PaymentLink':
      output.append('Link de Pagamento');
      break;
    case 'paymentLink':
      output.append('Link de Pagamento');
      break;
    case 'paymentlink':
      output.append('Link de Pagamento');
      break;
    case 'PayPal':
      output.append('PayPal');
      break;
    case 'paypal':
      output.append('PayPal');
      break;
    case 'payPal':
      output.append('PayPal');
      break;
    case 'RIF':
      output.append('RIF');
      break;
    case 'Rooms':
      output.append('Quartos');
      break;
    case 'rooms':
      output.append('quartos');
      break;
    case 'room':
      output.append('quarto');
      break;
    case 'Room':
      output.append('Quarto');
      break;
    case 'RoomType':
      output.append('Tipo de quarto');
      break;
    case 'RoomDescription':
      output.append('DescriÃ§Ã£o do Quarto');
      break;
    case 'RoomGuarantee':
      output.append('Garantia do Quarto');
      break;
    case 'RoundPoints':
      output.append('Arredondar pontos');
      break;
    case 'Save':
      output.append('Salvar');
      break;
    case 'searchByPrice':
      output.append('Pesquisar por preÃ§o');
      break;
    case 'Seat':
      output.append('Assento');
      break;
    case 'selectPaymentForm':
      output.append('Selecionar forma de pagamento');
      break;
    case 'selectAdditionalPaymentForm':
      output.append('Selecionar a forma de pagamento complementar da SubstituiÃ§Ã£o');
      break;
    case 'PaymentForm':
      output.append('Forma de Pagamento');
      break;
    case 'Send':
      output.append('Enviar');
      break;
    case 'sendByEmail':
      output.append('Enviar por e-mail');
      break;
    case 'SendEmailPassword':
      output.append('Enviar senha por e-mail');
      break;
    case 'OptionSelect':
      output.append('Selecione');
      break;
    case 'Select':
      output.append('Selecionar');
      break;
    case 'select':
      output.append('selecionar');
      break;
    case 'Selected':
      output.append('Selecionado');
      break;
    case 'selected':
      output.append('selecionado');
      break;
    case 'SelectedsFem':
      output.append('Selecionadas');
      break;
    case 'selectMyFlight':
      output.append('SELECIONAR MEU VOO');
      break;
    case 'select':
      output.append('selecionar');
      break;
    case 'ServiceTax':
      output.append('Taxa de ServiÃ§o');
      break;
    case 'serviceItem':
      output.append('Item de serviÃ§o');
      break;
    case 'sex':
    case 'Sex':
      output.append('Sexo');
      break;
    case 'ShowFile':
      output.append('Abrir Arquivo');
      break;
    case 'ShowMore':
      output.append('Veja mais');
      break;
    case 'ShowMoreRooms':
      output.append('Mostrar mais quartos');
      break;
    case 'single':
      output.append('Solteiro');
      break;
    case 'singleRoom':
      output.append('1 Viajante');
      break;
    case 'doubleRoom':
      output.append('2 Viajantes');
      break;
    case 'tripleRoom':
      output.append('3 Viajantes');
      break;
    case 'SplitPayments':
      output.append('Dividir Pagamento');
      break;
    case 'Street':
      output.append('Logradouro');
      break;
    case 'street':
      output.append('logradouro');
      break;
    case 'stretchAdd':
      output.append('Adicionar trecho');
      break;
    case 'stretchMultiDestination':
      output.append('Multi-Trechos');
      break;
    case 'Multidestination':
      output.append('Multitrechos');
      break;
    case 'MultiDestination':
      output.append('Multitrechos');
      break;
    case 'stretchOneWay':
      output.append('Somente Ida');
      break;
    case 'stretchRoundTrip':
      output.append('Ida e Volta');
      break;
    case 'stretchRemove':
      output.append('Remover trecho');
      break;
    case 'Stop':
      output.append('Parada');
      break;
    case 'Stops':
      output.append('Paradas');
      break;
    case 'store':
    case 'Store':
      output.append('Loja');
      break;
    case 'Surname':
      output.append('Sobrenome');
      break;
    case 'superior':
    case 'Superior':
      output.append('Superior');
      break;
    case 'SearchOf':
      output.append('Pesquisa de');
      break;
    case 'ServiceItem':
      output.append('Item de ServiÃ§o');
      break;
    case 'ServiceOrder':
      output.append('Ordem de ServiÃ§o');
      break;
    case 'Services':
      output.append('ServiÃ§os');
      break;
    case 'services':
      output.append('serviÃ§os');
      break;
    case 'selectedHotel':
      output.append('hotel selecionado');
      break;
    case 'selectedsHotels':
      output.append('hoteis selecionados');
      break;
    case 'SettingName':
      output.append('Nome Setting');
      break;
    case 'SettingValue':
      output.append('Valor Setting');
      break;
    case 'Source':
      output.append('Sistema');
      break;
    case 'Spreadsheet':
      output.append('Planilha');
      break;
    case 'ShipName':
      output.append('Nome do navio');
      break;
    case 'ShowRooms':
      output.append('Mostrar Quartos');
      break;
    case 'SystemAccount':
      output.append('Conta de Sistema');
      break;
    case 'SystemAccount_Sucessfull_Create':
      output.append('Conta de Sistema Criada com Sucesso');
      break;
    case 'Taxes':
      output.append('Taxas');
      break;
    case 'taxes':
      output.append('taxas');
      break;
    case 'Taxes and Rates':
      output.append('Impostos e Taxas');
      break;
    case 'TaxAmount':
      output.append('Taxa');
      break;
    case 'TaxAmountExchanged':
      output.append('Taxa equivalente');
      break;
    case 'taxesToPay':
      output.append('Taxas a pagar');
      break;
    case 'TemplateTester_ViewData':
      output.append('Visualizar Dados');
      break;
    case 'TemplateTester_IdServiceItem_Label':
      output.append('Id do Item de ServiÃ§o');
      break;
    case 'TemplateTester_ViewTemplate':
      output.append('Testar Template');
      break;
    case 'Tendered':
    case 'tendered':
      output.append('Barco Auxiliar');
      break;
    case 'ticketNumber':
    case 'NÃºmero do Bilhete':
      output.append('NÃºmero do Bilhete');
      break;
    case 'ticketStatus':
      output.append('Status do Bilhete');
      break;
    case 'tickettype':
    case 'TicketType':
    case 'ticketType':
    case 'Tickettype':
      output.append('Tipo (Ingresso)');
      break;
    case 'TrainTicketType':
      output.append('Tipo de ingresso (Trem)');
      break;
    case 'Type':
      output.append('Tipo');
      break;
    case 'to':
      output.append('para');
      break;
    case 'To':
      output.append('Para');
      break;
    case 'ToBook':
      output.append('Reservar');
      break;
    case 'totalInAdvanced':
      output.append('Total Adiantado');
      break;
    case 'total':
      output.append('total');
      break;
    case 'Total':
      output.append('Total');
      break;
    case 'TotalPayedValue':
      output.append('Total Pago no Fornecedor');
      break;
    case 'TravelInsurance':
      output.append('Seguro Viagem');
      break;
    case 'TotalAmount':
      output.append('Total');
      break;
    case 'TotalAmountExchanged':
      output.append('Total equivalente');
      break;
    case 'TotalMarkupAmount':
      output.append('Total de Margem');
      break;
    case 'TotalFares':
      output.append('Tarifa Total');
      break;
    case 'TotalTaxes':
      output.append('Total de Taxas');
      break;
    case 'Tour':
      output.append('Circuito');
      break;
    case 'tour':
      output.append('circuito');
      break;
    case 'Tours':
      output.append('Circuitos');
      break;
    case 'tours':
      output.append('circuitos');
      break;
    case 'TourName':
      output.append('Nome do circuito');
      break;
    case 'TravelReason':
      output.append('Motivo de Viagem');
      break;
    case 'NewTraveller':
      output.append('Novo Viajante...');
      break;
    case 'Traveller':
      output.append('Viajante');
      break;
    case 'Travellers':
      output.append('Viajantes');
      break;
    case 'twinBed':
      output.append('Solteiro');
      break;
    case 'Terms And Conditions':
      output.append('Termos e CondiÃ§Ãµes');
      break;
    case 'until':
      output.append('atÃ©');
      break;
    case 'update':
      output.append('atualizar');
      break;
    case 'Update':
      output.append('Atualizar');
      break;
    case 'UpdatingFare':
      output.append('Atualizando Tarifa');
      break;
    case 'up_to':
      output.append('atÃ©');
      break;
    case 'User':
      output.append('UsuÃ¡rio');
      break;
    case 'UserName':
      output.append('Nome de usuÃ¡rio');
      break;
    case 'userRequester':
      output.append('UsuÃ¡rio Solicitante');
      break;
    case 'Validated':
      output.append('Validado');
      break;
    case 'Validate':
      output.append('Validade');
      break;
    case 'Value':
      output.append('Valor');
      break;
    case 'Valuepay':
      output.append('Valor pago');
      break;
    case 'valueToPay':
      output.append('Valor a pagar');
      break;
    case 'verticallPlural':
      output.append('Verticais');
      break;
    case 'vipHeader':
      output.append('Vip');
      break;
    case 'Visualization':
      output.append('VisualizaÃ§Ã£o');
      break;
    case 'visualization':
      output.append('visualizaÃ§Ã£o');
      break;
    case 'View':
      output.append('Visualizar');
      break;
    case 'Wait':
      output.append('Aguarde');
      break;
    case 'WaitingNumber':
    case 'waitingNumber':
    case 'waitingnumber':
      output.append('Aguardando NÃºmeraÃ§Ã£o');
      break;
    case 'windows':
      output.append('janelas');
      break;
    case 'Windows':
      output.append('Janelas');
      break;
    case 'Without':
      output.append('Sem');
      break;
    case 'WorkGroup':
      output.append('Grupo de Atendimento');
      break;
    case 'WithoutMeal':
      output.append('Sem RefeiÃ§Ã£o');
      break;
    case 'year':
      output.append('ano');
      break;
    case 'years':
      output.append('anos');
      break;
    case 'ZipCode':
      output.append('Cep');
      break;
    case 'TicketsPendings':
      output.append('Bilhetes Pendentes');
      break;
    case 'TicketsInfo':
      output.append('InformaÃ§Ãµes de Bilhetes');
      break;
    case 'MCOInfo':
      output.append('InformaÃ§Ãµes do EMD');
      break;
    case 'TicketPayment':
      output.append('Pagamento do Bilhete');
      break;
    case 'SummaryIssue':
      output.append('Resumo da EmissÃ£o');
      break;
    case 'NotCharged':
      output.append('NÃ£o cobrado');
      break;
    case 'Charged':
      output.append('Cobrado');
      break;
    case 'Exempted':
      output.append('Isento');
      break;
    case 'ChargedBack':
      output.append('Cancelado');
      break;
    case 'CartÃ£o Fidelidade':
      output.append('CartÃ£o Fidelidade');
      break;
    case 'CreditCard':
    case 'creditcard':
    case 'CartÃ£o de CrÃ©dito':
    case 'CreditCardPayment':
      output.append('CartÃ£o de crÃ©dito');
      break;
    case 'Invoice':
    case 'invoice':
      output.append('Faturado');
      break;
    case 'invoice':
    case 'replacement':
      output.append('SubstituiÃ§Ã£o');
      break;
    case 'RefundPayment':
    case 'refundpayment':
      output.append('Reembolso');
      break;
    case 'SupplierCreditPayment':
    case 'suppliercreditpayment':
      output.append('CrÃ©dito no Fornecedor');
      break;
    case 'CreditCardInvoice':
    case 'creditcardinvoice':
      output.append('Faturado + CartÃ£o');
      break;
    case 'GovernmentAgency':
    case 'governmentagency':
      output.append('AgÃªncia governamental');
      break;
    case 'CreditCardRegistered':
    case 'creditcardregistered':
      output.append('CartÃµes de crÃ©dito cadastrados');
      break;
    case 'reimbursement':
      output.append('reembolso');
      break;
    case 'Reimbursement':
      output.append('Reembolso');
      break;
    case 'InvoicePayment':
    case 'invoicepayment':
      output.append('Pagamento Faturado');
      break;
    case 'AirSeatBook':
    case 'airseatBook':
      output.append('Assento');
      break;
    case 'Pago':
    case 'pago':
      output.append('Pago');
      break;
    case 'Processing':
    case 'InWorking':
      output.append('Processando');
      break;
    case 'Completed':
    case 'Complete':
      output.append('Completo');
      break;
    case 'CompletedWithError':
    case 'CompleteWithError':
      output.append('Completo com erros');
      break;
    case 'Concierge':
      output.append('Concierge');
      break;
    case 'blockedPolicy':
      output.append('A quebra desta polÃ­tica nÃ£o permite a finalizaÃ§Ã£o da requisiÃ§Ã£o.');
      break;
    case 'Points':
      output.append('Fidelidade');
      break;
    case 'points':
      output.append('Fidelidade');
      break;
    case 'InsufficientFunds':
      output.append('Saldo insuficiente');
      break;
    case 'InsufficientFundsPartialPaymentPossible':
      output.append('Saldo insuficiente para pagamento total. Ã possÃ­vel apenas o pagamento parcial');
      break;
    case 'CPFNotFound':
      output.append('CPF nÃ£o encontrado');
      break;
    case 'PointsConvertionFailedError':
      output.append('NÃ£o foi possÃ­vel calcular o pagamento em pontos');
      break;
    case 'credit':
      output.append('CrÃ©dito');
      break;
    case 'Credit':
      output.append('CrÃ©dito');
      break;
    case 'Penalty':
      output.append('Multa');
      break;
    case 'Proposal':
      output.append('OrÃ§amento');
      break;
    case 'ProposalOption':
      output.append('OpÃ§Ã£o do OrÃ§amento');
      break;
    case 'CreditValue':
      output.append('CrÃ©dito');
      break;
    case 'Pending':
      output.append('Pendente');
      break;
    case 'PreAuthorized':
      output.append('PrÃ©-Autorizado');
      break;
    case 'Active':
      output.append('Ativo');
      break;
    case 'hotelname':
      output.append('nome do hotel');
      break;
    case 'HotelName':
      output.append('Nome do Hotel');
      break;
    case 'BrokerStatus':
      output.append('Status da Reserva');
      break;
    case 'SavePayment':
      output.append('Adicionar Pagamento');
      break;
    case 'SO':
      output.append('OS');
      break;
    case 'Advanced':
      output.append('Adiantamento');
      break;
    case 'OrderInfo':
      output.append('InformaÃ§Ãµes do Pedido');
      break;
    case 'DepartureDate':
      output.append('Data de SaÃ­da');
      break;
    case 'Yes':
      output.append('Sim');
      break;
    case 'No':
      output.append('NÃ£o');
      break;
    case 'FlightNumber':
      output.append('NÂº do Voo');
      break;
    case 'Class':
      output.append('Classe');
      break;
    case 'Classes':
      output.append('Classes');
      break;
    case 'Connection':
      output.append('ConexÃ£o');
      break;
    case 'Status':
      output.append('Status');
      break;
    case 'OBFeeFull':
      output.append('Taxas do CartÃ£o (CobrÃ¡veis em caso de emissÃ£o com essa forma de pagamento)');
      break;
    case 'OBFee':
      output.append('Taxa do CartÃ£o');
      break;
    case 'DUTaxes':
      output.append('Taxas DU');
      break;
    case 'NonStop':
      output.append('Voo Direto');
      break;
    case 'SeeDetails':
      output.append('Ver Detalhes');
      break;
    case 'ExpiresOn':
      output.append('Expira em');
      break;
    case 'ExpireMonth':
      output.append('MÃªs de ExpiraÃ§Ã£o');
      break;
    case 'ExpireYear':
      output.append('Ano de ExpiraÃ§Ã£o');
      break;
    case 'Segments':
      output.append('Segmentos');
      break;
    case 'FlightStatus':
      output.append('Status do Voo');
      break;
    case 'ExternalLoc':
      output.append('Localizadores Externos');
      break;
    case 'Loc':
    case 'Localizador':
    case 'Locator':
    case 'ServiceLocator':
      output.append('Localizador');
      break;
    case 'Locs':
    case 'Localizadores':
    case 'Locators':
    case 'ServiceLocators':
      output.append('Localizadores');
      break;
    case 'GeneratedLoc':
    case 'Localizador gerado':
    case 'Generated Locator':
    case 'GeneratedServiceLocator':
      output.append('Localizador gerado');
      break;
    case 'GeneratedLocs':
    case 'Localizadores gerados':
    case 'Generated Locators':
    case 'GeneratedServiceLocators':
      output.append('Localizadores gerados');
      break;
    case 'Location':
      output.append('LocalizaÃ§Ã£o');
      break;
    case 'ExpirationDate':
      output.append('Data ExpiraÃ§Ã£o');
      break;
    case 'IssuerCia':
      output.append('Companhia Emissora');
      break;
    case 'OperatedBy':
      output.append('Operado Por');
      break;
    case 'PassiveLocator':
      output.append('Loc Passivo');
      break;
    case 'FaresTaxes':
      output.append('Tarifas e taxas');
      break;
    case 'PaxType':
      output.append('Tipo Passageiro');
      break;
    case 'Quantity':
      output.append('Quantidade');
      break;
    case 'EquivalentFare':
      output.append('Tarifa Equivalente');
      break;
    case 'FareBasis':
      output.append('Base TarifÃ¡ria');
      break;
    case 'Markup':
      output.append('Markup');
      break;
    case 'ExchangeRate':
      output.append('CÃ¢mbio');
      break;
    case 'ExchangeDate':
      output.append('Data CÃ¢mbio');
      break;
    case 'Totals':
      output.append('Totais');
      break;
    case 'Gender':
      output.append('GÃªnero');
      break;
    case 'Issue':
      output.append('EmissÃ£o');
      break;
    case 'RegisteredPayments':
      output.append('Pagamentos cadastrados');
      break;
    case 'RegisterPerson':
      output.append('Cadastrar Pessoa');
      break;
    case 'Exporting':
      output.append('Em exportaÃ§Ã£o');
      break;
    case 'Exported':
      output.append('Exportado');
      break;
    case 'Canceling':
      output.append('Em cancelamento');
      break;
    case 'RailwayStation':
      output.append('EstaÃ§Ã£o de Trem');
      break;
    case 'Port':
      output.append('Porto / Balsa');
      break;
    case 'None':
      output.append('Nenhum');
      break;
    case 'FareExpired_InformationDate':
      output.append('Tarifa(s) vÃ¡lida(s) em ');
      break;
    case 'FareExpired_Exception':
      output.append(', favor retarifar antes de realizar a emissÃ£o');
      break;
    case 'PhoneNumber':
      output.append('NÃºmero de Telefone');
      break;
    case 'ReplacementPayment':
    case 'Replacement':
      output.append('SubstituiÃ§Ã£o');
      break;
    case 'LocExpirationDate':
      output.append('Reservado atÃ©');
      break;
    case 'Meal':
      output.append('RefeiÃ§Ã£o');
      break;
    case 'notBoard':
      output.append('NÃ£o possui refeiÃ§Ã£o incluÃ­da');
      break;
    case 'UnavailableExchangeRate':
      output.append('NÃ£o foi possÃ­vel recuperar o valor do cÃ¢mbio aplicado no momento da reserva');
      break;
    case 'roomService':
      output.append('ServiÃ§os do quarto');
      break;
    case 'LOC':
      output.append('LOC');
      break;
    case 'ciaLoc':
      output.append('LOC Cia');
      break;
    case 'AddSegment':
      output.append('Adicionar Segmento');
      break;
    case 'Save':
      output.append('Salvar');
      break;
    case 'Ignore':
      output.append('Ignorar');
      break;
    case 'SeatMap':
      output.append('Mapa de Assentos');
      break;
    case 'Class':
      output.append('Classe');
      break;
    case 'Classes':
      output.append('Classes');
      break;
    case 'State':
      output.append('Estado');
      break;
    case 'Status':
      output.append('Status');
      break;
    case 'NoStatus':
      output.append('Sem Status');
      break;
    case 'F':
      output.append('Assento');
      break;
    case 'Time':
      output.append('HorÃ¡rio');
      break;
    case 'Price':
      output.append('PreÃ§o');
      break;
    case 'notService':
      output.append('Nenhum ServiÃ§o informado');
      break;
    case 'Subject':
      output.append('Assunto');
      break;
    case 'Message':
      output.append('Mensagem');
      break;
    case 'Mode':
      output.append('Modo');
      break;
    case 'OtherFem':
      output.append('Outra');
      break;
    case 'OthersFem':
      output.append('Outras');
      break;
    case 'Suggestions':
      output.append('SugestÃµes');
      break;
    case 'Existent Payments In Service Order':
      output.append('Pagamentos Existentes na OS');
      break;
    case 'ExitOf':
      output.append('Sair do');
      break;
    case 'Clear':
      output.append('Limpar');
      break;
    case 'Selection':
      output.append('SeleÃ§Ã£o');
      break;
    case 'Others':
      output.append('Outros');
      break;
    case 'MoreDetails':
      output.append('Mais detalhes');
      break;
    case 'CreatedBy':
      output.append('Criado por');
      break;
    case 'CreatedOn':
      output.append('Criado em');
      break;
    case 'SONumber':
      output.append('NÃºmero da ordem de serviÃ§o');
      break;
    case 'RequestWithVipTraveller':
      output.append('RequisiÃ§Ã£o possui viajantes Vip');
      break;
    case 'NoRecordFound':
      output.append('Nenhuma requisiÃ§Ã£o encontrada');
      break;
    case 'AddAlternativeApproval':
      output.append('Incluir Aprovador Alternativo');
      break;
    case 'ChangeStatus':
      output.append('Alterar Status');
      break;
    case 'Place':
      output.append('Local');
      break;
    case 'ExpiresOn':
      output.append('Expira em');
      break;
    case 'TotalInAdvance':
      output.append('Total Solicitado');
      break;
    case 'TotalSpent':
      output.append('Total Gasto');
      break;
    case 'VoucherNumber':
      output.append('NÃºmero do Voucher');
      break;
    case 'VoucherDate':
      output.append('Data do Voucher');
      break;
    case 'TotalCounterFare':
      output.append('Total Tarifa BalcÃ£o');
      break;
    case 'Payed':
      output.append('Pago');
      break;
    case 'Not payed':
      output.append('NÃ£o pago');
      break;
    case 'NewSO':
      output.append('Nova OS');
      break;
    case 'NoFlightDelayInfo':
      output.append('NÃ£o hÃ¡ informaÃ§Ãµes de atraso sobre esse voo.');
      break;
    case 'ToIssue':
      output.append('Emitir');
      break;
    case 'Full':
      output.append('Ã Vista');
      break;
    case 'Usesamepaymentasticket':
      output.append('Utilizar as mesmas formas de pagamento do bilhete');
      break;
    case 'Reallycancelticket':
      output.append('Deseja realmente cancelar este bilhete?');
      break;
    case 'ActionHistory':
      output.append('HistÃ³rico de AÃ§Ãµes');
      break;
    case 'ExternalPnr':
      output.append('Reserva Externa');
      break;
    case 'InvalidServiceOrderId':
      output.append('Id invÃ¡lido.');
      break;
    case 'SupplierPayment':
      output.append('Pagamento de fornecedor.');
      break;
    case 'SupplierCredit':
      output.append('CrÃ©dito no fornecedor');
      break;
    case 'Option':
      output.append('OpÃ§Ã£o');
      break;
    case 'Options':
      output.append('OpÃ§Ãµes');
      break;
    case 'AppliedPenalty':
      output.append('Multa Aplicada');
      break;
    case 'SameAddress':
      output.append('Mesmo endereÃ§o');
      break;
    case 'Title':
      output.append('TÃ­tulo');
      break;
    case 'Stars':
      output.append('Estrelas');
      break;
    case 'StartDate':
      output.append('Data inicial');
      break;
    case 'EndDate':
      output.append('Data final');
      break;
    case 'StartHour':
      output.append('Hora inicial');
      break;
    case 'EndHour':
      output.append('Hora final');
      break;
    case 'StartAge':
      output.append('Idade inicial');
      break;
    case 'SSRs':
      output.append('SSRs');
      break;
    case 'SSRCode':
      output.append('CÃ³digo');
      break;
    case 'SSRDescription':
      output.append('DescriÃ§Ã£o');
      break;
    case 'EndAge':
      output.append('Idade final');
      break;
    case 'Dates':
      output.append('Datas');
      break;
    case 'Date':
      output.append('Data');
      break;
    case 'ServiceName':
      output.append('Nome do serviÃ§o');
      break;
    case 'ServiceSupplierName':
      output.append('Nome do fornecedor');
      break;
    case 'Small':
    case 'small':
      output.append('Pequeno');
      break;
    case 'Large':
    case 'large':
      output.append('Grande');
      break;
    case 'Traditional':
    case 'traditional':
      output.append('Tradicional');
      break;
    case 'Open':
    case 'open':
      output.append('Aberto');
      break;
    case 'Undecided':
    case 'undecided':
      output.append('Incerto');
      break;
    case 'ApartBoth':
      output.append('Camas Separadas');
      break;
    case 'BothTogether':
      output.append('Camas Juntas');
      break;
    case 'Unknown':
    case 'unknown':
      output.append('Desconhecido');
      break;
    case 'Cruise Informations':
      output.append('InformaÃ§Ãµes de Cruzeiro');
      break;
    case 'Cabin Informations':
      output.append('InformaÃ§Ãµes da Cabine');
      break;
    case 'Cruise Taxes':
      output.append('Tarifas de Cruzeiro');
      break;
    case 'ServiceDescription':
      output.append('DescriÃ§Ã£o');
      break;
    case 'ServiceCategory':
      output.append('Categoria do ServiÃ§o');
      break;
    case 'IsFreeSale':
      output.append('Venda livre');
      break;
    case 'FareType':
      output.append('Tipo de tarifa');
      break;
    case 'SaleType':
      output.append('Tipo de venda');
      break;
    case 'TransferInformation':
      output.append('InformaÃ§Ãµes do transfer');
      break;
    case 'VoucherInfo':
      output.append('InformaÃ§Ãµes de voucher');
      break;
    case 'CancellationPolicy':
      output.append('PolÃ­tica de cancelamento');
      break;
    case 'BookingFares':
      output.append('Tarifas da reserva');
      break;
    case 'Car description':
      output.append('DescriÃ§Ã£o do carro');
      break;
    case 'Model':
      output.append('Modelo');
      break;
    case 'Acriss':
      output.append('Acriss');
      break;
    case 'Transmission':
      output.append('TransmissÃ£o');
      break;
    case 'Fuel':
      output.append('CombustÃ­vel');
      break;
    case 'HasAirConditioning':
      output.append('Ar condicionado');
      break;
    case 'NumberOfPassengers':
      output.append('NÃºmero de passageiros');
      break;
    case 'NumberOfBags':
      output.append('NÃºmero de bagagens');
      break;
    case 'NumberOfDoors':
      output.append('NÃºmero de portas');
      break;
    case 'Pickup Information':
      output.append('Local de retirada');
      break;
    case 'Pickup Date':
      output.append('Data de retirada');
      break;
    case 'Dropoff Information':
      output.append('Local de devoluÃ§Ã£o');
      break;
    case 'Dropoff Date':
      output.append('Data de devoluÃ§Ã£o');
      break;
    case 'Mileage':
      output.append('Milhagem');
      break;
    case 'MileageTerm':
      output.append('% de Online');
      break;
    case 'Free Mileage':
      output.append('livre');
      break;
    case 'Extra Hour Is Free Mileage':
      output.append('Hora extra inclui');
      break;
    case 'Extra Day Is Free Mileage':
      output.append('Dia extra inclui');
      break;
    case 'Miles/Kms Included':
      output.append('inclusos');
      break;
    case 'Agreement Details':
      output.append('Detalhes do Acordo');
      break;
    case 'Corporate Discount Number':
      output.append('CÃ³digo Corporativo');
      break;
    case 'Agreement Code':
      output.append('CÃ³digo Acordo');
      break;
    case 'Promotion Code':
      output.append('CÃ³digo PromoÃ§Ã£o');
      break;
    case 'Inclusions':
      output.append('InclusÃµes');
      break;
    case 'IncludedInBase':
      output.append('Incluso');
      break;
    case 'IncludedInTotal':
      output.append('Incluso');
      break;
    case 'PerDay':
      output.append('Por dia');
      break;
    case 'Percent':
      output.append('Por cento (%)');
      break;
    case 'per':
      output.append('por');
      break;
    case 'Extra Amount':
      output.append('Valor adicional');
      break;
    case 'Extra Hour Amount':
      output.append('Valor adicional por hora');
      break;
    case 'Extra Day Amount':
      output.append('Valor adicional por day');
      break;
    case 'Special Equipments':
      output.append('Equipamentos especiais');
      break;
    case 'EstimatedPrice':
      output.append('Valor estimado');
      break;
    case 'PricePlan':
      output.append('Plano');
      break;
    case 'Rate Code':
      output.append('Rate Code');
      break;
    case 'Route':
      output.append('Roteiro');
      break;
    case 'Exchange Rate':
      output.append('CÃ¢mbio');
      break;
    case 'MarkupedFare':
      output.append('Tarifa + Markup');
      break;
    case 'FareAmount':
      output.append('Valor da tarifa');
      break;
    case 'SaleFareAmount':
      output.append('Valor da venda');
      break;
    case 'AgencyMarkup':
      output.append('Markup da AgÃªncia');
      break;
    case 'Fare Amount':
      output.append('Valor da tarifa');
      break;
    case 'DailyFare Amount':
      output.append('Valor mÃ©dio da diÃ¡ria');
      break;
    case 'FareAmountExchanged':
      output.append('Tarifa equivalente');
      break;
    case 'Fare Type':
      output.append('Tipo da tarifa');
      break;
    case 'Estimated Total Fare':
      output.append('Valor Total Estimado');
      break;
    case 'Unspecified':
      output.append('NÃ£o informado');
      break;
    case 'Keyword':
      output.append('Palavra-chave');
      break;
    case 'Kilometer':
      output.append('Kilometragem');
      break;
    case 'Miles':
      output.append('MilhagensTarifas');
      break;
    case 'PayDate':
      output.append('Vencimento');
      break;
    case 'VenueInfo':
      output.append('Local e setor');
      break;
    case 'VenueName':
      output.append('Nome');
      break;
    case 'VenueSector':
      output.append('Setor');
      break;
    case 'SetupName':
      output.append('ConfiguraÃ§Ã£o');
      break;
    case 'VenuePhoneNumber':
      output.append('Telefone');
      break;
    case 'LotId':
      output.append('Lote');
      break;
    case 'ExchangedAmount':
      output.append('Valor Convertido');
      break;
    case 'SecurityCode':
      output.append('CÃ³digo de SeguranÃ§a');
      break;
    case 'SupplierInfo':
      output.append('Fornecedor');
      break;
    case 'SupplierName':
      output.append('Nome');
      break;
    case 'SupplierEmail':
      output.append('Email');
      break;
    case 'Periodic':
      output.append('Periodico');
      break;
    case 'Daily':
      output.append('DiÃ¡rio');
      break;
    case 'Inventory':
      output.append('Controle de inventÃ¡rio');
      break;
    case 'UponRequest':
      output.append('Sob consulta');
      break;
    case 'FreeSale':
      output.append('Venda livre');
      break;
    case 'True':
      output.append('Sim');
      break;
    case 'False':
      output.append('NÃ£o');
      break;
    case 'TwoOrThreeDoors':
      output.append('Duas ou trÃªs portas');
      break;
    case 'TwoOrFourDoors':
      output.append('Duas ou quatro portas');
      break;
    case 'FourOrFiveDoors':
      output.append('Quatro ou cinco portas');
      break;
    case 'Coupe':
      output.append('CoupÃ©');
      break;
    case 'Suv':
      output.append('SUV');
      break;
    case 'ServiceDetails':
      output.append('InformaÃ§Ãµes do serviÃ§o');
      break;
    case 'Crossover':
      output.append('Crossover');
      break;
    case 'CruiseCategory':
      output.append('Categoria');
      break;
    case 'Motorhome':
      output.append('Motorhome');
      break;
    case 'OpenairAllTerrain':
      output.append('Off-road');
      break;
    case 'CommercialVanOrTruck':
      output.append('Comercial, van ou caminhÃ£o');
      break;
    case 'Limousine':
      output.append('Limusine');
      break;
    case 'Monospace':
      output.append('Monospace');
      break;
    case 'Roadster':
      output.append('Roadster');
      break;
    case 'PickupRegularCab':
      output.append('Pickup');
      break;
    case 'PickupExtendedCab':
      output.append('Puckup com cabine extendida');
      break;
    case 'RecreationalVehicle':
      output.append('VeÃ­culo de passeio');
      break;
    case 'Sport':
      output.append('Esporte');
      break;
    case 'Convertible':
      output.append('ConversÃ­vel');
      break;
    case 'PassengerVan':
      output.append('Van');
      break;
    case 'WagonOrEstate':
      output.append('Wagon');
      break;
    case 'Special':
      output.append('Especial');
      break;
    case 'TwoWheelVehicle':
      output.append('Duas rodas');
      break;
    case 'SpecialOfferCar':
      output.append('Oferta especial');
      break;
    case 'Hourly':
      output.append('Por hora');
      break;
    case 'Monthly':
      output.append('Mensalmente');
      break;
    case 'Weekend':
      output.append('Final de semana');
      break;
    case 'Weekly':
      output.append('Semanal');
      break;
    case 'Manual':
      output.append('Manual');
      break;
    case 'Automatic':
      output.append('AutomÃ¡tico');
      break;
    case 'Economy':
      output.append('EconÃ´mico');
      break;
    case 'Intermediate':
      output.append('IntermediÃ¡rio');
      break;
    case 'Standard':
      output.append('PadrÃ£o');
      break;
    case 'Fullsize':
      output.append('Sedan');
      break;
    case 'Premium':
      output.append('Premium');
      break;
    case 'Luxury':
      output.append('Luxo');
      break;
    case 'Mini':
      output.append('Mini');
      break;
    case 'Compact':
      output.append('Compacto');
      break;
    case 'EconomyElite':
      output.append('EconÃ´mico Elite');
      break;
    case 'IntermediateElite':
      output.append('IntermediÃ¡rio Elite');
      break;
    case 'StandardElite':
      output.append('PadrÃ£o Elite');
      break;
    case 'FullsizeElite':
      output.append('Sedan Elite');
      break;
    case 'PremiumElite':
      output.append('Premium Elite');
      break;
    case 'LuxuryElite':
      output.append('Luxo Elite');
      break;
    case 'MiniElite':
      output.append('Mini Elite');
      break;
    case 'CompactElite':
      output.append('Compacto Elite');
      break;
    case 'navigational system':
      output.append('Sistema de navegaÃ§Ã£o GPS');
      break;
    case 'child seat/infant':
      output.append('Assento especial para bebÃª');
      break;
    case 'child seat/toddler':
      output.append('Assento especial para crianÃ§a');
      break;
    case 'child seat/booster':
      output.append('Assento de elevaÃ§Ã£o para crianÃ§a');
      break;
    case 'querybuilder:equal to':
      output.append('igual a');
      break;
    case 'querybuilder:different':
      output.append('diferente de');
      break;
    case 'querybuilder:greater than':
      output.append('maior que');
      break;
    case 'querybuilder:less than':
      output.append('menor que');
      break;
    case 'querybuilder:less than':
      output.append('menor que');
      break;
    case 'querybuilder:greater than or equal to':
      output.append('maior ou igual a');
      break;
    case 'querybuilder:less than or equal to':
      output.append('menor ou igual a');
      break;
    case 'querybuilder:contains':
      output.append('contÃ©m');
      break;
    case 'querybuilder:starts with':
      output.append('comeÃ§a com');
      break;
    case 'querybuilder:ends with':
      output.append('termina com');
      break;
    case 'querybuilder:is null':
      output.append('Ã© nulo');
      break;
    case 'querybuilder:is not null':
      output.append('nÃ£o Ã© nulo');
      break;
    case 'CallCenter':
      output.append('Central de Atendimento');
      break;
    case 'ImmediateCharge':
      output.append('Este item obriga o pagamento imediato de todos os itens da compra.');
      break;
    case 'ContactInformations':
      output.append('Contatos');
      break;
    case 'ContactPhoneType':
      output.append('Tipo');
      break;
    case 'Business':
      output.append('Trabalho');
      break;
    case 'Home':
      output.append('Casa');
      break;
    case 'Mobile':
      output.append('Celular');
      break;
    case 'Prefix':
      output.append('Prefixo');
      break;
    case 'PhoneNumber':
      output.append('Telefone');
      break;
    case 'Email':
      output.append('Email');
      break;
    case 'Cash':
      output.append('Dinheiro');
      break;
    case 'cash':
      output.append('Dinheiro');
      break;
    case 'Billet':
      output.append('Boleto');
      break;
    case 'billet':
      output.append('Boleto');
      break;
    case 'Check':
      output.append('Cheque');
      break;
    case 'check':
      output.append('Cheque');
      break;
    case 'Identity':
      output.append('RG');
      break;
    case 'Passport':
    case 'Passaporte':
      output.append('Passaporte');
      break;
    case 'PassportFullName':
      output.append('Nome no Passaporte');
      break;
    case 'PassportNumber':
      output.append('NÃºmero do Passaporte');
      break;
    case 'PassportExpireDate':
      output.append('Data de ExpiraÃ§Ã£o');
      break;
    case 'SeatPreference':
      output.append('PreferÃªncia de Assento');
      break;
    case 'SeatRegionPreference':
      output.append('RegiÃ£o do Assento');
      break;
    case 'DriverLicense':
      output.append('CNH');
      break;
    case 'CPF':
      output.append('CPF');
      break;
    case 'OnRequest':
      output.append('Sob solicitaÃ§Ã£o');
      break;
    case 'Allotment':
      output.append('Bloqueio');
      break;
    case 'Online':
      output.append('Online');
      break;
    case 'HotelProviderInfo':
      output.append('InformaÃ§Ãµes do fornecedor');
      break;
    case 'Culture':
      output.append('Cultura');
      break;
    case 'ContactNumber':
      output.append('NÃºmero de contato');
      break;
    case 'FareObservation':
      output.append('ObservaÃ§Ã£o da tarifa');
      break;
    case 'Original Currency':
      output.append('Moeda Original');
      break;
    case 'YouWillLostUnsavedDataMessage':
      output.append('Suas informaÃ§Ãµes que, por ventura, nÃ£o foram salvas serÃ£o perdidas.');
      break;
    case 'OutdateScriptsReloadMessage':
      output.append('Ã necessÃ¡rio atualizar o sistema para obter a Ãºltima versÃ£o. <a href=\'\'>CLIQUE AQUI</a> para atualizar.');
      break;
    case 'HotelRoom':
      output.append('Quarto');
      break;
    case 'ManagementFields':
      output.append('Campos Gerenciais');
      break;
    case 'ManagementFields_NotFound':
      output.append('Campos Gerenciais nÃ£o encontrados!');
      break;
    case 'InList':
      output.append('Em fila de espera');
      break;
    case 'Confirmed':
      output.append('Confirmado');
      break;
    case 'Reimbursed':
      output.append('Reembolsado');
      break;
    case 'ReimbursementRequested':
      output.append('Reembolso Solicitado');
      break;
    case 'Confirm':
      output.append('Confirmar');
      break;
    case 'SamePrice':
      output.append('Mesmo preÃ§o');
      break;
    case 'moreexpensive':
      output.append('mais caro');
      break;
    case 'morecheaper':
      output.append('mais barato');
      break;
    case 'Subject':
      output.append('Assunto');
      break;
    case 'Message':
      output.append('Mensagem');
      break;
    case 'Mode':
      output.append('Modo');
      break;
    case 'OtherFem':
      output.append('Outra');
      break;
    case 'OthersFem':
      output.append('Outras');
      break;
    case 'Suggestions':
      output.append('SugestÃµes');
      break;
    case 'ExitOf':
      output.append('Sair do');
      break;
    case 'Clear':
      output.append('Limpar');
      break;
    case 'FullFare':
      output.append('Cheia');
      break;
    case 'AgreementFare':
      output.append('Acordo');
      break;
    case 'BalconyFare':
      output.append('BalcÃ£o');
      break;
    case 'NetFare':
      output.append('Net');
      break;
    case 'PackageFare':
      output.append('Pacote');
      break;
    case 'Selection':
      output.append('SeleÃ§Ã£o');
      break;
    case 'GridPayment.Waiting':
      output.append('Aguardando Pagamento');
      break;
    case 'GridPayment.InAnalysis':
      output.append('Em AnÃ¡lise');
      break;
    case 'GridPayment.Paid':
      output.append('Pago');
      break;
    case 'GridPayment.Reversed':
      output.append('Estornado');
      break;
    case 'GridPayment.ErrorPayment':
      output.append('Erro no Pagamento');
      break;
    case 'GridPayment.ErrorReversal':
      output.append('Erro no Estorno');
      break;
    case 'BatchAction_AnonymousSearch':
      output.append('CotaÃ§Ã£o AnÃ´nima');
      break;
    case 'BatchAction_Search':
      output.append('CotaÃ§Ã£o Nomeada');
      break;
    case 'BatchAction_Issue':
      output.append('EmissÃ£o');
      break;
    case 'BatchAction_Book':
      output.append('Reserva');
      break;
    case 'BatchAction_SearchNBook':
      output.append('Reserva');
      break;
    case 'BatchAction_Retrieve':
      output.append('Retrieve');
      break;
    case 'BatchAction_RevalidatePNR':
      output.append('RevalidaÃ§Ã£o');
      break;
    case 'CreditCardNumber':
      output.append('NÃºmero do cartÃ£o');
      break;
    case 'CreditCardProvider':
      output.append('Bandeira');
      break;
    case 'CreditCardOwner':
      output.append('Nome no CartÃ£o de CrÃ©dito');
      break;
    case 'AuthorizationCode':
      output.append('CÃ³digo de autorizaÃ§Ã£o');
      break;
    case 'Error':
      output.append('Erro');
      break;
    case 'hotelAdditionalData':
      output.append('InformaÃ§Ãµes Adicionais para Hotel');
      break;
    case 'Confimation Number':
      output.append('NÃºmero de confirmaÃ§Ã£o');
      break;
    case 'SelectPayment':
      output.append('Selecionar Pagamento');
      break;
    case 'CancelPayment':
      output.append('Cancelar Pagamento');
      break;
    case 'PaymentInfo':
      output.append('InformaÃ§Ãµes de pagamento');
      break;
    case 'SystemAccounts':
      output.append('Contas de Sistema');
      break;
    case 'ExhibitionAll':
      output.append('Exibindo todos os');
      break;
    case 'ExhibitionPage':
      output.append('Exibindo pÃ¡gina');
      break;
    case 'RegisterTotal':
      output.append('Total de registros');
      break;
    case 'registers':
      output.append('registros');
      break;
    case 'Administration':
      output.append('AdministraÃ§Ã£o');
      break;
    case 'Data de ExpiraÃ§Ã£o':
      output.append('Data de ExpiraÃ§Ã£o');
      break;
    case 'interest':
      output.append('juros de');
      break;
    case 'withoutinterest':
      output.append('sem juros');
      break;
    case 'a.m.':
      output.append('a.m.');
      break;
    case 'AgeRange':
      output.append('Intervalo de idade');
      break;
    case 'DocumentType':
    case 'Document Type':
    case 'documenttype':
    case 'document type':
      output.append('Tipo do documento');
      break;
    case 'DocumentNumber':
      output.append('NÃºmero do documento');
      break;
    case 'DocumentFullName':
      output.append('Nome no documento');
      break;
    case 'DocumentCountry':
      output.append('PaÃ­s no documento');
      break;
    case 'DocumentExpireDate':
      output.append('Data de expiraÃ§Ã£o do documento');
      break;
    case 'Document':
      output.append('Documento');
      break;
    case 'ConcatenatedDocumentNumbers':
      output.append('Documentos');
      break;
    case 'PassportValidate':
      output.append('Validade do passaporte');
      break;
    case 'PassportCountry':
      output.append('PaÃ­s de emissÃ£o');
      break;
    case 'NationalPassaport':
      output.append('Passaporte nacional');
      break;
    case 'InternationalPassaport':
      output.append('Passaporte internacional');
      break;
    case 'NationalIdentity':
      output.append('Identidade nacional');
      break;
    case 'InternationalIdentity':
      output.append('Identidate internacional');
      break;
    case 'CreditCardMaxValue':
      output.append('Valor mÃ¡ximo no cartÃ£o');
      break;
    case 'CreditCardMinValue':
      output.append('Valor mÃ­nimo no cartÃ£o');
      break;
    case 'TotalValue':
      output.append('Valor total');
      break;
    case 'DirectPayment':
      output.append('Pagamento direto');
      break;
    case 'directpayment':
      output.append('Pagamento direto');
      break;
    case 'BankTransfer':
      output.append('TransferÃªncia bancÃ¡ria');
      break;
    case 'banktransfer':
      output.append('TransferÃªncia bancÃ¡ria');
      break;
    case 'PointOfSale':
      output.append('Ponto de venda');
      break;
    case 'pointofsale':
      output.append('Ponto de venda');
      break;
    case 'AirHotel':
      output.append('AÃ©reo + Hotel');
      break;
    case 'airhotel':
      output.append('AÃ©reo + Hotel');
      break;
    case 'Service':
      output.append('ServiÃ§o');
      break;
    case 'service':
      output.append('ServiÃ§o');
      break;
    case 'Stelo':
      output.append('Stelo');
      break;
    case 'stelo':
      output.append('Stelo');
      break;
    case 'DebitNote':
      output.append('Nota de DÃ©bito');
      break;
    case 'debitnote':
      output.append('Nota de DÃ©bito');
      break;
    case 'debit':
      output.append('dÃ©bito');
      break;
    case 'Debit':
      output.append('DÃ©bito');
      break;
    case 'credit':
      output.append('crÃ©dito');
      break;
    case 'Credit':
      output.append('CrÃ©dito');
      break;
    case 'GuaranteeReservation':
      output.append('Garantia de Reserva');
      break;
    case 'guaranteereservation':
      output.append('Garantia de Reserva');
      break;
    case 'ValueTransfer':
      output.append('TransferÃªncia de Valores');
      break;
    case 'valuetransfer':
      output.append('TransferÃªncia de Valores');
      break;
    case 'RetainedCommission':
      output.append('ComissÃ£o Retida');
      break;
    case 'FranchiseDiscount':
      output.append('Desconto Franquia');
      break;
    case 'franchisediscount':
      output.append('Desconto Franquia');
      break;
    case 'retainedcommission':
      output.append('ComissÃ£o Retida');
      break;
    case 'Exchange':
      output.append('Permuta');
      break;
    case 'exchange':
      output.append('Permuta');
      break;
    case 'RemoveSegment':
      output.append('Deseja realmente remover o(s) trecho(s)?');
      break;
    case 'ExchangeSegmentsConfirm':
      output.append('Deseja realmente trocar o(s) trecho(s)?');
      break;
    case 'RemoveFare':
      output.append('Deseja realmente remover esta tarifa?');
      break;
    case 'RemoveCommission':
      output.append('Deseja realmente remover esta comissÃ£o?');
      break;
    case 'AdvancedSearch':
      output.append('Pesquisa AvanÃ§ada');
      break;
    case 'Reports':
      output.append('RelatÃ³rios');
      break;
    case 'ProviderDefaultWarning':
      output.append('A empresa selecionada nÃ£o possui um fornecedor padrÃ£o, e por isso nÃ£o Ã© possÃ­vel alterar o contexto. Entre em contato com o administrador');
      break;
    case 'FareRules':
      output.append('Regras TarifÃ¡rias');
      break;
    case 'EmptyFareRules':
      output.append('NÃ£o existe regras tarifÃ¡rias cadastradas para esse voo.');
      break;
    case 'MustSelectHotelWarning':
      output.append('Por favor, selecione um hotel antes de continuar.');
      break;
    case 'MustSelectServiceWarning':
      output.append('Por favor, selecione um serviÃ§o antes de continuar.');
      break;
    case 'EditFeeValue':
      output.append('Editar valor do Fee');
      break;
    case 'EditRavValue':
      output.append('Editar valor da Rav');
      break;
    case 'ValueToIncrementFee':
      output.append('Valor para acrescentar ao Fee');
      break;
    case 'Fee':
      output.append('Fee');
      break;
    case ' a ':
      output.append(' a ');
      break;
    case 'all_age':
      output.append('Todas as idades');
      break;
    case 'need_save_actual_register':
      output.append('Ã necessÃ¡rio salvar o registro atual');
      break;
    case 'need_save':
      output.append('Ã necessÃ¡rio cadastrar');
      break;
    case 'the_field':
      output.append('O campo');
      break;
    case 'is_required':
      output.append('Ã© obrigatÃ³rio');
      break;
    case 'wait_load_file':
      output.append('Aguarde o carregamento do arquivo.');
      break;
    case 'total_rows':
      output.append('Total de linhas');
      break;
    case 'total_rows_processed':
      output.append('Total de linhas processadas');
      break;
    case 'Percentage':
      output.append('Percentage');
      break;
    case 'Import_Date':
      output.append('Data da ImportaÃ§Ã£o');
      break;
    case 'Occurred_error':
      output.append('Ocorreu um erro');
      break;
    case 'Error_load_page':
      output.append('Erro ao carregar a pÃ¡gina');
      break;
    case 'Contains':
      output.append('ContÃ©m');
      break;
    case 'Start_with':
      output.append('ComeÃ§a com');
      break;
    case 'End_with':
      output.append('Termina com');
      break;
    case 'History_Changes':
      output.append('HistÃ³rico de AlteraÃ§Ãµes');
      break;
    case 'not_accept_number':
      output.append('nÃ£o aceita nÃºmeros.');
      break;
    case 'not_fill_correctly':
      output.append('nÃ£o estÃ¡ preenchido corretamente.');
      break;
    case 'The_value_minimum':
      output.append('O valor mÃ­nimo para o campo');
      break;
    case 'The_value_maximum':
      output.append('O valor mÃ­nimo para o campo');
      break;
    case 'should_have_minimum':
      output.append('deve ter ao menos');
      break;
    case 'characters':
      output.append('caracteres.');
      break;
    case 'is':
      output.append('Ã©');
      break;
    case 'All':
      output.append('Todos');
      break;
    case 'Parcelas':
      output.append('Parcelas');
      break;
    case 'Primeira Parcela COMBO':
      output.append('1Âª');
      break;
    case 'Entrada COMBO':
      output.append('Entrada de');
      break;
    case 'ResumedFare':
      output.append('Tar');
      break;
    case 'ResumedTax':
      output.append('Tax');
      break;
    case 'ResumedMarkup':
      output.append('Mar');
      break;
    case 'ResumedDU':
      output.append('DU');
      break;
    case 'ResumedPenalty':
      output.append('Mul');
      break;
    case 'TarTaxDUMar':
    case 'Tar + Tax + DU + Mar':
      output.append('Tar + Tax + DU + Mar');
      break;
    case 'TarTaxDU':
    case 'Tar + Tax + DU':
      output.append('Tar + Tax + DU');
      break;
    case 'TicketPaymentInformation':
      output.append('InformaÃ§Ãµes de pagamento do bilhete');
      break;
    case 'Voo':
      output.append('Voo');
      break;
    case 'Complete':
      output.append('Completo');
      break;
    case 'PaymentReceipt':
      output.append('Recibo de Pagamento');
      break;
    case 'BookRequest':
      output.append('SolicitaÃ§Ã£o de Reserva');
      break;
    case 'SelectedDates':
      output.append('Datas Selecionadas');
      break;
    case 'Aguardando Pagamento':
    case 'AguardandoPagamento':
      output.append('Aguardando Pagamento');
      break;
    case 'Ãltimos Pedidos':
      output.append('Ãltimos Pedidos');
      break;
    case 'Ãltimas EmissÃµes':
    case 'Ultimas Emissoes':
      output.append('Ãltimas EmissÃµes');
      break;
    case 'Ãltimas Reservas':
    case 'Ultimas Reservas':
      output.append('Ãltimas Reservas');
      break;
    case 'emitido':
    case 'Emitido':
      output.append('Emitido');
      break;
    case 'Anulado':
    case 'Cancelado':
      output.append('Anulado');
      break;
    case 'EmisionPendiente':
      output.append('EmissÃ£o Pendente');
      break;
    case 'EmCancelamento':
      output.append('Em Cancelamento');
      break;
    case 'Nova Query':
      output.append('Nova Query');
      break;
    case 'Adulto':
      output.append('Adulto');
      break;
    case 'CrianÃ§a':
      output.append('CrianÃ§a');
      break;
    case 'BebÃª':
      output.append('BebÃª');
      break;
    case 'Tax':
      output.append('Tax');
      break;
    case 'Identidade':
      output.append('Identidade');
      break;
    case 'Carteira de motorista':
      output.append('Carteira de motorista');
      break;
    case 'CarPreferences':
      output.append('PreferÃªncias de Carro');
      break;
    case 'FlightWillBeReservedOnAWaitList':
      output.append('Existem vÃ´os que serÃ£o reservados em lista de espera');
      break;
    case 'FaresCanChange':
      output.append('As tarifas poderÃ£o ser alteradas neste processo. Deseja continuar?');
      break;
    case 'Order':
      output.append('CÃ³digo');
      break;
    case 'ToShare':
      output.append('Compartilhar');
      break;
    case 'forMore':
      output.append('por mais');
      break;
    case 'forLess':
      output.append('por menos');
      break;
    case 'forFree':
      output.append('grÃ¡tis');
      break;
    case 'saving':
      output.append('e economize');
      break;
    case 'samePrice':
      output.append('mesmo preÃ§o');
      break;
    case 'Deposit':
      output.append('DepÃ³sito');
      break;
    case 'DebitCard':
      output.append('CartÃ£o de dÃ©bito');
      break;
    case 'AgencyIATA':
      output.append('IATA da AgÃªncia');
      break;
    case 'AgencyName':
      output.append('Nome da AgÃªncia');
      break;
    case 'UntilXPM':
      output.append('BalcÃ£o');
      break;
    case 'DirectBill':
      output.append('Pagamento Direto');
      break;
    case 'DefaultGuarantee':
      output.append('Garantia PadrÃ£o');
      break;
    case 'AmountOfPeople':
      output.append('Quantidade de pessoas');
      break;
    case 'at':
      output.append('Ã s');
      break;
    case 'DisabledOutstandingServiceItemMessage':
      output.append('Pagamento desabilitado devido Ã s condiÃ§Ãµes da ordem de serviÃ§o');
      break;
    case 'Search':
      output.append('Busca');
      break;
    case 'HotelDetails':
      output.append('Detalhes do Hotel');
      break;
    case 'CheckOut':
      output.append('Fechamento');
      break;
    case 'Confirmation':
      output.append('ConfirmaÃ§Ã£o');
      break;
    case 'Svc City':
    case 'SvcCity':
    case 'svccity':
      output.append('Cidade do ServiÃ§o');
      break;
    case 'AgencyContactPhone':
      output.append('Telefone da AgÃªncia');
      break;
    case 'AgencyContactName':
      output.append('Nome Contato da AgÃªncia');
      break;
    case 'CustomerContactPhone':
      output.append('Telefone do Cliente');
      break;
    case 'CustomerContactName':
      output.append('Nome do Cliente');
      break;
    case 'CustomerContactEmail':
      output.append('Email do Cliente');
      break;
    case 'CustomerExternalId':
      output.append('CÃ³digo Customizado');
      break;
    case 'at':
      output.append('Ã s');
      break;
    case 'DisabledOutstandingServiceItemMessage':
      output.append('Pagamento desabilitado devido Ã s condiÃ§Ãµes da ordem de serviÃ§o');
      break;
    case 'Search':
      output.append('Busca');
      break;
    case 'HotelDetails':
      output.append('Detalhes do Hotel');
      break;
    case 'HotelPreferences':
      output.append('PreferÃªncias de Hotel');
      break;
    case 'CheckOut':
      output.append('Fechamento');
      break;
    case 'Confirmation':
      output.append('ConfirmaÃ§Ã£o');
      break;
    case 'Svc City':
    case 'SvcCity':
    case 'svccity':
      output.append('Cidade do ServiÃ§o');
      break;
    case 'Remove':
      output.append('Remover');
      break;
    case 'FlexibleSearch':
      output.append('Buscas FlexÃ­veis');
      break;
    case 'Foreign Identification':
    case 'foreign identification':
      output.append('CÃ©dula Estrangeira');
      break;
    case 'IssueCountry':
    case 'issuecountry':
    case 'Issue Country':
      output.append('PaÃ­s emissor');
      break;
    case 'Identification':
    case 'identification':
      output.append('IdentificaÃ§Ã£o');
      break;
    case 'Redress Number':
    case 'redress number':
    case 'RedressNumber':
    case 'redressnumber':
      output.append('Redress Number');
      break;
    case 'Nationality':
    case 'nationality':
      output.append('Nacionalidade');
      break;
    case 'Foreign Passport':
    case 'foreign passport':
      output.append('Passaporte estrangeiro');
      break;
    case 'Foreign Identity':
    case 'Foreign Identification':
    case 'foreign identity':
      output.append('Identidade estrangeira');
      break;
    case 'Expiry Date':
    case 'expiry date':
      output.append('Data ExpiraÃ§Ã£o');
      break;
    case 'Senior':
      output.append('SÃªnior');
      break;
    case 'AirLineCodeCommission':
      output.append('CÃ³d. Cia e ComissÃ£o');
      break;
    case 'AirlineFavorites':
      output.append('Cias AÃ©reas Preferidas');
      break;
    case 'AirlineLeastFavorites':
      output.append('Cias AÃ©reas Menos Preferidas');
      break;
    case 'Commission':
      output.append('ComissÃ£o');
      break;
    case 'OptionalInformation':
      output.append('InformaÃ§Ã£o Opcional');
      break;
    case 'TicketNumberFreeText':
      output.append('NÃºm. Bilhete e Texto Livre');
      break;
    case 'booked':
      output.append('reservada');
      break;
    case 'precified':
      output.append('tarifada');
      break;
    case 'requested':
      output.append('solicitada');
      break;
    case 'NewProposal':
      output.append('Novo orÃ§amento');
      break;
    case 'Natural':
      output.append('FÃ­sica');
      break;
    case 'Legal':
      output.append('JurÃ­dica');
      break;
    case 'MercantilBank':
    case 'mercantilbank':
      output.append('Banco Mercantil');
      break;
    case 'CTA':
      output.append('CTA');
      break;
    case 'ConfirmaÃ§Ã£o e Pagamento':
      output.append('ConfirmaÃ§Ã£o e Pagamento');
      break;
    case 'Reservar offline':
      output.append('Reservar offline');
      break;
    case 'Atual':
      output.append('Atual');
      break;
    case 'NewServiceOrder':
      output.append('Nova Ordem de ServiÃ§o');
      break;
    case 'ServiceOrder':
      output.append('Ordem de ServiÃ§o');
      break;
    case 'Synthetic':
      output.append('SintÃ©tico');
      break;
    case 'Analytical':
      output.append('AnalÃ­tico');
      break;
    case 'StartingAt':
      output.append('Ã partir de');
      break;
    case 'FullName':
      output.append('Nome Completo');
      break;
    case 'Visas':
      output.append('Vistos');
      break;
    case 'VisaType':
      output.append('Tipo');
      break;
    case 'ExpireDate':
      output.append('Data de expiraÃ§Ã£o');
      break;
    case 'Brand':
      output.append('Marca');
      break;
    case 'Obs':
      output.append('Obs');
      break;
    case 'Vaccines':
      output.append('Vacinas');
      break;
    case 'CreditCards':
      output.append('CartÃµes de CrÃ©dito');
      break;
    case 'NewPerson':
      output.append('Nova pessoa');
      break;
    case 'PersonalData':
      output.append('Dados Pessoais');
      break;
    case 'AdditionalDocuments':
      output.append('Documentos Adicionais');
      break;
    case 'Approve':
      output.append('Aprovar');
      break;
    case 'Balance':
      output.append('Saldo');
      break;
    case 'SearchTotalizer':
      output.append('Pesquisar OrÃ§amento');
      break;
    case 'Show':
      output.append('Exibir');
      break;
    case 'ExtraItemInformation':
      output.append('InformaÃ§Ã£o do item extra');
      break;
    case 'InsuranceDetails':
      output.append('Detalhes do Seguro');
      break;
    case 'Product':
      output.append('Produto');
      break;
    case 'Country':
      output.append('PaÃ­s');
      break;
    case 'InsuranceProfit':
      output.append('Lucro');
      break;
    case 'InsuranceValue':
      output.append('Valor');
      break;
    case 'PayerAddress':
      output.append('EndereÃ§o do pagador');
      break;
    case 'PayerData':
      output.append('Dados do pagador (nome, cpf, etc)');
      break;
    case 'AdminnetUser':
      output.append('usuÃ¡rio Adminnet');
      break;
    case 'BillNumber':
      output.append('NÃºmero da Fatura');
      break;
    case 'BillType':
      output.append('Tipo de Fatura');
      break;
    case 'DateOfBill':
      output.append('Data da fatura');
      break;
    case 'IdBill':
      output.append('Fatura ID');
      break;
    case 'IdBranchOffice':
      output.append('ID Filial');
      break;
    case 'IdCoin':
      output.append('CÃ³digo de Moeda');
      break;
    case 'IdCustomer':
      output.append('Cliente');
      break;
    case 'IdOriginalBill':
      output.append('Bill Fee');
      break;
    case 'IdUnit':
      output.append('Unidade');
      break;
    case 'StateBill':
      output.append('Bill Estado');
      break;
    case 'MountPayCash':
      output.append('Pagamento em dinheiro');
      break;
    case 'MountPayCreditCard':
      output.append('CartÃµes de pagamento');
      break;
    case 'Printed':
      output.append('Impresso');
      break;
    case 'AdminnetInfo':
      output.append('informaÃ§Ãµes Adminnet');
      break;
    case 'PayAndGo':
    case 'payandgo':
      output.append('PayAndGo');
      break;
    case 'Expired':
      output.append('Expirado');
      break;
    case 'Authorized':
      output.append('Autorizado');
      break;
    case 'Denied':
      output.append('Negado');
      break;
    case 'Unknown':
      output.append('Desconhecido');
      break;
    case 'ToInclude':
      output.append('A incluir');
      break;
    case 'serviceOrderNotCreatedHeader':
      output.append('SUAS RESERVAS FORAM EFETIVADAS!');
      break;
    case 'serviceOrderNotCreatedContent':
      output.append('PorÃ©m, infelizmente, ocorreram erros durante a gravaÃ§Ã£o da ORDEM DE SERVIÃO!<br />Sugerimos que vocÃª anote os LOCALIZADORES gerados para utilizar posteriormente, evitando assim multas desnecessÃ¡rias por criaÃ§Ã£o de reservas duplicadas.<br />Nossa equipe estÃ¡ sempre de olho nesse tipo de situaÃ§Ã£o, porÃ©m, caso queira tentar novamente, clique no botÃ£o ENVIAR abaixo ou entre em contato com o SUPORTE.');
      break;
    case 'serviceItemGridTabPendingChangesMessage':
      output.append('Existem alteraÃ§Ãµes em aberto. Confirme ou cancele antes de salvar.');
      break;
    case 'Responsable':
      output.append('ResponsÃ¡vel');
      break;
    case 'PackageAirConfigurations':
      output.append('ConfiguraÃ§Ãµes de AÃ©reo');
      break;
    case 'PackageHotelConfigurations':
      output.append('ConfiguraÃ§Ãµes de HotÃ©is');
      break;
    case 'PackageServicesConfigurations':
      output.append('ConfiguraÃ§Ãµes de ServiÃ§os');
      break;
    case 'WriteOrSelect':
      output.append('Digite ou selecione');
      break;
    case 'ServiceTypeName':
      output.append('Tipo de ServiÃ§o<br />');
      break;
    case 'BlockView':
      output.append('Bloquear<br />VisualizaÃ§Ã£o');
      break;
    case 'BlockEdit':
      output.append('Bloquear<br />EdiÃ§Ã£o');
      break;
    case 'BlockCreate':
      output.append('Bloquear<br />CriaÃ§Ã£o');
      break;
    case 'BlockOnlineView':
      output.append('Bloquear<br />Modo Online');
      break;
    case 'BaggagesIncluded_Unknown':
      output.append('NÃºmero de bagagens nÃ£o informado pela cia. Verifique junto as regras tarifÃ¡rias da mesma para mais detalhes.');
      break;
    case 'BaggagesIncluded_NoneAreIncluded':
      output.append('NÃ£o inclui despacho de bagagens');
      break;
    case 'BaggagesIncluded_OneBaggage':
      output.append('Inclui despacho de uma bagagem');
      break;
    case 'BaggagesIncluded_TwoBaggages':
      output.append('Inclui despacho de duas bagagens');
      break;
    case 'BaggagesIncluded_ThreeBaggages':
      output.append('Inclui despacho de trÃªs bagagens');
      break;
    case 'BaggagesIncluded':
      output.append('Despacho de Bagagem');
      break;
    case 'AddRemoveBaggages_Unknown':
      output.append('NÃºmero de bagagens nÃ£o informado');
      break;
    case 'AddRemoveBaggages_NoneAreIncluded':
      output.append('Adicione ');
      break;
    case 'AddRemoveBaggages_OneBaggage':
      output.append('Remover bagagem para economizar ');
      break;
    case 'AddRemoveBaggages_TwoBaggages':
      output.append('Remover bagagem para economizar ');
      break;
    case 'AddRemoveBaggages_ThreeBaggages':
      output.append('Remover bagagem para economizar ');
      break;
    case 'CheckoutBaggagesOption_NoneAreIncluded':
      output.append('Viaje sem bagagens ');
      break;
    case 'CheckoutBaggagesOption_OneBaggage':
      output.append('Uma bagagem inclusa ');
      break;
    case 'CheckoutBaggagesOption_TwoBaggages':
      output.append('Duas bagagens inclusas ');
      break;
    case 'CheckoutBaggagesOption_ThreeBaggages':
      output.append('TrÃªs bagagens inclusas ');
      break;
    case 'Franquia':
      output.append('Franquia');
      break;
    case 'Bagagem':
      output.append('Bagagem');
      break;
    case 'baggage':
      output.append('bagagem');
      break;
    case 'baggages':
      output.append('bagagens');
      break;
    case 'AddFreeBaggage':
      output.append('Adicione grÃ¡tis a franquia de ');
      break;
    case 'OPTIONALHIRING':
      output.append('CONTRATAÃÃO OPCIONAL');
      break;
    case 'Indifferent':
      output.append('Indiferente');
      break;
    case 'WithBaggage':
      output.append('Somente voos com bagagem');
      break;
    case 'WithoutBaggage':
      output.append('Somente voos sem bagagem');
      break;
    case 'MySettings':
      output.append('Minhas Settings');
      break;
    case 'service items':
      output.append('itens de serviÃ§o');
      break;
    case 'service item':
      output.append('item de serviÃ§o');
      break;
    case 'Number of Berths in Cabin':
      output.append('NÃºmero de camas Pullman');
      break;
    case 'Number of Berths in use':
      output.append('NÃºmero de camas Pullman em uso');
      break;
    case 'Number of Upper Berths available':
      output.append('NÃºmero de camas Pullman superiores disponÃ­veis');
      break;
    case 'Cabin Area':
      output.append('Ãrea da cabine');
      break;
    case 'Cabin Dimensions':
      output.append('DimensÃµes da cabine');
      break;
    case 'Cabin Window Size':
      output.append('Tamanho da janela da cabine');
      break;
    case 'Door Size':
      output.append('Tamanho da porta');
      break;
    case 'FranchiseDiscount':
      output.append('Desconto franquia');
      break;
    case 'franchisediscount':
      output.append('Desconto Franquia');
      break;
    case 'Agent Receipt':
      output.append('CÃ³pia do Agente de Viagem');
      break;
    case 'Guest Receipt':
      output.append('CÃ³pia do HÃ³spede');
      break;
    case 'Aft':
      output.append('Popa');
      break;
    case 'Forward':
      output.append('Proa');
      break;
    case 'Midship':
      output.append('Meio');
      break;
    case 'BestBuyAssessFarePNRChangeObs':
      output.append('OBS: A confirmaÃ§Ã£o dessa alteraÃ§Ã£o poderÃ¡ modificar a quantidade de bagagens em cada voo.');
      break;
    case 'AreYouSure':
      output.append('Tem certeza?');
      break;
    case 'EssentialInformations':
      output.append('InformaÃ§Ãµes adicionais');
      break;
    case 'Keep context':
      output.append('Manter contexto');
      break;
    case 'Change context':
      output.append('Alterar contexto<span>Ao alterar todas as outras abas serÃ£o fechadas</span>');
      break;
    case 'Alert context':
      output.append('O contexto da ordem de serviÃ§o aberta nÃ£o corresponde ao contexto atual');
      break;
    case 'extra':
      output.append('extra');
      break;
    case 'Extra':
      output.append('Extra');
      break;
    case 'AssessFareNeeded':
      output.append('Ã necessÃ¡rio tarifar o(s) item(s) antes de criar o orÃ§amento. Deseja tarifar agora?');
      break;
    case 'AssessFareErrorAndNeeded':
      output.append('Existem itens que nÃ£o foram tarifados corretamente e nÃ£o poderÃ£o ser enviados para o orÃ§amento. Deseja limpar esses itens da bandeja?');
      break;
    case 'SalesReport':
      output.append('RelatÃ³rio de vendas');
      break;
    case 'Atention':
      output.append('AtenÃ§Ã£o');
      break;
    case 'GeneralInfo':
      output.append('Dados Gerais');
      break;
    case 'PackageComposition':
      output.append('ComposiÃ§Ã£o do Pacote');
      break;
    case 'PackageCustom':
      break;
    case 'packagecustom':
      output.append('Pacote Customizado');
      break;
    case 'GovernmentTaxes':
      output.append('Impostos');
      break;
    case 'OriginalTax':
      output.append('Taxa Original');
      break;
    case 'OriginalFareAmount':
      output.append('Tarifa Original');
      break;
    case 'Fidelity':
      output.append('Fidelidade');
      break;
    case 'AlreadyApprovedItems':
      output.append('Itens jÃ¡ aprovados');
      break;
    case 'ServiceHours':
      output.append('HorÃ¡rio de Funcionamento');
      break;
    default:
      Resources.translateStatus({code: opt_data.code}, output);
  }
  if (!opt_sb) return output.toString();
};


Resources.checkoutTranslateBaggagesOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.baggagesIncluded) {
    case 'NoneAreIncluded':
      Resources.translate({code: 'CheckoutBaggagesOption_NoneAreIncluded'}, output);
      break;
    case 'OneBaggage':
      Resources.translate({code: 'CheckoutBaggagesOption_OneBaggage'}, output);
      break;
    case 'TwoBaggages':
      Resources.translate({code: 'CheckoutBaggagesOption_TwoBaggages'}, output);
      break;
    case 'ThreeBaggages':
      Resources.translate({code: 'CheckoutBaggagesOption_ThreeBaggages'}, output);
      break;
  }
  if (!opt_sb) return output.toString();
};


Resources.translateAirCabinType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.cabintype) {
    case 'FirstClass':
    case 'firstClass':
    case 'firstclass':
    case '0':
    case 0:
      Resources.translate({code: 'FirstClass'}, output);
      break;
    case 'Economic':
    case 'economic':
    case '2':
    case 2:
      Resources.translate({code: 'Economic'}, output);
      break;
    case '1':
    case 'Executive':
    case 'executive':
    case 1:
    case 'Business':
    case 'business':
      Resources.translate({code: 'Business_Class'}, output);
      break;
    case 'PremiumEconomy':
    case 'premiumeconomy':
    case '3':
    case 3:
      Resources.translate({code: 'PremiumEconomy'}, output);
      break;
    default:
      Resources.translate({code: 'Any'}, output);
      output.append(' ');
      Resources.translate({code: 'cabin'}, output);
  }
  if (!opt_sb) return output.toString();
};


Resources.passengerTitle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.title == 0) ? 'Sr.' : (opt_data.title == 1) ? 'Sra.' : (opt_data.title == 2) ? 'Sr.' : (opt_data.title == 3) ? 'Srta.' : (opt_data.title == 4) ? '.' : '');
  if (!opt_sb) return output.toString();
};


Resources.gender = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.Gender == 1) ? 'Feminino' : 'Masculino');
  if (!opt_sb) return output.toString();
};


Resources.passengerType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.PassengerType == 0) ? 'Adulto' : (opt_data.PassengerType == 1) ? 'CrianÃ§a' : (opt_data.PassengerType == 2) ? 'BebÃª' : (opt_data.PassengerType == 3) ? 'SÃªnior' : '');
  if (!opt_sb) return output.toString();
};


Resources.pricingStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.Status == 0) ? 'NÃ£o cobrado' : (opt_data.Status == 1) ? 'Cobrado' : (opt_data.Status == 2) ? 'Isento' : (opt_data.Status == 3) ? 'Estornado' : '');
  if (!opt_sb) return output.toString();
};


Resources.linkType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.Type == 0) ? 'Pai' : (opt_data.Type == 1) ? 'Filho' : (opt_data.Type == 2) ? 'AssociaÃ§Ã£o' : (opt_data.Type == 3) ? 'Gerado Por' : (opt_data.Type == 4) ? 'Gerou' : '');
  if (!opt_sb) return output.toString();
};


Resources.personLinkType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t\t');
  switch (opt_data.Type) {
    case 0:
      output.append('Pai / MÃ£e');
      break;
    case 1:
      output.append('Filho (a)');
      break;
    case 2:
      output.append('Amigo (a)');
      break;
    case 3:
      output.append('ConjugÃª');
      break;
    case 4:
      output.append('Enteado (a)');
      break;
    case 5:
      output.append('Padrasto (a)');
      break;
    case 6:
      output.append('IrmÃ£o (Ã£)');
      break;
    case 7:
      output.append('Neto (a)');
      break;
    case 8:
      output.append('AvÃ´ / AvÃ³');
      break;
    case 9:
      output.append('Tio (a)');
      break;
    case 10:
      output.append('Sobrinho (a)');
      break;
    case 11:
      output.append('Empregador');
      break;
    case 12:
      output.append('Empregado');
      break;
    case 13:
      output.append('BabÃ¡');
      break;
    case 14:
      output.append('Sob cuidado');
      break;
    case 15:
      output.append('Outro');
      break;
    case 16:
      output.append('Namorado (a)');
      break;
  }
  if (!opt_sb) return output.toString();
};


Resources.baggageAllowance = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.baggageAllowance == 0 || opt_data.baggageAllowance == 'Indifferent') ? 'Indiferente' : (opt_data.baggageAllowance == 1 || opt_data.baggageAllowance == 'WithBaggage') ? 'Somente voos com bagagem' : (opt_data.baggageAllowance == 2 || opt_data.baggageAllowance == 'WithoutBaggage') ? 'Somente voos sem bagagem' : '');
  if (!opt_sb) return output.toString();
};


Resources.cruiseCabinOccupancy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.occupancy == 1) ? 'Single' : (opt_data.occupancy == 2) ? 'Dupla' : (opt_data.occupancy == 3) ? 'Tripla' : (opt_data.occupancy == 3) ? 'QuÃ¡drupla' : '');
  if (!opt_sb) return output.toString();
};


Resources.cruiseGroupDiningConfiguration = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.code == 'SeatApart') ? 'Separadas' : (opt_data.code == 'SeatTogether') ? 'Juntas' : (opt_data.code == 'RoundRobin') ? 'AleatÃ³rias' : '-');
  if (!opt_sb) return output.toString();
};


Resources.translateStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  switch (opt_data.code) {
    case 'aberta':
    case 'Aberta':
      output.append('Em Aberto');
      break;
    case 'aguardandopostagem':
    case 'AguardandoPostagem':
      output.append('Aguardando Postagem');
      break;
    case 'analisecredito':
    case 'AnaliseCredito':
      output.append('AnÃ¡lise de CrÃ©dito');
      break;
    case 'aprovado':
    case 'Aprovado':
      output.append('Aprovado');
      break;
    case 'ativo':
    case 'Ativo':
      output.append('Ativo');
      break;
    case 'cancelado':
    case 'Cancelado':
      output.append('Cancelado');
      break;
    case 'confirmado':
    case 'Confirmado':
      output.append('Confirmado');
      break;
    case 'cotacaoefetuada':
    case 'CotacaoEfetuada':
      output.append('CotaÃ§Ã£o Efetuada');
      break;
    case 'cotacaorealizada':
    case 'CotacaoRealizada':
      output.append('CotaÃ§Ã£o Realizada');
      break;
    case 'cotacaoselecionada':
    case 'CotacaoSelecionada':
      output.append('CotaÃ§Ã£o Selecionada');
      break;
    case 'created':
    case 'Created':
      output.append('Criado');
      break;
    case 'creditoaprovado':
    case 'CreditoAprovado':
      output.append('CrÃ©dito Aprovado');
      break;
    case 'creditonegado':
    case 'CreditoNegado':
      output.append('CrÃ©dito Negado');
      break;
    case 'criado':
    case 'Criado':
      output.append('Criado');
      break;
    case 'emaprovacao':
    case 'EmAprovacao':
      output.append('Em AprovaÃ§Ã£o');
      break;
    case 'emaprovacaodemerito':
    case 'EmAprovacaoDeMerito':
      output.append('Em AprovaÃ§Ã£o de MÃ©rito');
      break;
    case 'emcancelamento':
    case 'EmCancelamento':
      output.append('Em Cancelamento');
      break;
    case 'emcotacao':
    case 'EmCotacao':
      output.append('Em CotaÃ§Ã£o');
      break;
    case 'emconsulta':
    case 'EmConsulta':
      output.append('Em Consulta');
      break;
    case 'ememissao':
    case 'EmEmissao':
      output.append('Em EmissÃ£o');
      break;
    case 'emitido':
    case 'Emitido':
      output.append('Emitido');
      break;
    case 'Cancelled':
    case 'cancelled':
      output.append('Cancelado');
      break;
    case 'emitidopendentefee':
    case 'EmitidoPendenteFee':
      output.append('Emitido Pendente CobranÃ§a Fee');
      break;
    case 'pendente':
    case 'Pendente':
      output.append('Pendente');
      break;
    case 'montandocotacao':
    case 'MontandoCotacao':
      output.append('Montando CotaÃ§Ã£o');
      break;
    case 'montandorequisicao':
    case 'MontandoRequisicao':
      output.append('Montando RequisiÃ§Ã£o');
      break;
    case 'pedido':
    case 'Pedido':
      output.append('Pedido');
      break;
    case 'pedidoemissao':
    case 'PedidoEmissao':
      output.append('Pedido de EmissÃ£o');
      break;
    case 'EmissaoConcluida':
    case 'emissaoconcluida':
      output.append('EmissÃ£o Concluida');
      break;
    case 'AguardandoReembolso':
    case 'aguardandoreembolso':
      output.append('Aguardando Reembolso');
      break;
    case 'AguardandoConfirmacao':
    case 'aguardandoconfirmacao':
      output.append('Aguardando ConfirmaÃ§Ã£o');
      break;
    case 'Reembolsado':
    case 'reembolsado':
      output.append('Reembolsado');
      break;
    case 'SolicitandoReembolso ':
    case 'solicitandoreembolso':
      output.append('Solicitando Reembolso');
      break;
    case 'EmissaoManual ':
    case 'emissaomanual':
      output.append('EmissÃ£o Manual');
      break;
    case 'pedidoreserva':
    case 'PedidoReserva':
      output.append('Pedido de Reserva');
      break;
    case 'realizado':
    case 'Realizado':
      output.append('Realizado');
      break;
    case 'reserva':
    case 'Reserva':
      output.append('Reserva');
      break;
    case 'reservado':
    case 'Reservado':
      output.append('Reservado');
      break;
    case 'reprovado':
    case 'Reprovado':
      output.append('Reprovado');
      break;
    case 'reservasolicitada':
    case 'ReservaSolicitada':
      output.append('Reserva Solicitada');
      break;
    case 'reservavalidada':
    case 'ReservaValidada':
      output.append('Reserva Validada');
      break;
    case 'selecaoefetuada':
    case 'SelecaoEfetuada':
      output.append('SeleÃ§Ã£o Efetuada');
      break;
    case 'aguardandoreserva':
    case 'AguardandoReserva':
      output.append('Aguardando Reserva');
      break;
    case 'preparandoentrega':
    case 'PreparandoEntrega':
      output.append('Preparando Entrega');
      break;
    case 'ingressodespachado':
    case 'IngressoDespachado':
      output.append('Ingresso Despachado');
      break;
    case 'ingressoentregue':
    case 'IngressoEntregue':
      output.append('Ingresso Entregue');
      break;
    case 'reemitido':
    case 'Reemitido':
      output.append('Reemitido');
      break;
    case 'cancelamentonaopermitido':
    case 'CancelamentoNaoPermitido':
      output.append('Canelamento NÃ£o Permitido');
      break;
    case 'aguardandolancamento':
    case 'AguardandoLancamento':
      output.append('Aguardando LanÃ§amento');
      break;
    case 'selecionarnovacotacao':
    case 'SelecionarNovaCotacao':
      output.append('Selecionar Nova CotaÃ§Ã£o');
      break;
    case 'Error':
      output.append('Erro');
      break;
    case 'PnrPaymentStatus':
    case 'pnrpaymentstatus':
      output.append('Status do Pagamento do Pnr');
      break;
    case 'PnrPayment':
    case 'pnrpayment':
      output.append('Pagamento do Pnr');
      break;
    case 'PnrPayments':
    case 'pnrpayments':
      output.append('Pagamentos do Pnr');
      break;
    case 'SupplierStatement':
    case 'supplierstatement':
      output.append('Extrato do Fornecedor');
      break;
    case 'PaymentType':
    case 'paymenttype':
      output.append('Tipo do Pagamento');
      break;
    case 'EmAprovacaoManual':
    case 'emaprovacaomanual':
      output.append('Em AprovaÃ§Ã£o Manual');
      break;
    case 'SelectedDates':
      output.append('Datas Selecionadas');
      break;
    case 'ReferenceDate':
      output.append('Data de ReferÃªncia');
      break;
    case 'DirectPayment':
      break;
    case 'directpayment':
      output.append('Pagamento direto');
      break;
    case 'BankTransfer':
      break;
    case 'banktransfer':
      output.append('TransferÃªncia bancÃ¡ria');
      break;
    case 'PointOfSale':
      break;
    case 'pointofsale':
      output.append('Ponto de venda');
      break;
    case 'AirHotel':
      break;
    case 'airhotel':
      output.append('AÃ©reo + Hotel');
      break;
    case 'Service':
      break;
    case 'service':
      output.append('ServiÃ§o');
      break;
    case 'Stelo':
      break;
    case 'stelo':
      output.append('Stelo');
      break;
    case 'Financial':
      output.append('Financiamento');
      break;
    case 'financial':
      output.append('Financiamento');
      break;
    case 'Upto':
      output.append('AtÃ©');
      break;
    case 'upto':
      output.append('atÃ©');
      break;
    case 'Hello':
      output.append('OlÃ¡');
      break;
    case 'Stopovers':
      output.append('Paradas');
      break;
    case 'ChangePassword':
      output.append('Alterar Senha');
      break;
    case 'DiscountCoupon':
      output.append('Cupom de desconto');
      break;
    case 'Today':
      output.append('Hoje');
      break;
    case 'Yesterday':
      output.append('Ontem');
      break;
    case 'Tomorrow':
      output.append('AmanhÃ£');
      break;
    case 'InvoicePaid':
      output.append('Faturado');
      break;
    case 'CreditCardPaid':
      output.append('Pago em CartÃ£o de crÃ©dito');
      break;
    case '':
      output.append('Credential doesnt allow issue');
      break;
    default:
      Resources.translateServiceDefinitionType({code: opt_data.code}, output);
  }
  if (!opt_sb) return output.toString();
};


Resources.translateServiceDefinitionType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  switch (opt_data.code) {
    case '46':
    case '5406':
      output.append('Ordem de ServiÃ§o');
      break;
    case '1888':
      output.append('Pedido de Seguro');
      break;
    case '4825':
    case '5545':
      output.append('Reserva (AÃ©reo)');
      break;
    case '5342':
      output.append('EmissÃ£o');
      break;
    case '5346':
    case '5546':
      output.append('Reserva (Hotel)');
      break;
    case '5377':
      output.append('Reserva (Ingresso)');
      break;
    case '5547':
      output.append('Pedido (AÃ©reo)');
      break;
    case '5548':
      output.append('Pedido (Hotel)');
      break;
    case '5763':
      output.append('Pedido (Carro)');
      break;
    case '5774':
      output.append('Adiantamento');
      break;
    case '5786':
      output.append('Reserva (Carro)');
      break;
    case '5816':
      output.append('Reembolso');
      break;
    default:
      Resources.pointOfEntranceTranslations({code: opt_data.code}, output);
  }
  if (!opt_sb) return output.toString();
};


Resources.translateB2CServiceItemStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  switch (opt_data.code) {
    case 'AnÃ¡lise de Risco Manual':
    case 'AnaliseRiscoManual':
      output.append('Em Atendimento');
      break;
    case 'Aguardando Pagamento':
    case 'AguardandoPagamento':
      output.append('Em Atendimento');
      break;
    case 'Pago':
      output.append('Em Atendimento');
      break;
    case 'EmCancelamento':
    case 'Em Cancelamento':
      output.append('Em Cancelamento');
      break;
    case 'EmAnaliseRisco':
    case 'Em AnÃ¡lise de Risco':
      output.append('Em Atendimento');
      break;
    case 'EmEmissao':
    case 'Em EmissÃ£o':
      output.append('Em Atendimento');
      break;
    case 'ReprovadoAnaliseRisco':
    case 'Reprovado AnÃ¡lise Risco':
      output.append('Em Atendimento');
      break;
    case 'EmitirVoucher':
    case 'Emitir Voucher':
      output.append('Em Atendimento');
      break;
    case 'ErroEmissao':
    case 'Erro EmissÃ£o':
      output.append('Em Atendimento');
      break;
    case 'EmissÃ£o Manual':
    case 'EmissaoManual':
      output.append('Em Atendimento');
      break;
    case 'Integrado':
    case 'ErroIntegracao':
    case 'EmIntegracao':
    case 'Emitido2':
    case 'EmIntegracaoCancelado':
    case 'ErroIntegracaoCancelado':
      output.append('ConcluÃ­do');
      break;
    case 'Emitido':
      output.append('ConcluÃ­do');
      break;
    case 'Cancelado':
      output.append('Cancelado');
      break;
    case 'AguardandoSolicitacao':
      output.append('Em Atendimento');
      break;
    case 'PendenteInformacao':
      output.append('Em Atendimento');
      break;
    case 'AguardandoConfirmacao':
    case 'Aguardando ConfirmaÃ§Ã£o':
      output.append('Em Atendimento');
      break;
    default:
      output.append('Em Atendimento');
  }
  if (!opt_sb) return output.toString();
};


Resources.translateAirPacCommandType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.commandtype) {
    case 'AirLineCodeCommission':
    case 'airLineCodeCommission':
    case 'airlinecodecommission':
    case '0':
    case 0:
      Resources.translate({code: 'AirLineCodeCommission'}, output);
      break;
    case 'Commission':
    case 'commission':
    case '1':
    case 1:
      Resources.translate({code: 'Commission'}, output);
      break;
    case 'OptionalInformation':
    case 'optionalInformation':
    case 'optionalinformation':
    case '2':
    case 2:
      Resources.translate({code: 'OptionalInformation'}, output);
      break;
    case 'TicketNumberFreeText':
    case 'ticketNumberFreeText':
    case 'ticketnumberfreetext':
    case '3':
    case 3:
      Resources.translate({code: 'TicketNumberFreeText'}, output);
      break;
    default:
      Resources.translate({code: 'Any'}, output);
      output.append(' ');
      Resources.translate({code: 'operation'}, output);
  }
  if (!opt_sb) return output.toString();
};


Resources.translatePersonTypeMercantil = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.PersonType) {
    case 'Natural':
    case 'natural':
    case '0':
    case 0:
      Resources.translate({code: 'Natural'}, output);
      break;
    case 'Legal':
    case 'legal':
    case '1':
    case 1:
      Resources.translate({code: 'Legal'}, output);
      break;
    case 'CTA':
    case 'cta':
    case '2':
    case 2:
      Resources.translate({code: 'CTA'}, output);
      break;
  }
  if (!opt_sb) return output.toString();
};


Resources.translatePointOfEntrance = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  Resources.translate({code: 'poe' + opt_data.pointOfEntrance}, output);
  if (!opt_sb) return output.toString();
};


Resources.translateDemandedBy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  Resources.translate({code: opt_data.demandedBy}, output);
  if (!opt_sb) return output.toString();
};


Resources.pointOfEntranceTranslations = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.code) {
    case 'poeChangeStatus':
      output.append('Troca de Status');
      break;
    case 'poeSmartBookPNR':
      output.append('Reserva');
      break;
    case 'poeRevalidatePNR':
      output.append('RevalidaÃ§Ã£o de PNR');
      break;
    case 'poePricePNR':
      output.append('PrecificaÃ§Ã£o de PNR');
      break;
    case 'poePricePnr':
      output.append('TarifaÃ§Ã£o da Reserva');
      break;
    case 'poeAddPnrInServiceOrder':
      output.append('InclusÃ£o de PNR');
      break;
    case 'poeProcessOrder':
      output.append('Processamento de Ordem de ServiÃ§o');
      break;
    case 'poeCancelTickets':
      output.append('Cancelamento de Bilhete(s)');
      break;
    case 'poeIssueTickets':
      output.append('EmissÃ£o de Bilhete(s)');
      break;
    case 'poeRetrieve':
      output.append('Retrieve');
      break;
    case 'poeCancelPNR':
      output.append('Cancelamento de Reserva');
      break;
    case 'poeBookPNR':
      output.append('EdiÃ§Ã£o da Reserva');
      break;
    case 'poeIgnoreChanges':
      output.append('Ignorar AlteraÃ§Ãµes da Reserva');
      break;
    case 'poeRemoveResponsibility':
      output.append('RemoÃ§Ã£o de Responsabilidade');
      break;
    case 'poeSetResponsibility':
      output.append('AdiÃ§Ã£o de Responsabilidade');
      break;
    case 'poeProcessServiceItem':
      output.append('GravaÃ§Ã£o de Item de ServiÃ§o');
      break;
    case 'poeProcessServiceItems':
      output.append('GravaÃ§Ã£o de Item de ServiÃ§o');
      break;
    case 'poeSplitPNR':
      output.append('Split de PNR');
      break;
    case 'poeRetrieveByLoc':
      output.append('Retrieve via Localizador');
      break;
    case 'poeCancelByLoc':
      output.append('Cancelamento via Localizador');
      break;
    case 'poeCommitChanges':
      output.append('Confirmar Troca de Voos');
      break;
    case 'poeIssueTicket':
      output.append('EmissÃ£o Manual de Bilhetes');
      break;
    case 'poeSmartBookPNR':
      output.append('Reserva');
      break;
    case 'poeRevalidatePNR':
      output.append('RevalidaÃ§Ã£o de PNR');
      break;
    case 'poePricePNR':
      output.append('PrecificaÃ§Ã£o de PNR');
      break;
    case 'poePricePnr':
      output.append('TarifaÃ§Ã£o da Reserva');
      break;
    case 'poeAddPnrInServiceOrder':
      output.append('InclusÃ£o de PNR');
      break;
    case 'poeProcessOrder':
      output.append('Processamento de Ordem de ServiÃ§o');
      break;
    case 'poeCancelTickets':
      output.append('Cancelamento de Bilhete(s)');
      break;
    case 'poeIssueTickets':
      output.append('EmissÃ£o de Bilhete(s)');
      break;
    case 'poeRetrieve':
      output.append('Retrieve');
      break;
    case 'poeCancelPNR':
      output.append('Cancelamento de Reserva');
      break;
    case 'poeRemoveSegment':
      output.append('Cancelamento de Segmentos');
      break;
    case 'poeBookPNR':
      output.append('EdiÃ§Ã£o da Reserva');
      break;
    case 'poeRemoveResponsibility':
      output.append('RemoÃ§Ã£o de Responsabilidade');
      break;
    case 'poeSetResponsibility':
      output.append('AdiÃ§Ã£o de Responsabilidade');
      break;
    case 'poeProcessServiceItem':
      output.append('GravaÃ§Ã£o de Item de ServiÃ§o');
      break;
    case 'poeSplitPNR':
      output.append('Split de PNR');
      break;
    case 'poeRetrieveByLoc':
      output.append('Retrieve via Localizador');
      break;
    case 'poeCancelByLoc':
      output.append('Cancelamento via Localizador');
      break;
    case 'poeProcessExtension':
      output.append('Processamento de ExtensÃ£o');
      break;
    case 'poeCommitChanges':
      output.append('Confirmar Troca de Voos');
      break;
    case 'poeIssueTicket':
      output.append('EmissÃ£o de Bilhete(s)');
      break;
    case 'poeCancelTicket':
      output.append('Cancelamento de Bilhete(s)');
      break;
    case 'poeBookSeat':
      output.append('Reserva de Assento(s)');
      break;
    case 'poeSetHasBeenPaidOnceItems':
      output.append('InclusÃ£o de Pagamento no Caixa');
      break;
    case 'ExecutionTime.TravelEngineSeek':
      output.append('Tempo total de pesquisa com os fornecedores');
      break;
    case 'ExecutionTime.TravelEngineInner':
      output.append('TravelEngine (interno)');
      break;
    case 'ExecutionTime.OrchestrationOuter':
      output.append('Orchestration (externo)');
      break;
    case 'ExecutionTime.TravelEngineOuter':
      output.append('TravelEngine (externo)');
      break;
    case 'ExecutionTime.OrchestrationInner':
      output.append('Orchestration (interno)');
      break;
    case 'ExecutionTime.ResolvePricing':
      output.append('AplicaÃ§Ã£o do pricing');
      break;
    case 'ExecutionTime.ResolveCarBlackLists':
      output.append('Black list de carros');
      break;
    case 'ExecutionTime.ResolveHotelRoomsSearchActions':
      output.append('RemoÃ§Ã£o/ordenaÃ§Ã£o de quartos');
      break;
    case 'ExecutionTime.ResolveSearchOrderPreferences':
      output.append('OrdenaÃ§Ã£o preferencial');
      break;
    case 'ExecutionTime.ResolvePaymentOptions':
      output.append('AplicaÃ§Ã£o das opÃ§Ãµes de pagamento');
      break;
    case 'ExecutionTime.RemoveDuplication':
      output.append('RemoÃ§Ã£o de duplicaÃ§Ã£o');
      break;
    case 'ExecutionTime.ResolveExchangeRates':
      output.append('AplicaÃ§Ã£o de cÃ¢mbio');
      break;
    case 'ExecutionTime.FinalizingResponse':
      output.append('Ajustando fim da pesquisa');
      break;
    case 'ExecutionTime.ResolveWhiteList':
      output.append('White list');
      break;
    case 'ExecutionTime.ResolveBlackList':
      output.append('Black list');
      break;
    case 'ExecutionTime.SearchDuration':
      output.append('Tempo total de pesquisa');
      break;
    default:
      Resources.demandedByTranslations({code: opt_data.code}, output);
  }
  if (!opt_sb) return output.toString();
};


Resources.demandedByTranslations = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.code) {
    case 'Interface':
      output.append('Interface');
      break;
    case 'WorkflowAction':
      output.append('AÃ§Ã£o do RobÃ´');
      break;
    case 'ExternalTrigger':
      output.append('AÃ§Ã£o AutomÃ¡tica');
      break;
    case 'FlowTrigger':
      output.append('Fluxo AutomÃ¡tico');
      break;
    case 'Retrieve':
      output.append('Sistema');
      break;
    case 'UpdateExchangeRates':
      output.append('AtualizaÃ§Ã£o AutomÃ¡tica de CÃ¢mbios');
      break;
    default:
      Resources.ruleEngine({code: opt_data.code}, output);
  }
  if (!opt_sb) return output.toString();
};


Resources.commissionRoleTranslate = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.role) {
    case 'Manager':
    case '1':
    case 1:
      output.append('Gestor - Empresa');
      break;
    case 'Responsible':
    case '2':
    case 2:
      output.append('ResponsÃ¡vel - Item de serviÃ§o');
      break;
    case 'Issuer':
    case '3':
    case 3:
      output.append('Emissor');
      break;
    case 'CorporateClient':
    case '4':
    case 4:
      output.append('Cliente Corporativo - Contexto');
      break;
    case 'Agency':
    case '5':
    case 5:
      output.append('AgÃªncia - Contexto');
      break;
    case 'ConsolidatorOperator':
    case '6':
    case 6:
      output.append('Consolidadora/Operadora - Contexto');
      break;
    default:
      Resources.translate({code: opt_data.role}, output);
  }
  if (!opt_sb) return output.toString();
};


Resources.cruiseFareStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.status) {
    case 'Closed':
    case '3':
    case 3:
      output.append('IndisponÃ­vel');
      break;
    case 'WaitList':
    case '1':
    case 1:
      output.append('Lista de espera');
      break;
    case 'Available':
    case '0':
    case 0:
      output.append('DisponÃ­vel');
      break;
    case 'Guaranteed':
    case '2':
    case 2:
      output.append('Garantida');
      break;
    default:
      output.append(soy.$$escapeHtml(opt_data.status));
  }
  if (!opt_sb) return output.toString();
};


Resources.measureTypes = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.status) {
    case 'Feet':
    case '0':
    case 0:
      output.append('PÃ©s');
      break;
    case 'Knots':
    case '1':
    case 1:
      output.append('NÃ³s');
      break;
    case 'SquareFeet':
    case '2':
    case 2:
      output.append('PÃ©s quadrados');
      break;
    case 'Inches':
    case '3':
    case 3:
      output.append('Polegadas');
      break;
    case 'Unit':
    case '4':
    case 4:
      output.append('Unidades');
      break;
    case 'Tons':
    case '5':
    case 5:
      output.append('Toneladas');
      break;
    case 'Meters':
    case '6':
    case 6:
      output.append('Metros');
      break;
    case 'KilometersPerHour':
    case '7':
    case 7:
      output.append('Km/h');
      break;
    default:
      output.append(soy.$$escapeHtml(opt_data.status));
  }
  if (!opt_sb) return output.toString();
};


Resources.cruiseCabinPositionInShip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.code) {
    case 'Unknown':
    case '0':
    case 0:
      output.append('Desconhecido');
      break;
    case 'Aft':
    case '1':
    case 1:
      output.append('Aft');
      break;
    case 'Forward':
    case '2':
    case 2:
      output.append('Forward');
      break;
    case 'Midship':
    case '3':
    case 3:
      output.append('Midship');
      break;
    default:
      output.append(soy.$$escapeHtml(opt_data.code));
  }
  if (!opt_sb) return output.toString();
};


Resources.cruiseCabinFilters = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.code) {
    case 'Balcony':
    case '1':
    case 1:
      output.append('Balcony');
      break;
    case 'Bath':
    case '2':
    case 2:
      output.append('Bath');
      break;
    case 'BathAndShower':
    case '3':
    case 3:
      output.append('Bath and Shower');
      break;
    case 'ConnectingRoom':
    case '4':
    case 4:
      output.append('Connecting Room');
      break;
    case 'Convertible':
    case '5':
    case 5:
      output.append('Convertible');
      break;
    case 'Cot':
    case '6':
    case 6:
      output.append('Cot');
      break;
    case 'Crib':
    case '7':
    case 7:
      output.append('Crib');
      break;
    case 'DeckFilter':
    case '8':
    case 8:
      output.append('Deck Filter');
      break;
    case 'Disabled':
    case '9':
    case 9:
      output.append('Disabled');
      break;
    case 'Inside':
    case '10':
    case 10:
      output.append('Inside');
      break;
    case 'NearLift':
    case '11':
    case 11:
      output.append('Near Lift');
      break;
    case 'NoBedBelection':
    case '12':
    case 12:
      output.append('No Bed Belection');
      break;
    case 'Outside':
    case '13':
    case 13:
      output.append('Outside');
      break;
    case 'Porthole':
    case '14':
    case 14:
      output.append('Porthole');
      break;
    case 'QueenBed':
    case '15':
    case 15:
      output.append('Queen Bed');
      break;
    case 'Refrigerator':
    case '16':
    case 16:
      output.append('Refrigerator');
      break;
    case 'Rollaway':
    case '17':
    case 17:
      output.append('Rollaway');
      break;
    case 'Shower':
    case '18':
    case 18:
      output.append('Shower');
      break;
    case 'Sofa':
    case '19':
    case 19:
      output.append('Sofa');
      break;
    case 'Window':
    case '20':
    case 20:
      output.append('Window');
      break;
    case 'Bathtub':
    case '21':
    case 21:
      output.append('Bathtub');
      break;
    case 'SeparateShower':
    case '22':
    case 22:
      output.append('Separate Shower');
      break;
    case 'Whirlpool':
    case '23':
    case 23:
      output.append('Whirlpool');
      break;
    case 'Jacuzzi':
    case '24':
    case 24:
      output.append('Jacuzzi');
      break;
    case 'HotTub':
    case '25':
    case 25:
      output.append('Hot Tub');
      break;
    case 'ConvertibleLowerBeds':
    case '26':
    case 26:
      output.append('Convertible Lower Beds');
      break;
    case 'ConvertibleDoubleSofaBed':
    case '27':
    case 27:
      output.append('Convertible Double Sofa Bed');
      break;
    case 'ConvertibleSingleSofaBed':
    case '28':
    case 28:
      output.append('Convertible Single Sofa Bed');
      break;
    case 'DoubleBed':
    case '29':
    case 29:
      output.append('Double Bed');
      break;
    case 'KingSizeBed':
    case '30':
    case 30:
      output.append('King Size Bed');
      break;
    case 'MurphyBedUpper':
    case '31':
    case 31:
      output.append('Murphy Bed Upper');
      break;
    case 'MurphyBedLower':
    case '32':
    case 32:
      output.append('Murphy Bed Lower');
      break;
    case 'DoubleMurphyBedLower':
    case '33':
    case 33:
      output.append('Double Murphy Bed Lower');
      break;
    case 'DoubleMurphyBedUpper':
    case '34':
    case 34:
      output.append('Double Murphy Bed Upper');
      break;
    case 'PullmanBed':
    case '35':
    case 35:
      output.append('Pullman Bed');
      break;
    case 'PulloutBed':
    case '36':
    case 36:
      output.append('Pullout Bed');
      break;
    case 'RollawayCannotBeCombinedWithCrib':
    case '37':
    case 37:
      output.append('Rollaway Cannot Be Combined With Crib');
      break;
    case 'StationaryLowerBed':
    case '38':
    case 38:
      output.append('Stationary Lower Bed');
      break;
    case 'BedBoards':
    case '39':
    case 39:
      output.append('Bed Boards');
      break;
    case 'LargePortholeWindow':
    case '40':
    case 40:
      output.append('Large Porthole Window');
      break;
    case 'ObstructedView':
    case '41':
    case 41:
      output.append('Obstructed to oView');
      break;
    case 'FloorToCeilingGlassDoors':
    case '42':
    case 42:
      output.append('Floor To Ceiling Glass Doors');
      break;
    case 'SlidingGlassDoor':
    case '43':
    case 43:
      output.append('Sliding Glass Door');
      break;
    case 'ButlerService':
    case '44':
    case 44:
      output.append('Butler Service');
      break;
    case 'Concierge':
    case '45':
    case 45:
      output.append('Concierge');
      break;
    case 'Bar':
    case '46':
    case 46:
      output.append('Bar');
      break;
    case 'MiniBar':
    case '47':
    case 47:
      output.append('Mini Bar');
      break;
    case 'BedExtensions':
    case '48':
    case 48:
      output.append('Bed Extensions');
      break;
    case 'BedRails':
    case '49':
    case 49:
      output.append('Bed Rails');
      break;
    case 'Duvet':
    case '50':
    case 50:
      output.append('Duvet');
      break;
    case 'BayWindow':
    case '51':
    case 51:
      output.append('Bay Window');
      break;
    case 'PrivateBalcony':
    case '52':
    case 52:
      output.append('Private Balcony');
      break;
    case 'FloorToCeilingWindow':
    case '53':
    case 53:
      output.append('Floor To Ceiling Window');
      break;
    case 'PictureWindow':
    case '54':
    case 54:
      output.append('Picture Window');
      break;
    case 'BabyGrandPiano':
    case '55':
    case 55:
      output.append('Baby Grand Piano');
      break;
    case 'ComputerJack':
    case '56':
    case 56:
      output.append('Computer Jack');
      break;
    case 'Desk':
    case '57':
    case 57:
      output.append('Desk');
      break;
    case 'Dresser':
    case '58':
    case 58:
      output.append('Dresser');
      break;
    case 'Vanity':
    case '59':
    case 59:
      output.append('Vanity');
      break;
    case 'HairDryer':
    case '60':
    case 60:
      output.append('Hair Dryer');
      break;
    case 'CDLibrary':
    case '61':
    case 61:
      output.append('CD Library');
      break;
    case 'DigitalVideoDiscLibrary':
    case '62':
    case 62:
      output.append('Digital Video Disc Library');
      break;
    case 'DigitalVideoDiscPlayer':
    case '63':
    case 63:
      output.append('Digital Video Disc Player');
      break;
    case 'LaserCDPlayer':
    case '64':
    case 64:
      output.append('Laser CD Player');
      break;
    case 'Safe':
    case '65':
    case 65:
      output.append('Safe');
      break;
    case 'StereoCDPlayer':
    case '66':
    case 66:
      output.append('Stereo CD Player');
      break;
    case 'Telephone':
    case '67':
    case 67:
      output.append('Telephone');
      break;
    case 'Television':
    case '68':
    case 68:
      output.append('Television');
      break;
    case 'VCR':
    case '69':
    case 69:
      output.append('VCR');
      break;
    case 'SittingArea':
    case '70':
    case 70:
      output.append('Sitting Area');
      break;
    case 'DiningRoom':
    case '71':
    case 71:
      output.append('Dining Room');
      break;
    case 'LivingRoom':
    case '72':
    case 72:
      output.append('Living Room');
      break;
    case 'MasterBedroom':
    case '73':
    case 73:
      output.append('Master Bedroom');
      break;
    case 'PrivateGarden':
    case '74':
    case 74:
      output.append('Private Garden');
      break;
    case 'PrivateLounge':
    case '75':
    case 75:
      output.append('Private Lounge');
      break;
    case 'SeparateBedroom':
    case '76':
    case 76:
      output.append('Separate Bedroom');
      break;
    case 'SeparatedWithACurtain':
    case '77':
    case 77:
      output.append('Separated With A Curtain');
      break;
    case 'SteamRoom':
    case '78':
    case 78:
      output.append('Steam Room');
      break;
    case 'StudioBedroom':
    case '79':
    case 79:
      output.append('Studio Bedroom');
      break;
    case 'WalkinCloset':
    case '80':
    case 80:
      output.append('Walkin Closet');
      break;
    case 'NoCabinDescriptionSupported':
    case '81':
    case 81:
      output.append('No Cabin Description Supported');
      break;
    default:
      output.append(soy.$$escapeHtml(opt_data.code));
  }
  if (!opt_sb) return output.toString();
};


Resources.ruleEngine = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  switch (opt_data.code) {
    case 'Add Line':
      output.append('Adicionar Linha');
      break;
    case 'BusSourceType':
      output.append('Fornecedor de Ã´nibus');
      break;
    case 'BusTotalAmount':
      output.append('Total do Ãnibus');
      break;
    case 'Select a option':
      output.append('Selecione uma opÃ§Ã£o');
      break;
    case 'Type cia codes separated by commas':
      output.append('Digite os cÃ³digos das Companhias AÃ©reas, separados por vÃ­rgula (ex: JJ, G3, P3)');
      break;
    case 'Type classes separated by commas':
      output.append('Digite as Classes de ServiÃ§o separadas por vÃ­rgula (ex: Y,W,X)');
      break;
    case 'Codes':
      output.append('CÃ³digos');
      break;
    case 'Delete':
      output.append('Excluir');
      break;
    case 'ServiceItemCategory':
      output.append('Categoria do Item de ServiÃ§o');
      break;
    case 'ContainedIn':
      output.append('Contido em');
      break;
    case 'NotContainedIn':
      output.append('NÃ£o contido em');
      break;
    case 'Or':
      output.append('Ou');
      break;
    case 'If YES':
      output.append('Se SIM');
      break;
    case 'ServiceItemMinimumStatusStage':
      output.append('EstÃ¡gio MÃ­nimo do Status');
      break;
    case 'Like':
      output.append('ContÃ©m');
      break;
    case 'NotLike':
      output.append('NÃ£o contÃ©m');
      break;
    case 'LowerEqual':
      output.append('Menor ou igual que');
      break;
    case 'MoreEqual':
      output.append('Maior ou igual que');
      break;
    case 'More':
      output.append('Maior que');
      break;
    case 'NotEqual':
      output.append('diferente de');
      break;
    case 'And':
      output.append('E');
      break;
    case 'ServiceItemMaximumStatusStage':
      output.append('EstÃ¡gio MÃ¡ximo do Status');
      break;
    case 'Equal':
      output.append('Igual a');
      break;
    case 'Results':
      output.append('Resultados');
      break;
    case 'If NO':
      output.append('Se NÃO');
      break;
    case 'Result':
      output.append('Resultado');
      break;
    case 'ServiceItemStatus':
      output.append('Status do Item de ServiÃ§o');
      break;
    case 'ServiceItemSubCategory':
      output.append('Sub-categoria do Item de ServiÃ§o');
      break;
    case 'Results Edit':
      output.append('EdiÃ§Ã£o de Resultados');
      break;
    case 'Confirm':
      output.append('Confirmar');
      break;
    case 'Cancel':
      output.append('Cancelar');
      break;
    case 'Terms Edit':
      output.append('EdiÃ§Ã£o de Termos');
      break;
    case 'or':
      output.append('ou');
      break;
    case 'Origins':
      output.append('Origens');
      break;
    case 'DestinationUsingFareBreak':
      output.append('Destino (considerando Quebra TarifÃ¡ria)');
      break;
    case 'DestinationsUsingFareBreak':
      output.append('Destinos (considerando Quebra TarifÃ¡ria)');
      break;
    case 'ValidatingCiaDestination':
      output.append('Destino Companhia Validadora');
      break;
    case 'ValidatingCiaOrigin':
      output.append('Origem Companhia Validadora');
      break;
    case 'OriginAirport':
      output.append('Aeroporto de Origem');
      break;
    case 'OriginAirports':
      output.append('Aeroportos de Origem');
      break;
    case 'OriginBusStation':
      output.append('RodoviÃ¡ria de Origem');
      break;
    case 'OriginBusStations':
      output.append('RodoviÃ¡rias de Origem');
      break;
    case 'DestinationAirport':
      output.append('Aeroporto de Destino');
      break;
    case 'DestinationAirportUsingFareBreak':
      output.append('Aeroportos de Destino (considerando Quebra TarifÃ¡ria)');
      break;
    case 'DestinationAirports':
      output.append('Aeroportos de Destino');
      break;
    case 'DestinationAirportsUsingFareBreak':
      output.append('Aeroporto de Destino (considerando Quebra TarifÃ¡ria)');
      break;
    case 'DestinationBusStation':
      output.append('RodoviÃ¡ria de Destino');
      break;
    case 'DestinationBusStations':
      output.append('RodoviÃ¡rias de Destino');
      break;
    case 'Bit':
      output.append('Bit');
      break;
    case 'Must consider same occurency in all fare breaks':
      output.append('Deve considerar a mesma ocorrÃªncia em todas bases tarifÃ¡rias');
      break;
    case 'Yes':
      output.append('Sim');
      break;
    case 'No':
      output.append('NÃ£o');
      break;
    case 'CodeShare':
      output.append('CodeShare');
      break;
    case 'AirCompanyCode':
      output.append('CÃ³digo da Companhia AÃ©rea');
      break;
    case 'ClassesOfService':
      output.append('Classes de ServiÃ§o');
      break;
    case 'FlightNumbers':
      output.append('NÃºmeros do Voo');
      break;
    case 'ClassOfService':
      output.append('Classe de ServiÃ§o');
      break;
    case 'OutboundDate':
      output.append('Data de SaÃ­da');
      break;
    case 'InboundDate':
      output.append('Data de Chegada');
      break;
    case 'ActualDateTime':
      output.append('Data Atual');
      break;
    case 'Going':
      output.append('Ida');
      break;
    case 'Return':
      output.append('Volta');
      break;
    case 'AirCompaniesByJourney':
      output.append('Companhia AÃ©reas da Viagem');
      break;
    case 'ClassesOfServiceByJourney':
      output.append('Classes da Viagem');
      break;
    case 'TicketBRLValue':
      output.append('Valor Bilhete BRL');
      break;
    case 'TicketUSDValue':
      output.append('Valor Bilhete USD');
      break;
    case 'TaxesTotalValue':
      output.append('Valor Total da Taxas');
      break;
    case 'FeeValue':
      output.append('valor do Fee');
      break;
    case 'NacionalTrip':
      output.append('Viagem Nacional');
      break;
    case 'HasInternationalLinkedItem':
      output.append('Possui Item Internacional Associado');
      break;
    case 'IsAdvancePayment':
      output.append('Ã Sinal');
      break;
    case 'NationalHotel':
      output.append('Hotel Nacional');
      break;
    case 'HotelLocation':
      output.append('Localidade do Hotel');
      break;
    case 'OneWay':
      output.append('Somente Ida');
      break;
    case 'RoundTrip':
      output.append('Ida e Volta');
      break;
    case 'TripType':
      output.append('Tipo da Viagem');
      break;
    case 'Surface':
      output.append('Surface');
      break;
    case 'Instalment':
      output.append('Parcelamento');
      break;
    case 'Issue':
      output.append('EmissÃ£o');
      break;
    case 'ExecutionContext':
      output.append('Contexto de ExecuÃ§Ã£o');
      break;
    case 'HotelDisplayDailyFare':
      output.append('DiÃ¡ria do Hotel');
      break;
    case 'HotelTotalAmount':
      output.append('Total do Hotel');
      break;
    case 'FareBreaksQuantity':
      output.append('Quantidade de Quebras TarifÃ¡rias');
      break;
    case 'TriangularRoute':
      output.append('Rota Triangular');
      break;
    case 'NumberSections':
      output.append('NÃºmero de Trechos');
      break;
    case 'SurfacesQuantity':
      output.append('Quantida de Surfaces');
      break;
    case 'IATAS':
      output.append('IATAS');
      break;
    case 'Type location IATAS separated by commas':
      output.append('Digite as IATAS das localidades, separadas por vÃ­rgula (ex: SAO,RIO,MIA)');
      break;
    case 'HasAirData':
      output.append('Tem AÃ©reo');
      break;
    case 'HasHotelData':
      output.append('Tem Hotel');
      break;
    case 'HasServiceData':
      output.append('Tem ServiÃ§o');
      break;
    case 'HasBusData':
      output.append('Tem Ãnibus');
      break;
    case 'HasCarData':
      output.append('Tem Carro');
      break;
    case 'HasTourData':
      output.append('Tem Circuito');
      break;
    case 'HasCruiseData':
      output.append('Tem Cruzeiro');
      break;
    case 'HasInsuranceData':
      output.append('Tem Seguro');
      break;
    case 'HotelSourceType':
      output.append('Fornecedor de hotel');
      break;
    case 'AirSourceType':
      output.append('Fornecedor de aÃ©reo');
      break;
    case 'IsItinerarySale':
      output.append('Venda de roteiro?');
      break;
    case 'ItineraryName':
      output.append('Nome do roteiro');
      break;
    case 'InsuranceSourceType':
      output.append('Fornecedor de seguro');
      break;
    case 'TourSourceType':
      output.append('Fornecedor de circuito');
      break;
    case 'InsuranceCompanyName':
      output.append('Corretora');
      break;
    case 'CruiseSourceType':
      output.append('Fornecedor de cruzeiro');
      break;
    case 'SourceType':
      output.append('Sistema');
      break;
    case 'OperatorFare':
      output.append('Tarifa Operadora');
      break;
    case 'NumberOfPayments':
      output.append('Quantidade de Pagamentos');
      break;
    case 'PaymentTypes':
      output.append('Tipos de Pagamento');
      break;
    case 'PaymentsTotalValue':
      output.append('Valor Total dos Pagamentos');
      break;
    case 'PaymentsIndividualValue':
      output.append('Valor Individual dos Pagamentos');
      break;
    case 'CreditCardProviders':
      output.append('Bandeira do CartÃ£o de CrÃ©dito');
      break;
    case 'NumberOfInstallments':
      output.append('Quantidade de Parcelas');
      break;
    case 'SupplierAccepted':
      output.append('Pagamento Aceito Pelo Fornecedor');
      break;
    case 'IsOperatorFare':
      output.append('Ã Tarifa Operadora');
      break;
    case 'IsInternational':
      output.append('Ã Internacional');
      break;
    case 'PaymentFareBasis':
      output.append('Base TarifÃ¡ria');
      break;
    case 'ClientSupplier':
      output.append('Cliente-Fornecedor');
      break;
    case 'Empty Condition':
      output.append('CondiÃ§Ã£o vazia');
      break;
    case 'Unknown Result':
      output.append('Resultado desconhecido');
      break;
    case 'Unknown Result':
      output.append('Resultado desconhecido');
      break;
    case 'LoginInformationName':
      output.append('Nome da Credencial');
      break;
    case 'IsInsuranceOperatorFare':
      output.append('Tarifa Operadora de Seguro');
      break;
    case 'HotelSupplierName':
      output.append('Nome do Fornecedor de Hotel');
      break;
    default:
      Resources.DashboardsFilters({code: opt_data.code}, output);
  }
  if (!opt_sb) return output.toString();
};


Resources.DashboardsFilters = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  switch (opt_data.code) {
    case 'CorporateCostumer':
      output.append('Cliente Corporativo');
      break;
    case 'Consolidator':
      output.append('Consolidadora');
      break;
    case 'TravelAgency':
      output.append('AgÃªncia');
      break;
    case 'ServiceOrderId':
      output.append('Id da OS');
      break;
    case 'ServiceItemId':
      output.append('Id do Item de ServiÃ§o');
      break;
    case 'StatusPnr':
      output.append('Status no Fornecedor');
      break;
    case 'CreatedDate':
      output.append('Data de CriaÃ§Ã£o');
      break;
    case 'IssuedDate':
      output.append('Data de EmissÃ£o');
      break;
    default:
      output.append((Global && Global.IsDebugContext) ? '*** ' + soy.$$escapeHtml(opt_data.code) + ' ***' : soy.$$escapeHtml(opt_data.code));
  }
  if (!opt_sb) return output.toString();
};


Resources.cruiseSuperCategoryNames = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  switch (opt_data.code) {
    case 'Inside':
      output.append('Interna');
      break;
    case 'OceanView':
      output.append('Externa');
      break;
    case 'Balcony':
      output.append('Varanda');
      break;
    case 'Deluxe':
      output.append('SuÃ­te');
      break;
    default:
      output.append(soy.$$escapeHtml(opt_data.code));
  }
  if (!opt_sb) return output.toString();
};


ï»¿(function ($) {

    function DatePickerManager() {

        var component = undefined;
        var _settings = {
        }
        this.initialize = function (target, opts) {
            component = $(target);
            $.extend(true, _settings, opts || {});

            initializeMobile(target, opts);
        }

        function initializeMobile(target, opts) {
            try {
                component.attr("type", "date");
            } catch (e) {
                component.prop("type", "date");
            } 
            

            if (opts.defaultDate) {
                _functionsMobile.setDate(opts.defaultDate);
            }
            if (opts.minDate) {
                _functionsMobile.minDate(opts.minDate);
            }
            if (opts.maxDate) {
                _functionsMobile.maxDate(opts.maxDate);
            }
        }

        this.getDate = function () {
            return _functionsMobile.getDate();
        }
        this.setDate = function (value) {
            return _functionsMobile.setDate(value);
        }
        this.option = function (name, value) {
            return _functionsMobile.option(name, value);
        }
        this.destroy = function () {
            return _functionsMobile.destroy();
        }
        this.val = function (value) {
            return _functionsMobile.val(value);
        }

        var _functionsMobile = {
            getDate: function () {
                return Util.Html5DateToDate(component.val());
            },
            setDate: function (value) {
                if (typeof (value.val) == "function")
                {
                    var val = value.val();
                    return component.val(val);
                }
                else
                    return component.val(Util.DateToHtml5Date(value));
            },
            option: function (name, value) {
                if (typeof (_functionsMobile[name]) != "undefined")
                    return _functionsMobile[name](value);
                else
                    return component;
            },
            minDate: function (value) {
                if (value) {
                    _functionsMobile.setDateIfLessThanMinValue(value);
                    component.attr('min', Util.DateToHtml5Date(value));
                    return component.attr('minDate', Util.DateToHtml5Date(value));
                }
                else {
                    var returnValue = component.attr('minDate');
                    if (!returnValue)
                        returnValue = component.val();
                    return Util.Html5DateToDate(returnValue);
                }
            },
            maxDate: function (value) {
                if (value) {
                    component.attr('max', Util.DateToHtml5Date(value));
                    return component.attr('maxDate', Util.DateToHtml5Date(value));
                }
                else {
                    var returnValue = component.attr('maxDate');
                    if (!returnValue)
                        returnValue = component.val();
                    return Util.Html5DateToDate(returnValue);
                }
            },
            destroy: function () {
                return component.datepicker("destroy");
            },
            val: function (value) {
                if (typeof (value) == "string")
                    return component.val(Util.StringToHtml5Date(value));
                if (value)
                    return component.val(Util.DateToHtml5Date(value));
                else {
                    var returnValue = component.val();
                    if (returnValue)
                        returnValue = Util.Html5DateToString(returnValue);
                    return returnValue
                }
            },
            setDateIfLessThanMinValue: function (minDate) {
                var currentDate = _functionsMobile.getDate();
                if (currentDate < minDate)
                    _functionsMobile.setDate(minDate);
            }
        }

    }


    function mobileBehaviour(component, args) {
        if (component.data(Util.GetPluginDataToken('datePickerManager')))
            return Util.pluginDefaultBehavior(component, "datePickerManager", args, function () { return new DatePickerManager() });
        else if (args && args.length && typeof (args[0]) != "string")
            return Util.pluginDefaultBehavior(component, "datePickerManager", args, function () { return new DatePickerManager() });
        else
            return component;
    }

    function listHasThisParameter(list, param) {
        if (list && list.length)
        {
            for (var i = 0; i < list.length; i++) {
                if (list[i] == param)
                    return true;
            }
        }
        return false;
    }

    function datepickerBehaviour(component, args) {
        if (listHasThisParameter(args, "val")) {
            if (args.length > 1)
                return component.val(args[1]);
            else
                return component.val();
        }
        else if (args) {
            return component.datepicker.apply(component, args);
        }
    }

    $.fn.datepickermanager = function () {
        if (Global.Mobile) {
            return mobileBehaviour(this, arguments);
        }
        else {
            return datepickerBehaviour(this, arguments);
        }
    }


})(jQuery);

/**
* MONTHS ONLY
* @version: 1.3.7
* @author: Dan Grossman http://www.dangrossman.info/
* @updated by: Rony Klachko - Added month view mode + additional setting options + support init by html data attributes + minor bugfixes
* @date: 2014-05-21
* @copyright: Copyright (c) 2012-2014 Dan Grossman. All rights reserved.
* @license: Licensed under Apache License v2.0. See http://www.apache.org/licenses/LICENSE-2.0
* @website: http://www.improvely.com/
*/
!function ($, moment) {

    var DateRangePicker = function (element, options, cb) {


        // by default, the daterangepicker element is placed at the bottom of HTML body
        this.parentEl = 'body';

        //element that triggered the date range picker
        this.element = $(element);

        if (!options.additionalClass)
            options.additionalClass = '';

        var formInputsHtml = '';
        if (!options.hideFormInputs) {
            formInputsHtml = '<div class="daterangepicker_start_input">' +
                '<label for="daterangepicker_start"></label>' +
                '<input class="input-mini" type="text" name="daterangepicker_start" value="" disabled="disabled" />' +
                '</div>' +
                '<div class="daterangepicker_end_input">' +
                '<label for="daterangepicker_end"></label>' +
                '<input class="input-mini" type="text" name="daterangepicker_end" value="" disabled="disabled" />' +
                '</div>';
        }

        //create the picker HTML object
        var DRPTemplate = '<div class="daterangepicker dropdown-menu ' + options.additionalClass + '">' +
            '<div class="calendar left"></div>' +
            '<div class="calendar right"></div>' +
            '<div class="ranges">' +
            '<div class="range_inputs">' + formInputsHtml +
            '<button class="applyBtn" disabled="disabled"></button>&nbsp;' +
            '<button class="cancelBtn"></button>' +
            '</div>' +
            '</div>' +
            '</div>';

        //custom options
        if (typeof options !== 'object' || options === null)
            options = {};

        this.parentEl = this.element.is('div') ? this.element : (typeof options === 'object' && options.parentEl && $(options.parentEl).length) || $(this.parentEl);
        this.container = $(DRPTemplate).appendTo(this.parentEl);

        //extends passed options with html data attribute options.
        $.extend(options, element.data('options'));
        this.setOptions(options, cb);

        //apply CSS classes and labels to buttons
        var c = this.container;
        $.each(this.buttonClasses, function (idx, val) {
            c.find('button').addClass(val);
        });
        this.container.find('.daterangepicker_start_input label').html(this.locale.fromLabel);
        this.container.find('.daterangepicker_end_input label').html(this.locale.toLabel);
        if (this.applyClass.length)
            this.container.find('.applyBtn').addClass(this.applyClass);
        if (this.cancelClass.length)
            this.container.find('.cancelBtn').addClass(this.cancelClass);
        this.container.find('.applyBtn').html(this.locale.applyLabel);
        this.container.find('.cancelBtn').html(this.locale.cancelLabel);

        //event listeners

        this.container.find('.calendar')
            .on('click.daterangepicker', '.prev', $.proxy(this.clickPrev, this))
            .on('click.daterangepicker', '.next', $.proxy(this.clickNext, this))
            .on('click.daterangepicker', 'td.available', $.proxy(this.clickDate, this))
            .on('mouseenter.daterangepicker', 'td.available', $.proxy(this.enterDate, this))
            .on('mouseleave.daterangepicker', 'td.available', $.proxy(this.updateFormInputs, this))
            .on('change.daterangepicker', 'select.yearselect', $.proxy(this.updateMonthYear, this))
            .on('change.daterangepicker', 'select.monthselect', $.proxy(this.updateMonthYear, this))
            .on('change.daterangepicker', 'select.hourselect,select.minuteselect,select.ampmselect', $.proxy(this.updateTime, this));

        this.container.find('.ranges')
            .on('click.daterangepicker', 'button.applyBtn', $.proxy(this.clickApply, this))
            .on('click.daterangepicker', 'button.cancelBtn', $.proxy(this.clickCancel, this))
            .on('click.daterangepicker', '.daterangepicker_start_input,.daterangepicker_end_input', $.proxy(this.showCalendars, this))
            .on('click.daterangepicker', 'li', $.proxy(this.clickRange, this))
            .on('mouseenter.daterangepicker', 'li', $.proxy(this.enterRange, this))
            .on('mouseleave.daterangepicker', 'li', $.proxy(this.updateFormInputs, this));

        if (this.element.is('input')) {
            this.element.on({
                'click.daterangepicker': $.proxy(this.show, this),
                'focus.daterangepicker': $.proxy(this.show, this),
                'keyup.daterangepicker': $.proxy(this.updateFromControl, this)
            });
        } else {
            //this.element.on('click.daterangepicker', $.proxy(this.toggle, this));
            this.show();
        }

        //external
    };

    DateRangePicker.prototype = {

        constructor: DateRangePicker,

        setOptions: function (options, callback) {

            this.minViewMode = 'day';

            if (typeof options.minViewMode === 'string') {
                this.minViewMode = options.minViewMode;
            }

            this.startDate = moment().startOf(this.minViewMode);
            this.endDate = moment().add('year', 1).endOf(this.minViewMode);
            this.minDate = false;
            this.maxDate = false;
            this.dateLimit = false;

            this.showDropdowns = false;
            this.showWeekNumbers = false;
            this.hideFormInputs = false;
            this.alwaysShowCalendars = false;
            this.autoApplyClickedRange = true;
            this.timePicker = false;
            this.timePickerIncrement = 30;
            this.timePicker12Hour = true;
            this.singleDatePicker = false;
            this.ranges = {};
            this.callUpdateCalendars = function () {
                this.updateCalendars();
            };

            this.opens = 'right';
            if (this.element.hasClass('pull-right'))
                this.opens = 'left';

            this.buttonClasses = ['btn', 'btn-small'];
            this.applyClass = 'btn-success';
            this.cancelClass = 'btn-default';

            this.format = this.viewModes[this.minViewMode].defaultFormat;
            this.separator = ' - ';

            this.locale = {
                applyLabel: 'Apply',
                cancelLabel: 'Cancel',
                fromLabel: 'From',
                toLabel: 'To',
                weekLabel: 'W',
                customRangeLabel: 'Custom Range',
                daysOfWeek: moment()._locale._weekdaysMin.slice(),
                monthNames: moment()._locale._monthsShort.slice(),
                firstDay: 0
            };

            this.cb = function () { };

            if (typeof options.format === 'string')
                this.format = options.format;

            if (typeof options.separator === 'string')
                this.separator = options.separator;

            if (typeof options.startDate === 'string')
                this.startDate = moment(options.startDate, this.format);

            if (typeof options.endDate === 'string')
                this.endDate = moment(options.endDate, this.format);

            if (typeof options.minDate === 'string')
                this.minDate = moment(options.minDate, this.format);

            if (typeof options.maxDate === 'string')
                this.maxDate = moment(options.maxDate, this.format);

            if (typeof options.startDate === 'object')
                this.startDate = moment(options.startDate);

            if (typeof options.endDate === 'object')
                this.endDate = moment(options.endDate);

            if (typeof options.minDate === 'object')
                this.minDate = moment(options.minDate);

            if (typeof options.maxDate === 'object')
                this.maxDate = moment(options.maxDate);

            if (options.onRenderDate)
                this.onRenderDate = options.onRenderDate;

            if (options.onRangeSelected)
                this.onRangeSelected = options.onRangeSelected;

            this.startDate = this.startDate.startOf(this.minViewMode);
            this.endDate = this.endDate.endOf(this.minViewMode);
            if (this.minDate) this.minDate = this.minDate.startOf(this.minViewMode);
            if (this.maxDate) this.maxDate = this.maxDate.endOf(this.minViewMode);

            if (typeof options.applyClass === 'string')
                this.applyClass = options.applyClass;

            if (typeof options.cancelClass === 'string')
                this.cancelClass = options.cancelClass;

            if (typeof options.dateLimit === 'object')
                this.dateLimit = options.dateLimit;


            // update day names order to firstDay
            if (typeof options.locale === 'object') {

                if (typeof options.locale.daysOfWeek === 'object') {
                    // Create a copy of daysOfWeek to avoid modification of original
                    // options object for reusability in multiple daterangepicker instances
                    this.locale.daysOfWeek = options.locale.daysOfWeek.slice();
                }

                if (typeof options.locale.monthNames === 'object') {
                    this.locale.monthNames = options.locale.monthNames.slice();
                }

                if (typeof options.locale.firstDay === 'number') {
                    this.locale.firstDay = options.locale.firstDay;
                    var iterator = options.locale.firstDay;
                    while (iterator > 0) {
                        this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift());
                        iterator--;
                    }
                }

                if (typeof options.locale.applyLabel === 'string') {
                    this.locale.applyLabel = options.locale.applyLabel;
                }

                if (typeof options.locale.cancelLabel === 'string') {
                    this.locale.cancelLabel = options.locale.cancelLabel;
                }

                if (typeof options.locale.fromLabel === 'string') {
                    this.locale.fromLabel = options.locale.fromLabel;
                }

                if (typeof options.locale.toLabel === 'string') {
                    this.locale.toLabel = options.locale.toLabel;
                }

                if (typeof options.locale.weekLabel === 'string') {
                    this.locale.weekLabel = options.locale.weekLabel;
                }

                if (typeof options.locale.customRangeLabel === 'string') {
                    this.locale.customRangeLabel = options.locale.customRangeLabel;
                }
            }

            if (typeof options.opens === 'string')
                this.opens = options.opens;

            if (typeof options.showWeekNumbers === 'boolean') {
                this.showWeekNumbers = options.showWeekNumbers;
            }

            if (typeof options.hideFormInputs === 'boolean') {
                this.hideFormInputs = options.hideFormInputs;
            }

            if (typeof options.alwaysShowCalendars === 'boolean') {
                this.alwaysShowCalendars = options.alwaysShowCalendars;
            }

            if (typeof options.autoApplyClickedRange === 'boolean') {
                this.autoApplyClickedRange = options.autoApplyClickedRange;
            }

            if (typeof options.buttonClasses === 'string') {
                this.buttonClasses = [options.buttonClasses];
            }

            if (typeof options.buttonClasses === 'object') {
                this.buttonClasses = options.buttonClasses;
            }

            if (typeof options.showDropdowns === 'boolean') {
                this.showDropdowns = options.showDropdowns;
            }

            if (typeof options.singleDatePicker === 'boolean') {
                this.singleDatePicker = options.singleDatePicker;
            }

            if (typeof options.timePicker === 'boolean') {
                this.timePicker = options.timePicker;
            }

            if (typeof options.timePickerIncrement === 'number') {
                this.timePickerIncrement = options.timePickerIncrement;
            }

            if (typeof options.timePicker12Hour === 'boolean') {
                this.timePicker12Hour = options.timePicker12Hour;
            }

            var start, end, range;

            //if no start/end dates set, check if an input element contains initial values
            if (typeof options.startDate === 'undefined' && typeof options.endDate === 'undefined') {
                if ($(this.element).is('input[type=text]')) {
                    var val = $(this.element).val();
                    var split = val.split(this.separator);
                    start = end = null;
                    if (split.length == 2) {
                        start = moment(split[0], this.format);
                        end = moment(split[1], this.format);
                    } else if (this.singleDatePicker) {
                        start = moment(val, this.format);
                        end = moment(val, this.format);
                    }
                    if (start !== null && end !== null) {
                        this.startDate = start;
                        this.endDate = end;
                    }
                }
            }

            if (typeof options.ranges === 'object') {
                for (range in options.ranges) {

                    start = moment(options.ranges[range][0]);
                    end = moment(options.ranges[range][1]);

                    // If we have a min/max date set, bound this range
                    // to it, but only if it would otherwise fall
                    // outside of the min/max.
                    if (this.minDate && start.isBefore(this.minDate))
                        start = moment(this.minDate);

                    if (this.maxDate && end.isAfter(this.maxDate))
                        end = moment(this.maxDate);

                    // If the end of the range is before the minimum (if min is set) OR
                    // the start of the range is after the max (also if set) don't display this
                    // range option.
                    if ((this.minDate && end.isBefore(this.minDate)) || (this.maxDate && start.isAfter(this.maxDate))) {
                        continue;
                    }

                    this.ranges[range] = [start, end];
                }

                var list = '<ul>';
                for (range in this.ranges) {
                    list += '<li>' + range + '</li>';
                }
                if (!this.alwaysShowCalendars) {
                    list += '<li>' + this.locale.customRangeLabel + '</li>';
                }
                list += '</ul>';
                this.container.find('.ranges ul').remove();
                this.container.find('.ranges').prepend(list);
            }

            if (typeof callback === 'function') {
                this.cb = callback;
            }

            if (!this.timePicker) {
                this.startDate = this.startDate.startOf('day');
                this.endDate = this.endDate.endOf('day');
            }

            if (this.singleDatePicker) {
                this.opens = 'right';
                this.container.find('.calendar.right').show();
                this.container.find('.calendar.left').hide();
                this.container.find('.ranges').hide();
                if (!this.container.find('.calendar.right').hasClass('single'))
                    this.container.find('.calendar.right').addClass('single');
            } else {
                this.container.find('.calendar.right').removeClass('single');
                this.container.find('.ranges').show();
            }

            this.oldStartDate = this.startDate.clone();
            this.oldEndDate = this.endDate.clone();
            this.oldChosenLabel = this.chosenLabel;

            this.setDates = this.setDates;

            this.leftCalendar = {
                month: moment([this.startDate.year(), this.startDate.month(), 1, this.startDate.hour(), this.startDate.minute()]),
                calendar: []
            };

            this.rightCalendar = {
                month: moment([this.endDate.year(), this.endDate.month(), this.endDate.daysInMonth(), this.endDate.hour(), this.endDate.minute()]),
                calendar: []
            };

            if (this.opens == 'right') {
                //swap calendar positions
                //var left = this.container.find('.calendar.left');
                //var right = this.container.find('.calendar.right');
                //left.removeClass('left').addClass('right');
                //right.removeClass('right').addClass('left');
            }

            if (typeof options.ranges === 'undefined' && !this.singleDatePicker) {
                this.container.addClass('show-calendar');
            }

            this.container.addClass('opens' + this.opens);

            this.updateView();
            this.updateCalendars();

            if (this.alwaysShowCalendars) {
                this.showCalendars();
            }

        },

        getStartDate: function () {
            return this.startDate ? this.startDate.toDate() : undefined;
        },

        getEndDate: function () {
            return this.endDate ? this.endDate.toDate() : this.getStartDate();
        },

        setStartDate: function (startDate) {
            if (typeof startDate === 'string')
                this.startDate = moment(startDate, this.format);

            if (typeof startDate === 'object')
                this.startDate = moment(startDate);

            if (!this.timePicker)
                this.startDate = this.startDate.startOf(this.minViewMode);

            this.oldStartDate = this.startDate.clone();

            this.updateView();
            this.updateCalendars();
        },

        setEndDate: function (endDate) {
            if (typeof endDate === 'string')
                this.endDate = moment(endDate, this.format);

            if (typeof endDate === 'object')
                this.endDate = moment(endDate);

            if (!this.timePicker)
                this.endDate = this.endDate.endOf(this.minViewMode);

            this.oldEndDate = this.endDate.clone();

            this.updateView();
            this.updateCalendars();
        },

        cleanSelectedDates: function () {
            this.oldStartDate = this.startDate.clone();
            this.oldEndDate = this.endDate.clone();

            this.updateView();
            this.updateCalendars();
        },

        updateView: function () {
            this.endDateToCalendar = this.startDate.clone().add('year', 1).endOf('year');

            this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year());
            this.rightCalendar.month.month(this.endDateToCalendar.month()).year(this.endDateToCalendar.year()).date(this.endDateToCalendar.daysInMonth());

            this.updateFormInputs();
        },

        updateFormInputs: function () {
            if (!this.hideFormInputs) {
                this.container.find('input[name=daterangepicker_start]').val(this.startDate.format(this.format));
                this.container.find('input[name=daterangepicker_end]').val(this.endDate.format(this.format));
            }

            if (this.startDate.isSame(this.endDate) || this.startDate.isBefore(this.endDate)) {
                this.container.find('button.applyBtn').removeAttr('disabled');
            } else {
                this.container.find('button.applyBtn').attr('disabled', 'disabled');
            }
        },

        updateFromControl: function () {
            if (!this.element.is('input')) return;
            if (!this.element.val().length) return;

            var dateString = this.element.val().split(this.separator),
                start = null,
                end = null;

            if (dateString.length === 2) {
                start = moment(dateString[0], this.format);
                end = moment(dateString[1], this.format);
            }

            if (this.singleDatePicker || start === null || end === null) {
                start = moment(this.element.val(), this.format);
                end = start;
            }

            if (end.isBefore(start)) return;

            this.oldStartDate = this.startDate.clone();
            this.oldEndDate = this.endDate.clone();

            this.startDate = start;
            this.endDate = end;

            if (!this.startDate.isSame(this.oldStartDate) || !this.endDate.isSame(this.oldEndDate))
                this.notify();

            this.updateCalendars();
        },

        notify: function () {
            if (!this.startDate.isSame(this.endDate)) {
                this._isFirstDateSelected = false;
                this.updateView();
                this.cb(this.startDate, this.endDate, this.chosenLabel);
                if (this.onRangeSelected)
                    this.onRangeSelected(this.startDate, this.endDate, this.chosenLabel);
            }
        },

        move: function () {
            var parentOffset = { top: 0, left: 0 };
            if (!this.parentEl.is('body')) {
                parentOffset = {
                    top: this.parentEl.offset().top - this.parentEl.scrollTop(),
                    left: this.parentEl.offset().left - this.parentEl.scrollLeft()
                };
            }

            if (this.opens == 'left') {
                this.container.css({
                    top: this.element.offset().top + this.element.outerHeight() - parentOffset.top,
                    right: $(window).width() - this.element.offset().left - this.element.outerWidth() - parentOffset.left,
                    left: 'auto'
                });
                if (this.container.offset().left < 0) {
                    this.container.css({
                        right: 'auto',
                        left: 9
                    });
                }
            } else {
                this.container.css({
                    top: this.element.offset().top + this.element.outerHeight() - parentOffset.top,
                    left: this.element.offset().left - parentOffset.left,
                    right: 'auto'
                });
                if (this.container.offset().left + this.container.outerWidth() > $(window).width()) {
                    this.container.css({
                        left: 'auto',
                        right: 0
                    });
                }
            }
        },

        toggle: function (e) {
            if (this.element.hasClass('active')) {
                this.hide();
            } else {
                this.show();
            }
        },

        show: function (e) {
            this.element.addClass('active');
            this.container.show();
            this.move();

            if (this.element.is('input')) {
                $(document).on('click.daterangepicker', $.proxy(this.outsideClick, this));
                // also explicitly play nice with Bootstrap dropdowns, which stopPropagation when clicking them
                $(document).on('click.daterangepicker', '[data-toggle=dropdown]', $.proxy(this.outsideClick, this));
            }

            this.element.trigger('show.daterangepicker', this);
        },

        outsideClick: function (e) {
            var target = $(e.target);
            // if the page is clicked anywhere except within the daterangerpicker/button
            // itself then call this.hide()
            if (
                target.closest(this.element).length ||
                target.closest(this.container).length ||
                target.closest('.calendar-date').length
            ) return;
            this.clickCancel();
        },

        hide: function (e) {

            if (this.element.is('input'))
                $(document).off('click.daterangepicker', this.outsideClick);

            this.element.removeClass('active');
            this.container.hide();

            if (!this.startDate.isSame(this.oldStartDate) || !this.endDate.isSame(this.oldEndDate))
                this.notify();

            this.oldStartDate = this.startDate.clone();
            this.oldEndDate = this.endDate.clone();

            this.element.trigger('hide.daterangepicker', this);
        },

        enterRange: function (e) {
            // mouse pointer has entered a range label
            var label = e.target.innerHTML;
            if (label == this.locale.customRangeLabel) {
                this.updateView();
            } else {
                var dates = this.ranges[label];
                this.container.find('input[name=daterangepicker_start]').val(dates[0].format(this.format));
                this.container.find('input[name=daterangepicker_end]').val(dates[1].format(this.format));
            }
        },

        showCalendars: function () {
            this.container.addClass('show-calendar');
            this.move();
        },

        hideCalendars: function () {
            this.container.removeClass('show-calendar');
        },

        updateInputText: function () {
            if (this.element.is('input') && !this.singleDatePicker) {
                this.element.val(this.startDate.format(this.format) + this.separator + this.endDate.format(this.format));
            } else if (this.element.is('input')) {
                this.element.val(this.startDate.format(this.format));
            }
        },

        clickRange: function (e) {
            var label = e.target.innerHTML;
            this.chosenLabel = label;
            if (label == this.locale.customRangeLabel) {
                this.showCalendars();
            } else {
                var dates = this.ranges[label];

                this.startDate = dates[0];
                this.endDate = dates[1];

                if (!this.timePicker) {
                    this.startDate.startOf('day');
                    this.endDate.endOf('day');
                }

                this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year()).hour(this.startDate.hour()).minute(this.startDate.minute());
                this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year()).hour(this.endDate.hour()).minute(this.endDate.minute());

                this.updateCalendars();

                if (this.autoApplyClickedRange) {
                    if (!this.alwaysShowCalendars) {
                        this.hideCalendars();
                    }
                    this.updateInputText();
                    this.hide();
                    this.element.trigger('apply.daterangepicker', this);
                }

            }
        },

        clickPrev: function (e) {
            var diffResolution = this.viewModes[this.minViewMode].next;

            var cal = $(e.target).parents('.calendar');

            if (this.leftCalendar.month.year() == this.rightCalendar.month.year() - 1) {
                this.leftCalendar.month.subtract(diffResolution, 1);
                this.rightCalendar.month.subtract(diffResolution, 1);
                this.rightCalendar.month.date(this.rightCalendar.month.daysInMonth());
            } else {
                if (cal.hasClass('left')) {
                    this.leftCalendar.month.subtract(diffResolution, 1);
                } else {
                    this.rightCalendar.month.subtract(diffResolution, 1);
                    this.rightCalendar.month.date(this.rightCalendar.month.daysInMonth());
                }
            }

            this.updateCalendars();
        },

        clickNext: function (e) {
            var diffResolution = this.viewModes[this.minViewMode].next;
            var cal = $(e.target).parents('.calendar');
            if (this.leftCalendar.month.year() == this.rightCalendar.month.year() - 1) {
                this.leftCalendar.month.add(diffResolution, 1);
                this.rightCalendar.month.add(diffResolution, 1);
                this.rightCalendar.month.date(this.rightCalendar.month.daysInMonth());
            } else {
                if (cal.hasClass('left')) {
                    this.leftCalendar.month.add(diffResolution, 1);
                } else {
                    this.rightCalendar.month.add(diffResolution, 1);
                    this.rightCalendar.month.date(this.rightCalendar.month.daysInMonth());
                }
            }

            this.updateCalendars();
        },

        _isFirstDateSelected: false,

        enterDate: function (e) {

            var title = $(e.target).attr('data-title');
            var row = title.substr(1, 1);
            var col = title.substr(3, 1);
            var cal = $(e.target).parents('.calendar');

            var isLeftCalendar = $(e.target).closest('.calendar').attr('class').contains('left');
            var currentCalendar = isLeftCalendar ? this.leftCalendar : this.rightCalendar;
            var currentDate = currentCalendar.calendar[row][col];

            if (!this._isFirstDateSelected || !currentDate.isSameOrAfter(this.startDate)) {
                this.container.find('input[name=daterangepicker_start]').val(this.leftCalendar.calendar[row][col].format(this.format));
            } else {
                this.container.find('input[name=daterangepicker_end]').val(this.rightCalendar.calendar[row][col].format(this.format));
            }

        },

        clickDate: function (e) {
            var title = $(e.target).attr('data-title');
            var row = title.substr(1, 1);
            var col = title.substr(3, 1);
            var cal = $(e.target).parents('.calendar');

            var startDate, endDate;

            //ORIGINAL
            //if (cal.hasClass('left')) {
            //    startDate = this.leftCalendar.calendar[row][col];
            //    endDate = this.endDate;
            //    if (typeof this.dateLimit === 'object') {
            //        var maxDate = moment(startDate).add(this.dateLimit).startOf('day');
            //        endDate = endDate.max(maxDate);
            //    }
            //} else {
            //    startDate = this.startDate;
            //    endDate = this.rightCalendar.calendar[row][col];
            //    if (typeof this.dateLimit === 'object') {
            //        var minDate = moment(endDate).subtract(this.dateLimit).startOf('day');
            //        startDate = startDate.min(minDate);
            //    }
            //}
            //END ORIGINAL

            //ADJUSTED
            var isLeftCalendar = $(e.target).closest('.calendar').attr('class').contains('left');
            var currentCalendar = isLeftCalendar ? this.leftCalendar : this.rightCalendar;
            var currentDate = currentCalendar.calendar[row][col];

            if (this._isFirstDateSelected && currentDate.isSameOrAfter(this.startDate)) {
                this._isFirstDateSelected = false;
                startDate = this.startDate.clone().startOf('month');
                endDate = currentDate.clone().endOf('month');
            } else {
                this._isFirstDateSelected = true;
                startDate = currentDate.clone().startOf('month');
                endDate = startDate.clone().endOf('month');
            }
            //END ADJUSTED

            if (this.singleDatePicker && cal.hasClass('left')) {
                endDate = startDate.clone();
            } else if (this.singleDatePicker && cal.hasClass('right')) {
                startDate = endDate.clone();
            }

            cal.find('td').removeClass('active');

            $(e.target).addClass('active');
            this.setDates(startDate, endDate);
            this.updateFormInputs();

            if (isLeftCalendar)
                this.leftCalendar.month = this.startDate.clone().startOf('month');
            else
                this.rightCalendar.month = this.endDate.clone().subtract('year', 1).endOf('month');

            if (isLeftCalendar)
                this.rightCalendar.month = this.endDate.clone().add('year', 1).endOf('month');
            else
                this.rightCalendar.month = this.endDate.clone().endOf('month');

            this.updateCalendars();

            if (!this.timePicker)
                endDate.endOf('day');

            if (this.singleDatePicker)
                this.clickApply();
        },

        setDates: function (startDate, endDate, apply) {

            if (apply === undefined)
                apply = false;

            if (!moment.isMoment(startDate))
                startDate = moment(startDate);

            if (!moment.isMoment(endDate))
                endDate = moment(endDate);

            var diffResolution = this.viewModes[this.minViewMode].duration;

            if (startDate.isSame(endDate) || startDate.isBefore(endDate)) {
                this.endDate = endDate;
            } else if (startDate.isAfter(endDate)) {
                var difference;
                if (this.minViewMode == 'month') {
                    difference = this.endDate.month() - this.startDate.month();
                    difference += (this.endDate.year() - this.startDate.year()) * 12;
                } else {
                    difference = this.endDate.diff(this.startDate, diffResolution);
                }

                this.endDate = moment(startDate).add(diffResolution, difference).endOf(this.minViewMode);
            }
            this.startDate = startDate;

            if (this.minDate) {
                this.startDate = this.startDate.min(this.minDate);
            }

            if (this.maxDate) {
                this.endDate = this.endDate.max(this.maxDate);
            }

            this.chosenLabel = this.locale.customRangeLabel;

            if (apply) {
                this.updateCalendars();
                this.clickApply();
            }
        },

        clickApply: function (e) {
            this.updateInputText();
            if (this.element.is('input'))
                this.hide();

            this.notify();
            this.element.trigger('apply.daterangepicker', this);
        },

        clickCancel: function (e) {
            this.startDate = this.oldStartDate;
            this.endDate = this.oldEndDate;

            this.chosenLabel = this.oldChosenLabel;
            this.updateView();
            this.updateCalendars();
            if (this.element.is('input'))
                this.hide();
            this.element.trigger('cancel.daterangepicker', this);
        },

        updateMonthYear: function (e) {
            var isLeft = $(e.target).closest('.calendar').hasClass('left'),
                leftOrRight = isLeft ? 'left' : 'right',
                cal = this.container.find('.calendar.' + leftOrRight);

            // Month must be Number for new moment versions
            var month = parseInt(cal.find('.monthselect').val(), 10);
            var year = cal.find('.yearselect').val();

            this[leftOrRight + 'Calendar'].month.month(month).year(year);

            this.updateCalendars();
        },

        updateTime: function (e) {
            var isLeft = $(e.target).closest('.calendar').hasClass('left'),
                leftOrRight = isLeft ? 'left' : 'right',
                cal = this.container.find('.calendar.' + leftOrRight);

            var hour = parseInt(cal.find('.hourselect').val(), 10);
            var minute = parseInt(cal.find('.minuteselect').val(), 10);

            if (this.timePicker12Hour) {
                var ampm = cal.find('.ampmselect').val();
                if (ampm === 'PM' && hour < 12)
                    hour += 12;
                if (ampm === 'AM' && hour === 12)
                    hour = 0;
            }

            if (isLeft) {
                var start = this.startDate.clone();
                start.hour(hour);
                start.minute(minute);
                this.startDate = start;
                this.leftCalendar.month.hour(hour).minute(minute);
            } else {
                var end = this.endDate.clone();
                end.hour(hour);
                end.minute(minute);
                this.endDate = end;
                this.rightCalendar.month.hour(hour).minute(minute);
            }

            this.updateCalendars();
        },

        updateCalendars: function () {
            var aYearAfterMinDate = this.minDate && this.minDate.clone().startOf('year');

            this.leftCalendar.calendar = this.buildCalendar(this.leftCalendar.month.month(), this.leftCalendar.month.year(), this.leftCalendar.month.hour(), this.leftCalendar.month.minute(), 'left');
            this.rightCalendar.calendar = this.buildCalendar(this.rightCalendar.month.month(), this.rightCalendar.month.year(), this.rightCalendar.month.hour(), this.rightCalendar.month.minute(), 'right');
            this.container.find('.calendar.left').empty().html(this.renderCalendar(this.leftCalendar.calendar, this.startDate, this.minDate, this.maxDate));
            this.container.find('.calendar.right').empty().html(this.renderCalendar(this.rightCalendar.calendar, this.endDate, aYearAfterMinDate, this.maxDate, true));

            this.container.find('.ranges li').removeClass('active');
            var customRange = true;
            var i = 0;
            for (var range in this.ranges) {
                if (this.timePicker) {
                    if (this.startDate.isSame(this.ranges[range][0]) && this.endDate.isSame(this.ranges[range][1])) {
                        customRange = false;
                        this.chosenLabel = this.container.find('.ranges li:eq(' + i + ')')
                            .addClass('active').html();
                    }
                } else {
                    //ignore times when comparing dates if time picker is not enabled
                    if (this.startDate.format('YYYY-MM-DD') == this.ranges[range][0].format('YYYY-MM-DD') && this.endDate.format('YYYY-MM-DD') == this.ranges[range][1].format('YYYY-MM-DD')) {
                        customRange = false;
                        this.chosenLabel = this.container.find('.ranges li:eq(' + i + ')')
                            .addClass('active').html();
                    }
                }
                i++;
            }
            if (!this.alwaysShowCalendars && customRange) {
                this.chosenLabel = this.container.find('.ranges li:last')
                    .addClass('active').html();
            }
        },

        buildCalendar: function (month, year, hour, minute, side) {
            var curDate;
            var calendar = [];
            if (this.minViewMode == 'month') {
                curDate = moment([year, 0, 1]);
                if (side == 'right') {
                    curDate = curDate.endOf('month');
                }

                //initialize a 3 rows x 4 columns array for the calendar
                for (i = 0; i < 3; i++) {
                    calendar[i] = [];
                    for (j = 0; j < 4; j++) {
                        calendar[i][j] = curDate.clone();
                        curDate = curDate.add('month', 1);
                        if (side == 'right') {
                            curDate = curDate.endOf('month');
                        }
                    }
                }
            } else {

                var firstDay = moment([year, month, 1]);
                var lastMonth = moment(firstDay).subtract('month', 1).month();
                var lastYear = moment(firstDay).subtract('month', 1).year();

                var daysInLastMonth = moment([lastYear, lastMonth]).daysInMonth();

                var dayOfWeek = firstDay.day();

                var i;

                //initialize a 6 rows x 7 columns array for the calendar
                calendar = [];
                for (i = 0; i < 6; i++) {
                    calendar[i] = [];
                }

                //populate the calendar with date objects
                var startDay = daysInLastMonth - dayOfWeek + this.locale.firstDay + 1;
                if (startDay > daysInLastMonth)
                    startDay -= 7;

                if (dayOfWeek == this.locale.firstDay)
                    startDay = daysInLastMonth - 6;

                curDate = moment([lastYear, lastMonth, startDay, 12, minute]);
                var col, row;
                for (i = 0, col = 0, row = 0; i < 42; i++ , col++ , curDate = moment(curDate).add('hour', 24)) {
                    if (i > 0 && col % 7 === 0) {
                        col = 0;
                        row++;
                    }
                    calendar[row][col] = curDate.clone().hour(hour);
                    curDate.hour(12);
                }
            }
            return calendar;
        },

        renderDropdowns: function (selected, minDate, maxDate) {

            var monthHtml = '';
            if (this.viewModes[this.minViewMode].ordinal < 6) {
                var currentMonth = selected.month();
                monthHtml = '<select class="monthselect">';

                for (var m = 0; m < 12; m++) {
                    if ((selected.isAfter(minDate, 'year') || m >= minDate.month()) && (selected.isBefore(maxDate, 'year') || m <= maxDate.month())) {
                        monthHtml += "<option value='" + m + "'" +
                            (m === currentMonth ? " selected='selected'" : "") + ">" + this.locale.monthNames[m] + "</option>";
                    }
                }
                monthHtml += "</select>";
            }

            var currentYear = selected.year();
            var maxYear = (maxDate && maxDate.year()) || (currentYear + 5);
            var minYear = (minDate && minDate.year()) || (currentYear - 50);
            var yearHtml = '<select class="yearselect">';

            for (var y = minYear; y <= maxYear; y++) {
                yearHtml += '<option value="' + y + '"' +
                    (y === currentYear ? ' selected="selected"' : '') + '>' + y + '</option>';
            }

            yearHtml += '</select>';

            return monthHtml + yearHtml;
        },

        renderCalendar: function (calendar, selected, minDate, maxDate, isRight) {

            var html = '<div class="calendar-date">';
            html += '<table class="table-condensed">';
            html += '<thead>';
            html += '<tr>';

            // add empty cell for week number
            if (this.showWeekNumbers)
                html += '<th></th>';

            var aDayInTheDisplayedMonth = calendar[1][1];

            if ((!isRight && (!minDate || minDate.isBefore(aDayInTheDisplayedMonth, 'month'))) ||
                (isRight && minDate && minDate.clone().add('year', 1).isBefore(aDayInTheDisplayedMonth, 'year'))) {
                html += '<th class="prev available"><i class="fa fa-arrow-left icon-arrow-left glyphicon glyphicon-arrow-left"></i></th>';
            } else {
                html += '<th></th>';
            }

            var dateHtml = '';

            if (this.showDropdowns) {
                dateHtml = this.renderDropdowns(aDayInTheDisplayedMonth, minDate, maxDate);
            } else {
                var monthYearFormat = this.viewModes[this.minViewMode].monthYearFormat;
                dateHtml += aDayInTheDisplayedMonth.format(monthYearFormat);
            }

            html += '<th colspan="' + this.viewModes[this.minViewMode].monthYearColSpan + '" class="month">' + dateHtml + '</th>';

            if (!maxDate || maxDate.isAfter(aDayInTheDisplayedMonth, 'month')) {
                html += '<th class="next available"><i class="fa fa-arrow-right icon-arrow-right glyphicon glyphicon-arrow-right"></i></th>';
            } else {
                html += '<th></th>';
            }

            html += '</tr>';

            if (this.minViewMode == 'days') {
                html += '<tr>';

                // add week number label
                if (this.showWeekNumbers)
                    html += '<th class="week">' + this.locale.weekLabel + '</th>';

                $.each(this.locale.daysOfWeek, function (index, dayOfWeek) {
                    html += '<th>' + dayOfWeek + '</th>';
                });

                html += '</tr>';
            }

            html += '</thead>';

            html += '<tbody>';

            for (var row = 0; row < calendar.length; row++) {
                html += '<tr>';

                // add week number
                if (this.showWeekNumbers && this.viewModes[this.minViewMode].ordinal < 6)
                    html += '<td class="week">' + calendar[row][0].week() + '</td>';

                for (var col = 0; col < calendar[row].length; col++) {
                    var cname = 'available ';

                    var availableDate;
                    if (this.onRenderDate)
                        availableDate = this.onRenderDate(this, calendar[row][col].toDate());

                    if (this.viewModes[this.minViewMode].ordinal < 6)
                        cname += (calendar[row][col].month() == calendar[1][1].month()) ? '' : 'off';

                    if (availableDate && availableDate.length) {
                        cname += ' ' + availableDate;
                    }
                    else if ((minDate && calendar[row][col].isBefore(minDate)) || (maxDate && calendar[row][col].isAfter(maxDate))) {
                        cname = ' off disabled ';
                    } else if (calendar[row][col].format('YYYY-MM-DD') == selected.format('YYYY-MM-DD')) {
                        cname += ' active ';
                        if (calendar[row][col].format('YYYY-MM-DD') == this.startDate.format('YYYY-MM-DD')) {
                            cname += ' start-date ';
                        }
                        if (calendar[row][col].format('YYYY-MM-DD') == this.endDate.format('YYYY-MM-DD')) {
                            cname += ' end-date ';
                        }
                    } else if (calendar[row][col] >= this.startDate && calendar[row][col] <= this.endDate) {
                        cname += ' in-range ';
                        if (calendar[row][col].isSame(this.startDate)) {
                            cname += ' start-date ';
                        }
                        if (calendar[row][col].isSame(this.endDate)) {
                            cname += ' end-date ';
                        }
                    }

                    cname += ' ' + this.minViewMode;

                    var title = 'r' + row + 'c' + col;
                    html += '<td class="' + cname.replace(/\s+/g, ' ').replace(/^\s?(.*?)\s?$/, '$1') + '" data-title="' + title + '">' + calendar[row][col].format(this.viewModes[this.minViewMode].cellFormat) + '</td>';
                }
                html += '</tr>';
            }

            html += '</tbody>';
            html += '</table>';
            html += '</div>';

            var i;
            if (this.timePicker) {

                html += '<div class="calendar-time">';
                html += '<select class="hourselect">';
                var start = 0;
                var end = 23;
                var selected_hour = selected.hour();
                if (this.timePicker12Hour) {
                    start = 1;
                    end = 12;
                    if (selected_hour >= 12)
                        selected_hour -= 12;
                    if (selected_hour === 0)
                        selected_hour = 12;
                }

                for (i = start; i <= end; i++) {
                    if (i == selected_hour) {
                        html += '<option value="' + i + '" selected="selected">' + i + '</option>';
                    } else {
                        html += '<option value="' + i + '">' + i + '</option>';
                    }
                }

                html += '</select> : ';

                html += '<select class="minuteselect">';

                for (i = 0; i < 60; i += this.timePickerIncrement) {
                    var num = i;
                    if (num < 10)
                        num = '0' + num;
                    if (i == selected.minute()) {
                        html += '<option value="' + i + '" selected="selected">' + num + '</option>';
                    } else {
                        html += '<option value="' + i + '">' + num + '</option>';
                    }
                }

                html += '</select> ';

                if (this.timePicker12Hour) {
                    html += '<select class="ampmselect">';
                    if (selected.hour() >= 12) {
                        html += '<option value="AM">AM</option><option value="PM" selected="selected">PM</option>';
                    } else {
                        html += '<option value="AM" selected="selected">AM</option><option value="PM">PM</option>';
                    }
                    html += '</select>';
                }

                html += '</div>';

            }

            return html;

        },

        remove: function () {

            this.container.remove();
            this.element.off('.daterangepicker');
            this.element.removeData('daterangepicker');

        },

        viewModes: {
            day: { ordinal: 4, next: 'month', prev: 'hour', get: 'date', duration: 'days', monthYearFormat: 'MMM YYYY', monthYearColSpan: 5, defaultFormat: 'MM/DD/YYYY', cellFormat: 'D' },
            month: { ordinal: 6, next: 'year', prev: 'day', get: 'month', duration: 'months', monthYearFormat: 'YYYY', monthYearColSpan: 2, defaultFormat: 'MMM, YYYY', cellFormat: 'MMM' }
        },

        onRenderDate: null,
        onRangeSelected: null

    };

    var old = $.fn.daterangepicker;
    $.fn.daterangepickerMO = function (options, cb) {
        this.each(function () {
            var el = $(this);
            if (el.data('daterangepicker'))
                el.data('daterangepicker').remove();
            el.data('daterangepicker', new DateRangePicker(el, options, cb));
        });

        return this;
    };

    /* DATEPICKER NO CONFLICT
	* =================== */

    //$.fn.daterangepicker.noConflict = function () {
    //    $.fn.daterangepicker = old;
    //    return this;
    //};

    //$(function () {
    //    var dateRangePicker = $.fn.daterangepicker && $.fn.daterangepicker.noConflict()
    //    $.fn.daterangepickerMO = dateRangePicker;
    //});


}(window.jQuery, window.moment);

ï»¿/**
* MONTHS ONLY
* @version: 1.0.0
* @author: Rodrigo Graf
* @date: 2019-11-22
* Details: Componente para a seleÃ§Ã£o de um range de datas baseado somente nos meses do ano
*/

!function ($) {
    var _now = new Date;
    var _functions = {
        auxiliary: {
            months: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
            stringToMonthYear: function (stringValue) {
                var splitted = stringValue.split('-');
                var monthYear = { Year: parseInt(splitted[0]), Month: parseInt(splitted[1]) };
                monthYear.MonthLabel = this.months[monthYear.Month - 1];
                return monthYear;
            }
        }
    };

    var monthsRangePicker = function (element, options) {

        this._options = {
            minDate: _now,
            maxDate: new Date(_now.getFullYear() + 2, _now.getMonth(), _now.getDate()),
            events: {
                onRangeSelected: null
            },
            validDates: [],

            startDate: null,
            endDate: null
        };

        this._settings = {
            dateElementPrefix: 'date_',
            highlightClassName: 'highlight',
            components: {
                content: '.monthsRangePicker',
                calendarsContent: '.calendars',
                calendars: '.calendar',
                calendarDates: '.calendar-date',
                chkDates: 'input.calendar-date-chk'
            }
        };

        this._options = $.extend(false, this._options, options);

        var template =
            '<div class="monthsRangePicker">' +
            '   <div class="calendars">' +
            '   </div > ';
        '</div > ';

        this.element = element;
        this.container = $(template).appendTo($(element));

        Util.SelectComponents(this._settings.components, this.container, true);
        this._renderCalendars(this._options);
        this._attachEvents();

        if (this._options.startDate && this._options.endDate) {
            this._selectRange(this._options.startDate, this._options.endDate);
        }
    };

    monthsRangePicker.prototype = {
        _renderCalendars: function (options) {
            var dates = this._getMonthsCollection(options.minDate, options.maxDate);
            var calendarMonthsElement = [];
            var calendarYearsElements = [];

            var addCalendar = function (year, calendarCollection, monthsElements) {
                var calendarEl =
                    '<div class="calendar">' +
                    '   <div class="calendar-title">' + year + '</div>' +
                    '   <div class="calendar-dates">' + monthsElements.join('') + '</div>' +
                    '</div > ';

                calendarCollection.push(calendarEl);
            };

            var _oldYear = dates[0].Year;
            var date = null;
            for (var i = 0; i < dates.length; i++) {
                date = dates[i];

                if (_oldYear !== date.Year) {
                    addCalendar(_oldYear, calendarYearsElements, calendarMonthsElement);
                    calendarMonthsElement = [];
                    _oldYear = date.Year;
                }

                var dateKey = this._monthYearToString(date);
                var dateElId = this._settings.dateElementPrefix + dateKey;
                var isDisabled = false;
                //var isSelected = false;

                if (Util.HasCount(this._options.validDates))
                    isDisabled = !this._options.validDates.any(function (d) { return d.getFullYear() === date.Year && d.getMonth() + 1 === date.Month; });

                var dateEl =
                    '<label class="calendar-date' + (isDisabled ? ' disabled' : '') + '">' +
                    '   <input type="checkbox" class="calendar-date-chk ' + dateElId + '" ' + (isDisabled ? ' disabled' : '') + ' value="' + dateKey + '" />' + //' + (isSelected ? 'checked="checked"' : '') + '
                    '   <p>' + _functions.auxiliary.months[date.Month - 1] + '</p>' +
                    '</label> ';

                calendarMonthsElement.push(dateEl);
            }
            addCalendar(_oldYear, calendarYearsElements, calendarMonthsElement);
            this._settings.components.calendarsContent.append(calendarYearsElements.join(''));
        },
        _getMonthsCollection: function (beginDate, endDate) {
            var dateArray = [];

            for (var year = beginDate.getFullYear(); year <= endDate.getFullYear(); year++) {
                for (var month = 1; month <= 12; month++) {
                    dateArray.push({
                        Month: month,
                        Year: year
                    });
                }
            }
            return dateArray;
        },
        _attachEvents: function () {
            Util.SelectComponents(this._settings.components, this.container, true);
            var that = this;
            this._settings.components.chkDates.on('change', function (event) { that._onDateSelected(event); });
        },
        _firstSelectedMonth: null,
        _onDateSelected: function (event) {
            var el = $(event.delegateTarget);
            var monthStr = el.val();

            if (this._firstSelectedMonth === null) {
                this._settings.components.chkDates
                    .removeClass('date-between');

                this._settings.components.chkDates
                    .removeAttr('checked')
                    .closest(this._settings.components.calendarDates.selector).removeClass(this._settings.highlightClassName);

                el.attr('checked', 'checked');
                el.closest(this._settings.components.calendarDates.selector).addClass(this._settings.highlightClassName);

                this._firstSelectedMonth = this._stringToMonthYear(monthStr);

                this._triggerRangeSelected();
            } else {
                var thisMonthYear = this._stringToMonthYear(monthStr);

                var startMonth = this._firstSelectedMonth;
                var endMonth = thisMonthYear;

                if (!el.is('[checked]') && this._monthYearToString(startMonth) === this._monthYearToString(endMonth)) {
                    startMonth = null;
                    endMonth = null;
                } else if (this._getMonthYearKey(startMonth) > this._getMonthYearKey(endMonth)) {
                    startMonth = thisMonthYear;
                    endMonth = this._firstSelectedMonth;
                }

                this._selectRange(startMonth, endMonth);
                this._firstSelectedMonth = null;
            }
        },
        _selectRange: function (startMonth, endMonth, triggerRangeSelected) {

            if (triggerRangeSelected === undefined)
                triggerRangeSelected = true;

            this._settings.components.chkDates.removeAttr('checked');
            this._settings.components.chkDates.removeClass('date-between');
            this._settings.components.chkDates.closest(this._settings.components.calendarDates.selector).removeClass(this._settings.highlightClassName);

            if (startMonth && endMonth) {
                if (startMonth && !startMonth.Month && startMonth.getMonth)
                    startMonth = {
                        Year: startMonth.getFullYear(),
                        Month: startMonth.getMonth() + 1
                    };

                if (endMonth && !endMonth.Month && endMonth.getMonth)
                    endMonth = {
                        Year: endMonth.getFullYear(),
                        Month: endMonth.getMonth() + 1
                    };

                for (var year = startMonth.Year; year <= endMonth.Year; year++) {
                    for (var month = 1; month <= 12; month++) {
                        var thisMonthYear = { Month: month, Year: year };
                        if (this._getMonthYearKey(thisMonthYear) >= this._getMonthYearKey(startMonth) &&
                            this._getMonthYearKey(thisMonthYear) <= this._getMonthYearKey(endMonth)) {

                            //Destaca caso seja a primeira ou ultima data selecionada
                            var highlight = this._getMonthYearKey(thisMonthYear) === this._getMonthYearKey(startMonth) || this._getMonthYearKey(thisMonthYear) === this._getMonthYearKey(endMonth);

                            var elementKey = this._monthYearToString(thisMonthYear);
                            var element = $('.' + this._settings.dateElementPrefix + elementKey, $(this.element));
                            element.attr('checked', 'checked');

                            if (highlight) {
                                element.closest(this._settings.components.calendarDates.selector)
                                    .removeClass(this._settings.highlightClassName)
                                    .addClass(this._settings.highlightClassName);
                            }
                            else {
                                element.addClass('date-between');
                            }
                        }
                    }
                }
            }

            if (triggerRangeSelected)
                this._triggerRangeSelected();
        },
        _stringToMonthYear: function (stringValue) {
            return _functions.auxiliary.stringToMonthYear(stringValue);
        },
        _monthYearToString: function (monthYear) {
            return monthYear.Year + '-' + monthYear.Month;
        },
        _getMonthYearKey: function (monthYear) {
            return parseInt(monthYear.Year.toString().padStart(4, "0") + '' + monthYear.Month.toString().padStart(2, "0"));
        },
        _triggerRangeSelected: function () {
            if (this._options.events.onRangeSelected) {
                var range = this.getRange();
                this._options.events.onRangeSelected(range);
            }
        },

        getRange: function () {
            return this._settings.components.chkDates
                .filter('[checked]')
                .map(function () {
                    return _functions.auxiliary.stringToMonthYear(this.value);
                })
                .get();
        },
        setValidDates: function (validDates) {
            this._options.validDates = validDates;

            this._settings.components.chkDates
                .removeAttr('disabled')
                .attr('disabled');

            this._settings.components.chkDates
                .closest(this._settings.components.calendarDates.selector)
                .removeClass('disabled')
                .addClass('disabled');

            var groups = validDates.groupByWithoutKey(function (i) {
                return i.getFullYear().toString().padStart(4, "0") + (i.getMonth() + 1).toString().padStart(2, "0");
            });
            for (var i = 0; i < groups.length; i++) {
                var group = groups[i];
                var date = group.first();

                var monthYearStr = this._monthYearToString({ Year: date.getFullYear(), Month: date.getMonth() + 1 });
                $('.date_' + monthYearStr, $(this.element))
                    .removeAttr('disabled')
                    .closest(this._settings.components.calendarDates.selector)
                    .removeClass('disabled');
            }
        },
        setDates: function (startDate, endDate, triggerRangeSelected) {
            this._selectRange(startDate, endDate, triggerRangeSelected);
        },
        remove: function () {

            this.container.remove();
            this.element.off('.monthsrangepicker');
            this.element.removeData('monthsrangepicker');

        }
    };

    $.fn.MonthsRangePicker = function (options, cb) {
        this.each(function () {
            var el = $(this);
            if (el.data('monthsrangepicker'))
                el.data('monthsrangepicker').remove();
            el.data('monthsrangepicker', new monthsRangePicker(el, options));
        });

        return this;
    };
}(window.jQuery);

ï»¿// moment.js locale configuration
// locale : brazilian portuguese (pt-br)
// author : Caio Ribeiro Pereira : https://github.com/caio-ribeiro-pereira

(function (factory) {
    if (typeof define === 'function' && define.amd) {
        define(['moment'], factory); // AMD
    } else if (typeof exports === 'object') {
        module.exports = factory(require('../moment')); // Node
    } else {
        factory(window.moment); // Browser global
    }
}(function (moment) {
    return moment.defineLocale('pt-br', {
        months: 'janeiro_fevereiro_marÃ§o_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro'.split('_'),
        monthsShort: 'Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez'.split('_'),
        weekdays: 'domingo_segunda-feira_terÃ§a-feira_quarta-feira_quinta-feira_sexta-feira_sÃ¡bado'.split('_'),
        weekdaysShort: 'dom_seg_ter_qua_qui_sex_sÃ¡b'.split('_'),
        weekdaysMin: 'dom_2Âª_3Âª_4Âª_5Âª_6Âª_sÃ¡b'.split('_'),
        longDateFormat: {
            LT: 'HH:mm',
            L: 'DD/MM/YYYY',
            LL: 'D [de] MMMM [de] YYYY',
            LLL: 'D [de] MMMM [de] YYYY [Ã s] LT',
            LLLL: 'dddd, D [de] MMMM [de] YYYY [Ã s] LT'
        },
        calendar: {
            sameDay: '[Hoje Ã s] LT',
            nextDay: '[AmanhÃ£ Ã s] LT',
            nextWeek: 'dddd [Ã s] LT',
            lastDay: '[Ontem Ã s] LT',
            lastWeek: function () {
                return (this.day() === 0 || this.day() === 6) ?
                    '[Ãltimo] dddd [Ã s] LT' : // Saturday + Sunday
                    '[Ãltima] dddd [Ã s] LT'; // Monday - Friday
            },
            sameElse: 'L'
        },
        relativeTime: {
            future: 'em %s',
            past: '%s atrÃ¡s',
            s: 'segundos',
            m: 'um minuto',
            mm: '%d minutos',
            h: 'uma hora',
            hh: '%d horas',
            d: 'um dia',
            dd: '%d dias',
            M: 'um mÃªs',
            MM: '%d meses',
            y: 'um ano',
            yy: '%d anos'
        },
        ordinal: '%dÂº'
    });
}));

/// <reference path="../Libraries/Formatters.js" />
/// <reference path="../Libraries/ServiceCaller.js" />
/// <reference path="../Libraries/Util.js" />
/// <reference path="../Libraries/Prototypes.js" />
/// <reference path="../Libraries/EnumHelper.js" />

var Debug = Debug || {};

function SearchModel(searchController) {

    //ATENÃÃO: VAMOS AOS POUCOS MIGRANDO TODAS AS FUNCOES PARA DENTRO DO _functions : {}
    //#region Properties
    var controller = searchController;
    var thisModel = this;

    //Manter a ordem alfabÃ©tica!!! :@
    var auxAirportsResponse = undefined;
    var auxLocationsResponse = {};
    var auxHotelSearchResponse = {};
    var auxHotelsPointsResponse = [];
    var auxChainsResponse = [];
    var auxPackagesResponse = {};
    var auxPriceGroupsResponse = [];
    var auxRecommendationsResponse = [];
    var auxInsuranceResponse = [];
    var calendarPackage = [];
    var changePackageRecommendationIndex = undefined;
    var clientWS = new ServiceCaller(Global.PathWebService);
    var concatEventData = undefined;
    var continueSearch = true;
    var data = {};
    var exchangeRates = undefined;
    var filteredCityPairs = [];
    var filteredData = undefined;
    var filteredPackages = [];
    var filteredPriceGroups = [];
    var filtredRecommendations = [];
    var lastInvoke = undefined;
    var lastGetSeachStatus = undefined;
    var nonVisibleHotels = [];
    var orderlyData = undefined;
    var lastFiltersData = undefined;
    var originalEventData = undefined;
    var _originalInsurances = undefined;
    var pricingTradeType = {};
    var searchData = {};
    var searchRequest = {};
    var selectedRoomsInHotel = [];
    var useResponseJSON = false;
    var visibleHotels = [];
    var withoutSuggestions = false; //NecessÃ¡rio enquanto nÃ£o existir uma tela de busca iatas
    var showPackagePrice = false;
    var removeUselessHotels = false;
    var selectedPackage = {
        recommendation: undefined,
        priceGroup: undefined,
        hotel: undefined,
        daysStay: undefined,
        TotalAmount: undefined
    };

    var fakeRoomBrokers = ["Sabre", "Travelport"];

    SearchResponseJSON = typeof SearchResponseJSON == 'undefined' ? undefined : SearchResponseJSON;

    //#endregion

    //#region Search

    var resetDatas = function () {
        data = {};
        resetDatas2();
    };

    var resetDatas2 = function () {
        auxHotelSearchResponse = {};
        auxPriceGroupsResponse = [];
        auxRecommendationsResponse = [];
        auxPackagesResponse = {};
        visibleHotels = [];
        nonVisibleHotels = [];
        searchData = {};
        orderlyData = undefined;
        auxInsuranceResponse = [];
    };

    this.savePreOrder = function (req) {
        req.AffiliatedId = Global.AffiliatedId;

        return clientWS.invoke("SavePreOrder", { req: req }, thisModel.savePreOrderSuccess, thisModel.onSavePreOrderError, undefined, Global.TimeOutServiceParameter);
    };

    this.savePreOrderSuccess = function (response) {
        if (_validateResponseCompleted(response))
            controller.onSavePreOrderCompleted(response);
        else
            controller.onSavePreOrderError(response);
    };

    this.onSavePreOrderError = function (response) {
        thisModel.onError(response);

        controller.onSavePreOrderError(response);
    };


    this.clone = function (controller) {
        var model = new SearchModel(controller);

        model.setModelData({
            auxAirportsResponse: auxAirportsResponse,
            auxHotelSearchResponse: auxHotelSearchResponse,
            auxPackagesResponse: auxPackagesResponse,
            auxPriceGroupsResponse: Util.CloneArray(auxPriceGroupsResponse),
            auxRecommendationsResponse: Util.CloneArray(auxRecommendationsResponse),
            auxInsuranceResponse: Util.CloneArray(auxInsuranceResponse),
            calendarPackage: calendarPackage,
            changePackageRecommendationIndex: changePackageRecommendationIndex,
            clientWS: clientWS,
            continueSearch: continueSearch,
            data: data,
            exchangeRates: exchangeRates,
            filteredCityPairs: filteredCityPairs,
            filteredData: filteredData,
            filteredPackages: Util.CloneArray(filteredPackages),
            filteredPriceGroups: Util.CloneArray(filteredPriceGroups),
            filtredRecommendations: Util.CloneArray(filtredRecommendations),
            lastInvoke: lastInvoke,
            lastGetSeachStatus: lastGetSeachStatus,
            nonVisibleHotels: Util.CloneArray(nonVisibleHotels),
            pricingTradeType: pricingTradeType,
            searchData: searchData,
            selectedRoomsInHotel: Util.CloneArray(selectedRoomsInHotel),
            useResponseJSON: useResponseJSON,
            visibleHotels: Util.CloneArray(visibleHotels),
            withoutSuggestions: withoutSuggestions,
            concatEventData: concatEventData
        });

        return model;
    };

    this.destroy = function () {
        thisModel = undefined;

        auxAirportsResponse = undefined;
        auxHotelSearchResponse = undefined;
        auxPackagesResponse = undefined;
        auxPriceGroupsResponse = undefined;
        auxRecommendationsResponse = undefined;
        auxInsuranceResponse = undefined;
        calendarPackage = undefined;
        changePackageRecommendationIndex = undefined;
        clientWS = undefined;
        continueSearch = undefined;
        data = undefined;
        exchangeRates = undefined;
        filteredCityPairs = undefined;
        filteredData = undefined;
        filteredPackages = undefined;
        filteredPriceGroups = undefined;
        filtredRecommendations = undefined;
        lastInvoke = undefined;
        lastGetSeachStatus = undefined;
        nonVisibleHotels = undefined;
        pricingTradeType = undefined;
        searchData = undefined;
        selectedRoomsInHotel = undefined;
        useResponseJSON = undefined;
        visibleHotels = undefined;
        withoutSuggestions = undefined;
    }

    this.setModelData = function (context) {
        auxAirportsResponse = context.auxAirportsResponse;
        auxHotelSearchResponse = context.auxHotelSearchResponse;
        auxPackagesResponse = context.auxPackagesResponse;
        auxPriceGroupsResponse = context.auxPriceGroupsResponse;
        auxRecommendationsResponse = context.auxRecommendationsResponse;
        auxInsuranceResponse = context.auxInsuranceResponse;
        calendarPackage = context.calendarPackage;
        changePackageRecommendationIndex = context.changePackageRecommendationIndex;
        clientWS = context.clientWS;
        continueSearch = context.continueSearch;
        data = context.data;
        exchangeRates = context.exchangeRates;
        filteredCityPairs = context.filteredCityPairs;
        filteredData = context.filteredData;
        filteredPackages = context.filteredPackages;
        filteredPriceGroups = context.filteredPriceGroups;
        filtredRecommendations = context.filtredRecommendations;
        lastInvoke = context.lastInvoke;
        lastGetSeachStatus = context.lastGetSeachStatus;
        nonVisibleHotels = context.nonVisibleHotels;
        pricingTradeType = context.pricingTradeType;
        searchData = context.searchData;
        selectedRoomsInHotel = context.selectedRoomsInHotel;
        useResponseJSON = context.useResponseJSON;
        visibleHotels = context.visibleHotels;
        withoutSuggestions = context.withoutSuggestions;
        concatEventData = context.concatEventData;
        selectedPackage = context.selectedPackage;
    };

    this.getCruiseDetails = function (req) {
        clientWS.invoke("GetCruiseDetails ", { req: req }, _onGetCruiseDetails, thisModel.onError);
    };

    function _onGetCruiseDetails(res) {
        CruiseExtension.cruiseDetailsExtension.adaptCruiseDetailsResponse(res);
        controller.onGetCruiseDetailsCompleted(res);
    }

    this.getCategories = function () {
        if (lastInvoke)
            lastInvoke.abort();

        continueSearch = true;
        lastInvoke = clientWS.invoke("GetEventCategories", { req: {} }, thisModel.onGetCategoriesCompleted, thisModel.onError);
    };

    this.getHotelCommercialAgreements = function (req) {
        clientWS.invoke("GetHotelCommercialAgreements", { req: { SearchRQ: { TravelEngineSearchRQ: getRequestData(req) } } }, controller.getHotelCommercialAgreementsCompleted.notify, thisModel.onError);
    };

    this.abort = function () {
        if (lastInvoke)
            lastInvoke.abort();

        if (lastGetSeachStatus)
            clearTimeout(lastGetSeachStatus);
    };

    this.onGetCategoriesCompleted = function (response) {
        if (response && response.Errors && response.Errors.length)
            thisModel.onError(response);
        else
            controller.onGetCategoriesCompleted(response);
    };

    this.StartSearch = function (searchParameters) {

        var now = performance.now();

        var toInvoke = Global && Global.UseMinimunSearchJSON ? "SearchMinimunJSON" : "Search";

        if (lastInvoke)
            lastInvoke.abort();

        if (searchParameters.AdditionalInfo && searchParameters.AdditionalInfo.ShowPackagePrice)
            showPackagePrice = true;

        if (searchParameters.AdditionalInfo && searchParameters.AdditionalInfo.RemoveUselessHotels)
            removeUselessHotels = true;

        if (useResponseJSON && SearchResponseJSON) {
            _fakeResponse(searchParameters);
        }
        else {

            var searchRQ = {};

            searchRQ.AdditionalInfo = searchRQ.AdditionalInfo || [];

            if (!searchParameters.KeepData)
                resetDatas();
            else
                resetDatas2();

            searchRQ.TravelEngineSearchRQ = getRequestData(searchParameters);
            searchRQ.Passengers = searchParameters.Passengers;
            searchRQ.UserParameters = searchParameters.UserParameters;
            searchRQ.BypassSourcesConfigurationLocationsRules = searchParameters.BypassSourcesConfigurationLocationsRules;

            if (searchParameters.RoomSharingCode)
                searchRQ.RoomSharingCode = searchParameters.RoomSharingCode;

            if (searchParameters.AdditionalInfo) {

                for (var p in searchParameters.AdditionalInfo) {
                    if (searchParameters.AdditionalInfo[p]) {
                        var obj = {
                            Key: p.toString(),
                            Value: searchParameters.AdditionalInfo[p].toString()
                        };

                        searchRQ.AdditionalInfo.push(obj);
                    }
                }
            }

            if (Global.UserSession) {
                searchRQ.TraceInfo = [{ Key: "SessionId", Value: Global.UserSession }];
            }

            searchRequest = searchRQ;

            lastInvoke = clientWS.invoke(toInvoke, { req: searchRQ }, function (response) { thisModel.OnSearch(response, searchParameters, now); }, thisModel.onError);
        }
    };

    function _validateResponseCompleted(response) {
        if (response.Errors && response.Errors.length && response.Errors.any(function (f) { return f.StopFlow == true; })) {
            thisModel.onError(response);
            if (Global.MessagesController) {
                if (showDefaultMessages && showDefaultMessages.showMessage) {
                    if (showDefaultMessages.typeMessage == 'Air')
                        Global.MessagesController.notifyMessages(["OnAssesFare_DefaultMessageError"], EnumHelper.MessagesExhibitor.ExhibitionType.Inline);
                    else if (showDefaultMessages.typeMessage == 'Hotel')
                        Global.MessagesController.notifyMessages(["OnAssesFare_DefaultMessageErrorHotel"], EnumHelper.MessagesExhibitor.ExhibitionType.Inline);
                    else
                        Global.MessagesController.notifyMessages(["OnAssesFare_DefaultMessageErrorPackages"], EnumHelper.MessagesExhibitor.ExhibitionType.Inline);
                }
                else if (checkRedirectMessages(response.Errors))
                    redirectLastPage();
                else if (!response.BookingFares)
                    redirectLastPage();
                else
                    Global.MessagesController.notifyMessages(response.Errors, EnumHelper.MessagesExhibitor.ExhibitionType.Inline);
            }
        }
        else
            return true;
    }

    this.getCachedSearch = function (getCachedSearchRQ) {

        getCachedSearchRQ.SearchId = data.SearchId;

        clientWS.invoke("GetCachedSearch", { req: getCachedSearchRQ }, function (response) { thisModel.onGetCachedSearch(response, getCachedSearchRQ); }, thisModel.onError);
    };

    this.onGetCachedSearch = function (response, getCachedSearchRQ) {
        response.TravelEngineSearchRS.Suppliers = response.Suppliers;
        response = response.TravelEngineSearchRS;

        adaptResponse(response);

        mergeHotelResponse(response);

        controller.onGetCachedSearchCompleted(response, getCachedSearchRQ);
    };

    this.getHotelsPoints = function () {
        getHotelsPointsRQ = {};
        getHotelsPointsRQ.SearchId = data.SearchId;

        clientWS.invoke("GetHotelsPoints", { req: getHotelsPointsRQ }, function (response) { thisModel.onGetHotelsPoints(response, getHotelsPointsRQ); }, function (response) {
            thisModel.onError(response);
            controller.onErrorHoltelsPoints();
        });
    };

    this.onGetHotelsPoints = function (response, getHotelsPointsRQ) {

        for (var i = 0; i < response.HotelsPointsDetails.length; i++) {
            var hotel = response.HotelsPointsDetails[i];
            hotel.ExternalProperties = [{ Key: "SearchInCache", Value: "true" }, { Key: "CacheId", Value: data.SearchId }];
            hotel.Rooms = [{ Id: hotel.IdCheapestRoom }];
            hotel.ValueFormatted = formatter.currency(hotel.Value, true, 2);
            auxHotelsPointsResponse.push(hotel);
        }

        controller.onGetHotelsPoints(response);
    };

    this.StartSearchBestRecomendation = function (searchParameters) {

        var requestData = getRequestData(searchParameters);

        requestData.SearchData.SearchMode = 0;

        clientWS.invoke("SearchBestPrice", { req: { "TravelEngineSearchRQ": requestData, "CompanyId": searchParameters.CompanyId, AdditionalInfo: [{ Key: 'SearchForPackageComposition', Value: searchParameters && searchParameters.SearchForPackageComposition ? searchParameters.SearchForPackageComposition.toString() : "false" }] } }, function (response) { thisModel.OnSearchBestPriceCompleted(response); }, thisModel.onError);
    };

    function _fakeResponse(searchParameters) {
        var resp;
        if (searchParameters.Air) {
            resp = SearchResponseJSON.response[searchParameters.Air.SearchType];
            resp.Status = 1;
            thisModel.OnSearch(resp);
        }
        else if (searchParameters.Hotel) {
            resp = SearchResponseJSON.response['hotel' + searchParameters.Hotel.RoomsRequest.length];
            resp.Status = 1;
            thisModel.OnSearchStatus(resp);
        }
    };

    this.OnSearchBestPriceCompleted = function (response) {
        adaptAirResponseData(response);
        adaptRecommendations(response)
        controller.onSearchBestPriceCompleted(response.Recommendations.first());
    };

    this.OnSearch = function (response, searchParameters, startTime) {

        if (!startTime)
            startTime = performance.now();

        if (response && response.Errors && response.Errors.length && Global && Global.HandleErrors)
            Global.HandleErrors(response);

        if (response.TravelEngineSearchRS) {

            if (response.TravelEngineSearchRS.Status == EnumHelper.SearchStatus.Searching)
                thisModel.GetSearchStatus(Global.MilisecondsToDoGetSearchStatus, response.TravelEngineSearchRS, searchParameters, startTime);
            else if (response.TravelEngineSearchRS.Status == EnumHelper.SearchStatus.Completed)
                thisModel.OnSearchStatus(response, startTime);
        }
        else {
            _functions.fillSearchDuration(response, startTime);

            controller.onSearchCompleted(response);
        }
    };

    this.OnFlexibleSearchStart = function (searchParameters) {

        var requestData = getRequestDataFlexibleSearch(searchParameters);

        clientWS.invoke("FlexibleSearch", { req: { "FlexibleSearchRQ": requestData, "CompanyId": searchParameters.CompanyId, AdditionalInfo: [{ Key: 'SearchForPackageComposition', Value: searchParameters && searchParameters.SearchForPackageComposition ? searchParameters.SearchForPackageComposition.toString() : "false" }] } }, function (response) { thisModel.OnFlexibleSearchCompleted(response); }, thisModel.onError);
    };

    this.OnFlexibleSearchCompleted = function (response) {
        controller.onFlexibleSearchCompleted(response);
    };

    function _adaptHotelAndPackageResponse(searchTMRS) {
        adaptHotelResponseData(searchTMRS);
        adaptPackageResponseData(searchTMRS);
        data = searchTMRS;
        SearchData = searchTMRS.SearchData;
    }

    function _onSearchHotelAvailability(response) {
        if (response && response.Errors && response.Errors.length && Global && Global.HandleErrors)
            Global.HandleErrors(response);

        _adaptHotelAndPackageResponse(response);
        controller.onSearchHotelAvailability(response);
    };

    function _ongetWPHotelImages(response) {
        if (response && response.Errors && response.Errors.length && Global && Global.HandleErrors)
            Global.HandleErrors(response);

        controller.onGetWPHotelImagesCompleted(response);
    };


    this.searchHotelAvailability = function (request) {
        var searchRQ = {
            "TravelEngineSearchRQ": getRequestData(request),
            Passengers: request.Passengers
        };

        if (Global.UserSession)
            searchRQ.TraceInfo = [{ Key: "SessionId", Value: Global.UserSession }];

        clientWS.invoke("SearchHotelAvailability", { req: searchRQ }, _onSearchHotelAvailability, thisModel.onError);
    };

    this.getWPHotelImages = function (hotelIds) {
        var metaValues = "";
        for (var i = 0; i < hotelIds.length; i++) {
            metaValues += '&filter[meta_value][]=' + hotelIds[i];
        }

        if (Global.Settings.PathWordPressWebService) {
            var clientWPRestApi = new ServiceCaller(Global.ShortCodeParameters.siteurl + '/' + Global.Settings.PathWordPressWebService);
            clientWPRestApi.invokeGet("hotel", 'filter[meta_key]=ta_hotel_id' + metaValues + '&_embed', _ongetWPHotelImages, thisModel.onError);
        }
    };


    //[!! IMPORTANTE PARA MÃTODOS DE CONSULTA VIA WP_JSON !!]
    //Custom Post Type deve estar com opÃ§Ã£o "show_in_rest" como true
    //https://wordpress.stackexchange.com/questions/201657/wp-rest-api-fetch-posts-from-post-type#:~:text=To%20show%20custom%20post%20types,%2Dcustom%2Dpost%2Dtype.
    this.wpJson = {
        cruise: {
            ships: {
                get: function (shipCode) {
                    thisModel.wpJson._util.doGetRequest('type_cruise_ships', 'filter[meta_key] = ta_ship_code & filter[meta_value]=' + shipCode + ' & per_page=1', this.onCompleted);
                },
                onCompleted(response) {
                    controller.cruise.ships.completed(response);
                }
            },
            ports: {
                get: function (portCode) {
                    thisModel.wpJson._util.doGetRequest('type_ports', 'filter[meta_key]=ta_port_code&filter[meta_value]=' + portCode + '&per_page=1', this.onCompleted);
                },
                onCompleted(response) {
                    controller.cruise.ports.completed(response);
                }
            },
            shipSubpages: {
                get: function (shipCode) {
                    thisModel.wpJson._util.doGetRequest('type_ships_subpage', 'name_ship=' + shipCode + '&per_page=10', this.onCompleted);
                },
                onCompleted: function (response) {
                    controller.cruise.shipSubpages.completed(response);
                }
            },
            restaurants: {
                get: function (shipCode) {
                    thisModel.wpJson._util.doGetRequest('type_ship_restaurant', 'name_ship=' + shipCode + '&per_page=30', this.onCompleted);
                },
                onCompleted: function (response) {
                    controller.cruise.restaurants.completed(response);
                }
            },
            barsAndLounges: {
                get: function (shipCode) {
                    thisModel.wpJson._util.doGetRequest('type_ship_bars', 'name_ship=' + shipCode + '&per_page=30', this.onCompleted);
                },
                onCompleted: function (response) {
                    controller.cruise.barsAndLounges.completed(response);
                }
            },
            entertainments: {
                get: function (shipCode) {
                    thisModel.wpJson._util.doGetRequest('type_ship_pastime', 'name_ship=' + shipCode + '&per_page=30', this.onCompleted);
                },
                onCompleted: function (response) {
                    controller.cruise.entertainments.completed(response);
                }
            }
        },

        _util: {
            doGetRequest: function (method, parameters, callback) {
                if (Global.Settings.PathWordPressWebService) {
                    var clientWPRestApi = new ServiceCaller(Global.ShortCodeParameters.siteurl + '/' + Global.Settings.PathWordPressWebService);
                    clientWPRestApi.invokeGet(method, parameters, callback, thisModel.onError, null, null, true);
                }
            },
            doGetACFRequest: function (method, parameters, callback) {
                if (Global.Settings.PathWordPressWebService) {
                    var clientWPRestApi = new ServiceCaller(Global.ShortCodeParameters.acfapiurl);
                    clientWPRestApi.invokeGet(method, parameters, callback, thisModel.onError, null, null, true);
                }
            }
        }
    }



    var mergeDatas = function (data, response) {

        var dataAux = data;

        data = response;

        var hasPriceGroups = data.PriceGroups && data.PriceGroups.length;
        if (!hasPriceGroups && dataAux.PriceGroups && dataAux.PriceGroups.length)
            data.PriceGroups = dataAux.PriceGroups;

        var hasHotels = data.Hotels && data.Hotels.length;
        if (!hasHotels && dataAux.Hotels && dataAux.Hotels.length)
            data.Hotels = dataAux.Hotels;

        var hasEvents = data.Events && data.Events.length;
        if (!hasEvents && dataAux.Events && dataAux.Events.length)
            data.Events = dataAux.Events;

        var hasRecs = data.Recommendations && data.Recommendations.length;
        if (!hasRecs && dataAux.Recommendations && dataAux.Recommendations.length)
            data.Recommendations = dataAux.Recommendations;

        if (dataAux.AirFiltersData && !data.AirFiltersData)
            data.AirFiltersData = dataAux.AirFiltersData;

        if (dataAux.HotelFiltersData && !data.HotelFiltersData)
            data.HotelFiltersData = dataAux.HotelFiltersData;

        var packages = data.Packages && data.Packages.length;
        if (!packages && dataAux.Packages && dataAux.Packages.length)
            data.Packages = dataAux.Packages;

        var hasServices = data.Services && data.Services.length;
        if (!hasServices && dataAux.Services && dataAux.Services.length)
            data.Services = dataAux.Services;

        var hasCars = data.Cars && data.Cars.length;
        if (!hasCars && dataAux.Cars && dataAux.Cars.length)
            data.Cars = dataAux.Cars;

        var hasPackages = data.Packages && data.Packages.length;
        if (!hasPackages && dataAux.Packages && dataAux.Packages.length)
            data.Packages = dataAux.Packages;

        var insurances = data.Insurances && data.Insurances.length;
        if (!insurances && dataAux.Insurances && dataAux.Insurance.length)
            data.Insurances = dataAux.Insurances;

        var hasBuses = data.Buses && data.Buses.length;
        if (!hasBuses && dataAux.Buses && dataAux.Buses.length)
            data.Buses = dataAux.Buses;
        
        return data;
    };

    function adaptInsuranceResponseData(response) {
        if (response.InsuranceResponseData && response.InsuranceResponseData.Insurances && response.InsuranceResponseData.Insurances.length) {
            response.Insurances = response.InsuranceResponseData.Insurances;
        }
    }

    function adaptAnacDetails(response) {
        if (response && response.AnacDetails) {

            if (response.FlightGroups) {
                response.FlightGroups.forEach(function (fg) {
                    fg.Flights.forEach(function (f) {
                        f.AnacDetails = response.AnacDetails[f.AnacDetailsIndex];
                    });
                });
            }

            if (response.CityPairs) {
                response.CityPairs.forEach(function (cityPair) {
                    cityPair.FlightGroups.forEach(function (fg) {
                        fg.Flights.forEach(function (f) {
                            f.AnacDetails = response.AnacDetails[f.AnacDetailsIndex];
                        });
                    });
                });
            }
        }
    };

    function _removeUselessHotels(response) {
        if (removeUselessHotels) {
            if (response.SearchData && response.SearchData.HotelSearchData && data && data.Hotels) {
                var daysStay = Util.DateValuesDiff(response.SearchData.HotelSearchData.CheckIn, response.SearchData.HotelSearchData.CheckOut, 'days');
                var bestPriceHotelId = (data.BestPricePackage != null && data.BestPricePackage.Hotels && data.BestPricePackage.Hotels.length) ? data.BestPricePackage.Hotels[0].Id : -1;
                var i = data.Hotels.length - 1;

                while (i >= 0) {
                    if (i < data.Hotels.length && data.Hotels[i].AuxiliarData && data.Hotels[i].AuxiliarData.AllRoomsAvailableStayOptions) {
                        if (!data.Hotels[i].AuxiliarData.AllRoomsAvailableStayOptions.any(function (s) { return s == daysStay; }) && data.Hotels[i].Id != bestPriceHotelId) {
                            delete auxHotelSearchResponse[data.Hotels[i].Id];
                            data.Hotels.remove(i);
                        }
                        else
                            i--;
                    }
                    else
                        i--;
                }
            }
        }
    }

    function _orderResultByPrice(response) {
        _orderCityPairsResult(response.CityPairs);
    };

    function _orderCityPairsResult(cityPairs) {
        if (cityPairs) {
            for (var i = 0; i < cityPairs.length; i++) {
                cityPairs[i].FlightGroups.orderBy(function (d) {
                    var fgTotalAmount;
                    var cheapestFareOption = d.FareOptions.orderBy(function (fo) { return fo.FareAmount; }).first();

                    if (cheapestFareOption != null)
                        fgTotalAmount = SharedFunctions.ResolverAirSumTaxes(cheapestFareOption.FareAmount, cheapestFareOption.DUTaxes, cheapestFareOption.TaxAmount);

                    if (fgTotalAmount && fgTotalAmount.FareAmount)
                        return fgTotalAmount.FareAmount;

                    return 0;
                });
            }
        }
    };

    this.onError = function (response) {
        if (response && response.Errors && response.Errors.length) {
            if (Global && Global.HandleErrors) {
                Global.HandleErrors(response);
            }
            controller.onError(response.Errors);
        }
    };

    function fillAdditionInfo(searchParameters) {

        var additionalInfo = [];
        if (searchParameters) {
            additionalInfo.push({ Key: 'IsCruise', Value: searchParameters.AdditionalInfo && searchParameters.AdditionalInfo.IsCruise ? searchParameters.AdditionalInfo.IsCruise : "false" });
            additionalInfo.push({ Key: 'SearchForPackageComposition', Value: searchParameters.SearchForPackageComposition ? searchParameters.SearchForPackageComposition.toString() : "false" });
            Util.getCookie('authenticatedCpf') && additionalInfo.push({ Key: 'authenticatedCpf', Value: Util.getCookie('authenticatedCpf') });
            Util.getCookie('userRoles') && additionalInfo.push({ Key: 'userRoles', Value: Util.getCookie('userRoles') });
            Util.getCookie('userRolesHash') && additionalInfo.push({ Key: 'userRolesHash', Value: Util.getCookie('userRolesHash') });

            if (searchParameters.AdditionalInfo && searchParameters.AdditionalInfo.SearchIndex)
                additionalInfo.push({ Key: 'SearchIndex', Value: searchParameters.AdditionalInfo.SearchIndex });

            if (searchParameters.UserParameters) {
                additionalInfo.push({ Key: "UserParameters", Value: JSON.stringify(searchParameters.UserParameters) });
            }
        }

        return additionalInfo;
    }

    this.GetSearchStatus = function (timeOut, response, searchParameters, startTime) {

        if (!startTime)
            startTime = performance.now();

        var toInvoke = Global && Global.UseMinimunJSON ? "GetSearchStatusMinimunJSON" : "GetSearchStatus";

        lastGetSeachStatus = setTimeout(
            function searchModelgetSearchStatus() {
                var RequestGetSearchStatus = {};
                RequestGetSearchStatus.SearchId = response.SearchId;
                RequestGetSearchStatus.Culture = Global.Culture;

                if (Global.AffiliatedId != undefined && Global.AffiliatedId != null && Global.AffiliatedId != 0)
                    RequestGetSearchStatus.AffiliatedId = Global.AffiliatedId;

                if (searchParameters && searchParameters.Air && searchParameters.Air.PricingTradeType) {
                    pricingTradeType = searchParameters.Air.PricingTradeType;
                }

                lastInvoke && lastInvoke.abort();

                if (continueSearch && response.PullStatusFrom) {

                    var searchRQ = {
                        TravelEngineGetStatusSearchRQ: RequestGetSearchStatus,
                        TradeType: parseFloat(pricingTradeType),
                        AdditionalInfo: fillAdditionInfo(searchParameters)
                    };

                    var client = clientWS;

                    var serviceUIAddress = response.PullStatusFrom.first(function (c) { return c.Key == "TravelAgentServiceUI" });
                    if (serviceUIAddress)
                        client = new ServiceCaller(serviceUIAddress.Value);

                    lastInvoke = client.invoke(toInvoke, { req: searchRQ, pullStatusFrom: response.PullStatusFrom }, function (response) { thisModel.OnSearchStatus(response, startTime); }, thisModel.onError);
                }

            }, timeOut);
    };

    this.OnSearchStatus = function (response, startTime) {

        if (!startTime)
            startTime = performance.now();

        _functions.prepare.searchResponse.errors(response);

        response.TravelEngineSearchRS.Suppliers = response.Suppliers;
        response = response.TravelEngineSearchRS;

        if (response && response.Errors && response.Errors.length && Global && Global.HandleErrors)
            Global.HandleErrors(response);

        orderlyData = undefined;

        adaptResponse(response);

        if (response &&
            (response.PriceGroups || response.Recommendations || response.CityPairs || response.CruiseResponseData
                || (response.Hotels && response.Hotels.length > 0)
                || (response.ServicesResponseData && response.ServicesResponseData.Services && response.ServicesResponseData.Services.length)
                || (response.CarResponseData && response.CarResponseData.CarQuoteGroups && response.CarResponseData.CarQuoteGroups.length
                    || (response.Insurances && response.Insurances.length))
            )) {

            data = mergeDatas(data, response);
        } else {
            if (response.Errors && response.Errors.length)
                data.Errors = response.Errors;
        }

        data.SearchSummary = response.SearchSummary;

        if (data.SearchData == undefined)
            data.SearchData = response.SearchData

        if (searchData == undefined || $.isEmptyObject(searchData))
            searchData = data.SearchData;

        _updateFilters(response);

        if (data) {

            Debug.lastSearchResponse = data;

            exchangeRates = data.ExchangeRates;

            controller.currentCurrency(exchangeRates);

            applyInterfaceIndex(data);

            mergeChainsResponse(data);

            mergeLocationsResponse(data);

            preparePriceGroupsRecommendation(data);

            mergePriceGroupsResponse(data);

            mergeRecommendationsResponse(data);

            mergeHotelResponse(data);

            mergePackagesResponse(data);

            _functions.mergeInsuranceResponse(data);

            if (Global.updateStayOptions == undefined || Global.updateStayOptions)
                updateStayOptions(data);

            adaptPriceGroups(data);

            adaptBestPricePackage(data);

            data.auxRecommendations = data.Recommendations || [];
            data.auxPriceGroups = data.PriceGroups || [];

            adaptCruiseOptions(data);

            if (response.Status == EnumHelper.SearchStatus.Completed) {

                validateCompletedResponse(data);

                _separateSuggestionPackages(data);

                _updateSearchSummary(data);

                _createPackageFilterData(data);

                _removeUselessHotels(data);

                _orderResultByPrice(data);

                _functions.calculatePackagePrice();

                _functions.fillSearchDuration(data, startTime);

                _functions.prepare.copyPriceGroupCityPairsOriginsAndDestinations(data);

                controller.onSearchCompleted(data);
            }
            else {
                if (doSearchUpdate(response))
                    controller.onSearchUpdated(data);

                if (response.PullStatusFrom)
                    thisModel.GetSearchStatus(Global.MilisecondsToDoGetSearchStatus, response, controller.lastSearchParameters, startTime);
                else
                    thisModel.onError(response);
            }
        }
    };

    this.PackageDetails = function (req) {
        clientWS.invoke("SearchPackageDetailsAvail", { req: { TravelEnginePackageDetailRQ: req } }, thisModel.onPackageDetailsSuccess, thisModel.OnError);
    };

    this.onPackageDetailsSuccess = function (response) {
        if (response && response.Errors && response.Errors.length)
            thisModel.onError(response);
        else
            controller.onPackageDetailsCompleted(response);
    };

    this.PackageCalendar = function (req) {
        clientWS.invoke("GetPackageCalendar", { req: req }, thisModel.onPackageCalendarSuccess, thisModel.OnError);
    };

    this.searchPackages = function (searchParameters) {

        var searchRQ = {
            "TravelEngineSearchRQ": getRequestData(searchParameters)
        };

        if (searchParameters.RoomSharingCode)
            searchRQ.RoomSharingCode = searchParameters.RoomSharingCode;

        if (searchParameters.AdditionalInfo) {

            searchRQ.AdditionalInfo = searchRQ.AdditionalInfo || [];
            for (var p in searchParameters.AdditionalInfo) {
                if (searchParameters.AdditionalInfo[p]) {
                    var obj = {
                        Key: p.toString(),
                        Value: searchParameters.AdditionalInfo[p].toString()
                    };

                    searchRQ.AdditionalInfo.push(obj);
                }
            }
        }

        clientWS.invoke("GetPackages", { req: searchRQ }, function (response) { thisModel.OnSearchStatus(response); }, thisModel.onError);
    };

    this.onPackageCalendarSuccess = function (response) {
        if (response && response.Errors && response.Errors.length)
            thisModel.onError(response);
        else
            controller.onPackageCalendarCompleted(response);
    };

    this.HotelDetails = function (req) {

        req.Culture = Global.Culture;
        req.Currency = Global.Currency;

        if (req.SearchParameters)
            req.SearchData = getRequestData(req.SearchParameters).SearchData;

        if (isFakeHotelBrokerForRooms(req.Hotel))
            req.Hotel.Rooms = [];

        this.processHotelDetails(req);

    };

    var isFakeHotelBrokerForRooms = function (hotel) {
        var response = false;
        for (var i = 0; i < fakeRoomBrokers.length; i++) {
            if (hotel.HotelBrokers[fakeRoomBrokers[i]] || hotel.HotelBrokers.any(function (h) { return h.Key == fakeRoomBrokers[i]; })) {
                response = true;
                break;
            }
        };

        return response;
    };

    var isFakeRoomBroker = function (room) {
        var response = false;
        for (var i = 0; i < fakeRoomBrokers.length; i++) {
            if (room.RoomBrokers[fakeRoomBrokers[i]] || room.RoomBrokers.any(function (h) { return h.Key == fakeRoomBrokers[i]; })) {
                response = true;
                break;
            }
        };

        return response;
    }

    this.onHotelDetailsSuccess = function (response, request) {
        if (response && response.Errors && response.Errors.length) {
            thisModel.onError(response);
        }
        else {
            if (response && response.TravelEngineHotelDetailsRS) {
                response.TravelEngineHotelDetailsRS.Hotel = complementHotelWithDetails(response.TravelEngineHotelDetailsRS.Hotel);
                updateHotelAfterGetDetails(response.TravelEngineHotelDetailsRS.Hotel);
                _functions.recalculateProducts.Hotel.recalculateOnHotelDetail(response.TravelEngineHotelDetailsRS.Hotel);
            }

            controller.onHotelDetailsCompleted(response, request);
        }
    };

    var updateHotelAfterGetDetails = function (hotel) {
        data.Hotels.forEach(function (h) {
            if (h.Id == hotel.Id) {
                h.Images = hotel.Images;
                h.Address = hotel.Address;

                if (isFakeHotelBrokerForRooms(h)) {
                    h.RoomsGroups = hotel.RoomsGroups;
                    if (h.AuxiliarData)
                        h.AuxiliarData.IsDetailed = true;
                }
            }
        });
    };

    this.processHotelDetails = function (req) {

        if (req.Hotel.HotelBrokers.any(function (broker) { return broker.Key == "HotelOffline"; })) {

            var prefferedBrokers = Global.SystemSettings ? Global.SystemSettings['PreferredBrokersForHotelDetails'].split(',') : [];

            if (prefferedBrokers.length == 0 || req.Hotel.HotelBrokers.any(ValidatePreferredBrokers)) {
                clientWS.invoke("HotelDetails", { req: { Culture: req.Culture, UserParameters: req.UserParameters, TravelEngineHotelDetailsRQ: req } }, function (res) { thisModel.onHotelDetailsSuccess(res, req); }, thisModel.onError);
            }
            else {
                var detailsResponse = getWrappedHotelDetailsResponse(req.Hotel);
                thisModel.onHotelDetailsSuccess(detailsResponse, req);
            }
        }
        else {
            clientWS.invoke("HotelDetails", { req: { Culture: req.Culture, UserParameters: req.UserParameters, TravelEngineHotelDetailsRQ: req } }, function (res) { thisModel.onHotelDetailsSuccess(res, req); }, thisModel.onError);
        }
    };

    this.Paginate = function (searchParameters) {

        var searchRQ = {};
        searchRQ.AdditionalInfo = searchRQ.AdditionalInfo || [];
        searchRQ.TravelEngineSearchRQ = getRequestData(searchParameters);
        searchRQ.Passengers = searchParameters.Passengers;
        searchRQ.UserParameters = searchParameters.UserParameters;

        clientWS.invoke("Search", { req: searchRQ }, function (response) {
            thisModel.OnPaginate(response, searchRQ);
        }, thisModel.onError);
    }

    this.OnPaginate = function (response, request) {
        if (response && response.Errors && response.Errors.length) {
            thisModel.onError(response);
        }
        else {
            adaptResponse(response.TravelEngineSearchRS);
            mergeHotelResponse(response.TravelEngineSearchRS);
            controller.onPaginateCompleted(response, request);
        }
    }

    var ValidatePreferredBrokers = function (broker) {
        var prefferedBrokers = Global.SystemSettings['PreferredBrokersForHotelDetails'].split(',');
        return prefferedBrokers.any(function (preferred) { return preferred == broker.Key; });
    }

    var getWrappedHotelDetailsResponse = function (hotel) {

        return { Errors: [], TravelEngineHotelDetailsRS: { Hotel: hotel } };
    }

    this.HotelDailyFares = function (req) {

        req.Culture = Global.Culture;
        req.Currency = Global.Currency;

        if (req.SearchParameters)
            req.SearchData = getRequestData(req.SearchParameters).SearchData;

        clientWS.invoke("HotelDetails", { req: { TravelEngineHotelDetailsRQ: req } }, thisModel.onHotelDailyFaresSuccess, thisModel.OnError);

    };

    this.onHotelDailyFaresSuccess = function (response) {
        if (response && response.Errors && response.Errors.length)
            thisModel.onError(response);
        else {
            complementHotelWithDetails(response.TravelEngineHotelDetailsRS.Hotel);
            controller.onHotelDailyFaresCompleted(response);
        }
    }

    this.HotelImagesDetails = function (req) {

        req.Culture = Global.Culture;
        req.Currency = Global.Currency;

        if (req.SearchParameters)
            req.SearchData = getRequestData(req.SearchParameters).SearchData;

        clientWS.invoke("HotelDetails", { req: { TravelEngineHotelDetailsRQ: req } }, thisModel.onHotelImagesDetailsSuccess, thisModel.OnError);

    }

    this.onHotelImagesDetailsSuccess = function (response) {
        if (response && response.Errors && response.Errors.length)
            thisModel.onError(response);
        else {
            complementHotelWithDetails(response.TravelEngineHotelDetailsRS.Hotel);
            controller.onHotelImagesDetailsCompleted(response);
        }
    }

    this.HotelMapDetails = function (req) {

        req.Culture = Global.Culture;
        req.Currency = Global.Currency;

        if (req.SearchParameters)
            req.SearchData = getRequestData(req.SearchParameters).SearchData;

        clientWS.invoke("HotelDetails", { req: { TravelEngineHotelDetailsRQ: req } }, thisModel.onHotelMapDetailsSuccess, thisModel.OnError);

    }

    this.onHotelMapDetailsSuccess = function (response) {
        if (response && response.Errors && response.Errors.length)
            thisModel.onError(response);
        else {
            complementHotelWithDetails(response.TravelEngineHotelDetailsRS.Hotel);
            controller.onHotelMapDetailsCompleted(response);
        }
    }

    this.EventDetails = function (req) {
        clientWS.invoke("EventDetails", { req: { TravelEngineEventDetailsRQ: req } }, thisModel.onEventDetailsSuccess, thisModel.onError);
    }

    this.onEventDetailsSuccess = function (response) {
        if (response && response.Errors && response.Errors.length)
            thisModel.onError(response);
        else {
            data.Event = response.Evento;
            controller.onEventDetailsCompleted(response);
        }
    }

    this.FilterByPrice = function (price) {

        var airFilterData = Util.Clone(data.AirFiltersData);

        airFilterData.NumberOfStops = [{ Stops: 0 }, { Stops: 1 }, { Stops: 2 }, { Stops: 3 }, { Stops: 4 }, { Stops: 5 }, { Stops: 6 }, { Stops: 7 }, { Stops: 8 }, { Stops: 9 }];
        airFilterData.MinDuration = 0;
        airFilterData.MaxDuration = 999999;
        airFilterData.MinOutboundDuration = 0;
        airFilterData.MaxOutboundDuration = 999999;
        airFilterData.MinOutboundDuration = 0;
        airFilterData.MaxOutboundDuration = 999999;
        airFilterData.MinOutboundTime = 0;
        airFilterData.MaxOutboundTime = 999999;
        airFilterData.MinInboundTime = 0;
        airFilterData.MaxInboundTime = 999999;

        airFilterData.AvailableNumberOfStops = [];

        if (!isNaN(price)) {
            price = price.normalize();
            airFilterData.MinPrice = price;
            airFilterData.MaxPrice = price;
            airFilterData.MinPoints = 0;
            airFilterData.MaxPoints = 0;
        } else if (typeof (price) == 'object') {
            if (price.Price && price.Price > 0) {
                airFilterData.MinPrice = price.Price;
                airFilterData.MaxPrice = price.Price;
            }
            if (price.Points && price.Points > 0) {
                airFilterData.MinPoints = price.Points;
                airFilterData.MaxPoints = price.Points;

                if (price.Ciacode)
                    airFilterData.AirCompanies = [{ 'CiaCode': price.Ciacode }];
            }

            if (price.NumberOfStops && price.NumberOfStops.length) {
                airFilterData.NumberOfStops = price.NumberOfStops;
            }
        }

        var obj = { 'AirFiltersData': airFilterData };

        thisModel.Filter(obj);

        controller.onFilterChanged(obj);
    };

    this.FilterByAirCompany = function (filterData) {
        thisModel.Filter(filterData);

        controller.onFilterChanged();
    };

    function removeFakeRooms(hotel) {
        hotel.Rooms = hotel.Rooms.removeAll(function (r) {
            if (fakeRoomBrokers.indexOf(r.OriginalBrokerName) > -1) {
                hotel.RoomsGroups.forEach(function (rg) {
                    rg.RoomsIds = rg.RoomsIds.removeAll(function (ri) { return ri === r.Id; });
                });

                return true;
            }

            r.Fake = false;
            return false;
        });
    }

    function mergeRoomsWithDetailedHotel(hotel, detailedHotel) {
        hotel.Rooms = hotel.Rooms.concat(detailedHotel.Rooms).orderBy(function (r) {
            return r.StayOptions[0].DailyFare.Value;
        });

        hotel.RoomsGroups.forEach(function (rg) {
            var detailedRoomGroup = detailedHotel.RoomsGroups.first(function (drg) { return drg.SearchIndex === rg.SearchIndex; });
            if (detailedRoomGroup) {
                detailedRoomGroup.RoomsIds.forEach(function (ri) { rg.RoomsIds.push(ri); });
                rg.Rooms = undefined;
            }
        });
    }

    function mergeRooms(hotel, detailedHotel) {
        if (!hotel.Rooms)
            hotel.Rooms = hotel.RoomsGroups.selectMany(function (rg) { return rg.Rooms });

        if (hotel.HotelBrokers.any(function (hb) { return fakeRoomBrokers.indexOf(hb.Key) > -1; })) {
            removeFakeRooms(hotel);

            if (hotel.Rooms.length)
                mergeRoomsWithDetailedHotel(hotel, detailedHotel);
            else {
                hotel.Rooms = detailedHotel.Rooms;
                hotel.RoomsGroups = detailedHotel.RoomsGroups;
            }

            hotel.MoreRooms = true;
        }
        else if (hotel.Rooms && hotel.Rooms.length) {

            var initialRoomsLength = hotel.Rooms && hotel.Rooms.length;
            var mergedRooms = Util.Clone(hotel.Rooms);

            $.each(detailedHotel.Rooms, function () {
                var detailedRoom = this;

                $.each(hotel.Rooms, function (index) {
                    if (this.Id == detailedRoom.Id) {
                        mergedRooms[index] = detailedRoom;
                        mergedRooms[index].Merged = true;
                    }
                });

                if (!detailedRoom.Merged)
                    mergedRooms.push(detailedRoom);
            });

            hotel.Rooms = mergedRooms;

            $.each(detailedHotel.RoomsGroups, function () {
                var detailedRoomGroup = this;
                $.each(hotel.RoomsGroups, function (index) {
                    hotel.RoomsGroups[index] = detailedRoomGroup;
                    hotel.RoomsGroups[index].Rooms = hotel.Rooms.where(function (r) { return detailedRoomGroup.RoomsIds.includes(r.Id) });
                });

            });

            if (hotel.Rooms.length != initialRoomsLength)
                hotel.MoreRooms = true;
        }
        else {
            hotel.Rooms = detailedHotel.Rooms;
            hotel.RoomsGroups = detailedHotel.RoomsGroups;
        }

    };

    function adaptResponse(response) {
        adaptAirResponseData(response);
        adaptHotelResponseData(response);
        adaptServiceResponseData(response);
        adaptCarResponseData(response);
        adaptInsuranceResponseData(response);
        adaptRecommendations(response);
        adaptAnacDetails(response);
        adaptPackageResponseData(response);
        adaptItineraryResponseData(response);
        adaptBusResponseData(response);
    }

    function adaptBusResponseData(response) {
        if (response.BusResponseData) {
            response.BusFiltersData = response.BusResponseData.BusFiltersData;
            response.BusStationPairs = response.BusResponseData.BusStationPairs;
         }
    }

    function adaptHotelResponseData(response) {
        if (response.HotelResponseData) {
            response.HotelFiltersData = response.HotelResponseData.HotelFiltersData;
            response.Hotels = response.HotelResponseData.Hotels;
            response.Chains = response.HotelResponseData.Chains;
            response.Locations = response.HotelResponseData.Locations;
        }
    };

    function adaptAirResponseData(response) {
        if (response.AirResponseData) {
            response.AirFiltersData = response.AirResponseData.AirFiltersData;
            response.AnacDetails = response.AirResponseData.AnacDetails;
            response.CityPairFiltersData = response.AirResponseData.CityPairFiltersData;
            response.CityPairs = response.AirResponseData.CityPairs;
            response.FlightGroups = response.AirResponseData.FlightGroups;
            response.PriceGroups = response.AirResponseData.PriceGroups;
            response.PriceMatrix = response.AirResponseData.PriceMatrix;
            response.Recommendations = response.AirResponseData.Recommendations;
        }
    };

    function adaptServiceResponseData(response) {
        if (response.ServicesResponseData && response.ServicesResponseData.Services && response.ServicesResponseData.Services.length) {
            var hasPackage = response.PackageResponseData && response.PackageResponseData.Packages && response.PackageResponseData.Packages.length > 0;
            response.ServicesResponseData.Suppliers = response.Suppliers;
            response.ServicesResponseData.Services = ServiceExtensions.PrepareFunctions.Initialize(response.ServicesResponseData, hasPackage);
        }
    };

    function adaptCarResponseData(response) {
        if (response.CarResponseData && response.CarResponseData.CarQuoteGroups && response.CarResponseData.CarQuoteGroups.length) {
            response.CarResponseData.CarQuoteGroups = CarExtensions.PrepareFunctions.Initialize(response.CarResponseData);
        }

        if (response.CarResponseData && response.CarResponseData.Quotes) {
            for (var i = 0; i < response.CarResponseData.Quotes.length; i++) {
                response.CarResponseData.Quotes[i].PickupDate = searchData.CarSearchData.PickupDate;
                response.CarResponseData.Quotes[i].DropoffDate = searchData.CarSearchData.DropoffDate;
            }
        }

    }

    function adaptPackageResponseData(response) {
        if (typeof (PackageExtensions) != "undefined") {
            if (response.PackageResponseData && response.PackageResponseData.Packages && response.PackageResponseData.Packages.length) {
                PackageExtensions.PrepareFunctions.Initialize(response, response.SearchData);
            }
            else {
                PackageExtensions.SearchResponseData.HotelResponseData = response.HotelResponseData;
                PackageExtensions.PrepareFunctions.Initialize(PackageExtensions.SearchResponseData, response.SearchData);
            }
        }
    }

    function adaptItineraryResponseData(response) {
        if (response.ItineraryResponseData && response.ItineraryResponseData.Itineraries && response.ItineraryResponseData.Itineraries.length) {
            response.ItineraryResponseData.Itineraries = ItineraryExtensions.PrepareFunctions.Initialize(response.ItineraryResponseData, response.SearchData);
        }
    };


    var complementHotelWithDetails = function (detailedHotel) {

        if (detailedHotel) {

            var hotel = thisModel.getHotelReferenced(detailedHotel.Id);

            if (hotel.dettach)
                hotel = hotel.dettach();

            if (hotel.Address)
                hotel.Address = detailedHotel.Address;

            hotel.Services = (hotel.Services && hotel.Services.length) ? hotel.Services : detailedHotel.Services;

            if (detailedHotel.Images && detailedHotel.Images.length)
                hotel.Images = detailedHotel.Images;

            mergeRooms(hotel, detailedHotel);

            //DescriÃ§Ã£o muda de disponibilidade para detalhe
            hotel.Description = detailedHotel.Description;

            hotel.ExternalDetails = detailedHotel.ExternalDetails;

            var hotel = new Hotel(hotel);

            hotel.AuxiliarData.IsDetailed = true;

            if (hotel.MoreRooms)
                auxHotelSearchResponse[hotel.Id] = [hotel, 0];

            return hotel;
        }
    };

    var doSearchUpdate = function (response) {

        if (response.Status != 1) {

            var searchParameters = controller.lastSearchParameters;

            if (response.AirResponseData) {
                if (response.AirResponseData.PriceMatrix && response.AirResponseData.PriceMatrix.AirCompanies && response.AirResponseData.PriceMatrix.AirCompanies.length)
                    return true;

                if (response.AirResponseData.CityPairs && response.AirResponseData.CityPairs.length)
                    return true;

                if (response.AirResponseData.Recommendations && response.AirResponseData.Recommendations.length)
                    return true;
            }

            if (response.Hotels && response.Hotels.length && !searchParameters.Air)
                return true;

            if (response.BestPricePackage && response.BestPricePackage.Hotels && response.BestPricePackage.Hotels.length && response.BestPricePackage.Recommendation)
                return true;

            if (response.CarResponseData && response.CarResponseData.CarQuoteGroups && response.CarResponseData.CarQuoteGroups.length)
                return true;

            if (response.PackageResponseData && response.PackageResponseData.Packages.length)
                return true;
        }

        return false;
    };

    var applyInterfaceIndex = function (response) {
        if (response && response.PriceGroups)
            for (var i = 0, len = response.PriceGroups.length; i < len; i++)
                response.PriceGroups[i].InterfaceIndex = i;
    };

    var mergePriceGroupsResponse = function (response) {
        if (response.PriceGroups)
            auxPriceGroupsResponse = response.PriceGroups;

        response.PriceGroups = auxPriceGroupsResponse;

        if (response.BestPricePackage && response.BestPricePackage.Recommendation) {
            response.BestPricePackage.Recommendation.PriceGroups = auxPriceGroupsResponse;
        }

    };

    var mergeRecommendationsResponse = function (response) {

        if (response.Recommendations) {
            auxRecommendationsResponse = response.Recommendations;
            for (var j = 0; j < auxRecommendationsResponse.length; j++) {
                fillRecommendationExchangeAirports(auxRecommendationsResponse[j]);

                if (auxRecommendationsResponse[j].PaymentOptions && auxRecommendationsResponse[j].PaymentOptions.length) {
                    var bestPayment = 0
                    for (var i = 0; i < auxRecommendationsResponse[j].PaymentOptions.length; i++)
                        if (auxRecommendationsResponse[j].PaymentOptions[i].Installments.length > auxRecommendationsResponse[j].PaymentOptions[bestPayment].Installments.length)
                            bestPayament = i;

                    auxRecommendationsResponse[j].Installments = auxRecommendationsResponse[j].PaymentOptions[bestPayment].Installments[auxRecommendationsResponse[j].PaymentOptions[bestPayment].Installments.length - 1].TotalInstallments;
                    auxRecommendationsResponse[j].InstallmentPrice = auxRecommendationsResponse[j].PaymentOptions[bestPayment].Installments[auxRecommendationsResponse[j].PaymentOptions[bestPayment].Installments.length - 1].OtherPaymentsAmount;
                }
            }
        }

        response.Recommendations = auxRecommendationsResponse;
    };

    var fillRecommendationExchangeAirports = function (recommendation) {
        recommendation.airportExchange = [];
        var lastDestination = "";
        recommendation.hasAirportExchange = false;
        for (var j = 0; j < recommendation.FlightGroups.length; j++) {

            var flightGroup = recommendation.FlightGroups[j];

            for (var i = 0; i < flightGroup.OriginalFlightGroup.Flights.length; i++) {
                var flight = flightGroup.OriginalFlightGroup.Flights[i];

                recommendation.airportExchange[j + '.' + i] = false;
                if (j > 0 || i > 0)
                    recommendation.airportExchange[j + '.' + i] = lastDestination != flight.Origin;

                recommendation.hasAirportExchange |= recommendation.airportExchange[j + '.' + i];

                lastDestination = flight.Destination;
            }
        }
    }

    var preparePriceGroupsRecommendation = function (response) {

        if (response.Recommendations) {
            if (typeof Recommendation === "function") {
                for (var i = 0; i < response.Recommendations.length; i++) {
                    response.Recommendations[i] = new Recommendation(response.Recommendations[i]);
                }
            }
        }

        if (response.PriceGroups) {
            if (typeof PriceGroup === "function") {
                for (var i = 0; i < response.PriceGroups.length; i++) {
                    response.PriceGroups[i] = new PriceGroup(response.PriceGroups[i], response.Recommendations);
                }
            }
        }
    }

    function prepareHotelFakeRooms(hotel) {
        if (isFakeHotelBrokerForRooms(hotel)) {

            if (hotel.Rooms && hotel.Rooms.length) {
                hotel.Rooms.forEach(function (r) {
                    r.Fake = isFakeRoomBroker(r);
                });
            }
            else if (hotel.RoomsGroups) {
                hotel.RoomsGroups.foreach(function (rg) {
                    rg.Rooms.foreach(function (r) {
                        r.Fake = isFakeRoomBroker(r);
                    });
                });
            }
        }
    };

    var mergeHotelResponse = function (response) {
        /* auxHotelSearchResponse Ã© o cache principal dos HotÃ©is */
        auxHotelSearchResponse = {};
        var hotelsCount = 0;

        if (response.Hotels && response.Hotels.length) {

            hotelsCount = response.Hotels.length;

            for (var h = 0; h < response.Hotels.length; h++) {
                var hotel = _functions.prepare.prepareHotel(response.Hotels[h]);

                auxHotelSearchResponse[hotel.Id] = [hotel, h];
            }

            /* preenche o response com todos os hotÃ©is que jÃ¡ estavam no client */
            response.Hotels = [];

            for (var i = 0; i <= hotelsCount; i++) {
                for (var h in auxHotelSearchResponse) {
                    var hotelArray = auxHotelSearchResponse[h];
                    var hotelIndex = auxHotelSearchResponse[h][1];

                    if (hotelIndex === i) {
                        if (h && auxHotelSearchResponse[h] && auxHotelSearchResponse[h][0])
                            response.Hotels.push(hotelArray[0]);
                    }
                }
            }

            if (response.Status == 1) {
                for (h = 0; h < response.Hotels.length; h++) {
                    if (data.Recommendations && data.Recommendations.length)
                        _functions.recalculateProducts.Hotel.reSelectHotelStayOptions(response.Hotels[h]);
                }
            }
        }
    };

    var mergePackagesResponse = function (response) {

        if (response.PackageResponseData) {
            if (response.PackageResponseData.Packages) {
                for (var i = 0; i < response.PackageResponseData.Packages.length; i++) {
                    var currentPackage = response.PackageResponseData.Packages[i];
                    auxPackagesResponse[currentPackage.Id] = currentPackage;
                }
            }

            response.PackageResponseData.Packages = getPackagesResponse();
        }
    };

    var getPackagesResponse = function () {
        var packages = [];

        for (var item in auxPackagesResponse)
            if (item && auxPackagesResponse[item])
                packages.push(auxPackagesResponse[item]);

        var refPackages = packages;

        packages = [];

        refPackages
            .orderByDescending(function (pkg) { return (pkg.Summary && pkg.Summary.AmountByPassenger) || 0; })
            .groupByWithoutKey(function (h) { return h.Summary && h.Summary.AmountByPassenger > 0; })
            .foreach(function (group) {
                var ordered = group.orderBy(function (pkg) { return pkg.Summary && pkg.Summary.AmountByPassenger; }, function (pkg) { return pkg.Nights; });

                packages.addRange(ordered);
            });

        return packages;
    };

    var productCategory = {
        Recommendation: '0',
        Hotel: '1',
        Service: '2',
        CityPair: '3'
    };

    var mergeLocationsResponse = function (response) {
        if (response.Locations) {
            for (var i = 0; i < response.Locations.length; i++) {
                var location = response.Locations[i];
                if (!auxLocationsResponse[location.Key])
                    auxLocationsResponse[location.Key] = location.Value;
            }
        }

        response.Locations = [];

        for (var i in auxLocationsResponse) {
            if (i && auxLocationsResponse[i])
                response.Locations.push(auxLocationsResponse[i]);
        }
    };

    var mergeChainsResponse = function (response) {
        if (response.Chains) {
            auxChainsResponse = response.Chains;
        }
    };

    var keepOriginalValues = function (hotel) {
        for (var i = 0; i < hotel.Rooms.length; i++) {
            var room = hotel.Rooms[i];

            for (var j = 0; j < room.StayOptions.length; j++) {

                var stayOption = room.StayOptions[j];

                /* Cria nova propriedade nos quartos para manter os valores originais */
                if (stayOption.OriginalValues == undefined) {
                    stayOption.OriginalValues = {};
                    stayOption.OriginalValues.TotalAmount = roomOption.TotalAmount;
                    stayOption.OriginalValues.PromoDisplayDailyFare = roomOption.PromoDisplayDailyFare;
                    stayOption.OriginalValues.DisplayDailyFare = roomOption.DisplayDailyFare;
                    stayOption.OriginalValues.TotalDiscountAH = roomOption.TotalDiscountAH;
                }
            }

            if (room.SelectedRoomOption && room.SelectedRoomOption.OriginalValues == undefined) {
                room.SelectedRoomOption.OriginalValues = {};
                room.SelectedRoomOption.OriginalValues.TotalAmount = room.SelectedRoomOption.TotalAmount;
                room.SelectedRoomOption.OriginalValues.PromoDisplayDailyFare = room.SelectedRoomOption.PromoDisplayDailyFare;
                room.SelectedRoomOption.OriginalValues.TotalDiscountAH = room.SelectedRoomOption.TotalDiscountAH;
            }
        }

        /* Cria nova propriedade no hotel para manter os valores originais */
        if (hotel.OriginalValues == undefined) {
            hotel.OriginalValues = {};
            hotel.OriginalValues.TotalAmount = hotel.TotalAmount;
            hotel.OriginalValues.PromoDisplayDailyFare = hotel.PromoDisplayDailyFare;
            hotel.OriginalValues.DisplayDailyFare = hotel.DisplayDailyFare;
        }
    };

    var updateStayOptions = function (response) {

        //if (response.Status != 0 && response.BestPricePackage && response.Hotels && response.BestPricePackage.Recommendation) {

        //    var recommendation = response.BestPricePackage.Recommendation;

        //    var recommendationValue = recommendation ? (recommendation.MarkupedTotalAmount > recommendation.TotalAmount ? recommendation.MarkupedTotalAmount : recommendation.TotalAmount) : 0

        //    for (var i = 0; i < response.Hotels.length; i++) {

        //        for (var j = 0; j < response.Hotels[i].RoomsGroups.length; j++) {

        //            response.Hotels[i].RoomsGroups[j].Rooms.forEach(function (r) {

        //                for (var k = 0; k < r.StayOptions.length; k++) {

        //                    var stayOption = r.StayOptions[k];

        //                    //Atualizar os RoomOptions
        //                    stayOption.sum(recommendationValue);
        //                }

        //            });
        //        }
        //    }
        //}
    };

    var getSelectedRoomOption = function (recommendation, room) {
        var checkinDate = getArrivalDate(recommendation);
        var checkoutDate = getDepartureDate(recommendation);

        var roomOptions = room.RoomOptions.where(function (ro) {
            return ((checkoutDate == undefined || Util.DateValuesEquals(ro.CheckOutValues, checkoutDate)) && Util.DateValuesEquals(ro.CheckInValues, checkinDate));
        });

        if (!roomOptions || roomOptions.length == 0)
            roomOptions = room.RoomOptions;

        roomOptions.orderBy(function (ro) { return ro.CheckInValues.Year + ro.CheckInValues.Month + ro.CheckInValues.Day; });

        return roomOptions[0];
    };

    var getArrivalDate = function (recommendation) {
        if (!recommendation)
            return null;
        var flights = recommendation.FlightGroups[0].OriginalFlightGroup.Flights;
        var checkinDate = Util.Clone(flights.last().ArrivalDateTimeValues);

        if (checkinDate.Hour < 5) {
            //Day before
            var date = (Util.DateValuesToDate(checkinDate)).addDays(-1);
            checkinDate.Year = date.getFullYear();
            checkinDate.Month = date.getMonth() + 1;
            checkinDate.Day = date.getDate();
        }

        return checkinDate;
    };

    var getDepartureDate = function (recommendation) {

        var resp = undefined;
        if (recommendation)
            if (recommendation.FlightGroups.length > 1)
                resp = Util.Clone(recommendation.FlightGroups[1].OriginalFlightGroup.Flights[0].DepartureDateTimeValues);

        return resp;
    };

    var adaptBestPricePackage = function (response) {

        if (response && response.BestPricePackage) {

            if (response.BestPricePackage.Hotels &&
                response.BestPricePackage.Hotels.hasCount()) {
                var bestPriceSelectedRooms = response.BestPricePackage.Hotels[0].Rooms;
                var hotel = _functions.prepare.prepareHotel(response.BestPricePackage.Hotels[0]);
                hotel.Rooms = bestPriceSelectedRooms;
                for (var r = 0; r < bestPriceSelectedRooms.length; r++) {
                    var allRooms = [];
                    hotel.RoomsGroups.foreach(function (rg) { return allRooms.addRange(rg.Rooms); })
                    bestPriceSelectedRooms[r] = allRooms.first(function (ro) { return ro.Id == bestPriceSelectedRooms[r].Id; });
                }

                response.BestPricePackage.Hotels[0] = hotel;
            }

            if (response.BestPricePackage && response.BestPricePackage.Recommendation) {
                adaptRecommendation(response.BestPricePackage);

                var recommendationFromList = response.Recommendations.first(
                    function (r) {
                        return r.Index == response.BestPricePackage.Recommendation.Index
                    }
                );

                if (Util.HasCount(recommendationFromList.FlightGroups)) {
                    var priceGroups = response.PriceGroups.where(function (pg) { return pg.CityPairs.length == recommendationFromList.FlightGroups.length; });

                    if (Util.HasCount(priceGroups)) {
                        priceGroups = priceGroups.where(function (pg) {
                            var isAllFlightGroupsReferenceHasRecommendationIndex = false;

                            for (i = 0; i < pg.CityPairs.length; i++) {
                                var cityPair = pg.CityPairs[i];

                                isAllFlightGroupsReferenceHasRecommendationIndex = cityPair.FlightGroupsReference.any(
                                    function (fgr) {
                                        return fgr.RecommendationIndexes.indexOf(recommendationFromList.Id) > -1
                                    }
                                );

                                if (!isAllFlightGroupsReferenceHasRecommendationIndex) {
                                    break;
                                }
                            }

                            return isAllFlightGroupsReferenceHasRecommendationIndex;
                        });

                        if (Util.HasCount(priceGroups)) {
                            if (priceGroups.all(function (pg) { return pg.Points > 0; }))
                                response.BestPricePackage.PriceGroup = priceGroups.getItemByMin(function (pg) { return pg.Points });
                            else
                                response.BestPricePackage.PriceGroup = priceGroups.getItemByMin(function (pg) { return pg.Price });
                        }
                    }
                }

                if (response.BestPricePackage.PriceGroup == undefined
                    && recommendationFromList.PriceGroupIndex > -1
                    && response.PriceGroups[recommendationFromList.PriceGroupIndex])
                    response.BestPricePackage.PriceGroup = response.PriceGroups[recommendationFromList.PriceGroupIndex];
            }

        }
    };

    var adaptCruiseOptions = function (response) {
        if (response && response.CruiseResponseData && typeof (CruiseExtension) != "undefined") {
            var cruiseExtension = new CruiseExtension.cruiseSearchExtension(response.CruiseResponseData, response.LocationsById);

            cruiseExtension.setCruiseOptionIndex();
            cruiseExtension.adaptCruiseOptionsLocations();
            cruiseExtension.adaptCruiseOptionsItineraryLocations();
            cruiseExtension.adaptFareOptions();
            cruiseExtension.adaptFilteredFareOptions();
            cruiseExtension.setBestPrice();
            cruiseExtension.fillCruiseGroupedData();

            if (Util.isTravelGo()) {
                response.CruiseResponseData.CruiseOptions.forEach(function (o) {
                    CruiseExtension.cruiseUtil.fillCruiseOptionBestPriceInformations(o);
                });
            }


            response.CruiseResponseData = cruiseExtension.get();
        }
    }

    var adaptRecommendations = function (response) {
        if (response) {
            if (response.Recommendations)
                for (var i = 0; i < response.Recommendations.length; i++) {
                    response.Recommendations[i]["RecommendationIndex"] = response.Recommendations[i].Index = i;
                    adaptRecommendation(response, response.Recommendations[i]);
                }
            if (response.BestPricePackage)
                adaptRecommendation(response, response.BestPricePackage.Recommendation);

            if (response.BestPricePackage)
                adaptRecommendation(response, response.BestPricePackage.ShortestFlightPackage);
        }
    };

    var adaptRecommendation = function (response, recommendation) {
        if (recommendation) {

            if (recommendation.B2BExtension)
                recommendation.Points = recommendation.B2BExtension.PointsValue;

            for (var k = 0; k < recommendation.FlightGroups.length; k++) {
                var rfg = recommendation.FlightGroups[k];

                if (response.FlightGroups)
                    rfg.OriginalFlightGroup = response.FlightGroups[rfg.FlightGroupIndex];
            }
        }
    };

    var adaptPriceGroups = function (response) {

        var recommendations = response.Recommendations;

        if (recommendations && recommendations.length) {

            response.PriceGroups = [];

            for (var pg = 0; pg < auxPriceGroupsResponse.length; pg++) {
                var priceGroup = auxPriceGroupsResponse[pg];

                for (var cp = 0, cpLen = priceGroup.CityPairs.length; cp < cpLen; cp++) {

                    var cityPair = priceGroup.CityPairs[cp];

                    cityPair.FlightGroups = [];

                    for (var fgr = 0, frgLen = cityPair.FlightGroupsReference.length; fgr < frgLen; fgr++) {
                        var flighGroupReference = cityPair.FlightGroupsReference[fgr];

                        for (var index = 0; index < flighGroupReference.RecommendationIndexes.length; index++) {
                            var recIndex = flighGroupReference.RecommendationIndexes[index];

                            if (recommendations[recIndex])
                                recommendations[recIndex].PriceGroupIndex = priceGroup.InterfaceIndex;
                        }

                        var recommendation = recommendations[flighGroupReference.RecommendationIndexes[0]];

                        if (recommendation) {

                            if (recommendation.Currency)
                                priceGroup.Currency = recommendation.Currency;

                            if (recommendation.PaymentOptions && recommendation.PaymentOptions.length)
                                priceGroup.PaymentOptions = recommendation.PaymentOptions;

                            var bestCombinationFlightGroup = recommendation.FlightGroups[flighGroupReference.FlightGroupIndex];
                            var originalFG = bestCombinationFlightGroup.OriginalFlightGroup;

                            if (!originalFG.RecommendationIndexes)
                                originalFG.RecommendationIndexes = [];

                            originalFG.RecommendationIndexes = originalFG.RecommendationIndexes.concat(flighGroupReference.RecommendationIndexes).distinct();

                            cityPair.FlightGroups.push(originalFG);
                        }
                    }
                }

                response.PriceGroups.push(priceGroup);
            }
        }
    };

    var getTotalGuests = function (hotels) {
        return hotels ? (hotels.length > 0 ? hotels[0].TotalGuests : 1) : 1;
    };

    var getRequestDataFlexibleSearch = function (response) {

        var requestData = {};

        if (response.Air
            && response.Air.Destinations
            && response.Air.Destinations.length) {

            requestData.Culture = Global.Culture;

            requestData.Origin = response.Air.Destinations[0].Origin;
            requestData.Destinations = [response.Air.Destinations[0].Destination];
            requestData.StartDate = response.Air.Destinations[0].OutboundDate;
            requestData.EndDate = response.Air.Destinations[0].InboundDate;
            requestData.OutboundDays = response.OutboundDays || 7;
            requestData.InboundDays = response.InboundDays || 6;
            requestData.TripType = response.Air.IsRoundTrip ? EnumHelper.AirSearch.TypeTrip.RoundTrip : EnumHelper.AirSearch.TypeTrip.OneWay;
        }

        return requestData;
    };

    var getRequestData = function (searchParameters) {

        var requestData = {};
        requestData.SearchData = {};
        requestData.SearchData.Sources = [];
        requestData.SearchData.HotelSearchData = null;
        requestData.SearchData.AirSearchData = null;
        requestData.SearchData.BusSearchData = null;
        requestData.SearchData.TicketsSearchData = null;
        requestData.SearchData.ServicesSearchData = null;
        requestData.SearchData.CarSearchData = null;
        requestData.SearchData.PackageSearchData = null;
        requestData.SearchData.CruiseSearchData = null;
        requestData.SearchData.InsuranceSearchData = null;
        requestData.SearchData.ItinerarySearchData = null;

        requestData.AffiliatedId = Global.AffiliatedId;

        requestData.Culture = Global.Culture;

        requestData.SearchData.SearchMode = typeof (searchParameters.SearchMode) != 'undefined' ? searchParameters.SearchMode : Global.SearchMode;
        requestData.SearchData.SearchStaticPkgs = searchParameters.SearchStaticPkgs;
        requestData.SearchData.SearchDynamicPkgs = searchParameters.SearchDynamicPkgs;

        requestData.AdditionalInfo = [{ Key: 'SearchForPackageComposition', Value: searchParameters && searchParameters.SearchForPackageComposition ? searchParameters.SearchForPackageComposition.toString() : "false" }];

        if (searchParameters.AdditionalInfo && searchParameters.AdditionalInfo.AllowSearchBlockedDate)
            requestData.AdditionalInfo.push({ Key: 'AllowSearchBlockedDate', Value: searchParameters.AdditionalInfo.AllowSearchBlockedDate });

        if (searchParameters.AdditionalInfo && searchParameters.AdditionalInfo.RoomSharingCode)
            requestData.AdditionalInfo.push({ Key: 'RoomSharingCode', Value: searchParameters.AdditionalInfo.RoomSharingCode });

        if (Global.AffiliatedId != undefined && Global.AffiliatedId != 0 && Global.AffiliatedId != null)
            requestData.AffiliatedId = Global.AffiliatedId;

        if (searchParameters.Air) {
            requestData.SearchData.AirSearchData = searchParameters.Air.RequestData;
            requestData.SearchData.AirSearchData.SearchType = searchParameters.Air.SearchType;
            requestData.SearchData.AirSearchData.BaggageFilter = searchParameters.Air.BaggageFilter;

            if (searchParameters.Air.Sources && searchParameters.Air.Sources.length)
                requestData.SearchData.Sources.addRange(searchParameters.Air.Sources);
        }

        if (searchParameters.Hotel) {
            requestData.SearchData.HotelSearchData = searchParameters.Hotel.RequestData;

            if (requestData.SearchData.HotelSearchData.Sources) {
                requestData.SearchData.Sources.addRange(requestData.SearchData.HotelSearchData.Sources);
            }
        }

        if (searchParameters.Insurance) {
            requestData.SearchData.InsuranceSearchData = searchParameters.Insurance.RequestData;
        }

        if (searchParameters.Tickets) {
            requestData.SearchData.TicketsSearchData = {};
            requestData.SearchData.TicketsSearchData.LocationId = searchParameters.Tickets.city;
            requestData.SearchData.TicketsSearchData.EndDate = searchParameters.Tickets.endDate;
            requestData.SearchData.TicketsSearchData.StartDate = searchParameters.Tickets.startDate;
            requestData.SearchData.TicketsSearchData.EventCategory = searchParameters.Tickets.Category;
            requestData.SearchData.TicketsSearchData.EventName = searchParameters.Tickets.Name;
        }

        if (searchParameters.Service)
            requestData.SearchData.ServicesSearchData = searchParameters.Service;

        if (searchParameters.Car)
            requestData.SearchData.CarSearchData = searchParameters.Car;

        if (searchParameters.Package)
            requestData.SearchData.PackageSearchData = searchParameters.Package;

        if (searchParameters.Cruise)
            requestData.SearchData.CruiseSearchData = searchParameters.Cruise;

        if (searchParameters.Itinerary) {
            requestData.SearchData.ItinerarySearchData = searchParameters.Itinerary;
            requestData.SearchData.ItinerarySearchData.Location = "";
        }

        if (searchParameters.Bus)
            requestData.SearchData.BusSearchData = searchParameters.Bus;
        
        requestData.SearchData.RelatedItineraryName = searchParameters.RelatedItineraryName;
        requestData.SearchData.RelatedItineraryCurrencyCode = searchParameters.RelatedItineraryCurrencyCode;

        searchData = requestData.SearchData;

        return requestData;
    };

    var getCityPairsRequest = function (searchParameters) {

        var cityPairs = [];

        var localCiaCodeList = [];

        for (var i = 0; i < searchParameters.CiaCodeList.length; i++) {
            if (searchParameters.CiaCodeList[i] != undefined && searchParameters.CiaCodeList[i] != "") {
                if (searchParameters.CiaCodeList[i].length >= 2)
                    localCiaCodeList.push(searchParameters.CiaCodeList[i]);
            }
        }

        var cityPair = {
            CiaCodeList: localCiaCodeList,
            NonStop: searchParameters.NonStop
        }

        var origin = Util.GetShortIATA(searchParameters.Origin);
        cityPair.Origin = origin == "" ? searchParameters.Origin : origin;

        var destination = Util.GetShortIATA(searchParameters.Destination);
        cityPair.Destination = destination == "" ? searchParameters.Destination : destination;

        cityPair.DepartureYear = searchParameters.Dates[0].Year;
        cityPair.DepartureMonth = searchParameters.Dates[0].Month;
        cityPair.DepartureDay = searchParameters.Dates[0].Day;

        cityPair.StartTime = Util.GetTreatyTime(searchParameters.StartTimeOut, "START");
        cityPair.EndTime = Util.GetTreatyTime(searchParameters.EndTimeOut, "END");

        cityPairs.push(cityPair);

        if (searchParameters.IsRoundTrip) {

            var cityPairRoundTrip = {
                CiaCodeList: localCiaCodeList,
                NonStop: searchParameters.NonStop
            }

            /* O destino passa a ser a origem */
            var origin = Util.GetShortIATA(searchParameters.Destination);
            cityPairRoundTrip.Origin = origin == "" ? searchParameters.Destination : origin;

            var destination = Util.GetShortIATA(searchParameters.Origin);
            cityPairRoundTrip.Destination = destination == "" ? searchParameters.Origin : destination;

            cityPairRoundTrip.DepartureYear = searchParameters.Dates[1].Year;
            cityPairRoundTrip.DepartureMonth = searchParameters.Dates[1].Month;
            cityPairRoundTrip.DepartureDay = searchParameters.Dates[1].Day;

            cityPairRoundTrip.StartTime = Util.GetTreatyTime(searchParameters.StartTimeIn, "START");
            cityPairRoundTrip.EndTime = Util.GetTreatyTime(searchParameters.EndTimeIn, "END");

            cityPairs.push(cityPairRoundTrip);
        }

        return cityPairs;
    }

    var validateCompletedResponse = function (response) {

        var thisErrors = [];

        var searchParameters = controller.lastSearchParameters;
        var noAirResults = true;

        if (withoutSuggestions)
            response.SuggestLocations = [];

        if (searchParameters.Air && searchParameters.Hotel) {
            if (thisErrors.length || (!response.BestPricePackage && (Global.ConsiderBestPrice == undefined || Global.ConsiderBestPrice))) {
                if (response.InvalidLocation) {
                    if (!response.RelativeLocations.length && !response.SuggestLocations.length)
                        thisErrors.push(["OnSearch_InvalidOriginOrDestination"]);
                }

                if (!response.InvalidLocation) {
                    if ((!response.PriceGroups || !response.PriceGroups.length) && !response.Recommendations)
                        thisErrors = [["OnSearch_PriceGroupsNotFound", searchParameters.Air.Destinations[0].Destination]];
                    else if (!response.Hotels || !response.Hotels.length)
                        thisErrors = [["OnSearch_HotelsNotFound", searchParameters.Hotel.Location]];

                    if (response.Packages && response.Packages.length) {
                        if (!response.Recommendations || !response.Recommendations.length)
                            thisErrors = [["OnSearch_PriceGroupsNotFound", searchParameters.Air.Destinations[0].Destination]];
                        else if (!response.Hotels || !response.Hotels.length)
                            thisErrors = [["OnSearch_HotelsNotFound", searchParameters.Hotel.Location]];
                    }
                }

                data.HotelFiltersData = {};
                data.BestPricePackage = null;
                data.ShortestFlightPackage = null;
                data.AirFiltersData = {};
                data.Hotels = [];
                data.PriceGroups = [];
                data.Packages = [];
            }
        }
        else if (searchParameters.Air) {
            if (response.InvalidLocation) {
                if (!response.RelativeLocations.length && !response.SuggestLocations.length)
                    thisErrors.push(["OnSearch_InvalidOriginOrDestination"]);
            }
            else {
                if (response.PriceGroups && response.PriceGroups.length)
                    noAirResults = false;

                if (response.CityPairs && response.CityPairs.length) {
                    if (response.CityPairs[0].FlightGroups && response.CityPairs[0].FlightGroups.length)
                        noAirResults = false;

                }

                if (response.Recommendations && response.Recommendations.length)
                    noAirResults = false;

                if (noAirResults) {
                    var destination;
                    if (searchParameters.Air.Destination)
                        destination = searchParameters.Air.Destination;
                    else if (searchParameters.Air.Destinations)
                        destination = searchParameters.Air.Destinations[0].Destination;

                    thisErrors.push(["OnSearch_PriceGroupsNotFound", destination]);
                }
            }
        }
        else if (searchParameters.Hotel) {
            if (response.InvalidLocation) {
                if (!response.RelativeLocations.length && !response.SuggestLocations.length && !thisErrors.length) {
                    thisErrors.push(["OnSearch_HotelsNotFound", searchParameters.Hotel.Location]);
                }
            }
            else if (!response.Hotels || !response.Hotels.length) {
                thisErrors.push(["OnSearch_HotelsNotFound", searchParameters.Hotel.Location]);
            }
        }
        else if (searchParameters.Car) {
            if (!response.CarResponseData)
                thisErrors.push(["OnSearchCar_NoResults"]);
        }
        else if (searchParameters.Service && (!response.ServicesResponseData || !response.ServicesResponseData.Services || !response.ServicesResponseData.Services.length)) {
            if (searchParameters.AdditionalInfo.hasOwnProperty("ServiceDestination"))
                thisErrors.push(["OnSearch_EventsNotFound", searchParameters.AdditionalInfo.ServiceDestination.d]);
            else
                thisErrors.push(["OnSearch_ServicesNotFound", ""]);
        }
        else if (searchParameters.Package && (!response.PackageResponseData || !response.PackageResponseData.Packages || !response.PackageResponseData.Packages.length)) {
            thisErrors.push(["OnSearch_PackagesNotFound", ""]);
        }
        else if (searchParameters.Bus && (!response.BusResponseData || !response.BusResponseData.BusStationPairs || !response.BusResponseData.BusStationPairs.length)) {
            thisErrors.push(["OnSearch_BusesNotFound", ""]);
        }

        if (thisErrors.length)
            if (data.Errors && data.Errors.length)
                data.Errors = data.Errors.concat(thisErrors);
            else
                data.Errors = thisErrors;
    }

    this.getCombinablesFlightGroups = function (pricegroup, flightgroup) {

        var combinableFlightGroups = [];

        if (pricegroup && pricegroup.CityPairs && pricegroup.CityPairs.length > 0) {

            var cityPairs = pricegroup.CityPairs;

            var cityPairIndex = getCityPairIndexInPriceGroupByFlightGroup(pricegroup, flightgroup);

            for (var i = 0; i < cityPairs.length; i++) {

                if (i != cityPairIndex) {
                    for (var n = 0; n < cityPairs[i].FlightGroups.length; n++) {
                        combinableFlightGroups.push(cityPairs[i].FlightGroups[n]);
                    }
                }
            }
        }
        return combinableFlightGroups;
    };

    var flightFilterByHotel = function (hotel) {

        var searchParameters = controller.lastSearchParameters;

        if (searchParameters.Hotel && !searchParameters.Hotel.AnotherDate && hotel) {

            var thisHotel = data.Hotels.first(function (h) { return h.Id == hotel.Id; });

            if (thisHotel) {

                var checkinHotelDates = [];

                //ObtÃ©m todas as datas de checkin de um hotel.
                thisHotel.RoomsGroups.forEach(function (rg) {
                    rg.Rooms.forEach(function (r) {
                        r.StayOptions.forEach(function (s) {
                            checkinHotelDates.push(Util.DateValuesToDate(s.CheckInValues));
                        });
                    });
                });

                var condition = function (fg) {

                    var arrivalFlightDate = Util.DateValuesToDate(fg.LastArrivalTimeValues);

                    return checkinHotelDates.any(function (checkInDate) {
                        return (arrivalFlightDate >= checkInDate) && (arrivalFlightDate < checkInDate.addDays(1));
                    });
                }

                //Filtra os voos pelas datas de checkin do hotel.
                data.PriceGroups = data.PriceGroups.where(function (pg) { return pg.CityPairs.length && pg.CityPairs[0].FlightGroups.length && pg.CityPairs[0].FlightGroups.any(condition); });

                function auxFunc(rec) { return condition(rec.FlightGroups && rec.FlightGroups.length && rec.FlightGroups[0].OriginalFlightGroup) || _isStaticRecommendation(rec); };

                data.Recommendations = data.Recommendations.where(auxFunc);
                data.auxRecommendations = data.auxRecommendations.where(auxFunc);
            }
        }
    };

    var getStaticPackageHotel = function (hotel) {

        return auxPackagesResponse ? auxPackagesResponse.where(function (pkg) {

            return pkg.Hotels ? pkg.Hotels.any(function (h) {

                return h.Id == hotel.Id;

            }) : false;

        }).first() : undefined;

    };

    var applyValueToPriceGroups = function (hotel) {

        if (hotel) {
            data.PriceGroups = [];
            var valueToAdd = hotel.TotalAmount;

            for (var pg = 0; pg < auxPriceGroupsResponse.length; pg++) {

                var priceGroup = auxPriceGroupsResponse[pg];

                if (priceGroup.OriginalValues == undefined) {
                    priceGroup.OriginalValues = {};
                    priceGroup.OriginalValues.Price = priceGroup.Price;
                }

                if (priceGroup.CityPairs.all(function (c) { return c.FlightGroups.length; })) {

                    priceGroup.Price = priceGroup.OriginalValues.Price + valueToAdd;

                    data.PriceGroups.push(priceGroup);
                }
            }
        }
    };

    var applyValueToRecommendations = function (hotel) {
        if (hotel) {

            var valueToAdd = hotel.TotalAmount * hotel.TotalGuests;

            var recommendations = [];
            for (var pg = 0; pg < data.auxRecommendations.length; pg++) {

                var recommendation = data.auxRecommendations[pg];

                if (recommendation.OriginalValues == undefined) {
                    recommendation.OriginalValues = {};
                    recommendation.OriginalValues.Price = recommendation.DisplayTotalAmount;
                }

                if (recommendation.FlightGroups && recommendation.FlightGroups.length && recommendation.FlightGroups.all(function (f) { return f.OriginalFlightGroup; })) {

                    var airCVCTotalGuests = SharedFunctions.GetCVCAirCVCTotalGuests(hotel);


                    recommendation.DisplayTotalAmount = (recommendation.MarkupedTotalAmount * airCVCTotalGuests) + valueToAdd;

                    recommendations.push(recommendation);
                }
            }

            data.auxRecommendations = recommendations;
        }
    };

    function getCityPairIndexInPriceGroupByFlightGroup(pricegroup, flightgroup) {

        var cityPairIndex = undefined;

        if (pricegroup && pricegroup.CityPairs && pricegroup.CityPairs.length > 0) {

            var cityPairs = pricegroup.CityPairs;

            for (var i = 0; i < cityPairs.length; i++) {

                if (cityPairs[i].FlightGroups.any(function (fg) { return fg.Hash == flightgroup.Hash; })) {
                    cityPairIndex = i;
                    break;
                }
            }
        }

        return cityPairIndex;
    };

    //#endregion

    //#region Getters

    var getRecommendation = function (newPackage) {

        if (!newPackage.Recommendation)
            return null;

        if (!newPackage.Recommendation.FlightGroups)
            return null;

        if (!newPackage.Recommendation.FlightGroups.length)
            return null;

        var recommendation = undefined;
        var recommendations = data.Recommendations;
        var flightGroups = newPackage.Recommendation.FlightGroups;
        var indexes1 = flightGroups[0].RecommendationIndexes;

        if (!indexes1)
            recommendation = newPackage.Recommendation;
        else {
            var indexes2 = undefined;

            if (flightGroups && flightGroups.length > 1) {
                indexes2 = flightGroups[1].RecommendationIndexes;

                for (var i1 = 0; i1 < indexes1.length; i1++) {
                    if (indexes2.any(function (i2) { return i2 == indexes1[i1]; })) {
                        recommendation = recommendations[indexes1[i1]];
                        if (recommendation && typeof recommendation.PriceGroupIndex != 'undefined')
                            changePackageRecommendationIndex = recommendation.PriceGroupIndex;
                        break;
                    }
                }
            }
            else {
                recommendation = recommendations[indexes1[0]];
            }
        }

        return recommendation;
    };

    this.getRecommendationByFlightGroupHashes = function (flightGroupHashes) {

        var flightGroups = {};
        var stringAllFlightGroupHashes = "";
        for (var i = 0; i < flightGroupHashes.length; i++)
            stringAllFlightGroupHashes += flightGroupHashes[i];

        for (var j = 0; j < data.Recommendations.length; j++) {
            var hashFlightGroupsRecomendation = "";
            for (var i = 0; i < data.Recommendations[j].FlightGroups.length; i++)
                hashFlightGroupsRecomendation += data.Recommendations[j].FlightGroups[i].OriginalFlightGroup.Hash;

            if (hashFlightGroupsRecomendation == stringAllFlightGroupHashes)
                return data.Recommendations[j];
        }
        return null;
    };

    this.getRecommendationByIndex = function (index) {
        return data.Recommendations.first(function (rec) { return rec.Index == index; });
    };

    this.getBrandedFareByIndex = function (recommendation, index) {
        if (index)
            return recommendation.BrandedFares[index];
        else
            return recommendation.BrandedFares[0];
    };

    this.getAdditionalInfo = function (flightGroupIndex, sourceType) {
        var additionalInfo = {};
        var searchRecommendations = data.Recommendations;

        if (searchRecommendations && searchRecommendations.length && typeof (flightGroupIndex) != 'undefined') {
            var brandedFares = searchRecommendations.selectMany(function (r) {
                return r.BrandedFares;
            });

            var values = brandedFares.select(function (b) {
                return b.TotalAmount;
            }).where(function (r) { return r > 0; });

            additionalInfo.MinFare = values.min();
            additionalInfo.MaxFare = values.max();
        }

        return additionalInfo;
    };

    this.getRecommendationByRecommendationIndex = function (index) {
        return data.Recommendations.first(function (rec) { return rec.RecommendationIndex == index; });
    };

    this.getSessionId = function () {
        return data.SessionId;
    };

    this.getPriceGroups = function () {

        var resp = [];
        var response = thisModel.getOrderlyData();
        if (response.PriceGroups) {

            var condition = function (priceGroup) {
                return priceGroup.CityPairs.length && priceGroup.CityPairs.all(function (cp) { return cp.FlightGroups.length; });
            };

            resp = response.PriceGroups.where(condition);
        }

        return resp;
    };

    this.getOrderlyData = function () {
        if (!orderlyData)
            orderlyData = thisModel.getData();

        //Para minimizar o uso do Clone dentro dos filtros de pesquisa.  
        //Para pacotes, em alguns casos com muitos resultados, o clone causa erro de estouro de memÃ³ria.
        if (orderlyData && orderlyData.InsuranceResponseData && orderlyData.InsuranceResponseData.Insurances) {
            if (!_originalInsurances)
                _originalInsurances = Util.CloneStringify(orderlyData.InsuranceResponseData.Insurances);
            else {
                orderlyData.InsuranceResponseData.Insurances = Util.CloneStringify(_originalInsurances);
                orderlyData.Insurances = orderlyData.InsuranceResponseData.Insurances;
            }
        }

        return orderlyData;
    };

    this.getData = function () {
        return data;
    };

    this.getSearchSummary = function () {
        return data.SearchSummary ? data.SearchSummary : {};
    };

    this.getFilteredData = function () {
        if (filteredData)
            return filteredData;

        return thisModel.getData();
    };

    this.getSearchData = function () {
        return searchData || {};
    };

    this.setCruiseSearchData = function (cruiseSearchData) {
        if (searchData && searchData.CruiseSearchData)
            searchData.CruiseSearchData = cruiseSearchData;
    };

    this.getCityPairs = function () {
        return data.CityPairs ? data.CityPairs : [];
    };

    this.getPackages = function () {
        return data.Packages ? data.Packages : [];
    };

    this.getSelectedFareOption = function (cityPair, flightGroupIndex, fareOptionIndex) {
        return cityPair.flightGroups[flightGroupIndex].FareOptions[fareOptionIndex];
    }

    this.getCityPairByFlightGroupsIndex = function (index) {
        return data.CityPairs.first(function (cp) { return cp.FlightGroups.first(function (fg) { return fg.Index == index; }); });
    };

    this.getCityPairFlightGroupByFlightGroupIndex = function (index) {

        var flightGroup = undefined;
        var cityPair = undefined;
        var newCityPair = undefined;
        var found = false;

        var cityPairs = thisModel.getCityPairs();

        for (var i = 0; i < cityPairs.length; i++) {
            for (var j = 0; j < cityPairs[i].FlightGroups.length; j++) {
                if (cityPairs[i].FlightGroups[j].Index == index) {
                    flightGroup = cityPairs[i].FlightGroups[j];
                    cityPair = cityPairs[i];
                    found = true;
                    break;
                }
            }

            if (found)
                break;
        }

        if (cityPair) {
            var newCityPair = {
                DateRequested: cityPair.DateRequested,
                Destination: cityPair.Destination,
                FlightGroups: [flightGroup],
                International: cityPair.International,
                Origin: cityPair.Origin
            };
        }
        return newCityPair;
    };

    this.getFlightGroupCityPairByFlightGroupIndex = function (index) {
        var cp = thisModel.getCityPairFlightGroupByFlightGroupIndex(index);

        if (cp != undefined && cp.FlightGroups != undefined)
            return cp.FlightGroups[0];
        else
            return undefined;
    };

    this.getHotels = function () {
        return data.Hotels ? data.Hotels : [];
    };

    this.getEvents = function () {
        return concatEventData ? concatEventData : [];
    };

    this.getFilteredEvents = function () {
        return data.FilteredEvents ? data.FilteredEvents : (data.Events ? data.Events : []);
    };

    this.getHotel = function (id, summary) {

        var hotel = undefined;

        if (!id && data && data.Hotel) {
            hotel = data.Hotel;
        }
        else if (auxHotelSearchResponse[id] && auxHotelSearchResponse[id][0]) {
            hotel = auxHotelSearchResponse[id][0];
        }
        else {
            hotel = data.Hotels.first(function (h) { return h.Id == id; });
        }

        if ((!hotel || summary) && auxHotelsPointsResponse && auxHotelsPointsResponse.length > 0) {
            hotel = auxHotelsPointsResponse.first(function (h) { return h.Id == id; });
        }

        return hotel;
    };

    this.getInsurance = function (id) {
        return _functions.insurance.getInsuranceById(id);
    }

    this.getInsuranceByIndex = function (index) {
        return _functions.insurance.getInsuranceByArrayIndex(index);
    }

    this.getPackage = function (packageId) {
        var package = !packageId ? data && data.Packages[0] ? data.Packages[0] : undefined : data.Packages.first(function (p) { return p.Id == packageId });
        return package;
    };

    this.getPackageByIndex = function (packageIndex, dontCloneTheObject) {
        var package = packageIndex == undefined ? data && data.Packages[0] ? data.Packages[0] : undefined : data.Packages.first(function (p) { return p.Index == packageIndex });
        return dontCloneTheObject ? package : Util.Clone(package);
    };

    this.getEventById = function (eventId) {
        var event = !eventId ? concatEventData && concatEventData[0] ? concatEventData[0] : undefined : concatEventData.first(function (e) { return e.Id == parseInt(eventId); });

        var cloned = Util.Clone(event);
        cloned.SearchSummary = controller.lastSearchParameters.Event;
        cloned.SearchParameters = controller.lastSearchParameters;

        return cloned;

    }

    this.getHotelReferenced = function (id) {

        var hotel = undefined;

        if (!id) {
            if (data && data.Hotel)
                hotel = data.Hotel
        }
        else {
            hotel = auxHotelSearchResponse && auxHotelSearchResponse[id] && auxHotelSearchResponse[id][0] ? auxHotelSearchResponse[id][0] : data && data.Hotels && data.Hotels.length > 0 ? data.Hotels.first(function (h) { return h.Id == id; }) : undefined;
        }

        return hotel;
    };

    this.getEvent = function (eventId) {
        if (data.Event)
            return data.Event;

        var event = data.Events ? data.Events.where(function (x) {
            if (x.Id == eventId)
                return x;
        })[0] : {};

        return event;
    };

    this.getFilteredHotels = function () {
        return data.FilteredHotels ? data.FilteredHotels : data.Hotels;
    };

    this.getExchangeRates = function () {
        return exchangeRates;
    }

    this.getVisibleHotels = function () {
        return visibleHotels;
    }

    this.getNonVisibleHotels = function () {
        return nonVisibleHotels;
    }

    this.getSelectedRoomsInHotel = function (hotelIndex) {
        var selectedHotel = undefined;

        if (selectedRoomsInHotel && selectedRoomsInHotel.length)
            selectedHotel = selectedRoomsInHotel.first(function (h) { return h.HotelIndex == hotelIndex; });

        return selectedHotel;
    };

    this.getAllSelectedRoomsInHotel = function () {
        return selectedRoomsInHotel;
    };

    this.getCachedAuxRecommendations = function () {
        return data ? (data.auxRecommendations || []) : {};
    }

    this.getCachedAuxPriceGroups = function () {
        return data ? (data.auxPriceGroups || []) : {};
    }

    this.getCalendarPackage = function () {
        return calendarPackage;
    }

    this.getFilteredPriceGroups = function () {
        return filteredPriceGroups;
    }

    this.getFilteredRecommendations = function () {
        return filtredRecommendations;
    }

    this.getPriceGroup = function (priceGroupIndex) {
        return data.PriceGroups.first(function (p) { return p.InterfaceIndex == priceGroupIndex; });
    }

    this.getFlightGroups = function (priceGroup, flightGroupHashs) {
        var flightGroups = [];

        var condition = function (flightGroup) {
            return flightGroupHashs.any(flightGroup.Hash);
        };

        for (var i = 0; i < priceGroup.CityPairs.length; i++) {
            flightGroups = flightGroups.concat(priceGroup.CityPairs[i].FlightGroups.where(condition));
        }

        var RecommendationIndexes = _functions.recalculateProducts.Air.getRecommendationIndexes(priceGroup, flightGroups);

        var intersectionRecommendationIndex = undefined;

        if (RecommendationIndexes.length == 1)
            intersectionRecommendationIndex = RecommendationIndexes[0];
        else
            intersectionRecommendationIndex = _functions.recalculateProducts.Air.getIntersectionRecommendationIndex(RecommendationIndexes);

        var recomendation = undefined;

        if (intersectionRecommendationIndex != undefined) {
            recomendation = data.Recommendations[intersectionRecommendationIndex];

            flightGroups = recomendation.FlightGroups.select(function (fg) { return fg.OriginalFlightGroup; });
        }
        else if (RecommendationIndexes.length == 1) {
            recomendation = data.Recommendations[RecommendationIndexes[0]];

            if (recomendation == undefined) {
                recomendation = this.discoverRecomendationSelected(flightGroups, priceGroup.BaggagesIncluded);
            }

        } else {
            recomendation = this.discoverRecomendationSelected(flightGroups, priceGroup.BaggagesIncluded);
        }

        _functions.recalculateProducts.Air.updateFlightGroups(flightGroups, recomendation, priceGroup.SelectedBrandedFare, intersectionRecommendationIndex);

        return flightGroups;
    }

    this.getFilteredPackages = function () {
        return filteredPackages;
    }

    this.getFilteredHybridPackages = function () {

        var _filteredData = this.getFilteredData();

        if (_filteredData && _filteredData.PackageResponseData)
            return _filteredData.PackageResponseData.Packages;

        return null;
    }

    this.getPackageRecommendations = function (_package, _data) {
        if (!_data)
            _data = data;

        return PackageExtensions.GetPackageRecommendations(_data.AirResponseData, _package);
    };

    this.getPackageHotels = function (_package, _data) {
        if (!_data)
            _data = data;

        return PackageExtensions.GetPackageHotels(_data.HotelResponseData, _package);
    };

    this.getPackageServices = function (_package, _data) {
        if (!_data)
            _data = data;

        return PackageExtensions.GetPackageServices(_data.ServicesResponseData, _package);
    };

    this.getMandatoryPackageServices = function (_package, _data) {
        if (!_data)
            _data = data;

        return PackageExtensions.GetMandatoryPackageServices(_data.ServicesResponseData, _package);
    };

    this.getPackageInsurances = function (_package, _data) {
        if (!_data)
            _data = data;

        return PackageExtensions.GetPackageInsurances(_data.InsuranceResponseData, _package);
    };

    this.getCarByIndex = function (index) {
        return data.CarResponseData.CarQuoteGroups[index] || {};
    };

    this.getCarCompanyByIndex = function (index) {
        return data.CarResponseData.Companies[index] || {};
    };

    this.setVisibleHotels = function (hotels) {
        visibleHotels = hotels;
    }

    this.setNonVisibleHotels = function (hotels) {
        nonVisibleHotels = hotels;
    }

    this.setFilteredPackages = function (packages) {
        filteredPackages = packages;
    }

    this.setFilteredPriceGroups = function (priceGroups) {
        filteredPriceGroups = priceGroups;
    }

    this.setFilteredRecommendations = function (recommendations) {
        filtredRecommendations = recommendations;
    }

    this.setSelectedRoomsInHotel = function (hotel) {

        if (selectedRoomsInHotel && selectedRoomsInHotel.length) {
            var selectedHotel = selectedRoomsInHotel.first(function (h) { return h.HotelIndex == hotel.Index; });

            if (selectedHotel) {
                selectedHotel.TotalAmount = hotel.TotalAmount;

                var roomIndexes = [];

                for (var j = 0; j < hotel.SeparatedRooms.length; j++) {
                    var room = hotel.SeparatedRooms[j][0];
                    roomIndexes.push({
                        RoomIndex: room.Index,
                        GroupNumber: room.GroupNumber
                    });
                }

                selectedHotel.RoomIndexes = roomIndexes;
            }
        }
    };

    this.setHotelToOtherOptionsInBudget = function (hotel, value) {
        var hotel = data.Hotels.first(function (h) { return h.Id == hotel.Id });
        hotel.IsOtherOptionToBudget = value;
    };

    this.setFlightToOtherOptionsInBudget = function (flightGroupIndex, value) {
        var flightGroup = thisModel.getFlightGroupCityPairByFlightGroupIndex(flightGroupIndex);
        flightGroup.Flights.forEach(function (flight) {
            var fareSelecteds = []
            if (flight.IsOtherOptionToBudget)
                fareSelecteds = flight.IsOtherOptionToBudget.split('|');
            if (fareSelecteds.any(function (v) { return v == value; }))
                fareSelecteds = fareSelecteds.removeAll(function (v) { return v == value; });
            else
                fareSelecteds.push(value);
            flight.IsOtherOptionToBudget = fareSelecteds.join('|');
        });
    };

    this.setRecommendationToOtherOptionsInBudget = function (recommendationIndex, brandedFareIndex, value) {
        var recommendation = thisModel.getRecommendationByIndex(recommendationIndex);
        var brandedFare = thisModel.getBrandedFareByIndex(recommendation, brandedFareIndex);

        if (brandedFare)
            brandedFare.SelectedToBudget = value;

        if (value)
            recommendation.IsOtherOptionToBudget = value;
        else
            recommendation.IsOtherOptionToBudget = recommendation.BrandedFares.any(function (b) { return b.SelectedToBudget == true });
    };

    this.getHotelsToOtherOptionsInBudget = function () {
        return data.Hotels.where(function (h) { return h.IsOtherOptionToBudget == true });
    };

    this.getFlightGroupsToOtherOptionsInBudget = function () {
        return data.CityPairs.selectMany(function (cp) { return cp.FlightGroups.where(function (fg) { return fg.Flights.any(function (f) { return f.IsOtherOptionToBudget == true }) }) });
    };

    this.getRecommendationToOtherOptionsInBudget = function () {
        return data.Recommendations.where(function (r) { return r.IsOtherOptionToBudget == true });
    };

    this.setPackage = function (newPackage) {

        if (newPackage.Hotels && newPackage.Hotels.length && newPackage.Hotels[0].HashKey) {
            newPackage.Summary.IsOnline = true;
            if (data.Packages && data.Packages.length) {
                for (var i = 0; i < data.Packages.length; i++) {

                    if (data.Packages[i].Hotels[0].HashKey == newPackage.Hotels[0].HashKey) {
                        var oldPackageIndex = data.Packages[i].Index;
                        var oldLoyalty = data.Packages[i].Loyalty;
                        data.Packages[i] = newPackage;
                        newPackage.Index = oldPackageIndex;
                        newPackage.Loyalty = oldLoyalty;
                        break;
                    }
                }

            }

            if (filteredPackages && filteredPackages.length) {
                for (var i = 0; i < filteredPackages.length; i++) {

                    if (filteredPackages[i].Hotels[0].HashKey == newPackage.Hotels[0].HashKey) {
                        var oldPackageIndex = filteredPackages[i].Index;
                        filteredPackages[i] = newPackage;
                        newPackage.Index = oldPackageIndex;
                        break;
                    }
                }

            }
        }

    }

    function _setCVCEventsData(data) {

        if (data && data.Events && data.Events.length) {
            var includeItens = data.Events[0].ExternalProperties.any(function (extProp) { return extProp.Key == "IncludeItens" && extProp.Value == "true" });

            if (includeItens) {
                concatEventData = !concatEventData ? data.Events : $.merge(concatEventData, data.Events);
            } else {
                originalEventData = data.Events;
            }
        }
    }

    this.setCalendarPackage = function (bestCalendarPackage) {

        var update = false;

        for (var i = 0; i < calendarPackage.length; i++) {
            if (calendarPackage[i].id == bestCalendarPackage.id) {
                // SÃ ESTOU ALTERANDO ESSA VARÃAVEL POÃS Ã A ÃNICA QUE PRECISA SER ALTERADA
                calendarPackage[i].isBestPrice = bestCalendarPackage.isBestPrice;
                update = true;
                break;
            }
        }

        if (!update)
            calendarPackage.push(bestCalendarPackage);
    }

    this.SetWithoutSuggestions = function (_withoutSuggestions) {
        withoutSuggestions = _withoutSuggestions;
    }

    this.updateEvent = function (event) {
        if (event && event.Id) {
            for (var i = 0, len = data.Events.length; i < len; i++) {
                if (data.Events[i].Id == event.Id) {
                    data.Events[i] = event;
                    break;
                }
            }
        }
    }

    /* Essa funÃ§Ã£o serve quando no ultimo GetSearchStatus nÃ£o vem voos nem hotÃ©is
    Porque neste caso ele nÃ£o atualiza os objetos referente aos filtros*/
    function _updateFilters(response) {
        if (data) {
            if (response.HotelFiltersData && !data.HotelFiltersData)
                data.HotelFiltersData = response.HotelFiltersData;

            if (response.AirFiltersData && !data.AirFiltersData)
                data.AirFiltersData = response.AirFiltersData;

            if (response.CityPairFiltersData && !data.CityPairFiltersData)
                data.CityPairFiltersData = response.CityPairFiltersData;

            if (response.InsuranceFiltersData && !data.InsuranceFiltersData)
                data.InsuranceFiltersData = response.InsuranceFiltersData;
        }
    }

    function _updateSearchSummary(data) {
        if (data.SearchSummary && data.SearchSummary.HotelSummary) {
            if (data.Hotels && data.Hotels.length)
                data.SearchSummary.HotelSummary.TotalHotels = data.Hotels.length;

            if (data.Packages && data.Packages.length)
                data.SearchSummary.HotelSummary.TotalPackages = data.Packages.length;
        }
    }

    this.ChangePackage = function (searchParameters, newPackage) {

        var recommendation = getRecommendation(newPackage);
        var searchData = getRequestData(searchParameters);
        var flightGroups = newPackage.Recommendation.FlightGroups.select(function (bcfg) { return bcfg.OriginalFlightGroup; });

        $.extend(true, searchData, {
            Recommendation: recommendation,
            Hotel: newPackage.Hotel,
            SearchId: data.SearchId,
            Culture: Global.Culture,
            FlightGroups: flightGroups
        });

        searchData.Events = newPackage.Events;
        searchData.AdditionalInfo = newPackage.AdditionalInfo;

        clientWS.invoke("ChangePackage", { req: { TravelEngineChangePackageRQ: searchData } }, thisModel.OnChangePackageSuccess, thisModel.onError);
    };

    this.OnChangePackageSuccess = function (response) {
        if (response) {

            if (response && response.Package && response.Package.Hotels[0]) {
                _functions.prepare.prepareHotel(response.Package.Hotels[0]);
                if (response.Package.Recommendation)
                    response.Package.Recommendation.PriceGroupIndex = changePackageRecommendationIndex;

                if (Global.updateStayOptions == undefined || Global.updateStayOptions)
                    applyValueToHotel(response.Package.Hotels[0], response.Package.Recommendation);

            }
            if (response.Errors && response.Errors.length)
                thisModel.onError(response);
            else
                controller.onChangePackageCompleted(response);
        }
    };

    this.discoverRecomendationSelected = function (flightGroups, baggagesIncluded) {
        var todosRecomendationIndexes = [];

        //Descobrir qual recomendation utilizar do flightGroup selecionado no PriceGroup
        for (var flightGroupIndex = 0; flightGroupIndex < flightGroups.length; flightGroupIndex++) {
            var flightGroup = flightGroups[flightGroupIndex];

            for (var recomendationIndex = 0; recomendationIndex < flightGroup.RecommendationIndexes.length; recomendationIndex++) {
                var realRecommendationIndex = flightGroup.RecommendationIndexes[recomendationIndex];
                var alreadyInsertedOnTodosRecommendationIndexes = todosRecomendationIndexes.length > 0 && todosRecomendationIndexes.any(function (i) { return i.RecommendationIndex == realRecommendationIndex; });

                // Se o Ã­ndice da recommendation jÃ¡ existir na relaÃ§Ã£o de recommendations selecionadas, incrementa o seu Hit
                if (alreadyInsertedOnTodosRecommendationIndexes) {
                    todosRecomendationIndexes.first(function (r) { return r.RecommendationIndex == realRecommendationIndex; }).Hits += 1;
                } else {
                    // Valida se a recommendation existe e se o nÃºmero de bagagens bate com o PriceGroup
                    var recommendation = data.Recommendations[realRecommendationIndex];
                    var hasRecommendation = data.Recommendations[realRecommendationIndex] != undefined;
                    var matchBaggageCount = hasRecommendation && (baggagesIncluded == undefined || recommendation.BrandedFares.any(function (b) { return b.BaggagesIncluded == baggagesIncluded; }));

                    //E insere na relaÃ§Ã£o de recommendations encontradas
                    if (matchBaggageCount) {
                        todosRecomendationIndexes.push({
                            RecommendationIndex: realRecommendationIndex
                            , Hits: 1
                        });
                    }
                }
            }
        }

        //O recomendation que aparecer mais, serÃ¡ o escolhido
        var recomendationChoosed = todosRecomendationIndexes.orderByDescending(function (rec) { return rec.Hits; })[0];

        if (recomendationChoosed)
            return data.Recommendations[recomendationChoosed.RecommendationIndex];

        return null;
    }

    this.clearCalendarPackage = function () {
        calendarPackage = [];
    }

    function _separateSuggestionPackages(data) {
        if (data.Packages && data.Packages.length) {
            data.PackagesSuggested = data.Packages.where(function (pac) { return pac.Summary.IsSuggestion == true; });
            data.Packages = data.Packages.where(function (pac) { return pac.Summary.IsSuggestion == false; });
        }
    }

    function _isStaticRecommendation(recomendation) {
        var objExternalProperties = recomendation.ExternalProperties;

        if (objExternalProperties && objExternalProperties.length) {

            for (var i = 0; i < objExternalProperties.length; i++) {
                var actualExternalProperties = objExternalProperties[i];

                if (actualExternalProperties.Key == "staticRecommendation") {
                    if (actualExternalProperties.Value.toLowerCase() == "true") {
                        return true;
                    }
                }
            }
        }

        return false;
    }

    function _createPackageFilterData(data) {
        if (data && data.AirFiltersData && data.HotelFiltersData) {
            data.PackageFiltesData = {};
            data.PackageFiltesData.Air = data.AirFiltersData;
            data.PackageFiltesData.Hotel = data.HotelFiltersData;

            if (data.Hotels && data.Hotels.length > 1)
                data.PackageFiltesData.TotalGuests = SharedFunctions.GetCVCAirCVCTotalGuests(data.Hotels[0]);
            else
                data.PackageFiltesData.TotalGuests = 1;

            data.PackageFiltesData.MinPrice = 0;
            data.PackageFiltesData.MaxPrice = 99999;

            if (data.Packages && data.Packages.length > 0) {
                data.PackageFiltesData.MinPrice = data.Packages.min(function (pck) { return pck.Summary.TotalAmount });
                data.PackageFiltesData.MaxPrice = data.Packages.max(function (pck) { return pck.Summary.TotalAmount });
            }

        }
    }

    function _createSelectedRoomsInHotel(data) {
        if (data && data.Hotels) {
            for (var i = 0; i < data.Hotels.length; i++) {
                var hotel = data.Hotels[i];

                var selectedRoom = {
                    HotelIndex: hotel.Index,
                    RoomIndexes: [],
                    TotalAmount: hotel.TotalAmount
                };

                for (var j = 0; j < hotel.SeparatedRooms.length; j++) {
                    var room = hotel.SeparatedRooms[j][0];
                    selectedRoom.RoomIndexes.push({
                        RoomIndex: room.Index,
                        GroupNumber: room.GroupNumber
                    });
                }

                selectedRoomsInHotel.push(selectedRoom);
            }
        }
    }

    this.getRecommendations = function () {
        return data.Recommendations;
    };

    this.Filter = function (filterData, filterType, aux, render) {
        if (!filteredData)
            filteredData = {};

        if (filterData.AirFiltersData)
            _airFilter(filterData.AirFiltersData, filterType);
        else if (filterData.BusFiltersData)
            _busFilter(filterData.BusFiltersData);
        else if (filterData.HotelFiltersData)
            _hotelFilter(filterData.HotelFiltersData, data);
        else if (filterData.CityPairFiltersData)
            _cityPairFilter(filterData.CityPairFiltersData, aux);
        else if (filterData.CarFilterData)
            _carFilter(filterData.CarFilterData);
        else if (filterData.ServiceFilterData)
            _serviceFilter(filterData.ServiceFilterData);
        else if (filterData.PackageFilterData)
            _packageFilter(filterData.PackageFilterData);
        else if (filterData.CruiseFiltersData)
            _cruiseFilter(filterData.CruiseFiltersData);
        else if (filterData.InsuranceFiltersData)
            _functions.filter.Insurance(filterData.InsuranceFiltersData);

        if (filteredData.CityPairs && filteredData.CityPairs.length)
            filteredData.FlightGroups = filteredData.CityPairs.selectMany(function (cp) { return filteredData.CityPairs[0].FlightGroups });

        if (orderlyData)
            filteredData.SearchData = orderlyData.SearchData;

        if (typeof (render) == "undefined" || render)
            controller.onFilterCompleted(filteredData);
    };

    this.ResetFilter = function () {
        filteredData = undefined;

        _resetPackageFilters();

        controller.onFilterCompleted(data);
    };

    function _cityPairFilter(filterData, index) {
        filteredData.SearchSummary = data.SearchSummary;
        filteredData.Errors = data.Errors;
        filteredData.CityPairFiltersData = data.CityPairFiltersData;
        filteredData.Index = index;
        filteredData.CityPairs = _cityPairsFilter(filterData, index);

        if (filterData.BaggagesOptions)
            filteredData.BaggagesOptionsFilter = filterData.BaggagesOptions;
    }

    function _airFilter(filterData, filterType) {
        filteredData.SearchSummary = data.SearchSummary;
        filteredData.Errors = data.Errors;
        filteredData.AirFiltersData = data.AirFiltersData;

        switch (filterType) {
            case EnumHelper.Filter.Type.Recommendation:
                filteredData.Recommendations = _recommendationsFilter(filterData);
                break;
            case EnumHelper.Filter.Type.PriceGroup:
                filteredData.PriceGroups = _priceGroupsFilter(filterData);
                break;
            case undefined:
                filteredData.Recommendations = _recommendationsFilter(filterData);
                filteredData.PriceGroups = _priceGroupsFilter(filterData);
                break;
        }

        filteredData.AirRenderNotFoundResults = filterData.RenderNotFoundResults;
    }

    function _busFilter(filterData) {
        filteredData.SearchSummary = data.SearchSummary;
        filteredData.Errors = data.Errors;
        filteredData.BusFiltersData = data.BusResponseData.BusFiltersData;
        filteredData.BusGroups = _busGroupsFilter(filterData);
        
        filteredData.BusRenderNotFoundResults = filterData.RenderNotFoundResults;
    }

    function _getMinPrice(event) {
        var minPrice = -1;
        for (k = 0; k < event.EventSectors.length; k++) {
            for (kk = 0; kk < event.EventSectors[k].SectorLots.length; kk++) {
                var lot = event.EventSectors[k].SectorLots[kk];
                if (lot && lot.TotalAmount < minPrice || minPrice == -1)
                    minPrice = lot.TotalAmount;
                kk = event.EventSectors[k].SectorLots.length;
            }
        }
        return minPrice.toFixed(2);
    }

    function _getMaxPrice(event) {
        var maxPrice = -1;
        for (k = 0; k < event.EventSectors.length; k++) {
            for (kk = 0; kk < event.EventSectors[k].SectorLots.length; kk++) {
                var lot = event.EventSectors[k].SectorLots[kk];
                if (lot && lot.TotalAmount > maxPrice)
                    maxPrice = lot.TotalAmount;
                kk = event.EventSectors[k].SectorLots.length;
            }
        }
        return maxPrice.toFixed(2);
    }

    function _ticketsFilter(filtersData) {
        var filterResponse = { Events: [] };

        if (concatEventData) {

            filterResponse.Events = concatEventData;

            var categories = [];
            var locations = [];

            for (var i = 0; i < filterResponse.Events.length; i++)
                if (filtersData.categories && !filtersData.categories.any(function (y) { return y.Id == filterResponse.Events[i].Category.Id }))
                    categories.push(i);

            if (categories.length > 0)
                for (var i = categories.length - 1; i >= 0; i--)
                    filterResponse.Events = filterResponse.Events.removeAt(categories[i]);

            if (filtersData.locations && ((filtersData.locations.length > 0 && filtersData.locations[0].Id != 0) || filtersData.locations.length == 0)) {
                for (var i = 0; i < filterResponse.Events.length; i++) {
                    var a = filtersData.locations.any(function (y) { return filterResponse.Events[i].EventVenues.any(function (q) { return y.Id == q.Venue.LocationId }) });
                    if (!a)
                        locations.push(i);
                }
                if (locations.length > 0)
                    for (var i = locations.length - 1; i >= 0; i--)
                        filterResponse.Events = filterResponse.Events.removeAt(locations[i]);
            }

            if (filtersData.useFilters.price)
                filterResponse.Events = _filterEventPrice(filterResponse, filtersData);

            if (filtersData.useFilters.group)
                filterResponse.Events = _filterByCategoryGroup(filterResponse, filtersData);

            if (filtersData.useFilters.category)
                filterResponse.Events = _filterByCategory(filterResponse, filtersData);

            if (filtersData.useFilters.supplier)
                filterResponse.Events = _filterBySupplierNames(filterResponse, filtersData);

            if (filtersData.useFilters.keyWord)
                filterResponse.Events = _filterByKeywordOnDescription(filterResponse, filtersData);

            data.FilteredEvents = filterResponse.Events;

        } else {
            filterResponse.Events = originalEventData;
        }
        return filterResponse;
    }

    function _filterEventPrice(response, filtersData) {
        var results = [];

        results = response.Events.where(function (event) {
            if (parseFloat(filtersData.MaxPrice) == 0 ||
                (parseFloat(_getMaxPrice(event)) >= parseFloat(filtersData.MinPrice) && parseFloat(_getMinPrice(event)) <= parseFloat(filtersData.MaxPrice)))
                return event;
        });

        return results;
    }

    function _filterByCategoryGroup(response, filtersData) {
        var results = [];

        for (var i = 0; i < response.Events.length; i++)
            if (filtersData.CategoryGroup && filtersData.CategoryGroup.length > 0 && !filtersData.CategoryGroup.any(function (y) { return y.CategoryGroupCode == response.Events[i].Category.Id }))
                results.push(i);

        if (results.length > 0)
            for (var i = results.length - 1; i >= 0; i--)
                response.Events = response.Events.removeAt(results[i]);

        return response.Events;
    }

    function _filterByCategory(response, filtersData) {
        var results = [];
        var events = response.Events;

        for (var i = 0; i < events.length; i++)
            for (var j = 0; j < events[i].Category.Categories.length; j++)
                if (filtersData.Category && filtersData.Category.length > 0 && !filtersData.Category.any(function (y) { return y.CategoryCode == events[i].Category.Categories[j].Id }))
                    results.push(i);


        if (results.length > 0)
            for (var i = results.length - 1; i >= 0; i--)
                response.Events = response.Events.removeAt(results[i]);

        return response.Events;
    }

    function _filterBySupplierNames(response, filtersData) {
        var results = [];

        for (var i = 0; i < response.Events.length; i++)
            if (filtersData.SuppliersNames && filtersData.SuppliersNames.length > 0 && !filtersData.SuppliersNames.any(function (y) { return y.SupplierName.toLowerCase().contains(response.Events[i].SupplierName.toLowerCase()) || filtersData.SuppliersNames.length == 0 }))
                results.push(i);

        if (results.length > 0)
            for (var i = results.length - 1; i >= 0; i--)
                response.Events = response.Events.removeAt(results[i]);

        return response.Events;
    }

    function _filterByKeywordOnDescription(response, filtersData) {
        var results = [];
        var events = response.Events;

        for (var i = 0; i < events.length; i++)
            if (filtersData.KeyWord && (!events[i].Description.toLowerCase().contains(filtersData.KeyWord.toLowerCase()) && !events[i].Id.toString().toLowerCase().contains(filtersData.KeyWord.toLowerCase())))
                results.push(i);

        if (results.length > 0)
            for (var i = results.length - 1; i >= 0; i--)
                response.Events = response.Events.removeAt(results[i]);

        return response.Events;
    }

    function _cityPairsFilter(filtersData, index) {
        var data = thisModel.getData().CityPairs;

        if (!data[index].OriginalFlightGroups)
            data[index].OriginalFlightGroups = data[index].FlightGroups;

        data[index].FlightGroups = data[index].OriginalFlightGroups.where(function (fg) {
            return (_validCityPair(fg, filtersData));
        });

        _orderCityPairsResult(data);

        return data;
    }

    function _validCityPair(flightGroup, filtersData) {
        var valid = false;

        _setOriginalFareOptions(flightGroup);

        if (_validCityPairAirSources(filtersData, flightGroup)
            && _validCityPairAirCompanies(filtersData, flightGroup)
            && _validCityPairStops(filtersData, flightGroup)
            && _validBaggagesOptionsCityPairs(filtersData, flightGroup)
            && _validCityPairTime(filtersData, flightGroup)
            && _validCityPairPrice(filtersData, flightGroup)
            && _validDuration(filtersData, flightGroup, false)
            && _validAirports(filtersData, flightGroup, false)
            && _validLoginInformations(filtersData, flightGroup)

        ) {
            valid = true;
        }

        return valid;
    }

    function _validCityPairAirSources(filterData, flightGroup) {
        var valid = true;

        if (filterData && filterData.AirSources && filterData.AirSources.length) {
            if (!filterData.AirSources.first(function (s) { return s == flightGroup.SourceType })) {
                valid = false;
            }
        }

        return valid;
    }

    function _validCityPairAirCompanies(filterData, flightGroup) {
        var valid = true;

        if (filterData && filterData.AirCompanies && filterData.AirCompanies.length) {
            if (!filterData.AirCompanies.first(function (c) { return c == flightGroup.MajorityAirCompany })) {
                valid = false;
            }
        }

        return valid;
    }

    function _validCityPairStops(filterData, flightGroup) {
        var valid = true;

        if (filterData && filterData.Stops && filterData.Stops.length) {
            if (!filterData.Stops.first(function (s) { return s == flightGroup.NumberOfStops; })) {
                valid = false;
            }
        }

        return valid;
    }

    function _validCityPairTime(filterData, flightGroup) {
        var valid = true;

        //Ida: Minimo
        if (filterData.MinDepartureTime) {
            var firstDepartureTimeValues = formatter.numericTime(flightGroup.FirstDepartureTimeValues);
            if (firstDepartureTimeValues < filterData.MinDepartureTime) {
                valid = false;
            }
        }
        //Ida: Maximo
        if (filterData.MaxDepartureTime) {
            var lastDepartureTimeValues = formatter.numericTime(flightGroup.FirstDepartureTimeValues);
            if (lastDepartureTimeValues > filterData.MaxDepartureTime) {
                valid = false;
            }
        }

        return valid;
    }

    function _validCityPairPrice(filterData, flightGroup) {
        if (controller.lastSearchParameters.Air.SearchType == "2") //Pesquisa por horÃ¡rio nÃ£o tem preÃ§o
            return true;

        flightGroup.FareOptions = flightGroup.FareOptions.where(function (fo) {
            return _validFareOption(fo, filterData);
        });

        return flightGroup.FareOptions.length > 0;
    }

    function _validFareOption(fareOption, filterData) {
        var valid = true;

        var resolvedSumTaxes = SharedFunctions.ResolverAirSumTaxes(fareOption.DisplayFareAmount, fareOption.DUTaxes, fareOption.TaxAmount);

        var flightGroupPrice = resolvedSumTaxes.FareAmount;

        if (filterData.MinPrice)
            if (flightGroupPrice < filterData.MinPrice)
                valid = false;

        if (filterData.MaxPrice)
            if (flightGroupPrice > filterData.MaxPrice)
                valid = false;

        return valid;
    }

    function _busGroupsFilter(filtersData) {
        var filteredBusGroups = [];
        var dataOrdely = thisModel.getOrderlyData();

        if (!dataOrdely.OriginalBusGroups)
            dataOrdely.OriginalBusGroups = dataOrdely.BusStationPairs[0].BusGroups;

        if (dataOrdely.OriginalBusGroups) {
            $.each(dataOrdely.OriginalBusGroups, function (busGroupIndex, busGroup) {
                if (_busFilterConditions(filtersData, busGroup)) {
                    filteredBusGroups.push(busGroup);
                }
            });

        }

        var data = thisModel.getData();

        data.auxBusGroups = filteredBusGroups;
        data.BusGroups = filteredBusGroups;

        return filteredBusGroups;
    }

    function _priceGroupsFilter(filtersData) {
        var priceGroups = [];
        var filteredPriceGroups = [];
        var dataOrdely = thisModel.getOrderlyData();

        if (!dataOrdely.OriginalPriceGroups)
            dataOrdely.OriginalPriceGroups = dataOrdely.PriceGroups;

        $.each(dataOrdely.OriginalPriceGroups, function (priceGroupIndex, priceGroupValue) {
            priceGroupValue.Price = priceGroupValue.Price.normalizeUp();

            var priceGroup = _functions.copy.Air.priceGroupWithoutFlightGroups(priceGroupValue);

            if (priceGroup && priceGroup.CityPairs) {
                var filteredCityPairs = [];

                $.each(priceGroup.CityPairs, function (cityPairIndex, cityPair) {
                    _functions.filter.flight.prepareFilterDataForMultiDestination(cityPair, filtersData);

                    $.each(cityPair.OriginalFlightGroups, function (originalFlighGroupIndex, originalFlightGroupValue) {
                        if (_airFilterConditions(filtersData, priceGroup, originalFlightGroupValue, cityPair, cityPairIndex > 0)) {
                            cityPair.FlightGroups.push(originalFlightGroupValue);
                        }
                    });

                    filteredCityPairs.push(cityPair);
                });

                var anyFlightGroups = filteredCityPairs.any(function (cityPair) { return cityPair.FlightGroups.length; });
                if (!anyFlightGroups)
                    anyFlightGroups = filteredCityPairs.any(function (cityPair) { return cityPair.OriginalFlightGroups.length; });

                $.each(filteredCityPairs.where(function (cityPair) { return anyFlightGroups }), function (cityPairIndex, cityPair) {

                    if (cityPair.FlightGroups.length == 0 && filtersData.NumberOfStops.length) {
                        var filterDataLessStops = {};
                        $.extend(true, filterDataLessStops, filtersData);

                        filterDataLessStops.NumberOfStops = function (stops) {
                            var i = 0;
                            var lessStops = [];
                            while (i !== (stops * 1))
                                lessStops.push({ Stops: i++ });

                            return lessStops;
                        }(filterDataLessStops.NumberOfStops.getItemByMin().Stops);

                        if (filterDataLessStops.NumberOfStops.length) {
                            $.each(cityPair.OriginalFlightGroups, function (originalFlighGroupIndex, originalFlightGroupValue) {
                                if (_airFilterConditions(filterDataLessStops, priceGroup, originalFlightGroupValue, cityPair, cityPairIndex > 0)) {
                                    cityPair.FlightGroups.push(originalFlightGroupValue);
                                }
                            });
                        }
                    }
                });

                if (filteredCityPairs.all(function (cityPair) { return cityPair.FlightGroups.length; })) {

                    if (filteredCityPairs.length > 1) {
                        if (filtersData.RoundTripAirport)
                            _filterRoundTripSameAirports(priceGroup);
                        if (filtersData.RoundTripCiaCompany)
                            filterRoundTripSameAirCompany(priceGroup);
                    }

                    if (filteredCityPairs.all(function (cityPair) { return cityPair.FlightGroups.length; })) {
                        priceGroup.CityPairs = filteredCityPairs;
                        priceGroups.push(priceGroup);
                        filteredPriceGroups.push(priceGroup);
                    }
                }
            }
        });

        var data = thisModel.getData();

        data.auxPriceGroups = filteredPriceGroups;
        data.PriceGroups = filteredPriceGroups;

        return priceGroups;
    }

    function getUniqueAirCompanies(cityPair) {
        var airCompanies = [];

        if (cityPair && cityPair.FlightGroups)
            airCompanies = cityPair.FlightGroups.select(function (fg) { return fg.MajorityAirCompany; }).distinct();

        return airCompanies;
    };

    var filterRoundTripSameAirCompany = function (priceGroup) {

        var airCompaniesOutbound = getUniqueAirCompanies(priceGroup.CityPairs[0]);

        var airCompaniesInbound = getUniqueAirCompanies(priceGroup.CityPairs[1]);

        var airCompaniesCross = airCompaniesOutbound.intersection(airCompaniesInbound);

        for (var iCp = 0; iCp < priceGroup.CityPairs.length; iCp++) {

            var cityPair = priceGroup.CityPairs[iCp];

            var newFlightGroups = [];

            for (var iFg = 0; iFg < cityPair.FlightGroups.length; iFg++) {

                fg = cityPair.FlightGroups[iFg];

                if (airCompaniesCross.any(fg.MajorityAirCompany))
                    newFlightGroups.push(fg);
            }

            cityPair.FlightGroups = newFlightGroups;
        }
    };

    var getUniqueAirports = function (cityPair, originDestination) {

        var airports = [];

        if (cityPair && cityPair.FlightGroups && originDestination)
            airports = cityPair.FlightGroups.select(function (fg) { return fg[originDestination]; }).distinct();

        return airports;
    };

    function _recommendationsFilter(filtersData) {
        var orderlyData = thisModel.getOrderlyData();
        filtersData.operatedAirCompanies = filtersData.AirCompanies.select(function (f) { return f.CiaCode; });

        var filteredRecommendations = [];
        orderlyData.Recommendations.foreach(function (rec) {
            if (_validRecommendation(rec, filtersData))
                filteredRecommendations.push(rec);
        });
        thisModel.getData().auxRecommendations = filteredRecommendations.orderBy(function (r) { return (r.BrandedFare ? r.BrandedFare.DisplayTotalAmount : 0) });

        return filteredRecommendations;
    }

    function _validRecommendation(recommendation, filtersData) {
        var valid = false;

        if (recommendation.FlightGroups && recommendation.FlightGroups.length > 0 && recommendation.FlightGroups[0].OriginalFlightGroup) {

            if (_validRecommendationPrice(filtersData, recommendation)
                && _validRoundTripSameAirports(filtersData, null, recommendation)
                && _validChangeAirportsBetweenFlights(filtersData, null, recommendation)
                && _validRoundTripSameAirCompany(filtersData, null, recommendation)
                && _validAirCompaniesRecommendations(filtersData, recommendation)
                && _validFareType(filtersData, recommendation)
                && _validCharter(filtersData, recommendation)
                && _validStopsRecommendation(filtersData, recommendation)
                && _validDaysStayRecommendation(filtersData, recommendation)) {
                if (filtersData.FilterFlightGroupIndex != undefined)
                    valid = _airFilterConditionsRecommendations(filtersData, recommendation.FlightGroups[filtersData.FilterFlightGroupIndex].OriginalFlightGroup, filtersData.FilterFlightGroupIndex, recommendation);
                else {

                    var index = 0;

                    valid = recommendation.FlightGroups.all(function (flightGroup) {
                        var resp = _airFilterConditionsRecommendations(filtersData, flightGroup.OriginalFlightGroup, index, recommendation);
                        index++;
                        return resp;
                    });
                }
            }
        }

        return valid;
    }

    function _validCharter(filtersData, recommendation) {
        var hasCharter = recommendation.FlightGroups.any(function (bfg) { return bfg.OriginalFlightGroup.SourceType == Util.Sources.Charter; });

        if (hasCharter)
            console.log("filtersData.CharterFares: " + filtersData.CharterFares + " / hasCharter: " + hasCharter);


        return (typeof (filtersData.CharterFares) == 'undefined') || (filtersData.CharterFares && hasCharter);
    }

    function _validFareType(filtersData, recommendation) {
        var isValid = !filtersData.OperatorFares && !filtersData.PublicFares;

        if (!isValid && recommendation != undefined) {
            _setOriginalBrandedFares(recommendation);

            if (Util.HasCount(recommendation.BrandedFares)) {
                var isPoints = recommendation.BrandedFares[0].B2BExtension != undefined
                    && recommendation.BrandedFares[0].B2BExtension.PointsValue > 0;

                if (isPoints) {
                    var filteredBrandedFares = [];

                    recommendation.BrandedFares = recommendation.BrandedFares.where(function (b) {
                        var hasOperatorFare = b.FareOptions.all(function (fo) {
                            return fo.CommercialAgreement != null && fo.CommercialAgreement.IsOperatorFare;
                        });

                        return (!filtersData.OperatorFares && !filtersData.PublicFares) || (filtersData.PublicFares && !hasOperatorFare) || (filtersData.OperatorFares && hasOperatorFare);
                    });

                    recommendation.BrandedFares = filteredBrandedFares;

                    isValid = Util.HasCount(filteredBrandedFares.length);
                } else {
                    var cheapestBrandedFare = recommendation.BrandedFares.getItemByMin(function (bf) {
                        return bf.DisplayTotalAmount;
                    });

                    if (cheapestBrandedFare != undefined && Util.HasCount(cheapestBrandedFare.FareOptions)) {
                        var hasOperatorFare = cheapestBrandedFare.FareOptions.all(function (fo) {
                            return fo.CommercialAgreement != null && fo.CommercialAgreement.IsOperatorFare;
                        });

                        isValid = (filtersData.PublicFares && !hasOperatorFare)
                            || (filtersData.OperatorFares && hasOperatorFare);
                    }
                }
            }

            _setDefaultBrandedFare(recommendation);
        }

        return isValid;
    }

    function _prepareFiltersData(filtersData) {

        if (filtersData.MinInboundTime == undefined)
            filtersData.MinInboundTime = filtersData.MinArrivalTime;

        if (filtersData.MaxInboundTime == undefined)
            filtersData.MaxInboundTime = filtersData.MaxArrivalTime;

        if (filtersData.MinOutboundTime == undefined)
            filtersData.MinOutboundTime = filtersData.MinDepartureTime;

        if (filtersData.MaxOutboundTime == undefined)
            filtersData.MaxOutboundTime = filtersData.MaxDepartureTime;
    };

    function _airFilterConditions(filtersData, priceGroup, flightGroup, cityPair, isInbound) {
        var hasFlights = flightGroup.Flights.length > 0;
        var isValidPrice = _validPriceGroupPrice(filtersData, priceGroup);
        var isValidTime = _validTime(filtersData, flightGroup, isInbound);
        var isValidAirport = _validAirports(filtersData, flightGroup, isInbound, priceGroup, undefined);
        var isValidStops = _validStops(filtersData, flightGroup, cityPair, priceGroup);
        var isValidDuration = _validDuration(filtersData, flightGroup, isInbound);
        var isValidAirCompanies = _validAirCompanies(filtersData, flightGroup, priceGroup);
        var isValidDaysStays = _validDaysStayPriceGroup(filtersData, flightGroup, priceGroup, isInbound);
        var isValidBaggagesOptions = _validBaggagesOptions(filtersData, priceGroup);

        return hasFlights
            && isValidPrice
            && isValidTime
            && isValidAirport
            && isValidStops
            && isValidDuration
            && isValidAirCompanies
            && isValidDaysStays
            && isValidBaggagesOptions;
    };

    function _airFilterConditionsRecommendations(filtersData, flightGroup, flightGroupIndex, recommendation) {
        var filterData = undefined;

        if (filtersData.CityPairs && filtersData.CityPairs.length) {
            var cityPairName = Util.StringFormat("{0}{1}", flightGroup.Origin, flightGroup.Destination);

            filterData = filtersData.CityPairs.first(function (cp) { return cp.Name == cityPairName; });

            if (!filterData)
                filterData = filtersData.CityPairs[flightGroupIndex] || filtersData.CityPairs[(flightGroupIndex > 0 ? 1 : 0)];
        }
        else
            filterData = filtersData;

        _prepareFiltersData(filterData);

        filterData.MultiDestination = filtersData.MultiDestination;

        return flightGroup.Flights.length > 0
            && _validTime(filterData, flightGroup, flightGroupIndex > 0, filtersData.CityPairs && filtersData.CityPairs.length)
            && _validAirports(filterData, flightGroup, flightGroupIndex > 0, undefined, recommendation)
            && _validDuration(filterData, flightGroup, flightGroupIndex)
            && _validBaggagesOptionsRecommendations(filtersData, recommendation)
            && _validLoginInformations(filtersData, flightGroup, flightGroupIndex);
    };

    function _validPriceGroupPrice(filtersData, priceGroup) {
        if (priceGroup.PackagePrice)
            return _validPrice(filtersData, priceGroup.PackagePrice);
        else
            if (filtersData.MinPoints >= 0 && filtersData.MaxPoints > 0)
                return _validPrice(filtersData, priceGroup.Points, true);
            else
                return _validPrice(filtersData, priceGroup.Price);
    }

    function _busFilterConditions(filtersData, busGroup) {
        var hasBuses = busGroup.Buses.length > 0;
        var isValidPrice = _validPrice(filtersData, busGroup.Price.Value);
        var isValidTime = _validBusTime(filtersData, busGroup);
        var isValidBusStation = _validBusStations(filtersData, busGroup);
        var isValidStops = _validBusStops(filtersData, busGroup);
        var isValidDuration = _validBusDuration(filtersData, busGroup);
        var isValidBusCategories = _validBusCategories(filtersData, busGroup);
        var isValidBusCompanies = _validBusCompanies(filtersData, busGroup);
        
        return hasBuses
            && isValidPrice
            && isValidTime
            && isValidBusStation
            && isValidStops
            && isValidDuration
            && isValidBusCategories
            && isValidBusCompanies;
    };

    function _validRecommendationPrice(filtersData, recommendation) {
        if (recommendation.PackagePrice)
            return _validPrice(filtersData, recommendation.PackagePrice);
        else
            return _validBrandedFares(filtersData, recommendation, recommendation.B2BExtension != null);

    }

    function _setOriginalBrandedFares(recommendation) {
        if (recommendation.OriginalBrandedFares)
            recommendation.BrandedFares = recommendation.OriginalBrandedFares;
        else
            recommendation.OriginalBrandedFares = recommendation.BrandedFares;
    }

    function _setOriginalFareOptions(flightGroup) {
        if (flightGroup.OriginalFareOptions)
            flightGroup.FareOptions = flightGroup.OriginalFareOptions;
        else
            flightGroup.OriginalFareOptions = flightGroup.FareOptions;
    }

    function _setDefaultBrandedFare(recommendation) {
        if (recommendation.BrandedFares && recommendation.BrandedFares.length)
            recommendation.BrandedFare = recommendation.BrandedFares.first();
    }

    function _validBrandedFares(filtersData, recommendation, isPoints) {
        var hasValidPrice = false;

        if (recommendation != undefined) {
            _setOriginalBrandedFares(recommendation);

            if (Util.HasCount(recommendation.BrandedFares)) {
                if (recommendation.BrandedFares[0].B2BExtension != undefined
                    && recommendation.BrandedFares[0].B2BExtension.PointsValue > 0) {
                    var filteredBrandedFares = [];

                    recommendation.BrandedFares.forEach(function (b) {
                        var hasB2BExtension = b.B2BExtension != null;
                        var value = (hasB2BExtension ? b.B2BExtension.PointsValue : b.DisplayTotalAmount);

                        if (_validPrice(filtersData, value, hasB2BExtension))
                            filteredBrandedFares.add(b);
                    });

                    recommendation.BrandedFares = filteredBrandedFares;

                    hasValidPrice = recommendation.BrandedFares && recommendation.BrandedFares.length;
                } else {
                    //Utiliza-se somente o branded fare mais barato porque este Ã© o valor mostrado na tela de resultados da pesquisa
                    var cheapestBrandedFareTotalAmount = recommendation.BrandedFares.min(function (bf) {
                        return bf.DisplayTotalAmount;
                    });

                    hasValidPrice = _validPrice(filtersData, cheapestBrandedFareTotalAmount, false);
                }
            }

            _setDefaultBrandedFare(recommendation);
        }

        return hasValidPrice;

        //_setOriginalBrandedFares(recommendation);

        //var filteredBrandedFares = [];
        //recommendation.BrandedFares.forEach(function (b) {
        //    var hasB2BExtension = b.B2BExtension != null;
        //    var value = (hasB2BExtension ? b.B2BExtension.PointsValue : b.DisplayTotalAmount);
        //    if (_validPrice(filtersData, value, hasB2BExtension))
        //        filteredBrandedFares.add(b);
        //});

        //recommendation.BrandedFares = filteredBrandedFares;
        //_setDefaultBrandedFare(recommendation);
        //return filteredBrandedFares.length > 0;
    }

    function _validPrice(filtersData, price, isPoints) {
        if (!isPoints) {
            return (filtersData.MinPrice <= price && price <= filtersData.MaxPrice) || (!filtersData.MinPrice && !filtersData.MaxPrice);
        }
        else if (filtersData.MinPoints && filtersData.MaxPoints) {
            formatterPoints = formatter.coins.getPoints();
            price = formatterPoints.toFixed(price) * 1;
            var min = formatterPoints.toFixed(filtersData.MinPoints) * 1;
            var max = formatterPoints.toFixed(filtersData.MaxPoints) * 1;
            return (min <= price && price <= max) || (min == 0 && max == 0);
        }

        return true;
    }

    function _validBusTime(filtersData, busGroup) {
        var refTime = formatter.numericTime(busGroup.Buses[0].Departure);

        if (refTime == null)
            return true;
        else if (filtersData.MinOutboundTime || filtersData.MaxOutboundTime)
            return refTime >= filtersData.MinOutboundTime && refTime <= filtersData.MaxOutboundTime;
        else
            return true;
    }

    function _validTime(filtersData, flightGroup, isInbound, isCityPair) {

        if (isCityPair) {
            var departure = formatter.numericTime(flightGroup.FirstDepartureTimeValues);

            var arrival = formatter.numericTime(flightGroup.LastArrivalTimeValues);

            var valid = (filtersData.MinArrivalTime <= arrival && arrival <= filtersData.MaxArrivalTime);

            if (valid)
                valid = (filtersData.MinDepartureTime <= departure && departure <= filtersData.MaxDepartureTime);

            return valid;

        }
        else {
            var refTime = formatter.numericTime(flightGroup.FirstDepartureTimeValues);

            if (refTime == null) {
                return true;
            } else if (filtersData.MinOutboundTime || filtersData.MaxOutboundTime) {
                return (!isInbound && refTime >= filtersData.MinOutboundTime && refTime <= filtersData.MaxOutboundTime)
                    || (isInbound && refTime >= filtersData.MinInboundTime && refTime <= filtersData.MaxInboundTime);
            }
            else
                return true;
        }
    }

    function _validAirports(filtersData, flightGroup, isInbound, priceGroup, recommendation) {
        var valid = true;

        filtersData.AirportsInbound = filtersData.AirportsInbound || [];
        filtersData.AirportsOutbound = filtersData.AirportsOutbound || [];

        if (filtersData.MultiDestination) {
            valid = valid && (filtersData.AirportsInbound.length == 0 || filtersData.AirportsInbound.any(function (airport) { return airport.Iata == flightGroup.Destination; }));
            valid = valid && (filtersData.AirportsOutbound.length == 0 || filtersData.AirportsOutbound.any(function (airport) { return airport.Iata == flightGroup.Origin; }));
        }
        else {
            if (isInbound)
                valid &= (filtersData.AirportsInbound.length == 0 || filtersData.AirportsInbound.any(function (inb) { return inb.Iata == flightGroup.Origin; }));
            else
                valid &= (filtersData.AirportsOutbound.length == 0 || filtersData.AirportsOutbound.any(function (out) { return out.Iata == flightGroup.Origin; }))
                    && (!filtersData.AirportsInbound.length || filtersData.AirportsInbound.any(function (inb) { return inb.Iata == flightGroup.Destination; }));
        }

        return valid;
    }

    function _validBusStations(filtersData, busGroup) {
        var valid = true;

        filtersData.BusStationsInbound = filtersData.BusStationsInbound || [];
        filtersData.BusStationsOutbound = filtersData.BusStationsOutbound || [];

        if (filtersData.MultiDestination) {
            valid = valid && (filtersData.BusStationsInbound.length == 0 || filtersData.BusStationsInbound.any(function (busStation) { return busStation.Description == busGroup.Destination; }));
            valid = valid && (filtersData.BusStationsOutbound.length == 0 || filtersData.BusStationsOutbound.any(function (busStation) { return busStation.Description == busGroup.Origin; }));
        }
        else {
            valid &= (filtersData.BusStationsOutbound.length == 0 || filtersData.BusStationsOutbound.any(function (out) { return out.Id == busGroup.OriginId; }))
                && (!filtersData.BusStationsInbound.length || filtersData.BusStationsInbound.any(function (inb) { return inb.Id == busGroup.DestinationId; }));
        }

        return valid;
    }

    function _validAirCompanies(filtersData, flightGroup, priceGroup) {
        var valid = false;
        if (filtersData.AirCompanies.length == 0)
            valid = true;
        else
            valid = filtersData.AirCompanies.any(function (air) { return air.CiaCode == flightGroup.MajorityAirCompany; });

        return valid;

    }

    function _validBusCategories(filtersData, busGroup) {
        if (filtersData.BusCategories.length == 0 || filtersData.BusCategories[0] == 'Todos')
            return true;
        else {
            if (filtersData.BusCategories.any(function (busCategory) { return busCategory == busGroup.Category; })) {
                return true;
            }
        }

        return false;
    }

    function _validBusCompanies(filtersData, busGroup) {
        var valid = false;
        if (filtersData.BusCompanies.length == 0 || filtersData.BusCompanies[0].CiaCode == 'undefined')
            valid = true;
        else
            valid = filtersData.BusCompanies.any(function (busCompany) { return busCompany.CiaCode == busGroup.Buses[0].CompanyId; });

        return valid;
    }

    function _validDaysStayPriceGroup(filtersData, flightGroup, priceGroup, isInbound) {
        var valid = false;
        if (!filtersData.MinDaysStay || !filtersData.MaxDaysStay || priceGroup.CityPairs.length < 2 || isInbound) {
            valid = true;
        }
        else {
            var returnDate = priceGroup.CityPairs[priceGroup.CityPairs.length - 1].OriginalFlightGroups[0].FirstDepartureTimeValues;
            var departure = flightGroup.FirstDepartureTimeValues;
            var arrival = flightGroup.LastArrivalTimeValues;
            var daysDifference = FlightGroupExtensions.Functions.getDaysStayByDates(returnDate, departure, arrival);
            if (daysDifference >= filtersData.MinDaysStay && daysDifference <= filtersData.MaxDaysStay)
                valid = true;
            else
                valid = false;
        }

        return valid;
    }

    function _validDaysStayRecommendation(filtersData, recommendation) {
        var valid = false;
        if (!filtersData.MinDaysStay || !filtersData.MaxDaysStay || recommendation.FlightGroups.length < 2) {
            valid = true;
        }
        else {
            var returnDate = recommendation.FlightGroups[recommendation.FlightGroups.length - 1].OriginalFlightGroup.FirstDepartureTimeValues;
            var departure = recommendation.FlightGroups[0].OriginalFlightGroup.FirstDepartureTimeValues;
            var arrival = recommendation.FlightGroups[0].OriginalFlightGroup.LastArrivalTimeValues;
            var daysDifference = FlightGroupExtensions.Functions.getDaysStayByDates(returnDate, departure, arrival);
            if (daysDifference >= filtersData.MinDaysStay && daysDifference <= filtersData.MaxDaysStay)
                valid = true;
            else
                valid = false;
        }
        return valid;
    }

    function _validAirCompaniesRecommendations(filtersData, recommendation) {
        var ciaCodes = [];

        for (var i = 0; i < recommendation.FlightGroups.length; i++)
            ciaCodes.addRange(recommendation.FlightGroups[i].OriginalFlightGroup.Flights.select(function (f) { return f.CiaCode; }));

        return filtersData.AirCompanies.length == 0 || filtersData.AirCompanies.any(function (c) { return ciaCodes.any(c.CiaCode); });
    }

    function _validRoundTripSameAirports(filtersData, priceGroup, recommendation) {
        var valid = true;

        if (filtersData.RoundTripAirport) {
            if (priceGroup)
                valid = _validRoundTripSameAirportsPriceGroup(priceGroup);
            else
                valid = _validRoundTripSameAirportsRecommendation(recommendation);
        }

        return valid;
    }

    function _validChangeAirportsBetweenFlights(filtersData, priceGroup, recommendation) {
        var valid = true;

        if (filtersData.IgnoreChangeAirportsBetweenFlights) {
            if (!priceGroup)
                valid = !recommendation.hasAirportExchange;
        }

        return valid;
    }

    function _validRoundTripSameAirportsPriceGroup(priceGroup) {
        var airportsOrigin = _getUniqueAirports(priceGroup.CityPairs[0].FlightGroups, "Origin");

        var airportsDestination = _getUniqueAirports(priceGroup.CityPairs[1].FlightGroups, "Destination");

        var airportsCross = airportsOrigin.intersection(airportsDestination);

        for (var iCp = 0; iCp < priceGroup.CityPairs.length; iCp++) {

            var newFlightGroups = [];

            for (var iFg = 0; iFg < priceGroup.CityPairs[iCp].FlightGroups.length; iFg++) {

                fg = priceGroup.CityPairs[iCp].FlightGroups[iFg];

                if ((iCp == 0 && airportsCross.any(fg.Origin)) || (iCp == 1 && airportsCross.any(fg.Destination)))
                    newFlightGroups.push(fg);
            }

            priceGroup.CityPairs[iCp].FlightGroups = newFlightGroups;
        }
    }

    function _validRoundTripSameAirportsRecommendation(recommendation) {
        return recommendation.FlightGroups.length == 2 && recommendation.FlightGroups[0].OriginalFlightGroup.Origin == recommendation.FlightGroups[1].OriginalFlightGroup.Destination;
    }

    function _validRoundTripSameAirCompany(filtersData, priceGroup, recommendation) {
        var valid = true;

        if (filtersData.RoundTripCiaCompany) {
            if (priceGroup)
                valid = _validRoundTripSameAirCompanyPriceGroup(priceGroup);
            else
                valid = _validRoundTripSameAirCompanyRecommendation(recommendation);
        }

        return valid;
    }

    function _validRoundTripSameAirCompanyPriceGroup(priceGroup) {

        if (priceGroup.CityPairs && priceGroup.CityPairs.length > 1) {
            var airCompaniesOutbound = _getUniqueAirCompanies(priceGroup.CityPairs[0].FlightGroups);

            var airCompaniesInbound = _getUniqueAirCompanies(priceGroup.CityPairs[1].FlightGroups);

            var airCompaniesCross = airCompaniesOutbound.intersection(airCompaniesInbound);

            for (var iCp = 0; iCp < priceGroup.CityPairs.length; iCp++) {

                var cityPair = priceGroup.CityPairs[iCp];

                var newFlightGroups = [];

                for (var iFg = 0; iFg < cityPair.FlightGroups.length; iFg++) {

                    fg = cityPair.FlightGroups[iFg];

                    if (airCompaniesCross.any(fg.MajorityAirCompany))
                        newFlightGroups.push(fg);
                }

                cityPair.FlightGroups = newFlightGroups;
            }
        }
    }

    function _validRoundTripSameAirCompanyRecommendation(recommendation) {

        var valid = false;
        var ciaCodes = _getRecommendationCiaCodes(recommendation);

        valid = (ciaCodes.distinct().length == 1);

        return valid;
    }

    function _getRecommendationCiaCodes(recommendation) {
        return recommendation.FlightGroups
            .selectMany(function (fg) {
                return fg.OriginalFlightGroup.Flights.select(function (f) {
                    return f.CiaCode;
                });
            });
    }

    function _validBusDuration(filtersData, busGroup) {
        var minDuration = filtersData.MinDuration;
        var maxDuration = filtersData.MaxDuration;

        if (minDuration === undefined || maxDuration === undefined)
            return true;
        else
            return busGroup.Duration == 0 || (minDuration <= busGroup.Duration && maxDuration >= busGroup.Duration);
    }

    function _validDuration(filtersData, flightGroup, isInbound) {
        var minDuration = filtersData.MinDuration ? filtersData.MinDuration : filtersData.MinOutboundDuration;
        var maxDuration = filtersData.MaxDuration ? filtersData.MaxDuration : filtersData.MaxOutboundDuration;


        if (minDuration === undefined || maxDuration === undefined)
            return true;
        else
            return flightGroup.TotalMinuteDuration == 0 || (minDuration <= flightGroup.TotalMinuteDuration && maxDuration >= flightGroup.TotalMinuteDuration);
    }

    function _validStops(filtersData, flightGroup, cityPair, priceGroup) {
        var allFiltersSelected = !filtersData.NumberOfStops || filtersData.NumberOfStops.length == 0 || filtersData.NumberOfStops.length == filtersData.AvailableNumberOfStops.length;
        if (allFiltersSelected)
            return true;

        var resp = filtersData.NumberOfStops.any(function (s) { return s.Stops == flightGroup.NumberOfStops });
        return resp;
    }

    function _validBusStops(filtersData, busGroup) {
        var allFiltersSelected = !filtersData.NumberOfStops || filtersData.NumberOfStops.length == 0 || filtersData.NumberOfStops.length == filtersData.AvailableNumberOfStops.length;
        if (allFiltersSelected)
            return true;

        var resp = filtersData.NumberOfStops.any(function (s) { return s.Stops == (busGroup.Buses.length - 1) });
        return resp;
    }

    function _validStopsRecommendation(filtersData, recommendation) {

        if (!filtersData.NumberOfStops || filtersData.NumberOfStops.length == 0) {
            return true;
        }
        else {
            var stops = [];

            for (var i = 0, len = filtersData.NumberOfStops.length; i < len; i++) {
                stops[i] = parseInt(filtersData.NumberOfStops[i].Stops);
            }

            for (var i = 0, len = recommendation.FlightGroups.length; i < len; i++) {
                var flightGroupsFlights = recommendation.FlightGroups[i].OriginalFlightGroup.Flights.length - 1;

                flightGroupsFlights += recommendation.FlightGroups[i].OriginalFlightGroup.Flights.sum(function (flight) {
                    return flight.NumberOfStops;
                });

                if ($.inArray(flightGroupsFlights, stops) == -1) {
                    return false;
                }
            }

            return true;
        }
    }

    function _validBaggagesOptionsCityPairs(filtersData, flightGroup) {
        if (filtersData != undefined && filtersData.BaggagesOptions != undefined && Array.isArray(filtersData.BaggagesOptions) && filtersData.BaggagesOptions.length > 0 && flightGroup != null) {
            flightGroup.FareOptions = flightGroup.FareOptions.where(function (fo) {
                return filtersData.BaggagesOptions.select(function (bo) { return bo.Options.toString(); }).contains(fo.BaggagesIncluded.toString());
            });

            return flightGroup.FareOptions.length > 0;
        }

        return true;
    };

    function _validBaggagesOptions(filtersData, priceGroup) {
        if (filtersData != undefined && filtersData.BaggagesOptions != undefined && Array.isArray(filtersData.BaggagesOptions) && filtersData.BaggagesOptions.length > 0 && priceGroup != null) {
            var isBaggageOptionValid = false;

            for (i = 0; i < filtersData.BaggagesOptions.length; i++) {
                var baggageOption = filtersData.BaggagesOptions[i].Options;

                isBaggageOptionValid = priceGroup.BaggagesIncluded == baggageOption;

                if (isBaggageOptionValid)
                    break;
            }

            return isBaggageOptionValid;
        }

        return true;
    };

    function _validBaggagesOptionsRecommendations(filtersData, recommendation) {
        if (filtersData != undefined && filtersData.BaggagesOptions != undefined && Array.isArray(filtersData.BaggagesOptions) && filtersData.BaggagesOptions.length > 0 && recommendation != undefined && Array.isArray(recommendation.BrandedFares)) {
            _setOriginalBrandedFares(recommendation);

            recommendation.BrandedFares = recommendation.BrandedFares.where(function (b) {
                var content = filtersData.BaggagesOptions.select(function (bo) {
                    return bo.Options.toString();
                });
                var result = content.contains(b.BaggagesIncluded.toString());

                if (result) {

                    b.FareOptions.where(function (f) {
                        result = content.contains(f.BaggagesIncluded.toString());
                        if (!result)
                            return;
                    });
                }

                return result;
            });

            _setDefaultBrandedFare(recommendation);

            return recommendation.BrandedFares.length > 0;
        }

        return true;
    };


    function _validLoginInformations(filtersData, flightGroup, flightGroupIndex) {
        if (filtersData != undefined && filtersData.LoginInformations != undefined && Array.isArray(filtersData.LoginInformations) && filtersData.LoginInformations.length > 0 && flightGroup != undefined) {
            return filtersData.LoginInformations.any(function (f) { return f.LoginInformationId == flightGroup.LoginInformationId })
        }
        return true;
    };


    function _getUniqueAirCompanies(flightGroups) {
        var airCompanies = [];

        if (flightGroups)
            airCompanies = flightGroups.selectMany(function (fg) { return fg.Flights.select(function (f) { return f.CiaCode; }); }).distinct();

        return airCompanies;
    }

    function _getUniqueAirports(flightGroups, originDestination) {

        var airports = [];

        if (flightGroups && originDestination)
            airports = flightGroups.select(function (fg) { return fg[originDestination]; }).distinct();

        return airports;
    }

    function _filterRoundTripSameAirports(priceGroup) {

        var airportsOrigin = _getUniqueAirports(priceGroup.CityPairs[0].FlightGroups, "Origin");

        var airportsDestination = _getUniqueAirports(priceGroup.CityPairs[1].FlightGroups, "Destination");

        var airportsCross = airportsOrigin.intersection(airportsDestination);

        for (var iCp = 0; iCp < priceGroup.CityPairs.length; iCp++) {

            var newFlightGroups = [];

            for (var iFg = 0; iFg < priceGroup.CityPairs[iCp].FlightGroups.length; iFg++) {

                fg = priceGroup.CityPairs[iCp].FlightGroups[iFg];

                if ((iCp == 0 && airportsCross.any(fg.Origin)) || (iCp == 1 && airportsCross.any(fg.Destination)))
                    newFlightGroups.push(fg);
            }

            priceGroup.CityPairs[iCp].FlightGroups = newFlightGroups;
        }
    };

    function _filterRoundTripSameBusStations(busGroup) {

        var busStationsOrigin = _getUniqueAirports(busGroup, "Origin");

        var busStationsDestination = _getUniqueAirports(busGroup, "Destination");

        var busStationsCross = airportsOrigin.intersection(busStationsDestination);

        for (var iCp = 0; iCp < busGroup.Buses.length; iCp++) {

            var newFlightGroups = [];

            for (var iFg = 0; iFg < priceGroup.CityPairs[iCp].FlightGroups.length; iFg++) {

                fg = priceGroup.CityPairs[iCp].FlightGroups[iFg];

                if ((iCp == 0 && airportsCross.any(fg.Origin)) || (iCp == 1 && airportsCross.any(fg.Destination)))
                    newFlightGroups.push(fg);
            }

            priceGroup.CityPairs[iCp].FlightGroups = newFlightGroups;
        }
    };

    function _hotelFilter(filtersData) {
        filteredData.Hotels = [];
        filteredData.BestPrice = 0;
        filteredData.TotalHotels = 0;

        if (filtersData.StayOptionsFilter)
            _functions.filter.Hotel.byStayOptions.createStayOptionsFilter(filtersData);

        filtersData.MinPrice = isNaN(filtersData.MinPrice) ? 0 : filtersData.MinPrice.normalize();
        filtersData.MaxPrice = isNaN(filtersData.MaxPrice) ? 99999999 : filtersData.MaxPrice.normalize();
        filtersData.HotelName = (filtersData.HotelName) ? filtersData.HotelName.normalize() : "";

        var ordelyResponse = thisModel.getOrderlyData();

        ordelyResponse.FilteredHotels = [];

        if (ordelyResponse.Hotels) {
            for (var i = 0; i < ordelyResponse.Hotels.length; i++) {
                var hotel = ordelyResponse.Hotels[i];

                filteredData.TotalHotels++;

                if (_hotelFilterCondition(filtersData, hotel)) {

                    ordelyResponse.FilteredHotels.push(hotel);

                    if (hotel.DisplayDailyFare < filteredData.BestPrice || filteredData.BestPrice == 0)
                        filteredData.BestPrice = hotel.DisplayDailyFare;
                }
            }
        }

        filteredData.Hotels = ordelyResponse.FilteredHotels;

        filteredData.HotelRenderNotFoundResults = filtersData.RenderNotFoundResults;
    }

    function _hotelFilterCondition(filtersData, hotel) {
        return _validHotelName(filtersData, hotel)
            && _validStars(filtersData, hotel)
            && _validPrices(filtersData, hotel)
            && _validDistances(filtersData, hotel)
            && _validBoards(filtersData, hotel)
            && _validTypes(filtersData, hotel)
            && _validHotelType(filtersData, hotel)
            && _validSources(filtersData, hotel)
            && _validComparativeFareTypes(filtersData, hotel)
            && _validStayOptions(filtersData, hotel)
            && _validChain(filtersData, hotel);
    }

    function _validHotelName(filtersData, hotel) {
        return (!filtersData.HotelName) || !filtersData.HotelName.length || hotel.Name.normalize().contains(filtersData.HotelName);
    }

    function _validChain(filtersData, hotel) {
        return filtersData.Chains.length == 0 || filtersData.Chains.any(hotel.Chain.Code || hotel.Chain.Name);
    }

    function _validStars(filtersData, hotel) {
        return filtersData.Stars.length == 0 || filtersData.Stars.any(hotel.Stars) || hotel.Stars == 0;
    }

    function _validPrices(filtersData, hotel) {
        var price = 0;

        price = hotel.getPointsAmount().normalize();
        if (!price) {
            if (hotel.AuxiliarData.PackagePrice) {

                price = hotel.AuxiliarData.PackagePrice;

            } else {
                price = hotel.getCheapestDailyFare().normalize();
            }
        }

        return filtersData.MinPrice <= price && price <= filtersData.MaxPrice;
    }

    function _validBoards(filtersData, hotel) {
        return filtersData.Boards.length == 0 ||
            hotel.RoomsGroups.any(function (rg) {
                return rg.Rooms.any(function (r) {
                    return filtersData.Boards.any(function (h) {
                        if (h) {
                            var stayOption = r.getSelectedStayOption();
                            return h.normalizedEquals(stayOption.Services && stayOption.Services.length && stayOption.Services[0].Name || "");
                        }
                    });
                })
            });
    }

    function _validDistances(filtersData, hotel) {
        return (hotel.Address.DistanceToCenterCity >= filtersData.MinDistanceToCenterCity && hotel.Address.DistanceToCenterCity <= filtersData.MaxDistanceToCenterCity) &&
            (hotel.Address.DistanceToNearestAirport >= filtersData.MinDistanceToNearestAirport && hotel.Address.DistanceToNearestAirport <= filtersData.MaxDistanceToNearestAirport);
    }

    function _validHotelType(filtersData, hotel) {
        if (!hotel.Types)
            hotel.Types = [];

        return !hotel.Types.length || !filtersData.TypesHotel || filtersData.TypesHotel.length == 0 ||
            hotel.Types.any(function (type) {
                return filtersData.TypesHotel.any(function (t) {
                    return t == type.Name;
                })
            });
    }

    function _validTypes(filtersData, hotel) {
        return !filtersData.HotelTypes || filtersData.HotelTypes.length == 0 ||
            hotel.RoomsGroups.any(function (rg) {
                return rg.Rooms.any(function (r) {
                    return filtersData.HotelTypes.any(function (t) {
                        var res = true;
                        if (t == "Offline")
                            res = r.Source.normalize().contains("offline");
                        else
                            res = !r.Source.normalize().contains("offline");

                        return res;
                    });
                })
            });
    }

    function _validSources(filtersData, hotel) {
        return !filtersData.Sources || !filtersData.Sources.length ||
            hotel.RoomsGroups.any(function (rg) {
                return rg.Rooms.any(function (r) {
                    var sourceName = r.Source;
                    if (r.OriginalBrokerName && r.OriginalBrokerName.length && r.OriginalBrokerName != r.Source)
                        sourceName = r.OriginalBrokerName + " (" + r.Source + ")";
                    return filtersData.Sources.any(sourceName);
                });
            });
    }

    function _validComparativeFareTypes(filtersData, hotel) {
        return !filtersData.HotelComparativeFareTypes || filtersData.HotelComparativeFareTypes.length == 0 ||
            hotel.RoomsGroups.any(function (rg) {
                return rg.Rooms.any(function (r) {
                    return filtersData.HotelComparativeFareTypes.any(function (t) {
                        var stayOption = r.getSelectedStayOption();
                        return (stayOption && stayOption.FareDetails && t == stayOption.FareDetails.FareType);
                    });
                })
            });
    }

    function _validStayOptions(filtersData, hotel) {
        return !filtersData.StayOptionsFilter ||
            hotel.AuxiliarData.AllRoomsAvailableStayOptions.any(function (allrso) {
                return allrso == filtersData.StayOptionsFilter.MinStayOption ||
                    allrso == filtersData.StayOptionsFilter.MaxStayOption;
            });
    };

    function _carFilter(filtersData) {
        filteredData.CarResponseData = { CarQuoteGroups: [] };
        data.CarQuoteGroups = [];

        var validateCompanies = filtersData.Companies && filtersData.Companies.length > 0;
        var validateCarCategories = filtersData.CarCategories && filtersData.CarCategories.length > 0;
        var validateCarTypes = filtersData.CarTypes && filtersData.CarTypes.length > 0;
        var validateCarRateQualifier = filtersData.CarRateQualifier && filtersData.CarRateQualifier.length > 0;

        for (var i = 0, len = data.CarResponseData.CarQuoteGroups.length; i < len; i++) {
            var carQuoteGroup = Util.Clone(data.CarResponseData.CarQuoteGroups[i]);

            var isValid = true;

            //Company
            if (validateCompanies && $.inArray(carQuoteGroup.Company.Id, filtersData.Companies) == -1)
                isValid = false;

            //Category
            if (validateCarCategories && $.inArray(carQuoteGroup.BestQuote.Car.Category, filtersData.CarCategories) == -1)
                isValid = false;

            //Type
            if (validateCarTypes && $.inArray(carQuoteGroup.BestQuote.Car.Type, filtersData.CarTypes) == -1)
                isValid = false;

            //RateQualifier
            if (validateCarRateQualifier && $.inArray(carQuoteGroup.BestQuote.FareSummary.CarRateQualifier, filtersData.CarRateQualifier) == -1)
                isValid = false;

            //Price
            var validQuotes = carQuoteGroup.Quotes.where(function (quote) {
                quote.FareSummary.MarkupedEstimatedFareAmount = parseFloat(quote.FareSummary.MarkupedEstimatedFareAmount.toFixed(2));

                return quote.FareSummary.MarkupedEstimatedFareAmount >= filtersData.MinPrice && quote.FareSummary.MarkupedEstimatedFareAmount <= filtersData.MaxPrice;
            });

            //Equipments
            validQuotes = validQuotes.where(function (quote) {

                var isInValidDoors = filtersData.Equipments.Doors && filtersData.Equipments.Doors.length && $.inArray(quote.Car.NumberOfDoors, filtersData.Equipments.Doors) == -1;

                var isInValidPassengers = filtersData.Equipments.Passengers && filtersData.Equipments.Passengers.length && $.inArray(quote.Car.NumberOfPassengers, filtersData.Equipments.Passengers) == -1;

                var isInValidBags = filtersData.Equipments.Bags && filtersData.Equipments.Bags.length && $.inArray(quote.Car.NumberOfBags, filtersData.Equipments.Bags) == -1;

                var isInValidTransmission = filtersData.Equipments.Transmission && filtersData.Equipments.Transmission.length && $.inArray(quote.Car.Transmission, filtersData.Equipments.Transmission) == -1;

                var carHasAirConditioning = quote.Car.HasAirConditioning ? 1 : 0;
                var isInValidAirConditioning = filtersData.Equipments.AirConditioning && filtersData.Equipments.AirConditioning.length && $.inArray(carHasAirConditioning, filtersData.Equipments.AirConditioning) == -1;

                return !isInValidDoors && !isInValidPassengers && !isInValidBags && !isInValidTransmission && !isInValidAirConditioning;

            });

            if (!validQuotes.length)
                isValid = false;
            else {
                if (validQuotes.length != carQuoteGroup.Quotes.length) {
                    carQuoteGroup.Quotes = validQuotes;

                    carQuoteGroup.PickupLocations = [];
                    carQuoteGroup.DropoffLocations = [];

                    carQuoteGroup.Quotes.forEach(function (q) {
                        if (q.DropoffLocationIndex != null)
                            carQuoteGroup.DropoffLocations.push(data.CarResponseData.RentalLocations[q.DropoffLocationIndex]);

                        if (q.PickupLocationIndex != null)
                            carQuoteGroup.PickupLocations.push(data.CarResponseData.RentalLocations[q.PickupLocationIndex]);
                    });

                    carQuoteGroup.Quotes.orderBy(function (q) { return q.FareSummary.MarkupedEstimatedFareAmount; });
                    carQuoteGroup.BestQuote = carQuoteGroup.Quotes.first();
                }
            }

            if (isValid)
                filteredData.CarResponseData.CarQuoteGroups.push(carQuoteGroup);
        }
        if (filteredData.CarResponseData && filteredData.CarResponseData.CarQuoteGroups.length) {

            var isOrderDescending = filteredData.CarResponseData.CarQuoteGroups.first().BestQuote.FareSummary.EstimatedTotalFare > filteredData.CarResponseData.CarQuoteGroups.last().BestQuote.FareSummary.EstimatedTotalFare;

            if (isOrderDescending) {
                filteredData.CarResponseData.CarQuoteGroups.orderByDescending(function (q) { return q.BestQuote.FareSummary.EstimatedTotalFare })
            } else {
                filteredData.CarResponseData.CarQuoteGroups.orderBy(function (q) { return q.BestQuote.FareSummary.EstimatedTotalFare })
            }
        }
    };

    function _serviceFilter(filtersData) {
        filteredData.ServicesResponseData = { Services: [] };

        data.ServicesResponseData.Services.forEach(function (service) {

            var isValid = true;

            //Price
            if (isValid && filtersData.MinPrice != undefined && filtersData.MaxPrice != undefined) {

                var fares = (service.OriginalFares || service.Fares);

                var validFares = fares.where(function (f) {

                    f.TotalAmount = parseFloat(f.TotalAmount.toFixed(2));

                    return filtersData.MinPrice <= f.TotalAmount && f.TotalAmount <= filtersData.MaxPrice;
                });

                if (!validFares.length)
                    isValid = false;
            }

            //Category
            if (isValid && filtersData.Categories && filtersData.Categories.length) {
                var serviceCategory = service.Category;
                if (!serviceCategory)
                    serviceCategory = data.ServicesResponseData.Categories[service.CategoryIndex];

                isValid = $.inArray(serviceCategory.Id, filtersData.Categories) > -1;
            }

            //Supplier
            if (isValid && filtersData.Suppliers && filtersData.Suppliers.length) {
                if (service.SupplierId != null) {
                    var serviceSupplier = data.Suppliers.where(function (supplier) { return supplier.Id == service.SupplierId }).first();
                    isValid = $.inArray(serviceSupplier.Id, filtersData.Suppliers) > -1;
                }
                else
                    isValid = false;
            }

            // fare time
            if (isValid && filtersData.MinTime != undefined && filtersData.MaxTime != undefined) {
                isValid = service.Fares.any(function (f) {
                    return (!f.StartHour && !f.EndHour) ||
                        ((f.StartHour >= filtersData.MinTime && f.StartHour <= filtersData.MaxTime) || (f.EndHour >= filtersData.MinTime && f.EndHour <= filtersData.MaxTime));
                });
            }

            //Countries
            if (isValid && filtersData.Countries && filtersData.Countries.length) {
                isValid = service.Locations && service.Locations.any(function (l) {
                    return filtersData.Countries.any(l);
                });
            }

            //Consumable Days
            if (isValid && filtersData.AvailableConsumableDays && filtersData.AvailableConsumableDays.length) {
                isValid = filtersData.AvailableConsumableDays.any(service.ConsumableDays);
            }


            //SupplierIds
            if (isValid && filtersData.SuppliersIds && filtersData.SuppliersIds.length) {
                isValid = filtersData.SuppliersIds.any(function (s) { return service.OnlineSupplierId == s || service.SupplierId == s; });
            }

            //KeyWord
            if (isValid && filtersData.KeyWord && filtersData.KeyWord.length) {
                var keyword = filtersData.KeyWord.toLowerCase();
                var description = service.Description && service.Description.length ? service.Description.toLowerCase() : '';
                var name = service.Name && service.Name.length ? service.Name.toLowerCase() : '';
                var otherDescriptions = (service.OtherDescriptions && service.OtherDescriptions.length ? service.OtherDescriptions.select(function (h) { return h.Value; }).join() : '').toLowerCase();
                var supplierName = ((service.Supplier && service.Supplier.Name) || '').toLowerCase();

                isValid = name.contains(keyword)
                    || description.contains(keyword)
                    || otherDescriptions.contains(keyword)
                    || supplierName.contains(keyword);
            }

            if (isValid)
                filteredData.ServicesResponseData.Services.push(service);
        });
    };

    function _resetPackageFilters() {
        if (data.PackageResponseData && data.PackageResponseData.Packages && data.PackageResponseData.Packages.length) {
            data.PackageResponseData.Packages.forEach(function (p) {
                p.ResetIndexes();
                p.ResetCheckinDates();
            });
        }
    };

    function _packageFilter(filtersData) {

        var packages = getPackagesResponse();

        filteredData.PackageResponseData = {
            Packages: [],
            LastFilterActive: filtersData.LastFilterActive
        };

        var activeFilters = {
            airCompany: (filtersData.CiaCodes && filtersData.CiaCodes.length > 0),
            sameAirCompanyRoundTrip: (filtersData.SameAirCompanyRoundTrip),
            departureDaysOfWeek: (filtersData.DaysOfWeek && filtersData.DaysOfWeek.length > 0),
            hotelName: (filtersData.HotelName != ""),
            hotelRating: (filtersData.Categories && filtersData.Categories.length > 0),
            nights: (filtersData.Nights && filtersData.Nights.length > 0),
            price: true,
            packageName: (filtersData.PackageName != "")
        };

        var len = packages.length;
        for (var i = 0; i < len; i++) {

            var _package = packages[i];
            var _validRecommendationsIndexes = [];
            var _validHotelsIndexes = [];
            var _validServicesIndexes = [];
            var _isValid = true;

            var _validateRecommendations = _package.HasRecommendation;
            var _validateHotels = _package.HasHotel;

            _package.ResetIndexes();
            _package.ResetCheckinDates();

            //#region Package filters

            //Departure days
            if (activeFilters.departureDaysOfWeek) {
                var _validItens = _package.CheckinDates.where(function (dt) { return filtersData.DaysOfWeek.contains(Util.DateValuesToDate(dt).getDay()) });
                _package.CheckinDates = _validItens;
                _isValid = (_package.CheckinDates.any());
            }

            //Nights
            if (_isValid && activeFilters.nights)
                _isValid = filtersData.Nights.contains(_package.Nights);

            //#endregion

            if (_package.Summary) {
                //#region Air filters

                if (_isValid && _package.Summary && _package.Summary.MajorityAirCompanies && _package.Summary.MajorityAirCompanies.length) {

                    if (activeFilters.airCompany) {
                        _isValid = _package.Summary.MajorityAirCompanies.any(function (m) {
                            return filtersData.CiaCodes.any(function (ciaCode) { return m.Value.contains(ciaCode); });
                        });
                    }

                    if (_isValid && activeFilters.sameAirCompanyRoundTrip) {
                        var firstValue = _package.Summary.MajorityAirCompanies.first().Value;
                        var lastValue = _package.Summary.MajorityAirCompanies.last().Value;

                        _isValid = firstValue.any(function (f) { return lastValue.contains(f); });
                    }
                }
            }

            //var recommendations = PackageExtensions.GetPackageRecommendations(data.AirResponseData, _package);

            //recommendations.foreach(function (rec, c) {
            //    var _recommendation = rec;
            //    var _validItem = true;

            //    //Air company
            //    if (activeFilters.airCompany) {
            //        _validItem = _recommendation.FlightGroups.any(function (flightGroup) {
            //            return filtersData.CiaCodes.contains(flightGroup.OriginalFlightGroup.MajorityAirCompany);
            //        });
            //    }

            //    //Same air company for round trip
            //    if (_validItem && activeFilters.sameAirCompanyRoundTrip) {
            //        var inboundAirCompany = _recommendation.FlightGroups.first().OriginalFlightGroup.MajorityAirCompany;
            //        var outboundAirCompany = _recommendation.FlightGroups.last().OriginalFlightGroup.MajorityAirCompany;
            //        _validItem = (inboundAirCompany == outboundAirCompany);
            //    }

            //    if (_validItem)
            //        _validRecommendationsIndexes[c] = (i);
            //});

            //#endregion

            //#region Hotel filters

            if (_package.Summary) {

                if (_isValid && _package.Summary.HotelNames) {

                    //Hotel name
                    if (activeFilters.hotelName && filtersData.HotelName) {

                        var hotelName = filtersData.HotelName.normalize();

                        _isValid = _package.Summary.HotelNames.any(function (h) {
                            return h.normalize().contains(hotelName);
                        });
                    }

                    //Hotel rating (stars)
                    if (_isValid && activeFilters.hotelRating && _package.Summary.HotelStars)
                        _isValid = _package.Summary.HotelStars.any(function (star) { return filtersData.Categories.contains(star); });;
                }

                //_package.HotelIndexes.forEach(function (i, c) {
                //    var _hotel = data.HotelResponseData.Hotels[i];
                //    var _validItem = true;


                //    if (activeFilters.hotelName)
                //        _validItem = (_hotel.Name.normalize().contains(filtersData.HotelName));

                //    //Hotel rating (stars)
                //    if (_validItem && activeFilters.hotelRating)
                //        _validItem = (filtersData.Categories.contains(_hotel.Stars));

                //    if (_validItem)
                //        _validHotelsIndexes[c] = i;
                //});
            }

            //#endregion

            //#region Package filters

            if (activeFilters.packageName) {
                var packName = _package.Name;
                if (_package.ExtendedName)
                    packName = _package.ExtendedName;

                _isValid = (packName.normalize().contains(filtersData.PackageName));
            }

            //#endregion

            //if ((_validateRecommendations && !_validRecommendationsIndexes.any()) || (_validateHotels && !_validHotelsIndexes.any()))
            //    _isValid = false;

            if (_isValid) {

                //_package.RecommendationsIndexes = Util.CloneArray(_validRecommendationsIndexes);
                //_package.HotelIndexes = Util.CloneArray(_validHotelsIndexes);

                filteredData.PackageResponseData.Packages.push(_package);
            }
        }
    };

    function _resetCruiseFilter(cruiseOptions) {
        cruiseOptions.forEach(function (cruiseOption) {
            cruiseOption.FilteredFareOptions = cruiseOption.FareOptions;

            cruiseOption.FareOptions.foreach(function (fareOption) {
                fareOption.AllSuperCategories.foreach(function (superCategory) {
                    superCategory.isDisabled = false;
                });
            });
        });
    }

    function _getCruiseOptionsWithFareOptions(cruiseOptions) {
        return cruiseOptions.where(function (cruiseOption) {
            return cruiseOption.FilteredFareOptions.length > 0;
        });
    }

    function _getCruiseOptionsWithFareOptions(cruiseOptions) {
        return cruiseOptions.where(function (cruiseOption) {
            return cruiseOption.FilteredFareOptions.length > 0;
        });
    }

    function _filterCruiseOptions(filtersData, orderlyData) {
        var cruiseOptions = [];

        if (!filtersData.SorterOnly) {
            for (var i = 0; i < orderlyData.CruiseResponseData.CruiseOptions.length; i++)
                cruiseOptions.push($.extend(false, orderlyData.CruiseResponseData.CruiseOptions[i], {}));

            _resetCruiseFilter(cruiseOptions);

            if (Util.HasCount(filtersData.Promotions)) {
                cruiseOptions.foreach(function (cruiseOption) {
                    filtersData.Promotions.foreach(function (promotionCode) {
                        cruiseOption.FilteredFareOptions = cruiseOption.FilteredFareOptions.where(function (fo) {
                            /*
                            return fo.CompatiblePromotions.any(function (cp) {
                                //return filtersData.Promotions.indexOf(cp.Code) >= 0;
                                return promotionCode === cp.Code;
                            });
                            */

                            return fo.SuperCategories.any(function (sc) {
                                return sc.CompatiblePromotions.any(function (cp) {
                                    return cp.Code === promotionCode;
                                });
                            });
                        });

                        cruiseOption.FilteredFareOptions.foreach(function (o) {
                            o.SuperCategories = o.SuperCategories.where(function (sc) {
                                return sc.CompatiblePromotions.any(function (cp) {
                                    return cp.Code === promotionCode;
                                });
                            });

                            o.AllSuperCategories = o.SuperCategories;
                        });
                    });
                });
            }

            cruiseOptions = _getCruiseOptionsWithFareOptions(cruiseOptions);

            if (filtersData.NumbersOfNights && filtersData.NumbersOfNights.length > 0)
                cruiseOptions = cruiseOptions.where(function (s) { return filtersData.NumbersOfNights.any(s.Cruise.NumberOfNights); });

            if (filtersData.CruiseLines && filtersData.CruiseLines.length > 0)
                cruiseOptions = cruiseOptions.where(function (s) { return filtersData.CruiseLines.any(s.Cruise.CruiseLine.Code); });

            if (filtersData.Ships && filtersData.Ships.length > 0)
                cruiseOptions = cruiseOptions.where(function (s) { return filtersData.Ships.any(s.Cruise.Ship.Code); });

            if (filtersData.CruiseEmbarks && filtersData.CruiseEmbarks.length > 0)
                cruiseOptions = cruiseOptions.where(function (s) { return filtersData.CruiseEmbarks.any(s.Cruise.EmbarkPortId); });

            if (filtersData.CruiseDestinations && filtersData.CruiseDestinations.length > 0)
                cruiseOptions = cruiseOptions.where(function (s) { return filtersData.CruiseDestinations.any(s.Cruise.Destination.Code); });

            if (filtersData.CruiseEmbarksDate ||
                (filtersData.CruiseEmbarksDatesRange && filtersData.CruiseEmbarksDatesRange.StartDate && filtersData.CruiseEmbarksDatesRange.EndDate))

                cruiseOptions.foreach(function (cruiseOption) {

                    if (filtersData.CruiseEmbarksDate)
                        cruiseOption.FilteredFareOptions = cruiseOption.FilteredFareOptions.where(function (f) { return filtersData.CruiseEmbarksDate == formatter.dateValuesShort(f.EmbarkDate); });

                    if (filtersData.CruiseEmbarksDatesRange && filtersData.CruiseEmbarksDatesRange.StartDate && filtersData.CruiseEmbarksDatesRange.EndDate)
                        cruiseOption.FilteredFareOptions = cruiseOption.FilteredFareOptions.where(function (f) {
                            var embarkDate = Util.DateValuesToDate(f.EmbarkDate);
                            return embarkDate >= filtersData.CruiseEmbarksDatesRange.StartDate && embarkDate <= filtersData.CruiseEmbarksDatesRange.EndDate;
                        });
                });

            cruiseOptions.foreach(function (cruiseOption) {
                cruiseOption.FilteredFareOptions.foreach(function (fareOption) {
                    fareOption.AllSuperCategories.foreach(function (superCategory) {
                        superCategory.withoutFareAmount = !superCategory.FareAmount;

                        superCategory.isDisabled = superCategory.withoutFareAmount;

                        if (!superCategory.withoutFareAmount) {
                            if (filtersData.MinCruisePrice || filtersData.MaxCruisePrice)
                                superCategory.isDisabled = !(superCategory.FareAmount.Value >= (filtersData.MinCruisePrice || 0) && superCategory.FareAmount.Value <= (filtersData.MaxCruisePrice || Number.MAX_VALUE));

                            if (filtersData.SuperCategories && filtersData.SuperCategories.length > 0)
                                superCategory.isDisabled = superCategory.isDisabled || !filtersData.SuperCategories.any(superCategory.Name);
                        }
                    });
                });

                cruiseOption.FilteredFareOptions = cruiseOption.FilteredFareOptions.where(function (fareOption) {
                    return fareOption.AllSuperCategories.any(function (superCategory) {
                        return !superCategory.isDisabled && !superCategory.withoutFareAmount;
                    });
                });
            });

            cruiseOptions = _getCruiseOptionsWithFareOptions(cruiseOptions);
        } else {
            if (filteredData && filteredData.CruiseResponseData && filteredData.CruiseResponseData.CruiseOptions)
                cruiseOptions = filteredData.CruiseResponseData.CruiseOptions;
            else
                cruiseOptions = $.extend(true, orderlyData.CruiseResponseData.CruiseOptions, {});
        }

        return cruiseOptions;
    }

    function _filterCruiseOptionsExceptBy(filtersData, orderlyData, except) {
        var filtersDataBase = $.extend(true, {}, filtersData);
        filtersDataBase[except] = [];
        var cruiseOptions = _filterCruiseOptions(filtersDataBase, orderlyData);

        return cruiseOptions;
    }

    function _updateCruiseFiltersData(originalFiltersData, filtersData, orderlyData) {
        originalFiltersData = $.extend(true, {}, originalFiltersData);

        if (filtersData.SorterOnly)
            filtersData = $.extend(true, lastFiltersData, filtersData);
        else
            lastFiltersData = filtersData;

        var cruiseOptions = _filterCruiseOptionsExceptBy(filtersData, orderlyData, "NumbersOfNights");
        if (filtersData.NumbersOfNights)
            for (var i = 0; i < originalFiltersData.NumbersOfNights.length; i++) {
                originalFiltersData.NumbersOfNights[i].Selected = filtersData.NumbersOfNights.any(originalFiltersData.NumbersOfNights[i].NumberOfNights);
                originalFiltersData.NumbersOfNights[i].AvailableOptionsCount = cruiseOptions.count(function (s) { return originalFiltersData.NumbersOfNights[i].NumberOfNights == s.Cruise.NumberOfNights; });
            }

        cruiseOptions = _filterCruiseOptionsExceptBy(filtersData, orderlyData, "CruiseEmbarks");

        if (filtersData.CruiseEmbarks)
            for (var i = 0; i < originalFiltersData.Embarks.length; i++) {
                originalFiltersData.Embarks[i].Selected = filtersData.CruiseEmbarks.any(originalFiltersData.Embarks[i].Location.Id);
                originalFiltersData.Embarks[i].AvailableOptionsCount = cruiseOptions.count(function (s) { return originalFiltersData.Embarks[i].Location.Id == s.Cruise.EmbarkPortId; });
            }

        cruiseOptions = _filterCruiseOptionsExceptBy(filtersData, orderlyData, "CruiseDestinations");

        if (filtersData.CruiseDestinations)
            for (var i = 0; i < originalFiltersData.Destinations.length; i++) {
                originalFiltersData.Destinations[i].Selected = filtersData.CruiseDestinations.any(originalFiltersData.Destinations[i].CruiseDestination.Code);
                originalFiltersData.Destinations[i].AvailableOptionsCount = cruiseOptions.count(function (s) { return originalFiltersData.Destinations[i].CruiseDestination.Code == s.Cruise.Destination.Code; });
            }

        cruiseOptions = _filterCruiseOptionsExceptBy(filtersData, orderlyData, "CruiseLines");

        if (filtersData.CruiseLines)
            for (var i = 0; i < originalFiltersData.CruiseLines.length; i++) {
                originalFiltersData.CruiseLines[i].Selected = filtersData.CruiseLines.any(originalFiltersData.CruiseLines[i].CruiseLine.Code);
                originalFiltersData.CruiseLines[i].AvailableOptionsCount = cruiseOptions.count(function (s) { return originalFiltersData.CruiseLines[i].CruiseLine.Code == s.Cruise.CruiseLine.Code; });
            }

        cruiseOptions = _filterCruiseOptionsExceptBy(filtersData, orderlyData, "Ships");
        if (filtersData.Ships)
            for (var i = 0; i < originalFiltersData.Ships.length; i++) {
                originalFiltersData.Ships[i].Selected = filtersData.Ships.any(originalFiltersData.Ships[i].Ship.Code);
                originalFiltersData.Ships[i].AvailableOptionsCount = cruiseOptions.count(function (s) { return originalFiltersData.Ships[i].Ship.Code == s.Cruise.Ship.Code; });
            }

        cruiseOptions = _filterCruiseOptionsExceptBy(filtersData, orderlyData, "Promotions");
        if (filtersData.Promotions)
            for (var i = 0; i < originalFiltersData.Promotions.length; i++) {
                originalFiltersData.Promotions[i].Selected = filtersData.Promotions.any(originalFiltersData.Promotions[i].Promotion.Code);
                originalFiltersData.Promotions[i].AvailableOptionsCount = cruiseOptions.count(function (s) {
                    //var compatiblePromotions = s.FareOptions.selectMany(function (fo) { return fo.CompatiblePromotions; });
                    var compatiblePromotions = s.FareOptions.selectMany(function (fo) {
                        return fo.SuperCategories.selectMany(function (sc) {
                            return sc.CompatiblePromotions;
                        });
                    });
                    return compatiblePromotions.any(function (cp) { return cp.Code === originalFiltersData.Promotions[i].Promotion.Code; });
                });
            }

        if (filtersData.SuperCategories)
            for (var i = 0; i < originalFiltersData.SuperCategories.length; i++)
                originalFiltersData.SuperCategories[i].Selected = originalFiltersData.SuperCategories[i].SuperCategory && filtersData.SuperCategories.any(originalFiltersData.SuperCategories[i].SuperCategory.Name);

        originalFiltersData.active_calendar = filtersData.CruiseEmbarksDate != undefined;
        originalFiltersData.active_nights = filtersData.NumbersOfNights && filtersData.NumbersOfNights.any();
        originalFiltersData.active_embarks = filtersData.CruiseEmbarks && filtersData.CruiseEmbarks.any();
        originalFiltersData.active_destinations = filtersData.CruiseDestinations && filtersData.CruiseDestinations.any();
        originalFiltersData.active_cruiseLines = filtersData.CruiseLines && filtersData.CruiseLines.any();
        originalFiltersData.active_ships = filtersData.Ships && filtersData.Ships.any();
        originalFiltersData.active_prices = filtersData.MinCruisePrice != originalFiltersData.MinCruisePrice || filtersData.MaxCruisePrice != originalFiltersData.MaxCruisePrice;
        originalFiltersData.active_superCategories = filtersData.SuperCategories && filtersData.SuperCategories.any();

        originalFiltersData.active_any = Object.keys(originalFiltersData).any(function (prop) { return prop.startsWith("active_") && originalFiltersData[prop]; });
        originalFiltersData.hover = filtersData.hover;

        originalFiltersData.selectedMinCruisePrice = filtersData.MinCruisePrice;
        originalFiltersData.selectedMaxCruisePrice = filtersData.MaxCruisePrice;


        originalFiltersData.OrderCruiseBy = filtersData.OrderCruiseBy;
        return originalFiltersData;
    }

    function _cruiseFilter(filtersData) {
        var orderlyData = thisModel.getOrderlyData();

        var cruiseOptions = _filterCruiseOptions(filtersData, orderlyData);
        cruiseOptions = _sortCruiseOptions(cruiseOptions, filtersData);

        var updatedFiltersData = _updateCruiseFiltersData(orderlyData.CruiseResponseData.CruiseFiltersData, filtersData, orderlyData);

        filteredData.CruiseResponseData = {
            CruiseOptions: cruiseOptions,
            CruiseFiltersData: updatedFiltersData,
            SearchData: orderlyData.SearchData
        };
    }

    function _sortCruiseOptions(cruiseOptions, filtersData) {

        // Maior PreÃ§o
        if (filtersData.OrderCruiseBy == 'priceHigh')
            cruiseOptions = cruiseOptions.orderByDescending(function (c) {
                if (Util.isTravelGo() && c.bestPriceInformations) {
                    return c.bestPriceInformations.TotalAmount.Value;
                } else {
                    return c.FareOptions.max(function (f) {
                        return f.AllSuperCategories.where(function (s) { return !s.isDisabled; }).max(function (s) {
                            return s && s.FareAmount && s.FareAmount.Value;
                        })
                    });
                }
            });

        // Menor PreÃ§o
        if (filtersData.OrderCruiseBy == 'priceLow')
            cruiseOptions = cruiseOptions.orderBy(function (c) {
                if (Util.isTravelGo() && c.bestPriceInformations) {
                    return c.bestPriceInformations.TotalAmount.Value;
                } else {
                    return c.FareOptions.min(function (f) {
                        return f.AllSuperCategories.where(function (s) { return !s.isDisabled; }).min(function (s) {
                            return s && s.FareAmount && s.FareAmount.Value;
                        })
                    })
                }
            });

        //Datas PrÃ³ximas
        if (filtersData.OrderCruiseBy == 'dateLow')
            cruiseOptions = cruiseOptions.orderBy(function (c) {
                if (c.bestPriceInformations) {
                    return formatter.dateValuesToDate(c.bestPriceInformations.EmbarkDate);
                } else {
                    return formatter.dateValuesToDate(c.Cruise.EmbarkDate);
                }
            });

        //Total de Noites ASC
        if (filtersData.OrderCruiseBy == 'nightLow')
            cruiseOptions = cruiseOptions.orderBy(function (c) {
                return c.Cruise.NumberOfNights;
            });

        //Total de Noites DESC
        if (filtersData.OrderCruiseBy == 'nightHigh')
            cruiseOptions = cruiseOptions.orderByDescending(function (c) {
                return c.Cruise.NumberOfNights;
            });

        return cruiseOptions;
    }

    this.getServiceCategories = function () {
        clientWS.invoke("GetServiceCategories", {
            req: {
                Culture: (Global && Global.Culture || "pt-BR"),
                GetServiceCategoriesRQ: {
                    Culture: (Global && Global.Culture || "pt-BR")
                }
            }
        }, controller.onGetServiceCategoriesCompleted, thisModel.onError);
    };

    this.getServicesByName = function (serviceName, serviceType) {
        if (lastInvoke)
            lastInvoke.abort();

        lastInvoke = clientWS.invoke("GetServicesByName", {
            req: {
                GetServicesByNameRQ: { ServiceName: serviceName, ServiceType: serviceType }
            }
        }, controller.onGetServicesByNameCompleted, thisModel.onError);
    };

    this.getPackagesByName = function (keyword) {
        if (lastInvoke)
            lastInvoke.abort();

        lastInvoke = clientWS.invoke("GetPackagesByName", { req: { Name: keyword } }, controller.onGetPackagesByNameCompleted, thisModel.onError);
    };

    this.getItinerariesByName = function (keyword) {
        if (lastInvoke)
            lastInvoke.abort();

        lastInvoke = clientWS.invoke("GetItinerariesByName", { req: { Name: keyword } }, controller.onGetItinerariesByNameCompleted, thisModel.onError);
    };

    this.getBrandedFares = function (req) {
        clientWS.invoke("GetBrandedFares", { req: req }, controller.onGetBrandedFaresCompleted, thisModel.onError);
    };

    this.getServiceById = function (serviceId) {
        if (lastInvoke)
            lastInvoke.abort();

        lastInvoke = clientWS.invoke("GetServiceById", { req: { GetServiceByIdRQ: { ServiceId: serviceId } } }, controller.onGetServiceByIdCompleted, thisModel.onError);
    };

    this.getRentalLocations = function (req) {
        clientWS.invoke("GetCarContent",
            { req: req },
            function (response) {
                response.Key = req.Key;
                controller.onGetRentalLocationsCompleted(response)
            },
            thisModel.onError);
    };

    this.getCarCompanies = function (req) {
        clientWS.invoke("GetCarContent",
            { req: req },
            function (response) { controller.onGetCarCompaniesCompleted(response) },
            thisModel.onError);
    };

    this.getCarContent = function (req) {
        clientWS.invoke("GetCarContent",
            { req: req },
            function (response) {

                if (req.AuxiliarData)
                    response.AuxiliarData = req.AuxiliarData;

                controller.onGetCarContentCompleted(response);
            },
            thisModel.onError);
    };

    this.getPackageLocations = function (req) {
        clientWS.invoke("GetPackageLocations",
            { req: req },
            controller.onGetPackageLocationsCompleted,
            thisModel.onError);
    };

    this.recalculateProductsByAirSelection = function (recommendation, priceGroup, daysStay, foreignData) {
        _functions.recalculateProducts.byAirSelection(recommendation, priceGroup, daysStay, foreignData);
    };

    this.recalculateProductsByHotelSelection = function (hotel, foreignData) {
        _functions.recalculateProducts.byHotelSelection(hotel, foreignData);
    };

    this.recalculateProductsByInsuranceSelection = function (insurance, foreignData) {
        _functions.recalculateProducts.byInsuranceSelection(insurance, foreignData);
    };

    this.getSearchRequest = function () {
        return searchRequest;
    };

    this.updateDataValue = function (newData, propertyName) {
        data[propertyName] = newData[propertyName];
    };

    this.updateHotels = function (newData) {
        mergeHotelResponse(newData);

        data.Hotels = newData.Hotels;

        _functions.calculatePackagePrice();
    };

    this.getSelectedPackage = function () {
        return selectedPackage;
    };

    this.setInsuranceLocation = function (insurance) {
        _functions.insurance.setLocation(insurance);
    }

    this.loadHotelLocations = function (req) {
        clientWS.invoke("GetHotelLocations", { req: req }, function (response) { response.req = req; _onLoadHotelLocations(response); }, thisModel.onError);
    };

    function _onLoadHotelLocations(res) {
        controller.onLoadHotelLocations(res);
    }

    function _validInsurancePrice(insurance, filterData) {
        if (filterData.MaxPoints > 0) {
            if (insurance.InsuranceOption.Loyalty && insurance.InsuranceOption.Loyalty.PointsValue)
                if (insurance.InsuranceOption.Loyalty.PointsValue >= filterData.MinPoints && insurance.InsuranceOption.Loyalty.PointsValue <= filterData.MaxPoints)
                    return true
        }
        else if (insurance.InsuranceOption.TotalAmount >= filterData.MinPrice && insurance.InsuranceOption.TotalAmount <= filterData.MaxPrice) {
            return true;
        }

        return false;
    }

    function _validInsuranceKeyword(insurance, filterData) {
        return !filterData.keyword || insurance.InsuranceOption.Description.normalizedContains(filterData.keyword) || insurance.InsuranceOption.Title.normalizedContains(filterData.keyword);
    }

    var _functions = {
        prepare: {
            searchResponse: {
                errors: function (response) {
                    if (!response.TravelEngineSearchRS)
                        response.TravelEngineSearchRS = {};

                    if (!response.TravelEngineSearchRS.Errors || !response.TravelEngineSearchRS.Errors.length)
                        response.TravelEngineSearchRS.Errors = response.Errors;
                }
            },
            prepareHotel: function (hotel) {

                hotel.Stars = Math.floor(hotel.Stars);

                if (hotel.Address) {
                    hotel.Address.NearestAirport = auxLocationsResponse[hotel.Address.NearestAirportId];
                    hotel.Address.DistanceToCenterCity = hotel.Address.DistanceToCenterCity == undefined ? 0 : hotel.Address.DistanceToCenterCity.normalize();
                    hotel.Address.DistanceToNearestAirport = hotel.Address.DistanceToNearestAirport == undefined ? 0 : hotel.Address.DistanceToNearestAirport.normalize();
                    hotel.Address.Location = auxLocationsResponse[hotel.Address.LocationId];
                }

                if (hotel.ChainIndex != null)
                    hotel.Chain = auxChainsResponse[hotel.ChainIndex];

                _functions.prepare.prepareSearchData(hotel);
                prepareHotelFakeRooms(hotel);

                hotel = new Hotel(hotel);

                return hotel;
            },
            prepareSearchData: function (hotel) {
                hotel.SearchData = {};
                var hotelSearchData = thisModel.getSearchData().HotelSearchData;
                if (hotelSearchData) {
                    hotel.SearchData.CheckInValues = hotelSearchData.CheckIn;
                    hotel.SearchData.CheckOutValues = hotelSearchData.CheckOut;
                }
                else {
                    var packageSearchData = thisModel.getSearchData().PackageSearchData;
                    if (packageSearchData) {
                        hotel.SearchData.CheckInValues = packageSearchData.BeginDepartureDateTime;
                        hotel.SearchData.CheckOutValues = packageSearchData.EndDepartureDateTime;
                        hotel.SearchData.RoomsRequest = packageSearchData.PackageRoomsRequest;
                        hotel.SearchData.RoomsRequest.foreach(function (r) { Util.prepareRoomRequestAges(r); })
                    }
                }
            },
            copyPriceGroupCityPairsOriginsAndDestinations: function (data) {
                if (data != undefined && data.AirResponseData != undefined && Util.HasCount(data.AirResponseData.PriceGroups)) {
                    data.AirResponseData.PriceGroups.forEach(function (priceGroup, index) {
                        if (priceGroup != undefined && Util.HasCount(priceGroup.CityPairs)) {
                            priceGroup.CityPairs.forEach(function (cityPair, cityPairIndex) {
                                cityPair.OriginalOrigin = cityPair.Origin;
                                cityPair.OriginalDestination = cityPair.Destination;
                            });
                        }
                    });
                }
            },
        },
        calculatePackagePrice: function () {
            if (showPackagePrice) {

                var sPackage = _functions.getSelectedPackage();

                if (sPackage && data.BestPricePackage
                    && data.BestPricePackage.Recommendation
                    && Util.HasCount(data.BestPricePackage.Hotels)) {

                    if (!sPackage.hotel)
                        sPackage.hotel = data.BestPricePackage.Hotels[0];

                    if (!sPackage.recommendation)
                        sPackage.recomendation = data.BestPricePackage.Recommendation;

                    if (!sPackage.priceGroup)
                        sPackage.priceGroup = data.BestPricePackage.PriceGroup;

                    _functions.recalculateProducts.bestPricePackage();
                }

                if (sPackage) {
                    if (sPackage.recommendation && sPackage.priceGroup)
                        _functions.recalculateProducts.byAirSelection(sPackage.recommendation, sPackage.priceGroup);

                    if (sPackage.hotel)
                        _functions.recalculateProducts.byHotelSelection(sPackage.hotel);
                }
            }
        },
        copy: {
            Air: {
                priceGroupWithoutFlightGroups: function (priceGroup) {

                    if (!priceGroup.OriginalCityPairs)
                        priceGroup.OriginalCityPairs = priceGroup.CityPairs;

                    for (var i = 0; i < priceGroup.OriginalCityPairs.length; i++)
                        if (!priceGroup.OriginalCityPairs[i].OriginalFlightGroups)
                            priceGroup.OriginalCityPairs[i].OriginalFlightGroups = priceGroup.OriginalCityPairs[i].FlightGroups;

                    for (var i = 0; i < priceGroup.CityPairs.length; i++) {
                        var cityPair = priceGroup.CityPairs[i];

                        cityPair.FlightGroups = [];


                    }

                    return priceGroup;
                }
            }
        },
        fillSearchDuration: function (data, startTime) {
            if (data.ExecutionStatistics && data.ExecutionStatistics.ExecutionTimes) {
                data.ExecutionStatistics.ExecutionTimes.push({
                    Key: 'SearchDuration',
                    Value: parseInt(performance.now() - startTime)
                });
            }
        },
        filter: {
            flight: {
                prepareFilterDataForMultiDestination: function (cityPair, filtersData) {
                    if (filtersData.MultiDestination && Util.isNotNullOrWhiteSpace(cityPair.OriginalOrigin) && Util.isNotNullOrWhiteSpace(cityPair.OriginalDestination)) {
                        var cityPairName = cityPair.OriginalOrigin + cityPair.OriginalDestination;
                        var filtersDataCityPair = filtersData.CityPairs.first(function (cp) { return cp.Name == cityPairName; });

                        if (filtersDataCityPair != undefined) {
                            filtersData.AirportsInbound = filtersDataCityPair.AirportsInbound;
                            filtersData.AirportsOutbound = filtersDataCityPair.AirportsOutbound;
                            filtersData.MinArrivalTime = filtersDataCityPair.MinArrivalTime;
                            filtersData.MaxArrivalTime = filtersDataCityPair.MaxArrivalTime;
                            filtersData.MinDepartureTime = filtersDataCityPair.MinDepartureTime;
                            filtersData.MaxDepartureTime = filtersDataCityPair.MaxDepartureTime;
                            filtersData.MinDuration = filtersDataCityPair.MinDuration;
                            filtersData.MaxDuration = filtersDataCityPair.MaxDuration;
                            filtersData.MinOutboundDuration = filtersDataCityPair.MinOutboundDuration;
                            filtersData.MaxOutboundDuration = filtersDataCityPair.MaxOutboundDuration;
                            filtersData.MinInboundDuration = filtersDataCityPair.MinInboundDuration;
                            filtersData.MaxInboundDuration = filtersDataCityPair.MaxInboundDuration;
                            filtersData.MinOutboundTime = filtersDataCityPair.MinOutboundTime;
                            filtersData.MaxOutboundTime = filtersDataCityPair.MaxOutboundTime;
                            filtersData.MinInboundTime = filtersDataCityPair.MinInboundTime;
                            filtersData.MaxInboundTime = filtersDataCityPair.MaxInboundTime;
                        }
                    }
                },
            },
            Hotel: {
                byStayOptions: {
                    createStayOptionsFilter: function (hotelFilterData) {
                        if (hotelFilterData && hotelFilterData.StayOptionsFilter) {
                            if (hotelFilterData.StayOptionsFilter.FlightGroups) {
                                var daysStay = FlightGroupExtensions.Functions.getDaysStayBySelectedAir(hotelFilterData.StayOptionsFilter.FlightGroups);
                                hotelFilterData.StayOptionsFilter.MinStayOption = daysStay;
                                hotelFilterData.StayOptionsFilter.MaxStayOption = daysStay;
                                return true;
                            }
                        }
                        return false;
                    }
                }
            },
            Insurance: function (filterData) {
                var filteredInsurances = [];

                if (filterData) {
                    var orderlyData = thisModel.getOrderlyData();

                    filteredInsurances = orderlyData.Insurances.where(function (insurance) {
                        return insurance
                            && insurance.InsuranceOption
                            && _validInsurancePrice(insurance, filterData)
                            && _validInsuranceKeyword(insurance, filterData);
                    });
                }

                filteredData.Insurances = filteredInsurances;
            },
        },
        getSelectedPackage: function () {
            return controller.getSelectedPackage();
        },
        insurance: {
            getInsurances: function () {
                if (filteredData && filteredData.Insurances) {
                    return filteredData.Insurances;
                } else if (data && data.Insurances) {
                    return data.Insurances;
                }
            },
            getInsuranceById: function (id) {
                var insurances = _functions.insurance.getInsurances();
                var insurance = id && Util.isValidNumber(id) && id > 0 && Util.HasCount(insurances)
                    ? insurances.first(function (i) { return i.InsuranceOption.Id == id; })
                    : undefined;

                return _functions.insurance.setLocation(insurance);
            },
            getInsuranceByArrayIndex: function (index) {
                var insurances = _functions.insurance.getInsurances();
                var insurance = index && Util.isValidNumber(index) && data && Util.HasCount(insurances) && insurances.length > index
                    ? insurances[index]
                    : undefined;

                return _functions.insurance.setLocation(insurance);
            },
            setLocation: function (insurance) {
                if (insurance && !insurance.Location && searchData && searchData.InsuranceSearchData) {
                    insurance.Location = searchData.InsuranceSearchData.Location;
                }

                return insurance;
            },
        },
        mergeInsuranceResponse: function (response) {
            if (response && response.InsuranceResponseData && Util.HasCount(response.InsuranceResponseData.Insurances)) {
                var allInsurances = response.InsuranceResponseData.Insurances.concat(auxInsuranceResponse);
                var insurancesFiltered = [];

                $.each(allInsurances, function (index, insurance) {
                    var insuranceFound = insurancesFiltered.first(function (ins) {
                        return ins.DestinationCode == insurance.DestinationCode
                            && ins.InsuranceOption.SourceType == insurance.InsuranceOption.SourceType
                            && ins.InsuranceOption.ProductCode == insurance.InsuranceOption.ProductCode
                            && ins.InsuranceOption.FareCode == insurance.InsuranceOption.FareCode;
                    });

                    if (!insuranceFound)
                        insurancesFiltered.push(insurance);
                });

                response.InsuranceResponseData.Insurances = insurancesFiltered.orderBy(function (insurance) { return insurance.TotalAmount; });
                response.Insurances = response.InsuranceResponseData.Insurances;

                auxInsuranceResponse = response.InsuranceResponseData.Insurances;
            }
        },
        recalculateProducts: {
            all: function (foreignData) {
                _functions.recalculateProducts.recalculateSelectedPackage();
                var hotelPrice = _functions.recalculateProducts.Hotel.getHotelPrice() || 0;
                var airPrice = _functions.recalculateProducts.Air.getAirPrice() || 0;
                var insurancePrice = _functions.recalculateProducts.Insurance.getInsurancePrice() || 0;

                if ([airPrice, hotelPrice, insurancePrice].count(function (price) { return price > 0; }) > 1) {
                    var hotelAdditionalPrice = airPrice + insurancePrice;
                    var airAdditionaPrice = hotelPrice + insurancePrice;
                    var insuranceAdditionalPrice = airPrice + hotelPrice;

                    _functions.recalculateProducts.Hotel.recalculateHotels(hotelAdditionalPrice, data);
                    _functions.recalculateProducts.Hotel.recalculateHotels(hotelAdditionalPrice, foreignData);

                    _functions.recalculateProducts.Hotel.recalculateHotelFilter(data);
                    _functions.recalculateProducts.Hotel.recalculateHotelFilter(foreignData);

                    _functions.recalculateProducts.Air.recalculatePriceGroups(airAdditionaPrice, data);
                    _functions.recalculateProducts.Air.recalculatePriceGroups(airAdditionaPrice, foreignData);

                    _functions.recalculateProducts.Air.recalculateRecommendations(airAdditionaPrice, data);
                    _functions.recalculateProducts.Air.recalculateRecommendations(airAdditionaPrice, foreignData);

                    _functions.recalculateProducts.Air.recalculateAirFilter(data);
                    _functions.recalculateProducts.Air.recalculateAirFilter(foreignData);

                    _functions.recalculateProducts.Insurance.recalculateInsurances(insuranceAdditionalPrice, data);
                    _functions.recalculateProducts.Insurance.recalculateInsurances(insuranceAdditionalPrice, foreignData);

                    _functions.recalculateProducts.Insurance.recalculateFilter(data);
                    _functions.recalculateProducts.Insurance.recalculateFilter(foreignData);
                }
            },
            byAirSelection: function (recommendation, priceGroup, daysStay, foreignData) {
                var sPackage = _functions.getSelectedPackage();

                sPackage.recommendation = recommendation;
                sPackage.priceGroup = priceGroup;
                sPackage.daysStay = daysStay;

                _functions.recalculateProducts.all(foreignData);
            },
            byHotelSelection: function (hotel, foreignData) {
                var sPackage = _functions.getSelectedPackage();

                sPackage.hotel = hotel;

                _functions.recalculateProducts.all(foreignData);
            },
            byInsuranceSelection: function (insurance, foreignData) {
                var sPackage = _functions.getSelectedPackage();

                sPackage.insurance = insurance;

                _functions.recalculateProducts.all(foreignData);
            },
            bestPricePackage: function () {
                if (data && data.BestPricePackage) {
                    var airPrice = _functions.recalculateProducts.Air.getAirPrice() || 0;
                    var hotelPrice = _functions.recalculateProducts.Hotel.getHotelPrice() || 0;
                    var insurancePrice = _functions.recalculateProducts.Insurance.getInsurancePrice() || 0;

                    var needUpdateHotelPrices = airPrice || insurancePrice;
                    var needUpdateAirPrices = hotelPrice || insurancePrice;
                    var needUpdateInsurancePrices = airPrice || hotelPrice;
                    var otherProductsPrice = airPrice + insurancePrice;

                    if (needUpdateHotelPrices && Util.HasCount(data.BestPricePackage.Hotels))
                        _functions.recalculateProducts.Hotel.recalculateHotel(otherProductsPrice, data.BestPricePackage.Hotels[0]);

                    if (needUpdateAirPrices) {
                        otherProductsPrice = hotelPrice + insurancePrice;

                        if (data.BestPricePackage.Recommendation) {
                            _functions.recalculateProducts.Air.recalculateRecommendation(data.BestPricePackage.Recommendation, otherProductsPrice);
                        }

                        if (data.BestPricePackage.PriceGroup) {
                            _functions.recalculateProducts.Air.recalculatePriceGroup(data.BestPricePackage.PriceGroup, otherProductsPrice);
                        }
                    }

                    if (needUpdateInsurancePrices) {
                        otherProductsPrice = airPrice + hotelPrice;

                        if (Util.HasCount(data.BestPricePackage.Insurances))
                            _functions.recalculateProducts.Insurance.recalculateInsurance(otherProductsPrice, data.BestPricePackage.Insurances[0]);

                        if (data.BestPricePackage.Insurance)
                            _functions.recalculateProducts.Insurance.recalculateInsurance(otherProductsPrice, data.BestPricePackage.Insurance);
                    }
                }
            },
            recalculateSelectedPackage: function () {
                var hotelPrice = _functions.recalculateProducts.Hotel.getHotelPrice();
                var airPrice = _functions.recalculateProducts.Air.getAirPrice();
                var insurancePrice = _functions.recalculateProducts.Insurance.getInsurancePrice();

                var sPackage = _functions.getSelectedPackage();

                sPackage.TotalAmount = hotelPrice + airPrice + insurancePrice;
            },
            Hotel: {
                Room: {
                    reSelectRoomStayOptions: function (room, checkInDay, checkOutDay) {
                        var correspondingStayOption = room.StayOptions.first(

                            function (stay) {
                                return stay.CheckInValues.Day == checkInDay && (!checkOutDay || stay.CheckOutValues.Day == checkOutDay)
                            }
                        );

                        if (correspondingStayOption) {

                            room.StayOptions.foreach(
                                function (s) {
                                    s.Selected = false
                                }
                            );

                            correspondingStayOption.Selected = true;
                        }
                    },
                    reSelectRoomGroupStayOptions: function (roomGroup, checkInDay, checkOutDay) {
                        roomGroup.Rooms.foreach(
                            function (room) {
                                _functions.recalculateProducts.Hotel.Room.reSelectRoomStayOptions(room, checkInDay, checkOutDay);

                            }
                        );
                    }
                },
                recalculateOnHotelDetail: function (hotel) {
                    var airPrice = _functions.recalculateProducts.Air.getAirPrice() || 0;
                    var insurancePrice = _functions.recalculateProducts.Insurance.getInsurancePrice() || 0;

                    if (airPrice || insurancePrice)
                        _functions.recalculateProducts.Hotel.recalculateHotel((airPrice + insurancePrice), hotel);
                },
                recalculateHotels: function (otherProductsPrice, data) {
                    if (otherProductsPrice && data && Util.HasCount(data.Hotels)) {
                        for (var h = 0; h < data.Hotels.length; h++) {
                            var hotel = data.Hotels[h];
                            _functions.recalculateProducts.Hotel.recalculateHotel(otherProductsPrice, hotel);
                        }

                        data.Hotels = data.Hotels.orderBy(function (h) {
                            return (h.AuxiliarData && h.AuxiliarData.PackagePrice) || 0;
                        });
                    }
                },
                reSelectHotelStayOptions: function (hotel) {

                    if (data.Recommendations.hasCount()) {
                        var roomsGroups = hotel.RoomsGroups;

                        var recommendation = null;

                        if (data.BestPricePackage && data.BestPricePackage.Recommendation) {
                            recommendation = data.BestPricePackage.Recommendation;

                        } else {
                            var recommendation = data.Recommendations.getItemByMin(function (r) { return r.DisplayTotalAmount; }); //Pelo preÃ§o

                            var recommendations = data.Recommendations.where(function (r) { return r.DisplayTotalAmount == recommendation.DisplayTotalAmount; });

                            recommendation = recommendations.getItemByMin(function (r) { return r.FlightGroups[0].OriginalFlightGroup.LastArrivalTimeValues.Day; }); //Pelo HorÃ¡rio
                        }

                        var checkInDay = recommendation.FlightGroups.first().OriginalFlightGroup.LastArrivalTimeValues.Day;
                        var checkOutDay = recommendation.FlightGroups.length > 1 ? recommendation.FlightGroups.last().OriginalFlightGroup.FirstDepartureTimeValues.Day : null;

                        if (checkInDay) {
                            roomsGroups.foreach(
                                function (roomGroup) {
                                    _functions.recalculateProducts.Hotel.Room.reSelectRoomGroupStayOptions(roomGroup, checkInDay, checkOutDay);

                                }
                            );
                        }
                    }
                },
                recalculateHotel: function (otherProductsPrice, hotel) {
                    hotel.AuxiliarData.PackagePrice = otherProductsPrice + hotel.AuxiliarData.TotalAmount;
                    if (Util.HasCount(hotel.RoomsGroups)) {
                        _functions.recalculateProducts.Hotel.recalculateRoomGroup(otherProductsPrice, hotel);
                    }
                },
                recalculateRoomGroup: function (otherProductsPrice, hotel) {
                    hotel.RoomsGroups.foreach(function (roomGroup) {
                        var siblingsSum = hotel.RoomsGroups.sum(function (rg) {
                            var price = 0;
                            if (roomGroup != rg) {
                                var selectedRoom = _functions.recalculateProducts.Hotel.getSelectedOrFirstRoom(rg.Rooms);
                                price = selectedRoom.AuxiliarData.TotalAmount;
                            }
                            return price;
                        });

                        var sPackage = _functions.getSelectedPackage();

                        roomGroup.Rooms.foreach(function (r) {
                            r.AuxiliarData.StayOption.AuxiliarData.PackagePriceWithoutMyPrice = Math.round(otherProductsPrice, 2);
                            r.AuxiliarData.StayOption.AuxiliarData.PackagePrice = Math.round(siblingsSum + otherProductsPrice + r.AuxiliarData.StayOption.AuxiliarData.TotalAmountNonFormatted, 2);
                            r.AuxiliarData.StayOption.AuxiliarData.PackagePriceDifference = Math.round(r.AuxiliarData.StayOption.AuxiliarData.PackagePrice - sPackage.TotalAmount, 2);
                        });
                    });

                    if (hotel.AuxiliarData && hotel.RoomsGroups.length) {
                        hotel.AuxiliarData.PackagePriceWithoutMyPrice = Math.round(hotel.RoomsGroups[0].Rooms[0].AuxiliarData.StayOption.AuxiliarData.PackagePriceWithoutMyPrice, 2);
                        hotel.AuxiliarData.PackagePrice = Math.round(hotel.RoomsGroups[0].Rooms[0].AuxiliarData.StayOption.AuxiliarData.PackagePrice, 2);
                        hotel.AuxiliarData.PackagePriceDifference = Math.round(hotel.RoomsGroups[0].Rooms[0].AuxiliarData.StayOption.AuxiliarData.PackagePriceDifference, 2);
                    }
                },
                recalculateHotelFilter: function (data) {
                    if (data && data.HotelFiltersData) {
                        if (!data.HotelFiltersData.OriginalMinPrice)
                            data.HotelFiltersData.OriginalMinPrice = data.HotelFiltersData.MinPrice;

                        if (!data.HotelFiltersData.OriginalMaxPrice)
                            data.HotelFiltersData.OriginalMaxPrice = data.HotelFiltersData.MaxPrice;

                        data.HotelFiltersData.PackagePriceWithoutHotel = 0;

                        data.HotelFiltersData.DaysCount = 1;

                        if (data.Hotels && data.Hotels.length) {
                            data.HotelFiltersData.PackagePriceWithoutHotel = (data.Hotels[0].AuxiliarData.PackagePriceWithoutMyPrice || 0);
                            data.HotelFiltersData.DaysCount = parseInt(data.Hotels[0].AuxiliarData.DaysCount || "0");
                        }

                        data.HotelFiltersData.MinPrice = data.HotelFiltersData.PackagePriceWithoutHotel + (data.HotelFiltersData.OriginalMinPrice * data.HotelFiltersData.DaysCount);
                        data.HotelFiltersData.MaxPrice = data.HotelFiltersData.PackagePriceWithoutHotel + (data.HotelFiltersData.OriginalMaxPrice * data.HotelFiltersData.DaysCount);
                    }
                },
                getSelectedOrFirstRoom: function (rooms) {
                    var selectedRoom = rooms.first(function (r) { return r.StayOptions.any(function (so) { return so.selected == true; }); });
                    if (!selectedRoom)
                        selectedRoom = rooms.first();
                    return selectedRoom;
                },
                getHotelPrice: function () {

                    var sPackage = _functions.getSelectedPackage();

                    if (sPackage.hotel)
                        return sPackage.hotel.getSelectedTotalAmount().normalize();

                    return undefined;
                }
            },
            Air: {
                getRecommendationIndexes: function (priceGroup, flightGroups) {
                    var recommendationIndexes = [];

                    for (var i = 0; i < priceGroup.CityPairs.length; i++) {
                        var actualCityPair = priceGroup.CityPairs[i];

                        for (var j = 0; j < flightGroups.length; j++) {
                            var actualFlightGroupIndex = actualCityPair.FlightGroups.indexOf(flightGroups[j]);
                            if (actualCityPair.OriginalFlightGroups && actualCityPair.OriginalFlightGroups.length)
                                actualFlightGroupIndex = actualCityPair.OriginalFlightGroups.indexOf(flightGroups[i]);

                            if (actualFlightGroupIndex != -1)
                                recommendationIndexes = recommendationIndexes.concat(actualCityPair.FlightGroupsReference[actualFlightGroupIndex].RecommendationIndexes)
                        }
                    }

                    return recommendationIndexes;
                },
                getIntersectionRecommendationIndex: function (recommendationIndexes) {
                    var intersectionRecommendationIndex = undefined;
                    var foundRecommendationIndex = false;

                    for (var i = 0; i < recommendationIndexes[0].length; i++) {
                        var recIndexInbound = recommendationIndexes[0][i];

                        if (foundRecommendationIndex)
                            break;

                        for (var j = 0; j < recommendationIndexes[1].length; j++) {
                            var recIndexOutbound = recommendationIndexes[1][j];

                            if (recIndexInbound == recIndexOutbound) {
                                intersectionRecommendationIndex = recIndexInbound;
                                foundRecommendationIndex = true;
                                break;
                            }
                        }
                    }

                    return intersectionRecommendationIndex;
                },
                updateFlightGroups: function (flightGroups, recommendation, selectedBrandedFare, intersectionRecommendationIndex) {

                    var groupedFlightGroups = flightGroups.groupByWithoutKey(function (f) { return f.Hash; });

                    for (var i = 0; i < groupedFlightGroups.length; i++) {

                        var _flightGroups = groupedFlightGroups[i];

                        for (var j = 0; j < _flightGroups.length; j++) {

                            if (selectedBrandedFare)
                                _flightGroups[j].FareOption = selectedBrandedFare.FareOptions[i];

                            if (intersectionRecommendationIndex != undefined)
                                _flightGroups[j].RecommendationIndexes = [intersectionRecommendationIndex];
                        }
                    }
                },
                recalculateRecommendations: function (otherProductsPrice, data) {
                    if (data && Util.HasCount(data.Recommendations)) {
                        data.Recommendations.foreach(function (r) {
                            _functions.recalculateProducts.Air.recalculateRecommendation(r, otherProductsPrice);
                        });
                    }
                },
                recalculateRecommendation: function (r, otherProductsPrice) {
                    var sPackage = _functions.getSelectedPackage();

                    r.PackagePrice = Math.round((r.TotalAmount * _functions.recalculateProducts.Air.getPaxQuantity()) + otherProductsPrice, 2);
                    r.PackagePriceDifference = Math.round(r.PackagePrice - sPackage.TotalAmount, 2);
                },
                recalculatePriceGroups: function (otherProductsPrice, data) {
                    if (data && Util.HasCount(data.PriceGroups)) {
                        data.PriceGroups.foreach(function (p) {
                            _functions.recalculateProducts.Air.recalculatePriceGroup(p, otherProductsPrice);
                        });
                    }
                },
                recalculatePriceGroup: function (p, otherProductsPrice) {
                    var sPackage = _functions.getSelectedPackage();

                    p.PackagePrice = (p.Price * _functions.recalculateProducts.Air.getPaxQuantity()) + otherProductsPrice;

                    p.PackagePriceDifference = p.PackagePrice - sPackage.TotalAmount;
                },
                recalculateAirFilter: function (data) {
                    if (data && data.AirFiltersData) {
                        if (data.Recommendations[0].PackagePrice)
                            data.AirFiltersData.MinPrice = data.Recommendations[0].PackagePrice;

                        if (data.Recommendations[data.Recommendations.length - 1].PackagePrice)
                            data.AirFiltersData.MaxPrice = data.Recommendations[data.Recommendations.length - 1].PackagePrice;
                    }
                },
                getAirPrice: function () {
                    var airPrice = _functions.recalculateProducts.Air.getPriceGroupPrice();
                    if (!airPrice)
                        airPrice = _functions.recalculateProducts.Air.getRecommendation();
                    if (airPrice)
                        return (airPrice * _functions.recalculateProducts.Air.getPaxQuantity()).normalize();
                    else
                        return null;
                },
                getPriceGroupPrice: function () {
                    var sPackage = _functions.getSelectedPackage();

                    if (sPackage.priceGroup) {
                        return sPackage.priceGroup.Price;
                    }
                    return undefined;
                },
                getRecommendation: function () {

                    var sPackage = _functions.getSelectedPackage();

                    if (sPackage.recommendation) {
                        if (sPackage.recommendation.B2BExtension) {
                            return sPackage.recommendation.B2BExtension.PointsMoney;
                        } else {
                            return sPackage.recommendation.TotalAmount;
                        }
                    }
                    return undefined;
                },
                getPaxQuantity: function () {

                    if (data.SearchData && data.SearchData.AirSearchData)
                        return data.SearchData.AirSearchData.NumberADTs + data.SearchData.AirSearchData.NumberCHDs + data.SearchData.AirSearchData.NumberINFs;

                    return 1;
                }
            },
            Insurance: {
                getInsurancePrice: function () {
                    var price = 0;
                    var sPackage = _functions.getSelectedPackage();

                    if (sPackage && sPackage.insurance && sPackage.insurance.InsuranceOption) {
                        price = sPackage.insurance.InsuranceOption.TotalAmount;
                    }

                    return price;
                },
                getPaxQuantity: function () {
                    return data.SearchData && data.SearchData.InsuranceSearchData
                        ? data.SearchData.InsuranceSearchData.PassengerAges.length
                        : 1;
                },
                recalculateFilter: function (data) {
                    if (data && data.InsuranceFiltersData && data.Insurances) {
                        var insurances = data.Insurances.where(function (i) { return !isNaN(i.PackagePrice); });

                        if (Util.HasCount(insurances)) {
                            data.InsuranceFiltersData.MinPrice = insurances.min(function (i) { return i.PackagePrice; });
                            data.InsuranceFiltersData.MaxPrice = insurances.max(function (i) { return i.PackagePrice; });
                        }
                    }
                },
                recalculateInsurance: function (otherProductsPrice, insurance) {
                    var selectedPackage = _functions.getSelectedPackage();

                    if (selectedPackage) {
                        insurance.PackagePrice = Math.round((insurance.TotalAmount * _functions.recalculateProducts.Insurance.getPaxQuantity()) + otherProductsPrice, 2);
                        insurance.PackagePriceDifference = Math.round(insurance.PackagePrice - selectedPackage.TotalAmount, 2);
                    }
                },
                recalculateInsurances: function (otherProductsPrice, data) {
                    if (data && Util.HasCount(data.Insurances)) {
                        data.Insurances.foreach(function (i) {
                            _functions.recalculateProducts.Insurance.recalculateInsurance(i, otherProductsPrice);
                        });
                    }
                },
            }
        },
    };
}

ï»¿/// <reference path="../Libraries/Formatters.js" />
/// <reference path="../Libraries/ServiceCaller.js" />
/// <reference path="../Libraries/Util.js" />
/// <reference path="../Libraries/Prototypes.js" />

function LocationsModel(locationsController) {

    var controller = locationsController;

    var thisModel = this;
    var lastInvoke = undefined;

    var clientWS = new ServiceCaller(Global.PathWebService);

    this.startSearch = function (_req) {        
        if (lastInvoke)
            lastInvoke.abort();

        lastInvoke = clientWS.invoke("FindLocations", { req: _req }, thisModel.onSearchCompleted, thisModel.onError);
    }

    this.startSearchByGeolocation = function (_request) {
        if (lastInvoke)
            lastInvoke.abort();

        lastInvoke = clientWS.invoke("SearchNearestAirportByGeolocation", { request: _request }, thisModel.onSearchByGeolocationCompleted, thisModel.onError);
    }

    this.LoadLocationByIata = function (iata, culture, product) {
        clientWS.invoke("LoadLocationByIata", { Iata: iata, culture: culture, product: product }, thisModel.onLoadLocationByIataComplete, thisModel.onError);
    }

    this.startSaveSteps = function (_req) {
        clientWS.invoke("SearchStepSave", { req: _req }, function (response) { }, thisModel.onError);
    }

    this.onSearchByGeolocationCompleted = function (response) {
        if (response.Errors && response.Errors.length > 0)
            thisModel.onError(response);
        else {
            lastInvoke = undefined;
            controller.onSearchByGeolocationCompleted(response);
        }
    }

    this.onSearchCompleted = function (response) {
        if (response.Errors && response.Errors.length > 0)
            thisModel.onError(response);
        else {
            lastInvoke = undefined;
            controller.onSearchCompleted(response);
        }
    }

    this.onLoadLocationByIataComplete = function (response) {
        controller.onLoadLocationByIataComplete(response);
    }

    this.abort = function () {
        if (lastInvoke)
            lastInvoke.abort();
    }

    this.onError = function (response, callback) {
        if (response && response.Errors && response.Errors.length) {
            if (Global && Global.HandleErrors) {
                Global.HandleErrors(response);
            }
            Global.MessagesController.notifyMessages(response.Errors, EnumHelper.MessagesExhibitor.ExhibitionType.Dialog);
        }

        if (callback) {
            var res = response;
            if (response && response.HtmlResponse) {
                res.Errors = [];
                res.Errors.push('Ocorreram erros na chamada do serviÃ§o. Verifique o envelope de Request.')
            }

            callback(res);
        }
    };

    this.loadLocationById = function (req) {
        clientWS.invoke("LoadLocationsById", { req: req }, function (response) { response.req = req; _onLoadLocationById(response); }, thisModel.onError);
    }

    function _onLoadLocationById(res) {
        controller.onLoadLocationById(res);
    }
}

ï»¿/// <reference path="Event.js" />
/// <reference path="../Models/SearchModel.js" />

function LocationsController (params) {

    if (Global && Global.LocationsController) return Global.LocationsController;
    
    var thisController = this;

    this.searchCompleted = new Event();
    this.searchByGeolocationCompleted = new Event();
    this.loadLocationByIdCompleted = new Event();
    this.LoadLocationByIataCompleted = new Event();
    var searchModel = new LocationsModel(this);

    this.search = function (req) {
        searchModel.startSearch(req);
    }

    this.LoadLocationByIata = function (iata, culture, product) {
        searchModel.LoadLocationByIata(iata, culture, product);
    }

    this.saveSteps = function (req) {
        searchModel.startSaveSteps(req);
    }

    this.searchByGeolocation = function (request) {
        searchModel.startSearchByGeolocation(request);
    }

    this.onSearchByGeolocationCompleted = function (response) {
        thisController.searchByGeolocationCompleted.notify(response);
    }

    this.onSearchCompleted = function (res) {
        thisController.searchCompleted.notify(res);
    }

    this.onLoadLocationByIataComplete = function (res) {
        thisController.LoadLocationByIataCompleted.notify(res);
    }

    this.abort = function () {
        searchModel.abort();
    }

    this.loadLocationById = function (req) {
        searchModel.loadLocationById(req);
    }

    this.onLoadLocationById = function (res) {
        thisController.loadLocationByIdCompleted.notify(res);
    }

    var settings = { "Global": undefined };

    $.extend(true, settings, params || {});

    if (!settings.Global) {
        if (!Global)
           Global = {};

        if (!Global.LocationsController)
            Global.LocationsController = this;

        return Global.LocationsController;
    }
    else {
        params.Global.LocationsController = this;
        return params.Global.LocationsController;
    }
}


ï»¿/// <reference path="event.js" />

function MessagesController(params) {

    var thisMessageController = this;

    this.onMessages = new Event();
    this.onMessage = new Event();
    this.onCloseExhibitor = new Event();
    this.onHide = new Event();

    this.notifyMessages = function (messages, exhibitionType, messageType, ignoreMessagesCodeList) {
        var thisMessages = [];

        if (ignoreMessagesCodeList && ignoreMessagesCodeList.length > 0) {
            var condition = function (e) {
                return ignoreMessagesCodeList.any(function (codeMessage) {
                    return codeMessage != e.MessageCode;
                });
            }
            messages = messages.where(function (message) { return condition(message); });
        }

        if (messages.length > 0) {
            var serviceErros = messages.where(function (e) { return e.ErrorMessage || e.FriendlyMessage; });
            var clientMessages = messages.where(function (e) { return !(e.ErrorMessage || e.FriendlyMessage); });

            if (serviceErros.length) {
                var auxMessages = serviceErros.where(function (e) {
                    return e.FriendlyMessage
                }).select(function (e) {
                    var message = e.FriendlyMessage;
                    if (!settings.ShowOnlyFriendlyMessage) {
                        var errorMessage = Util.RemoveStackTraceFromErrorMessage(e.ErrorMessage);

                        if (errorMessage && !errorMessage.normalizedContains(e.FriendlyMessage))
                            message = Util.StringFormat("{0}: {1}", e.FriendlyMessage, errorMessage);
                    }

                    return message;
                });

                if (!auxMessages.length)
                    auxMessages = serviceErros.where(function (e) { return e.ErrorMessage }).select(function (e) { return Util.RemoveStackTraceFromErrorMessage(e.ErrorMessage); });

                serviceErros = auxMessages;

                if (!exhibitionType)
                    exhibitionType = EnumHelper.MessagesExhibitor.Type.Message;

                thisMessages = thisMessages.concat(serviceErros);
            }

            if (cultureResource && clientMessages.length) {

                if (exhibitionType) {
                    var messageTypeToken = "MessageType_" + Util.MessagesExhibitionTypeResolver(exhibitionType);
                    thisMessages = cultureResource[messageTypeToken] ? [messageTypeToken] : [];
                }

                thisMessages = thisMessages.concat(Util.Clone(clientMessages));

                for (var i = 0, messagesLen = thisMessages.length; i < messagesLen; i++) {
                    var token = thisMessages[i];

                    var messageArguments = undefined;

                    if ($.isArray(token)) {
                        token = thisMessages[i][0];
                        messageArguments = thisMessages[i].slice(1);
                    }

                    var message = cultureResource[token];

                    if (message) {
                        if (messageArguments)
                            message = message.format(messageArguments);

                        thisMessages[i] = message;
                    }
                    else {
                        thisMessages[i] = token;

                        if (typeof (console) != "undefined")
                            console.log("\"" + token + "\" was not found!");
                    }
                }

                thisMessages.clearUndefined();
            }

            thisMessageController.onMessages.notify(thisMessages, exhibitionType, messageType);
        }
        else {
            thisMessageController.onHide.notify();
        }

        return thisMessages;
    }

    this.notifyMessage = function (message) {
        thisMessageController.onMessage.notify(message);
    }

    this.closeExhibitor = function (data) {
        thisMessageController.onCloseExhibitor.notify(data);
    }

    this.notifyHideMessages = function () {
        thisMessageController.onHide.notify();
    }

    var settings = { "Global": undefined, ShowOnlyFriendlyMessage: false };

    if (!$)
        $ = jQuery;
    $.extend(true, settings, params || {});

    if (!settings.Global) {
        if (!Global) Global = {};

        if (!Global.MessagesController)
            Global.MessagesController = this;

        return Global.MessagesController;
    }
    else {
        params.Global.MessagesController = this;
        return params.Global.MessagesController;
    }
};


/// <reference path="Event.js" />
/// <reference path="../Models/SearchModel.js" />

function SearchController(params) {

    if (!(params && params.Global) && Global && Global.SearchController)
        return Global.SearchController;

    var searchModel = new SearchModel(this);

    var thisController = this;

    var lastChangePackageType = undefined;

    this.savePreOrderStarting = new Event();
    this.savePreOrderCompleted = new Event();
    this.savePreOrderError = new Event();

    this.filterStarting = new Event();
    this.filterChanged = new Event();
    this.filterCompleted = new Event();
    this.filterReseting = new Event();

    this.searchCompleted = new Event();
    this.searchStarting = new Event();
    this.searchUpdated = new Event();

    this.getCachedSearchStarting = new Event();
    this.getCachedSearchCompleted = new Event();

    this.budgetModeStarting = new Event();
    this.budgetModeCompleted = new Event();

    this.paginateStarting = new Event();
    this.paginateCompleted = new Event();

    this.selectedToBudget = new Event();

    this.budgetModeStarting = new Event();
    this.budgetModeCompleted = new Event();

    this.selectedToBudget = new Event();

    this.changePackageStarting = new Event();
    this.changePackageCompleted = new Event();

    this.getCategoriesStarting = new Event();
    this.getCategoriesCompleted = new Event();

    this.errorRaised = new Event();

    this.ongetWPHotelImages = new Event();

    this.getWPCruiseShipDetailsCompleted = new Event();
    this.getWPCruisePortDetailsCompleted = new Event();
    this.getWPCruiseShipSubpagesCompleted = new Event();
    this.getWPCruiseRestaurantsCompleted = new Event();
    this.getWPCruiseShipBarsAndLoungesCompleted = new Event();
    this.getWPCruiseShipEntertainmentsCompleted = new Event();


    this.hotelDetailsStarting = new Event();
    this.hotelDetailsExternalPage = new Event();
    this.hotelDetailsTransactionPage = new Event();
    this.hotelDetailsCompleted = new Event();

    this.hotelDetailsIFrame = new Event();

    this.packageDetailsStarting = new Event();
    this.packageDetailsCompleted = new Event();

    this.packageCalendarStarting = new Event();
    this.packageCalendarCompleted = new Event();

    this.onSort = new Event();
    this.sortStarting = new Event();
    this.sortCompleted = new Event();

    this.hotelDailyFaresStarting = new Event();
    this.hotelDailyFaresCompleted = new Event();

    this.hotelImagesDetailsStarting = new Event();
    this.hotelImagesDetailsCompleted = new Event();

    this.hotelMapDetailsStarting = new Event();
    this.hotelMapDetailsCompleted = new Event();

    this.eventDetailsCompleted = new Event();
    this.eventDetailsStarting = new Event();

    this.hotelsRendered = new Event();
    this.hotelsValuesUpdated = new Event();

    this.getHotelsPointsStarting = new Event();
    this.getHotelsPointsCompleted = new Event();
    this.errorHotelsPointsRaised = new Event();

    this.priceGroupsValuesUpdated = new Event();
    this.recommendationsValuesUpdated = new Event();
    this.onChangeSelectedPackage = new Event();

    this.onShowSearchMotor = new Event();
    this.onHideSearchMotor = new Event();
    this.onShowSearchResult = new Event();
    this.onHideSearchResult = new Event();
    this.onClearSearchResult = new Event();
    this.onPrepareSearchMotorComponents = new Event();

    this.onSelectPackageRecommendation = new Event();
    this.onSelectPackageEvents = new Event();

    this.currentCurrencyUpdated = new Event();
    this.refreshCurrencyStarting = new Event();
    this.refreshCurrencyCompleted = new Event();

    this.onRecalculateProductsByAirSelectionStarting = new Event();
    this.onRecalculateProductsByAirSelectionCompleted = new Event();
    this.onRecalculateProductsByHotelSelectionStarting = new Event();
    this.onRecalculateProductsByHotelSelectionCompleted = new Event();
    this.onRecalculateProductsByInsuranceSelectionStarting = new Event();
    this.onRecalculateProductsByInsuranceSelectionCompleted = new Event();

    this.searchBestPriceCompleted = new Event();

    this.setSelectedRoomsInHotelUpdated = new Event();

    this.flexibleSearchCompleted = new Event();

    this.requestQuotation = new Event();

    this.paxCountsUpdated = new Event();

    this.getPackageLocationsCompleted = new Event();

    this.getPackagesByNameCompleted = new Event();

    this.getItinerariesByNameCompleted = new Event();

    this.onShowMore = new Event();
    //#region Cars

    this.getRentalLocationsCompleted = new Event();

    this.getCarCompaniesCompleted = new Event();

    this.getCarContent = new Event();

    this.onIncludeProduct = new Event();
    this.onRemoveProduct = new Event();

    //#endregion

    //#region Services

    this.getServiceCategoriesCompleted = new Event();
    this.getServicesByNameCompleted = new Event();
    this.getServiceByIdCompleted = new Event();

    //#endregion

    this.searchHotelAvailabilityStarting = new Event();
    this.searchHotelAvailabilityCompleted = new Event();

    this.getCruiseDetailsStarting = new Event();
    this.getCruiseDetailsCompleted = new Event();

    this.getBrandedFaresStarting = new Event();
    this.getBrandedFaresCompleted = new Event();

    this.onCreateRequest = new Event();

    this.loadHotelLocationsCompleted = new Event();

    this.getHotelCommercialAgreementsCompleted = new Event();

    this.getHotelCommercialAgreements = function (req) {
        searchModel.getHotelCommercialAgreements(req);
    };

    this.createRequest = function (searchRequest) {
        _controller.onCreateRequest.notify(searchRequest);
    };

    this.getServiceCategories = function () {
        searchModel.getServiceCategories();
    };

    this.onGetServiceCategoriesCompleted = function (resp) {
        thisController.getServiceCategoriesCompleted.notify(resp);
    };

    this.getCruiseDetails = function (req) {
        thisController.getCruiseDetailsStarting.notify(req);

        searchModel.getCruiseDetails(req);
    };

    this.onGetCruiseDetailsCompleted = function (res) {
        thisController.getCruiseDetailsCompleted.notify(res);
    };

    this.getServicesByName = function (serviceName, serviceType) {
        searchModel.getServicesByName(serviceName, serviceType);
    };

    this.onGetServicesByNameCompleted = function (resp) {
        thisController.getServicesByNameCompleted.notify(resp);
    };

    this.getServiceById = function (serviceId) {
        searchModel.getServiceById(serviceId);
    };

    this.onGetServiceByIdCompleted = function (resp) {
        thisController.getServiceByIdCompleted.notify(resp);
    };

    this.recalculateProductsByAirSelection = function (recommendation, priceGroup, daysStay, foreignData) {
        thisController.onRecalculateProductsByAirSelectionStarting.notify(searchModel.getData());
        searchModel.recalculateProductsByAirSelection(recommendation, priceGroup, daysStay, foreignData);
        thisController.onRecalculateProductsByAirSelectionCompleted.notify(searchModel.getData());
    };

    this.recalculateProductsByHotelSelection = function (hotel, foreignData) {
        thisController.onRecalculateProductsByHotelSelectionStarting.notify(searchModel.getData());
        searchModel.recalculateProductsByHotelSelection(hotel, foreignData);
        thisController.onRecalculateProductsByHotelSelectionCompleted.notify(searchModel.getData());
    };

    this.recalculateProductsByInsuranceSelection = function (insurance, foreignData) {
        thisController.onRecalculateProductsByInsuranceSelectionStarting.notify(searchModel.getData());
        searchModel.recalculateProductsByInsuranceSelection(insurance, foreignData);
        thisController.onRecalculateProductsByInsuranceSelectionCompleted.notify(searchModel.getData());
    };
    
    this.lastSearchParameters = undefined;

    this.bestRecomendations = [];

    this.selectedPackage = undefined;


    this.savePreOrder = function (params) {
        thisController.savePreOrderStarting.notify(params);

        return searchModel.savePreOrder(params);
    }

    this.onSavePreOrderCompleted = function (response) {
        thisController.savePreOrderCompleted.notify(response);
    }

    this.onSavePreOrderError = function (response) {
        thisController.savePreOrderError.notify(response);
    }


    this.destroy = function () {
        this.lastSearchParameters = undefined;
        this.bestRecomendations = undefined;
        this.selectedPackage = undefined;
    };

    this.getCleanCopy = function () {
        var copyController = new SearchController({ Global: {} });
        copyController.lastSearchParameters = thisController.lastSearchParameters;
        var copySearchModel = searchModel.clone(copyController);
        copyController.setSearchModel(copySearchModel);
        return copyController;
    };

    this.includeProduct = function (productType) {
        thisController.onIncludeProduct.notify(productType);
    };

    this.removeProduct = function (productType) {
        thisController.onRemoveProduct.notify(productType);
    };

    this.setSearchModel = function (newSearchModel) {
        searchModel = newSearchModel;
    };

    this.onRequestQuotation = function (searchparameters) {
        thisController.requestQuotation.notify(searchparameters);
    };

    this.showSearchMotor = function () {
        thisController.onShowSearchMotor.notify();
    }

    this.hideSearchMotor = function () {
        thisController.onHideSearchMotor.notify();
    }

    this.showSearchResult = function () {
        thisController.onShowSearchResult.notify();
    }

    this.hideSearchResult = function () {
        thisController.onHideSearchResult.notify();
    }

    this.clearSearchResult = function () {
        thisController.onClearSearchResult.notify();
    }

    this.prepareSearchMotorComponents = function () {
        thisController.onPrepareSearchMotorComponents.notify();
    }

    this.onPaxCountsUpdated = function (data) {

        if (thisController.lastSearchParameters &&
            thisController.lastSearchParameters.Air &&
            thisController.lastSearchParameters.Air.RequestData) {
            thisController.lastSearchParameters.Air.RequestData.NumberADTs = (data.NumberADTs && !isNaN(data.NumberADTs)) ? data.NumberADTs : thisController.lastSearchParameters.Air.RequestData.NumberADTs;
            thisController.lastSearchParameters.Air.RequestData.NumberCHDs = (data.NumberCHDs && !isNaN(data.NumberCHDs)) ? data.NumberCHDs : thisController.lastSearchParameters.Air.RequestData.NumberCHDs;
            thisController.lastSearchParameters.Air.RequestData.NumberINFs = (data.NumberINFs && !isNaN(data.NumberINFs)) ? data.NumberINFs : thisController.lastSearchParameters.Air.RequestData.NumberINFs;
        }

        thisController.paxCountsUpdated.notify(data);
    };

    this.search = function (searchParameters, searchResponse) {
        thisController.searchStarting.notify(searchParameters);

        if (searchResponse && searchResponse.SearchId && searchResponse.SearchId != '') {
            thisController.lastSearchParameters = searchParameters;
            searchModel.OnSearch(searchResponse, searchParameters);
        }
        else {
            thisController.lastSearchParameters = searchParameters;
            searchModel.StartSearch(searchParameters);
        }
    };

    this.searchExecuted = function (response) {
        thisController.searchStarting.notify({});

        searchModel.OnSearch(response);
    };

    this.searchBestRecomendation = function (searchParameters) {
        searchModel.StartSearchBestRecomendation(searchParameters);
    };

    this.flexibleSearchStart = function (searchParameters) {
        searchModel.OnFlexibleSearchStart(searchParameters);
    };

    this.getSearchData = function () {
        return searchModel.getSearchData();
    };

    this.setCruiseSearchData = function (cruiseSearchData) {
        return searchModel.setCruiseSearchData(cruiseSearchData);
    }

    this.getCategories = function () {
        thisController.getCategoriesStarting.notify();

        searchModel.getCategories();
    };

    this.onGetCategoriesCompleted = function (response) {
        thisController.getCategoriesCompleted.notify(response);
    };

    this.onBudgetModeStarting = function () {
        thisController.budgetModeStarting.notify(true);
    };

    this.onBudgetModeCompleted = function () {
        thisController.budgetModeCompleted.notify(false);
    };

    this.paginate = function (req) {
        searchModel.Paginate(req);
        thisController.paginateStarting.notify();
    };

    this.onPaginateCompleted = function (response, request) {
        thisController.paginateCompleted.notify(response, request);
    };

    this.onSelectedToBudget = function (value) {
        thisController.selectedToBudget.notify(value);
    };

    this.onSearchUpdated = function (response) {
        thisController.searchUpdated.notify(response);
    };

    this.onBudgetModeStarting = function () {
        thisController.budgetModeStarting.notify(true);
    }

    this.onBudgetModeCompleted = function () {
        thisController.budgetModeCompleted.notify(false);
    }

    this.onSelectedToBudget = function (value) {
        thisController.selectedToBudget.notify(value);
    }

    this.onSearchCompleted = function (response) {
        if (response.BestPricePackage)
            thisController.selectedPackage = response.BestPricePackage;

        if (response.Recommendations && response.Recommendations.length > 0)
            thisController.bestRecomendations.push(response.Recommendations[0]);

        thisController.searchCompleted.notify(response);
    };

    this.getCachedSearch = function (request) {

        thisController.getCachedSearchStarting.notify(request);

        searchModel.getCachedSearch(request);
    }

    this.onGetCachedSearchCompleted = function (response, request) {
        thisController.getCachedSearchCompleted.notify(response, request);
    };

    this.onSearchBestPriceCompleted = function (response) {
        if (response)
            thisController.bestRecomendations.push(response);

        thisController.searchBestPriceCompleted.notify(response);
    };

    this.onFlexibleSearchCompleted = function (response) {
        thisController.flexibleSearchCompleted.notify(response);
    };

    this.filter = function (filterData, filterType, aux, render) {
        thisController.filterStarting.notify(filterData);

        searchModel.Filter(filterData, filterType, aux, render);
    };

    this.resetFilter = function () {
        searchModel.ResetFilter();
    };

    this.filterByPrice = function (price) {
        searchModel.FilterByPrice(price);
    };

    this.filterByAirCompany = function (filterData) {
        searchModel.FilterByAirCompany(filterData);
    };

    this.filterReset = function (data) {
        thisController.filterReseting.notify(data);
    };

    this.onFilterCompleted = function (response) {
        thisController.filterCompleted.notify(response);
    };

    this.onSortCompleted = function (response) {
        thisController.sortCompleted.notify(response);
    };

    this.onSortData = function (data) {
        thisController.sortStarting.notify(data);
        thisController.onSortCompleted(data);
    };

    this.sort = function (data) {
        thisController.onSort.notify(data);

        thisController.onSortData(data);
    };

    this.onFilterChanged = function (filterData) {
        thisController.filterChanged.notify(filterData);
    };

    this.onError = function (error) {
        thisController.errorRaised.notify(error);
    };

    this.changePackage = function (packag, changePackageType) {

        //para saber estÃ¡ trocando voo ou hotel.
        lastChangePackageType = changePackageType;

        thisController.changePackageStarting.notify(packag);

        searchModel.ChangePackage(thisController.lastSearchParameters, packag);
    };

    this.onChangePackageCompleted = function (response) {
        thisController.changePackageCompleted.notify(response);
    };

    this.changeSelectedPackage = function (packag) {

        thisController.selectedPackage = packag;

        var data = searchModel.PrepareFinalRender(packag, true); //SearchModel FEU - nÃ£o remover o 2Âº parametro

        thisController.updatePriceGroupsValues(data);
        thisController.updateHotelsValues(data);
        thisController.updateRecommendationsValues(data);

        lastChangePackageType = undefined;

        thisController.onChangeSelectedPackage.notify(data);
    };

    this.updateHotelsValues = function (hotels) {
        thisController.hotelsValuesUpdated.notify(hotels);
    };

    this.updateRecommendationsValues = function (priceGroups) {
        thisController.recommendationsValuesUpdated.notify(priceGroups);
    };

    this.updatePriceGroupsValues = function (priceGroups) {
        thisController.priceGroupsValuesUpdated.notify(priceGroups);
    };

    this.selectPackageRecommendation = function (recommendation) {
        thisController.onSelectPackageRecommendation.notify(recommendation);
    };

    this.selectPackageEvents = function (events) {
        thisController.onSelectPackageEvents.notify(events);
    };

    this.hotelDetails = function (req) {

        thisController.hotelDetailsStarting.notify(req);

        if (req.HotelDetailsMode == EnumHelper.HotelDetailsMode.IFrame)
            thisController.hotelDetailsIFrame.notify(req);
        else if (req.HotelDetailsMode == EnumHelper.HotelDetailsMode.ExternalPage)
            thisController.hotelDetailsExternalPage.notify(req);
        else
            searchModel.HotelDetails(req);
    };

    this.eventDetails = function (req) {
        thisController.eventDetailsStarting.notify(req);
        searchModel.EventDetails(req);
    };

    this.packageDetails = function (req) {
        thisController.packageDetailsStarting.notify(req);

        searchModel.PackageDetails(req);
    };

    this.packageCalendar = function (req) {
        thisController.packageCalendarStarting.notify(req);

        searchModel.PackageCalendar(req);
    };

    this.searchPackages = function (searchParameters) {
        thisController.lastSearchParameters = searchParameters;

        thisController.searchStarting.notify(searchParameters);

        searchModel.searchPackages(searchParameters);
    };

    this.onHotelDetailsCompleted = function (response, request) {
        if (request.HotelDetailsMode == EnumHelper.HotelDetailsMode.TransactionPage)
            thisController.hotelDetailsTransactionPage.notify(response, request);
        else
            thisController.hotelDetailsCompleted.notify(response);
    };

    this.onPackageDetailsCompleted = function (response) {
        thisController.packageDetailsCompleted.notify(response);
    };

    this.onPackageCalendarCompleted = function (response) {
        thisController.packageCalendarCompleted.notify(response);
    };

    this.hotelDailyFares = function (req) {

        thisController.hotelDailyFaresStarting.notify(req);

        searchModel.HotelDailyFares(req);
    };

    this.onHotelDailyFaresStarting = function (response) {
        thisController.hotelDailyFaresStarting.notify(response);
    };

    this.onHotelDailyFaresCompleted = function (response) {
        thisController.hotelDailyFaresCompleted.notify(response);
    };

    this.hotelImagesDetails = function (req) {

        thisController.hotelImagesDetailsStarting.notify(req);

        searchModel.HotelImagesDetails(req);
    };

    this.onHotelImagesDetailsStarting = function (response) {
        thisController.hotelImagesDetailsStarting.notify(response);
    };

    this.onHotelImagesDetailsCompleted = function (response) {
        thisController.hotelImagesDetailsCompleted.notify(response);
    };

    this.hotelMapDetails = function (req) {

        thisController.hotelMapDetailsStarting.notify(req);

        searchModel.HotelMapDetails(req);
    };

    this.onHotelMapDetailsStarting = function (response) {
        thisController.hotelMapDetailsStarting.notify(response);
    };

    this.onHotelMapDetailsCompleted = function (response) {
        thisController.hotelMapDetailsCompleted.notify(response);
    };

    this.onEventDetailsCompleted = function (response) {
        thisController.eventDetailsComplete.notify(response);
    };

    this.getFlightGroups = function (priceGroup, flightGroupHashs) {
        return searchModel.getFlightGroups(priceGroup, flightGroupHashs);
    };

    this.getPriceGroup = function (priceGroupIndex) {
        return searchModel.getPriceGroup(priceGroupIndex);
    };

    this.getData = function (cloned) {
        return searchModel.getData(cloned);
    };

    this.onGetHotelsPointsStarting = function () {
        thisController.getHotelsPointsStarting.notify();
    };

    this.getHotelsPoints = function () {
        thisController.onGetHotelsPointsStarting();
        return searchModel.getHotelsPoints();
    }

    this.onGetHotelsPoints = function (response) {
        thisController.getHotelsPointsCompleted.notify(response);
    }

    this.onErrorHoltelsPoints = function () {
        thisController.errorRaised.notify();
        thisController.errorHotelsPointsRaised.notify();
    }

    this.getOrderlyData = function () {
        return searchModel.getOrderlyData();
    };

    this.getFilteredData = function (cloned) {
        return searchModel.getFilteredData();
    };

    this.getCityPairs = function () {
        return searchModel.getCityPairs();
    };

    this.getPackages = function () {
        return searchModel.getPackages();
    };

    this.getPackage = function (id) {
        return searchModel.getPackage(id);
    };

    this.getPackageByIndex = function (index, dontCloneTheObject) {
        return searchModel.getPackageByIndex(index, dontCloneTheObject);
    };

    this.getEventById = function (eventId) {
        return searchModel.getEventById(eventId);
    };

    this.updateEvent = function (event) {
        searchModel.updateEvent(event);
    };

    this.getRecommendationByFlightGroupHashes = function (flightGroupHashes) {
        return searchModel.getRecommendationByFlightGroupHashes(flightGroupHashes);
    };

    this.getAdditionalInfo = function (getAdditionalInfo, sourceType) {
        return searchModel.getAdditionalInfo(getAdditionalInfo, sourceType);
    };

    this.getRecommendations = function () {
        return searchModel.getRecommendations();
    };

    this.getSelectedFareOption = function (cityPair, flightGroupIndex, fareOptionIndex) {
        return searchModel.getSelectedFareOption(cityPair, flightGroupIndex, fareOptionIndex);
    };

    this.getCityPairByFlightGroupIndex = function (index) {
        return searchModel.getCityPairByFlightGroupsIndex(index);
    };

    this.getCityPairFlightGroupByFlightGroupIndex = function (index) {
        return searchModel.getCityPairFlightGroupByFlightGroupIndex(index);
    };

    this.getFlightGroupCityPairByFlightGroupIndex = function (index) {
        return searchModel.getFlightGroupCityPairByFlightGroupIndex(index);
    };

    this.getRecommendationByIndex = function (index) {
        return searchModel.getRecommendationByIndex(index);
    };

    this.getRecommendationByRecommendationIndex = function (index) {
        return searchModel.getRecommendationByRecommendationIndex(index);
    };

    this.getPriceGroups = function () {
        return searchModel.getPriceGroups();
    };

    this.getHotels = function () {
        return searchModel.getHotels();
    };

    this.getEvents = function () {
        return searchModel.getEvents();
    };

    this.getEvent = function (eventId) {
        return searchModel.getEvent(eventId);
    };

    this.getFilteredEvents = function () {
        return searchModel.getFilteredEvents();
    };

    this.getHotel = function (hash, summary) {
        return searchModel.getHotel(hash, summary);
    };

    this.getInsurance = function (insuranceId) {
        return searchModel.getInsurance(insuranceId);
    }

    this.getInsuranceByIndex = function (insuranceIndex) {
        return searchModel.getInsuranceByIndex(insuranceIndex);
    }

    this.getHotelReferenced = function (hash) {
        return searchModel.getHotelReferenced(hash);
    };

    this.getSessionId = function (hash) {
        return searchModel.getSessionId(hash);
    };

    this.onHotelsRendered = function (hotels, hotelsOuted) {
        searchModel.setVisibleHotels(hotels);
        searchModel.setNonVisibleHotels(hotelsOuted);
        thisController.hotelsRendered.notify(hotels);
    };

    this.getVisibleHotels = function () {
        return searchModel.getVisibleHotels();
    };

    this.getNonVisibleHotels = function () {
        return searchModel.getNonVisibleHotels();
    };

    this.getFilteredPackages = function () {
        return searchModel.getFilteredPackages();
    };

    this.setFilteredPackages = function (packages) {
        return searchModel.setFilteredPackages(packages);
    };

    this.getFilteredHybridPackages = function () {
        return searchModel.getFilteredHybridPackages();
    };

    this.getFilteredPriceGroups = function () {
        return searchModel.getFilteredPriceGroups();
    };

    this.setFilteredPriceGroups = function (priceGroups) {
        return searchModel.setFilteredPriceGroups(priceGroups);
    };

    this.getFilteredRecommendations = function () {
        return searchModel.getFilteredRecommendations();
    };

    this.setFilteredRecommendations = function (recommendations) {
        return searchModel.setFilteredRecommendations(recommendations);
    };

    this.getExchangeRates = function () {
        return searchModel.getExchangeRates();
    };

    this.getFilteredHotels = function () {
        return searchModel.getFilteredHotels();
    };

    this.getSearchId = function () {
        return searchModel.getSearchId();
    };

    this.currentCurrency = function (exchangeRates) {
        thisController.currentCurrencyUpdated.notify(exchangeRates);
    };

    this.refreshCurrency = function (params) {
        thisController.refreshCurrencyStarting.notify(params);
        thisController.refreshCurrencyCompleted.notify(params);
    };

    this.callSearchCompleted = function (response) {
        searchModel.onSearchCompleted(response);
    };

    this.abort = function () {
        searchModel.abort();
    };

    this.getCachedAuxRecommendations = function () {
        return searchModel.getCachedAuxRecommendations();
    };

    this.getCachedAuxPriceGroups = function () {
        return searchModel.getCachedAuxPriceGroups();
    };

    this.getCombinablesFlightGroups = function (pricegroup, flightgroup) {
        return searchModel.getCombinablesFlightGroups(pricegroup, flightgroup);
    };

    this.getCalendarPackage = function () {
        return Util.Clone(searchModel.getCalendarPackage());
    };

    this.setCalendarPackage = function (bestCalendarPackage) {
        return searchModel.setCalendarPackage(bestCalendarPackage);
    };

    this.SetWithoutSuggestions = function (_withoutSuggestions) {
        searchModel.SetWithoutSuggestions(_withoutSuggestions);
    };

    this.clearCalendarPackage = function () {
        return searchModel.clearCalendarPackage();
    };

    this.setPackage = function (newPackage) {
        return searchModel.setPackage(newPackage);
    };

    this.getSearchSummary = function () {
        return searchModel.getSearchSummary();
    };

    this.setSelectedRoomsInHotel = function (hotel) {
        searchModel.setSelectedRoomsInHotel(hotel);
        thisController.setSelectedRoomsInHotelUpdated.notify(hotel);
    };

    this.setHotelToOtherOptionsInBudget = function (hotel, value) {
        searchModel.setHotelToOtherOptionsInBudget(hotel, value);
    };

  

    this.getHotelsToOtherOptionsInBudget = function () {
        return searchModel.getHotelsToOtherOptionsInBudget();
    };

    this.getFlightGroupsToOtherOptionsInBudget = function () {
        return searchModel.getFlightGroupsToOtherOptionsInBudget();
    };

    this.getRecommendationToOtherOptionsInBudget = function () {
        return searchModel.getRecommendationToOtherOptionsInBudget();
    };

    this.getSelectedRoomsInHotel = function (hotelIndex) {
        return searchModel.getSelectedRoomsInHotel(hotelIndex);
    };

    this.getAllSelectedRoomsInHotel = function () {
        return searchModel.getAllSelectedRoomsInHotel();
    };

    this.setFlightToOtherOptionsInBudget = function (flightGroupIndex, value) {
        searchModel.setFlightToOtherOptionsInBudget(flightGroupIndex, value);
    };

    this.setRecommendationToOtherOptionsInBudget = function (recommendationIndex, brandedFareIndex, value) {
        searchModel.setRecommendationToOtherOptionsInBudget(recommendationIndex, brandedFareIndex, value);
    };

    this.getFlightGroupsToOtherOptionsInBudget = function () {
        return searchModel.getFlightGroupsToOtherOptionsInBudget();
    };

    this.getRecommendationToOtherOptionsInBudget = function () {
        return searchModel.getRecommendationToOtherOptionsInBudget();
    };

    this.getAllControllerEvents = function () {

        var funcs = [];

        for (prop in thisController) {
            if (thisController[prop] && thisController[prop].isEvent) {
                funcs.push({
                    Event: thisController[prop],
                    EventName: prop
                });
            }
        }

        funcs.orderByDescending(function (e) { e.Event.count(); });

        return funcs;
    };

    this.consoleLogAttachedEvents = function () {
        if (console && console.log && typeof console.log == "function") {
            var thisEvents = thisController.getAllControllerEvents();
            thisEvents.orderByDescending(function (e) { return e.Event.count(); });
            thisEvents.forEach(function (e) {
                if (e.Event.count() > 0)
                    console.log(e.Event, e.Event.count(), e.EventName);
            });
        }
    };

    this.getService = function (serviceId) {

        return searchModel.getService(serviceId);
    };

    this.getSelectedService = function (serviceId, FareId) {

        return searchModel.getSelectedService(serviceId, FareId);
    };

    //#region Cars

    this.getRentalLocations = function (req) {
        searchModel.getRentalLocations(req);
    };

    this.onGetRentalLocationsCompleted = function (resp) {
        thisController.getRentalLocationsCompleted.notify(resp);
    };

    this.getCarCompanies = function (req) {
        searchModel.getCarCompanies(req);
    };

    this.onGetCarCompaniesCompleted = function (resp) {
        thisController.getCarCompaniesCompleted.notify(resp);
    };

    this.getCarByIndex = function (index) {
        return searchModel.getCarByIndex(index);
    };

    this.getCarCompanyByIndex = function (index) {
        return searchModel.getCarCompanyByIndex(index);
    };

    this.getCarContent = function (req) {
        searchModel.getCarContent(req);
    };

    this.onGetCarContentCompleted = function (resp) {
        thisController.getCarCompaniesCompleted.notify(resp);
    };

    //#endregion

    //#region Packages
    this.getPackageLocations = function (req) {
        searchModel.getPackageLocations(req);
    };

    this.onGetPackageLocationsCompleted = function (data) {
        thisController.getPackageLocationsCompleted.notify(data);
    };

    this.getPackageRecommendations = function (_package, _data) {
        return searchModel.getPackageRecommendations(_package, _data);
    };

    this.getPackageHotels = function (_package, _data) {
        return searchModel.getPackageHotels(_package, _data);
    };

    this.getPackageServices = function (_package, _data) {
        return searchModel.getPackageServices(_package, _data);
    };

    this.getMandatoryPackageServices = function (_package, _data) {
        return searchModel.getMandatoryPackageServices(_package, _data);
    };

    this.getPackageInsurances = function (_package, _data) {
        return searchModel.getPackageInsurances(_package, _data);
    };

    this.getPackagesByName = function (keyword) {
        searchModel.getPackagesByName(keyword);
    };

    this.onGetPackagesByNameCompleted = function (resp) {
        thisController.getPackagesByNameCompleted.notify(resp);
    };

    this.getItinerariesByName = function (keyword) {
        searchModel.getItinerariesByName(keyword);
    };

    this.onGetItinerariesByNameCompleted = function (resp) {
        thisController.getItinerariesByNameCompleted.notify(resp);
    };


    //#endregion

    this.getWPHotelImages = function (hotelIds) {
        searchModel.getWPHotelImages(hotelIds);
    };

    this.onGetWPHotelImagesCompleted = function (resp) {
        thisController.ongetWPHotelImages.notify(resp);
    };

    this.cruise = {
        ships: {
            get: function (shipCode) {
                searchModel.wpJson.cruise.ships.get(shipCode);
            },
            completed: function (response) {
                thisController.getWPCruiseShipDetailsCompleted.notify(response);
            }
        },
        ports: {
            get: function (portCode) {
                searchModel.wpJson.cruise.ports.get(portCode);
            },
            completed: function (response) {
                thisController.getWPCruisePortDetailsCompleted.notify(response);
            }
        },
        shipSubpages: {
            get: function (shipCode) {
                searchModel.wpJson.cruise.shipSubpages.get(shipCode);
            },
            completed: function (response) {
                thisController.getWPCruiseShipSubpagesCompleted.notify(response);
            }
        },
        restaurants: {
            get: function (shipCode) {
                searchModel.wpJson.cruise.restaurants.get(shipCode);
            },
            completed: function (response) {
                thisController.getWPCruiseRestaurantsCompleted.notify(response);
            }
        },
        barsAndLounges: {
            get: function (shipCode) {
                searchModel.wpJson.cruise.barsAndLounges.get(shipCode);
            },
            completed: function (response) {
                thisController.getWPCruiseShipBarsAndLoungesCompleted.notify(response);
            }
        },
        entertainments: {
            get: function (shipCode) {
                searchModel.wpJson.cruise.entertainments.get(shipCode);
            },
            completed: function (response) {
                thisController.getWPCruiseShipEntertainmentsCompleted.notify(response);
            }
        }
    }
    
    this.searchHotelAvailability = function (request) {
        thisController.searchHotelAvailabilityStarting.notify(request);
        searchModel.searchHotelAvailability(request);
    };

    this.onSearchHotelAvailability = function (response) {
        thisController.searchHotelAvailabilityCompleted.notify(response);
    };

    this.showMore = function (currentQuantity, quantityShowMore, type) {
        thisController.onShowMore.notify(currentQuantity, quantityShowMore, type);
    };

    this.getSearchRequest = function () {
        return searchModel.getSearchRequest();
    };

    this.getLastSearchParameters = function () {
        return thisController.lastSearchParameters;
    };

    this.setLastSearchParameters = function (searchParameters) {
        thisController.lastSearchParameters = searchParameters;
    };

    this.updateDataValue = function (newData, propertyName) {
        searchModel.updateDataValue(newData, propertyName);
    };

    this.updateHotels = function (newData) {
        searchModel.updateHotels(newData);
    };

    this.getSelectedPackage = function () {
        return searchModel.getSelectedPackage();
    };

    this.getBrandedFares = function (req) {
        thisController.getBrandedFaresStarting.notify(req);

        return searchModel.getBrandedFares(req);
    }

    this.onGetBrandedFaresCompleted = function (response) {
        thisController.getBrandedFaresCompleted.notify(response);
    }

    this.setInsuranceLocation = function (insurance) {
        searchModel.setInsuranceLocation(insurance);
    }

    this.loadHotelLocations = function (req) {
        searchModel.loadHotelLocations(req);
    };

    this.onLoadHotelLocations = function (res) {
        thisController.loadHotelLocationsCompleted.notify(res);
    };

    this.getUserLastAction = function () {
        var lastSearchParameters = thisController.getLastSearchParameters();

        if (lastSearchParameters.UserParameters) {
            return lastSearchParameters.UserParameters.Action || "";
        }
        return "";
    };

    var settings = { "Global": undefined };

    $.extend(true, settings, params || {});

    var _controller = undefined;

    if (!Global.UseIndividualController) {
        if (!settings.Global) {
            Global = Global || {};

            if (!Global.SearchController)
                Global.SearchController = this;

            _controller = Global.SearchController;
        }
        else {
            params.Global.SearchController = this;

            _controller = params.Global.SearchController;
        }
    }

    return _controller;
}


var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var typescriptPlugins;
(function (typescriptPlugins) {
    var cruisePassengersQuantity = (function (_super) {
        __extends(cruisePassengersQuantity, _super);
        function cruisePassengersQuantity() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        cruisePassengersQuantity.prototype.getPluginName = function () { return 'cruisePassengersQuantity'; };
        cruisePassengersQuantity.prototype.getDefaultSettings = function () { return new CruisePassengersQuantity.Settings(); };
        cruisePassengersQuantity.prototype.render = function () {
            if (!this._settings.data.defaultChildrens && this._settings.data.defaultChildAges && this._settings.data.defaultChildAges.length)
                this._settings.data.defaultChildrens = this._settings.data.defaultChildAges.length;
            else
                this._settings.data.defaultChildrens = 0;
            this._component.html(this._settings.templates.cruisePassengersQuantity(this._settings.data));
            this._selectComponents();
            this._setComponentsEvents();
            this.onChildrenQuantityChange();
        };
        cruisePassengersQuantity.prototype._afterInitialize = function () {
            this.render();
        };
        cruisePassengersQuantity.prototype._setComponentsEvents = function () {
            var _this = this;
            this._settings.components.adultsQuantity.attachOnce('change', function (event) { return _this.onAdultQuantityChange(); });
            this._settings.components.childrensQuantity.attachOnce('change', function (event) { return _this.onChildrenQuantityChange(); });
            this._settings.components.seniorsQuantity.attachOnce('change', function (event) { return _this.onSeniorQuantityChange(); });
            this._settings.components.buttonPlus.attachOnce('click', function (event) { return _this.onPlusClicked(event); });
            this._settings.components.buttonMinus.attachOnce('click', function (event) { return _this.onMinusClicked(event); });
        };
        cruisePassengersQuantity.prototype.getData = function () {
            this._selectComponents();
            var slcsChildAges = this._settings.components.slcChildAge;
            var childAges = [];
            if (slcsChildAges.length > 0 && this._settings.components.childrensQuantity.val() > 0)
                childAges = slcsChildAges.map(function () { return $(this).val(); }).get().filter(function (val) { return val >= 0; });
            return {
                NumberOfAdults: this._settings.components.adultsQuantity.val(),
                NumberOfChildrens: this._settings.components.childrensQuantity.val(),
                ChildAges: childAges
            };
        };
        cruisePassengersQuantity.prototype._onQuantityChange = function () {
            this._setCompatibleChildrenPromotionsVisibility();
            if (this._settings.events.onQuantityChange) {
                var data = this.getData();
                this._settings.events.onQuantityChange(data);
            }
        };
        cruisePassengersQuantity.prototype._changePaxLimits = function () {
            var adultsQuantity = parseInt(this._settings.components.adultsQuantity.val());
            var childQuantity = parseInt(this._settings.components.childrensQuantity.val());
            var seniorQuantity = parseInt(this._settings.components.seniorsQuantity.val());
            var paxLimit = 4;
            var totalPax = adultsQuantity + childQuantity;
            var available = totalPax = paxLimit - totalPax;
            var availToAdults = adultsQuantity + available;
            var availToChild = childQuantity + available;
            this._settings.components.adultsQuantity.attr('max', availToAdults);
            this._settings.components.childrensQuantity.attr('max', availToChild);
            this._changeComponentEnable(this._settings.components.buttonPlusAdultsQuantity, true);
            this._changeComponentEnable(this._settings.components.buttonMinusAdultsQuantity, true);
            this._changeComponentEnable(this._settings.components.buttonPlusChildrensQuantity, true);
            this._changeComponentEnable(this._settings.components.buttonMinusChildrensQuantity, true);
            this._changeComponentEnable(this._settings.components.buttonPlusSeniorsQuantity, true);
            this._changeComponentEnable(this._settings.components.buttonMinusSeniorsQuantity, true);
            if (availToAdults <= 0 || availToAdults === adultsQuantity)
                this._changeComponentEnable(this._settings.components.buttonPlusAdultsQuantity, false);
            if (adultsQuantity <= 1)
                this._changeComponentEnable(this._settings.components.buttonMinusAdultsQuantity, false);
            if (availToChild <= 0 || availToChild === childQuantity)
                this._changeComponentEnable(this._settings.components.buttonPlusChildrensQuantity, false);
            if (childQuantity <= 0)
                this._changeComponentEnable(this._settings.components.buttonMinusChildrensQuantity, false);
            if (seniorQuantity >= adultsQuantity)
                this._changeComponentEnable(this._settings.components.buttonPlusSeniorsQuantity, false);
            if (seniorQuantity > adultsQuantity)
                this._settings.components.seniorsQuantity.val(adultsQuantity);
        };
        cruisePassengersQuantity.prototype._changeComponentEnable = function (component, enable) {
            var disabledClass = 'disabled';
            component.removeClass(disabledClass).removeAttr('disabled');
            if (!enable)
                component.addClass(disabledClass).attr('disabled', 'disabled');
        };
        cruisePassengersQuantity.prototype.adjustValues = function (component) {
            var value = parseInt(component.val());
            var max = parseInt(component.attr('max'));
            if (value >= max) {
                component.val(max);
                value = max;
            }
            if (value < 0) {
                value = 0;
                component.val(value);
            }
            return value;
        };
        cruisePassengersQuantity.prototype.onAdultQuantityChange = function () {
            this.adjustValues(this._settings.components.adultsQuantity);
            this._changePaxLimits();
            this._onQuantityChange();
        };
        cruisePassengersQuantity.prototype.onSeniorQuantityChange = function () {
            this.adjustValues(this._settings.components.adultsQuantity);
            this._changePaxLimits();
            this._onQuantityChange();
        };
        cruisePassengersQuantity.prototype.onChildrenQuantityChange = function () {
            var childrensQuantity = this.adjustValues(this._settings.components.childrensQuantity);
            if (childrensQuantity == 0 || this._settings.data.showChildAgesSelection === false) {
                this._settings.components.childAgesContainer.hide();
            }
            else {
                this._settings.components.childAgesContainer.show();
                this._settings.components.slcChildAge.filter(':not(:first)').parent().remove();
                for (var i = 0; i < childrensQuantity; i++) {
                    var age = -1;
                    if (i == 0) {
                        this._settings.components.slcChildAge.eq(0).val(age);
                    }
                    else {
                        this._addChildAgeSelect(age, i);
                    }
                }
            }
            this._changePaxLimits();
            this._onQuantityChange();
        };
        cruisePassengersQuantity.prototype._setCompatibleChildrenPromotionsVisibility = function () {
            if (Util.HasCount(this._settings.components.promotions)) {
                var unavailablePromotionClass = 'hide';
                var unavailablePromotionListItemClass = 'hide';
                var data = this.getData();
                var promotions = this._settings.data.selectedPromotions;
                this._settings.components.promotions.removeClass(unavailablePromotionClass);
                this._settings.components.promotions.closest('.promotionListItem').removeClass(unavailablePromotionListItemClass);
                if (Util.HasCount(promotions)) {
                    for (var _i = 0, promotions_1 = promotions; _i < promotions_1.length; _i++) {
                        var promotion = promotions_1[_i];
                        if (promotion.GuestsConfiguration) {
                            if ((promotion.GuestsConfiguration.Adults && promotion.GuestsConfiguration.Adults.Min && promotion.GuestsConfiguration.Adults.Min > data.NumberOfAdults) ||
                                (promotion.GuestsConfiguration.Adults && promotion.GuestsConfiguration.Adults.Max && promotion.GuestsConfiguration.Adults.Max < data.NumberOfAdults) ||
                                (promotion.GuestsConfiguration.Childrens && promotion.GuestsConfiguration.Childrens.Min && promotion.GuestsConfiguration.Childrens.Min > data.NumberOfChildrens) ||
                                (promotion.GuestsConfiguration.Childrens && promotion.GuestsConfiguration.Childrens.Max && promotion.GuestsConfiguration.Childrens.Max > data.NumberOfChildrens)) {
                                promotion.unavailable = true;
                                var promotionEl = this._settings.components.promotions.filter('[promotioncode=' + promotion.Code + ']');
                                promotionEl.addClass(unavailablePromotionClass);
                                promotionEl.closest('.promotionListItem').addClass(unavailablePromotionListItemClass);
                            }
                        }
                    }
                }
            }
        };
        cruisePassengersQuantity.prototype._addChildAgeSelect = function (age, index) {
            var componentToClone = this._settings.components.slcChildAge.first().parent();
            var clonedContent = componentToClone.clone();
            var clonedSelect = clonedContent.find('select');
            if (age != undefined)
                clonedSelect.val(age);
            clonedContent.find('.childNumber').html(index + 1);
            componentToClone.parent().append(clonedContent);
            this._selectComponents();
        };
        cruisePassengersQuantity.prototype.validate = function (data) {
            var validationResult = { Valid: true };
            if (!data)
                data = this.getData();
            if (!data.NumberOfAdults || data.NumberOfAdults <= 0) {
                confirm('Selecione ao menos 1 adulto para realizar a pesquisa');
                validationResult.Valid = false;
            }
            else if (data.NumberOfChildrens > 0 &&
                (!Util.HasCount(data.ChildAges) || data.NumberOfChildrens != data.ChildAges.length)) {
                confirm('Preencha a idade das criaÃ§as informadas');
                validationResult.Valid = false;
            }
            return validationResult;
        };
        cruisePassengersQuantity.prototype.onMinusClicked = function (event) {
            event.preventDefault();
            var fieldName = $(event.target).data('field');
            var parent = $(event.target).closest('div');
            var currentInput = parent.find('input[name=' + fieldName + ']');
            var currentVal = parseInt(currentInput.val(), 10);
            if (!isNaN(currentVal) && currentVal > 0) {
                parent.find('input[name=' + fieldName + ']').val(currentVal - 1);
            }
            else {
                parent.find('input[name=' + fieldName + ']').val(0);
            }
            this.onChildrenQuantityChange();
        };
        cruisePassengersQuantity.prototype.onPlusClicked = function (event) {
            event.preventDefault();
            var fieldName = $(event.target).data('field');
            var parent = $(event.target).closest('div');
            var currentInput = parent.find('input[name=' + fieldName + ']');
            var currentVal = parseInt(currentInput.val(), 10);
            var max = parseInt(currentInput.attr('max'));
            if (!isNaN(currentVal)) {
                if (currentVal < max)
                    parent.find('input[name=' + fieldName + ']').val(currentVal + 1);
            }
            else {
                parent.find('input[name=' + fieldName + ']').val(0);
            }
            this.onChildrenQuantityChange();
        };
        cruisePassengersQuantity = __decorate([
            registerView()
        ], cruisePassengersQuantity);
        return cruisePassengersQuantity;
    }(ViewBase));
    typescriptPlugins.cruisePassengersQuantity = cruisePassengersQuantity;
})(typescriptPlugins || (typescriptPlugins = {}));


var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var CruisePassengersQuantity;
(function (CruisePassengersQuantity) {
    var Settings = (function (_super) {
        __extends(Settings, _super);
        function Settings() {
            var _this = _super.call(this) || this;
            _this.templates = {
                cruisePassengersQuantity: CruisePassengersQuantityTPL.getCruisePassengersQuantityTemplate('cruisePassengersQuantity')
            };
            _this.components.adultsQuantity = '.adultsQuantity';
            _this.components.childrensQuantity = ".childrensQuantity";
            _this.components.seniorsQuantity = ".seniorsQuantity";
            _this.components.childAgesContainer = "#childAgesContainer";
            _this.components.slcChildAge = ".slcChildAge";
            _this.components.buttonMinus = '.button-minus';
            _this.components.buttonPlus = '.button-plus';
            _this.components.buttonMinusAdultsQuantity = '.adultsQuantity-button-minus';
            _this.components.buttonPlusAdultsQuantity = '.adultsQuantity-button-plus';
            _this.components.buttonMinusChildrensQuantity = '.childrensQuantity-button-minus';
            _this.components.buttonPlusChildrensQuantity = '.childrensQuantity-button-plus';
            _this.components.buttonMinusSeniorsQuantity = '.seniorsQuantity-button-minus';
            _this.components.buttonPlusSeniorsQuantity = '.seniorsQuantity-button-plus';
            _this.components.promotions = '.promotion';
            _this.data.showChildAgesSelection = true;
            _this.data.mustShowSeniors = false;
            return _this;
        }
        return Settings;
    }(BaseSettings));
    CruisePassengersQuantity.Settings = Settings;
})(CruisePassengersQuantity || (CruisePassengersQuantity = {}));


ï»¿var CruisePassengersQuantityTPL = (function () {

    function groupPromotionsByGuestType(promotions) {
        var groupedPromotions = {
            childrenPromotions: []
        }

        for (var i = 0; i < promotions.length; i++) {
            var promotion = promotions[i];

            if (promotion.GuestsConfiguration) {
                if (promotion.GuestsConfiguration.Childrens &&
                    (
                        (promotion.GuestsConfiguration.Childrens.Min && promotion.GuestsConfiguration.Childrens.Min > 0) || 
                        (promotion.GuestsConfiguration.Childrens.Max && promotion.GuestsConfiguration.Childrens.Max > 0)
                    )
                ) {

                    groupedPromotions.childrenPromotions.push(promotion);
                }
            }
        }

        return groupedPromotions;
    }

    function cruisePassengersQuantity(data) {
        var settings = {
            template: CruisePassengersQuantity.cruisePassengersQuantity,
            data: {}
        };

        $.fn.extend(settings, data || {});

        var prepareRender = function (data) {

            data.maxAdultsQuantity = 5;
            data.maxChildrensQuantity = 5;

            if (data.defaultAdults == undefined)
                data.defaultAdults = 2;

            if (data.defaultChildrens == undefined)
                data.defaultChildrens = 0;

            if (Util.HasCount(data.selectedPromotions)) {
                //Agrupa as promoÃ§Ãµes por tipo de passageiro para auxiliar na exibiÃ§Ã£o 
                data.promotionsByGuestType = groupPromotionsByGuestType(data.selectedPromotions);

                //Ajusta o padrÃ£o selecionado de quantidade de hÃ³spedes de acordo com o maior valor das promoÃ§Ãµes aplicadas
                if (data.selectedPromotions.any(function (p) {
                    return p.GuestsConfiguration &&
                        ((p.GuestsConfiguration.Adults && p.GuestsConfiguration.Adults.Min) ||
                            (p.GuestsConfiguration.Childrens && p.GuestsConfiguration.Childrens.Min))
                })) {
                    var adultsQuantityBiggerMin = data.selectedPromotions.max(function (p) { return p.GuestsConfiguration.Adults && p.GuestsConfiguration.Adults.Min || 0; });
                    if (adultsQuantityBiggerMin)
                        data.defaultAdults = adultsQuantityBiggerMin;

                    var childrensQuantityBiggerMin = data.selectedPromotions.max(function (p) { return p.GuestsConfiguration.Childrens && p.GuestsConfiguration.Childrens.Min || 0; });
                    if (childrensQuantityBiggerMin)
                        data.defaultChildrens = childrensQuantityBiggerMin;
                }
            }
            
            return data;
        }

        return settings.template({
            data: prepareRender(data)
        });
    }

    var templates = {
        cruisePassengersQuantity: cruisePassengersQuantity
    }

    this.getCruisePassengersQuantityTemplate = function (templateName) {
        return templates[templateName] || function () { return "" };
    }

    return this;

})();

// This file was automatically generated from CruisePassengersQuantity.soy.
// Please don't edit this file by hand.

if (typeof CruisePassengersQuantity == 'undefined') { var CruisePassengersQuantity = {}; }


CruisePassengersQuantity.cruisePassengersQuantity = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>');
  CruisePassengersQuantity.inputPaxSelection({inputClass: 'adultsQuantity', defaultNumber: opt_data.data.defaultAdults, maxNumber: opt_data.data.maxAdultsQuantity}, output);
  output.append('<p>Adultos</p></div><div class="childrenQuantityBlock">');
  CruisePassengersQuantity.inputPaxSelection({inputClass: 'childrensQuantity', defaultNumber: opt_data.data.defaultChildrens, maxNumber: opt_data.data.maxChildrensQuantity}, output);
  output.append('<p>CrianÃ§as (1 a 11 anos*)</p><small>*Idade das crianÃ§as na data do cruzeiro</small>');
  if (opt_data.data.promotionsByGuestType && opt_data.data.promotionsByGuestType.childrenPromotions && opt_data.data.promotionsByGuestType.childrenPromotions.length) {
    output.append('<div class="compatiblePromotionsBlock"><ul class="compatiblePromotions">');
    var promotionList26 = opt_data.data.promotionsByGuestType.childrenPromotions;
    var promotionListLen26 = promotionList26.length;
    for (var promotionIndex26 = 0; promotionIndex26 < promotionListLen26; promotionIndex26++) {
      var promotionData26 = promotionList26[promotionIndex26];
      output.append('<li class="promotionListItem highlight-box"><div', (promotionData26.GuestsConfiguration && promotionData26.GuestsConfiguration.Adults && promotionData26.GuestsConfiguration.Adults.Min) ? ' minadults="' + soy.$$escapeHtml(promotionData26.GuestsConfiguration.Adults.Min) + '"' : '', (promotionData26.GuestsConfiguration && promotionData26.GuestsConfiguration.Adults && promotionData26.GuestsConfiguration.Adults.Max) ? ' maxadults="' + soy.$$escapeHtml(promotionData26.GuestsConfiguration.Adults.Max) + '"' : '', (promotionData26.GuestsConfiguration && promotionData26.GuestsConfiguration.Childrens && promotionData26.GuestsConfiguration.Childrens.Min) ? ' minchildrens="' + soy.$$escapeHtml(promotionData26.GuestsConfiguration.Childrens.Min) + '"' : '', (promotionData26.GuestsConfiguration && promotionData26.GuestsConfiguration.Childrens && promotionData26.GuestsConfiguration.Childrens.Max) ? ' maxchildrens="' + soy.$$escapeHtml(promotionData26.GuestsConfiguration.Childrens.Max) + '"' : '', 'promotioncode="', soy.$$escapeHtml(promotionData26.Code), '" class="promotion">+ ', soy.$$escapeHtml(promotionData26.Name), ' **</div><!--<small class="tooltip"><span>CritÃ©rios vÃ¡lidos da promoÃ§Ã£o:</span><br /><span>', soy.$$escapeHtml(promotionData26.GuestsConfiguration.RulesDescription), '</span></small>--></li>');
    }
    output.append('</ul></div>');
  }
  output.append('</div></div><div id="childAgesContainer" style="display:none;"><ul class="child-ages"><li><span class="childIdentifier">Idade da <span class="childNumber">1</span>Âª CrianÃ§a: </span><select class="slcChildAge">');
  for (var i64 = -1; i64 < 12; i64++) {
    output.append((i64 != 0) ? '<option value="' + soy.$$escapeHtml(i64) + '" ' + ((opt_data.data.defaultChildAges && opt_data.data.defaultChildAges.length && opt_data.data.defaultChildAges[i64] == i64 + 1) ? 'selected' : '') + '>' + ((i64 == -1) ? 'Selecione' : (i64 > 0) ? soy.$$escapeHtml(i64) + ' ' + ((i64 == 1) ? 'ano' : 'anos') : '') + '</option>' : '');
  }
  output.append('</select></li></ul></div>');
  if (!opt_sb) return output.toString();
};


CruisePassengersQuantity.inputPaxSelection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="input-group"><a href="javascript:void(0)" class="button-minus ', soy.$$escapeHtml(opt_data.inputClass), '-button-minus" data-field="quantity">-</a><input type="text" readonly="readonly" step="1" max="', soy.$$escapeHtml(opt_data.maxNumber), '" value="', soy.$$escapeHtml(opt_data.defaultNumber), '" name="quantity" class="quantity-field ', soy.$$escapeHtml(opt_data.inputClass), '"><a href="javascript:void(0)" class="button-plus ', soy.$$escapeHtml(opt_data.inputClass), '-button-plus" data-field="quantity">+</a></div>');
  if (!opt_sb) return output.toString();
};


// This file was automatically generated from AirSearchEngine.soy.
// Please don't edit this file by hand.

if (typeof SearchEngine == 'undefined') { var SearchEngine = {}; }


SearchEngine.Air = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input class="touch research_show matrix" for="show_research" id="show_research" alue="open" type="checkbox"><label for="show_research" class="touch research matrix">Abrir</label><div class="content flight"></div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.AirContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t<!-- adiciona classe para esconder, pois o less nÃ£o serÃ¡ atualizado em todos clientes --><h1 class="matrix">Refinar Busca</h1><h2>', soy.$$escapeHtml(opt_data.settings.title), '</h2><div class="radio way"><label><input type="radio" id="chkRoundTrip" name="tripType" value="1" checked="checked" class="chkOneWay" /><span>Ida e volta</span></label><label><input type="radio" id="chkOneWay" name="tripType" value="2" ', (opt_data.settings.roundtrip == false) ? 'checked="checked"' : '', ' class="chkRoundTrip" /><span>Somente ida</span></label>', (opt_data.settings.enableMultiSearch) ? '<label><input type="radio" id="chkMultiDestination" name="tripType" value="3" class="chkMultiDestination" /><span>Multitrechos</span></label>' : '', '</div><div class="destinationContainer">');
  SearchEngine.destination({settings: opt_data.settings}, output);
  output.append('</div>', (opt_data.settings.enableMultiSearch) ? '<div class="addSegment"><a href="#" class="btn addSegmentLink" style="display:none">+ Adicionar trecho</a></div>' : '', '<div class="advanced travelers passengers">');
  SearchEngine.passengers({settings: opt_data.settings}, output);
  output.append('</div><div class="advanced settings"><input id="air_advanced_check" type="checkbox" name="air_advanced_check"><label for="air_advanced_check">AvanÃ§ado</label><div class="content">');
  SearchEngine.createAirCompaniesAndCabinFilters({settings: opt_data.settings}, output);
  SearchEngine.baggages({settings: opt_data.settings}, output);
  output.append('</div></div>');
  SearchEngine.searchButton({isHome: opt_data.isHome}, output);
  if (opt_data.settings.enableMultiSearch) {
    SearchEngine.cleanButton(null, output);
  }
  if (!opt_sb) return output.toString();
};


SearchEngine.destination = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="destinationDiv">');
  SearchEngine.destinationFields({settings: opt_data.settings}, output);
  output.append((opt_data.settings.enableMultiSearch) ? '<a href="#" class="btn removeSegment" style="display:none">- Remover trecho</a>' : '');
  if (!opt_sb) return output.toString();
};


SearchEngine.passengers = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label for="air_travelers_check">Viajantes</label><input id="air_travelers_check" type="checkbox" name="air_travelers_check"><div class="content"><label class="adults select">', (! opt_data.settings.version) ? '<p>Adultos: <small> + 12 anos</small></p>' : 'Adultos: <small> + 12 anos</small>');
  SearchEngine.selectPassengersQtd({Id: 'drpAdultsQtd', Class: 'ddlQtdAdults air_drpAdultsQtd', Qtd: opt_data.settings.maxAdults, StartFrom: 1}, output);
  output.append('</label><label class="children select">', (! opt_data.settings.version) ? '<p>CrianÃ§as: <small> 2 a 11 anos</small></p>' : 'CrianÃ§as: <small> 2 a 11 anos</small>');
  SearchEngine.selectPassengersQtd({Id: 'drpChildrenQtd', Class: 'ddlQtdChildrens air_drpChildrenQtd', Qtd: opt_data.settings.maxChildren, StartFrom: 0}, output);
  output.append('</label><label class="babies select">', (! opt_data.settings.version) ? '<p>BebÃªs: <small> 0 a 23 meses</small></p>' : 'BebÃªs: <small> 0 a 23 meses</small>');
  SearchEngine.selectPassengersQtd({Id: 'drpBabiesQtd', Class: 'ddlQtdBabies air_drpBabiesQtd', Qtd: opt_data.settings.maxBabies, StartFrom: 0}, output);
  output.append('</label></div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.destinationFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t<div class="destination">');
  SearchEngine.createOriginAndDestinationFields({settings: opt_data.settings}, output);
  output.append((! opt_data.settings.version) ? '</div>' : '', (opt_data.settings.version == '1') ? '</div>' : '');
  SearchEngine.createDateFields({settings: opt_data.settings}, output);
  if (!opt_sb) return output.toString();
};


SearchEngine.createOriginAndDestinationFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t<label class="from">', (! opt_data.settings.version) ? '<p>Origem:</p>' : 'Origem:', '<input type="text" onpaste="return false" placeholder="Digite a cidade de origem" class="txtOrigin autocomplete_empty just-letters-for-locations" autocomplete="off" nextelem=".txtDestination" nextelemcontext=".destinationDiv" /><small>Origem</small></label><label class="going_to">', (! opt_data.settings.version) ? '<p>Destino:</p>' : 'Destino:', '<input type="text" onpaste="return false" placeholder="Digite a cidade de destino" class="txtDestination autocomplete_empty just-letters-for-locations" autocomplete="off" nextelem=".txtOutboundDateGo" nextelemcontext=".destinationDiv" /><small>Destino</small></label>');
  if (!opt_sb) return output.toString();
};


SearchEngine.createDateFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t<label class="date" changetext="true">', (! opt_data.settings.version) ? '<p>Ida:</p>' : 'Ida:', '<input type="text" pattern="[0-9]*" placeholder="Ida (dd/mm/aaaa)" class="txtOutboundDateGo hasDatepicker" /><small>Data da ida</small></label><label class="date ', (opt_data.settings.roundTrip == false) ? 'hide' : '', '">', (! opt_data.settings.version) ? '<p>Volta:</p>' : 'Volta:', '<input type="text" pattern="[0-9]*" placeholder="Volta (dd/mm/aaaa)" class="txtInboundDateBack hasDatepicker" /><small>Data de volta</small></label>');
  if (!opt_sb) return output.toString();
};


SearchEngine.createAirCompaniesAndCabinFilters = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t<label class="airline select">');
  SearchEngine.selectAirCompany({Id: 'drpCiaCode', TabIndex: 2, settings: opt_data.settings}, output);
  output.append('</label><label class="cabin select">');
  SearchEngine.selectCabin({Id: 'drpCabin', TabIndex: 0}, output);
  output.append('</label>');
  if (!opt_sb) return output.toString();
};


SearchEngine.baggages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t');
  SearchEngine.selectBaggageAllowance({baggageAllowances: opt_data.settings.baggageAllowances, baggageFilterSelected: opt_data.settings.baggageFilter}, output);
  output.append('<label class="no-stop"><input type="checkbox" id="chkNonStop" name="chkNonStop" /> <span>Somente voos diretos</span></label>');
  if (!opt_sb) return output.toString();
};


// This file was automatically generated from BusSearchEngine.soy.
// Please don't edit this file by hand.

if (typeof SearchEngine == 'undefined') { var SearchEngine = {}; }


SearchEngine.Bus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input class="touch research_show matrix" for="show_research" id="show_research" alue="open" type="checkbox"><label for="show_research" class="touch research matrix">Abrir</label><div class="content bus"></div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.BusContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t<!-- adiciona classe para esconder, pois o less nÃ£o serÃ¡ atualizado em todos clientes --><h1 class="matrix">Refinar Busca</h1><h2>', soy.$$escapeHtml(opt_data.settings.title), '</h2><div class="radio way"><label><input type="radio" id="chkRoundTrip" name="tripType" value="1" checked="checked" class="chkOneWay" /><span>Ida e volta</span></label><label><input type="radio" id="chkOneWay" name="tripType" value="2" ', (opt_data.settings.roundtrip == false) ? 'checked="checked"' : '', ' class="chkRoundTrip" /><span>Somente ida</span></label></div><div class="destinationContainer">');
  SearchEngine.destination({settings: opt_data.settings}, output);
  output.append('</div>');
  SearchEngine.searchButton({isHome: opt_data.isHome}, output);
  if (!opt_sb) return output.toString();
};


SearchEngine.destination = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="destinationDiv">');
  SearchEngine.destinationFields({settings: opt_data.settings}, output);
  if (!opt_sb) return output.toString();
};


SearchEngine.destinationFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t<div class="destination">');
  SearchEngine.createOriginAndDestinationFields({settings: opt_data.settings}, output);
  output.append((! opt_data.settings.version) ? '</div>' : '', (opt_data.settings.version == '1') ? '</div>' : '');
  SearchEngine.createDateFields({settings: opt_data.settings}, output);
  if (!opt_sb) return output.toString();
};


SearchEngine.createOriginAndDestinationFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t<label class="from">', (! opt_data.settings.version) ? '<p>Origem:</p>' : 'Origem:', '<input type="text" onpaste="return false" placeholder="Digite a cidade de origem" class="txtOrigin autocomplete_empty just-letters-for-locations" autocomplete="off" nextelem=".txtDestination" nextelemcontext=".destinationDiv" /><small>Origem</small></label><label class="going_to">', (! opt_data.settings.version) ? '<p>Destino:</p>' : 'Destino:', '<input type="text" onpaste="return false" placeholder="Digite a cidade de destino" class="txtDestination autocomplete_empty just-letters-for-locations" autocomplete="off" nextelem=".txtOutboundDateGo" nextelemcontext=".destinationDiv" /><small>Destino</small></label>');
  if (!opt_sb) return output.toString();
};


SearchEngine.createDateFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t<label class="date" changetext="true">', (! opt_data.settings.version) ? '<p>Ida:</p>' : 'Ida:', '<input type="text" pattern="[0-9]*" placeholder="Ida (dd/mm/aaaa)" class="txtOutboundDateGo hasDatepicker" /><small>Data da ida</small></label><label class="date ', (opt_data.settings.roundTrip == false) ? 'hide' : '', '">', (! opt_data.settings.version) ? '<p>Volta:</p>' : 'Volta:', '<input type="text" pattern="[0-9]*" placeholder="Volta (dd/mm/aaaa)" class="txtInboundDateBack hasDatepicker" /><small>Data de volta</small></label>');
  if (!opt_sb) return output.toString();
};


// This file was automatically generated from HotelSearchEngine.soy.
// Please don't edit this file by hand.

if (typeof SearchEngine == 'undefined') { var SearchEngine = {}; }


SearchEngine.Hotel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input class="touch matrix research_show" for="show_research" id="show_research" alue="open" type="checkbox"><label for="show_research" class="touch matrix research">Abrir</label><div class="content hotel"></div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.HotelContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.settings.renderTitle) ? '<h1 class="matrix">Refinar Busca</h1><h2>' + soy.$$escapeHtml(opt_data.settings.title) + '</h2>' : '', '<div class="destination">', (opt_data.settings.renderLocation) ? '<label class="city hotelCity"><p>Digite a cidade de seu hotel:</p><input placeholder="Digite a cidade de seu hotel" type="text" id="txtLocation" onpaste="return false" class="autocomplete_empty just-letters-for-locations" autocomplete="off" nextelem="#txtCheckIn" /><small>Digite a cidade de seu hotel</small></label>' : '', (! opt_data.settings.version) ? '</div>' : '', '<label class="date departure"><p>Chegada:</p><input pattern="[0-9]*" placeholder="Chegada" type="text" id="txtCheckIn" class="txtCheckinHotelDate hasDatepicker" autocomplete="off" /><small> Data de chegada</small></label><label class="date going-to"><p>SaÃ­da:</p><input pattern="[0-9]*" placeholder="SaÃ­da" type="text" id="txtCheckOut" class="txtCheckoutHotelDate hasDatepicker" autocomplete="off" /><small> Data de saÃ­da</small></label><label class="label name_hotel"><p>Nome do hotel (opcional):</p><input class="hotelName" placeholder="Nome do hotel (opcional)" type="text" name="name_hotel" ondragstart="return false" ondrop="return false"><small>Nome do hotel (opcional)</small></label>', (opt_data.settings.version == '1') ? '</div>' : '', '<div class="advanced travelers"><label for="hotel_travelers_check">Viajantes</label><input id="hotel_travelers_check" type="checkbox" name="hotel_travelers_check"><div class="content"><label class="qtdaRoom rooms_number select"><p>Quartos</p><select id="drpRoomsQtd" class="hotel_drpRoomsQtd"><option selected="selected" value="1">1</option>');
  for (var i70 = 2; i70 < 4; i70++) {
    output.append('<option value="', soy.$$escapeHtml(i70), '">', soy.$$escapeHtml(i70), '</option>');
  }
  output.append('</select></label>', (opt_data.settings.version == '1') ? '<div class="qty_rooms"><div class="type_rooms">' : '', '<ul class="listRoomsSearchEngine rooms">');
  for (var i81 = 0; i81 < 4; i81++) {
    SearchEngine.hotelSearchEngineRoom({roomIndex: i81, maxGuestQuantities: opt_data.settings.maxGuestQuantities, maxGuestChildrenQuantities: opt_data.settings.maxGuestChildrenQuantities, settings: opt_data.settings}, output);
  }
  output.append('</ul>', (opt_data.settings.version == '1') ? '</div></div>' : '', '</div></div>');
  SearchEngine.searchButton({isHome: opt_data.isHome}, output);
  if (!opt_sb) return output.toString();
};


SearchEngine.hotelSearchEngineRoom = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="search-engine-roomContainer ', (opt_data.roomIndex > 0) ? 'hide' : '', '" roomindex="', soy.$$escapeHtml(opt_data.roomIndex), '"><strong>Quarto <span>', soy.$$escapeHtml(opt_data.roomIndex + 1), '</span></strong><label class="select adults">', (! opt_data.settings.version) ? '<p>Adultos:<small>+ de 18 anos</small></p>' : '', (opt_data.settings.version == '1') ? '<p>Adultos:</p><small>+ de 18 anos</small>' : '', '<select id="drpAdultsQtdRoom', soy.$$escapeHtml(opt_data.roomIndex), '" class="hotel_drpAdults" data-roomIndex="', soy.$$escapeHtml(opt_data.roomIndex + 1), '">');
  var iLimit127 = opt_data.maxGuestQuantities;
  for (var i127 = 1; i127 < iLimit127; i127++) {
    output.append('<option value="', soy.$$escapeHtml(i127), '" ', (i127 == 1) ? 'selected' : '', '>', soy.$$escapeHtml(i127), '</option>');
  }
  output.append('</select></label><label class="select children">', (opt_data.settings.version == '1') ? '<p>CrianÃ§as:</p><small>0 a 17 anos</small>' : '', (! opt_data.settings.version) ? '<p>CrianÃ§as:<small>0 a 17 anos</small></p>' : '', '<select id="drpChildrenQtdRoom', soy.$$escapeHtml(opt_data.roomIndex), '" class="childrensQtdRoom hotel_childrensQtdRoom" data-roomIndex="', soy.$$escapeHtml(opt_data.roomIndex + 1), '">');
  var iLimit161 = opt_data.maxGuestChildrenQuantities;
  for (var i161 = 0; i161 < iLimit161; i161++) {
    output.append('<option value="', soy.$$escapeHtml(i161), '" ', (i161 == 0) ? 'selected' : '', '>', soy.$$escapeHtml(i161), '</option>');
  }
  output.append('</select></label><div class="select_box child_years_old child-ages hide"><strong>Idade de cada crianÃ§a:</strong>');
  var iLimit175 = opt_data.maxGuestChildrenQuantities;
  for (var i175 = 0; i175 < iLimit175; i175++) {
    output.append('<label class="select hide roomChildAges ages"><select id="drpChildAge', soy.$$escapeHtml(opt_data.roomIndex), soy.$$escapeHtml(i175), '">');
    for (var i180 = 0; i180 < 18; i180++) {
      output.append((i180 == 0) ? '<option value="' + soy.$$escapeHtml(i180) + '" selected><1 ano</option>' : '<option value="' + soy.$$escapeHtml(i180) + '">' + soy.$$escapeHtml(i180) + '</option>');
    }
    output.append('</select></label>');
  }
  output.append('</div></li>');
  if (!opt_sb) return output.toString();
};


ï»¿var HotelExtensions = HotelExtensions || {};

HotelExtensions.PrepareFunctions = HotelExtensions.PrepareFunctions || {};

HotelExtensions.SortingFunctions = HotelExtensions.SortingFunctions || {};

HotelExtensions.PrepareFunctions.Hotel = function (hotel, currentDate) {
    var _internalStore = hotel;
    hotel.extended = true;

    if (!hotel.getTotalGuests) // Usamos o getTotalGuests apenas para checar se a variavel hotel jÃ¡ estÃ¡ extendido
        hotel = new Hotel(hotel);

    hotel.AuxiliarData = hotel.AuxiliarData || {};
    hotel.AuxiliarData.MarkupAmount = 0;
    hotel.AuxiliarData.TotalAmount = 0;
    hotel.AuxiliarData.FareAmount = 0;
    hotel.AuxiliarData.AverageFareAmountByDay = 0;
    hotel.AuxiliarData.AverageTotalAmountByDayNonFormatted = 0;
    hotel.AuxiliarData.AverageFareAmountByGuestNonFormatted = 0;
    hotel.AuxiliarData.AveragePointsAmountByGuest = 0;
    hotel.AuxiliarData.AveragePointsAmountByDayNonFormatted = 0;
    hotel.AuxiliarData.OriginalFareAmount = 0;
    hotel.AuxiliarData.OriginalTotalAmount = 0;
    hotel.AuxiliarData.OriginalAverageFareAmountByDay = 0;
    hotel.AuxiliarData.OriginalAverageTotalAmountByDay = 0;
    hotel.AuxiliarData.FeeAmountAsTax = 0;
    hotel.AuxiliarData.FeeAmount = 0;
    hotel.AuxiliarData.TaxAmount = 0;
    hotel.AuxiliarData.AverageTaxAmountByDay = 0;
    hotel.AuxiliarData.OriginalTaxAmount = 0;

    hotel.AuxiliarData.Points = hotel.AuxiliarData.Points || {};
    hotel.AuxiliarData.Points.TotalPoints = 0;

    var cheapestRooms = [];
    for (var i = 0; i < hotel.RoomsGroups.length; i++) {
        var roomGroup = hotel.RoomsGroups[i];
        for (var j = 0; j < roomGroup.Rooms.length; j++) {

            var room = roomGroup.Rooms[j];

            var processId = room.ExternalProperties.first(function (a) { return a.Key === 'ProcessId'; });
            if (processId && i === 0 && !room.OtherGroupNames) {
                room.OtherGroupNames = [];
                var rProcessId = processId.Value;
                for (var l = 1; l < hotel.RoomsGroups.length; l++) {
                    var nextRoomGroup = hotel.RoomsGroups[l];
                    for (var k = 0; k < nextRoomGroup.Rooms.length; k++) {
                        var nextRoom = nextRoomGroup.Rooms[k];
                        var nextRoomProcessId = nextRoom.ExternalProperties.first(function (a) { return a.Key === 'ProcessId'; }).Value;
                        if (nextRoomProcessId === rProcessId) {
                            room.OtherGroupNames.push(l + 1 + ': ' + nextRoom.Name);
                            break;
                        }
                    }
                }
            }

            if (room.ReservationInfo) {

                if (room.ReservationInfo.CancelDeadLineDateValues && room.ReservationInfo.SaleType != EnumHelper.HotelSaleType.OnRequest) {
                    var date = Util.DateValuesToDate(room.ReservationInfo.CancelDeadLineDateValues);

                    if (!hotel.AuxiliarData.CancelDeadLineDate || hotel.AuxiliarData.CancelDeadLineDate > date) {
                        hotel.AuxiliarData.CancelDeadLineDate = date;
                        hotel.AuxiliarData.CancelDeadLineDateValues = room.ReservationInfo.CancelDeadLineDateValues;
                        hotel.AuxiliarData.CancelDeadLineDateValuesFormatted = formatter.dateValuesShort(room.ReservationInfo.CancelDeadLineDateValues) + " " + formatter.timeValuesShort(room.ReservationInfo.CancelDeadLineDateValues);
                    }
                }

                if (room.ReservationInfo.CancellationPolicies.length) {
                    hotel.AuxiliarData.CancellationPolicies = room.ReservationInfo.CancellationPolicies;
                }
            }

            roomGroup.Rooms[j] = HotelExtensions.PrepareFunctions.Room(room);
        }

        var minRoom = roomGroup.Rooms.getItemByMin(function (r) { return r.AuxiliarData.StayOption.AuxiliarData.TotalAmountNonFormatted; });

        if (minRoom)
            cheapestRooms.push(minRoom);
    }

    hotel.AuxiliarData.DisableButtons = hotel.RoomsGroups.all(function (rg) { return rg.Rooms.all(function (r) { return !r.StayOptions[0].CanBook; }) });

    if (cheapestRooms && cheapestRooms.length) {

        hotel.AuxiliarData.TotalGuests = hotel.getTotalGuests();

        var cheapestRoom = null;
        for (var i = 0; i < cheapestRooms.length; i++) {
            var room = cheapestRooms[i];
            var soAuxData = room.AuxiliarData.StayOption.AuxiliarData;

            hotel.AuxiliarData.MarkupAmount += soAuxData.TotalMarkupNonFormatted;
            hotel.AuxiliarData.TotalAmount += soAuxData.TotalAmountNonFormatted;
            hotel.AuxiliarData.FareAmount += soAuxData.FareAmountNonFormatted;
            hotel.AuxiliarData.TaxAmount += soAuxData.TaxAmountNonFormatted;
            hotel.AuxiliarData.AverageFareAmountByDay += soAuxData.FareAmountNonFormatted / soAuxData.DaysCount;
            hotel.AuxiliarData.AverageTaxAmountByDay += soAuxData.TaxAmountNonFormatted / soAuxData.DaysCount;
            hotel.AuxiliarData.AverageTotalAmountByDayNonFormatted += soAuxData.TotalAmountNonFormatted / soAuxData.DaysCount;
            hotel.AuxiliarData.AverageTotalAmountByGuestNonFormatted += soAuxData.TotalAmountNonFormatted / hotel.AuxiliarData.TotalGuests;

            hotel.AuxiliarData.AveragePointsAmountByGuest += soAuxData.PointsAmount / hotel.AuxiliarData.TotalGuests;
            hotel.AuxiliarData.AveragePointsAmountByDayNonFormatted += soAuxData.PointsAmount / soAuxData.DaysCount;
            hotel.AuxiliarData.FeeAmountAsTax += room.AuxiliarData.StayOption.getFeeAmount(true, 1);
            hotel.AuxiliarData.FeeAmount += room.AuxiliarData.StayOption.getFeeAmount(false, 1);

            hotel.AuxiliarData.OriginalFareAmount += soAuxData.OriginalFareAmountNonFormatted;
            hotel.AuxiliarData.OriginalTotalAmount += soAuxData.OriginalTotalAmountNonFormatted;
            hotel.AuxiliarData.OriginalTaxAmount += soAuxData.OriginalTaxAmountNonFormatted;
            hotel.AuxiliarData.OriginalAverageFareAmountByDay += soAuxData.OriginalFareAmountNonFormatted / soAuxData.DaysCount;
            hotel.AuxiliarData.OriginalAverageTaxAmountByDay += soAuxData.OriginalTaxAmountNonFormatted / soAuxData.DaysCount;
            hotel.AuxiliarData.OriginalAverageTotalAmountByDay += soAuxData.OriginalTotalAmountNonFormatted / soAuxData.DaysCount;

            if (!cheapestRoom || soAuxData.TotalAmountNonFormatted < cheapestRoom.AuxiliarData.StayOption.AuxiliarData.TotalAmountNonFormatted)
                cheapestRoom = room;

            if (soAuxData.Points && soAuxData.Points.TotalPoints) {
                hotel.AuxiliarData.Points.TotalPoints += parseFloat(soAuxData.Points.TotalPoints.replaceAll(',', '.'));
            }
        }

        hotel.AuxiliarData.OriginalCurrency = cheapestRoom.AuxiliarData.StayOption.OriginalDailyFare.CurrencyCode;
        hotel.AuxiliarData.Currency = cheapestRoom.AuxiliarData.StayOption.DailyFare.CurrencyCode;
        hotel.AuxiliarData.ShowOriginalAmounts = hotel.AuxiliarData.OriginalCurrency != hotel.AuxiliarData.Currency || hotel.AuxiliarData.DisableButtons;

        hotel.AuxiliarData.CheckInValues = formatter.dateValuesShort(cheapestRoom.AuxiliarData.StayOption.CheckInValues);
        hotel.AuxiliarData.CheckInHourValue = formatter.timeValuesShort(cheapestRoom.AuxiliarData.StayOption.CheckInValues);
        hotel.AuxiliarData.CheckOutValues = formatter.dateValuesShort(cheapestRoom.AuxiliarData.StayOption.CheckOutValues);
        hotel.AuxiliarData.CheckOutHourValue = formatter.timeValuesShort(cheapestRoom.AuxiliarData.StayOption.CheckOutValues);
        hotel.AuxiliarData.DaysCount = cheapestRoom.AuxiliarData.StayOption.AuxiliarData.DaysCount;

        if (currentDate && !hotel.AuxiliarData.CurrentDate) {
            hotel.AuxiliarData.CurrentDate = Util.DateValuesToDate(currentDate);
            if (!hotel.AuxiliarData.CurrentDate)
                hotel.AuxiliarData.CurrentDate = currentDate;
        }

        if (hotel.Description == null)
            hotel.Description = "";

        hotel.AuxiliarData.NameNormalized = hotel.Name ? hotel.Name.normalize() : "";

        hotel.Description = hotel.Description.replaceAll("&lt;", '<').replaceAll("&gt;", '>');

        hotel.AuxiliarData.ShortDescription = hotel.Description ? Util.CutText(hotel.Description, 190) : "";
        hotel.AuxiliarData.StrippedHtmlShortDescription = Util.StripHtml(hotel.AuxiliarData.ShortDescription);

        hotel.AuxiliarData.HasLoyalty = function () { return false; };

        hotel.AuxiliarData.CheapestPointsAmount = formatter.currency(cheapestRoom.AuxiliarData.StayOption.AuxiliarData.TotalPointsAmount, false, 0, hotel.AuxiliarData.Currency);
        hotel.AuxiliarData.DailyFare = cheapestRoom.AuxiliarData.StayOption.AuxiliarData.DailyFare;
        hotel.AuxiliarData.CheapestDailyFare = formatter.currency(hotel.AuxiliarData.DailyFare, true, 2, hotel.AuxiliarData.Currency);

        hotel.AuxiliarData.FareAmountFormatted = formatter.currency(hotel.AuxiliarData.FareAmount, true, 2, hotel.AuxiliarData.Currency);
        hotel.AuxiliarData.TotalAmountFormatted = formatter.currency(hotel.AuxiliarData.TotalAmount, true, 2, hotel.AuxiliarData.Currency);
        hotel.AuxiliarData.TaxAmountFormatted = formatter.currency(hotel.AuxiliarData.TaxAmount, true, 2, hotel.AuxiliarData.Currency);
        hotel.AuxiliarData.AverageFareAmountByDayFormatted = formatter.currency(hotel.AuxiliarData.AverageFareAmountByDay, true, 2, hotel.AuxiliarData.Currency);
        hotel.AuxiliarData.AverageTaxAmountByDayFormatted = formatter.currency(hotel.AuxiliarData.AverageTaxAmountByDay, true, 2, hotel.AuxiliarData.Currency);

        if (cheapestRoom.AuxiliarData.StayOption.Services) {
            hotel.AuxiliarData.ServicesTotalValue = cheapestRoom.AuxiliarData.StayOption.Services.sum(function (s) { return s.Fare.Value });
            hotel.AuxiliarData.ServicesTotalValueFormatted = formatter.currency(hotel.AuxiliarData.ServicesTotalValue, true, 2, hotel.AuxiliarData.Currency);
        } else {
            hotel.AuxiliarData.ServicesTotalValueFormatted = "";
        }

        if (cheapestRoom.AuxiliarData.StayOption.Board) {
            hotel.AuxiliarData.BoardValue = cheapestRoom.AuxiliarData.StayOption.Board.Fare.Value;
            hotel.AuxiliarData.BoardValueFormatted = formatter.currency(hotel.AuxiliarData.BoardValue, true, 2, cheapestRoom.AuxiliarData.StayOption.Board.Fare.CurrencyCode);
        } else {
            hotel.AuxiliarData.BoardValueFormatted = "";
        }

        if (hotel.AuxiliarData.DisableButtons) {
            hotel.AuxiliarData.TotalAmountFormatted = "";
            hotel.AuxiliarData.TaxAmountFormatted = "";
            hotel.AuxiliarData.AverageTaxAmountByDayFormatted = "";
            hotel.AuxiliarData.FareAmountFormatted = "";
            hotel.AuxiliarData.AverageFareAmountByDayFormatted = "";
        }

        hotel.AuxiliarData.OriginalFareAmountFormatted = "";
        hotel.AuxiliarData.OriginalTotalAmountFormatted = "";
        hotel.AuxiliarData.OriginalTaxAmountFormatted = "";

        hotel.AuxiliarData.NeedExchangeRate = hotel.AuxiliarData.ShowOriginalAmounts;
        hotel.AuxiliarData.HasExchangeRate = hotel.AuxiliarData.OriginalFareAmount != hotel.AuxiliarData.FareAmount;
        if (hotel.AuxiliarData.HasExchangeRate) {
            hotel.AuxiliarData.OriginalFareAmountFormatted = formatter.currency(hotel.AuxiliarData.OriginalFareAmount, true, 2, hotel.AuxiliarData.OriginalCurrency);
            hotel.AuxiliarData.OriginalTotalAmountFormatted = formatter.currency(hotel.AuxiliarData.OriginalTotalAmount, true, 2, hotel.AuxiliarData.OriginalCurrency);
            hotel.AuxiliarData.OriginalTaxAmountFormatted = formatter.currency(hotel.AuxiliarData.OriginalTaxAmount, true, 2, hotel.AuxiliarData.OriginalCurrency);

        }

        hotel.AuxiliarData.OriginalAverageFareAmountByDayFormatted = "";
        if (hotel.AuxiliarData.OriginalAverageFareAmountByDay != hotel.AuxiliarData.AverageFareAmountByDay)
            hotel.AuxiliarData.OriginalAverageFareAmountByDayFormatted = formatter.currency(hotel.AuxiliarData.OriginalAverageFareAmountByDay, true, 2, hotel.AuxiliarData.OriginalCurrency);

        hotel.AuxiliarData.OriginalAverageTotalAmountByDayFormatted = "";
        if (hotel.AuxiliarData.OriginalAverageTotalAmountByDay != hotel.AuxiliarData.AverageTotalAmountByDay)
            hotel.AuxiliarData.OriginalAverageTotalAmountByDayFormatted = formatter.currency(hotel.AuxiliarData.OriginalAverageTotalAmountByDay, true, 2, hotel.AuxiliarData.OriginalCurrency);

        hotel.AuxiliarData.TotalAmountFormatted = formatter.currency(hotel.AuxiliarData.TotalAmount, true, 2, hotel.AuxiliarData.Currency);

        if (hotel.AuxiliarData.MarkupAmount)
            hotel.AuxiliarData.MarkupAmountFormatted = formatter.currency(hotel.AuxiliarData.MarkupAmount, true, 2, hotel.AuxiliarData.Currency);

        hotel.AuxiliarData.AverageTotalAmountByDay = formatter.currency(hotel.AuxiliarData.AverageTotalAmountByDayNonFormatted, true, 2, hotel.AuxiliarData.Currency);
        hotel.AuxiliarData.AverageFareAmountByGuest = formatter.currency(hotel.AuxiliarData.AverageFareAmountByGuestNonFormatted, true, 2, hotel.AuxiliarData.Currency);

        hotel.AuxiliarData.CheapestAveragePointsAmountByDay = formatter.currency(hotel.AuxiliarData.CheapestPointsAmount / cheapestRoom.AuxiliarData.StayOption.AuxiliarData.DaysCount, false, 0, hotel.AuxiliarData.Currency);
        hotel.AuxiliarData.CheapestAveragePointsAmountByGuest = formatter.currency(hotel.AuxiliarData.CheapestPointsAmount / hotel.AuxiliarData.TotalGuests, false, 0, hotel.AuxiliarData.Currency);

        hotel.AuxiliarData.AveragePointsAmountByGuest = hotel.AuxiliarData.AveragePointsAmountByGuestNonFormatted;

        hotel.AuxiliarData.AveragePointsAmountByDay = formatter.currency(hotel.AuxiliarData.AveragePointsAmountByDayNonFormatted, false, 0, hotel.AuxiliarData.Currency);

        hotel.RoomsGroups.orderBy(function (rg) { return rg.SearchIndex; });

        hotel.AuxiliarData.CheckInHourValue = "";
        hotel.AuxiliarData.CheckOutHourValue = "";

        hotel.AuxiliarData.Installments = cheapestRoom.AuxiliarData.StayOption.Installments;

        var installmentPrice = cheapestRoom.AuxiliarData.StayOption.AuxiliarData.InstallmentPrice;

        if (installmentPrice) {
            hotel.AuxiliarData.CheapestInstallmentsFareAmountByDay = formatter.currency(installmentPrice / cheapestRoom.AuxiliarData.StayOption.AuxiliarData.DaysCount, true, 2);

            hotel.AuxiliarData.CheapestInstallmentsFareAmountByGuest = formatter.currency(installmentPrice / hotel.AuxiliarData.TotalGuests, true, 2);
        }

        if (hotel.AuxiliarData.Points.TotalPoints) {
            hotel.AuxiliarData.Points.TotalPointsFormatted = hotel.AuxiliarData.Points.TotalPoints + ' Pontos';
        }
    }

    hotel.AuxiliarData.Stars = hotel.getStarsTypes();

    if (hotel.Address) {
        hotel.AuxiliarData.Address = hotel.getFullAddress(hotel.Address);

        if (hotel.Address.Location) {
            hotel.AuxiliarData.Location = hotel.Address.Location.FullNameWithIATA;
        }

        if (hotel.Address.DistanceToCenterCity)
            hotel.AuxiliarData.DistanceToCenterCity = hotel.formatDistance(hotel.Address.DistanceToCenterCity);

        if (hotel.Address.DistanceToNearestAirport)
            hotel.AuxiliarData.DistanceToNearestAirport = hotel.formatDistance(hotel.Address.DistanceToNearestAirport);

        hotel.AuxiliarData.HasCoordinates = hotel.Address.Latitude || hotel.Address.Longitude;
    }

    if (hotel.Images && hotel.Images.Image)
        hotel.Images = hotel.Images.Image;

    hotel.AuxiliarData.ThumbImageUrl = hotel.getThumbImage();
    hotel.AuxiliarData.HasImages = hotel.Images && hotel.Images.length && hotel.Images.any(function (c) { return !c.ThumbImage; });

    if (hotel.AuxiliarData.ThumbImageUrl) {
        hotel.AuxiliarData.ThumbImageUrl = Util.ParseImagesUrl(hotel.AuxiliarData.ThumbImageUrl.Url);
    }

    hotel.AuxiliarData.Category = hotel.Category && hotel.Category != null && hotel.Category != "" ? hotel.Category : Resources.translate({ code: "NÃ£o Informado" });
    hotel.AuxiliarData.SafeCovid = hotel.Services.any(s => s.Name.normalizedEquals("Stay Safe"));

    if (hotel.CheckInHourValue)
        hotel.AuxiliarData.CheckInHourValue = formatter.timeValuesShort(hotel.CheckInHourValue);

    if (hotel.CheckOutHourValue)
        hotel.AuxiliarData.CheckOutHourValue = formatter.timeValuesShort(hotel.CheckOutHourValue);

    if (hotel.AuxiliarData.CheckInValues) {
        hotel.AuxiliarData.CheckInDateFormatted = hotel.AuxiliarData.CheckInValues;
        if (hotel.AuxiliarData.CheckInHourValue && hotel.AuxiliarData.CheckInHourValue != "")
            hotel.AuxiliarData.CheckInDateFormatted = hotel.AuxiliarData.CheckInDateFormatted + " " + hotel.AuxiliarData.CheckInHourValue;
    }

    if (hotel.AuxiliarData.CheckOutValues) {
        hotel.AuxiliarData.CheckOutDateFormatted = hotel.AuxiliarData.CheckOutValues;
        if (hotel.AuxiliarData.CheckOutHourValue && hotel.AuxiliarData.CheckOutHourValue != "")
            hotel.AuxiliarData.CheckOutDateFormatted = hotel.AuxiliarData.CheckOutDateFormatted + " " + hotel.AuxiliarData.CheckOutHourValue;
    }

    var fakeRoomBrokers = ["Sabre", "Travelport"];

    hotel.AuxiliarData.ShowDetails = true;

    hotel.AuxiliarData.HasCommercialAgreementMath = hotel.AuxiliarData.ExternalProperties && hotel.AuxiliarData.ExternalProperties.CommercialAgreementMath && hotel.AuxiliarData.ExternalProperties.CommercialAgreementMath.length > 0;
    if (hotel.AuxiliarData.HasCommercialAgreementMath)
        hotel.AuxiliarData.CommercialAgreementMatched = hotel.AuxiliarData.ExternalProperties.CommercialAgreementMath;

    hotel.AuxiliarData.NeedMooreInfo = false;
    hotel.AuxiliarData.IsDraggable = true;

    if (hotel.HotelBrokers && hotel.HotelBrokers.any(function (b) { return fakeRoomBrokers.indexOf(b.Key) > -1; })) {
        if (hotel.RoomsGroups.any(function (rg) { return rg.Rooms.any(function (r) { return r.Fake; }) })) {
            hotel.AuxiliarData.DisableButtons = true;
            hotel.AuxiliarData.IsDraggable = false;
            hotel.AuxiliarData.NeedMooreInfo = true;
        }
    }

    hotel.AuxiliarData.IsFullOnRequest = hotel.RoomsGroups.all(function (rg) { return rg.Rooms.all(function (r) { return r.ReservationInfo && r.ReservationInfo.SaleType == EnumHelper.HotelSaleType.OnRequest; }); });

    hotel.AuxiliarData.NumberOfAdults = hotel.RoomsGroups.sum(function (r) { return r.Adults; });
    hotel.AuxiliarData.NumberOfChild = hotel.RoomsGroups.sum(function (r) { return r.ChildAges.length; });

    hotel.HasCompatibleStayOptions = true;

    hotel.AuxiliarData.ExtraInfoFormatted = "";
    if (hotel.ExtraInfo && hotel.ExtraInfo.EssentialInformations && hotel.ExtraInfo.EssentialInformations.length)
        hotel.AuxiliarData.ExtraInfoFormatted = hotel.ExtraInfo.EssentialInformations.join('\n');

    if (hotel.RoomsGroups.length && hotel.RoomsGroups[0].Rooms.length && hotel.RoomsGroups[0].Rooms[0].StayOptions.length) {
        var firstStayOption = hotel.RoomsGroups[0].Rooms[0].StayOptions[0];
        hotel.AuxiliarData.OriginalFare = firstStayOption.OriginalDailyFare.Value;
        hotel.AuxiliarData.OriginalFareFormatted = formatter.currency(hotel.AuxiliarData.OriginalFare, true, 2, hotel.AuxiliarData.OriginalCurrency);
        hotel.AuxiliarData.OriginalMarkupedFare = firstStayOption.AuxiliarData.FareAmountByDay / parseFloat(firstStayOption.AuxiliarData.ExchangeRate);
        hotel.AuxiliarData.OriginalMarkupedFareFormatted = formatter.currency(hotel.AuxiliarData.OriginalMarkupedFare, true, 2, hotel.AuxiliarData.OriginalCurrency);
    }

    hotel.HasObservations = (typeof hotel.Observations === "string" && hotel.Observations !== "");

    hotel.getCheapestRooms = function () {
        var resp = [];
        for (var i = 0; i < _internalStore.RoomsGroups.length; i++) {
            var roomGroup = _internalStore.RoomsGroups[i];
            var minRoom = roomGroup.Rooms.getItemByMin(function (r) { return r.AuxiliarData.StayOption.AuxiliarData.TotalAmountNonFormatted; });
            if (minRoom)
                resp.push(minRoom);
        }
        return resp;
    };

    hotel.getSelectedTotalAmount = function () {
        var rooms = _internalStore.Rooms;

        if (!rooms)
            rooms = _internalStore.getCheapestRooms();

        if (rooms && rooms.length) {
            var validRooms = rooms.where(function (r) {
                return r.AuxiliarData.StayOption
                    && r.AuxiliarData.StayOption.AuxiliarData;
            });

            return validRooms.sum(function (r) {
                return r.AuxiliarData.StayOption.AuxiliarData.TotalAmountNonFormatted;
            });
        }

        return 0;
    }

    hotel.getSelectedTotalPointsAmount = function () {
        var rooms = _internalStore.Rooms;

        if (!rooms)
            rooms = _internalStore.getCheapestRooms();

        if (rooms && rooms.length) {
            var validRooms = rooms.where(function (r) {
                return r.AuxiliarData.StayOption
                    && r.AuxiliarData.StayOption.AuxiliarData
                    && (r.AuxiliarData.StayOption.AuxiliarData.TotalPointsAmount || (r.AuxiliarData.StayOption.AuxiliarData.Points && r.AuxiliarData.StayOption.AuxiliarData.Points.TotalPoints));
            });

            if (Global.InterfaceEnvelope && Global.InterfaceEnvelope.PointsAndMoneyViewOption) {
                return validRooms.sum(function (r) { return eval(r.AuxiliarData.StayOption.AuxiliarData.Points.TotalPoints); });
            } else {
                return validRooms.sum(function (r) { return r.AuxiliarData.StayOption.AuxiliarData.TotalPointsAmount; });
            }
        }

        return 0;
    }

    hotel.getSelectedTotalPartialPointsAmount = function () {
        var rooms = _internalStore.Rooms;
        if (!rooms)
            rooms = _internalStore.getCheapestRooms();

        if (rooms && rooms.length) {
            var validRooms = rooms.where(function (r) {
                return r.AuxiliarData.StayOption
                    && r.AuxiliarData.StayOption.AuxiliarData
                    && (r.AuxiliarData.StayOption.AuxiliarData.Points && r.AuxiliarData.StayOption.AuxiliarData.Points.PartialPoints);
            });

            return validRooms.sum(function (r) { return eval(r.AuxiliarData.StayOption.AuxiliarData.Points.PartialPoints); });
        }

        return 0;
    }

    hotel.hasLoyalty = function () {
        return (_internalStore.RoomsGroups
            && _internalStore.RoomsGroups.length
            && _internalStore.RoomsGroups[0].Rooms
            && _internalStore.RoomsGroups[0].Rooms.length
            && _internalStore.RoomsGroups[0].Rooms[0].StayOptions[0].Loyalty) ? true : false;
    };

    return hotel;
};

var Hotel = HotelExtensions.Hotel = function (hotel, currentDate) {

    var _internalStore = hotel;
    var _this = hotel;

    hotel.dettach = function () {
        return _internalStore;
    };

    var keyValueToObj = function (dic) {
        var obj = {};

        if (dic) {
            for (var i = 0; i < dic.length; i++) {
                obj[dic[i].Key] = dic[i].Value;
            }
        }

        return obj;
    };

    function _instanceExternalProperties() {
        if (!_internalStore.ExternalProperties || !$.isArray(_internalStore.ExternalProperties))
            _internalStore.ExternalProperties = [];
    }

    hotel.AuxiliarData = {
        HotelBrokers: keyValueToObj(hotel.HotelBrokers),
        ExternalProperties: keyValueToObj(hotel.ExternalProperties)
    };

    hotel.getStarsTypes = function (numberOfGoldTypes) {

        var stars = ["silver", "silver", "silver", "silver", "silver"];

        var i = 0;

        for (i; i < _internalStore.Stars; i++)
            stars[i] = "gold";

        if (_internalStore.Stars < i)
            stars[i - 1] = "half";

        return stars;
    };

    hotel.getFullAddress = function () {

        var resp = "";

        var address = _internalStore.Address;

        if (address) {

            if (address.Street)
                resp += address.Street;

            if (address.Number)
                resp += (resp.length ? ", " : "") + address.Number;

            if (address.District)
                resp += " - " + address.District;

            if (address.Location && address.Location.Name) {
                var concatLocation = _internalStore.ExternalProperties.first(function (ep) { return ep.Key == "ConcatLocation"; });
                if (!concatLocation || concatLocation.Value == "true")
                    resp += " - " + address.Location.Name;
            }

            if (address.PostalCode)
                resp += " - " + address.PostalCode;
        }

        return resp;
    };

    hotel.formatDistance = function (distance) {
        if (typeof distance == 'string')
            distance = parseFloat(distance);

        var distanceFormatted = distance ? distance.toFixed(2) : 0;

        return distanceFormatted < 1 ? (distanceFormatted * 1000) + " m" : formatter.distance(distanceFormatted);
    };

    hotel.update = function (obj) {
        $.extend(_internalStore, obj);

        return _internalStore;
    };

    hotel.getThumbImage = function () {

        if (_internalStore.Images && _internalStore.Images.length)
            return _internalStore.Images.first(function (h) { return h.ThumbImage; }) || _internalStore.Images[0];

        return undefined;
    };

    var loadRoomGroups = function () {
        if (!_internalStore.Rooms)
            _internalStore.Rooms = [];

        for (var i = 0; i < _internalStore.RoomsGroups.length; i++) {
            var roomGroup = _internalStore.RoomsGroups[i];

            roomGroup.HotelId = _internalStore.Id;

            if (roomGroup.Rooms) {
                $.each(roomGroup.Rooms, function () {
                    var room = this;
                    if (!_internalStore.Rooms.any(function (r) { return r.Id == room.Id; }))
                        _internalStore.Rooms.push(room);
                });
            }
            if ((_internalStore.Rooms && _internalStore.Rooms.length) || !roomGroup.Rooms || roomGroup.Rooms.any(function (r) { return !r.getSelectedStayOption; })) {
                roomGroup.Rooms = [];

                if (_internalStore.Rooms && _internalStore.Rooms.length) {
                    var rooms = _internalStore.Rooms.where(function (r) { return roomGroup.RoomsIds.any(r.Id); });

                    if (rooms.length > 1)
                        rooms = rooms.distinct(function (r) { return r.Id; });

                    rooms.forEach(function (r) { roomGroup.Rooms.push(Util.Clone(r)); });
                    //roomGroup.Rooms = rooms;
                }

                roomGroup.TotalGuests = roomGroup.Adults + (roomGroup.ChildAges ? roomGroup.ChildAges.length : 0);

                for (var j = 0; j < roomGroup.Rooms.length; j++) {
                    roomGroup.Rooms[j] = new Room(roomGroup.Rooms[j], roomGroup, _internalStore.RoomsGroups);
                }
            }


        }

        delete _internalStore.Rooms;
    };

    var removeRoomGroupsWithoutRooms = function () {
        if (Util.HasCount(_internalStore.RoomsGroups)) {
            _internalStore.RoomsGroups = _internalStore.RoomsGroups.where(function (rg) { return Util.HasCount(rg.Rooms); });
        }
    }

    var verifyAndFillIataProductIdentification = function () {
        if (_internalStore.Rooms) {
            _internalStore.Rooms.forEach(
                function (r) {
                    var iataProductIdentification = r.ExternalProperties.first(function (ep) {
                        return ep && ep.Key == "IATAProductIdentification"
                    });
                    if (iataProductIdentification)
                        r.IATAProductIdentification = iataProductIdentification.Value;
                });
        }
    };

    hotel.getTotalGuests = function () {
        var totalGuests = 0;

        for (var i = 0; _internalStore.RoomsGroups && i < _internalStore.RoomsGroups.length; i++) {

            var roomGroup = _internalStore.RoomsGroups[i];

            totalGuests += roomGroup.Adults + (roomGroup.ChildAges && roomGroup.ChildAges.length || 0);
        }

        return totalGuests;
    };

    hotel.getHotelBroker = function (preferHotelOffline) {
        if (preferHotelOffline == "true" && _internalStore.HotelBrokers.any(function (item) { return item.Key == 'HotelOffline' })) {
            return 'HotelOffline';
        }

        return _internalStore.HotelBrokers[0].Key;
    };

    function _createHotelDetailsRoomsRequestUrl(roomsRequest) {
        var url = [];
        for (var i = 0; i < roomsRequest.length; i++) {
            if (i)
                url.push('!');
            else
                url.push('/');

            url.push(roomsRequest[i].Adults);
            for (var j = 0; j < roomsRequest[i].ChildAges.length; j++)
                url.push('-', roomsRequest[i].ChildAges[j]);
        }

        return url;
    };

    function _createHotelDetailsSearchUrl(searchData) {
        var url = [];

        if (searchData && searchData.Hotel) {
            url.push('/', formatter.dateValuesShort(searchData.Hotel.CheckIn).replaceAll('/', '-'));
            url.push('/', formatter.dateValuesShort(searchData.Hotel.CheckOut).replaceAll('/', '-'));
            url = url.concat(_createHotelDetailsRoomsRequestUrl(searchData.Hotel.RoomsRequest));
        }

        return url;
    };

    hotel.getHotelDetailPageUrl = function (searchData, preferHotelOffline) {
        var broker = _this.getHotelBroker(preferHotelOffline);
        var url = [Util.Sources[broker]];
        url.push('/', _this.AuxiliarData.HotelBrokers[broker]);

        if (_internalStore.Address && _internalStore.Address.LocationId)
            url.push('/', _internalStore.Address.LocationId);
        else if (searchData && searchData.Hotel)
            url.push('/', searchData.Hotel.LocationId);
        else
            throw "Unknown Hotel Location";

        url = url.concat(_createHotelDetailsSearchUrl(searchData));

        var noramlizedName = _internalStore.Name.removeDiacritics(); //.replaceAll(' ', '-');
        //while (noramlizedName.contains('--'))
        //    noramlizedName = noramlizedName.replaceAll('--', '-');

        url.push('/', noramlizedName);

        return url.join('');
    };

    hotel.hasActiveCancellationPolicy = function () {
        return _internalStore.RoomsGroups.any(function (rg) {
            return rg.Rooms.any(function (r) {
                return r.hasActiveCancellationPolicy();
            });
        });
    };

    _instanceExternalProperties();

    verifyAndFillIataProductIdentification();

    loadRoomGroups();
    removeRoomGroupsWithoutRooms();

    HotelExtensions.PrepareFunctions.Hotel(hotel, currentDate);

    return hotel;
};

HotelExtensions.SortingFunctions.DefaultHotelsSort = function (hotels) {

    var byPoints = function (hotel) { return hotel.getAveragePointsAmountByDay(); };

    var byPreferential = function (hotel) {
        var preferential = hotel.ExternalProperties && hotel.ExternalProperties.length && hotel.ExternalProperties.first(function (e) { return e.Key == "Preferential" });

        return !(preferential && preferential.Value.toLowerCase() == "true");
    };

    var byName = function (hotel) { return hotel.Name; };

    var byFareAmount = function (hotel) { return hotel.getFareAmount(); };

    if (hotels && hotels.length && hotels[0].hasLoyalty()) {
        hotels.orderBy(byPoints, byName);
    }
    else {
        hotels.orderBy(byPreferential, byFareAmount, byName);
    }

    return hotels;
};

HotelExtensions.IsBudgetMode = function () {
    if (!Util.isTravelGo()) {
        var currentTab = $("#" + Ide.getCurrentTab().id);
        var budgetElement = currentTab.find("#budget");

        return budgetElement && budgetElement.eq(0).is(":visible");
    }

    return false;
}

ï»¿var HotelExtensions = HotelExtensions || {};

HotelExtensions.PrepareFunctions = HotelExtensions.PrepareFunctions || {};

HotelExtensions.PrepareFunctions.Room = function (room) {
    room.AuxiliarData = room.AuxiliarData || {};

    room.SourceAlias = room.Source;

    if (room.OriginalBrokerName && room.OriginalBrokerName.length && room.OriginalBrokerName != room.Source) {
        room.SourceAlias = room.OriginalBrokerName + " (" + room.Source + ")";
    }

    var sourceAlias = room.ExternalProperties && room.ExternalProperties.first(function (e) { return e.Key == "SourceAlias"; });
    if (sourceAlias && sourceAlias.Value) {
        room.SourceAlias = sourceAlias.Value;
    }

    if (room.Name && room.Name.length)
        room.AuxiliarData.ShortName = Util.CutText(room.Name, 10);

    for (var i = 0; i < room.StayOptions.length; i++) {
        room.StayOptions[i] = HotelExtensions.PrepareFunctions.StayOption(room.StayOptions[i]);
    }

    room.AuxiliarData.StayOption = HotelExtensions.PrepareFunctions.StayOption(room.getSelectedStayOption());

    if (!room.AuxiliarData.StayOption)
        console.log("Quarto sem stayOption selecionado." + room.Name);

    room.AuxiliarData.HasReservationInfo = (room.ReservationInfo && room.ReservationInfo.CancellationPolicies && room.ReservationInfo.CancellationPolicies.length);
    room.AuxiliarData.ShowPolicyLink = (room.CancellationSummary) || room.AuxiliarData.HasReservationInfo;

    if (room.AuxiliarData.ShowPolicyLink)
        room.AuxiliarData.ShowPolicyLink = CommonFunctions.ViewHotelCancellationPolicy();

    var roomPromotion = room.ExternalProperties.first(function (e) { return e.Key == "Promotion"; })
    if (roomPromotion && roomPromotion.Value) 
        room.AuxiliarData.Promotion = roomPromotion.Value;
    
    return room;
};

var Room = HotelExtensions.Room = function (room, roomGroup, allRoomGroups) {

    var _internalStore = room;
    var _this = room;

    var _thisRoomGroup = roomGroup;
    var _allRoomGroups = allRoomGroups;

    room.AuxiliarData = {};

    room.getTotalGuests = function () {
        if (_thisRoomGroup) {
            return _thisRoomGroup.TotalGuests;
        }

        return -1;
    };

    room.getSelectedStayOption = function () {

        var selecteds = this.StayOptions.where(function (s) { return s.Selected; });

        if (!selecteds.length)
            return this.StayOptions[0];
        else if (selecteds.length == 1)
            return selecteds[0]

        return selecteds.orderBy(function (h) { return h.DailyFare.Value; }).first();
    };
    
    room.hasActiveCancellationPolicy = function () {
        var resp = false;

        if (_this.ReservationInfo != null && _this.ReservationInfo.CancellationPolicies != null && _this.ReservationInfo.CancellationPolicies.length) {

            var currentDate = new Date();

            if (_this.ReservationInfo.CancellationPolicies.any(function (cp) {
                return cp.PenaltyAmount > 0
                && currentDate >= Util.DateValuesToDate(cp.ApplicablePeriodStart)
                && currentDate <= Util.DateValuesToDate(cp.ApplicablePeriodEnd)
            }))
                resp = true;

        }

        return resp;
    };
    
    room.extended = true;

    for (var i = 0; room.StayOptions && i < room.StayOptions.length; i++)
        room.StayOptions[i] = new StayOption(room.StayOptions[i], roomGroup, allRoomGroups);

    return room;
};

ï»¿var HotelExtensions = HotelExtensions || {};

HotelExtensions.PrepareFunctions = HotelExtensions.PrepareFunctions || {};

var StayOption = HotelExtensions.StayOption = function (stayOption, roomGroup, allRoomGroups) {

    var _internalStore = stayOption;
    var _this = stayOption;
    var _thisRoomGroup = roomGroup;
    var _allRoomGroups = allRoomGroups || [];
    var _auxData = {};
    stayOption.AuxiliarData = {};

    stayOption.getTotalGuests = function () {
        if (_allRoomGroups)
            return _allRoomGroups.sum(function (h) { return h.TotalGuests; });

        return -1;
    };

    stayOption.getDaysCount = function () {

        if (!_internalStore.DaysCount) {
            var checkIn = Util.DateValuesToDate(_internalStore.CheckInValues);
            var checkOut = Util.DateValuesToDate(_internalStore.CheckOutValues);
            _internalStore.DaysCount = checkIn.dateDiff('d', checkOut);
        }

        return _internalStore.DaysCount;
    };

    stayOption.getServicesAmount = function (exchangeRate) {
        return (_internalStore.Services ? _internalStore.Services.sum(function (s) { return s.EquivalentFare.Value; }) : 0) / (exchangeRate || 1);
    };

    stayOption.getBoardAmount = function (exchangeRate) {
        return _internalStore.Board ? (_internalStore.Board.EquivalentFare.Value === 0 ? _internalStore.Board.Fare.Value * _internalStore.ExchangeRate : _internalStore.Board.EquivalentFare.Value) : 0;
    };

    stayOption.getTotalDailyFare = function (dailyFare) {
        var daysCount = _this.getDaysCount();
        return dailyFare * daysCount;
    };

    stayOption.getFareAmount = function (dailyFare, exchangeRate) {
        var totalFare = stayOption.getTotalDailyFare(dailyFare);
        totalFare += _this.getMarkupAmount(dailyFare, exchangeRate);
        totalFare += _this.getServicesAmount(exchangeRate);
        totalFare += _this.getBoardAmount(exchangeRate);
        totalFare -= _this.getDiscountAmount(exchangeRate);
        totalFare -= _this.getEquivalentPointsMoneyAmount(exchangeRate);
        return totalFare;
    };

    stayOption.getDiscountAmount = function (exchangeRate) {
        var discountAmount = 0;
        if (_internalStore.FareDetails) {
            if (_internalStore.FareDetails.Discount > 0)
                discountAmount += (_internalStore.FareDetails.Discount * _this.getDaysCount());
        }
        return discountAmount / (exchangeRate || 1);
    };


    stayOption.getMarkupAmount = function (dailyFare, exchangeRate) {
        var markupAmount = 0;
        if (_internalStore.FareDetails) {
            if (_internalStore.FareDetails.Markup > 0)
                markupAmount += (_internalStore.FareDetails.Markup * _this.getDaysCount());
            else if (_internalStore.FareDetails.MarkupPercent > 0) {
                var dailyFareTotal = getTotalDailyFare(dailyFare, exchangeRate);
                markupAmount += (dailyFareTotal * _internalStore.FareDetails.MarkupPercent);
            }
        }

        return markupAmount / (exchangeRate || 1);
    };

    stayOption.getFeeAmount = function (isTax, exchangeRate) {
        var feeValue = 0;

        if (_internalStore.FareDetails && _internalStore.FareDetails.Pricing) {
            if (typeof (_internalStore.FareDetails.Pricing.IsTax) === 'undefined')
                _internalStore.FareDetails.Pricing.IsTax = false;

            feeValue = _internalStore.FareDetails.Pricing.IsTax == isTax ? _internalStore.FareDetails.Pricing.Fee * _this.getDaysCount() : 0;
        }

        return feeValue / (exchangeRate || 1);
    };

    stayOption.getTaxAmount = function (dailyTax, exchangeRate) {
        return (dailyTax * _this.AuxiliarData.DaysCount) + _this.getFeeAmount(exchangeRate, false);
    };

    stayOption.getTotalAmount = function (dailyFare, dailyTax, exchangeRate) {
        return _this.getFareAmount(dailyFare, exchangeRate) + _this.getTaxAmount(dailyTax, exchangeRate);
    };

    stayOption.getAverageTotalAmountByDay = function (dailyFare, dailyTax, exchangeRate) {
        return _this.getTotalAmount(dailyFare, dailyTax, exchangeRate) / _this.AuxiliarData.DaysCount;
    };

    stayOption.getAverageFareAmountByDay = function (dailyFare, exchangeRate) {
        return _this.getFareAmount(dailyFare, exchangeRate) / _this.AuxiliarData.DaysCount;
    };

    stayOption.getAverageFareAmountByGuest = function (dailyFare, exchangeRate) {
        return _this.getFareAmount(dailyFare, exchangeRate) / _this.AuxiliarData.TotalGuests;
    };

    stayOption.getPointsAmount = function (pointsValueProperty) {
        var pointsAmount = 0;
        if (_this.Loyalty)
            pointsAmount = _this.Loyalty[pointsValueProperty];
        else if (_internalStore.Loyalty)
            pointsAmount = _internalStore.Loyalty[pointsValueProperty];

        return pointsAmount;
    };

    stayOption.getPointsValue = function () {
        return _this.getPointsAmount('PointsValue');
    };

    stayOption.getTotalPointsAmount = function () {
        return _this.getPointsValue() * _this.AuxiliarData.DaysCount;
    };

    stayOption.getEquivalentPointsMoneyAmount = function () {
        return _internalStore.Loyalty ? _internalStore.Loyalty.EquivalentPointsMoney : 0;
    };

    stayOption.getAveragePointsAmountByDay = function () {
        return _this.getPointsValue() / _this.AuxiliarData.DaysCount;
    };

    stayOption.getAveragePointsAmountByGuest = function () {
        return _this.getPointsValue() / _this.AuxiliarData.TotalGuests;
    };

    stayOption.getInstallmentFareAmount = function (dailyFare, exchangeRate) {
        return _this.getFareAmount(dailyFare, exchangeRate) / (_internalStore.Installments || 1);
    };

    stayOption.getAverageInstallmentsFareAmountByDay = function (dailyFare, exchangeRate) {
        return _this.getInstallmentFareAmount(dailyFare, exchangeRate) / _this.AuxiliarData.DaysCount;
    };

    stayOption.getAverageInstallmentsFareAmountByGuest = function (dailyFare, exchangeRate) {
        return _this.getInstallmentFareAmount(dailyFare, exchangeRate) / _this.AuxiliarData.TotalGuests;
    };

    stayOption.getInstallmentTotalAmount = function (dailyFare, dailyTax, exchangeRate) {
        return _this.getTotalAmount(dailyFare, dailyTax, exchangeRate) / (_internalStore.Installments || 1);
    };

    stayOption.preparePartialFare = function () {
        if (typeof (_internalStore.ExternalProperties.first(function (ep) { return ep.Key == "MaxPercent"; })) !== 'undefined') {
            var maxPercentFareIs100 = _internalStore.ExternalProperties.first(function (ep) { return ep.Key == "MaxPercentFareIs100"; }).Value;
            var maxPercent = _internalStore.ExternalProperties.first(function (ep) { return ep.Key == "MaxPercent"; }).Value;
            var minPercent = _internalStore.ExternalProperties.first(function (ep) { return ep.Key == "MinPercent"; }).Value;

            maxPercent = maxPercent.replace(',', '.');
            minPercent = minPercent.replace(',', '.')

            if (stayOption.Loyalty) {

                var minPartialFare = stayOption.Loyalty.ExternalProperties.first(function (ep) { return ep.Key == "MinPartialFare"; });
                var minPartialPoints = stayOption.Loyalty.ExternalProperties.first(function (ep) { return ep.Key == "MinPartialPoints"; });

                _auxData.PartialFare = true;
                if (minPartialFare)
                    _auxData.MinPartialFare = parseFloat(minPartialFare.Value);
                else
                    _auxData.MinPartialFare = Number(_internalStore.Loyalty.EquivalentPointsMoney * (1 - minPercent), 2);

                if (minPartialPoints)
                    _auxData.MinPartialPoints = parseFloat(minPartialPoints.Value);
                else
                    _auxData.MinPartialPoints = Math.round(_internalStore.Loyalty.PointsValue * minPercent);

                stayOption.Loyalty.PointsValue = Math.round(_internalStore.Loyalty.PointsValue * maxPercent);
                stayOption.Loyalty.OriginalPointsValues = Math.round(_internalStore.Loyalty.OriginalPointsValues * maxPercent);

                if (!JSON.parse(maxPercentFareIs100)) {
                    _auxData.MaxPartialFare = Number(_internalStore.Loyalty.EquivalentPointsMoney * (1 - maxPercent), 2);
                }
            }
        }
        else {
            if (stayOption.Loyalty) {
                _auxData.PartialFare = false;
            }
        }
    };

    stayOption.prepareExternalPropertiesData = function () {
        var showPointsAndMoney = Util.GetExternalPropertieValue(stayOption.ExternalProperties, "ShowPointsAndMoney");
        if (showPointsAndMoney && showPointsAndMoney === "true") {
            stayOption.AuxiliarData.Points = {
                PointsByDay: Util.GetExternalPropertieValue(stayOption.ExternalProperties, "PointsByDay"),
                TotalPoints: Util.GetExternalPropertieValue(stayOption.ExternalProperties, "TotalPoints"),
                PartialPoints: Util.GetExternalPropertieValue(stayOption.ExternalProperties, "PartialPoints"),
                PartialFare: Util.GetExternalPropertieValue(stayOption.ExternalProperties, "PartialFare")
            };

            stayOption.AuxiliarData.Points.PointsByDayFormatted = stayOption.AuxiliarData.Points.PointsByDay + " Pontos";
            stayOption.AuxiliarData.Points.TotalPointsFormatted = stayOption.AuxiliarData.Points.TotalPoints + " Pontos";
        }
    }

    stayOption.extended = true;

    return stayOption;
};

HotelExtensions.PrepareFunctions.StayOption = function (stayOption) {

    function setOriginalFields(stayOption) {
        stayOption.AuxiliarData.OriginalCurrency = stayOption.OriginalDailyFare.CurrencyCode;
        stayOption.AuxiliarData.OriginalDailyFare = stayOption.OriginalDailyFare.Value;
        stayOption.AuxiliarData.OriginalTaxAmount = stayOption.OriginalDailyTax.Value;

        stayOption.AuxiliarData.OriginalFareAmountByGuest = stayOption.getAverageFareAmountByGuest(stayOption.OriginalDailyFare.Value, stayOption.ExchangeRate);
        stayOption.AuxiliarData.OriginalFareAmountByDay = stayOption.getAverageFareAmountByDay(stayOption.OriginalDailyFare.Value, stayOption.ExchangeRate);
        stayOption.AuxiliarData.OriginalTotalAmountByDay = stayOption.getAverageTotalAmountByDay(stayOption.OriginalDailyFare.Value, stayOption.OriginalDailyTax.Value, stayOption.ExchangeRate);
        stayOption.AuxiliarData.OriginalPointsAmount = stayOption.getPointsAmount('OriginalPointsValues');
        stayOption.AuxiliarData.OriginalFareAmountNonFormatted = stayOption.getFareAmount(stayOption.OriginalDailyFare.Value, stayOption.ExchangeRate);
        stayOption.AuxiliarData.OriginalTaxAmountNonFormatted = stayOption.getTaxAmount(stayOption.OriginalDailyTax.Value, stayOption.ExchangeRate);
        stayOption.AuxiliarData.OriginalTotalMarkupNonFormatted = stayOption.getMarkupAmount(stayOption.OriginalDailyFare.Value, stayOption.ExchangeRate);
        stayOption.AuxiliarData.OriginalAverageTotalAmountByDayNonFormatted = stayOption.getAverageTotalAmountByDay(stayOption.OriginalDailyFare.Value, stayOption.OriginalDailyTax.Value);

        stayOption.AuxiliarData.OriginalAverageFareAmountByDay = formatter.currency(stayOption.AuxiliarData.OriginalFareAmountByDay, true, 2, stayOption.AuxiliarData.OriginalCurrency);
        stayOption.AuxiliarData.OriginalAverageFareAmountByGuest = formatter.currency(stayOption.AuxiliarData.OriginalFareAmountByGuest, true, 2, stayOption.AuxiliarData.OriginalCurrency);
        stayOption.AuxiliarData.OriginalAverageTotalAmountByDay = formatter.currency(stayOption.AuxiliarData.OriginalTotalAmountByDay, true, 2, stayOption.AuxiliarData.OriginalCurrency);

        if (stayOption.CanBook)
            stayOption.AuxiliarData.OriginalFareAmount = formatter.currency(stayOption.AuxiliarData.OriginalFareAmountNonFormatted, true, 2, stayOption.AuxiliarData.OriginalCurrency);
        else
            stayOption.AuxiliarData.OriginalFareAmount = "";

        stayOption.AuxiliarData.OriginalNetFareAmount = formatter.currency(stayOption.AuxiliarData.OriginalFareAmountNonFormatted - stayOption.AuxiliarData.OriginalTotalMarkup, true, 2, stayOption.AuxiliarData.OriginalCurrency);
        stayOption.AuxiliarData.OriginalAverageNetFareAmountByDay = formatter.currency((stayOption.AuxiliarData.OriginalFareAmountNonFormatted - stayOption.AuxiliarData.OriginalTotalMarkup) / stayOption.AuxiliarData.DaysCount, true, 2, stayOption.AuxiliarData.OriginalCurrency);
        stayOption.AuxiliarData.OriginalTaxAmount = formatter.currency(stayOption.getTaxAmount(stayOption.OriginalDailyTax.Value), true, 2, stayOption.AuxiliarData.OriginalCurrency);
        stayOption.AuxiliarData.OriginalTotalAmountNonFormatted = stayOption.getTotalAmount(stayOption.OriginalDailyFare.Value, stayOption.OriginalDailyTax.Value, stayOption.ExchangeRate);
        stayOption.AuxiliarData.OriginalTotalAmount = formatter.currency(stayOption.AuxiliarData.OriginalTotalAmountNonFormatted, true, 2, stayOption.AuxiliarData.OriginalCurrency);
        stayOption.AuxiliarData.OriginalDailyFare = formatter.currency(stayOption.OriginalDailyFare.Value, false, 2, stayOption.AuxiliarData.OriginalCurrency);

        if (stayOption.AuxiliarData.OriginalTotalMarkupNonFormatted)
            stayOption.AuxiliarData.OriginalTotalMarkup = formatter.currency(stayOption.AuxiliarData.OriginalTotalMarkupNonFormatted, true, 2, stayOption.AuxiliarData.OriginalCurrency);

        var originalInstallmentPrice = stayOption.getAverageInstallmentsFareAmountByDay(stayOption.OriginalDailyFare.Value, stayOption.ExchangeRate);
        if (originalInstallmentPrice) {
            stayOption.AuxiliarData.OriginalInstallmentFareAmount = formatter.currency(originalInstallmentPrice, true, 2, stayOption.AuxiliarData.OriginalCurrency);
            stayOption.AuxiliarData.OriginalAverageInstallmentsFareAmountByGuest = formatter.currency(originalInstallmentPrice / stayOption.AuxiliarData.TotalGuests, true, 2, stayOption.AuxiliarData.OriginalCurrency);
        }

        stayOption.AuxiliarData.OriginalPointsAmount = stayOption.OriginalPointsAmount;
        stayOption.AuxiliarData.OriginalPointsValue = stayOption.OriginalPointsValue;
    }

    function setEquivalentFields(stayOption) {

        var remainingBalanceMoney = 0;
        if (stayOption.Loyalty && stayOption.Loyalty.RemainingBalanceMoney)
            remainingBalanceMoney = stayOption.Loyalty.RemainingBalanceMoney;

        stayOption.AuxiliarData.Currency = stayOption.DailyFare.CurrencyCode;
        stayOption.AuxiliarData.DailyFare = stayOption.DailyFare.Value;
        stayOption.AuxiliarData.FareAmountByDay = stayOption.getAverageFareAmountByDay(stayOption.DailyFare.Value, 1);
        stayOption.AuxiliarData.TotalAmountByDay = stayOption.getAverageTotalAmountByDay(stayOption.DailyFare.Value, stayOption.DailyTax.Value, 1);
        stayOption.AuxiliarData.FareAmountByGuest = stayOption.getAverageFareAmountByGuest(stayOption.DailyFare.Value, 1);
        stayOption.AuxiliarData.PointsAmount = stayOption.getPointsValue();
        stayOption.AuxiliarData.TotalPointsAmount = stayOption.getTotalPointsAmount();
        stayOption.AuxiliarData.TotalPointsAmountFormatted = formatter.coins.getPoints().toString(stayOption.AuxiliarData.TotalPointsAmount);
        stayOption.AuxiliarData.FareAmountNonFormatted = stayOption.getFareAmount(stayOption.DailyFare.Value, 1);
        stayOption.AuxiliarData.TaxAmountNonFormatted = stayOption.getTaxAmount(stayOption.DailyTax.Value, 1);
        stayOption.AuxiliarData.TotalMarkupNonFormatted = stayOption.getMarkupAmount(stayOption.DailyFare.Value, 1);
        stayOption.AuxiliarData.AverageTotalAmountByDayNonFormatted = stayOption.getAverageTotalAmountByDay(stayOption.DailyFare.Value, stayOption.DailyTax.Value, 1);
        stayOption.AuxiliarData.TotalAmountNonFormatted = stayOption.getTotalAmount(stayOption.DailyFare.Value, stayOption.DailyTax.Value, 1);

        if (remainingBalanceMoney)
            stayOption.AuxiliarData.TotalAmountNonFormatted = stayOption.getTotalDailyFare(remainingBalanceMoney);

        stayOption.AuxiliarData.AverageFareAmountByDay = formatter.currency(stayOption.AuxiliarData.FareAmountByDay, true, 2, stayOption.AuxiliarData.Currency);
        stayOption.AuxiliarData.AverageFareAmountByGuest = formatter.currency(stayOption.AuxiliarData.FareAmountByGuest, true, 2, stayOption.AuxiliarData.Currency);
        stayOption.AuxiliarData.AveragePointsAmountByDay = formatter.currency(stayOption.getAveragePointsAmountByDay(), false, 0, stayOption.AuxiliarData.Currency);
        stayOption.AuxiliarData.AveragePointsAmountByGuest = formatter.currency(stayOption.getAveragePointsAmountByGuest(), false, 0, stayOption.AuxiliarData.Currency);
        stayOption.AuxiliarData.AverageTotalAmountByDay = formatter.currency(stayOption.AuxiliarData.TotalAmountByDay, true, 2, stayOption.AuxiliarData.Currency);
        stayOption.AuxiliarData.FareAmount = formatter.currency(stayOption.AuxiliarData.FareAmountNonFormatted, true, 2, stayOption.AuxiliarData.Currency);
        stayOption.AuxiliarData.NetFareAmount = formatter.currency(stayOption.AuxiliarData.FareAmountNonFormatted - stayOption.AuxiliarData.TotalMarkup, true, 2, stayOption.AuxiliarData.Currency);
        stayOption.AuxiliarData.AverageNetFareAmountByDay = formatter.currency((stayOption.AuxiliarData.FareAmountNonFormatted - stayOption.AuxiliarData.TotalMarkup) / stayOption.AuxiliarData.DaysCount, true, 2, stayOption.AuxiliarData.Currency);
        stayOption.AuxiliarData.TaxAmount = formatter.currency(stayOption.getTaxAmount(stayOption.AuxiliarData.TaxAmountNonFormatted, 1), true, 2, stayOption.AuxiliarData.Currency);
        if (stayOption.AuxiliarData.TotalMarkupNonFormatted)
            stayOption.AuxiliarData.TotalMarkup = formatter.currency(stayOption.AuxiliarData.TotalMarkupNonFormatted, true, 2, stayOption.AuxiliarData.Currency);

        stayOption.AuxiliarData.TotalAmount = formatter.currency(stayOption.AuxiliarData.TotalAmountNonFormatted, true, 2, stayOption.AuxiliarData.Currency);
        stayOption.AuxiliarData.InstallmentPrice = stayOption.getAverageInstallmentsFareAmountByDay(stayOption.DailyFare, stayOption.ExchangeRate);

        if (stayOption.AuxiliarData.InstallmentPrice) {
            stayOption.AuxiliarData.InstallmentFareAmount = formatter.currency(stayOption.AuxiliarData.InstallmentPrice, true, 2, stayOption.AuxiliarData.Currency);
            stayOption.AuxiliarData.AverageInstallmentsFareAmountByGuest = formatter.currency(stayOption.AuxiliarData.InstallmentPrice / stayOption.AuxiliarData.TotalGuests, true, 2, stayOption.AuxiliarData.Currency);
        }
    }

    function setFields(stayOption) {
        stayOption.AuxiliarData.TotalGuests = stayOption.getTotalGuests();
        stayOption.AuxiliarData.DaysCount = stayOption.getDaysCount();

        stayOption.preparePartialFare();
        stayOption.prepareExternalPropertiesData();

        stayOption.AuxiliarData.CheckInValues = stayOption.CheckInValues ? formatter.dateValuesShort(stayOption.CheckInValues) : undefined;
        stayOption.AuxiliarData.CheckOutValues = stayOption.CheckOutValues ? formatter.dateValuesShort(stayOption.CheckOutValues) : undefined;
        stayOption.AuxiliarData.Comissioned = stayOption.FareDetails && stayOption.FareDetails.FareType == EnumHelper.Hotel.FareType.Comissioned;
        stayOption.AuxiliarData.ExchangeRate = stayOption.ExchangeRate ? stayOption.ExchangeRate : 1;
        stayOption.AuxiliarData.ExchangeRateFormatted = formatter.currency(stayOption.AuxiliarData.ExchangeRate, false, 4);

        stayOption.AuxiliarData.PackageFare = false;
        if (stayOption.FareDetails)
            stayOption.AuxiliarData.PackageFare = stayOption.FareDetails.FareType == EnumHelper.Hotel.FareType.Package;
        
        if (stayOption.Services && stayOption.Services.length) {
            for (var i = 0; i < stayOption.Services.length; i++) {
                var service = stayOption.Services[i];
                service.AuxiliarData = service.AuxiliarData || {};
                service.AuxiliarData.ShortName = service.Name ? Util.CutText(service.Name, 10) : "";
            }
        }
    }

    setFields(stayOption);
    setEquivalentFields(stayOption);
    setOriginalFields(stayOption);

    stayOption.AuxiliarData.ShowOriginalAmounts = stayOption.DailyFare.CurrencyCode != stayOption.OriginalDailyFare.CurrencyCode || stayOption.DailyFare.CanBook;

    return stayOption;
};

// This file was automatically generated from ServiceSearchEngine.soy.
// Please don't edit this file by hand.

if (typeof SearchEngine == 'undefined') { var SearchEngine = {}; }


SearchEngine.Service = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input class="touch matrix research_show" for="show_research" id="show_research" alue="open" type="checkbox"><label for="show_research" class="touch matrix research">Abrir</label><div class="content service"></div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.simpleService = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label class="autocomplete servicename"><p>Nome de serviÃ§o</p><input type="text" autocomplete="off" class="servicename" id="service-name" placeholder="Nome de serviÃ§o"><small>Nome de serviÃ§o</small></label>');
  SearchEngine.searchButton({isHome: true}, output);
  if (!opt_sb) return output.toString();
};


SearchEngine.serviceDestinationContainer = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="destination"><label class="autocomplete origin city"><p>Cidade</p><input type="text" autocomplete="off" class="txtServiceDestination just-letters-for-locations" placeholder="Cidade" nextelem=".txtServiceInitialDate"><small>Cidade</small></label>', (! opt_data.settings.version) ? '</div>' : '');
  if (!opt_sb) return output.toString();
};


SearchEngine.ServiceContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h1 class="matrix">Refinar Busca</h1><h2>', soy.$$escapeHtml(opt_data.settings.title), '</h2>');
  if (opt_data.settings.enableSearchByName) {
    output.append('<label class="searchByDestination"><input type="radio" class="switchSearchParam" name="searchByDestinationOrName" value="destination" checked="checked" /><span> Buscar por cidade </span></label><label class="searchByName"><input type="radio" class="switchSearchParam" name="searchByDestinationOrName" value="name" /><span>Buscar por nome</span></label>');
    SearchEngine.serviceDestinationContainer({settings: opt_data.settings}, output);
    output.append('<div class=""><label class="autocomplete name hide">');
    Resources.translate({code: 'Name'}, output);
    output.append('<input type="text" value="" class="txtServiceName" autocomplete="off" /></label></div>');
  } else {
    SearchEngine.serviceDestinationContainer({settings: opt_data.settings}, output);
  }
  output.append('<label class="data checkin date"><p>A partir de</p><input type="text" class="txtServiceInitialDate" placeholder="A partir de"><small> A partir de</small></label><label class="data checkout date"><p>AtÃ©</p><input type="text" class="txtServiceFinalDate" placeholder="AtÃ©"><small>AtÃ©</small></label><label class="category select"><p>Categoria</p><select class="select cboServiceCategory" tabindex="-1"><option value="">Selecione uma categoria</option></select><small>Categoria</small></label><label class="blacklist_category hide"></label>', (opt_data.settings.version == '1') ? '</div>' : '');
  SearchEngine.searchButton({isHome: opt_data.isHome}, output);
  if (!opt_sb) return output.toString();
};


SearchEngine.PassengersAges = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t', (opt_data.hiddenlabel) ? '<p>Idade dos Viajantes</p>' : '');
  var iLimit100 = opt_data.amount;
  for (var i100 = 0; i100 < iLimit100; i100++) {
    SearchEngine.PassengerAge({i: i100, hiddenlabel: opt_data.hiddenlabel}, output);
  }
  if (!opt_sb) return output.toString();
};


SearchEngine.PassengerAge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label class="select">', (! opt_data.hiddenlabel) ? '<p>Viajante ' + soy.$$escapeHtml(opt_data.i) + '</p>' : '', '<select class="passenger-age"><option selected="selected"></option><option value="0">< 1 ano</option>');
  for (var i117 = 1; i117 < 100; i117++) {
    output.append('<option value="', soy.$$escapeHtml(i117), '" ', (i117 == 30) ? 'selected ="selected" ' : '', '>', soy.$$escapeHtml(i117), '</option>');
  }
  output.append('</select></label>');
  if (!opt_sb) return output.toString();
};


SearchEngine.CategoryCombo = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">Selecione uma Categoria</option>');
  var categoryList133 = opt_data.categories;
  var categoryListLen133 = categoryList133.length;
  for (var categoryIndex133 = 0; categoryIndex133 < categoryListLen133; categoryIndex133++) {
    var categoryData133 = categoryList133[categoryIndex133];
    output.append('<option value="', soy.$$escapeHtml(categoryData133.Id), '">', soy.$$escapeHtml(categoryData133.Name), '</option>');
  }
  if (!opt_sb) return output.toString();
};


SearchEngine.BlackListCategories = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var categoryList141 = opt_data.categories;
  var categoryListLen141 = categoryList141.length;
  for (var categoryIndex141 = 0; categoryIndex141 < categoryListLen141; categoryIndex141++) {
    var categoryData141 = categoryList141[categoryIndex141];
    output.append('<input type="checkbox" name="', soy.$$escapeHtml(categoryData141.Name), '" value="', soy.$$escapeHtml(categoryData141.Id), '" ', (categoryData141.IsBlackList) ? 'checked="true" ' : '', ' />');
  }
  if (!opt_sb) return output.toString();
};


// This file was automatically generated from DynamicPackageSearchEngine.soy.
// Please don't edit this file by hand.

if (typeof SearchEngine == 'undefined') { var SearchEngine = {}; }


SearchEngine.DynamicPackage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input class="touch matrix research_show" for="show_research" id="show_research" alue="open" type="checkbox"><label for="show_research" class="touch matrix research">Abrir</label><div class="content dynamicpackage"></div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.dynamicPackageContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h1 class="matrix">Refinar Busca</h1><h2>', soy.$$escapeHtml(opt_data.settings.title), '</h2><ul class="products"><li><label class="service"><input type="checkbox" checked="checked" value="Service" id="package-service-toggle" /><span></span><p>ServiÃ§o</p></label></li><li><label class="air"><input type="checkbox" checked="checked" value="Air" id="package-air-toggle" /><span></span><p>Voos</p></label></li><li><label class="hotel"><input type="checkbox" checked="checked" value="Hotel" id="package-hotel-toggle" /><span></span><p>Hotel</p></label></li></ul><div class="destination"><label class="autocomplete destin city hide package-air"><p>Origem</p><input id="origin" type="text" autocomplete="off" placeholder="Digite a cidade de origem" nextelem="#destination"><small>Origem</small></label><label class="autocomplete destin city"><p>Destino</p><input id="destination" type="text" autocomplete="off" placeholder="Digite a cidade de destino" nextelem="#startDate"><small>Destino</small></label>', (! opt_data.settings.version) ? '</div>' : '', '<label class="data startdate date"><p>Ida</p><input type="text" id="startDate" pattern="[0-9]*" placeholder="Ida (dd/mm/aaaa)"><small> Ida</small></label><label class="data enddate date"><p>Volta</p><input type="text" id="endDate" pattern="[0-9]*" placeholder="Volta (dd/mm/aaaa)"><small>Volta</small></label><div class="advanced settings"><input id="air_advanced_check" type="checkbox" name="air_advanced_check"><label for="air_advanced_check">AvanÃ§ado</label><div class="content" style="opacity: 1;"><div class="hide package-service"><label class="autocomplete servicename"><p>Nome do serviÃ§o</p><input type="text" autocomplete="off" class="servicename" id="service-name" placeholder="Nome do serviÃ§o"><small>Nome do serviÃ§o</small></label><label class="category select"><p>Categoria do serviÃ§o</p><select class="select cboServiceCategory" tabindex="-1"><option value="">Categoria do serviÃ§o</option></select><small>Categoria do serviÃ§o</small></label></div><div class="hide package-air"><div class="radio way"><label><input type="radio" id="chkRoundTrip" name="tripType" value="1" checked="checked" /><span>Ida e volta</span></label><label><input type="radio" id="chkOneWay" name="tripType" value="2" /><span>Somente ida</span></label></div><label class="airline select">');
  SearchEngine.selectAirCompany({Id: 'drpCiaCode', TabIndex: 2, settings: opt_data.settings}, output);
  output.append('</label><label class="cabin select">');
  SearchEngine.selectCabin({Id: 'drpCabin', TabIndex: 0}, output);
  output.append('</label>');
  SearchEngine.selectBaggageAllowance({baggageAllowances: opt_data.settings.baggageAllowances, baggageFilterSelected: opt_data.settings.baggageFilter}, output);
  output.append('<label class="no-stop"><input type="checkbox" id="chkNonStop" name="chkNonStop" /> <span></span>Somente voos diretos</label></div><div class="hide package-hotel">', (opt_data.settings.version == '1') ? '<label class="otherCity"><input type="checkbox" class="hotel-other-choosedestination" /><span>Escolher um hotel em outra cidade</span></label><label class="otherHotelCity hide"><input type="text" class="hotel-other-destination city autocomplete_empty just-letters-for-locations" onpaste="return false" autocomplete="off" placeholder="Digite a cidade do hotel" /></label><label class="otherDate"><input type="checkbox" class="hotel-other-choosedates" /><span>Escolher um hotel em outra data</span></label><label class="hotel_date date hide">Chegada:<input type="text" class="hotel-other-checkin hasDatepicker" placeholder="CheckIn hotel" /></label><label class="hotel_date date hide">SaÃ­da:<input type="text" class="hotel-other-checkout hasDatepicker" placeholder="CheckOut hotel" /></label>' : '<div class="change_hotel"><label class="otherCity"><input type="checkbox" class="hotel-other-choosedestination" /><span>Escolher um hotel em outra cidade</span></label><label class="otherHotelCity hide"><input type="text" class="hotel-other-destination city autocomplete_empty just-letters-for-locations" onpaste="return false" autocomplete="off" placeholder="Digite a cidade do hotel" /></label></div><div class="change_date"><label class="otherDate"><input type="checkbox" class="hotel-other-choosedates" /><span>Escolher um hotel em outra data</span></label><label class="hotel_date date hide">Chegada:<input type="text" class="hotel-other-checkin hasDatepicker" placeholder="CheckIn hotel" /></label><label class="hotel_date date hide">SaÃ­da:<input type="text" class="hotel-other-checkout hasDatepicker" placeholder="CheckOut hotel" /></label></div>', '</div></div></div><div class="advanced travelers passengers"><label for="services_advanced_check">Viajantes</label><input id="services_advanced_check" type="checkbox" name="services_advanced_check"><div class="content"><label class="adults select travelers"><p>Viajantes:</p><select id="passenger-quantity">');
  var iLimit160 = opt_data.maxPassengers + 1;
  for (var i160 = 1; i160 < iLimit160; i160++) {
    output.append('<option value="', soy.$$escapeHtml(i160), '">', soy.$$escapeHtml(i160), '</option>');
  }
  output.append('</select></label><div class="travelers_ages"><p>Idade dos viajantes</p><ul class="passengersAges ages"><li class="passenger-container">');
  SearchEngine.passenger(null, output);
  output.append('</li>');
  var iLimit172 = opt_data.maxPassengers;
  for (var i172 = 1; i172 < iLimit172; i172++) {
    output.append('<li class="passenger-container hide">');
    SearchEngine.passenger(null, output);
    output.append('</li>');
  }
  output.append('</ul></div></div></div>');
  SearchEngine.searchButton({isHome: opt_data.isHome}, output);
  if (!opt_sb) return output.toString();
};


SearchEngine.passenger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label class="age select"><p>Idade</p><select class="passenger-age"><option value="0">< 1 ano</option>');
  for (var i187 = 1; i187 < 100; i187++) {
    output.append('<option value="', soy.$$escapeHtml(i187), '" ', (i187 == 30) ? 'selected="selected"' : '', '>', soy.$$escapeHtml(i187), '</option>');
  }
  output.append('</select></label><label class="room hide package-hotel select"><p>Quarto</p><select class="passenger-room"><option value="1">Quarto 1</option>');
  for (var i204 = 2; i204 < 4; i204++) {
    output.append('<option value="', soy.$$escapeHtml(i204), '">Quarto ', soy.$$escapeHtml(i204), '</option>');
  }
  output.append('</select></label>');
  if (!opt_sb) return output.toString();
};


// This file was automatically generated from PackageSearchEngine.soy.
// Please don't edit this file by hand.

if (typeof SearchEngine == 'undefined') { var SearchEngine = {}; }


SearchEngine.Package = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input class="touch matrix research_show" for="show_research" id="show_research" alue="open" type="checkbox"><label for="show_research" class="touch matrix research">Abrir</label><div class="content package self_package"></div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.destinationContainer = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="destination"><label class="from"><p>Origem:</p><input class="txtOrigin autocomplete_completed" placeholder="Digite a cidade de origem" type="text" name="origin" style="" autocomplete="off" ondragstart="return false" ondrop="return false" nextelem="#cboPackageDestination" /><small>Origem</small></label><label class="going_to select"><p>Destino:</p><select class="cboPackageDestination"></select><small>Destino</small></label></div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.PackageContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h1 class="matrix">Refinar Busca</h1><h2>', soy.$$escapeHtml(opt_data.settings.title), '</h2><div class="destination">', (opt_data.settings.enableSearchByName) ? '<label class="searchByDestination"><input type="radio" class="switchSearchParam" name="pkSearchByDestinationOrName" value="destination" checked="checked" /><span> Buscar por destino </span></label><label class="searchByName"><input type="radio" class="switchSearchParam" name="pkSearchByDestinationOrName" value="name" /><span>Buscar por nome</span></label><br />' : '', '<label class="from"><p>Origem:</p><input class="txtOrigin autocomplete_completed" placeholder="Digite a cidade de origem" type="text" name="origin" style="" autocomplete="off" ondragstart="return false" ondrop="return false" /><small>Origem</small></label><label class="going_to select"><p>Destino:</p><select class="cboPackageDestination"></select><small>Destino</small></label>', (opt_data.settings.enableSearchByName) ? '<label class="package_name hide"><p>Nome: </p><input type="text" value="" class="txtPackageName autocomplete_empty" autocomplete="off"></label>' : '', '</div>');
  if (! opt_data.settings.templateOptions.showDateInDatePicker) {
    output.append('<label class="date select"><p>Partida:</p><select class="txtOutboundDate">');
    var optionList69 = opt_data.settings.availableDepartureOptions;
    var optionListLen69 = optionList69.length;
    for (var optionIndex69 = 0; optionIndex69 < optionListLen69; optionIndex69++) {
      var optionData69 = optionList69[optionIndex69];
      output.append('<option value="" data-month="', soy.$$escapeHtml(optionData69.Month), '" data-year="', soy.$$escapeHtml(optionData69.Year), '">', soy.$$escapeHtml(optionData69.Label), '</option>');
    }
    output.append('</select><small>Partida</small></label>');
  } else {
    output.append('<label class="data startdate date"><p>PerÃ­odo de partida:</p><input id="startDate" type="text" placeholder="PerÃ­odo de partida: (dd/mm/aaaa)"><small>PerÃ­odo de partida</small></label>');
  }
  SearchEngine.travellers({settings: opt_data.settings}, output);
  SearchEngine.searchButton({isHome: opt_data.isHome}, output);
  if (!opt_sb) return output.toString();
};


SearchEngine.travellers = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="advanced travelers">');
  if (opt_data.settings.maxRooms > 0) {
    output.append('<div class="content">', (opt_data.settings.version == '1') ? '<div class="qty_rooms"><div class="type_rooms">' : '', '<ul class="packageRoomList room_list">');
    SearchEngine.packageRoom({roomNumber: 0, maxRooms: opt_data.settings.maxRooms, settings: opt_data.settings}, output);
    output.append('</ul>', (opt_data.settings.version == '1') ? '</div></div>' : '', '</div>', (! opt_data.settings.allowRoomSharing) ? '<a class="addRoom" href="#">Adicionar quarto</a><a class="removeRoom" href="#">Remover quarto</a>' : '');
  }
  output.append('</div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.packageRoom = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="roomContainer search-engine-roomContainer" roomindex="', soy.$$escapeHtml(opt_data.roomNumber), '"><div class="list_actions"><p class="roomNumber">Quarto ', soy.$$escapeHtml(opt_data.roomNumber + 1), '</p><label class="label traveller select">', (opt_data.settings.allowRoomSharing) ? '<span>Vagas:</span>' : '<span>Viajantes:</span>', '<select class="travellers cboPackagePassengers"><option value="1" selected="selected">1</option>');
  for (var i146 = 2; i146 < 10; i146++) {
    output.append('<option value="', soy.$$escapeHtml(i146), '">', soy.$$escapeHtml(i146), '</option>');
  }
  output.append('</select></label>', (! opt_data.settings.version) ? '<div class="label select_box years_old child-ages"><p>Idade dos viajantes:</p>' : '', '<div class="', (opt_data.settings.version == '1') ? 'label select_box years_old child-ages  ' : '', ' passengersAges">');
  SearchEngine.PassengerAge({hiddenLabel: false}, output);
  output.append('</div></div></div></li>');
  if (!opt_sb) return output.toString();
};


SearchEngine.PassengerAge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label class="select">', (! opt_data.hiddenlabel) ? '<p>Viajante</p>' : '', '<select class="passenger-age"><option selected="selected"></option><option value="0">< 1 ano</option>');
  for (var i179 = 1; i179 < 100; i179++) {
    output.append('<option value="', soy.$$escapeHtml(i179), '" ', (i179 == 30) ? 'selected ="selected" ' : '', '>', soy.$$escapeHtml(i179), '</option>');
  }
  output.append('</select></label>');
  if (!opt_sb) return output.toString();
};


SearchEngine.locationsOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">');
  Resources.translate({code: 'Select'}, output);
  output.append('</option>');
  var locationList195 = opt_data.data.locations;
  var locationListLen195 = locationList195.length;
  for (var locationIndex195 = 0; locationIndex195 < locationListLen195; locationIndex195++) {
    var locationData195 = locationList195[locationIndex195];
    output.append('<option locationid="', soy.$$escapeHtml(locationData195.LocationId), '" destinationid="', soy.$$escapeHtml(locationData195.DestinationId), '" value="', soy.$$escapeHtml(locationData195.LocationId), '">', soy.$$escapeHtml(locationData195.Name), '</option>');
  }
  if (!opt_sb) return output.toString();
};


// This file was automatically generated from TourSearchEngine.soy.
// Please don't edit this file by hand.

if (typeof SearchEngine == 'undefined') { var SearchEngine = {}; }


SearchEngine.Tour = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input class="touch matrix research_show" for="show_research" id="show_research" alue="open" type="checkbox"><label for="show_research" class="touch matrix research">Abrir</label><div class="content tour"></div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.destinationContainer = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="destination"><label class="autocomplete origin city"><p>Destino</p><input type="text" autocomplete="off" class="txtTourDestination just-letters-for-locations" placeholder="Destino" nextelem=".tourOutboundDate"><small>Destino</small></label></div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.TourContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.settings.renderTitle) ? '<h1 class="matrix">Refinar Busca</h1><h2>' + soy.$$escapeHtml(opt_data.settings.title) + '</h2>' : '');
  if (opt_data.settings.enableSearchByName) {
    output.append('<label class="searchByDestination"><input type="radio" class="switchSearchParam" name="tourSearchByDestinationOrName" value="destination" checked="checked" /><span> Buscar por destino </span></label><label class="searchByName"><input type="radio" class="switchSearchParam" name="tourSearchByDestinationOrName" value="name" /><span>Buscar por nome</span></label>');
    SearchEngine.destinationContainer(null, output);
    output.append('<div><label class="autocomplete name hide">');
    Resources.translate({code: 'Name'}, output);
    output.append('<input type="text" value="" class="txtTourName" autocomplete="off" /></label></div>');
  } else {
    SearchEngine.destinationContainer(null, output);
  }
  output.append('<label class="data checkin date"><p>A partir de</p><input type="text" class="tourOutboundDate" placeholder="A partir de"><small> A partir de</small></label><label class="data checkout date"><p>AtÃ©</p><input type="text" class="tourInboundDate" placeholder="AtÃ©"><small>AtÃ©</small></label><div class="advanced travelers"><label for="air_advanced_check">Viajante</label><input id="air_advanced_check" type="checkbox" name="air_advanced_check"><div class="content"><div class="qty_rooms"><div class="type_rooms"><ul class="tourRoomList">');
  SearchEngine.tourRoom({roomNumber: 1, maxRooms: opt_data.settings.maxRooms, maxPassengers: opt_data.settings.maxPassengers}, output);
  output.append('</ul></div></div></div></div>');
  SearchEngine.searchButton({isHome: opt_data.isHome}, output);
  if (!opt_sb) return output.toString();
};


SearchEngine.tourRoom = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="roomContainer search-engine-roomContainer" roomindex="0"><div class="list_actions"><span class="roomNumber">Quarto ', soy.$$escapeHtml(opt_data.roomNumber), '</span><label class="label traveller select"><span>HÃ³spedes:</span><select class="travellers cboTourPassengers"><option value="1" selected="selected">1</option>');
  if (opt_data.maxPassengers > 1) {
    var iLimit84 = opt_data.maxPassengers;
    for (var i84 = 2; i84 < iLimit84; i84++) {
      output.append('<option value="', soy.$$escapeHtml(i84), '">', soy.$$escapeHtml(i84), '</option>');
    }
  }
  output.append('</select></label><div class="label select_box years_old child-ages passengersAges"><p>Idade dos Viajantes</p>');
  SearchEngine.PassengerAge({hiddenlabel: true}, output);
  output.append('</div><!-- --><a class="removeRoom ', (opt_data.roomNumber == 1) ? 'hide' : '', '" href="#">Remover quarto</a><!-- --></div><a class="addRoom ', (opt_data.roomNumber >= opt_data.maxRooms) ? 'hide' : '', '" href="#">Adicionar quarto</a></li>');
  if (!opt_sb) return output.toString();
};


// This file was automatically generated from CruiseSearchEngine.soy.
// Please don't edit this file by hand.

if (typeof SearchEngine == 'undefined') { var SearchEngine = {}; }


SearchEngine.Cruise = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="content cruise" style="display: block;"><p>SearchEngine Cruise 1</p></div>');
  if (!opt_sb) return output.toString();
};


SearchEngine.CruiseContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml(opt_data.settings.title), '</h2>');
  if (Global.ShortCodeParameters.site_multiple_company_flows) {
    output.append('<!--Companhia-->');
    SearchEngine.FieldListTemplate({labelClass: 'cia_label', placeholder: 'Companhia', listTitle: 'Selecione a Companhia', listClass: 'cruise_line', isHome: opt_data.isHome}, output);
  } else {
    output.append('<label class="cia_label" style="display: none"><select class="cruise_line" data-placeholder="Selecionar Companhia"></select></label>');
  }
  output.append('<div class="destination_fields"><!--Destino-->');
  SearchEngine.FieldListTemplate({labelClass: 'going_to_label', placeholder: 'Cruzeiro Para', listTitle: 'Selecione o Destino', listClass: 'destination', isHome: opt_data.isHome}, output);
  output.append('<!--Origem-->');
  SearchEngine.FieldListTemplate({labelClass: 'from_label', placeholder: 'Partindo de', listTitle: 'Selecione o Porto de Embarque', listClass: 'origin', isHome: opt_data.isHome}, output);
  output.append('</div><!-- Datas --><label class="date_label"><input type="text" class="txtEmbarkStart" readonly placeholder="Data de Embarque"/><span class="select-arrow"></span><div class="content-panel"><div class="list-title showInMobile"><a href="javascript:void(0);" class="cancel">Voltar</a><p>Selecione a Data da Sua Viagem</p><a href="javascript:void(0);" class="apply">Aplicar</a></div><div class="txtEmbarkStartCalendar"></div><div class="list-commands"><a href="javascript:void(0);" class="btn clearSelectedOptions hide ', (! opt_data.isHome) ? 'showInMobile' : '', '">Limpar</a>', (! opt_data.isHome) ? '<a href="javascript:void(0);" class="apply notShowInMobile">Aplicar</a>' : '', '</div></div></label><!--Navio-->');
  SearchEngine.FieldListTemplate({labelClass: 'ship_label', placeholder: 'Navio', listTitle: 'Selecione o Navio', listClass: 'ship', isHome: opt_data.isHome}, output);
  output.append('<label class="guests_label"><input type="text" class="txtGuests" readonly="readonly" placeholder="HÃ³spedes" /><span class="select-arrow"></span><div class="content-panel"><div class="list-title showInMobile"><a href="javascript:void(0);" class="cancel">Voltar</a><p>Quantidade de HÃ³spedes</p><a href="javascript:void(0);" class="apply">Aplicar</a></div><div class="guestsData"></div><div class="legend">HÃ³spedes adicionais podem ser inseridos durante a compra</div><!--<div class="legend">* Idade das crianÃ§as na data do Cruzeiro</div>--><div class="list-commands">', (! opt_data.isHome) ? '<a href="javascript:void(0);" class="apply notShowInMobile">Aplicar</a>' : '', '</div></div></label>');
  if (opt_data.isHome) {
    SearchEngine.searchButton({isHome: opt_data.isHome}, output);
  } else {
    output.append('<a href="javascript:void(0)" class="send doResearch" title="Refazer pesquisa">Buscar</a>');
  }
  output.append('<span style="display: none;">', soy.$$escapeHtml(opt_data.settings), '</span><span style="display: none;">', soy.$$escapeHtml(opt_data.isHome), '</span>');
  if (!opt_sb) return output.toString();
};


SearchEngine.FieldListTemplate = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label class="', soy.$$escapeHtml(opt_data.labelClass), '"><div class="list-items-field"><input type="text" class="list-items-text" readonly placeholder="', soy.$$escapeHtml(opt_data.placeholder), '" /><span class="list-items-badge hide"></span><div class="content-panel"><div class="list-title showInMobile"><a href="javascript:void(0);" class="cancel">Voltar</a><p>', soy.$$escapeHtml(opt_data.listTitle), '</p><a href="javascript:void(0);" class="apply">Aplicar</a></div><div class="list-items-content"><ul class="', soy.$$escapeHtml(opt_data.listClass), ' list-items-options"></ul><ul class="', soy.$$escapeHtml(opt_data.listClass), ' list-items-options"></ul><ul class="', soy.$$escapeHtml(opt_data.listClass), ' list-items-options"></ul><ul class="', soy.$$escapeHtml(opt_data.listClass), ' list-items-options"></ul></div><div class="list-commands"><a href="javascript:void(0);" class="btn clearSelectedOptions hide ', (! opt_data.isHome) ? 'showInMobile' : '', '">Limpar</a>', (! opt_data.isHome) ? '<a href="javascript:void(0);" class="apply notShowInMobile">Aplicar</a>' : '', '</div></div></div><span class="select-arrow"></span></label>');
  if (!opt_sb) return output.toString();
};


// This file was automatically generated from SearchEngine.soy.
// Please don't edit this file by hand.

if (typeof SearchEngine == 'undefined') { var SearchEngine = {}; }


SearchEngine.motorTabs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="tabs">');
  var tabList4 = opt_data.tabs;
  var tabListLen4 = tabList4.length;
  for (var tabIndex4 = 0; tabIndex4 < tabListLen4; tabIndex4++) {
    var tabData4 = tabList4[tabIndex4];
    output.append('<li class="', soy.$$escapeHtml(tabData4['class']), ' searchEngineSel ', (tabData4.active) ? 'active' : '', '" searchenginetype="', soy.$$escapeHtml(tabData4.type), '"><a href="#" title="', soy.$$escapeHtml(tabData4.name), '"><span class="ico"> </span> ', soy.$$escapeHtml(tabData4.name), '</a></li>');
  }
  output.append('</ul>');
  if (!opt_sb) return output.toString();
};


SearchEngine.searchButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="#" id="btnSearch" ', (opt_data.page) ? 'page="' + soy.$$escapeHtml(opt_data.page) + '"' : '', ' class="send" title="', (opt_data.isHome) ? 'Buscar' : 'Refazer pesquisa', '">', (opt_data.isHome) ? 'Buscar' : 'Refazer pesquisa', '</a>');
  if (!opt_sb) return output.toString();
};


SearchEngine.cleanButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('\t<a href="javascript:void(0);" class="clearSearchParams clear">Limpar</a>');
  if (!opt_sb) return output.toString();
};


SearchEngine.selectPassengersQtd = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select id="', soy.$$escapeHtml(opt_data.Id), '" class="', soy.$$escapeHtml(opt_data.Class), '" ', (opt_data.RoomIndex >= 0) ? ' room="' + soy.$$escapeHtml(opt_data.RoomIndex) + '" ' : '', '>');
  var iLimit61 = opt_data.Qtd;
  for (var i61 = 0; i61 < iLimit61; i61++) {
    output.append((i61 >= opt_data.StartFrom) ? '<option value="' + soy.$$escapeHtml(i61) + '" ' + ((opt_data.SelectedIndex != undefined ? i61 == opt_data.SelectedIndex : i61 == opt_data.StartFrom) ? 'selected=\'selected\'' : '') + '>' + soy.$$escapeHtml(i61) + '</option>' : '');
  }
  output.append('</select>');
  if (!opt_sb) return output.toString();
};


SearchEngine.selectAirCompany = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p>Companhias aÃ©reas:</p><select id="', soy.$$escapeHtml(opt_data.Id), '" tabindex="', soy.$$escapeHtml(opt_data.TabIndex), '"><option value="">Todas as cias aÃ©reas</option>');
  if (opt_data.settings && opt_data.settings.airCompanies) {
    var optionList88 = opt_data.settings.airCompanies;
    var optionListLen88 = optionList88.length;
    for (var optionIndex88 = 0; optionIndex88 < optionListLen88; optionIndex88++) {
      var optionData88 = optionList88[optionIndex88];
      output.append('<option value="', soy.$$escapeHtml(optionData88.c), '">', soy.$$escapeHtml(optionData88.dn), '</option>');
    }
  } else {
    output.append('<option value="AR">Aerolineas</option><option value="AM">AeromÃ©xico</option><option value="5L">Aerosur S A</option><option value="AB">Air Berlin</option><option value="AC">Air Canada</option><option value="TX">Air Caraibes</option><option value="CA">Air China</option><option value="UX">Air Europa</option><option value="AF">Air France</option><option value="AZ">Alitalia</option><option value="NH">All Nippon Airways</option><option value="Z8">Amaszonas</option><option value="AA">American Airlines</option><option value="R7">Aserca Airlines</option><option value="AV,O6">Avianca</option><option value="9V">Avior Airlines</option><option value="AD">Azul Linhas AÃ©reas</option><option value="UP">Bahamasair</option><option value="OB">Boliviana de AviaciÃ³n BoA</option><option value="5Q">BQB Lineas Aereas</option><option value="BA">British Airways</option><option value="CX">Cathay Pacific</option><option value="KX">Cayman Airways</option><option value="CZ">China Southern</option><option value="DE">Condor Flugdienst</option><option value="CO">Continental </option><option value="CM">Copa </option><option value="CU">Cubana</option><option value="DL">Delta </option><option value="PM">Deutsche Lufthansa A.g.</option><option value="LY">El Al</option><option value="EK">Emirates</option><option value="ET">Ethiopian</option><option value="EY">Etihad</option><option value="BR">EVA Airways</option><option value="G3">Gol Linhas AÃ©reas</option><option value="YO">Heli Air Monaco</option><option value="IB">Iberia</option><option value="8I">Insel Aruba</option><option value="JL">Japan </option><option value="KL">Klm</option><option value="KE">Korean Air</option><option value="LR">Lacsa</option><option value="LA">LAN Airlines (LA)</option><option value="4M">LAN Argentina (4M)</option><option value="LP">LAN Peru S.A (LP)</option><option value="JJ">LATAM</option><option value="LH">Lufthansa</option><option value="MH">Malaysian Airline</option><option value="MSQ">Meta Linhas AÃ©reas</option><option value="MX">Mexicana</option><option value="WY">Oman Air</option><option value="GP">Pantanal</option><option value="2Z">Passaredo</option><option value="PC">Pegasus Hava Tasimaciligi</option><option value="PU">Pluna</option><option value="Z4">Puma</option><option value="QF">Qantas Airways</option><option value="QR">Qatar Airways</option><option value="AT">Royal Air Maroc</option><option value="S3">Santa Barbara Airlines</option><option value="SLX">Sete Linhas Aereas</option><option value="SQ">Singapore Airlines</option><option value="H2">Sky Airline</option><option value="SA">South African</option><option value="LX">Swiss</option><option value="DT">TAAG-Angola</option><option value="TA">TACA</option><option value="VR">TACV Cabo Verde</option><option value="PZ">TAM Mercosur</option><option value="EQ">Tame Linea Aerea Del Ecuador</option><option value="TP">TAP</option><option value="TK">Turkish </option><option value="UA">United </option><option value="US">Usair</option><option value="EB">Wamos Air</option>');
  }
  output.append('</select>');
  if (!opt_sb) return output.toString();
};


SearchEngine.selectCabin = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p> Classes: </p><select id="', soy.$$escapeHtml(opt_data.Id), '" tabindex="', soy.$$escapeHtml(opt_data.TabIndex), '"><option value=""> Todas as classes</option><option value="0">1Âª Classe</option><option value="1">Executiva</option><option value="2">EconÃ´mica</option><option value="3">EconÃ´mica Premium</option></select>');
  if (!opt_sb) return output.toString();
};


SearchEngine.selectBaggageAllowance = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label class="label baggage select"><p>Bagagem</p><select id="drpBaggageFilter">');
  var baggageAllowanceList127 = opt_data.baggageAllowances;
  var baggageAllowanceListLen127 = baggageAllowanceList127.length;
  for (var baggageAllowanceIndex127 = 0; baggageAllowanceIndex127 < baggageAllowanceListLen127; baggageAllowanceIndex127++) {
    var baggageAllowanceData127 = baggageAllowanceList127[baggageAllowanceIndex127];
    output.append('<option value="', soy.$$escapeHtml(baggageAllowanceIndex127), '" ', (opt_data.baggageFilterSelected && opt_data.baggageFilterSelected == baggageAllowanceIndex127) ? 'selected="selected"' : '', '>');
    Resources.baggageAllowance({baggageAllowance: baggageAllowanceData127}, output);
    output.append('</option>');
  }
  output.append('</select></label>');
  if (!opt_sb) return output.toString();
};


ï»¿if (typeof Global.SearchEngine == 'undefined')
    Global.SearchEngine = {};

Global.SearchEngine.motorTabs = {
    searchmotor_tabs_air: {
        type: 'Air',
        name: 'Flight',
        title: 'searchmotor_tabs_air_title'
    },
    searchmotor_tabs_bus: {
        type: 'Bus',
        name: 'Bus',
        title: 'searchmotor_tabs_bus_title'
    },
    searchmotor_tabs_hotel: {
        type: 'Hotel',
        name: 'Hotel',
        title: 'searchmotor_tabs_hotel_title'
    },
    searchmotor_tabs_service: {
        type: 'Service',
        name: 'Service',
        title: 'searchmotor_tabs_service_title'
    },
    searchmotor_tabs_package: {
        type: 'Package',
        name: 'Package',
        title: 'searchmotor_tabs_package_title'
    },
    searchmotor_tabs_dynamic: {
        type: 'DynamicPackage',
        name: 'DynamicPackage',
        title: 'searchmotor_tabs_dynamic_title'
    },
    searchmotor_tabs_tour: {
        type: 'Tour',
        name: 'Tour',
        title: 'searchmotor_tabs_tour_title'
    },
    searchmotor_tabs_insurance: {
        type: 'Insurance',
        name: 'Insurance',
        title: 'searchmotor_tabs_insurance_title'
    },
    searchmotor_tabs_map: {
        type: 'Map',
        name: 'Map',
        title: 'searchmotor_tabs_map_title'
    },
    searchmotor_tabs_calendar: {
        type: 'Calendar',
        name: 'Calendar',
        title: 'searchmotor_tabs_calendar_title'
    },
    searchmotor_tabs_cruise: {
        type: 'Cruise',
        name: 'Cruise',
        title: 'searchmotor_tabs_cruise_title'
    }
};

Global.SearchEngine.getMotorTabName = function (product) {
    var name = Global.ShortCodeParameters[product.title];
    if (!name || !name.length)
        name = Resources.translate({ code: product.name })

    return name;
};

function SearchEngineTPL(options) {
    var _return = "";
    var settings = {};

    $.extend(true, settings, options || {});

    function _getMotorTabs() {
        var tabs = [];
        for (var parameter in Global.ShortCodeParameters) {
            if (Global.SearchEngine.motorTabs[parameter] && Global.ShortCodeParameters[parameter] == 'true') {
                var product = Global.SearchEngine.motorTabs[parameter];
                tabs.push({ type: product.type, name: Global.SearchEngine.getMotorTabName(product), class: product.name.toLowerCase(), active: Global.ShortCodeParameters.defaultsearch == product.type });
            }
        }

        $(tabs).each(function (i, v) {
            if (v.active && settings.defaultSearchEngine != v.type.toLowerCase())
                v.active = false;
            
            if (!v.active && settings.defaultSearchEngine == v.type.toLowerCase())
                v.active = true;
        });

        if (!tabs.any(function (t) { return t.active; }))
            tabs[0].active = true;

        return tabs;
    };

    if (Global.ShortCodeParameters['showsearchmotortabs'] && JSON.parse(Global.ShortCodeParameters['showsearchmotortabs']))
        _return = SearchEngine.motorTabs({ tabs: _getMotorTabs() });

    _return += SearchEngine[settings.tplName]({ 'settings': settings });

    return _return;
};

var AirSearchEngineTPL = function (options) {
    var _settings = {
        title: Global.SearchEngine.getMotorTabName(Global.SearchEngine.motorTabs.searchmotor_tabs_air),
        nonStop: Util.QueryString("NonStop", location.search),
        roundTrip: Util.QueryString("RoundTrip", location.search),
        airCompanies: Global.AirCompanies,
        version: options.versionSearchEngine,
        maxAdults: options.maxAdults,
        maxChildren: options.maxChildren,
        maxBabies: options.maxBabies,
        baggageAllowances: Object.keys(EnumHelper.BaggageAllowance).where(function (b) { return b.length > 2; }),
        baggageFilter: Util.QueryString("Baggage", location.search),
        enableMultiSearch: Global.Settings && Global.Settings.EnableTravelGoMultiSearch && Global.Settings.EnableTravelGoMultiSearch == 'true'
    };

    $.extend(true, _settings, options || {});

    return SearchEngine.AirContent(
        {
            'settings': _settings,
            isHome: Global.isHome,
            isMasterPricer: Global.isMasterPricer
        });
};

var BusSearchEngineTPL = function (options) {
    var _settings = {
        title: Global.SearchEngine.getMotorTabName(Global.SearchEngine.motorTabs.searchmotor_tabs_bus),
        nonStop: Util.QueryString("NonStop", location.search),
        roundTrip: Util.QueryString("RoundTrip", location.search),
        version: options.versionSearchEngine,
        enableMultiSearch: Global.Settings && Global.Settings.EnableTravelGoMultiSearch && Global.Settings.EnableTravelGoMultiSearch == 'true'
    };

    $.extend(true, _settings, options || {});

    return SearchEngine.BusContent(
        {
            'settings': _settings,
            isHome: Global.isHome
        });
};

function HotelSearchEngineTPL(options) {
    var _settings = {
        renderTitle: Global.SearchEngine.RenderTitle != undefined ? Global.SearchEngine.RenderTitle : true,
        renderLocation: Global.SearchEngine.RenderLocation != undefined ? Global.SearchEngine.RenderLocation : true,
        title: Global.SearchEngine.getMotorTabName(Global.SearchEngine.motorTabs.searchmotor_tabs_hotel),
        version: options.versionSearchEngine
    };

    $.extend(true, _settings, options || {});

    return SearchEngine.HotelContent({
        settings: _settings,
        isHome: Global.isHome
    });
};

function InsuranceSearchEngineTPL(options) {
    var _settings = {
        renderTitle: Global.SearchEngine.RenderTitle != undefined ? Global.SearchEngine.RenderTitle : true,
        renderLocation: Global.SearchEngine.RenderLocation != undefined ? Global.SearchEngine.RenderLocation : true,
        title: Global.SearchEngine.getMotorTabName(Global.SearchEngine.motorTabs.searchmotor_tabs_insurance),
        version: options.versionSearchEngine
    };

    $.extend(true, _settings, options || {});

    return SearchEngine.InsuranceContent({
        settings: _settings,
        isHome: Global.isHome
    });
};

function setCustomDateValues(settings) {

    settings.years = [];

    year = new Date().getFullYear();

    for (i = 0; i < settings.FlexibleSearchQtdYears; i++) {
        settings.years.push(year)
        year++;
    }

    settings.month = new Date().getMonth() + 1;
}

function MapSearchEngineTPL(options) {
    var _settings = {
        renderTitle: Global.SearchEngine.RenderTitle != undefined ? Global.SearchEngine.RenderTitle : true,
        renderLocation: Global.SearchEngine.RenderLocation != undefined ? Global.SearchEngine.RenderLocation : true,
        title: Global.SearchEngine.getMotorTabName(Global.SearchEngine.motorTabs.searchmotor_tabs_map),
        version: options.versionSearchEngine
    };

    $.extend(true, _settings, options || {});

    setCustomDateValues(_settings);

    return SearchEngine.MapContent({
        settings: _settings,
        isHome: Global.isHome
    });
};

function CalendarSearchEngineTPL(options) {
    var _settings = {
        renderTitle: Global.SearchEngine.RenderTitle != undefined ? Global.SearchEngine.RenderTitle : true,
        renderLocation: Global.SearchEngine.RenderLocation != undefined ? Global.SearchEngine.RenderLocation : true,
        title: Global.SearchEngine.getMotorTabName(Global.SearchEngine.motorTabs.searchmotor_tabs_calendar),
        version: options.versionSearchEngine
    };

    $.extend(true, _settings, options || {});

    setCustomDateValues(_settings);

    return SearchEngine.CalendarContent({
        settings: _settings,
        isHome: Global.isHome
    });
};

function ServiceSearchEngineTPL(options) {
    var _settings = {
        title: Global.SearchEngine.getMotorTabName(Global.SearchEngine.motorTabs.searchmotor_tabs_service),
        version: options.versionSearchEngine,
        enableSearchByName: false
    };

    $.extend(true, _settings, options || {});

    if (Global.ShortCodeParameters['simpleservice'] == 'true')
        _settings.template = SearchEngine.simpleService;

    return SearchEngine.ServiceContent({
        settings: _settings,
        isHome: Global.isHome
    });
};

function DynamicPackageSearchEngineTPL(options) {
    var _settings = {
        maxPassengers: 9,
        title: Global.SearchEngine.getMotorTabName(Global.SearchEngine.motorTabs.searchmotor_tabs_dynamic),
        version: options.versionSearchEngine,
        baggageAllowances: Object.keys(EnumHelper.BaggageAllowance).where(function (b) { return b.length > 2; }),
        baggageFilter: Util.QueryString("Baggage", location.search)
    };

    $.extend(true, _settings, options || {});

    var template = SearchEngine.dynamicPackageContent;
    if (Global.ShortCodeParameters['simpleservice'] == 'true')
        template = SearchEngine.simpleService;

    return template({
        settings: _settings,
        isHome: Global.isHome,
        maxPassengers: _settings.maxPassengers
    });
};

function TourSearchEngineTPL(options) {
    var _settings = {
        renderTitle: Global.SearchEngine.RenderTitle != undefined ? Global.SearchEngine.RenderTitle : true,
        title: Global.SearchEngine.getMotorTabName(Global.SearchEngine.motorTabs.searchmotor_tabs_tour),
        version: options.versionSearchEngine,
        enableSearchByName: false,
        maxPassengers: options.maxPassengers,
    };

    $.extend(true, _settings, options || {});

    return SearchEngine.TourContent({
        settings: _settings,
        isHome: Global.isHome
    });
};

function CruiseSearchEngineTPL(options) {
    var _settings = {
        title: Global.SearchEngine.getMotorTabName(Global.SearchEngine.motorTabs.searchmotor_tabs_cruise),
    };

    $.extend(true, _settings, options || {});

    _settings.maxPassengers = 5;
    _settings.maxChildren = 5;

    return SearchEngine.CruiseContent({
        settings: _settings,
        isHome: Global.isHome
    });
};

var ServiceSearchEngineCategoriesTPL = function (data) {
    return SearchEngine.CategoryCombo({ "categories": data });
};

var ServiceSearchEngineBlackListCategoriesTPL = function (data) {
    return SearchEngine.BlackListCategories({ "categories": data });
};

var ServiceSearchEnginePassengersAgesTPL = function (passengersAmount) {
    return SearchEngine.PassengersAges({ "amount": passengersAmount });
};

function PackageSearchEngineTPL(options) {

    var _settings = {
        maxRooms: 3,
        title: Global.SearchEngine.getMotorTabName(Global.SearchEngine.motorTabs.searchmotor_tabs_package),
        version: options.versionSearchEngine,
        enableSearchByName: false,
        maxDaysToSearch: 360,
    };

    var resp = "";

    $.fn.extend(_settings, options || {}, true);

    var salesFlowVersion = Util.GetSetting("HybridPackage.SalesFlowVersion") || Util.GetShortCodeParameter("hybridpackage_salesflowversion");

    if (salesFlowVersion)
        _settings.salesFlowVersion = salesFlowVersion;

    if (_settings.salesFlowVersion == EnumHelper.HybridPackageSalesFlowVersion.Two)
        _settings.maxRooms = 0;

    function _prepareRender(sett) {
        sett.availableDepartureOptions = SharedFunctions.GenerateSearchEngineAvailableMonths(_settings.maxDaysToSearch);
        return sett;
    };

    return SearchEngine.PackageContent({
        settings: _prepareRender(_settings),
        isHome: Global.isHome
    });
};

var PackageSearchEngineLocationsOptionsTPL = function (locations) {

    var locs = [];

    if (locations && locations.length && locations[0].lid) {
        locs = locations.selectMany(function (h) {
            var resp = [];

            if (h.n)
                resp.push({ Name: h.n, LocationId: h.lid, DestinationId: h.did });
            if (h.lname)
                resp.push({ Name: h.lname, LocationId: h.lid, DestinationId: 0 });

            return resp;
        });

        locs = locs.groupByWithoutKey(function (item) { return item.LocationId + "" + item.DestinationId; })
            .select(function (h) { return h[0]; });
    }
    else {
        locs = locations.select(function (h) {
            return { Name: h.c, LocationId: h.id, DestinationId: 0 };
        });
    }

    locs = locs.orderBy(function (h) { return h.Name; });

    return SearchEngine.locationsOptions({
        data: {
            locations: locs
        }
    });
};

ï»¿(function ($) {

    function ServicesAutocomplete() {
        var _component = undefined;
        var _serviceSelected = undefined;
        var _this = this;

        var _settings = {
            controllers: {
                searchController: undefined
            },
            events: {
                onSelectService: function () { }
            },
            serviceType: EnumHelper.Services.ServiceType.Other
        };

        var _events = {
            controllers: {
                getServicesByNameCompleted: function (response) {
                    if (response.GetServicesByNameRS.Services && response.GetServicesByNameRS.Services.length)
                        _component.dropBox("dropBoxAddItems", response.GetServicesByNameRS.Services);
                },
                onGetServiceByIdCompleted: function (response) {
                    if (response && response.GetServiceByIdRS && response.GetServiceByIdRS.Service) {
                        _this.setData(response.GetServiceByIdRS.Service);
                    }
                }
            },
            onSelectEvents: function (ctrl, selected) {
                _serviceSelected = selected;
                if (_settings.events.onSelectService)
                    _settings.events.onSelectService(_serviceSelected);
            }
        };

        var _functions = {
            controllers: {
                setEvents: function (action) {
                    _settings.controllers.searchController.getServicesByNameCompleted[action](_events.controllers.getServicesByNameCompleted);
                    _settings.controllers.searchController.getServiceByIdCompleted[action](_events.controllers.onGetServiceByIdCompleted);
                },
                attachEvents: function () {
                    _functions.controllers.setEvents('attach');
                },
                dettachEvents: function () {
                    _functions.controllers.setEvents('dettach');
                }
            },
            searchServices: function (ctrl, params) {
                _serviceSelected = undefined;
                _settings.controllers.searchController.getServicesByName(params.keyword, _settings.serviceType);
            },
            createAutoComplete: function () {
                _component.dropBox({
                    legend: Util.GetInterfaceMessage('ServicesAutocomplete_AutocompleteLegend'),
                    digitInterval: 300,
                    showHeader: false,
                    columns: [{ name: 'Name', title: Util.CallResources('Name') }],
                    onSearch: _functions.searchServices,
                    onSelect: _events.onSelectEvents,
                    useMoreResults: false,
                    searchColumn: 'Name'
                });
            },
            getServiceById: function (id) {
                _settings.controllers.searchController.getServiceById(id);
            },
        };

        this.destroy = function () {
            _functions.controllers.dettachEvents();
            _component.dropBox('destroy');
            _component.empty();
        };
        
        this.initialize = function (target, opts) {
            $.extend(true, _settings, opts || {});

            _component = $(target);

            _functions.controllers.attachEvents();
            _functions.createAutoComplete();
        };
        
        this.setData = function (selected) {
            _serviceSelected = selected;
            _component.dropBox('dropBoxSetSelected', _serviceSelected);
        };

        this.setDataByServiceName = function (serviceName) {
            var _temporaryGetServicesByNameCompleted = function (resp) {
                if (resp != undefined &&
                    resp.GetServicesByNameRS != undefined &&
                    Util.HasCount(resp.GetServicesByNameRS.Services)) {
                    _this.setData(resp.GetServicesByNameRS.Services[0]);
                }

                _settings.controllers.searchController.getServicesByNameCompleted["dettach"](_temporaryGetServicesByNameCompleted);

                _functions.controllers.attachEvents();
            };

            _serviceSelected = undefined;

            _functions.controllers.dettachEvents();

            _settings.controllers.searchController.getServicesByNameCompleted["attach"](_temporaryGetServicesByNameCompleted);
            _settings.controllers.searchController.getServicesByName(serviceName, _settings.serviceType);
        };

        this.setById = function (serviceId) {
            _functions.getServiceById(serviceId);
        };

        this.getData = function () {
            return _serviceSelected;
        };

        this.clearSelected = function () {
            _component.dropBox("dropBoxClearSelected");
        };
    }

    $.fn.servicesAutocomplete = function () {
        return Util.pluginDefaultBehavior(this, "servicesAutocomplete", arguments, function () { return new ServicesAutocomplete() });
    }
})(jQuery);

ï»¿(function ($) {

    function PackagesAutocomplete() {
        var _component = undefined;
        var _packageSelected = undefined;
        var _this = this;

        var _settings = {
            controllers: {
                searchController: undefined
            },
            events: {
                onSelectPackage: function () { }
            }
        };

        var _events = {
            controllers: {
                getPackagesByNameCompleted: function (response) {
                    if (response.Packages && response.Packages.length)
                        _component.dropBox("dropBoxAddItems", response.Packages);
                }
            },
            onSelectEvents: function (ctrl, selected) {
                _packageSelected = selected;
                if (_settings.events.onSelectPackage)
                    _settings.events.onSelectPackage(_packageSelected);
            }
        };

        var _functions = {
            controllers: {
                setEvents: function (action) {
                    _settings.controllers.searchController.getPackagesByNameCompleted[action](_events.controllers.getPackagesByNameCompleted);
                },
                attachEvents: function () {
                    _functions.controllers.setEvents('attach');
                },
                dettachEvents: function () {
                    _functions.controllers.setEvents('dettach');
                }
            },
            searchPackages: function (ctrl, params) {
                _packageSelected = undefined;
                _settings.controllers.searchController.getPackagesByName(params.keyword);
            },
            createAutoComplete: function () {
                _component.dropBox({
                    legend: Util.GetInterfaceMessage('PackagesAutocomplete_AutocompleteLegend'),
                    digitInterval: 300,
                    showHeader: false,
                    columns: [{ name: 'Name', title: Util.CallResources('Name') }],
                    onSearch: _functions.searchPackages,
                    onSelect: _events.onSelectEvents,
                    useMoreResults: false,
                    searchColumn: 'Name'
                });
            }
        };

        this.destroy = function () {
            _functions.controllers.dettachEvents();
            _component.dropBox('destroy');
            _component.empty();
        };

        this.initialize = function (target, opts) {

            $.extend(true, _settings, opts || {});

            _component = $(target);

            _functions.controllers.attachEvents();
            _functions.createAutoComplete();
        };

        this.setData = function (selected) {
            _packageSelected = selected;
            _component.dropBox('dropBoxSetSelected', _packageSelected);
        };

        this.getData = function () {
            return _packageSelected;
        };

        this.clearSelected = function () {
            _component.dropBox("dropBoxClearSelected");
        };
    }

    $.fn.packagesAutocomplete = function () {
        return Util.pluginDefaultBehavior(this, "packagesAutocomplete", arguments, function () { return new PackagesAutocomplete() });
    }
})(jQuery);

/// <reference path="../Libraries/Util.js" />

(function ($) {

    function MessagesExhibitor() {
        var thisMessagesExhibitor = this;
        var component = undefined;
        var lastexhibitionType = undefined;

        var settings = {
            scrollTo: true,
            template: function (x) { return ""; },
            controllers: {
                messagesController: undefined,
                searchController: undefined,
                checkOutController: undefined
            },
            components: {
                timerDisplay: '.timerDisplay',
            },
            events: {
                setAdditionalShowMessagesEvents: function () { },
                afterClear: function () { }
            },
            exhibitionType: undefined,
            type: undefined,
            addBold: true,
            addTag: undefined,
            hasTwoBehaviors: true,
            clickClear: true,
            componentTargetToRender: undefined,
            timerDisplay: 15000,
            showTimerDisplayCountdown: true
        }

        var showMessagesTimeOut = undefined;
        var timerDisplayCountdown = undefined;
        var timerDisplayTimeOut = undefined;
        var messagesToShow = [];

        var _functions = {
            events: {
                setEvents : function(action){
                    if (settings.controllers.messagesController) {
                        settings.controllers.messagesController.onMessages[action](thisMessagesExhibitor.showMessage);
                        settings.controllers.messagesController.onMessage[action](thisMessagesExhibitor.showMessage);
                        settings.controllers.messagesController.onHide[action](thisMessagesExhibitor.hideMessage);
                    }

                    if (settings.controllers.searchController) {
                        settings.controllers.searchController.searchStarting[action](thisMessagesExhibitor.clear);
                        settings.controllers.searchController.filterStarting[action](thisMessagesExhibitor.clear);
                        settings.controllers.searchController.changePackageStarting[action](thisMessagesExhibitor.clear);
                    }
                },
                attach: function () {
                    _functions.events.setEvents('attach');
                },
                dettach: function () {
                    _functions.events.setEvents('dettach');
                },
                setComponentEvents: function () {
                    if (settings.clickClear)
                        component.click(function () { thisMessagesExhibitor.clear() });

                    $(component).on('click', '.close', function () {
                        component.hide();
                        component.removeClass('opened');
                        $('.more_info', component).show();
                    });

                    $(component).on('click', '.more_info', function (e) {
                        component.addClass('opened');

                        e.stopPropagation();
                    });
                }
            }
        }

        this.changeSettings = function (opts) {
            $.extend(true, settings, opts || {});
        };

        this.showMessage = function (messages, exhibitionType, messageType) {

            if (!settings.hasTwoBehaviors && settings.exhibitionType != undefined && (exhibitionType != 0 && !exhibitionType))
                exhibitionType = settings.exhibitionType;

            if (exhibitionType == undefined)
                exhibitionType = EnumHelper.MessagesExhibitor.ExhibitionType.Inline;

            if (showMessagesTimeOut) {
                clearTimeout(showMessagesTimeOut);
            }
            else {
                thisMessagesExhibitor.clear();
            }

            messagesToShow = messagesToShow.concat(messages).distinct();

            showMessagesTimeOut = setTimeout(function () {

                var componentTarget = component;

                if ($(settings.componentTargetToRender) && $(settings.componentTargetToRender).length) {
                    componentTarget = $(settings.componentTargetToRender);
                    componentTarget.empty();
                }

                if (messagesToShow.length) {
                    lastexhibitionType = exhibitionType;

                    var content = "<center>";

                    if (settings.addTag) {
                        for (var i = 0; i < messagesToShow.length; i++) {

                            content += "<" + settings.addTag + ">";

                            if (i == 0) {
                                if (settings.addBold)
                                    content += "<b>" + messagesToShow[i] + "</b>";
                                else
                                    content += messagesToShow[i];
                            }
                            else {
                                content += messagesToShow[i];
                            }

                            content += "</" + settings.addTag + ">";
                        }
                    }
                    else {
                        content += "<p class='first errorLineMessage'>" + messagesToShow[0] + "</p>";

                        for (var msgToShowIndex = 1; msgToShowIndex < messagesToShow.length; msgToShowIndex++) {
                            content += "<p class='errorLineMessage'>" + messagesToShow[msgToShowIndex] + "</p>";
                        }
                    }

                    content += "</center>";

                    if (exhibitionType == EnumHelper.MessagesExhibitor.ExhibitionType.Dialog)
                        _showDialog(content);
                    else if (exhibitionType == EnumHelper.MessagesExhibitor.ExhibitionType.Slider)
                        _showSlider(content);
                    else if (exhibitionType == EnumHelper.MessagesExhibitor.ExhibitionType.Alert)
                        if (typeof swal != "undefined") {
                            if (!messageType)
                                messageType = EnumHelper.MessagesExhibitor.Type.Info;

                            for (var i = 0; i < messagesToShow.length; i++)
                                messagesToShow[i] = messagesToShow[i].replaceAll('\n', '<br />');

                            swal({
                                html: messagesToShow.join('<br />'),
                                type: EnumHelper.MessagesExhibitor.Type[messageType].toLowerCase(),
                                confirmButtonColor: '#74b749',
                                confirmButtonText: Resources.translate({ code: "Close" }),
                                width: 700
                            });
                        }
                        else
                            alert(messagesToShow.join('\n'));
                    else {
                        componentTarget.append(content).show();
                        if ($(".message_alert center").length != 0)
                            component.show();
                    }
                }

                showMessagesTimeOut = undefined;
                messagesToShow = [];

                if (settings.scrollTo && $.scrollTo) {
                    var top = componentTarget.offset().top;

                    if (exhibitionType == EnumHelper.MessagesExhibitor.ExhibitionType.Dialog) {
                        var parent = componentTarget.parent('.ui-dialog');
                        if (parent && parent.length)
                            top = componentTarget.parent('.ui-dialog').offset().top;
                    }

                    if (top > 35) top -= 35;

                    $.scrollTo({ top: top, left: 0 }, 100);
                }

                _VerifyMoreInfoVisibility();

                if (settings.events.setAdditionalShowMessagesEvents)
                    settings.events.setAdditionalShowMessagesEvents();

                _timerDisplaySettings(exhibitionType);

            }, 500);
        }

        function _VerifyMoreInfoVisibility() {
            var paragraphsHeight = 0;

            component.find('.messagesExhibitor p').each(function (i) {
                var ctrl = $(this);
                paragraphsHeight += ctrl.height();
            });

            if (paragraphsHeight < 40)
                $('.more_info', component).hide();
            else
                $('.more_info', component).show();

            component.removeClass('opened');
        }

        var _timerDisplaySettings = function (exhibitionType) {

            if (exhibitionType != EnumHelper.MessagesExhibitor.ExhibitionType.Fixed) {

                var timerDisplay = _getTimerDisplay();

                if (timerDisplay > 0) {
                    timerDisplayTimeOut && clearTimeout(timerDisplayTimeOut);

                    timerDisplayTimeOut = setTimeout(function _timeDisplayFunc() {
                        thisMessagesExhibitor.clear();
                        timerDisplayCountdown && clearInterval(timerDisplayCountdown);
                    }, timerDisplay);

                    if (settings.showTimerDisplayCountdown) {
                        var timerDisplayer = $(settings.components.timerDisplay, component);

                        var seconds = parseInt(timerDisplay / 1000, 10);

                        timerDisplayer.html(seconds--).show();

                        timerDisplayCountdown && clearInterval(timerDisplayCountdown);

                        timerDisplayCountdown = setInterval(function _countDown() {
                            timerDisplayer.html(seconds--);
                        }, 1000);
                    }
                }
            }
        };

        this.hideMessage = function () {
            component.hide();

            if ($(settings.componentTargetToRender) && $(settings.componentTargetToRender).length)
                $(settings.componentTargetToRender).hide();
        }

        this.clear = function () {
            if (lastexhibitionType == EnumHelper.MessagesExhibitor.ExhibitionType.Slider) {
                if ($(settings.componentTargetToRender) && $(settings.componentTargetToRender).length)
                    $(settings.componentTargetToRender).html('').slideUp();
                else
                    component.html('').slideUp();
            }
            else if (lastexhibitionType == EnumHelper.MessagesExhibitor.ExhibitionType.Dialog) {
                component.html('');
            }
            else {
                if ($(settings.componentTargetToRender) && $(settings.componentTargetToRender).length) {
                    $(settings.componentTargetToRender).empty();
                    component.hide(50);
                }
                else
                    component.hide(50).empty();
            }

            settings.events.afterClear && settings.events.afterClear();
        }

        this.destroy = function () {
            _functions.events.dettach();
        };

        this.setComponentTargetToRender = function (jQueryComp) {
            settings.componentTargetToRender = jQueryComp;
        };

        this.initialize = function (comp, opts) {

            component = $(comp);

            $.extend(true, settings, opts || {});

            _functions.events.dettach();
            _functions.events.attach();

            _functions.events.setComponentEvents();
        }

        function _showSlider(content) {
            component.append(content).slideDown();
        }

        function _setSliderEvents() {
            component.unbind('click').click(function () {
                $(this).html('').slideUp();
            });
        }

        function _showDialog(content) {
            if ($("." + component.attr("class")).is(':visible'))
                $("." + component.attr("class")).destroyDialog();

            component.html(content);

            var jDialog = component.clone();
            try {
                jDialog.destroyDialog();
            } catch (e) { }
            jDialog.attr("title", _getTitle());

            jDialog.dialog({
                modal: true,
                closeText: "show",
                draggable: false,
                dialogClass: 'messages-exhibitor',
                position: { my: "center top+10px", at: "center top", of: window },
                buttons: {
                    Ok: function () {
                        $(this).dialog("close");
                        settings.controllers.messagesController.closeExhibitor({});
                    }
                }
            });

            jDialog.on('dialogclose', function (event) {
                settings.controllers.messagesController.closeExhibitor({});
            });
        }

        function _getTitle() {
            return Util.MessagesExhibitionTypeResolver(settings.exhibitionType);
        }

        function _getTimerDisplay() {

            if (Util && Util.GetSetting) {
                var timerDisplaySetting = Util.GetSetting("MessagesExhibitorTimerDisplay");

                if (timerDisplaySetting) {

                    var timerDisplayValue = parseInt(timerDisplaySetting);

                    if (!isNaN(timerDisplayValue))
                        return timerDisplayValue;
                }
            }

            return settings.timerDisplay;
        }
    };

    $.fn.messagesExhibitor = function () {
        return Util.pluginDefaultBehavior(this, "messagesExhibitor", arguments, function () { return new MessagesExhibitor() });
    };
})(jQuery);


ï»¿/// <reference path="../Libraries/Util.js" />

if (!Global) var Global = {};
if (!Global.Culture)
    Global.Culture = "pt-BR";

Global.SearchTypes = {
    PesqInc: 1,
    Proximity: 2,
    Full: 3
};

Global.Product = {
    None: 0,
    Air: 1,
    Hotel: 2,
    AirHotel: 3,
    Service: 4,
    Car: 5,
    Cruise: 6,
    Itinerary: 7,
    Bus: 8
};

Global.ProductTypeRDC = {
    Air: 1,
    Hotel: 2,
    Car: 3,
    Package: 4,
    Cruise: 7,
    MultiProducts: 8,
    Insurance: 9,
    Services: 10,
    Road: 11
};

(function ($) {

    function searchStepRecorder() {
        this.SearchSteps = [],
		this.ResultedName = "",
        this.ResultedId = 0,
        this.MinLen = 0,
        this.MaxLen = 30,

        this.exists = function (text) {
            return this.SearchSteps.length && this.SearchSteps.any(function (t) { return t == text; });
        };

        this.add = function (text) {
            if (text.replace(/[ ]+/, '').length <= this.MinLen)
                this.clear();
            else
                if (!this.exists(text))
                    this.SearchSteps.push(text);

            if (this.SearchSteps.length > this.MaxLen)
                this.SearchSteps.shift();

            this.choose(text, 0);
            this.toString();
        };

        this.clear = function () {
            this.SearchSteps = [];
            this.ResultedName = "";
            this.ResultedId = 0;
        };

        this.choose = function (text, id) {
            this.ResultedName = text;
            this.ResultedId = id;
        };
    }

    function LocationsFinder() {
        var stepRecorder = new searchStepRecorder();
        var thisLocationsFinder = this;
        var component = undefined;
        var uniqueController = [];

        var settings = {
            Disturb: {
                Use: true,
                MinLen: 3,
                UseNumbers: true,
                Alter: { Use: true, MinLen: 4 },
                Delete: { Use: true, MinLen: 5 },
                Include: { Use: true, MinLen: 4 },
                Transpose: { Use: true, MinLen: 4 }
            },
            Normalize: {
                Use: true,
                Trim: true,
                RemoveArticles: false,
                RemoveDuplicatedChars: true,
                RemoveNonAlphanumerics: true,
                PreventPortugueseErrors: true
            },
            controllers: {
                locationsController: undefined
            },
            columns: {
                type: false,
                name: true,
                h: false
            },
            xhtmlColumns: ["id", "ip"],
            IsCity: true,
            IsAirport: true,
            HasIata: false,
            HasHotelCode: false,
            waitElement: undefined,
            matchOnlyAtBeginning: true,
            clientCache: [],
            maxResultsClient: 15,
            maxResultsServer: 10,
            useMoreResults: false,
            moreResultsMessage: "Mais Resultados",
            useCacheEnhancer: true,
            onlyHalfClientResults: true,
            DisturbProximities: false,
            idealNumberOfProximitiesRoots: 3,
            idealNumberOfProximities: 6,
            SearchType: Global.SearchTypes.Full,
            CurrentProduct: Global.Product.AirHotel,
            culture: undefined,
            countryId: undefined,
            recordStep: true,
            onDropBoxSelect: stepRecorderSave,
            onSelectLocation: function (location) { },
            removeAllAirportsFromName: true,
            useScroll: false,
            applyStatusClasses: true,
            applyFixedClass: false,
            useClientCache: true,
            useJustCache: false,
            includeAirportsChildren: true,
            personalizedSearch: false,
            useBrowserGeoLocation: false,
            noFilter: false,
            searchColumn: 'n'
            , alternativeColumns: [],
            loadProximities: false
        };

        function _attachEvents() {
            if (settings.controllers.locationsController) {
                settings.controllers.locationsController.searchCompleted.attach(thisLocationsFinder.renderLocations);

                if (settings.useBrowserGeoLocation) {
                    settings.controllers.locationsController.searchByGeolocationCompleted.attach(thisLocationsFinder.renderGeolocation);
                }
            }
        }

        function _dettachEvents() {
            if (settings.controllers.locationsController) {
                settings.controllers.locationsController.searchCompleted.dettach(thisLocationsFinder.renderLocations);

                if (settings.useBrowserGeoLocation) {
                    settings.controllers.locationsController.searchByGeolocationCompleted.dettach(thisLocationsFinder.renderGeolocation);
                }
            }
        }

        this.initialize = function (target, options) {
            var clientCache = options.clientCache || [];

            options.clientCache = [];

            $.extend(true, settings, options || {});

            settings.clientCache = clientCache;
            options.clientCache = settings.clientCache;

            _dettachEvents();
            _attachEvents();

            component = $(target);

            var columns = [];

            if (settings.columns.googleIdentifier && typeof Ide != 'undefined' && Ide.applicationSettings.GoogleApiKey)
                columns.push({ name: 'googleIdentifier', title: 'googleIdentifier', width: 20, onDraw: _getGoogleIdentifierImage });

            if (settings.columns.type)
                columns.push({ name: 'Type', title: 'Type', width: 50, onDraw: _getLocationTypeImage });

            if (settings.columns.name)
                columns.push({ name: 'n', title: 'Name', width: 1050, onDraw: _getName });

            if (settings.columns.h)
                columns.push({ name: 'h', title: 'h', width: 50 });

            if (settings.alternativeColumns != null && settings.alternativeColumns.length > 0) {
                settings.alternativeColumns.forEach(function (value, index) {
                    columns.push(value);
                });
            }

            if (typeof Ide != 'undefined' && Ide.applicationSettings.GoogleApiKey)
                settings.clientCache = undefined;

            if (settings.clientCache) {
                for (var i = 0; i < settings.clientCache.length; i++) {
                    var item = settings.clientCache[i];
                    item.NameNormalized = _normalize(item.n);
                    item.IATANormalized = (item && item.i && item.i.toLowerCase() || "");
                    uniqueController.push(item.id);
                }
            }

            component.dropBox({
                showHeader: false,
                lineHeight: component.height(),
                boxWidth: 350,
                boxHeight: 230,

                maxResultsServer: settings.maxResultsServer,
                maxResultsClient: settings.maxResultsClient,
                linesByPaging: 8,
                digitInterval: 200,
                maxRequestsPerSecond: 3,
                minSearchLength: 1,

                highlightMatchText: true,
                highlightMatchTextMinLen: 2,

                onSelect: settings.onDropBoxSelect,
                onNewSearchTerm: stepRecorderAdd,
                onSearchClient: _pesqIncSearchClient,
                onSearch: _pesqIncSearchServer,

                cacheEnhancer: _pescIncCacheEnhancer,

                onNewSearchTermParams: {},
                onSearchClientParams: {},
                onSearchParams: {},

                items: settings.clientCache,
                searchColumn: settings.searchColumn,
                uniqueColumn: 'n',
                columns: columns,
                xhtmlColumns: settings.xhtmlColumns,

                waitElement: settings.waitElement,
                moreResultsMessage: settings.moreResultsMessage,
                useMoreResults: settings.useMoreResults,
                currentProduct: settings.CurrentProduct,
                useScroll: settings.useScroll,
                applyStatusClasses: settings.applyStatusClasses,
                applyFixedClass: settings.applyFixedClass
            });

            component.bind("paste", function () { return false; });

            if (settings.useBrowserGeoLocation)
                _askGeolocation();

        }

        function _askGeolocation() {
            if (navigator.geolocation && window.location.protocol.contains('https')) {
                navigator.geolocation.getCurrentPosition(_setGeolocationPosition);
            } else {
                //console.log("Geolocation nÃ£o Ã© suportado por este navegador.");
            }
        }

        function _setGeolocationPosition(position) {

            settings.latitude = position.coords.latitude;
            settings.longitude = position.coords.longitude;

            var request = {
                "Latitude": settings.latitude,
                "Longitude": settings.longitude,
                "Culture": Global.Culture.toLowerCase()
            };
            settings.controllers.locationsController.searchByGeolocation(request);
        }

        function _getTotalWidth() {
            var width = parseFloat(component.width());
            width += parseFloat(component.css('padding-left'));
            width += parseFloat(component.css('padding-right'));

            return width;
        }

        function _getName(item) {
            if (!item.go)
                return item.n;
            else
                return item.n + " - <span class='googleLocationDescription'>" + item.d + "</span>";
        }

        function _getGoogleIdentifierImage(item) {
            return "<div class='googleLocation_" + item.go + "'></div>";
        }

        function _getLocationTypeImage(currentItem) {
            return "<div class='pesqIncLocation_" + currentItem.Type + "'></div>";
        }

        function _removeNonPesqIncChars(text) {
            var iataRegex = /[0-9A-Za-z\(\)\[\]\/\-, ]+/;

            var result = iataRegex.exec(text);

            return (result && result[0]) ? result[0].toString().replace("()", "").replace("[]", "") : "";
        }

        function _normalize(text) {
            if (settings.Normalize.Use) {
                text = Util.RetiraAcentos(text).toLowerCase();

                if (settings.Normalize.RemoveNonAlphanumerics)
                    text = _removeNonPesqIncChars(text);

                if (settings.Normalize.RemoveDuplicatedChars) {
                    var chars = text.split("");
                    var resp = [""];

                    for (var i = 0; i < chars.length; i++)
                        if (i > (chars.length - 2) || chars[i] != chars[i + 1])
                            resp[resp.length] = chars[i];

                    text = resp.join("");
                }

                if (settings.Normalize.PreventPortugueseErrors) {
                    text = text
						.replace(/[Ã¡Ã Ã¢Ã£]/g, "a")
						.replace(/[Ã©Ã¨Ãª]/g, "e")
						.replace(/[Ã­Ã¬Ã®]/g, "i")
						.replace(/[Ã³Ã²Ã´Ãµ]/g, "o")
						.replace(/[ÃºÃ¹Ã»]/g, "u")
						.replace(/!^k/g, "c")
						.replace(/Ã§/g, "s")
						.replace(/ss/g, "s")
						.replace(/sh|ch/g, "x")
						.replace(/lh/g, "l")
						.replace(/nh/g, "n");
                }
            }

            return text;
        }

        function _disturbedTextPattern(text, matchOnlyAtBeginning) {
            var pattern = "";

            var normText = _normalize(text).replace("(", "").replace(")", "");

            var changes = (settings.Disturb.UseNumbers) ? "[a-zA-Z0-9_]" : "[a-zA-Z]";

            pattern = ((matchOnlyAtBeginning) ? "^(" : "(") + normText + ")|";
            text = text.replace("^[\w]", "");

            if (text.length == 2)
                pattern = pattern.concat("(/" + normText + ")|");

            if (text.length == 3)
                pattern = pattern.concat("(\\\((" + text + ")\\\))|");

            //Permite BUSCA por ESTADO no client. Retirado para buscas de Aeroportos
            if (text.length >= 3 && !settings.HasIata)
                pattern = pattern.concat("(-" + normText + ")|");

            if (text.length >= 3)
                pattern = pattern.concat("(," + normText + ")|");

            pattern = pattern.concat("(\\\[" + normText + ")|");

            if (settings.Disturb.Use && normText.length > 1 && normText.length >= settings.Disturb.MinLen) {

                if (settings.Disturb.Alter.Use && normText.length >= settings.Disturb.Alter.MinLen)
                    for (var i = 1; i < normText.length + 1; i++)
                        pattern = pattern.concat((matchOnlyAtBeginning) ? "^(" : "(").concat(normText.substring(0, i - 1)).concat(changes).concat(normText.substring(i, normText.length)).concat(")|");

                if (settings.Disturb.Delete.Use && normText.length >= settings.Disturb.Delete.MinLen)
                    for (var i = 1; i < normText.length + 1; i++)
                        pattern = pattern.concat((matchOnlyAtBeginning) ? "^(" : "(").concat(normText.substring(0, i - 1)).concat(normText.substring(i, normText.length)).concat(")|");

                if (settings.Disturb.Include.Use && normText.length >= settings.Disturb.Include.MinLen)
                    for (var i = 0; i < normText.length + 1; i++)
                        pattern = pattern.concat((matchOnlyAtBeginning) ? "^(" : "(").concat(normText.substring(0, i)).concat(changes).concat(normText.substring(i, normText.length)).concat(")|")

                if (settings.Disturb.Transpose.Use && normText.length >= settings.Disturb.Transpose.MinLen)
                    for (var i = 0; i < normText.length - 1; i++)
                        pattern = pattern.concat((matchOnlyAtBeginning) ? "^(" : "(").concat(normText.substring(0, i)).concat(normText.substring(i + 1, i + 2)).concat(normText.substring(i, i + 1)).concat(normText.substring(i + 2, normText.length)).concat(")|");
            }

            pattern = pattern.substring(0, pattern.length - 1);

            pattern += "|( " + normText + ")";

            return new RegExp(pattern);
        }

        function _clearValues() {
            component.attr("selectedLocationId", 0);

            component.attr("selectedLocationIdProximity", 0);
        }

        function _pesqIncSearchClient(ctrl, paramns) {
            var justNational = settings.countryId == 210;

            if (settings.useClientCache) {
                _clearValues();

                var inputValue = component.val();

                var normSearchTerm = _normalize(inputValue);

                if (normSearchTerm != "" && settings.clientCache) {

                    var disturbedPattern = _disturbedTextPattern(normSearchTerm, settings.matchOnlyAtBeginning);

                    var resultList = [];

                    var resultList = settings.clientCache.where(function (item) {
                        return (
                            item && ((item.i && item.i.length && disturbedPattern.test(item.i.toLowerCase())) || disturbedPattern.test(item.NameNormalized)) && FilterResult(item)
                            ) || settings.noFilter;
                    });

                    resultList.orderByDescending(function (o) { return o.h });

                    var onlyLetters = inputValue.replace("^[\w]", "");

                    if (onlyLetters.length == 3)
                        resultList = _priorizeIATAMatchs(resultList, onlyLetters);

                    if (settings.IsAirport && settings.includeAirportsChildren)
                        resultList = _includeAirportsChildren(resultList);

                    if (settings.onlyHalfClientResults && resultList.length >= (settings.maxResultsClient / 2))
                        resultList = resultList.slice(0, settings.maxResultsClient / 2);

                    if (justNational && resultList.length)
                        resultList = resultList.where(function (rst) { return rst["in"] == false; });
                    
                    if (settings.CurrentProduct === Global.Product.Bus)
                        resultList = []; // nao utiliza o cache no rodoviario
                    
                    thisLocationsFinder.renderLocations({ Locations: resultList, isClientCall: true });
                }
            }
        }
        
        function _priorizeIATAMatchs(resultList, onlyLetters) {

            onlyLetters = onlyLetters.toLowerCase();

            var iataMatches = resultList.where(function (o) { return o != null && o.i != null && o.i.toLowerCase() == onlyLetters; });

            if (iataMatches.length) {
                resultList = resultList.removeAll(function (o) { return o.i != null && o.i.toLowerCase() == onlyLetters; });
                resultList = iataMatches.concat(resultList);
            }

            return resultList;
        }

        function _includeAirportsChildren(resultList) {
            var auxList = [];

            for (var i = 0; i < resultList.length; i++) {

                auxList.push(resultList[i]);

                var includeAirportsChildren = resultList[i].ac && (settings.CurrentProduct == Global.Product.Air || settings.CurrentProduct == Global.Product.AirHotel);

                if (includeAirportsChildren)
                    for (var j = 0; j < resultList[i].ac.length; j++)
                        auxList.push(resultList[i].ac[j]);
            }

            return auxList;
        }

        //Copia de Framework.Locations.DTO.Location.LocationType
        var LocationType = {
            World: 0,
            Continent: 1,
            Country: 2,
            State: 3,
            City: 4,
            Airport: 5,
            Region: 6
        }

        function FilterResult(item) {

            itemType = (item.t) ? item.t : 0;
            itemIata = (item.i) ? item.i.replace(/[ ]+/g, "") : "";
            itemCode = (item.hc) ? item.hc : false;

            var validation =
                ((settings.IsCity && LocationType.City == itemType) || (settings.IsAirport && LocationType.Airport == itemType))
                && (!settings.HasIata || itemIata != "") && (!settings.HasHotelCode || itemCode)

            return validation;
        }

        function stepRecorderAdd() {
            stepRecorder.add(component.val());
        }

        function stepRecorderSave(ctrl, onSelectParams) {
            var val = component.val();
            var id = onSelectParams.id;
            var ip = onSelectParams.ip;

            stepRecorder.choose(val, id);
            component.attr("selectedLocationId", id);
            component.attr("selectedLocationIdProximity", ip);

            var req = {
                "ResultedId": stepRecorder.ResultedId,
                "ResultedName": stepRecorder.ResultedName,
                "SearchSteps": stepRecorder.SearchSteps
            };

            settings.controllers.locationsController.saveSteps(req);
            stepRecorder.clear();
        }

        function _pesqIncSearchServer(ctrl, params) {

            if (params.keyword && !settings.useJustCache) {

                var regOnluLetters = /[A-Za-z]+/;

                var result = regOnluLetters.exec(params.keyword);

                if ((result) && result.length > 0) {

                    var filter = {
                        HasIata: settings.HasIata,
                        HasHotelCode: settings.HasHotelCode,
                        ShowBus: settings.ShowBus,
                        LocationTypes: [],
                        LoadProximities: settings.loadProximities
                    }

                    if (settings.LocationsType && settings.LocationsType.length > 0) {
                        filter.LocationTypes = settings.LocationsType;
                    }
                    else {
                        if (settings.IsCity)
                            filter.LocationTypes.push(4);

                        if (settings.IsAirport)
                            filter.LocationTypes.push(5);
                    }

                    var req = {
                        "Filter": filter,
                        "Culture": (Global.Culture) ? Global.Culture.toLowerCase() : 'pt-BR',
                        "Keyword": params.keyword,
                        "DisturbProximities": settings.DisturbProximities,
                        "IdealNumberOfProximitiesRoots": settings.idealNumberOfProximitiesRoots,
                        "IdealNumberOfProximities": settings.idealNumberOfProximities,
                        "IdealAmountResults": settings.maxResultsServer,
                        "SearchType": settings.SearchType,
                        "CurrentProduct": settings.CurrentProduct,
                        "IncludeAirportsChildren": settings.includeAirportsChildren,
                        "CountryId": settings.countryId,
                        "LoadCityCodes": settings.LoadCityCodes,
                        "UseGooglePlaces": true
                    };

                    if (settings.hasOwnProperty("allowCitiesWithoutIATA")
                        && settings.allowCitiesWithoutIATA != undefined
                        && typeof settings.allowCitiesWithoutIATA == "boolean") {
                        req.AllowCitiesWithoutIATA = settings.allowCitiesWithoutIATA;
                    }

                    settings.controllers.locationsController.search(req);
                }
            }
        }

        function _pescIncCacheEnhancer(items) {
            if (items && settings.useCacheEnhancer) {

                uniqueController = uniqueController.sort(function (a, b) { return a - b });

                for (var i = 0; i < items.length; i++) {

                    var addedItem = (RecursiveBinarySearch(uniqueController, items[i].id, 0, uniqueController.length) != -1);

                    var isProximity = items[i].n.indexOf("[") != -1;

                    if (items[i].ip > 0)
                        items[i].ip = items[i].ip;

                    if (!addedItem && !isProximity) {
                        items[i].NameNormalized = _normalize(items[i].n);
                        items[i].IATANormalized = (items[i] && items[i].i && items[i].i.toLowerCase() || "");

                        if (settings.clientCache)
                            settings.clientCache.push(items[i]);

                        uniqueController.push(items[i].id);
                    }
                }
            }
        }

        function RecursiveBinarySearch(items, search, min, max) {
            if (min > max)
                return -1;

            var index = parseInt((min + max) / 2, 10);

            if (items[index] > search)
                return RecursiveBinarySearch(items, search, min, index - 1)
            else if (items[index] < search)
                return RecursiveBinarySearch(items, search, index + 1, max)
            else if (items[index] == search)
                return index;
            else
                return -1;
        }

        function _pesqIncError(ctrl, result) {
            alert("Deu erro!"
                    + "\n\n" + ctrl
                    + "\n\n" + result
                );
        }

        this.renderGeolocation = function (result) {

            var origin = component.dropBox("dropBoxGetSelection") ? component.dropBox("dropBoxGetSelection") : (component.val().trim() !== "" ? component.val().trim() : undefined);

            if (!origin && settings.CurrentProduct === 1 && settings.useBrowserGeoLocation && result.NearestAirport) {
                component.dropBox("dropBoxSetSelected", result.NearestAirport);
            }
        }

        this.renderLocations = function (result) {

            var val = component.val().trim();

            if (settings.personalizedSearch) {
                if (component.is(':focus'))
                    component.dropBox("dropBoxAddItems", result.Locations || [], val, result.isClientCall);
            } else {
                if (result.Keyword == val || result.isClientCall) {
                    if (!result.Locations)
                        result.Locations = [];

                    if (result.Locations && result.Locations.length == 0)
                        result.Locations.push(_getContinueTypingObject());
                    if (component.is(':focus'))
                        component.dropBox("dropBoxAddItems", result.Locations, val, result.isClientCall);
                    else
                        component.dropBox("hideDropBox");
                }
            }
        }
        
            this.hide = function () {
                component.dropBox("hideDropBox");
            };

            function _getContinueTypingObject() {
                return new (function () {
                    this.n = _getContinueTypingPhrase(),
                    this.d = _getContinueTypingPhrase(),
                    this.c = _getContinueTypingPhrase(),
                    this.h = 0,
                    this.t = 4
                    this.i = "",
                    this.hc = "",
                    this.ip = 0,
                    this.ac = null,
                    this.id = 999999,
                    this.continueTyping = true
                });
            }

            function _getContinueTypingPhrase() {
                switch (Global.Culture.toLowerCase()) {
                    case "pt-br": return "Continue digitando ou aguarde o resultado";
                    case "en-us": return "Continue entering or wait for the result";
                    case "es-ar": return "Siga ingresando o esperar a que el resultado";
                    case "es-mx": return "Siga ingresando o esperar a que el resultado";           
                    default: return "Downloading";
                }
            }

            function _fillLocation(iataNormalized, nameNormalized, c, d, h, i, id, n, nOriginal) {
                return {
                    IATANormalized: iataNormalized,
                    NameNormalized: nameNormalized,
                    ac: null,
                    c: c,
                    d: d,
                    h: h,
                    hc: true,
                    i: i,
                    id: id,
                    ip: 0,
                    n: n,
                    nOriginal: nOriginal,
                    t: 4
                };
            }

            function _fillDataAzul(data) {
                if (!data) {
                    switch (component.val()) {
                        case "bel-azul":
                            data = _fillLocation("bel", "belem - para / br, brasil, todos os aeroportos (bel)", "BelÃ©m - ParÃ¡ / BR, Brasil, Todos os Aeroportos (BEL)", "BelÃ©m", 4093, "BEL", 249890, "BelÃ©m - ParÃ¡ / BR, Brasil, Todos os Aeroportos (BEL)", "BelÃ©m - ParÃ¡ / BR, Brasil, Todos os Aeroportos (BEL)");
                            break;
                        case "cnf-azul":
                            data = _fillLocation("cnf", "confins - minas gerais / br, brasil (cnf)", "Confins - Minas Gerais / BR, Brasil (CNF)", "Confins", 74, "CNF", 255013, "Confins - Minas Gerais / BR, Brasil (CNF)", "BelÃ©m - ParÃ¡ / BR, Brasil, Todos os Aeroportos (BEL)");
                            break;
                        case "bsb-azul":
                            data = _fillLocation("bsb", "brasilia - distrito federal / br, brasil, todos os aeroportos (bsb)", "BrasÃ­lia - Distrito Federal / BR, Brasil, Todos os Aeroportos (BSB)", "BrasÃ­lia", 15723, "BSB", 250993, "BrasÃ­lia - Distrito Federal / BR, Brasil, Todos os Aeroportos (BSB)", "BrasÃ­lia - Distrito Federal / BR, Brasil, Todos os Aeroportos (BSB)");
                            break;
                        case "vcp-azul":
                            data = _fillLocation("vcp", "campinas - sao paulo / br, brasil, todos os aeroportos (vcp)", "Campinas - SÃ£o Paulo / BR, Brasil, Todos os Aeroportos (VCP)", "Campinas", 3552, "VCP", 252381, "Campinas - SÃ£o Paulo / BR, Brasil, Todos os Aeroportos (VCP)", "Campinas - SÃ£o Paulo / BR, Brasil, Todos os Aeroportos (VCP)");
                            break;
                        case "cwb-azul":
                            data = _fillLocation("cwb", "curitiba - parana / br, brasil, todos os aeroportos (cwb)", "Curitiba - ParanÃ¡ / BR, Brasil, Todos os Aeroportos (CWB)", "Curitiba", 29263, "CWB", 255767, "Curitiba - ParanÃ¡ / BR, Brasil, Todos os Aeroportos (CWB)", "Curitiba - ParanÃ¡ / BR, Brasil, Todos os Aeroportos (CWB)");
                            break;
                        case "fln-azul":
                            data = _fillLocation("fln", "florianopolis - santa catarina / br, brasil, todos os aeroportos (fln)", "FlorianÃ³polis - Santa Catarina / BR, Brasil, Todos os Aeroportos (FLN)", "FlorianÃ³polis", 63286, "FLN", 258559, "FlorianÃ³polis - Santa Catarina / BR, Brasil, Todos os Aeroportos (FLN)", "FlorianÃ³polis - Santa Catarina / BR, Brasil, Todos os Aeroportos (FLN)");
                            break;
                        case "for-azul":
                            data = _fillLocation("for", "fortaleza - ceara / br, brasil (for)", "Fortaleza - CearÃ¡ / BR, Brasil (FOR)", "Fortaleza", 109632, "FOR", 258680, "Fortaleza - CearÃ¡ / BR, Brasil (FOR)", "Fortaleza - CearÃ¡ / BR, Brasil (FOR)");
                            break;
                        case "mao-azul":
                            data = _fillLocation("mao", "manaus - amazonas / br, brasil, todos os aeroportos (mao)", "Manaus - Amazonas / BR, Brasil, Todos os Aeroportos (MAO)", "Manaus", 4960, "MAO", 264324, "Manaus - Amazonas / BR, Brasil, Todos os Aeroportos (MAO)", "Manaus - Amazonas / BR, Brasil, Todos os Aeroportos (MAO)");
                            break;
                        case "nat-azul":
                            data = _fillLocation("nat", "natal - rio grande do norte / br, brasil, todos os aeroportos (nat)", "Natal - Rio Grande do Norte / BR, Brasil, Todos os Aeroportos (NAT)", "Natal", 103414, "NAT", 266442, "Natal - Rio Grande do Norte / BR, Brasil, Todos os Aeroportos (NAT)", "Natal - Rio Grande do Norte / BR, Brasil, Todos os Aeroportos (NAT)");
                            break;
                        case "poa-azul":
                            data = _fillLocation("poa", "porto alegre - rio grande do sul / br, brasil, todos os aeroportos (poa)", "Porto Alegre - Rio Grande do Sul / BR, Brasil, Todos os Aeroportos (POA)", "Porto Alegre", 27160, "POA", 270169, "Porto Alegre - Rio Grande do Sul / BR, Brasil, Todos os Aeroportos (POA)", "Porto Alegre - Rio Grande do Sul / BR, Brasil, Todos os Aeroportos (POA)");
                            break;
                        case "rec-azul":
                            data = _fillLocation("rec", "recife - pernambuco / br, brasil, todos os aeroportos (rec)", "Recife - Pernambuco / BR, Brasil, Todos os Aeroportos (REC)", "Recife", 50962, "REC", 271594, "Recife - Pernambuco / BR, Brasil, Todos os Aeroportos (REC)", "Recife - Pernambuco / BR, Brasil, Todos os Aeroportos (REC)");
                            break;
                        case "gig-azul":
                            data = _fillLocation("gig", "galeao - antonio carlos (tom) jobim international airport, brasil (gig)", "Rio de Janeiro - Rio de Janeiro / BR, Brasil, Todos os Aeroportos (RIO)", "GaleÃ£o - AntÃ´nio Carlos (Tom) Jobim International Airport", 24, "GIG", 2701188, "GaleÃ£o - AntÃ´nio Carlos (Tom) Jobim International Airport, Brasil (GIG)", "GaleÃ£o - AntÃ´nio Carlos (Tom) Jobim International Airport, Brasil (GIG)");
                            break;
                        case "ssa-azul":
                            data = _fillLocation("ssa", "salvador - bahia / br, brasil, todos os aeroportos (sa)", "Salvador - Bahia / BR, Brasil, Todos os Aeroportos (SSA)", "Salvador", 82225, "SSA", 273040, "Salvador - Bahia / BR, Brasil, Todos os Aeroportos (SSA)", "Salvador - Bahia / BR, Brasil, Todos os Aeroportos (SSA)");
                            break;
                        case "gru-azul":
                            data = _fillLocation("gru", "guarulos - sao paulo / br, brasil (gru)", "Guarulhos - SÃ£o Paulo / BR, Brasil (GRU)", "Guarulhos", 2771, "GRU", 259839, "Guarulhos - SÃ£o Paulo / BR, Brasil (GRU)", "Guarulhos - SÃ£o Paulo / BR, Brasil (GRU)");
                            break;
                        case "sao-azul":
                            data = _fillLocation("sao", "sao paulo - sao paulo / br, brasil, todos os aeroportos (sao)", "SÃ£o Paulo - SÃ£o Paulo / BR, Brasil, Todos os Aeroportos (SAO)", "SÃ£o Paulo", 63746, "SAO", 275279, "SÃ£o Paulo - SÃ£o Paulo / BR, Brasil, Todos os Aeroportos (SAO)", "SÃ£o Paulo - SÃ£o Paulo / BR, Brasil, Todos os Aeroportos (SAO)");
                            break;
                    }
                }
                return data;
            }

            this.getData = function () {
                var data = component.dropBox("dropBoxGetSelection");

                data = _fillDataAzul(data);

                return data;
            }

            this.setData = function (loc) {
                return component.dropBox("dropBoxSetSelected", loc);
            }

            this.clearSelected = function () {
                component.dropBox("dropBoxClearSelected");
            };

            var _loadLocationByIdRQ = undefined;

            this.setDataById = function (locId) {
                if (locId) {
                    var loc = undefined;

                    if (settings.clientCache && settings.clientCache.length)
                        loc = settings.clientCache.first(function (l) { return l && l.id == locId; });
                    else if (Global && Global.LocationsCache && Global.LocationsCache.length)
                        loc = Global.LocationsCache.first(function (l) { return l && l.id == locId });

                    if (loc)
                        component.dropBox("dropBoxSetSelected", loc);
                    else {

                        var loadByIdUrl = (Global.WebCommonPath || "WebCommon/") + "Handlers/LocationsCache.ashx?" + "culture=" + Global.Culture + "&locId=" + locId;

                        $.getScript(loadByIdUrl, function (resp) {
                            if (resp)
                                new Function(resp)();

                            loc = Global.LocationsCache.first(function (l) { return l && l.id == locId; });
                            if (loc) {
                                component.dropBox("dropBoxSetSelected", loc);
                            }
                        });
                    }
                }
            }

            this.clearSelected = function () {
                component.dropBox("dropBoxClearSelected");
            };

            function _onloadLocationById(res) {
                if (res.req == _loadLocationByIdRQ) {
                    settings.controllers.locationsController.loadLocationByIdCompleted.dettach(_onloadLocationById);

                    component.dropBox("dropBoxSetSelected", res.Locations[0]);
                }
            }
        }

        $.fn.getSelectedLocationName = function (target) {
            var val = $(this).val();

            return (val.indexOf('[') == -1) ? val : val.substring(0, val.indexOf('[') - 1);
        }

        $.fn.getSelectedLocationId = function () {
            return $(this).attr("selectedLocationId");
        }

        $.fn.getSelectedLocationNameProximity = function (target) {
            var val = $(this).val();

            return val.substring(val.indexOf('[') + 1, val.indexOf(' a '));
        }

        $.fn.getSelectedLocationIdProximity = function () {
            return $(this).attr("selectedLocationIdProximity");
        }

        $.fn.locationsFinder = function () {
            return Util.pluginDefaultBehavior(this, "locationsFinder", arguments, function () { return new LocationsFinder() });
        }
    })(jQuery);


ï»¿if (typeof (SearchEngine) == 'undefined')
    SearchEngine = {};

(function ($) {

    if (typeof (SearchEngine.Air) == 'undefined')
        SearchEngine.Air = {};

    var _functions = {
        getCityPairsRequest: function (searchParameters, settings) {

            var cityPairs = [];

            var localCiaCodeList = [];
            var lineContainer = $(this);
            for (var s = 0; s < searchParameters.Destinations.length; s++) {
                var destinationTravel = searchParameters.Destinations[s];

                if (!destinationTravel.NonStop)
                    destinationTravel.NonStop = lineContainer.find(settings.components.air.nonStop).length == 0 ? Util.IsChecked(settings.components.air.nonStop) : lineContainer.find(settings.components.air.nonStop).is(":checked");

                if (settings.components.air.nonStop && settings.components.air.nonStop.length > 0)
                    searchParameters.NonStop = Util.IsChecked(settings.components.air.nonStop.eq(0));
                else
                    searchParameters.NonStop = destinationTravel.NonStop;

                var cityPair = {
                    CiaCodeList: destinationTravel.CiaCodes,
                    NonStop: destinationTravel.NonStop
                }

                var origin = Util.GetShortIATA(destinationTravel.Origin);
                cityPair.Origin = origin == "" ? destinationTravel.Origin : origin;

                var destination = Util.GetShortIATA(destinationTravel.Destination);
                cityPair.Destination = destination == "" ? destinationTravel.Destination : destination;

                if (destinationTravel.OutboundDate) {
                    cityPair.DepartureYear = destinationTravel.OutboundDate.Year;
                    cityPair.DepartureMonth = destinationTravel.OutboundDate.Month;
                    cityPair.DepartureDay = destinationTravel.OutboundDate.Day;
                }

                cityPair.StartTime = Util.GetTreatyTime(destinationTravel.StartTimeOut, "START");
                cityPair.EndTime = Util.GetTreatyTime(destinationTravel.EndTimeOut, "END");

                //Cabin
                if (destinationTravel.CabinFilter != "") {
                    cityPair.CabinFilter = destinationTravel.CabinFilter;
                }

                cityPairs.push(cityPair);
            }

            if (searchParameters.IsRoundTrip) {

                var cityPairRoundTrip = {
                    CiaCodeList: localCiaCodeList,
                    NonStop: searchParameters.NonStop
                }

                if (searchParameters.Destinations[0].Destination) {
                    var origin = Util.GetShortIATA(searchParameters.Destinations[0].Destination);
                    cityPairRoundTrip.Origin = origin == "" ? searchParameters.Destinations[0].Destination : origin;
                }

                if (searchParameters.Destinations[0].Origin) {
                    var destination = Util.GetShortIATA(searchParameters.Destinations[0].Origin);
                    cityPairRoundTrip.Destination = destination == "" ? searchParameters.Destinations[0].Origin : destination;
                }

                if (searchParameters.Destinations[0].InboundDate) {
                    cityPairRoundTrip.DepartureYear = searchParameters.Destinations[0].InboundDate.Year;
                    cityPairRoundTrip.DepartureMonth = searchParameters.Destinations[0].InboundDate.Month;
                    cityPairRoundTrip.DepartureDay = searchParameters.Destinations[0].InboundDate.Day;
                }

                if (searchParameters.Destinations[0].StartTimeIn)
                    cityPairRoundTrip.StartTime = Util.GetTreatyTime(searchParameters.Destinations[0].StartTimeIn, "START");
                if (searchParameters.Destinations[0].EndTimeIn)
                    cityPairRoundTrip.EndTime = Util.GetTreatyTime(searchParameters.Destinations[0].EndTimeIn, "END");

                cityPairRoundTrip.CiaCodeList = searchParameters.Destinations[0].CiaCodes;

                cityPairs.push(cityPairRoundTrip);
            }

            return cityPairs;
        },
        removeExtraDestinationDiv: function (settings) {
            settings.components.air.destinationDiv.remove(".clonedSegment");
            settings.components.air.destinationDiv = $(settings.components.air.destinationDiv);
        },
        hideOrShowInBoundFields: function (action, settings) {
            _functions.validateHideOrShowAction(action);

            //Date
            settings.components.air.inboundDate.val("")[action]();
            settings.components.air.inboundDate.parent()[action]();
            settings.components.air.timeIn[action]();
            //Period
            settings.components.air.periodIn[action]();
            settings.components.air.periodIn.parent()[action]();
        },
        hideOrShowMultiDestinationButtons: function (action, settings) {
            _functions.validateHideOrShowAction(action);

            settings.components.air.addSegment[action]();
            //settings.components.air.removeSegment[action]();
        },
        validateHideOrShowAction: function (action) {
            if (action != "hide" && action != "show")
                return false;

            return true;
        },
        initAirLocations: function (settings) {
            var pesqIncConfig = _functions.setPesqIncConfig(settings);
            if ($.fn.locationsFinder && settings.controllers.locationsController) {
                pesqIncConfig.CurrentProduct = Global.Product.Air;
                pesqIncConfig.IsCity = true;
                pesqIncConfig.HasIata = true;
                settings.components.air.destination.locationsFinder(pesqIncConfig).click(function () { $(this).select(); });

                pesqIncConfig.CurrentProduct = Global.Product.Air;
                pesqIncConfig.IsCity = true;
                pesqIncConfig.HasIata = true;

                settings.components.air.origin.locationsFinder(pesqIncConfig).click(function () { $(this).select(); });
            }
        },
        initAirDatePickers: function (settings, settingsDatePicker) {
            settings.components.air.outboundDate.removeClass(settings.componentsOptions.hasDatepicker).datepicker('destroy').datepicker(DatePickerOption(settingsDatePicker));

            if (settings.events.onOutboundDateBlur)
                settingsDatePicker.onSelect = settings.events.onOutboundDateBlur;

            settingsDatePicker.minDate = settingsDatePicker.minDate.addDays(settings.minPeriodToSearch);

            settingsDatePicker.maxDate = settingsDatePicker.maxDate.addDays(settings.minPeriodToSearch);

            settings.components.air.inboundDate.removeClass(settings.componentsOptions.hasDatepicker).datepicker('destroy').datepicker(DatePickerOption(settingsDatePicker));
        },
        initHotelDatePickers: function (settings, settingsDatePicker) {
            if (settings.calcCheckoutMaxDateFromToday)
                settingsDatePicker.maxDate = settingsDatePicker.maxDate.addDays(-1);
            settings.components.hotel.checkIn.removeClass(settings.componentsOptions.hasDatepicker).datepicker('destroy').datepicker(DatePickerOption(settingsDatePicker));
            settingsDatePicker.minDate = settingsDatePicker.minDate.addDays(1);
            settingsDatePicker.maxDate = settingsDatePicker.maxDate.addDays(1);
            settings.components.hotel.checkOut.removeClass(settings.componentsOptions.hasDatepicker).datepicker('destroy').datepicker(DatePickerOption(settingsDatePicker));
        },
        validateHotelLocation: function (errors, settings) {
            var locationName = settings.components.hotel.location.val();

            if (locationName == "") {
                errors.push("OnSearch_NoCityName");
            } else {
                if (locationName.length < 3) {
                    errors.push("OnSearch_HotelCityNameLengthMoreThan3");
                } else {
                    var location = settings.components.hotel.location.locationsFinder("getData");

                    if (!location)
                        errors.push("OnSearch_InvalidCity");
                }
            }
        },
        validateHotelDates: function (settings) {
            var checkInDate = settings.components.hotel.checkIn.val();
            var checkOutDate = settings.components.hotel.checkOut.val();

            var errorsDate = [];

            if (checkInDate == "")
                errorsDate.push("OnSearch_CheckInDateFormat");
            else if (!checkInDate.isDate())
                errorsDate.push("OnSearch_InvalidCheckInDate");

            if (checkOutDate == "")
                errorsDate.push("OnSearch_CheckOutDateFormat");
            else if (!checkOutDate.isDate())
                errorsDate.push("OnSearch_InvalidCheckOutDate");

            if (errorsDate.length == 0) {
                if (checkInDate == checkOutDate)
                    errorsDate.push("OnSearchAirHotel_ChekinLessEqualsOutboundDate");
                else if (formatter.dateValuesToDate(checkInDate.toDateValues()) > formatter.dateValuesToDate(checkOutDate.toDateValues()))
                    errorsDate.push("OnSearchHotel_CheckoutLessEqualsCheckin");
                else {
                    var minDate = settings.components.hotel.checkIn.datepicker('option', 'minDate');
                    var maxDate = settings.components.hotel.checkOut.datepicker('option', 'maxDate');

                    if (formatter.dateValuesToDate(checkInDate.toDateValues()) < formatter.dateValuesToDate(minDate.toDateValues()))
                        errorsDate.push(["OnSearch_MinHoursHotel", settings.minDaysToSearch * 24]);
                    else if (formatter.dateValuesToDate(checkOutDate.toDateValues()) > formatter.dateValuesToDate(maxDate.toDateValues()))
                        errorsDate.push(["OnSearch_MaxDaysToChekoutDate", settings.maxDaysToSearch]);
                }
            }
            return errorsDate;
        },
        getHotelGuestsQuantities: function (settings, component) {
            var guests = {
                babies: 0,
                adults: 0,
                children: 0
            }, numberOfRooms = parseInt(Util.GetComponentValue(settings.components.hotel.rooms), 10);

            for (var i = 0; i < numberOfRooms; i++) {
                guests.adults += parseInt(Util.GetComponentValue($(settings.components.hotel.guests.adults.selector + i, component)), 10);
                var numberOfChildren = parseInt(Util.GetComponentValue($(settings.components.hotel.guests.childrens.selector + i, component)), 10);
                for (var j = 0; j < numberOfChildren; j++) {
                    var age = parseInt(Util.GetComponentValue($(settings.components.hotel.guests.childrensAge.selector + i.toString() + j.toString(), component)), 10);
                    age > 2 ? guests.children++ : guests.babies++;
                }
            }

            return guests;
        },
        validateHotelGuests: function (errors, settings, component) {
            var hotelGuests = _functions.getHotelGuestsQuantities(settings, component);

            if (hotelGuests.total > settings.maxGuestQuantities)
                errors.push(["OnSearch_NoMoreThanXGuests", settings.maxGuestQuantities]);
            else if (settings.validateNeedMoreAdultsThanInfants && hotelGuests.babies > hotelGuests.adults)
                errors.push(["OnSearch_NeedMoreAdultsThanInfants"]);
        },
        validateMaxSearchDays: function (componentDatePicker, errors, periodToSearch, settings) {
            if (componentDatePicker.datepicker("getDate") && componentDatePicker.datepicker("getDate") > periodToSearch) {
                settings.maxDaysToSearch == 365 ? errors.push("OnSearch_NoMoreThanOneYear") : errors.push(["OnSearch_NoMoreThanXDays", settings.maxDaysToSearch]);
                componentDatePicker.datepicker("setDate", periodToSearch);
            }
        },
        validateInBoundMaxSearchDays: function (componentDatePicker, errors, settings) {
            var periodToSearch;

            if (settings.validateMaxSearchDaysFromCheckinDate) {
                var outBoundComponentDatePicker = settings.components.air.outboundDate;
                var dateValue = outBoundComponentDatePicker.val();
                var date = formatter.dateValuesToDate(dateValue.toDateValues());
                periodToSearch = date.addDays(settings.maxDaysToSearch);
            }
            else
                periodToSearch = new Date().addDays(settings.maxDaysToSearch);


            _functions.validateMaxSearchDays(componentDatePicker, errors, periodToSearch, settings);
        },
        validateOutBoundMaxSearchDays: function (componentDatePicker, errors, settings) {
            var periodToSearch = new Date().addDays(settings.maxDaysToSearch);

            _functions.validateMaxSearchDays(componentDatePicker, errors, periodToSearch, settings);
        },
        applyMinDateRules: function (ctrl, settings) {
            var myDate = ctrl.datepicker("getDate");
            var minDate = ctrl.datepicker("option", "minDate");
            var currentDateValue = ctrl.val().toDateValues();

            if (!myDate)
                myDate = minDate;

            if (myDate < minDate || (currentDateValue.isValid == false && ctrl.val() != "")) {
                ctrl.datepicker('setDate', minDate);

                settings.controllers.messagesController.notifyMessages(["ApplyCorrectDateRule"], settings.exhibitionType);
            }
        },
        applyMaxDateRules: function (ctrl, settings) {
            var myDate = ctrl.datepicker("getDate");
            var minDate = ctrl.datepicker("option", "minDate");
            var maxDate = ctrl.datepicker("option", "maxDate");
            var currentDateValue = ctrl.val().toDateValues();

            if (!myDate)
                myDate = maxDate;

            if (myDate > maxDate || (currentDateValue.isValid == false && ctrl.val() != "")) {
                ctrl.datepicker('setDate', minDate);

                settings.controllers.messagesController.notifyMessages(["ApplyCorrectDateRule"], settings.exhibitionType);
            }
        },
        inboundDateRules: function (settings) {
            if (settings.applycorrectDateRules) {
                _functions.applyMinDateRules(settings.components.air.inboundDate, settings);
                _functions.applyMaxDateRules(settings.components.air.inboundDate, settings);
            }
        },
        outboundDateRules: function (component, settings) {
            if (settings.applycorrectDateRules) {
                _functions.applyMinDateRules(settings.components.air.outboundDate, settings);
                _functions.applyMaxDateRules(settings.components.air.outboundDate, settings);
            }

            var $this = component != undefined && typeof component == 'string' ? $(component) : $(this);

            var myDate = $this.datepicker("getDate") || $this.datepicker("option", "minDate");

            var refToCalcCheckoutMaxDate = settings.calcCheckoutMaxDateFromToday ? (new Date()) : myDate;

            var minDate = $this.datepicker("getDate");

            if (!minDate)
                minDate = $this.datepicker("option", "minDate");

            if (settings.components.air.inboundDate.is(':visible')) {
                var checkoutDaysToAdd = settings.maxDaysToSearch;
                settings.components.air.inboundDate.datepicker("option", "minDate", minDate)
                                                   .datepicker("option", "maxDate", refToCalcCheckoutMaxDate.addDays(checkoutDaysToAdd));
            }

            var filteredOutboundDate = settings.components.air.outboundDate.filter(':visible');

            var parentIndex = filteredOutboundDate.index($this);

            //if (parentIndex + 1 != filteredOutboundDate.length) {
            //    filteredOutboundDate.eq(parentIndex + 1).datepicker("option", "minDate", minDate);
            //    _functions.outboundDateRules(filteredOutboundDate.eq(parentIndex + 1), settings);
            //}
        },
        checkInDateRules: function (settings) {
            if (settings.applycorrectDateRules) {
                _functions.applyMinDateRules(settings.components.hotel.checkIn);
                _functions.applyMaxDateRules(settings.components.hotel.checkIn);
            }
            var checkInDate = settings.components.hotel.checkIn.datepicker("getDate");
            var refToCalcCheckoutMaxDate = settings.calcCheckoutMaxDateFromToday ? (new Date()) : checkInDate;

            if (checkInDate != null) {
                var minDate = checkInDate.addDays(settings.minDaysToSearch);
                var maxDate = refToCalcCheckoutMaxDate.addDays(settings.maxPeriodToSearch);

                settings.components.hotel.checkOut.datepicker("option", "minDate", minDate)
                                              .datepicker("option", "maxDate", maxDate);
            }
        },
        checkOutDateRules: function (settings) {
            if (settings.applycorrectDateRules) {
                _functions.applyMinDateRules(settings.components.hotel.checkOut);
                _functions.applyMaxDateRules(settings.components.hotel.checkOut);
            }
        },
        fillChildrenAge: function (childrenAgeComponent, age) {
            childrenAgeComponent.setSelectedValue(age);
            $('a.current', childrenAgeComponent).click();
        },
        fillHotelRoomsRequest: function (data, settings, component) {
            var isCustomElements = $(settings.components.hotel.guests.adults.selector + '0', component).hasClass('multi_options');

            if (!isCustomElements)
                settings.components.hotel.rooms.val(data.RoomsRequest.length);
            else
                $(settings.components.hotel.rooms.selector, component).setSelectedValue(data.RoomsRequest.length).trigger('change');

            for (var i = 0; i < data.RoomsRequest.length; i++) {

                var room = data.RoomsRequest[i];

                if (!isCustomElements) {
                    $(settings.components.hotel.guests.adults.selector + i).val(room.Adults);
                    $(settings.components.hotel.guests.childrens.selector + i).val(room.ChildAges ? room.ChildAges.length : 0);

                    if (room.ChildAges) {
                        for (var c = 0; c < room.ChildAges.length; c++)
                            $(settings.components.hotel.guests.childrensAge.selector + i + "" + c).val(room.ChildAges[c]);
                    }
                }
                else {
                    $(settings.components.hotel.guests.adults.selector + i, component).setSelectedValue(room.Adults);
                    $(settings.components.hotel.guests.childrens.selector + i, component).setSelectedValue(room.ChildAges.length);
                    if (room.ChildAges.length) {
                        $(settings.components.hotel.guests.childrens.selector + i, component).trigger('change');
                        for (var c = 0, len = room.ChildAges.length; c < len; c++)
                            _functions.fillChildrenAge($(settings.components.hotel.guests.childrensAge.selector + i + "" + c, component), room.ChildAges[c]);
                    }
                }
            }
        },
        setPesqIncConfig: function (settings) {
            return {
                SearchType: Global.SearchTypes.Full,
                maxResultsClient: 15,
                maxResultsServer: 30,
                idealNumberOfProximities: 6,
                idealNumberOfProximitiesRoots: 3,
                useCacheEnhancer: true,
                onlyHalfClientResults: true,
                onDropBoxSelect: function () { },
                clientCache: Global.LocationsCache,
                useScroll: settings.useScrollOnPesqInc,
                applyStatusClasses: settings.applyStatusClassesOnPesqInc,
                applyFixedClass: settings.applyFixedClassOnPesqInc,
                controllers: {
                    locationsController: Global.LocationsController
                }
            }
        },
        getQueryStringDatePattern: function (date) {
            return date.Day + '/' + date.Month + '/' + date.Year;
        },
        getQueryStringAdults: function (roomsRequest) {
            return roomsRequest.select(function (r) { return r.Adults; }).join(",");
        },
        getQueryStringChildren: function (roomsRequest) {
            return roomsRequest.select(function (r) { return r.ChildAges.length; }).join(",");
        },
        getQueryStringChildAges: function (roomsRequest) {
            return roomsRequest.select(function (r) { return r.ChildAges.join(","); }).join(";");
        }
    };

    SearchEngine.Air.readQueryString = function (queryString, settings) {
        var searchParameters = {};

        searchParameters.CompanyId = 0;

        searchParameters.Air = {};

        if (Util.QueryString("SomenteIda", queryString) == undefined)
            searchParameters.Air.IsRoundTrip = (Util.QueryString("RoundTrip", queryString) == 1 || Util.QueryString("RoundTrip", queryString) == "true") ? true : false;
        else
            searchParameters.Air.IsRoundTrip = (Util.QueryString("SomenteIda", queryString) == 1 || Util.QueryString("SomenteIda", queryString) == "true") ? false : true;
        searchParameters.Air.MultiDestination = false;
        searchParameters.Air.Destinations = [];
        var destinationToPush = {};
        var origin = "";
        var destination = "";

        origin = Util.QueryString("Origem", queryString).replaceAll("%20", " ").replaceAll("---", ")").replaceAll("--", "(");
        destinationToPush.Origin = origin;

        destination = Util.QueryString("Destino", queryString).replaceAll("%20", " ").replaceAll("---", ")").replaceAll("--", "(");
        destinationToPush.Destination = destination;

        if (Global.LocationsCache && Global.LocationsCache.length > 0) {
            var auxOriginData = Global.LocationsCache.where(function (loc) { return loc.i == origin });

            if (auxOriginData.length > 0)
                destinationToPush.OriginData = auxOriginData[0];

            var auxDestinationData = Global.LocationsCache.where(function (loc) { return loc.i == destination });

            if (auxDestinationData.length > 0)
                destinationToPush.DestinationData = auxDestinationData[0];
        } else {
            destinationToPush.OriginData = origin;
            destinationToPush.DestinationData = destination;
        }

        if (destinationToPush.Origin.length == 3)
            destinationToPush.Origin = destinationToPush.Origin.toUpperCase();

        if (destinationToPush.Destination.length == 3)
            destinationToPush.Destination = destinationToPush.Destination.toUpperCase();

        var outboundDate = Util.QueryString("Data", queryString, 0) != undefined ? Util.QueryString("Data", queryString, 0) : Util.QueryString("DataIda", queryString);

        destinationToPush.OutboundDate = outboundDate.toDateValues();

        var inboundDate = Util.QueryString("Data", queryString, 1) != undefined ? Util.QueryString("Data", queryString, 1) : Util.QueryString("DataVolta", queryString);
        if (inboundDate != undefined)
            destinationToPush.InboundDate = inboundDate.toDateValues();

        destinationToPush.NonStop = (Util.QueryString("SomenteDireto", queryString) == "true" ? true : false);

        destinationToPush.StartTimeOut = Util.QueryString("Hora", queryString, 0) != "" ? Util.QueryString("Hora", queryString, 0) : undefined;
        destinationToPush.EndTimeOut = Util.QueryString("Hora", queryString, 0) != "" ? Util.QueryString("Hora", queryString, 0) : undefined;

        destinationToPush.StartTimeIn = Util.QueryString("Hora", queryString, 1) != "" ? Util.QueryString("Hora", queryString, 1) : undefined;
        destinationToPush.EndTimeIn = Util.QueryString("Hora", queryString, 1) != "" ? Util.QueryString("Hora", queryString, 1) : undefined;

        destinationToPush.CiaCodes = [];
        if (Util.QueryString("Cia", queryString) != undefined || Util.QueryString("Cia", queryString) != "") {

            var ciaCode = Util.QueryString("Cia", queryString);
            if (ciaCode != "" && ciaCode != undefined) {
                if (ciaCode.indexOf(",") >= 0)
                    destinationToPush.CiaCodes = ciaCode.split(",");
                else
                    destinationToPush.CiaCodes.push(ciaCode);
            }
        }

        searchParameters.Air.Adults = 0;
        searchParameters.Air.Children = 0;
        searchParameters.Air.Babies = 0;

        searchParameters.Air.Adults = parseInt(Util.QueryString("NumADT", queryString));
        searchParameters.Air.Children = parseInt(Util.QueryString("NumCHD", queryString));
        searchParameters.Air.Babies = parseInt(Util.QueryString("NumINF", queryString));

        if (Util.QueryString("Cabine", queryString) != undefined || Util.QueryString("Cabine", queryString) != "")
            searchParameters.Air.CabinType = Util.QueryString("Cabine", queryString);

        if (settings.components.air.searchType.length != 0)
            searchParameters.Air.SearchType = settings.components.air.searchType.val();
        else
            searchParameters.Air.SearchType = settings.searchType;

        searchParameters.Air.Destinations.push(destinationToPush);

        SearchEngine.Air.getRequestData(searchParameters, settings);

        return searchParameters;
    };

    SearchEngine.Air.getData = function (settings) {
        var searchParameters = {};

        searchParameters.CompanyId = 0;

        searchParameters.Air = {};

        if (settings.components.air.roundTrip.length)
            searchParameters.Air.IsRoundTrip = settings.components.air.roundTrip.is(":ischecked");
        else
            searchParameters.Air.IsRoundTrip = settings.components.air.inboundDate && settings.components.air.inboundDate.val() && !settings.components.air.inboundDate.val().isEmpty();

        searchParameters.Air.MultiDestination = settings.components.air.multiDestination.is(":ischecked");

        searchParameters.Air.IsOneWay = settings.components.air.oneWay.is("ischecked") || settings.components.air.oneWay.hasClass(settings.componentsOptions.customCheckedClass);

        var origin = "";
        var destination = "";
        searchParameters.Air.Destinations = [];
        var citiPairItens = settings.components.air.destinationDiv;
        isInternationalAirSearch = false;
        citiPairItens.each(function () {
            var currentCityPair = $(this);
            var destinationTravel = {};

            if ($.fn.locationsFinder) {
                origin = currentCityPair.find(settings.components.air.origin).locationsFinder("getData");
                destinationTravel.Origin = origin && origin.i ? origin.i : currentCityPair.find(settings.components.air.origin).val();

                if (origin && origin["in"]) isInternationalAirSearch = true;
                destination = currentCityPair.find(settings.components.air.destination).locationsFinder("getData");
                destinationTravel.Destination = destination && destination.i ? destination.i : currentCityPair.find(settings.components.air.destination).val();
                if (destination && destination["in"]) isInternationalAirSearch = true;
            }
            else {
                origin = currentCityPair.find(settings.components.air.origin).val();
                destinationTravel.Origin = origin;

                destination = currentCityPair.find(settings.components.air.destination).val();
                destinationTravel.Destination = destination;
            }

            destinationTravel.OriginData = origin;
            destinationTravel.DestinationData = destination;

            if (destinationTravel.Origin.length == 3)
                destinationTravel.Origin = destinationTravel.Origin.toUpperCase();

            if (destinationTravel.Destination.length == 3)
                destinationTravel.Destination = destinationTravel.Destination.toUpperCase();

            var outboundDate = currentCityPair.find(settings.components.air.outboundDate, currentCityPair).val();
            if (outboundDate)
                destinationTravel.OutboundDate = outboundDate.toDateValues();

            var inboundDate = currentCityPair.find(settings.components.air.inboundDate, currentCityPair).val();
            if (inboundDate)
                destinationTravel.InboundDate = inboundDate.toDateValues();

            destinationTravel.NonStop = currentCityPair.find(settings.components.air.nonStop).length == 0 ? Util.IsChecked(settings.components.air.nonStop) : currentCityPair.find(settings.components.air.nonStop).is(":checked");

            //Periodo selecionado
            var periodInboundComponent = currentCityPair.find(settings.components.air.inboundPeriod);
            var periodOutboundComponent = currentCityPair.find(settings.components.air.outboundPeriod);
            var periodInbound = periodInboundComponent.getPeriod();
            var periodOutbound = periodOutboundComponent.getPeriod();
            destinationTravel.StartTimeIn = periodInbound.StartTime;
            destinationTravel.EndTimeIn = periodInbound.EndTime;
            destinationTravel.StartTimeOut = periodOutbound.StartTime;
            destinationTravel.EndTimeOut = periodOutbound.EndTime;


            destinationTravel.CiaCodes = [];
            if (settings.components.air.ciaCode) {
                var ciaCode;
                var ciaCodeComponentValue;
                //if (settings.components.air.ciaCode.length)
                //ciaCode = Util.GetComponentValue(settings.components.air.ciaCode);
                //else
                //ciaCode = currentCityPair.find(settings.components.air.ciaCode).val();
                if (searchParameters.Air.MultiDestination) {
                    ciaCodeComponentValue = Util.GetComponentValue(currentCityPair.find(settings.components.air.ciaCode));
                }
                else {
                    ciaCodeComponentValue = Util.GetComponentValue(settings.components.air.ciaCode);
                }

                if (ciaCodeComponentValue != "") {
                    ciaCode = ciaCodeComponentValue;
                }

                if (ciaCode && ciaCode != "") {
                    if (ciaCode.indexOf(",") >= 0)
                        destinationTravel.CiaCodes = ciaCode.split(",");
                    else
                        destinationTravel.CiaCodes.push(ciaCode);
                }
            }

            if (settings.components.air.pricingTradeType)
                destinationTravel.PricingTradeType = currentCityPair.find(settings.components.air.pricingTradeType).eq(0).val();

            //Cabin
            destinationTravel.CabinFilter = Util.GetComponentValue(currentCityPair.find(settings.components.air.cabinType));

            searchParameters.Air.Destinations.push(destinationTravel);
        });

        searchParameters.Air.Adults = 0;
        searchParameters.Air.Children = 0;
        searchParameters.Air.Babies = 0;

        searchParameters.Air.Adults = parseInt(Util.GetComponentValue(settings.components.air.adults));
        searchParameters.Air.Children = parseInt(Util.GetComponentValue(settings.components.air.children));
        searchParameters.Air.Babies = parseInt(Util.GetComponentValue(settings.components.air.babies));

        if (settings.components.air.nonStop && settings.components.air.nonStop.length > 0)
            searchParameters.Air.NonStop = Util.IsChecked(settings.components.air.nonStop.eq(0));

        if (settings.components.air.cabinType)
            searchParameters.Air.CabinType = settings.components.air.cabinType.val();

        if (settings.components.air.searchType.length != 0)
            searchParameters.Air.SearchType = settings.components.air.searchType.val();
        else
            searchParameters.Air.SearchType = settings.searchType;

        if (searchParameters.Air.SearchType == 0 && isInternationalAirSearch) {
            searchParameters.Air.SearchType = 3;
            var func = function () { alert(Util.GetInterfaceMessage("InternationalSearch")); };
            setTimeout(func, 500);
        }

        searchParameters.Air.isInternationalAirSearch = isInternationalAirSearch;

        searchParameters.SearchForPackageComposition = Util.IsChecked(settings.components.air.searchForPackageComposition);

        SearchEngine.Air.getRequestData(searchParameters, settings);

        return searchParameters;
    };

    SearchEngine.Air.getRequestData = function (searchParameters, settings) {
        if (searchParameters && searchParameters.Air) {
            searchParameters.Air.RequestData = {};
            searchParameters.Air.RequestData.CityPairsRequest = _functions.getCityPairsRequest(searchParameters.Air, settings);

            if (isNaN(searchParameters.Air.Adults))
                searchParameters.Air.RequestData.NumberADTs = 1;
            else
                searchParameters.Air.RequestData.NumberADTs = searchParameters.Air.Adults;

            if (isNaN(searchParameters.Air.Children))
                searchParameters.Air.RequestData.NumberCHDs = 0;
            else
                searchParameters.Air.RequestData.NumberCHDs = searchParameters.Air.Children;

            if (isNaN(searchParameters.Air.Babies))
                searchParameters.Air.RequestData.NumberINFs = 0;
            else
                searchParameters.Air.RequestData.NumberINFs = searchParameters.Air.Babies;

            searchParameters.Air.RequestData.BestCombinationWithSwitchAirport = searchParameters.Air.BestCombinationWithSwitchAirport;
            //searchParameters.Air.RequestData.CabinFilter = parseFloat(searchParameters.Air.CabinType);
            searchParameters.Air.RequestData.TradeType = parseFloat(searchParameters.Air.PricingTradeType);
        }
    };

    SearchEngine.Air.searchRules = function (settings) {
        var isOneWay = settings.components.air.oneWay.is(":ischecked");
        var isRoundTrip = settings.components.air.roundTrip.is(":ischecked");
        var isMultiDestination = !isOneWay && !isRoundTrip ? true : false;

        _functions.removeExtraDestinationDiv(settings);
        _functions.hideOrShowMultiDestinationButtons("hide", settings);

        if (isOneWay) {
            _functions.hideOrShowInBoundFields("hide", settings);
            settings.components.air.destinationContainer.removeClass(settings.componentsOptions.air.destinationContainerRemoveClassOneWay);
            settings.components.air.destinationContainer.addClass(settings.componentsOptions.air.destinationContainerAddClassOneWay);
        }
        else if (isRoundTrip) {
            _functions.hideOrShowInBoundFields("show", settings);
            settings.components.air.destinationContainer.removeClass(settings.componentsOptions.air.destinationContainerRemoveClassRoundTrip);
            settings.components.air.destinationContainer.addClass(settings.componentsOptions.air.destinationContainerAddClassRoundTrip);
        }
        else if (isMultiDestination) {
            settings.components.air.destinationContainer.removeClass(settings.componentsOptions.air.destinationContainerRemoveClassMultiDestination);
            settings.components.air.destinationContainer.addClass(settings.componentsOptions.air.destinationContainerAddClassMultiDestination);
            _functions.hideOrShowInBoundFields("hide", settings);
            _functions.hideOrShowMultiDestinationButtons("show", settings);
        }
    };

    SearchEngine.Air.getQueryStringAirDestination = function (data, settings) {

        var querystring = "";

        if (data.Air.Destinations) {
            for (var i = 0; i < data.Air.Destinations.length; i++) {
                querystring = querystring + "&Origem=" + data.Air.Destinations[i].Origin.removeDiacritics().replaceAll(" ", "%20").replaceAll("(", "%28").replaceAll(")", "%29");
                querystring = querystring + "&Destino=" + data.Air.Destinations[i].Destination.removeDiacritics().replaceAll(" ", "%20").replaceAll("(", "%28").replaceAll(")", "%29");

                if (data.Air.IsRoundTrip) {
                    querystring = querystring + "&Origem=" + data.Air.Destinations[i].Destination.removeDiacritics();
                    querystring = querystring + "&Destino=" + data.Air.Destinations[i].Origin.removeDiacritics();
                }

                var proximityId = settings.components.air.destination.getSelectedLocationIdProximity();
                var proximityName = settings.components.air.destination.getSelectedLocationNameProximity().removeDiacritics();

                querystring = querystring + "&Proximity=" + proximityName
                querystring = querystring + "&ProximityId=" + (proximityName ? proximityName : 0);
                querystring = querystring + "&Data=" + _functions.getQueryStringDatePattern(data.Air.Destinations[i].OutboundDate);
                querystring += "&RoundTrip=" + (data.Air.IsRoundTrip == true ? "1" : "0");

                if (data.Air.Destinations[i].InboundDate)
                    querystring = querystring + "&Data=" + _functions.getQueryStringDatePattern(data.Air.Destinations[i].InboundDate);

                if (data.Air.Destinations[i].CiaCodes.length > 0) {
                    var ciaQueryString = "&Cia=";
                    var sep = "";
                    for (var j = 0; j < data.Air.Destinations[i].CiaCodes.length; j++) {
                        ciaQueryString = ciaQueryString + sep + data.Air.Destinations[i].CiaCodes[j];
                        sep = ",";
                    }
                    querystring = querystring + ciaQueryString;
                }

                querystring = querystring + "&SomenteDireto=" + data.Air.Destinations[i].NonStop;
            }
        }

        return querystring;
    };

    SearchEngine.Air.Validate = function (settings) {
        var errors = [];

        settings.components.air.destinationDiv.each(function () {
            var thisDestination = $(this);

            var originComponent = thisDestination.find(settings.components.air.origin);

            if (originComponent.val() == "")
                errors.push("OnSearch_NoOrigin");
            else if (originComponent.locationsFinder("getData") == undefined)
                errors.push("OnSearch_InvalidOrigin");

            var destinationComponent = thisDestination.find(settings.components.air.destination);

            if (destinationComponent.val() == "")
                errors.push("OnSearch_NoDestin");
            else if (originComponent.val() == destinationComponent.val())
                errors.push("OnSearch_OriginEqualsDestin");
            else if (destinationComponent.locationsFinder("getData") == undefined)
                errors.push("OnSearch_InvalidDestination");

            var minDate = new Date().addDays(settings.minDaysToSearch - 1);
            var maxDate = new Date();

            var outboundDateComponent = thisDestination.find(settings.components.air.outboundDate);

            if (outboundDateComponent.val() == "")
                errors.push("OnSearch_NoOutboundDate");
            else if (!outboundDateComponent.val().isDate())
                errors.push("OnSearch_InvalidOutboundDate");
            else if (settings.anotheDatePickersOption.minDate != undefined) {
                var MinDate = new Date().addDays(settings.anotheDatePickersOption.minDate);

                if (outboundDateComponent.val() < minDate)
                    errors.push(["OnSearch_MinHoursHotel", settings.anotheDatePickersOption.minDate * 24]);
            }

            if (outboundDateComponent.val().length) {
                var outboundDate = formatter.dateValuesToDate(outboundDateComponent.val().toDateValues());

                if (outboundDate < minDate) {
                    if (settings.minDaysToSearch > 0)
                        errors.push(["OnSearch_MinHours", settings.minDaysToSearch * 24]);
                    else
                        errors.push("OnSearch_OutboundLessThanCurrentDate");
                }

                var refToCalcCheckoutMaxDate = settings.calcCheckoutMaxDateFromToday ? (new Date()) : outboundDate;
                maxDate = refToCalcCheckoutMaxDate.addDays(settings.maxDaysToSearchHotels);
            }

            if (settings.components.air.roundTrip.is(':ischecked') || settings.components.air.inboundDate && settings.components.air.inboundDate.val() && !settings.components.air.inboundDate.val().isEmpty()) {
                if (settings.components.air.inboundDate.val() == "") {
                    errors.push("OnSearch_NoInboundDate");
                }
                else if (!settings.components.air.inboundDate.val().isDate())
                    errors.push("OnSearch_InvalidInboundDate");
            }
        });

        _functions.validateOutBoundMaxSearchDays(settings.components.air.outboundDate, errors, settings);

        if (settings.components.air.multiDestination.is(':ischecked')) {
            var lastDate = new Date();
            var noErrors = true;

            settings.components.air.destinationDiv.each(function () {
                var thisDestination = $(this);
                if (lastDate > thisDestination.find(settings.components.air.outboundDate).val().toDateTime() && noErrors) {
                    errors.push("OnSearch_OutboundDateOutOrder");
                    noErrors = false;
                }
                lastDate = settings.components.air.outboundDate.val().toDateTime();
            });
        }

        if (Util.IsChecked(settings.components.air.roundTrip) || (settings.components.air.inboundDate && settings.components.air.inboundDate.val() && !settings.components.air.inboundDate.val().isEmpty())) {

            if (settings.components.air.outboundDate.val() != "" && settings.components.air.inboundDate.val() != "" && settings.components.air.outboundDate.datepicker("getDate") > settings.components.air.inboundDate.datepicker("getDate")) {
                settings.components.air.inboundDate.val(settings.components.air.outboundDate.val());
                errors.push("OnSearch_OutboundLessThanInboundDate");
            }

            if (settings.components.air.timeOut.val() != "" && settings.components.air.timeIn.val() != "") {
                if (settings.components.air.outboundDate.val() == settings.components.air.inboundDate.val()
                && parseInt(settings.components.air.timeOut.val()) > parseInt(settings.components.air.timeIn.val())) {
                    errors.push("OnSearch_CurrentDateTimeInLessThanTimeOut");
                }
            }

            if (settings.components.air.outboundDate.val() != "") {

                var outboundDate = settings.components.air.outboundDate.datepicker("getDate");

                outboundDate = new Date(outboundDate.getTime() + (1000 * 60 * 60 * 23 + (1000 * 60 * 59)));

                if (outboundDate <= (new Date())) {
                    errors.push("OnSearch_OutboundLessThanCurrentDate");
                    settings.components.air.outboundDate.datepicker("setDate", (new Date()));
                }

                _functions.validateInBoundMaxSearchDays(settings.components.air.inboundDate, errors, settings);
            }
        }

        if (settings.components.air.outboundDate.val() != "") {

            var outboundDate = settings.components.air.outboundDate.datepicker("getDate");

            outboundDate = new Date(outboundDate.getTime() + (1000 * 60 * 60 * 23 + (1000 * 60 * 59)));

            if (outboundDate <= (new Date())) {
                errors.push("OnSearch_OutboundLessThanCurrentDate");
                settings.components.air.outboundDate.datepicker("setDate", (new Date()));
            }
        }

        if ((parseInt(Util.GetComponentValue(settings.components.air.adults)) + parseInt(Util.GetComponentValue(settings.components.air.children)) + parseInt(Util.GetComponentValue(settings.components.air.babies))) > 9) {
            errors.push("OnSearch_NoMoreThanNinePassengers");
            settings.components.air.adults.val(1);
            settings.components.air.children.val(0);
            settings.components.air.babies.val(0);
        }

        if ((parseInt(Util.GetComponentValue(settings.components.air.children)) + parseInt(Util.GetComponentValue(settings.components.air.babies))) > settings.maxChildren && settings.maxChildren > 0) {
            errors.push("OnSearch_NoMoreChildren");
        }

        if (parseInt(Util.GetComponentValue(settings.components.air.adults)) < parseInt(Util.GetComponentValue(settings.components.air.babies))) {
            errors.push("OnSearch_NeedMoreAdultsThanInfants");
            settings.components.air.babies.val(parseInt(Util.GetComponentValue(settings.components.air.adults)));
        }

        if (parseInt(Util.GetComponentValue(settings.components.air.adults)) == 0 && parseInt(Util.GetComponentValue(settings.components.air.children)) == 0) {
            errors.push("OnSearch_NeedPassenger");
        }

        SharedFunctions.ValidateContext(errors);

        return errors;
    };

    SearchEngine.Air.fillValues = function (data, settings, component) {

        if (data && !$.isEmptyObject(data)) {

            var hotelLocationData = undefined, hotelCheckinData = undefined, hotelCheckOutData = undefined;
            var passengers = {
                Adults: parseInt(data.Air.Adults) || 0,
                Children: parseInt(data.Air.Children) || 0,
                Babies: parseInt(data.Air.Babies) || 0
            };

            if (data.Hotel) {
                if (data.Hotel.LocationData)
                    hotelLocationData = data.Hotel.LocationData;
                if (data.Hotel.CheckIn && data.Hotel.CheckIn.isValid)
                    hotelCheckinData = data.Hotel.CheckIn;
                if (data.Hotel.CheckOut && data.Hotel.CheckOut.isValid)
                    hotelCheckOutData = data.Hotel.CheckOut;
                if (data.Hotel.RoomsRequest.length) {
                    passengers.Adults = 0;
                    passengers.Children = 0;
                    passengers.Babies = 0;
                    for (var i = 0, len = data.Hotel.RoomsRequest.length; i < len; i++) {
                        passengers.Adults += parseInt(data.Hotel.RoomsRequest[i].Adults);
                        for (var j = 0, limit = data.Hotel.RoomsRequest[i].ChildAges.length; j < limit; j++) {
                            if (parseInt(data.Hotel.RoomsRequest[i].ChildAges[j]) < 2)
                                passengers.Babies += 1;
                            else
                                passengers.Children += 1;
                        }

                    }
                }
            }

            if (passengers.Adults > settings.maxGuestQuantities)
                passengers.Adults = settings.maxGuestQuantities
            if (passengers.Children > settings.maxChildren)
                passengers.Children = settings.maxChildren
            if (passengers.Babies > passengers.Adults)
                passengers.Babies = passengers.Adults;
            if (settings.maxBabies && passengers.Babies > settings.maxBabies)
                passengers.Babies = settings.maxBabies;

            if (data.Air)
                data = data.Air;

            //BUG 2101 - IE7 
            if (data.IsRoundTrip)
                settings.components.air.roundTrip.check();
            else if (data.Destinations && data.Destinations.length == 1 && settings.type == "Air")
                settings.components.air.oneWay.check();
            else
                settings.components.air.multiDestination.check();

            SearchEngine.Air.searchRules(settings);

            if (data.Destinations) {
                if (data.Destinations[0].OriginData) {
                    settings.components.air.origin.locationsFinder("setData", data.Destinations[0].OriginData);
                }
                else {
                    var origin = data.Destinations[0].Origin;

                    if (origin && origin.length == 3) {
                        var location = Global.LocationsCache.first(function (h) { return h.i == origin; });

                        if (location) {
                            settings.components.air.origin.locationsFinder("setData", location);
                        }
                        else {
                            var loadByIataUrl = Global.WebCommonPath + "Handlers/LocationsCache.ashx?" + "culture=" + Global.Culture + "&iata=" + origin;

                            $.getScript(loadByIataUrl, function (resp) {
                                if (resp) {
                                    (new Function(resp))();

                                    loc = Global.LocationsCache.first(function (l) { return l && l.i == origin });

                                    if (loc) {
                                        settings.components.air.origin.locationsFinder("setData", loc);
                                    }
                                }
                            });
                        }
                    }
                    else {
                        settings.components.air.origin.val(origin);
                    }
                }

                if (data.Destinations[0].DestinationData) {
                    settings.components.air.destination.locationsFinder("setData", data.Destinations[0].DestinationData);
                }
                else {

                    var destination = data.Destinations[0].Destination;

                    if (destination && destination.length == 3) {
                        var location = Global.LocationsCache.first(function (h) { return h.i == destination; });

                        if (location) {
                            settings.components.air.origin.locationsFinder("setData", location);
                        }
                        else {
                            var loadByIataUrl = Global.WebCommonPath + "Handlers/LocationsCache.ashx?" + "culture=" + Global.Culture + "&iata=" + destination;

                            $.getScript(loadByIataUrl, function (resp) {
                                if (resp) {
                                    (new Function(resp))();

                                    loc = Global.LocationsCache.first(function (l) { return l && l.i == destination });

                                    if (loc) {
                                        settings.components.air.destination.locationsFinder("setData", loc);
                                    }
                                }
                            });
                        }
                    }
                    else {
                        settings.components.air.destination.val(destination);
                    }
                }

                if (hotelLocationData)
                    settings.components.hotel.location.locationsFinder("setData", hotelLocationData);

                if (data.Destinations[0].OutboundDate) {
                    settings.components.air.outboundDate
                        .datepicker("setDate", formatter.dateValuesToDate(data.Destinations[0].OutboundDate))
                        .val(formatter.dateValuesShort(data.Destinations[0].OutboundDate));

                    if (settings.validateAirRulesOnChange)
                        _functions.outboundDateRules(settings.components.air.outboundDate.selector, settings);
                }

                if (data.Destinations[0].InboundDate) {
                    settings.components.air.inboundDate
                        .datepicker("setDate", formatter.dateValuesToDate(data.Destinations[0].InboundDate))
                        .val(formatter.dateValuesShort(data.Destinations[0].InboundDate));

                    if (settings.validateAirRulesOnChange)
                        _functions.inboundDateRules(settings.components.air.inboundDate.selector);
                }

                if (hotelCheckinData) {
                    settings.components.hotel.checkIn
                        .datepicker("setDate", formatter.dateValuesToDate(hotelCheckinData))
                        .val(formatter.dateValuesShort(hotelCheckinData));

                    if (settings.validateAirRulesOnChange)
                        _functions.outboundDateRules(settings.components.hotel.checkIn.selector, settings);
                }

                if (hotelCheckOutData) {
                    settings.components.hotel.checkOut
                        .datepicker("setDate", formatter.dateValuesToDate(hotelCheckOutData))
                        .val(formatter.dateValuesShort(hotelCheckOutData));

                    if (settings.validateAirRulesOnChange)
                        _functions.inboundDateRules(settings.components.hotel.checkOut.selector);
                }

                $(settings.components.air.nonStop.selector, component).setCheck(data.Destinations[0].NonStop);

                if (data.Destinations[0].StartTimeOut && data.Destinations[0].StartTimeOut != "")
                    settings.components.air.timeOut.val(data.Destinations[0].StartTimeOut);

                if (data.Destinations[0].StartTimeIn && data.Destinations[0].StartTimeIn != "")
                    settings.components.air.timeIn.val(data.Destinations[0].StartTimeIn);
            }

            if (!settings.components.air.adults.hasClass("multi_options")) {
                settings.components.air.adults.val(data.Adults);
                settings.components.air.children.val(data.Children);
                settings.components.air.babies.val(data.Babies);
            }
            else {
                settings.components.air.adults.setSelectedValue(passengers.Adults);
                settings.components.air.children.setSelectedValue(passengers.Children);
                settings.components.air.babies.setSelectedValue(passengers.Babies);
            }

            settings.components.air.cabinType.val(data.CabinType);
            settings.components.air.pricingTradeType.val(data.PricingTradeType);

            if (data.Destinations && data.Destinations.length && data.Destinations[0].CiaCodes && data.Destinations[0].CiaCodes.length) {
                var ciaCodes = undefined;

                if (data.Destinations[0].CiaCodes.length == 1)
                    ciaCodes = data.Destinations[0].CiaCodes[0];
                else if (data.Destinations[0].CiaCodes.length == 2)
                    ciaCodes = data.Destinations[0].CiaCodes[0] + ',' + data.Destinations[0].CiaCodes[1];

                if (!settings.components.air.ciaCode.hasClass('multi_options'))
                    settings.components.air.ciaCode.val(ciaCodes);
                else
                    settings.components.air.ciaCode.setSelectedValue(ciaCodes);
            }
        }
    };

    SearchEngine.Air.init = function (settings, settingsDatePicker, toHotel) {
        var settingsDatePicker = undefined;

        var currentDate = Util.CreateAbsoluteDate();

        if (typeof settings.anotheDatePickersOption.minDate != 'undefined') {
            settingsDatePicker = {
                minDate: currentDate.addDays(parseInt(settings.minDaysToSearch, 10)),
                maxDate: currentDate.addDays(parseInt(settings.maxDaysToSearch, 10))
            };
        }
        else
            settingsDatePicker = {
                maxDate: currentDate.addDays(parseInt(settings.maxDaysToSearch, 10))
            };

        _functions.initAirDatePickers(settings, settingsDatePicker);
        _functions.initAirLocations(settings);

        if (settings.events.afterInitialize)
            settings.events.afterInitialize(settings);
    };

    SearchEngine.Hotel.readQueryString = function (queryString, settings) {

        var searchParameters = {};

        searchParameters.Hotel = {};

        var numberOfRooms = Util.QueryString("Rooms", queryString);
        searchParameters.Hotel.RoomsRequest = [];

        for (var i = 0; i < numberOfRooms; i++) {
            var ChildrenByRoom = [];

            var numberOfChildren = Util.QueryString("Children", queryString).split(",")[i];
            var ChildrenAgesByRoom = Util.QueryString("ChildAges", queryString).split(";");

            for (var j = 0; j < numberOfChildren; j++)
                ChildrenByRoom.push(ChildrenAgesByRoom[i].split(",")[j].replaceAll("%3C1", "0").replaceAll("<1", "0"));

            var numberOfAdults = Util.QueryString("Adults", queryString).split(",")[i];
            searchParameters.Hotel.RoomsRequest.push({ Adults: numberOfAdults, ChildAges: ChildrenByRoom });
        }

        searchParameters.Hotel.CheckIn = Util.QueryString("CheckIn", queryString).toDateValues();
        searchParameters.Hotel.CheckOut = Util.QueryString("CheckOut", queryString).toDateValues();

        var location = Util.QueryString("Location", queryString).replaceAll("%20", " ").replaceAll("---", ")").replaceAll("--", "(");
        var destination = location;

        searchParameters.Hotel.LocationId = Util.QueryString("LocationId", queryString);

        if (Global.LocationsCache && Global.LocationsCache.length > 0) {
            var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.d == $.trim(destination) });

            if (auxLocationData.length > 0)
                searchParameters.Hotel.LocationData = auxLocationData[0];
        }
        else {
            searchParameters.Hotel.LocationData = destination;
        }

        searchParameters.Hotel.Location = location;

        if (searchParameters.Hotel.Location.length == 3)
            searchParameters.Hotel.Location = searchParameters.Hotel.Location.toUpperCase();

        SearchEngine.Hotel.getRequestData(searchParameters);

        return searchParameters;
    };

    SearchEngine.Hotel.getData = function (settings, component) {
        var searchParameters = {};

        searchParameters.CompanyId = 0;

        searchParameters.Hotel = {};

        var numberOfRooms = Util.GetComponentValue(settings.components.hotel.rooms);
        searchParameters.Hotel.RoomsRequest = [];

        for (var i = 0; i < numberOfRooms; i++) {
            var ChildrenByRoom = [];

            var numberOfChildren = Util.GetComponentValue($(settings.components.hotel.guests.childrens.selector + i, component));
            for (var j = 0; j < numberOfChildren; j++)
                ChildrenByRoom.push(Util.GetComponentValue($(settings.components.hotel.guests.childrensAge.selector + i.toString() + j.toString(), component)));

            var numberOfAdultsAux = Util.GetComponentValue($(settings.components.hotel.guests.adults.selector + i, component));
            var numberOfAdults = numberOfAdultsAux.length ? numberOfAdultsAux[0] : numberOfAdultsAux;

            searchParameters.Hotel.RoomsRequest.push({ Adults: numberOfAdults, ChildAges: ChildrenByRoom });
        }

        if (settings.components.hotel.checkIn.length && settings.components.hotel.checkIn.val() != "")
            searchParameters.Hotel.CheckIn = settings.components.hotel.checkIn.val().toDateValues();

        if (settings.components.hotel.checkOut.length && settings.components.hotel.checkOut.val() != "")
            searchParameters.Hotel.CheckOut = settings.components.hotel.checkOut.val().toDateValues();

        var destination = settings.components.hotel.location.locationsFinder("getData");
        searchParameters.Hotel.LocationId = destination ? destination.id : 0;
        searchParameters.Hotel.LocationData = destination;

        searchParameters.Hotel.Location = settings.components.hotel.location.length ? settings.components.hotel.location.val() : '';

        if (searchParameters.Hotel.Location.length == 3)
            searchParameters.Hotel.Location = searchParameters.Hotel.Location.toUpperCase();

        searchParameters.Hotel.ChainCode = settings.components.hotel.chainCode.val();
        searchParameters.Hotel.Name = settings.components.hotel.name.val();
        searchParameters.Hotel.Sources = [];

        searchParameters.SearchForPackageComposition = Util.IsChecked(settings.components.hotel.searchForPackageComposition);

        SearchEngine.Hotel.getRequestData(searchParameters);

        return searchParameters;
    };

    SearchEngine.Hotel.getRequestData = function (searchParameters) {
        if (searchParameters && searchParameters.Hotel) {
            searchParameters.Hotel.RequestData = {};
            searchParameters.Hotel.RequestData.HotelName = searchParameters.Hotel.Name;
            searchParameters.Hotel.RequestData.ChainCode = searchParameters.Hotel.ChainCode;
            searchParameters.Hotel.RequestData.LocationId = searchParameters.Hotel.LocationId;
            searchParameters.Hotel.RequestData.Location = searchParameters.Hotel.Location;
            searchParameters.Hotel.RequestData.CheckIn = searchParameters.Hotel.CheckIn;
            searchParameters.Hotel.RequestData.CheckOut = searchParameters.Hotel.CheckOut;
            searchParameters.Hotel.RequestData.RoomsRequest = searchParameters.Hotel.RoomsRequest;
            searchParameters.Hotel.RequestData.HotelId = searchParameters.Hotel.HotelId;
            searchParameters.Hotel.RequestData.Source = searchParameters.Hotel.Source;

            if (searchParameters.Hotel.AnotherDate != undefined)
                searchParameters.Hotel.RequestData.AnotherDate = searchParameters.Hotel.AnotherDate;
        }
    };

    SearchEngine.Hotel.displayRooms = function (settings) {
        if (settings.components.hotel && settings.components.hotel.rooms && settings.components.hotel.rooms.length && settings.components.hotel.rooms.val().length == 0) {

            var roomsQuantity = Util.GetComponentValue(settings.components.hotel.rooms);

            roomsQuantity = roomsQuantity == undefined ? 1 : roomsQuantity;

            var rooms = settings.components.hotel.roomContainer.hide();

            for (var i = 0; i < roomsQuantity; i++)
                rooms.eq(i).show();
        } else {
            if (settings.events.displayRooms)
                settings.events.displayRooms(settings.components.hotel.rooms.val());
            else {
                var numberOfRooms = settings.components.hotel.rooms.val();

                var roomContainers = settings.components.hotel.roomContainer.hide().addClass('hide');

                settings.components.hotel.childrenAgeTitle.hide().addClass('hide');

                for (var i = 0; i < numberOfRooms; i++) {
                    var roomContainer = roomContainers.eq(i).show().removeClass('hide');
                    var qtdChildren = settings.components.hotel.childrenAgeQntd.eq(i).val();
                    if (qtdChildren > 0) {
                        settings.components.hotel.childrenAgeTitle.show().removeClass('hide');

                        var childAges = roomContainer.find(settings.components.hotel.childrenAgeDisplay);
                        for (var j = 0; j < qtdChildren; j++) {
                            childAges.eq(j).show().removeClass('hide');
                        }
                    }
                }
            }
        }
    };

    SearchEngine.Hotel.getQueryStringHotel = function (data, settings) {

        var querystring = "";

        querystring += "&Location=" + settings.components.hotel.location.getSelectedLocationName().removeDiacritics().split("-")[0];
        querystring += "&LocationId=" + data.Hotel.LocationId;
        querystring += "&CheckIn=" + _functions.getQueryStringDatePattern(data.Hotel.CheckIn);
        querystring += "&CheckOut=" + _functions.getQueryStringDatePattern(data.Hotel.CheckOut);
        querystring += "&Rooms=" + data.Hotel.RoomsRequest.length;
        querystring += "&Adults=" + _functions.getQueryStringAdults(data.Hotel.RoomsRequest);
        querystring += "&Children=" + _functions.getQueryStringChildren(data.Hotel.RoomsRequest);
        querystring += "&ChildAges=" + _functions.getQueryStringChildAges(data.Hotel.RoomsRequest);

        return querystring;
    };

    SearchEngine.Hotel.GetHotelGuestsQuantities = _functions.getHotelGuestsQuantities;

    SearchEngine.Hotel.Validate = function (settings, component) {
        var errors = [];

        _functions.validateHotelLocation(errors, settings);
        errors = errors.concat(_functions.validateHotelDates(settings));
        _functions.validateHotelGuests(errors, settings, component);

        SharedFunctions.ValidateContext(errors);

        return errors;
    };

    SearchEngine.Hotel.fillValues = function (data, settings, component) {
        if (data && !$.isEmptyObject(data)) {
            //Valores de origem, destino, outbound e inbound de air
            var airDestinationData = undefined,
            airInboundData = undefined,
            airOutboundData = undefined;
            if (data.Air) {
                if (data.Air.Destinations.length) {
                    if (data.Air.Destinations[0].DestinationData)
                        airDestinationData = data.Air.Destinations[0].DestinationData;
                    if (data.Air.Destinations[0].OutboundDate)
                        airOutboundData = formatter.dateValuesToDate(data.Air.Destinations[0].OutboundDate);
                    if (data.Air.Destinations[0].InboundDate)
                        airInboundData = formatter.dateValuesToDate(data.Air.Destinations[0].InboundDate);
                }

                if (data.Hotel) {
                    if (!_compareAirPassengersWithHotelGuests(data.Air, data.Hotel))
                        data.Hotel.RoomsRequest = _convertAirPassengersToHotelRoomRequest(data.Air);
                }
            }

            if (data.Hotel)
                data = data.Hotel;

            if (data.LocationData)
                settings.components.hotel.location.locationsFinder("setData", data.LocationData);
            else if (data.LocationId)
                settings.components.hotel.location.locationsFinder("setDataById", data.LocationId);
            else if (airDestinationData)
                settings.components.hotel.location.locationsFinder("setData", airDestinationData);
            else if (data.Location) {
                settings.components.hotel.location.val(data.Location);
            }

            if (data.Name)
                settings.components.hotel.name.val(data.Name);

            if (data.CheckIn && data.CheckIn.isValid) {
                settings.components.hotel.checkIn.datepicker("setDate", formatter.dateValuesToDate(data.CheckIn))
                settings.components.hotel.checkIn.val(formatter.dateValuesShort(data.CheckIn));
                _functions.checkInDateRules(settings);
            } else if (airOutboundData) {
                var maxDate = settings.components.hotel.checkIn.datepicker("option", "maxDate");
                var minDate = settings.components.hotel.checkIn.datepicker("option", "minDate");
                var checkinDate = (airOutboundData >= minDate) ? ((airOutboundData <= maxDate) ? airOutboundData : maxDate) : minDate;
                settings.components.hotel.checkIn.datepicker("setDate", checkinDate)
                settings.components.hotel.checkIn.val(formatter.dateValuesShort(checkinDate.toDateValues()));
                _functions.checkOutDateRules(settings);
            }

            if (data.CheckOut && data.CheckOut.isValid) {
                settings.components.hotel.checkOut.datepicker("setDate", formatter.dateValuesToDate(data.CheckOut));
                settings.components.hotel.checkOut.val(formatter.dateValuesShort(data.CheckOut));
            } else if (airInboundData) {
                var maxDate = settings.components.hotel.checkOut.datepicker("option", "maxDate");
                var minDate = settings.components.hotel.checkOut.datepicker("option", "minDate");
                var checkoutDate = (airInboundData >= minDate) ? ((airInboundData <= maxDate) ? airInboundData : maxDate) : minDate;
                settings.components.hotel.checkOut.datepicker("setDate", checkoutDate);
                settings.components.hotel.checkOut.val(formatter.dateValuesShort(checkoutDate.toDateValues()));
            }

            if (data.RoomsRequest) {
                _functions.fillHotelRoomsRequest(data, settings, component);
                SearchEngine.Hotel.displayRooms(settings);
            }
        }
    };

    SearchEngine.Hotel.init = function (settings) {
        var settingsDatePicker = {
            'minDate': Util.CreateAbsoluteDate().addDays(parseInt(settings.minDaysToSearch, 10)),
            'maxDate': Util.CreateAbsoluteDate().addDays(parseInt(settings.maxDaysToSearch, 10))
        };

        _functions.initHotelDatePickers(settings, settingsDatePicker);

        var pesqIncConfig = _functions.setPesqIncConfig(settings);
        if ($.fn.locationsFinder && settings.controllers.locationsController) {
            pesqIncConfig.CurrentProduct = Global.Product.Hotel;
            pesqIncConfig.IsAirport = false;
            pesqIncConfig.HasHotelCode = true;
            pesqIncConfig.HasIata = false;

            settings.components.hotel.location.locationsFinder(pesqIncConfig).click(function () { $(this).select(); });
        }

        if (settings.events.afterInitialize)
            settings.events.afterInitialize(settings);
    };

})(jQuery);

/// <reference path="../../Libraries/Util.js" />
/// <reference path="../../Libraries/DatePickerOption.js" />
/// <reference path="../../Libraries/Jquery.js" />

(function ($) {

    function AirSearchEngine() {
        var component = undefined;
        var settings = {
            data: {},
            template: undefined,
            templateOptions: {},
            showCombos: false,
            searchEngineTab: false,
            validateMaxSearchDaysFromCheckinDate: false,
            minDaysToSearch: 3,
            maxDaysToSearch: 365,
            minPeriodToSearch: 3,
            calcCheckoutMaxDateFromToday: false,
            maxBabies: 0,
            maxChildren: 0,
            maxAdults: 0,
            maxPassengers: 999999,
            useScrollOnPesqInc: false,
            applyStatusClassesOnPesqInc: true,
            applyFixedClassOnPesqInc: false,
            applycorrectDateRules: true,
            useBrowserGeoLocation: true,
            anotheDatePickersOption: {
                minDate: 0
            },
            controllers: {
                messagesController: undefined,
                locationsController: undefined
            },
            events: {
                afterInitialize: undefined
            },
            components: {
                air: {
                    origin: '.txtOrigin',
                    destination: '.txtDestination',
                    inboundDate: '.txtInboundDate',
                    inboundCalendarIcon: '.inboundCalendarIcon',
                    outboundDate: '.txtOutboundDate',
                    outboundCalendarIcon: '.outboundCalendarIcon',
                    inboundPeriod: '.drpPeriodInbound',
                    outboundPeriod: '.drpPeriodOutbound',
                    adults: '.drpAdultsQtd',
                    children: '.drpChildrenQtd',
                    babies: '.drpBabiesQtd',
                    srcs: '.dropSrcQtd',
                    nonStop: '.chkNonStop',
                    oneWay: '.chkOneWay',
                    multiDestination: '.chkMultiDestination',
                    roundTrip: '.chkRoundTrip',
                    timeOut: '.drpTimeOut',
                    timeIn: '.drpTimeIn',
                    periodIn: '.sltPeriodIn',
                    periodOut: '.sltPeriodOut',
                    outboundLabel: ".outboundLabel",
                    searchType: '.sltSearchType',
                    ciaCode: '.drpCiaCode',
                    baggageFilter: '#drpBaggageFilter',
                    cabinType: '.drpCabin',
                    pricingTradeType: '.drpPricingTradeType',
                    advancedSearch: '.chkAdvancedSearch',
                    destinationContainer: '.destinationContainer',
                    addSegment: '.addSegmentLink',
                    removeSegment: '.removeSegment',
                    destinationDv: '.destinationDiv',
                    searchForPackageComposition: '.searchForPackageComposition',
                    clearSearchParams: '.clearSearchParams',
                    advancedOptionsContainer: '.advanced',
                    advancedOptionsContainerSettings: '.advanced.settings',
                    toggleAdvancedOptions: '.toggleAdvancedSearch',
                },
                searchEngineInboundDate: '.search-engine-inbound-date',
                searchEngineInboundHour: '.search-engine-inbound-hour',
                siteForm: '.site-form-volta',
                advancedSearchSiteForm: '.site-form-busca-avancada',
                searchEngineCombos: '#combos'
            },
            componentsOptions: {
                hasDatepicker: 'hasDatepicker',
                comboBoxClass: 'multi_options',
                comboDivisoria: '.Motor_Divisoria',
                updateValueCompleteClass: 'autocomplete_completed',
                customCheckedClass: 'current',
                air: {
                    destinationContainerAddClassOneWay: 'oneWay',
                    destinationContainerAddClassRoundTrip: 'roundTrip',
                    destinationContainerAddClassMultiDestination: 'multiDestination',
                    destinationContainerRemoveClassOneWay: 'roundTrip multiDestination',
                    destinationContainerRemoveClassRoundTrip: 'oneWay multiDestination',
                    destinationContainerRemoveClassMultiDestination: 'oneWay roundTrip',
                    origin: {
                        validatorClass: 'just-letters-for-locations'
                    },
                    destination: {
                        validatorClass: 'just-letters-for-locations'
                    }
                }
            },
            exhibitionType: undefined,
            searchType: 1,
            validateAirRulesOnChange: true,
            defaultOriginId: 0,
            defaultDestinationId: 0,
            defaultOutboundDate: undefined,
            defaultInboundDate: undefined,
            loadProximities: false,
            defaultAirCia: undefined,
            lockAirCia: undefined
        };
        var pesqIncConfig = {};
        var thisSearchEngine = this;
        var isInternationalAirSearch = false;
        var _gtagEventCategory = "Motor de aereo";
        var _rootSystemAccountInfo = Util.GetRootSystemAccountInfo();
        var _functions = {
            components: {
                setCiaCodes: function (destination, ciaCodeComponent) {
                    if (destination != undefined && ciaCodeComponent != undefined && typeof ciaCodeComponent !== 'string') {
                        var ciaCodes = [];

                        if (Util.HasCount(destination.CiaCodes)) {
                            ciaCodes = ciaCodes.concat(destination.CiaCodes);
                        }

                        if (!ciaCodeComponent.hasClass('multi_options'))
                            ciaCodeComponent.val(ciaCodes);
                        else
                            ciaCodeComponent.setSelectedValue(ciaCodes);
                    }
                },
                setDate: function (dateValue, component, dateRules, selector) {
                    if (selector.length == 0)
                        selector = undefined;

                    if (dateValue != undefined && component != undefined) {
                        component
                            .datepickermanager("setDate", formatter.dateValuesToDate(dateValue))
                            .datepickermanager("val", formatter.dateValuesShort(dateValue));

                        if (settings.validateAirRulesOnChange && dateRules != undefined)
                            if (component)
                                dateRules.call(component)
                            else
                                dateRules(selector);
                    }

                },
                setLocation: function (iata, component) {
                    if (iata != undefined && component != undefined && typeof component !== 'string') {
                        var location = _functions.locations.loadLocationsFromCacheByIata(iata);

                        if (location) {
                            component.locationsFinder("setData", location);
                        } else {
                            component.val(iata);
                        }
                    }
                },
                setNonStop: function (value, component) {
                    if (value != undefined && component != undefined) {
                        component.setCheck(value);
                    }
                },
                setOriginAndDestination: function (destination, originComponent, destinationComponent) {
                    if (destination != undefined && originComponent != undefined && destinationComponent != undefined) {
                        if (destination.OriginData != undefined) {
                            originComponent.locationsFinder("setData", destination.OriginData);
                        }
                        else {
                            _functions.components.setLocation(destination.Origin, originComponent);
                        }

                        if (destination.DestinationData != undefined) {
                            destinationComponent.locationsFinder("setData", destination.DestinationData);
                        }
                        else {
                            _functions.components.setLocation(destination.Destination, destinationComponent);
                        }
                    }
                },
            },
            locations: {
                loadLocationsFromCacheByIata: function (iata) {
                    if (iata != undefined && Util.isString(iata) && iata.length == 3 && Global.LocationsCache) {
                        var location = Global.LocationsCache.first(function (loc) { return loc != undefined && loc.i == iata });

                        if (location == undefined) {
                            var loadByIataUrl = Global.WebCommonPath + "Handlers/LocationsCache.ashx?" + "culture=" + Global.Culture + "&iata=" + iata;

                            $.getScript(loadByIataUrl, function (resp) {
                                if (resp) {
                                    (new Function(resp))();

                                    location = Global.LocationsCache.first(function (l) { return l != undefined && l.i == origin });
                                }
                            });
                        }

                        return location;
                    }

                    return undefined;
                },
                loadLocationsFromCacheByName: function (name) {
                    if (name != undefined && Util.isString(name) && Util.HasCount(Global.LocationsCache)) {
                        var location = Global.LocationsCache.first(function (loc) { return loc != undefined && loc.n == name });

                        if (location == undefined) {
                            var loadByIataUrl = Global.WebCommonPath + "Handlers/LocationsCache.ashx?" + "culture=" + Global.Culture + "&iata=" + iata;

                            $.getScript(loadByIataUrl, function (resp) {
                                if (resp) {
                                    (new Function(resp))();

                                    location = Global.LocationsCache.first(function (l) { return l != undefined && l.n == name });
                                }
                            });
                        }

                        return location;
                    }

                    return undefined;
                },
            },
            queryString: {
                auxiliar: {
                    get: function (key, queryString) {
                        var value = Util.QueryString(key, queryString);

                        return value != undefined && value != ""
                            ? value
                            : undefined;
                    },
                },
                destination: {
                    getCiaCodes: function (destination, queryString, destinationIndex) {
                        if (destinationIndex == undefined)
                            destinationIndex = 0;

                        var ciaCode = Util.QueryString("Cia", queryString, destinationIndex);

                        if (ciaCode != undefined) {
                            if (ciaCode.indexOf(",") >= 0)
                                destination.CiaCodes = ciaCode.split(",");
                            else
                                destination.CiaCodes.push(ciaCode);
                        }
                    },
                    getDates: function (destination, queryString, destinationIndex) {
                        if (destinationIndex == undefined)
                            destinationIndex = 0;

                        var outboundDate = Util.QueryString("Data", queryString, destinationIndex) || Util.QueryString("DataIda", queryString);
                        var inboundDate = Util.QueryString("Data", queryString, (++destinationIndex)) || Util.QueryString("DataVolta", queryString);
                        var nonStopQueryStringFilter = Util.QueryString("NonStop", queryString);
                        var startTimeOutQueryStringFilter = Util.QueryString("Hora", queryString, destinationIndex);
                        var startTimeInQueryStringFilter = Util.QueryString("Hora", queryString, (++destinationIndex));

                        destination.OutboundDate = outboundDate.toDateValues("pt");

                        if (inboundDate != undefined)
                            destination.InboundDate = inboundDate.toDateValues("pt");

                        destination.NonStop = nonStopQueryStringFilter == "1" || nonStopQueryStringFilter == "true";

                        destination.StartTimeOut = startTimeOutQueryStringFilter;
                        destination.EndTimeOut = startTimeOutQueryStringFilter;

                        destination.StartTimeIn = startTimeInQueryStringFilter;
                        destination.EndTimeIn = startTimeInQueryStringFilter;
                    },
                    getNonStop: function (destination, queryString, destinationIndex) {
                        if (destinationIndex == undefined)
                            destinationIndex = 0;

                        var nonStop = Util.QueryString("NonStop", queryString, destinationIndex);

                        destination.NonStop = nonStop || false;
                    },
                    getOriginAndDestination: function (destination, queryString) {
                        destination.OriginData = destination.Origin;
                        destination.DestinationData = destination.Destination;

                        if (Global.LocationsCache && Global.LocationsCache.length > 0) {
                            destination.OriginData = destination.Origin.length == 3
                                ? _functions.locations.loadLocationsFromCacheByIata(destination.Origin) 
                                : _functions.locations.loadLocationsFromCacheByName(destination.Origin);

                            destination.DestinationData = destination.Destination.length == 3
                                ? _functions.locations.loadLocationsFromCacheByIata(destination.Destination) 
                                : _functions.locations.loadLocationsFromCacheByName(destination.Destination);
                        }

                        if (destination.Origin.length == 3)
                            destination.Origin = destination.Origin.toUpperCase();

                        if (destination.Destination.length == 3)
                            destination.Destination = destination.Destination.toUpperCase();
                    },
                },
                getBaggageFilter: function (searchParameters, queryString) {
                    searchParameters.Air.BaggageFilter = _functions.queryString.auxiliar.get("Baggage", queryString);
                },
                getCabinTypeFilter: function (searchParameters, queryString) {
                    searchParameters.Air.CabinType = _functions.queryString.auxiliar.get("Cabine", queryString);
                },
                getDestinationData: function (searchParameters, queryString) {
                    var quantityOfDestinations = !searchParameters.Air.MultiDestination
                        ? "1"
                        : Util.QueryString("DestQtd", queryString) || "0";

                    quantityOfDestinations = !Util.isValidNumber(quantityOfDestinations)
                        ? 0
                        : parseInt(quantityOfDestinations);

                    for (destinationIndex = 0; destinationIndex < quantityOfDestinations; destinationIndex++) {
                        var destinationToPush = {
                            CiaCodes: [],
                            Destination: Util.QueryString("Destino", queryString, destinationIndex).replaceAll("%20", " ").replaceAll("---", ")").replaceAll("--", "("),
                            DestinationData: undefined,
                            EndTimeIn: undefined,
                            EndTimeOut: undefined,
                            InboundDate: undefined,
                            NonStop: false,
                            Origin: Util.QueryString("Origem", queryString, destinationIndex).replaceAll("%20", " ").replaceAll("---", ")").replaceAll("--", "("),
                            OriginData: undefined,
                            OutboundDate: undefined,
                            StartTimeIn: undefined,
                            StartTimeOut: undefined,
                        };

                        _functions.queryString.destination.getOriginAndDestination(destinationToPush, queryString);
                        _functions.queryString.destination.getDates(destinationToPush, queryString, destinationIndex);
                        _functions.queryString.destination.getCiaCodes(destinationToPush, queryString, destinationIndex);
                        _functions.queryString.destination.getNonStop(destinationToPush, queryString, destinationIndex);

                        searchParameters.Air.Destinations.push(destinationToPush);
                    }
                },
                getFlightTypeData: function (searchParameters, queryString) {
                    var multiDestinationQueryStringValue = Util.QueryString("Multi", queryString);

                    if (multiDestinationQueryStringValue != undefined) {
                        searchParameters.Air.MultiDestination = (multiDestinationQueryStringValue == 1 || multiDestinationQueryStringValue == "true");
                    } else {
                        var roundTripQueryStringValue = Util.QueryString("RoundTrip", queryString);
                        var oneWayQueryStringValue = Util.QueryString("SomenteIda", queryString);

                        if (roundTripQueryStringValue != undefined)
                            searchParameters.Air.IsRoundTrip = (roundTripQueryStringValue == 1 || roundTripQueryStringValue == "true");
                        else
                            searchParameters.Air.IsRoundTrip = !(oneWayQueryStringValue == 1 || oneWayQueryStringValue == "true");
                    }
                },
                getNonStopFilter: function (searchParameters, queryString) {
                    searchParameters.Air.NonStop = _functions.queryString.auxiliar.get("NonStop", queryString);
                },
                getPassengerData: function (searchParameters, queryString) {
                    searchParameters.Air.Adults = _functions.queryString.auxiliar.get("NumADT", queryString) || 0;
                    searchParameters.Air.Children = _functions.queryString.auxiliar.get("NumCHD", queryString) || 0;
                    searchParameters.Air.Babies = _functions.queryString.auxiliar.get("NumINF", queryString) || 0;
                },
                getIsRoundTrip: function (searchParameters, queryString) {
                    var roundTrip = _functions.queryString.auxiliar.get("RoundTrip", queryString);

                    searchParameters.Air.IsRoundTrip = (roundTrip == 1);
                },
            },
        };

        this.initialize = function (target, opts) {

            component = $(target);

            $.extend(true, settings, opts || {});

            _attachEvents();

            _setLiveEvents();
        }

        this.render = function () {
            _selectComponents();

            component.html(settings.template(settings));

            if (settings.events.posRender)
                settings.events.posRender(settings);

            _selectComponents();

            _initAir();

            _setValidators();

            _showCombos();

            _setComponentsEvents();

            settings.components.air.clearSearchParams.show();
        }

        this.setOptions = function (options) {
            $.extend(true, settings, options);
        }

        this.getData = function () {

            var searchParameters = {};

            searchParameters.CompanyId = 0;

            searchParameters.Air = {};

            if (settings.components.air.roundTrip.length)
                searchParameters.Air.IsRoundTrip = settings.components.air.roundTrip.is(":ischecked");
            else
                searchParameters.Air.IsRoundTrip = settings.components.air.inboundDate && settings.components.air.inboundDate.datepickermanager("val") && settings.components.air.inboundDate.datepickermanager("val").length;

            searchParameters.Air.MultiDestination = settings.components.air.multiDestination.is(":ischecked");

            searchParameters.Air.IsOneWay = settings.components.air.oneWay.is("ischecked") || settings.components.air.oneWay.hasClass(settings.componentsOptions.customCheckedClass);

            if (settings.components.air.nonStop && settings.components.air.nonStop.length)
                searchParameters.Air.NonStop = Util.IsChecked(settings.components.air.nonStop);

            var origin = "";
            var destination = "";
            searchParameters.Air.Destinations = [];

            var citiPairItens = settings.components.air.destinationDv;
            isInternationalAirSearch = false;

            var index = 0;

            citiPairItens.each(function () {
                var currentCityPair = $(this);
                var destinationTravel = {};

                if (currentCityPair.length > 1) {
                    currentCityPair = $(currentCityPair[index]);
                }

                if ($.fn.locationsFinder) {
                    origin = currentCityPair.find(settings.components.air.origin[index]).locationsFinder("getData");
                    destinationTravel.Origin = origin && origin.i ? origin.i : currentCityPair.find(settings.components.air.origin[index]).val();

                    if (origin && origin["in"]) isInternationalAirSearch = true;
                    destination = currentCityPair.find(settings.components.air.destination[index]).locationsFinder("getData");
                    destinationTravel.Destination = destination && destination.i ? destination.i : currentCityPair.find(settings.components.air.destination[index]).val();
                    if (destination && destination["in"]) isInternationalAirSearch = true;
                }
                else {
                    origin = currentCityPair.find(settings.components.air.origin[index]).val();
                    destinationTravel.Origin = origin;

                    destination = currentCityPair.find(settings.components.air.destination[index]).val();
                    destinationTravel.Destination = destination;
                }

                destinationTravel.OriginData = origin;
                destinationTravel.DestinationData = destination;

                if (destinationTravel.Origin.length == 3)
                    destinationTravel.Origin = destinationTravel.Origin.toUpperCase();

                if (destinationTravel.Destination.length == 3)
                    destinationTravel.Destination = destinationTravel.Destination.toUpperCase();

                var outboundDate = currentCityPair.find(settings.components.air.outboundDate[index], currentCityPair).datepickermanager("val");
                if (!outboundDate || !outboundDate.length)
                    outboundDate = currentCityPair.parent().find(settings.components.air.outboundDate[index], currentCityPair).datepickermanager("val");

                if (outboundDate)
                    destinationTravel.OutboundDate = outboundDate.toDateValues();

                var inboundDateField = currentCityPair.find(settings.components.air.inboundDate[index], currentCityPair);
                if (!searchParameters.Air.MultiDestination && (!inboundDateField || !inboundDateField.length))
                    inboundDateField = currentCityPair.parent().find(settings.components.air.inboundDate[index], currentCityPair);

                if (!searchParameters.Air.MultiDestination && inboundDateField && inboundDateField.length) {
                    var inboundDate = inboundDateField.datepickermanager("val");
                    if (inboundDate)
                        destinationTravel.InboundDate = inboundDate.toDateValues();
                }

                destinationTravel.NonStop = currentCityPair.find(settings.components.air.nonStop).length == 0
                    ? Util.IsChecked(settings.components.air.nonStop)
                    : currentCityPair.find(settings.components.air.nonStop).is(":checked");

                //Periodo selecionado
                var periodInboundComponent = currentCityPair.find(settings.components.air.inboundPeriod);
                var periodOutboundComponent = currentCityPair.find(settings.components.air.outboundPeriod);
                var periodInbound = thisSearchEngine.getPeriodByComponent(periodInboundComponent);
                var periodOutbound = thisSearchEngine.getPeriodByComponent(periodOutboundComponent);

                destinationTravel.StartTimeIn = periodInbound.StartTime;
                destinationTravel.EndTimeIn = periodInbound.EndTime;
                destinationTravel.StartTimeOut = periodOutbound.StartTime;
                destinationTravel.EndTimeOut = periodOutbound.EndTime;

                _setCiaCodes(destinationTravel, searchParameters, currentCityPair);

                if (settings.components.air.pricingTradeType)
                    destinationTravel.PricingTradeType = currentCityPair.find(settings.components.air.pricingTradeType).eq(0).val();

                //Cabin
                destinationTravel.CabinFilter = Util.GetComponentValue(currentCityPair.find(settings.components.air.cabinType));

                searchParameters.Air.Destinations.push(destinationTravel);
                index++;
            });

            searchParameters.Air.Adults = parseInt(Util.GetComponentValue(settings.components.air.adults));
            searchParameters.Air.Children = parseInt(Util.GetComponentValue(settings.components.air.children));
            searchParameters.Air.Babies = parseInt(Util.GetComponentValue(settings.components.air.babies));
            searchParameters.Air.Srcs = parseInt(Util.GetComponentValue(settings.components.air.srcs));

            if (isNaN(searchParameters.Air.Adults) && isNaN(searchParameters.Air.Srcs) && isNaN(searchParameters.Air.Children))
                searchParameters.Air.Adults = 1;

            if (settings.components.air.cabinType)
                searchParameters.Air.CabinType = settings.components.air.cabinType.val();

            if (settings.components.air.baggageFilter)
                searchParameters.Air.BaggageFilter = settings.components.air.baggageFilter.val();

            if (settings.components.air.searchType.length != 0)
                searchParameters.Air.SearchType = settings.components.air.searchType.val();
            else
                searchParameters.Air.SearchType = settings.searchType;

            if (searchParameters.Air.SearchType == 0 && isInternationalAirSearch) {
                searchParameters.Air.SearchType = 3;
                var func = function () { alert(Util.GetInterfaceMessage("InternationalSearch")); };
                setTimeout(func, 500);
            }

            searchParameters.Air.isInternationalAirSearch = isInternationalAirSearch;

            searchParameters.SearchForPackageComposition = Util.IsChecked(settings.components.air.searchForPackageComposition);

            _getAirRequestData(searchParameters);

            if (Util.IsAbleToSendGtagEvents(_rootSystemAccountInfo))
                _sendGtagEvents(searchParameters);

            return searchParameters;
        }

        function _setCiaCodes(destinationTravel, searchParameters, currentCityPair) {
            destinationTravel.CiaCodes = [];
            if (settings.components.air.ciaCode) {
                var ciaCode;
                var ciaCodeComponentValue;

                if (searchParameters.Air.MultiDestination) {
                    ciaCodeComponentValue = Util.GetComponentValue(currentCityPair.find(settings.components.air.ciaCode));
                }
                else {
                    ciaCodeComponentValue = Util.GetComponentValue(settings.components.air.ciaCode);
                }

                if (ciaCodeComponentValue != "") {
                    ciaCode = ciaCodeComponentValue;
                }

                if (ciaCode && ciaCode != "") {
                    if (ciaCode.indexOf(",") >= 0)
                        destinationTravel.CiaCodes = ciaCode.split(",");
                    else
                        destinationTravel.CiaCodes.push(ciaCode);
                }
            }
        };

        this.updateValues = function (searchParameters) {
            if (searchParameters) {

                var adults = 1, babies = 0, childrens = 0;

                if (searchParameters.ConsumerSummary) {
                    adults = searchParameters.ConsumerSummary.Adults;
                    babies = searchParameters.ConsumerSummary.Babies;
                    childrens = searchParameters.ConsumerSummary.Childrens;
                }

                if (searchParameters.getConsumerTotals) {
                    var consumerTotals = searchParameters.getConsumerTotals();

                    if (consumerTotals && (consumerTotals.Adults != adults || consumerTotals.Babies != babies || consumerTotals.Childrens != childrens)) {
                        adults = consumerTotals.Adults <= settings.maxPassengers ? consumerTotals.Adults : settings.maxPassengers;
                        childrens = consumerTotals.Childrens <= settings.maxChildren ? consumerTotals.Childrens : settings.maxChildren;
                        babies = consumerTotals.Babies <= settings.maxBabies ? consumerTotals.Babies <= adults ? consumerTotals.Babies : adults : settings.maxBabies;
                    }
                }

                if (!settings.components.air.adults.hasClass(settings.componentsOptions.comboBoxClass)) {
                    settings.components.air.adults.val(adults);
                    settings.components.air.children.val(childrens);
                    settings.components.air.babies.val(babies);
                } else {
                    settings.components.air.adults.setSelectedValue(adults);
                    settings.components.air.children.setSelectedValue(childrens);
                    settings.components.air.babies.setSelectedValue(babies);
                }

                if (searchParameters.DepartureLocationData)
                    settings.components.air.origin.addClass(settings.componentsOptions.updateValueCompleteClass).locationsFinder("setData", searchParameters.DepartureLocationData);
                else if (searchParameters.DepartureLocation)
                    settings.components.air.origin.addClass(settings.componentsOptions.updateValueCompleteClass).val(searchParameters.DepartureLocation);
                else
                    settings.components.air.origin.removeClass(settings.componentsOptions.updateValueCompleteClass).val("").locationsFinder("setData", 0);

                if (searchParameters.DestinationLocationData)
                    settings.components.air.destination.addClass(settings.componentsOptions.updateValueCompleteClass).locationsFinder("setData", searchParameters.DestinationLocationData);
                else if (searchParameters.DestinationLocation)
                    settings.components.air.destination.addClass(settings.componentsOptions.updateValueCompleteClass).val(searchParameters.DestinationLocation);
                else
                    settings.components.air.destination.removeClass(settings.componentsOptions.updateValueCompleteClass).val("").locationsFinder("setData", 0);

                if (searchParameters.StartDate) {
                    settings.components.air.outboundDate.datepickermanager("setDate", formatter.dateValuesToDate(searchParameters.StartDate)).val(formatter.dateValuesShort(searchParameters.StartDate));
                    if (settings.validateAirRulesOnChange)
                        _outboundDateRules(settings.components.air.outboundDate.selector);
                } else {
                    settings.components.air.outboundDate.val("").datepickermanager("setDate", undefined);
                }

                if (searchParameters.EndDate) {
                    settings.components.air.inboundDate.val(formatter.dateValuesShort(searchParameters.EndDate)).datepickermanager("setDate", formatter.dateValuesToDate(searchParameters.EndDate));
                    if (settings.validateAirRulesOnChange)
                        _inboundDateRules(settings.components.air.inboundDate.selector);
                } else {
                    settings.components.air.inboundDate.val("").datepickermanager("setDate", undefined);
                }

                settings.components.air.searchForPackageComposition.setCheck(searchParameters.SearchForPackageComposition);

                if (searchParameters.Air) {

                    if (searchParameters.Air.IsRoundTrip)
                        settings.components.air.roundTrip.click();
                    else if (searchParameters.Air.IsOneWay)
                        settings.components.air.oneWay.click();
                    else
                        settings.components.air.multiDestination.click();

                    settings.components.air.nonStop.setCheck(searchParameters.Air.NonStop);

                    var ciaCode = searchParameters.Air.CiaCodes.length ? searchParameters.Air.CiaCodes[0] : "";

                    if (!settings.components.air.ciaCode.hasClass(settings.componentsOptions.comboBoxClass))
                        settings.components.air.ciaCode.val(ciaCode);
                    else
                        settings.components.air.ciaCode.setSelectedValue(ciaCode);

                }
            }
        }

        //METODO DO ANTIGO SEARCHENGINE
        this.fillValues = function (data) {

            if (data && !$.isEmptyObject(data)) {
                var hotelLocationData = undefined, hotelCheckinData = undefined, hotelCheckOutData = undefined;
                var passengers = {
                    Adults: parseInt(data.Air.Adults) || 0,
                    Children: parseInt(data.Air.Children) || 0,
                    Babies: parseInt(data.Air.Babies) || 0
                };

                if (data.Hotel) {
                    if (data.Hotel.LocationData)
                        hotelLocationData = data.Hotel.LocationData;
                    if (data.Hotel.CheckIn && data.Hotel.CheckIn.isValid)
                        hotelCheckinData = data.Hotel.CheckIn;
                    if (data.Hotel.CheckOut && data.Hotel.CheckOut.isValid)
                        hotelCheckOutData = data.Hotel.CheckOut;
                    if (data.Hotel.RoomsRequest.length) {
                        passengers.Adults = 0;
                        passengers.Children = 0;
                        passengers.Babies = 0;
                        for (var i = 0, len = data.Hotel.RoomsRequest.length; i < len; i++) {
                            passengers.Adults += parseInt(data.Hotel.RoomsRequest[i].Adults);
                            for (var j = 0, limit = data.Hotel.RoomsRequest[i].ChildAges.length; j < limit; j++) {
                                if (parseInt(data.Hotel.RoomsRequest[i].ChildAges[j]) < 2)
                                    passengers.Babies += 1;
                                else
                                    passengers.Children += 1;
                            }

                        }
                    }
                }

                if (passengers.Adults > settings.maxGuestQuantities)
                    passengers.Adults = settings.maxGuestQuantities
                if (passengers.Children > settings.maxChildren)
                    passengers.Children = settings.maxChildren
                if (passengers.Babies > passengers.Adults)
                    passengers.Babies = passengers.Adults;
                if (settings.maxBabies && passengers.Babies > settings.maxBabies)
                    passengers.Babies = settings.maxBabies;

                if (data.Air)
                    data = data.Air;

                //BUG 2101 - IE7 
                if (data.IsRoundTrip)
                    settings.components.air.roundTrip.check();
                else if (data.Destinations && data.Destinations.length == 1)
                    settings.components.air.oneWay.check();
                else
                    settings.components.air.multiDestination.check();

                _searchAirRules();
                
                if (data.Destinations) {
                    for (destinationIndex = 2; destinationIndex < data.Destinations.length; destinationIndex++) {
                        ////Multitrechos (+ de 2 trechos)
                        //Para que crie todos os componentes e depois preencha os valores, pois ao iniciar os componentes de data ele zera tudo
                        // fazendo com haja a perda dos dados.
                        _onAddAirSegment();
                        _selectComponents(settings.components.air);
                    }
                    for (destinationIndex = 0; destinationIndex < data.Destinations.length; destinationIndex++) {

                        var destinationData = data.Destinations[destinationIndex];
                        var originComponent = $(settings.components.air.origin[destinationIndex]);
                        var destinationComponent = $(settings.components.air.destination[destinationIndex]);
                        var outboundDateComponent = $(settings.components.air.outboundDate[destinationIndex]);
                        var inboundDateComponent = $(settings.components.air.inboundDate[destinationIndex]);
                        var timeOutComponent = $(settings.components.air.timeOut[destinationIndex]);
                        var timeInComponent = $(settings.components.air.timeIn[destinationIndex]);
                        var ciaCodeComponent = $(settings.components.air.ciaCode[destinationIndex]);

                        _functions.components.setOriginAndDestination(destinationData, originComponent, destinationComponent);

                        if (destinationData.OutboundDate)
                            _functions.components.setDate(destinationData.OutboundDate, outboundDateComponent, _outboundDateRules, settings.components.air.outboundDate.selector);

                        if (destinationData.InboundDate)
                            _functions.components.setDate(destinationData.InboundDate, inboundDateComponent, _inboundDateRules, settings.components.air.inboundDate.selector);

                        if (destinationData.StartTimeOut && destinationData.StartTimeOut != "")
                            timeOutComponent.val(destinationData.StartTimeOut);

                        if (destinationData.StartTimeIn && destinationData.StartTimeIn != "")
                            timeInComponent.val(destinationData.StartTimeIn);

                        if (Util.HasCount(destinationData.CiaCodes))
                            _functions.components.setCiaCodes(destinationData, ciaCodeComponent);

                        if (Util.HasCount(settings.components.air.nonStop) && settings.components.air.nonStop[destinationIndex] != undefined) {
                            var nonStopComponent = $(settings.components.air.nonStop[destinationIndex]);

                            _functions.components.setNonStop(destinationData.NonStop, nonStopComponent);
                        }
                    }

                    if (hotelLocationData) 
                        settings.components.hotel.location.locationsFinder("setData", hotelLocationData);

                    if (hotelCheckinData) 
                        _functions.components.setDate(hotelCheckinData, settings.components.hotel.checkIn, _outboundDateRules);

                    if (hotelCheckOutData) 
                        _functions.components.setDate(hotelCheckOutData, settings.components.hotel.checkOut, _inboundDateRules);

                    if (typeof settings.components.air.nonStop !== 'string')
                        settings.components.air.nonStop.setCheck(data.NonStop);
                    else 
                        $(settings.components.air.nonStop.selector, component).setCheck(data.NonStop);
                }

                if (!settings.components.air.adults.hasClass("multi_options")) {
                    settings.components.air.adults.val(data.Adults);
                    settings.components.air.children.val(data.Children);
                    settings.components.air.babies.val(data.Babies);
                }
                else {
                    settings.components.air.adults.setSelectedValue(passengers.Adults);
                    settings.components.air.children.setSelectedValue(passengers.Children);
                    settings.components.air.babies.setSelectedValue(passengers.Babies);
                }

                settings.components.air.cabinType.val(data.CabinType);
                settings.components.air.pricingTradeType.val(data.PricingTradeType);
            }

        }

        this.validate = function () {
            var errors = [];

            settings.components.air.destinationDv.each(function () {
                var thisDestination = $(this);

                var originComponent = thisDestination.find(settings.components.air.origin);

                if (originComponent.val() == "")
                    errors.push("OnSearch_NoOrigin");
                else if (originComponent.locationsFinder("getData") == undefined)
                    errors.push("OnSearch_InvalidOrigin");

                var destinationComponent = thisDestination.find(settings.components.air.destination);

                if (destinationComponent.val() == "")
                    errors.push("OnSearch_NoDestin");
                else if (originComponent.val() == destinationComponent.val())
                    errors.push("OnSearch_OriginEqualsDestin");
                else if (destinationComponent.locationsFinder("getData") == undefined)
                    errors.push("OnSearch_InvalidDestination");

                var minDate = new Date().addDays(settings.minDaysToSearch - 1);
                var maxDate = new Date();

                var outboundDateComponent = thisDestination.find(settings.components.air.outboundDate);

                if (!outboundDateComponent.length)
                    outboundDateComponent = thisDestination.parent().find(settings.components.air.outboundDate);

                if (outboundDateComponent.datepickermanager("val") == "")
                    errors.push("OnSearch_NoOutboundDate");
                else if (!outboundDateComponent.datepickermanager("val").isDate())
                    errors.push("OnSearch_InvalidOutboundDate");
                else if (settings.anotheDatePickersOption.minDate != undefined) {
                    var MinDate = new Date().addDays(settings.anotheDatePickersOption.minDate);

                    if (outboundDateComponent.datepickermanager("getDate") < minDate)
                        errors.push(["OnSearch_MinHoursHotel", settings.anotheDatePickersOption.minDate * 24]);
                }

                if (outboundDateComponent.datepickermanager("val").length) {
                    var outboundDate = formatter.dateValuesToDate(outboundDateComponent.datepickermanager("val").toDateValues());

                    if (outboundDate < minDate) {
                        if (settings.minDaysToSearch > 0)
                            errors.push(["OnSearch_MinHours", settings.minDaysToSearch * 24]);
                        else
                            errors.push("OnSearch_OutboundLessThanCurrentDate");
                    }

                    var refToCalcCheckoutMaxDate = settings.calcCheckoutMaxDateFromToday ? (new Date()) : outboundDate;
                    maxDate = refToCalcCheckoutMaxDate.addDays(settings.maxDaysToSearchHotels);
                }

                if (!settings.components.air.inboundDate.hasClass('hide') && (settings.components.air.roundTrip.is(':ischecked') || settings.components.air.inboundDate && settings.components.air.inboundDate.datepickermanager("val") && settings.components.air.inboundDate.datepickermanager("val").length)) {
                    if (settings.components.air.inboundDate.datepickermanager("val") == "") {
                        errors.push("OnSearch_NoInboundDate");
                    }
                    else if (!settings.components.air.inboundDate.datepickermanager("val").isDate())
                        errors.push("OnSearch_InvalidInboundDate");
                }
            });

            _validateOutBoundMaxSearchDays(settings.components.air.outboundDate, errors);

            if (settings.components.air.multiDestination.is(':ischecked')) {
                var lastDate = undefined;
                var noErrors = true;

                settings.components.air.destinationDv.each(function () {
                    var thisDestination = $(this);
                    if (lastDate > thisDestination.find(settings.components.air.outboundDate).datepickermanager("val").toDateTime() && noErrors) {
                        errors.push("OnSearch_OutboundDateOutOrder");
                        noErrors = false;
                    }
                    lastDate = thisDestination.find(settings.components.air.outboundDate).datepickermanager("val").toDateTime();
                });
            }else if (Util.IsChecked(settings.components.air.roundTrip) || (settings.components.air.inboundDate && settings.components.air.inboundDate.datepickermanager("val") && settings.components.air.inboundDate.datepickermanager("val").length)) {

                if (settings.components.air.outboundDate.datepickermanager("val") != "" && settings.components.air.inboundDate.datepickermanager("val") != "" && settings.components.air.outboundDate.datepickermanager("getDate") > settings.components.air.inboundDate.datepickermanager("getDate")) {
                    settings.components.air.inboundDate.val(settings.components.air.outboundDate.datepickermanager("val"));
                    errors.push("OnSearch_OutboundLessThanInboundDate");
                }

                if (settings.components.air.timeOut.val() != "" && settings.components.air.timeIn.val() != "") {
                    if (settings.components.air.outboundDate.datepickermanager("val") == settings.components.air.inboundDate.datepickermanager("val")
                    && parseInt(settings.components.air.timeOut.val()) > parseInt(settings.components.air.timeIn.val())) {
                        errors.push("OnSearch_CurrentDateTimeInLessThanTimeOut");
                    }
                }

                if (settings.components.air.outboundDate.datepickermanager("val") != "") {

                    var outboundDate = settings.components.air.outboundDate.datepickermanager("getDate");

                    outboundDate = new Date(outboundDate.getTime() + (1000 * 60 * 60 * 23 + (1000 * 60 * 59)));

                    if (outboundDate <= (new Date())) {
                        errors.push("OnSearch_OutboundLessThanCurrentDate");
                        settings.components.air.outboundDate.datepickermanager("setDate", (new Date()));
                    }

                    _validateInBoundMaxSearchDays(settings.components.air.inboundDate, errors);
                }
            }else if (settings.components.air.outboundDate.datepickermanager("val") != "") {

                var outboundDate = settings.components.air.outboundDate.datepickermanager("getDate");

                outboundDate = new Date(outboundDate.getTime() + (1000 * 60 * 60 * 23 + (1000 * 60 * 59)));

                if (outboundDate <= (new Date())) {
                    errors.push("OnSearch_OutboundLessThanCurrentDate");
                    settings.components.air.outboundDate.datepickermanager("setDate", (new Date()));
                }
            }

            if ((parseInt(Util.GetComponentValue(settings.components.air.adults)) + parseInt(Util.GetComponentValue(settings.components.air.children)) + parseInt(Util.GetComponentValue(settings.components.air.babies))) > 9) {
                errors.push("OnSearch_NoMoreThanNinePassengers");
                settings.components.air.adults.val(1);
                settings.components.air.children.val(0);
                settings.components.air.babies.val(0);
            }

            if ((parseInt(Util.GetComponentValue(settings.components.air.children)) + parseInt(Util.GetComponentValue(settings.components.air.babies))) > settings.maxChildren && settings.maxChildren > 0) {
                errors.push("OnSearch_NoMoreChildren");
            }

            if (parseInt(Util.GetComponentValue(settings.components.air.adults)) < parseInt(Util.GetComponentValue(settings.components.air.babies))) {
                errors.push("OnSearch_NeedMoreAdultsThanInfants");
                settings.components.air.babies.val(parseInt(Util.GetComponentValue(settings.components.air.adults)));
            }

            if (parseInt(Util.GetComponentValue(settings.components.air.adults)) == 0
                && parseInt(Util.GetComponentValue(settings.components.air.children)) == 0
                && (parseInt(Util.GetComponentValue(settings.components.air.srcs)) || 0) == 0) {
                errors.push("OnSearch_NeedPassenger");
            }

            SharedFunctions.ValidateContext(errors);

            if (settings.controllers.messagesController && errors && errors.length)
                settings.controllers.messagesController.notifyMessages(errors, settings.exhibitionType);

            return errors.length == 0;
        };

        this.readQueryString = function (queryString) {
            var searchParameters = {
                Air: {
                    CompanyId: 0,
                    Destinations: [],
                    IsRoundTrip: false,
                    MultiDestination: false,
                }
            };

            _functions.queryString.getPassengerData(searchParameters, queryString);
            _functions.queryString.getFlightTypeData(searchParameters, queryString);
            _functions.queryString.getBaggageFilter(searchParameters, queryString);
            _functions.queryString.getCabinTypeFilter(searchParameters, queryString);
            _functions.queryString.getDestinationData(searchParameters, queryString);
            _functions.queryString.getNonStopFilter(searchParameters, queryString);
            _functions.queryString.getIsRoundTrip(searchParameters, queryString);

            searchParameters.Air.SearchType = settings.components.air.searchType.length != 0
                ? settings.components.air.searchType.val()
                : settings.searchType;

            _getAirRequestData(searchParameters);

            return searchParameters;
        }

        this.getQueryString = function (pageUrl) {

            var data = thisSearchEngine.getData();

            pageUrl = pageUrl + "?SearchType=Air";

            var querystring = "";

            querystring = querystring + _getQueryStringAirDestination(data);

            querystring += "&RoundTrip=" + (data.Air.IsRoundTrip == true ? "1" : "0");
            querystring += "&NonStop=" + data.Air.NonStop.toString();

            querystring += "&NumADT=" + (data.Air.Adults ? data.Air.Adults : 0);
            querystring += "&NumCHD=" + (data.Air.Children ? data.Air.Children : 0);
            querystring += "&NumINF=" + (data.Air.Babies ? data.Air.Babies : 0);

            if (data.Air.RequestData.CityPairsRequest[0] != undefined && data.Air.RequestData.CityPairsRequest[0].EndTime != undefined)
                querystring += "&Hora=" + (data.Air.RequestData.CityPairsRequest[0].EndTime - 1).toString();
            else
                querystring += "&Hora=";

            if (data.Air.RequestData.CityPairsRequest[1] != undefined && data.Air.RequestData.CityPairsRequest[1].EndTime != undefined)
                querystring += "&Hora=" + (data.Air.RequestData.CityPairsRequest[1].EndTime - 1).toString();
            else
                querystring += "&Hora=";

            querystring += "&Cabine=" + data.Air.CabinType;
            querystring += "&Baggage=" + data.Air.BaggageFilter;
            querystring += "&Multi=" + (data.Air.MultiDestination || false).toString();
            querystring += "&DestQtd=" + data.Air.Destinations.length.toString();

            querystring = querystring.replace("undefined", "");
            querystring = querystring.replace("null", "");

            return pageUrl + querystring;
        }

        this.getGenericData = function () {
            var data = thisSearchEngine.getData();
            var genericData = { Air: {} };

            genericData.SearchForPackageComposition = data.SearchForPackageComposition;
            genericData.DepartureLocation = data.Air.Destinations[0].Origin;
            genericData.DestinationLocation = data.Air.Destinations[0].Destination;
            genericData.DepartureLocationData = data.Air.Destinations[0].OriginData ? data.Air.Destinations[0].OriginData : null;
            genericData.DestinationLocationData = data.Air.Destinations[0].DestinationData ? data.Air.Destinations[0].DestinationData : null;
            genericData.StartDate = data.Air.Destinations[0].OutboundDate ? data.Air.Destinations[0].OutboundDate : null;
            genericData.EndDate = data.Air.Destinations[0].InboundDate ? data.Air.Destinations[0].InboundDate : null;

            genericData.ConsumerSummary = {
                Adults: data.Air.Adults,
                Childrens: data.Air.Children,
                Babies: data.Air.Babies
            };

            genericData.Air.CiaCodes = data.Air.Destinations[0].CiaCodes;
            genericData.Air.IsRoundTrip = data.Air.IsRoundTrip;
            genericData.Air.IsOneWay = data.Air.IsOneWay;
            genericData.Air.MultiDestination = data.Air.MultiDestination;
            genericData.Air.NonStop = data.Air.NonStop;

            return genericData;
        }

        function _dettachEvents() {

        }

        function _attachEvents() {
            _dettachEvents();
        }

        function _setLiveEvents() {
            _selectComponents();

            $(component).off('click', settings.components.air.outboundCalendarIcon.selector).on('click', settings.components.air.outboundCalendarIcon.selector, _showOutBoundCalendar)
            $(component).off('click', settings.components.air.inboundCalendarIcon.selector).on('click', settings.components.air.inboundCalendarIcon.selector, _showInboundDateCalendar);
            $(component).off('click', settings.components.air.oneWay.selector).on('click', settings.components.air.oneWay.selector, _onChangeSearchType);
            $(component).off('click', settings.components.air.roundTrip.selector).on('click', settings.components.air.roundTrip.selector, _onChangeSearchType);
            $(component).off('click', settings.components.air.multiDestination.selector).on('click', settings.components.air.multiDestination.selector, _onChangeSearchType);
            $(component).off('click', settings.components.air.advancedSearch.selector).on('click', settings.components.air.advancedSearch.selector, _advancedSearch);
            $(component).off('click', settings.components.air.clearSearchParams.selector).on('click', settings.components.air.clearSearchParams.selector, thisSearchEngine.render);
            $(component).off('click', settings.components.air.addSegment.selector).on('click', settings.components.air.addSegment.selector, _onAddSegment);
            $(component).off('click', settings.components.air.removeSegment.selector).on('click', settings.components.air.removeSegment.selector, _onRemoveSegment);

            var eventChangeDate = (Global.Mobile) ? 'blur' : 'change';

            if (settings.validateAirRulesOnChange) {
                $(component).off(eventChangeDate, settings.components.air.outboundDate.selector).on(eventChangeDate, settings.components.air.outboundDate.selector, _outboundDateRules);
                $(component).off(eventChangeDate, settings.components.air.inboundDate.selector).on(eventChangeDate, settings.components.air.inboundDate.selector, _inboundDateRules);
            }

            if (!Global.Mobile) {
                $(component).off('keyup', settings.components.air.outboundDate.selector).on('keyup', settings.components.air.outboundDate.selector, Util.ForceMaskDate);
                $(component).off('keyup', settings.components.air.inboundDate.selector).on('keyup', settings.components.air.inboundDate.selector, Util.ForceMaskDate);
            }

            $(component).off(eventChangeDate, settings.components.air.outboundDate.selector).on(eventChangeDate, settings.components.air.outboundDate.selector, _dateAirRules);
        }

        function _setComponentsEvents() {
            settings.components.air.toggleAdvancedOptions.unbind("click").bind("click", _toggleAdvancedOptions);
        }

        function _dateAirRules(component) {
            var $this = component != undefined && typeof component == 'string' ? $(component) : $(this);

            _applyMinDateRules($this);

            var myDate = $this.datepickermanager("getDate") || $this.datepickermanager("option", "minDate");

            var refToCalcCheckoutMaxDate = settings.calcCheckoutMaxDateFromToday ? (new Date()) : myDate;
            var minDate = $this.datepickermanager("getDate");

            if (!minDate)
                minDate = $this.datepickermanager("option", "minDate");

            if (settings.components.air.inboundDate.not(':hidden') && !settings.components.air.inboundDate.hasClass('hide')) {
                var checkoutDaysToAdd = settings.type == "AirHotel" ? settings.maxDaysToSearchHotels : settings.maxSearchDays;
                settings.components.air.inboundDate.datepickermanager("option", "minDate", minDate)
                                                   .datepickermanager("option", "maxDate", refToCalcCheckoutMaxDate.addDays(checkoutDaysToAdd));
            }

            var filteredOutboundDate = settings.components.air.outboundDate.not(':hidden');

            var parentIndex = filteredOutboundDate.index($this);

            if (parentIndex + 1 != filteredOutboundDate.length) {
                filteredOutboundDate.eq(parentIndex + 1).datepickermanager("option", "minDate", minDate);
                _dateAirRules.call(filteredOutboundDate.eq(parentIndex + 1));
            }
        }

        function _setPesqIncConfig() {
            pesqIncConfig = {
                SearchType: Global.SearchTypes.Full,
                maxResultsClient: 15,
                maxResultsServer: 30,
                idealNumberOfProximities: 6,
                idealNumberOfProximitiesRoots: 3,
                useCacheEnhancer: true,
                onlyHalfClientResults: true,
                onDropBoxSelect: function () { },
                clientCache: Global.LocationsCache,
                useScroll: settings.useScrollOnPesqInc,
                applyStatusClasses: settings.applyStatusClassesOnPesqInc,
                applyFixedClass: settings.applyFixedClassOnPesqInc,
                controllers: {
                    locationsController: Global.LocationsController
                }
            };
        }

        function _initAir(settingsDatePicker, toHotel) {
            _setPesqIncConfig();

            var settingsDatePicker = undefined;

            var currentDate = Util.CreateAbsoluteDate();

            if (typeof settings.anotheDatePickersOption.minDate != 'undefined') {
                settingsDatePicker = {
                    numberOfMonths: (Global.Mobile) ? 1 : 2,
                    minDate: currentDate.addDays(parseInt(settings.minDaysToSearch, 10)),
                    maxDate: currentDate.addDays(parseInt(settings.maxDaysToSearch, 10))
                };
            }
            else
                settingsDatePicker = {
                    numberOfMonths: (Global.Mobile) ? 1 : 2,
                    maxDate: currentDate.addDays(parseInt(settings.maxDaysToSearch, 10))
                };

            _initAirDatePickers(settingsDatePicker);

            _initAirLocations();

            if (settings.events.afterInitialize)
                settings.events.afterInitialize(settings);
        }

        function _initAirLocations(toHotel) {
            if ($.fn.locationsFinder && settings.controllers.locationsController) {
                pesqIncConfig.CurrentProduct = Global.Product.Air;
                pesqIncConfig.IsCity = true;
                pesqIncConfig.HasIata = true;
                pesqIncConfig.useBrowserGeoLocation = false;
                pesqIncConfig.loadProximities = settings.loadProximities;
                settings.components.air.destination.locationsFinder(pesqIncConfig).click(function () { $(this).select(); });

                pesqIncConfig.useBrowserGeoLocation = settings.useBrowserGeoLocation;
                settings.components.air.origin.locationsFinder(pesqIncConfig).click(function () { $(this).select(); });
                if (settings.defaultOriginId > 0) {
                    var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(settings.defaultOriginId) });
                    if (auxLocationData.length > 0)
                        settings.components.air.origin.locationsFinder('setData', auxLocationData[0]);
                }
                if (settings.defaultDestinationId > 0) {
                    var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(settings.defaultDestinationId) });
                    if (auxLocationData.length > 0)
                        settings.components.air.destination.locationsFinder('setData', auxLocationData[0]);
                }
                if (settings.lockDestination == "true") {
                    $(settings.components.air.destination).attr("disabled", "disabled");
                }
                if (settings.defaultAirCia) {
                    $(settings.components.air.ciaCode).children("[value='" + settings.defaultAirCia + "']").prop("selected", true);
                }
                if (settings.lockAirCia == "true") {
                    $(settings.components.air.ciaCode).attr("disabled", "disabled");
                }
            }
        }

        function _initAirDatePickers(settingsDatePicker) {
            if (Global.Mobile) {
                settings.components.air.outboundDate.removeClass(settings.componentsOptions.hasDatepicker).datepickermanager('destroy');
                settings.components.air.outboundDate.datepickermanager(DatePickerOption(settingsDatePicker));
            } else {
                settings.components.air.outboundDate.removeClass(settings.componentsOptions.hasDatepicker).datepickermanager('destroy').datepickermanager(DatePickerOption(settingsDatePicker));
            }

            if (settings.events.onOutboundDateBlur)
                settingsDatePicker.onSelect = settings.events.onOutboundDateBlur;

            settingsDatePicker.minDate = settingsDatePicker.minDate.addDays(settings.minPeriodToSearch);

            settingsDatePicker.maxDate = settingsDatePicker.maxDate.addDays(settings.minPeriodToSearch);

            if (Global.Mobile) {
                settings.components.air.inboundDate.removeClass(settings.componentsOptions.hasDatepicker).datepickermanager('destroy');
                settings.components.air.inboundDate.datepickermanager(DatePickerOption(settingsDatePicker));
            } else {
                settings.components.air.inboundDate.removeClass(settings.componentsOptions.hasDatepicker).datepickermanager('destroy').datepickermanager(DatePickerOption(settingsDatePicker));;
            }
            
            _setDefaultDate(settings.defaultOutboundDate, settings.components.air.outboundDate);

            _outboundDateRules.call(settings.components.air.outboundDate.eq(0));
            _setDefaultDate(settings.defaultInboundDate, settings.components.air.inboundDate);

            if (settings.lockCheckin == "true")
                settings.components.air.outboundDate.attr("disabled", "disabled");
            if (settings.lockCheckout == "true")
                settings.components.air.inboundDate.attr("disabled", "disabled");

        }

        function _setDefaultDate(defaultDate, $component) {
            if (defaultDate) {
                var date = defaultDate.toDateValues("pt");

                if (date.isValid) {
                    $component.datepickermanager("setDate", formatter.dateValuesToDate(date));
                    $component.datepickermanager("val", formatter.dateValuesShort(date));
                }
            }
        }

        function _onChangeSearchType(event) {
            if (!$(this).hasClass("current")) {
                setTimeout(_searchAirRules, 50);
            }
        }

        function _onAddSegment(event) {
            if (event)
                event.preventDefault();
            _onAddAirSegment();
        }

        function _onRemoveSegment(event) {
            if (event)
                event.preventDefault();

            $(this).closest(settings.components.air.destinationDv).remove();
            _selectComponents(settings.components.air);
        }

        function _showOutBoundCalendar() {
            settings.components.air.outboundDate.datepickermanager("show");
        }

        function _showInboundDateCalendar() {
            settings.components.air.inboundDate.datepickermanager("show");
        }

        function _onAddAirSegment() {
            var lastSegment = settings.components.air.destinationDv.filter(':last');
            lastSegment.find(settings.components.air.outboundDate).attr('id', '');

            var lastOrigin = lastSegment.find(settings.components.air.destination).locationsFinder("getData");
            var lastOriginText = lastSegment.find(settings.components.air.destination).val();

            var clonedLastSegment = lastSegment.clone();

            var txtClonedLastSegmentOrigin;
            var txtClonedLastSegmentDestination;
            var txtClonedLastSegmentOutboundDate;

            clonedLastSegment.addClass("clonedSegment");
            clonedLastSegment.insertAfter(lastSegment);
            
            txtClonedLastSegmentOrigin = clonedLastSegment.find(settings.components.air.origin.selector, component);
            txtClonedLastSegmentDestination = clonedLastSegment.find(settings.components.air.destination.selector, component);
            txtClonedLastSegmentOutboundDate = clonedLastSegment.find(settings.components.air.outboundDate.selector, component);

            var lastIndex = settings.components.air.outboundDate.index(settings.components.air.outboundDate.last());
            _outboundDateRules.call(settings.components.air.outboundDate.eq(lastIndex));

            if ($(".removeSegment", component).length == 2) {
                clonedLastSegment.find(".removeSegment").hide();
            }
            else {
                $(".removeSegment", component).eq(1).show();
                clonedLastSegment.find(".removeSegment").show();
            }

            _selectComponents(settings.components.air);
            _initAir();

            if (lastOrigin) {
                txtClonedLastSegmentOrigin.locationsFinder("setData", lastOrigin);
                txtClonedLastSegmentOrigin.val(lastOriginText);
            }
            else {
                txtClonedLastSegmentOrigin.val("");
            }

            txtClonedLastSegmentDestination.locationsFinder("setData", {});
            txtClonedLastSegmentDestination.val("");
            txtClonedLastSegmentOutboundDate.val("");
            _dateAirRules.call(settings.components.air.outboundDate.eq(0));
        }

        function _inboundDateRules() {
            if (settings.applycorrectDateRules && settings.components.air.inboundDate.not(':hidden') && !settings.components.air.inboundDate.hasClass('hide')) {
                _applyMinDateRules(settings.components.air.inboundDate);
                _applyMaxDateRules(settings.components.air.inboundDate);
            }
        }

        function _outboundDateRules(component) {
            var $this = component != undefined && typeof component == 'string' ? $(component) : $(this);

            if (settings.applycorrectDateRules) {
                _applyMinDateRules($this);
                _applyMaxDateRules($this);
            }

            var myDate = $this.datepickermanager("getDate") || $this.datepickermanager("option", "minDate");

            var refToCalcCheckoutMaxDate = settings.calcCheckoutMaxDateFromToday ? (new Date()) : myDate;

            var minDate = $this.datepickermanager("getDate");

            if (!minDate)
                minDate = $this.datepickermanager("option", "minDate");

            if (settings.components.air.inboundDate.not(':hidden') && !settings.components.air.inboundDate.hasClass('hide')) {
                var checkoutDaysToAdd = settings.maxDaysToSearch;
                settings.components.air.inboundDate.datepickermanager("option", "minDate", minDate)
                                                   .datepickermanager("option", "maxDate", refToCalcCheckoutMaxDate.addDays(checkoutDaysToAdd));
            }

            var filteredOutboundDate = settings.components.air.outboundDate.not(':hidden');

            var parentIndex = filteredOutboundDate.index($this);

            if (parentIndex + 1 != filteredOutboundDate.length) {
                filteredOutboundDate.eq(parentIndex + 1).datepickermanager("option", "minDate", minDate);
                _outboundDateRules.call(filteredOutboundDate.eq(parentIndex + 1));
            }
        }

        function _applyMinDateRules(ctrl) {
            var myDate = ctrl.datepickermanager("getDate");
            var minDate = ctrl.datepickermanager("option", "minDate");
            var currentDateValue = ctrl.datepickermanager("val").toDateValues();

            if (!myDate)
                myDate = minDate;

            var isInvalid = (currentDateValue.isValid == false && ctrl.val() != "");

            if (myDate < minDate || isInvalid) {
                ctrl.datepickermanager('setDate', minDate);

                if (isInvalid)
                    settings.controllers.messagesController.notifyMessages(["ApplyCorrectDateRule"], settings.exhibitionType);
            }
        }

        function _applyMaxDateRules(ctrl) {
            var myDate = ctrl.datepickermanager("getDate");
            var minDate = ctrl.datepickermanager("option", "minDate");
            var maxDate = ctrl.datepickermanager("option", "maxDate");
            var currentDateValue = ctrl.datepickermanager("val").toDateValues();

            if (!myDate)
                myDate = maxDate;

            if (myDate > maxDate || (currentDateValue.isValid == false && ctrl.val() != "")) {
                ctrl.datepickermanager('setDate', minDate);

                settings.controllers.messagesController.notifyMessages(["ApplyCorrectDateRule"], settings.exhibitionType);
            }

        }

        ///////////////Funcoes acionadas ao mudar o tipo de pesquisa////////////////////////////////////////
        function _searchAirRules() {
            var isOneWay = settings.components.air.oneWay.is(":ischecked");
            var isRoundTrip = settings.components.air.roundTrip.is(":ischecked");
            var isMultiDestination = !isOneWay && !isRoundTrip ? true : false;

            _removeExtraDestinationDiv();
            _hideOrShowMultiDestinationButtons("hide");

            
            var goingText = Resources.translate({ code: 'Going' }) + ':';

            if (isOneWay) {
                _hideOrShowInBoundFields("hide");
                settings.components.air.destinationContainer.removeClass(settings.componentsOptions.air.destinationContainerRemoveClassOneWay);
                settings.components.air.destinationContainer.addClass(settings.componentsOptions.air.destinationContainerAddClassOneWay);

                if (settings.components.air.destinationContainer.parent()) {
                    settings.components.air.destinationContainer.parent().removeClass(settings.componentsOptions.air.destinationContainerRemoveClassOneWay);
                    settings.components.air.destinationContainer.parent().addClass(settings.componentsOptions.air.destinationContainerAddClassOneWay);
                }
            }
            else if (isRoundTrip) {
                _hideOrShowInBoundFields("show");
                settings.components.air.destinationContainer.removeClass(settings.componentsOptions.air.destinationContainerRemoveClassRoundTrip);
                settings.components.air.destinationContainer.addClass(settings.componentsOptions.air.destinationContainerAddClassRoundTrip);

                if (settings.components.air.destinationContainer.parent()) {
                    settings.components.air.destinationContainer.parent().removeClass(settings.componentsOptions.air.destinationContainerRemoveClassRoundTrip);
                    settings.components.air.destinationContainer.parent().addClass(settings.componentsOptions.air.destinationContainerAddClassRoundTrip);
                }
            }
            else if (isMultiDestination) {
                settings.components.air.destinationContainer.removeClass(settings.componentsOptions.air.destinationContainerRemoveClassMultiDestination);
                settings.components.air.destinationContainer.addClass(settings.componentsOptions.air.destinationContainerAddClassMultiDestination);

                if (settings.components.air.destinationContainer.parent()) {
                    settings.components.air.destinationContainer.parent().removeClass(settings.componentsOptions.air.destinationContainerRemoveClassMultiDestination);
                    settings.components.air.destinationContainer.parent().addClass(settings.componentsOptions.air.destinationContainerAddClassMultiDestination);
                }

                _hideOrShowInBoundFields("hide");
                _hideOrShowMultiDestinationButtons("show");
                _onAddAirSegment();

                goingText = Resources.translate({ code: 'Date' }) + ':';
            }

            $('.date[changetext*=true] p').html(goingText);
        }

        var _equivalentVisualAction = {
            'hide': 'addClass',
            'show': 'removeClass'
        };

        function _hideOrShowInBoundFields(action) {
            _validateHideOrShowAction(action);

            //Date
            settings.components.air.inboundDate.val("")[action]()[_equivalentVisualAction[action]]('hide');
            settings.components.air.inboundDate.parent()[action]()[_equivalentVisualAction[action]]('hide');
            settings.components.air.timeIn[action]()[_equivalentVisualAction[action]]('hide');
            //Period
            settings.components.air.periodIn[action]()[_equivalentVisualAction[action]]('hide');
            settings.components.air.periodIn.parent()[action]()[_equivalentVisualAction[action]]('hide');
        }

        function _hideOrShowMultiDestinationButtons(action) {
            _validateHideOrShowAction(action);

            settings.components.air.addSegment[action]();
            //settings.components.air.removeSegment[action]();
        }

        function _validateHideOrShowAction(action) {
            return !(action != "hide" && action != "show");
        }

        /*Remove as divs extras criadas pelo "adicionar trecho"*/
        function _removeExtraDestinationDiv() {
            settings.components.air.destinationDv.remove(".clonedSegment");
            settings.components.air.destinationDv = $(settings.components.air.destinationDv);

            _selectComponents();
        }

        ///////////////Fim das funcoes acionadas ao mudar o tipo de pesquisa////////////////////////////////////////
        function _setValidators() {
            settings.components.air.origin.addClass(settings.componentsOptions.air.origin.validatorClass);
            settings.components.air.destination.addClass(settings.componentsOptions.air.destination.validatorClass);
        }

        function _showCombos() {
            if (!settings.searchEngineTab) {
                if (settings.showCombos) {
                    settings.components.searchEngineCombos.show().next(settings.componentsOptions.comboDivisoria).show();
                    ctrl = settings.components.air.advancedSearch;
                } else {
                    settings.components.searchEngineCombos.hide().next(settings.componentsOptions.comboDivisoria).hide();
                }
            }
        }

        function _getAirRequestData(searchParameters) {
            if (searchParameters && searchParameters.Air) {
                searchParameters.Air.RequestData = {};
                searchParameters.Air.RequestData.CityPairsRequest = _getCityPairsRequest(searchParameters.Air);

                searchParameters.Air.RequestData.NumberADTs = searchParameters.Air.Adults || 0;
                searchParameters.Air.RequestData.NumberCHDs = searchParameters.Air.Children || 0
                searchParameters.Air.RequestData.NumberINFs = searchParameters.Air.Babies || 0;
                searchParameters.Air.RequestData.NumberSRCs = searchParameters.Air.Srcs || 0;

                searchParameters.Air.RequestData.BestCombinationWithSwitchAirport = searchParameters.Air.BestCombinationWithSwitchAirport;
                //searchParameters.Air.RequestData.CabinFilter = parseFloat(searchParameters.Air.CabinType);
                searchParameters.Air.RequestData.TradeType = parseFloat(searchParameters.Air.PricingTradeType);
                searchParameters.Air.RequestData.BaggageFilter = searchParameters.Air.BaggageFilter;
            }
        }

        function _getCityPairsRequest(searchParameters) {

            var cityPairs = [];

            var localCiaCodeList = [];
            var lineContainer = $(this);
            for (var s = 0; s < searchParameters.Destinations.length; s++) {
                var destinationTravel = searchParameters.Destinations[s];

                destinationTravel.NonStop = searchParameters.Destinations[0].NonStop;

                var cityPair = {
                    CiaCodeList: destinationTravel.CiaCodes,
                    NonStop: destinationTravel.NonStop
                }

                var origin = Util.GetShortIATA(destinationTravel.Origin);
                cityPair.Origin = origin == "" ? destinationTravel.Origin : origin;

                var destination = Util.GetShortIATA(destinationTravel.Destination);
                cityPair.Destination = destination == "" ? destinationTravel.Destination : destination;

                if (destinationTravel.OutboundDate) {
                    cityPair.DepartureYear = destinationTravel.OutboundDate.Year;
                    cityPair.DepartureMonth = destinationTravel.OutboundDate.Month;
                    cityPair.DepartureDay = destinationTravel.OutboundDate.Day;
                }

                cityPair.StartTime = Util.GetTreatyTime(destinationTravel.StartTimeOut, "START");
                cityPair.EndTime = Util.GetTreatyTime(destinationTravel.EndTimeOut, "END");

                //Cabin
                if (searchParameters.CabinType != "") {
                    cityPair.CabinFilter = searchParameters.CabinType;
                }

                cityPairs.push(cityPair);
            }

            if (searchParameters.IsRoundTrip) {

                var cityPairRoundTrip = {
                    CiaCodeList: localCiaCodeList,
                    NonStop: searchParameters.NonStop
                }

                if (searchParameters.Destinations[0].Destination) {
                    var origin = Util.GetShortIATA(searchParameters.Destinations[0].Destination);
                    cityPairRoundTrip.Origin = origin == "" ? searchParameters.Destinations[0].Destination : origin;
                }

                if (searchParameters.Destinations[0].Origin) {
                    var destination = Util.GetShortIATA(searchParameters.Destinations[0].Origin);
                    cityPairRoundTrip.Destination = destination == "" ? searchParameters.Destinations[0].Origin : destination;
                }

                if (searchParameters.Destinations[0].InboundDate) {
                    cityPairRoundTrip.DepartureYear = searchParameters.Destinations[0].InboundDate.Year;
                    cityPairRoundTrip.DepartureMonth = searchParameters.Destinations[0].InboundDate.Month;
                    cityPairRoundTrip.DepartureDay = searchParameters.Destinations[0].InboundDate.Day;
                }

                if (searchParameters.Destinations[0].StartTimeIn)
                    cityPairRoundTrip.StartTime = Util.GetTreatyTime(searchParameters.Destinations[0].StartTimeIn, "START");
                if (searchParameters.Destinations[0].EndTimeIn)
                    cityPairRoundTrip.EndTime = Util.GetTreatyTime(searchParameters.Destinations[0].EndTimeIn, "END");

                cityPairRoundTrip.CiaCodeList = searchParameters.Destinations[0].CiaCodes;

                cityPairs.push(cityPairRoundTrip);

                var filledCabinFilter = cityPairs.first(function (h) { return h.CabinFilter; });

                if (filledCabinFilter) {
                    cityPairs.forEach(function (x) {
                        x.CabinFilter = filledCabinFilter.CabinFilter;
                    });
                }

            }

            return cityPairs;
        }

        function _validateOutBoundMaxSearchDays(componentDatePicker, errors) {
            var periodToSearch = new Date().addDays(settings.maxDaysToSearch);

            _validateMaxSearchDays(componentDatePicker, errors, periodToSearch);
        }

        function _validateInBoundMaxSearchDays(componentDatePicker, errors) {

            var periodToSearch;

            if (settings.validateMaxSearchDaysFromCheckinDate) {
                var outBoundComponentDatePicker = settings.components.air.outboundDate;
                var dateValue = outBoundComponentDatePicker.datepickermanager("val");
                var date = formatter.dateValuesToDate(dateValue.toDateValues());
                periodToSearch = date.addDays(settings.maxDaysToSearch);
            }
            else
                periodToSearch = new Date().addDays(settings.maxDaysToSearch);


            _validateMaxSearchDays(componentDatePicker, errors, periodToSearch);
        }

        function _validateMaxSearchDays(componentDatePicker, errors, periodToSearch) {
            if (componentDatePicker.datepickermanager("getDate") && componentDatePicker.datepickermanager("getDate") > periodToSearch) {
                settings.maxDaysToSearch == 365 ? errors.push("OnSearch_NoMoreThanOneYear") : errors.push(["OnSearch_NoMoreThanXDays", settings.maxDaysToSearch]);
                componentDatePicker.datepickermanager("setDate", periodToSearch);
            }
        }

        function _getQueryStringAirDestination(data) {

            var querystring = "";

            if (data.Air.Destinations) {
                for (var i = 0; i < data.Air.Destinations.length; i++) {
                    querystring = querystring + "&Origem=" + data.Air.Destinations[i].Origin.removeDiacritics().replaceAll(" ", "%20").replaceAll("(", "%28").replaceAll(")", "%29");
                    querystring = querystring + "&Destino=" + data.Air.Destinations[i].Destination.removeDiacritics().replaceAll(" ", "%20").replaceAll("(", "%28").replaceAll(")", "%29");

                    if (data.Air.IsRoundTrip) {
                        querystring = querystring + "&Origem=" + data.Air.Destinations[i].Destination.removeDiacritics();
                        querystring = querystring + "&Destino=" + data.Air.Destinations[i].Origin.removeDiacritics();
                    }

                    var proximityId = settings.components.air.destination.getSelectedLocationIdProximity();
                    var proximityName = settings.components.air.destination.getSelectedLocationNameProximity().removeDiacritics();

                    querystring = querystring + "&Proximity=" + proximityName
                    querystring = querystring + "&ProximityId=" + (proximityName ? proximityName : 0);
                    querystring = querystring + "&Data=" + _getQueryStringDatePattern(data.Air.Destinations[i].OutboundDate);

                    if (data.Air.Destinations[i].InboundDate)
                        querystring = querystring + "&Data=" + _getQueryStringDatePattern(data.Air.Destinations[i].InboundDate);

                    if (data.Air.Destinations[i].CiaCodes.length > 0) {
                        var ciaQueryString = "&Cia=";
                        var sep = "";

                        for (var j = 0; j < data.Air.Destinations[i].CiaCodes.length; j++) {
                            ciaQueryString = ciaQueryString + sep + data.Air.Destinations[i].CiaCodes[j];
                            sep = ",";
                        }

                        querystring = querystring + ciaQueryString;
                    }

                    if (data.Air.Destinations[i].NonStop)
                        querystring += "&NonStop=" + data.Air.Destinations[i].NonStop.toString();
                }
            }

            return querystring;
        }

        function _advancedSearch() {
            var ctrl = $(this);

            if (ctrl.is(":ischecked"))
                settings.components.advancedSearchSiteForm.show();
            else
                settings.components.advancedSearchSiteForm.hide();
        }

        function _getQueryStringDatePattern(date) {
            return date.Day + '/' + date.Month + '/' + date.Year;
        }

        function _selectComponents(components) {
            if (!components)
                components = settings.components;
            Util.SelectComponents(components, component, true);
        }

        this.changeSearchType = function (newSearchType) {
            if (newSearchType != null)
                settings.searchType = newSearchType;
        };

        this.getPeriodByComponent = function ($component) {
            var rs = { StartTime: 0, EndTime: 0 };
            var isCustomElement = $component.hasClass("multi_options") ? true : false;
            var componentValue = isCustomElement ? $component.getSelectedValue() : $component.val();

            if (!componentValue) {
                return rs;
            }

            var timeValues = {
                Morning: { StartTime: 6, EndTime: 12 },
                Afternoon: { StartTime: 12, EndTime: 18 },
                Night: { StartTime: 18, EndTime: 24 },
                Dawn: { StartTime: 0, EndTime: 6 }
            };

            switch (componentValue) {
                case "Morning":
                case "Afternoon":
                case "Night":
                case "Dawn":
                    rs = timeValues[componentValue];
                    break;
                case "0":
                    rs.StartTime = 0;
                    rs.EndTime = 1;
                    break;
                default:
                    componentValue = parseInt(componentValue);
                    rs.StartTime = componentValue - 1;
                    rs.EndTime = componentValue + 1;
            }
            return rs;
        };

        function _toggleAdvancedOptions() {
            settings.components.air.advancedOptionsContainer.toggleClass("opened");
        }

        function _sendGtagEvents(searchParameters) {
            var airSearchParameters = searchParameters.Air;                        
            
            _sendGtagSelectOutboundPeriodEvent(airSearchParameters);
            _sendGtagSelectInboundPeriodEvent(airSearchParameters);
            _sendGtagSelectCiaEvent(airSearchParameters);
            _sendGtagSelectCabinEvent(airSearchParameters);
            _sendGtagSelectBaggageEvent(airSearchParameters);
            _sendGtagCheckNonStopEvent(airSearchParameters);
            _sendGtagSearchEvent(airSearchParameters);
        }

        function _sendGtagSelectOutboundPeriodEvent(airSearchParameters, useCustomLabel) {
            var destinations = airSearchParameters.Destinations;
            var outboundPeriodSelected;
            
            if (destinations.length) {
                if (airSearchParameters.MultiDestination) {
                    var concatenatedPeriods = destinations
                    .map(function(d){
                        if (d.StartTimeOut != 0 || d.EndTimeOut != 0) {
                            return {
                                StartTime: d.StartTimeOut,
                                EndTime: d.EndTimeOut
                            };                        
                        }
                    })
                    .filter(function(e) {
                        return e != undefined;
                    })
                    .reduce(function(acc, cur, index) {
                        var periond = _getPeriodByStartAndEndValues(cur);
                        return Util.ConcatenateStringSeparatedBy("/", acc, periond, index);
                    }, '');
    
                    if (concatenatedPeriods) 
                        outboundPeriodSelected = 'Multi-trechos ' + destinations.length + ' - ' + concatenatedPeriods;
                } else {
                    var outboundPeriodObj = {
                        StartTime: destinations[0].StartTimeOut,
                        EndTime: destinations[0].EndTimeOut
                    };
    
                    if (outboundPeriodObj.StartTime == 0 && outboundPeriodObj.EndTime == 0) 
                        return;
    
                    var outboundPeriodSelected = _getPeriodByStartAndEndValues(outboundPeriodObj);
                }
            }

            if (outboundPeriodSelected) {
                var gtagEventLabel;

                if (useCustomLabel) 
                    gtagEventLabel = outboundPeriodSelected + ' - ' + _rootSystemAccountInfo;

                Util.SendGtagEvent('select_outboundPeriod', _gtagEventCategory, gtagEventLabel);
            }        
        }

        function _sendGtagSelectInboundPeriodEvent(airSearchParameters, useCustomLabel) {
            var destinations = airSearchParameters.Destinations;
            var inboundPeriodSelected;
            
            if (destinations.length && airSearchParameters.IsRoundTrip) {
                var inboundPeriodObj = {
                    StartTime: destinations[0].StartTimeIn,
                    EndTime: destinations[0].EndTimeIn
                };

                if (inboundPeriodObj.StartTime == 0 && inboundPeriodObj.EndTime == 0) 
                    return;                

                var inboundPeriodSelected = _getPeriodByStartAndEndValues(inboundPeriodObj);
            }

            if (inboundPeriodSelected) {
                var gtagEventLabel;
                
                if (useCustomLabel) 
                    gtagEventLabel = inboundPeriodSelected + ' - ' + _rootSystemAccountInfo;

                Util.SendGtagEvent('select_inboundPeriod', _gtagEventCategory, gtagEventLabel);   
            }
        }
        
        function _sendGtagSelectCiaEvent(airSearchParameters, useCustomLabel) {
            var destinations = airSearchParameters.Destinations;
            var ciaCodeSelected;
            
            if (destinations.length) {
                if (airSearchParameters.MultiDestination) {                
                    var listOfCiaCodesInStr = destinations.reduce(function(acc, destination, index) {
                        // Funciona pegar sÃ³ o primeiro item pois no v2 nosso motor sÃ³ permite a seleÃ§Ã£o de UMA ciaCode por trecho
                        // Se for implementado um multiple select deve-se iterar pela lista CiaCodes
                        var ciaCode = destination.CiaCodes[0];
                        return Util.ConcatenateStringSeparatedBy("/", acc, ciaCode, index);
                    }, '');
    
                    if (listOfCiaCodesInStr) {
                        ciaCodeSelected = 'Multi-trechos ' + destinations.length + ' - ' + listOfCiaCodesInStr;
                    }
                } else {
                    var ciaCodeSelected = destinations[0].CiaCodes[0];
                }
            }

            if (ciaCodeSelected) {
                var gtagEventLabel;
                
                if (useCustomLabel)
                    gtagEventLabel = ciaCodeSelected + ' - ' + _rootSystemAccountInfo;

                Util.SendGtagEvent('select_ciaCode', _gtagEventCategory, gtagEventLabel);   
            }
        }

        function _sendGtagSelectCabinEvent(airSearchParameters, useCustomLabel) {
            var destinations = airSearchParameters.Destinations;
            var cabinType;
            var cabinTypesLabel = {
                "0": "Primeira classe",
                "1": "Executiva",
                "2": "EconÃ´mica",
                "3": "EconÃ´mica premium",
            };
            
            if (destinations.length) {
                if (airSearchParameters.MultiDestination) {
                    var listOfCabinTypesInStr = destinations.reduce(function(acc, destination, index) {
                        var cabinType = destination.CabinFilter;
                        
                        if (cabinType) {
                            var cabinTypeLabel = cabinTypesLabel[cabinType];
                            return Util.ConcatenateStringSeparatedBy("/", acc, cabinTypeLabel, index);
                        }
                        
                        return acc;         
                    }, '');
    
                    if (listOfCabinTypesInStr) {
                        cabinType = 'Multi-trechos ' + destinations.length + ' - ' + listOfCabinTypesInStr;
                    }
                } else if (destinations[0].CabinFilter) {
                    cabinType = cabinTypesLabel[destinations[0].CabinFilter];
                }      
            }

            if (cabinType) {
                var gtagEventLabel;

                if (useCustomLabel) 
                    gtagEventLabel = cabinType + ' - ' + _rootSystemAccountInfo;
                
                Util.SendGtagEvent('select_cabinType', _gtagEventCategory, gtagEventLabel);   
            }
        }

        function _sendGtagSelectBaggageEvent(airSearchParameters, useCustomLabel) {
            if (airSearchParameters.BaggageFilter != "0") {
                var gtagEventLabel;

                if (useCustomLabel) {                    
                    var baggageFilterLabels = {
                        "1": "Com bagagem",
                        "2": "Sem bagagem"
                    };
                    gtagEventLabel = baggageFilterLabels[airSearchParameters.BaggageFilter] + ' - ' + _rootSystemAccountInfo;
                }

                Util.SendGtagEvent('select_baggageFilter', _gtagEventCategory, gtagEventLabel);   
            }
        }

        function _sendGtagCheckNonStopEvent(airSearchParameters) {
            if (airSearchParameters.NonStop) 
                Util.SendGtagEvent('select_nonStop', _gtagEventCategory);
        }

        function _sendGtagSearchEvent(airSearchParameters, useCustomLabel) {
            var gtagEventLabel;

            if (useCustomLabel) {
                var tripType = _getTripTypeBySearchAirSearchParameters(airSearchParameters);
                var searchType = _getSearchTypeByAirSearchParameters(airSearchParameters);
                var destinations = _getDestinationByAirSearchParameters(airSearchParameters);
                gtagEventLabel = tripType + ' - ' + (searchType ? searchType + ' - ' : '' ) + (destinations ? destinations + ' - ' : '' ) + _rootSystemAccountInfo;
            }

            Util.SendGtagEvent('search', _gtagEventCategory, gtagEventLabel);
        }

        function _getTripTypeBySearchAirSearchParameters(airSearchParameters) {
            var tripOptions = {
                oneWay: "Somente ida",
                roundTrip: "Ida e volta",
                multiDestination: "Multi-trechos"
            };
            var isOneWay = airSearchParameters.IsOneWay;
            var isRoundTrip = airSearchParameters.IsRoundTrip;
            var tripType = isOneWay ? tripOptions.oneWay : (isRoundTrip ? tripOptions.roundTrip : tripOptions.multiDestination);

            if (tripType === tripOptions.multiDestination)
                tripType = _appendNumberOfDestinations(tripType, airSearchParameters.Destinations.length);

            return tripType;
        }

        function _appendNumberOfDestinations(str, number) {
            return str + ' ' + number;
        }

        function _getSearchTypeByAirSearchParameters(airSearchParameters) {
            var searchTypeOptions = {
                "0": "PreÃ§o + horÃ¡rio",
                "2": "HorÃ¡rio",
                "3": "PreÃ§o",
            }

            return searchTypeOptions[airSearchParameters.SearchType] || '';
        }

        function _getDestinationByAirSearchParameters(airSearchParameters) {
            var destinationsList = airSearchParameters.Destinations;
            var destinationsIds;
            
            if (airSearchParameters.IsRoundTrip || airSearchParameters.IsOneWay) {
                destinationsIds = destinationsList[0].DestinationData.id;
            } else {
                destinationsIds = destinationsList.reduce(function (acc, cur, index) {
                    return Util.ConcatenateStringSeparatedBy("/", acc, cur.DestinationData.id, index);
                }, "");
            }

            return destinationsIds || "";
        }

        function _getPeriodByStartAndEndValues(periodObj) {
            var periodSelected;
            
            if (periodObj.StartTime == 6 && periodObj.EndTime == 12)
                periodSelected = "Morning";
            else if (periodObj.StartTime == 12 && periodObj.EndTime == 18)
                periodSelected = "Afternoon";
            else if (periodObj.StartTime == 18 && periodObj.EndTime == 24)
                periodSelected = "Night";
            else if (periodObj.StartTime == 0 && periodObj.EndTime == 6)
                periodSelected = "Dawn";
            else if (periodObj.StartTime == 0 && periodObj.EndTime == 1)
                periodSelected = "0";
            else periodSelected = parseInt(periodObj.StartTime) + 1;

            return periodSelected;
        }
    }

    $.fn.airSearchEngine = function () {
        return Util.pluginDefaultBehavior(this, "airSearchEngine", arguments, function () { return new AirSearchEngine() });
    }

})(jQuery);

ï»¿/// <reference path="../../Libraries/Util.js" />
/// <reference path="../../Libraries/DatePickerOption.js" />
/// <reference path="../../Libraries/Jquery.js" />

(function ($) {

    function BusSearchEngine() {
        var component = undefined;
        var settings = {
            data: {},
            template: undefined,
            templateOptions: {},
            showCombos: false,
            idealAmountResults: 150,
            includeAirportsChildren: false,
            searchEngineTab: false,
            validateMaxSearchDaysFromCheckinDate: false,
            minDaysToSearch: 3,
            maxDaysToSearch: 365,
            minPeriodToSearch: 3,
            calcCheckoutMaxDateFromToday: false,
            maxBabies: 0,
            maxChildren: 0,
            maxAdults: 0,
            maxPassengers: 999999,
            useScrollOnPesqInc: false,
            applyStatusClassesOnPesqInc: true,
            applyFixedClassOnPesqInc: false,
            applycorrectDateRules: true,
            useBrowserGeoLocation: true,
            anotheDatePickersOption: {
                minDate: 0
            },
            controllers: {
                messagesController: undefined,
                locationsController: undefined
            },
            events: {
                afterInitialize: undefined
            },
            components: {
                bus: {
                    origin: '.txtOrigin',
                    destination: '.txtDestination',
                    inboundDate: '.txtInboundDate',
                    inboundCalendarIcon: '.inboundCalendarIcon',
                    outboundDate: '.txtOutboundDate',
                    outboundCalendarIcon: '.outboundCalendarIcon',
                    inboundPeriod: '.drpPeriodInbound',
                    outboundPeriod: '.drpPeriodOutbound',
                    //adults: '.drpAdultsQtd',
                    //children: '.drpChildrenQtd',
                    //babies: '.drpBabiesQtd',
                    //srcs: '.dropSrcQtd',
                    nonStop: '.chkNonStop',
                    oneWay: '.chkOneWay',
                    multiDestination: '.chkMultiDestination',
                    roundTrip: '.chkRoundTrip',
                    timeOut: '.drpTimeOut',
                    timeIn: '.drpTimeIn',
                    periodIn: '.sltPeriodIn',
                    periodOut: '.sltPeriodOut',
                    outboundLabel: ".outboundLabel",
                    searchType: '.sltSearchType',
                    ciaCode: '.drpCiaCode',
                    baggageFilter: '#drpBaggageFilter',
                    cabinType: '.drpCabin',
                    pricingTradeType: '.drpPricingTradeType',
                    advancedSearch: '.chkAdvancedSearch',
                    destinationContainer: '.destinationContainer',
                    addSegment: '.addSegmentLink',
                    removeSegment: '.removeSegment',
                    destinationDv: '.destinationDiv',
                    searchForPackageComposition: '.searchForPackageComposition',
                    clearSearchParams: '.clearSearchParams',
                    advancedOptionsContainer: '.advanced',
                    advancedOptionsContainerSettings: '.advanced.settings',
                    toggleAdvancedOptions: '.toggleAdvancedSearch',
                },
                searchEngineInboundDate: '.search-engine-inbound-date',
                searchEngineInboundHour: '.search-engine-inbound-hour',
                siteForm: '.site-form-volta',
                advancedSearchSiteForm: '.site-form-busca-avancada',
                searchEngineCombos: '#combos'
            },
            componentsOptions: {
                hasDatepicker: 'hasDatepicker',
                comboBoxClass: 'multi_options',
                comboDivisoria: '.Motor_Divisoria',
                updateValueCompleteClass: 'autocomplete_completed',
                customCheckedClass: 'current',
                bus: {
                    destinationContainerAddClassOneWay: 'oneWay',
                    destinationContainerAddClassRoundTrip: 'roundTrip',
                    destinationContainerAddClassMultiDestination: 'multiDestination',
                    destinationContainerRemoveClassOneWay: 'roundTrip multiDestination',
                    destinationContainerRemoveClassRoundTrip: 'oneWay multiDestination',
                    destinationContainerRemoveClassMultiDestination: 'oneWay roundTrip',
                    origin: {
                        validatorClass: 'just-letters-for-locations'
                    },
                    destination: {
                        validatorClass: 'just-letters-for-locations'
                    }
                }
            },
            exhibitionType: undefined,
            searchType: 1,
            validateBusRulesOnChange: true,
            defaultOriginId: 0,
            defaultDestinationId: 0,
            defaultOutboundDate: undefined,
            defaultInboundDate: undefined,
            loadProximities: false
        };
        var pesqIncConfig = {};
        var thisSearchEngine = this;
        var isInternationalBusSearch = false;
        var _gtagEventCategory = "Motor de rodoviario";
        var _rootSystemAccountInfo = Util.GetRootSystemAccountInfo();
        var _functions = {
            components: {
                setCiaCodes: function (destination, ciaCodeComponent) {
                    if (destination != undefined && ciaCodeComponent != undefined && typeof ciaCodeComponent !== 'string') {
                        var ciaCodes = [];

                        if (Util.HasCount(destination.CiaCodes)) {
                            ciaCodes = ciaCodes.concat(destination.CiaCodes);
                        }

                        if (!ciaCodeComponent.hasClass('multi_options'))
                            ciaCodeComponent.val(ciaCodes);
                        else
                            ciaCodeComponent.setSelectedValue(ciaCodes);
                    }
                },
                setDate: function (dateValue, component, dateRules, selector) {
                    if (selector.length == 0)
                        selector = undefined;

                    if (dateValue != undefined && component != undefined) {
                        component
                            .datepickermanager("setDate", formatter.dateValuesToDate(dateValue))
                            .datepickermanager("val", formatter.dateValuesShort(dateValue));

                        if (settings.validateBusRulesOnChange && dateRules != undefined)
                            if (component)
                                dateRules.call(component)
                            else
                                dateRules(selector);
                    }

                },
                setLocation: function (iata, component) {
                    if (iata != undefined && component != undefined && typeof component !== 'string') {
                        var location = _functions.locations.loadLocationsFromCacheByIata(iata);

                        if (location) {
                            component.locationsFinder("setData", location);
                        } else {
                            component.val(iata);
                        }
                    }
                },
                setNonStop: function (value, component) {
                    if (value != undefined && component != undefined) {
                        component.setCheck(value);
                    }
                },
                setOriginAndDestination: function (destination, originComponent, destinationComponent) {
                    if (destination != undefined && originComponent != undefined && destinationComponent != undefined) {
                        if (destination.OriginData != undefined) {
                            originComponent.locationsFinder("setData", destination.OriginData);
                        }
                        else {
                            _functions.components.setLocation(destination.Origin, originComponent);
                        }

                        if (destination.DestinationData != undefined) {
                            destinationComponent.locationsFinder("setData", destination.DestinationData);
                        }
                        else {
                            _functions.components.setLocation(destination.Destination, destinationComponent);
                        }
                    }
                },
            },
            locations: {
                loadLocationFromCacheById: function(id){
                    if (id != undefined){
                        var location = Global.LocationsCache.first(function (loc) { return loc != undefined && loc.id == id });

                        if (location == undefined) {
                            var loadByIataUrl = Global.WebCommonPath + "Handlers/LocationsCache.ashx?" + "culture=" + Global.Culture + "&locId=" + id;

                            $.getScript(loadByIataUrl, function (resp) {
                                if (resp) {
                                    (new Function(resp))();

                                    location = Global.LocationsCache.first(function (l) { return l != undefined && l.id == id });
                                }
                            });
                        }

                        return location;
                    }
                    
                    return undefined;
                },
                loadLocationsFromCacheByIata: function (iata) {
                    if (iata != undefined && Util.isString(iata) && iata.length == 3 && Global.LocationsCache) {
                        var location = Global.LocationsCache.first(function (loc) { return loc != undefined && loc.i == iata });

                        if (location == undefined) {
                            var loadByIataUrl = Global.WebCommonPath + "Handlers/LocationsCache.ashx?" + "culture=" + Global.Culture + "&iata=" + iata;

                            $.getScript(loadByIataUrl, function (resp) {
                                if (resp) {
                                    (new Function(resp))();

                                    location = Global.LocationsCache.first(function (l) { return l != undefined && l.i == origin });
                                }
                            });
                        }

                        return location;
                    }

                    return undefined;
                },
                loadLocationsFromCacheByName: function (name) {
                    if (name != undefined && Util.isString(name) && Util.HasCount(Global.LocationsCache)) {
                        var location = Global.LocationsCache.first(function (loc) { return loc != undefined && loc.n == name });

                        if (location == undefined) {
                            var loadByIataUrl = Global.WebCommonPath + "Handlers/LocationsCache.ashx?" + "culture=" + Global.Culture + "&iata=" + name;

                            $.getScript(loadByIataUrl, function (resp) {
                                if (resp) {
                                    (new Function(resp))();

                                    location = Global.LocationsCache.first(function (l) { return l != undefined && l.n == name });
                                }
                            });
                        }

                        return location;
                    }

                    return undefined;
                },
            },
            queryString: {
                auxiliar: {
                    get: function (key, queryString) {
                        var value = Util.QueryString(key, queryString);

                        return value != undefined && value != ""
                            ? value
                            : undefined;
                    },
                },
                destination: {
                    getCiaCodes: function (destination, queryString, destinationIndex) {
                        if (destinationIndex == undefined)
                            destinationIndex = 0;

                        var ciaCode = Util.QueryString("Cia", queryString, destinationIndex);

                        if (ciaCode != undefined) {
                            if (ciaCode.indexOf(",") >= 0)
                                destination.CiaCodes = ciaCode.split(",");
                            else
                                destination.CiaCodes.push(ciaCode);
                        }
                    },
                    getDates: function (destination, queryString, destinationIndex) {
                        if (destinationIndex == undefined)
                            destinationIndex = 0;

                        var outboundDate = Util.QueryString("Data", queryString, destinationIndex) || Util.QueryString("DataIda", queryString);
                        var inboundDate = Util.QueryString("Data", queryString, (++destinationIndex)) || Util.QueryString("DataVolta", queryString);
                        var nonStopQueryStringFilter = Util.QueryString("NonStop", queryString);
                        var startTimeOutQueryStringFilter = Util.QueryString("Hora", queryString, destinationIndex);
                        var startTimeInQueryStringFilter = Util.QueryString("Hora", queryString, (++destinationIndex));

                        destination.OutboundDate = outboundDate.toDateValues("pt");

                        if (inboundDate != undefined)
                            destination.InboundDate = inboundDate.toDateValues("pt");

                        destination.NonStop = nonStopQueryStringFilter == "1" || nonStopQueryStringFilter == "true";

                        destination.StartTimeOut = startTimeOutQueryStringFilter;
                        destination.EndTimeOut = startTimeOutQueryStringFilter;

                        destination.StartTimeIn = startTimeInQueryStringFilter;
                        destination.EndTimeIn = startTimeInQueryStringFilter;
                    },
                    getNonStop: function (destination, queryString, destinationIndex) {
                        if (destinationIndex == undefined)
                            destinationIndex = 0;

                        var nonStop = Util.QueryString("NonStop", queryString, destinationIndex);

                        destination.NonStop = nonStop || false;
                    },
                    getOriginAndDestination: function (destination, queryString) {
                        destination.OriginData = destination.Origin;
                        destination.DestinationData = destination.Destination;

                        if (Global.LocationsCache && Global.LocationsCache.length > 0) {
                            destination.OriginData = _functions.queryString.destination.getLocationData(destination.OriginId, destination.Origin);
                            destination.DestinationData = _functions.queryString.destination.getLocationData(destination.DestinationId, destination.Destination);
                        }

                        if (destination.Origin.length == 3)
                            destination.Origin = destination.Origin.toUpperCase();

                        if (destination.Destination.length == 3)
                            destination.Destination = destination.Destination.toUpperCase();
                        
                        if (!destination.DestinationData)
                            destination.DestinationData = { id: destination.DestinationId, n: destination.Destination };

                        if (!destination.OriginData)
                            destination.OriginData = { id: destination.OriginId, n: destination.Origin };
                        
                    },
                    getLocationData: function(locationId, locationName){
                        if (locationId != undefined && Util.isValidNumber(locationId))
                            return _functions.locations.loadLocationFromCacheById(locationId);
                        else if (locationName.length == 3)
                            return _functions.locations.loadLocationsFromCacheByIata(locationName);
                        else
                            return _functions.locations.loadLocationsFromCacheByName(locationName)
                    }
                },
                getBaggageFilter: function (searchParameters, queryString) {
                    searchParameters.Bus.BaggageFilter = _functions.queryString.auxiliar.get("Baggage", queryString);
                },
                getCabinTypeFilter: function (searchParameters, queryString) {
                    searchParameters.Bus.CabinType = _functions.queryString.auxiliar.get("Cabine", queryString);
                },
                getDestinationData: function (searchParameters, queryString) {
                    var quantityOfDestinations = !searchParameters.Bus.MultiDestination
                        ? "1"
                        : Util.QueryString("DestQtd", queryString) || "0";

                    quantityOfDestinations = !Util.isValidNumber(quantityOfDestinations)
                        ? 0
                        : parseInt(quantityOfDestinations);

                    for (destinationIndex = 0; destinationIndex < quantityOfDestinations; destinationIndex++) {
                        var destinationToPush = {
                            CiaCodes: [],
                            Destination: Util.QueryString("Destino", queryString, destinationIndex).replaceAll("%20", " ").replaceAll("---", ")").replaceAll("--", "("),
                            DestinationId: Util.QueryString("DestinoId", queryString, destinationIndex),
                            DestinationData: undefined,
                            EndTimeIn: undefined,
                            EndTimeOut: undefined,
                            InboundDate: undefined,
                            NonStop: false,
                            Origin: Util.QueryString("Origem", queryString, destinationIndex).replaceAll("%20", " ").replaceAll("---", ")").replaceAll("--", "("),
                            OriginId: Util.QueryString("OrigemId", queryString, destinationIndex),
                            OriginData: undefined,
                            OutboundDate: undefined,
                            StartTimeIn: undefined,
                            StartTimeOut: undefined,
                        };

                        _functions.queryString.destination.getOriginAndDestination(destinationToPush, queryString);
                        _functions.queryString.destination.getDates(destinationToPush, queryString, destinationIndex);
                        _functions.queryString.destination.getCiaCodes(destinationToPush, queryString, destinationIndex);
                        _functions.queryString.destination.getNonStop(destinationToPush, queryString, destinationIndex);

                        searchParameters.Bus.Destinations.push(destinationToPush);
                    }
                },
                getFlightTypeData: function (searchParameters, queryString) {
                    var multiDestinationQueryStringValue = Util.QueryString("Multi", queryString);

                    if (multiDestinationQueryStringValue != undefined) {
                        searchParameters.Bus.MultiDestination = (multiDestinationQueryStringValue == 1 || multiDestinationQueryStringValue == "true");
                    } else {
                        var roundTripQueryStringValue = Util.QueryString("RoundTrip", queryString);
                        var oneWayQueryStringValue = Util.QueryString("SomenteIda", queryString);

                        if (roundTripQueryStringValue != undefined)
                            searchParameters.Bus.IsRoundTrip = (roundTripQueryStringValue == 1 || roundTripQueryStringValue == "true");
                        else
                            searchParameters.Bus.IsRoundTrip = !(oneWayQueryStringValue == 1 || oneWayQueryStringValue == "true");
                    }
                },
                getNonStopFilter: function (searchParameters, queryString) {
                    searchParameters.Bus.NonStop = _functions.queryString.auxiliar.get("NonStop", queryString);
                },
                // getPassengerData: function (searchParameters, queryString) {
                //     searchParameters.Bus.Adults = _functions.queryString.auxiliar.get("NumADT", queryString) || 0;
                //     searchParameters.Bus.Children = _functions.queryString.auxiliar.get("NumCHD", queryString) || 0;
                //     searchParameters.Bus.Babies = _functions.queryString.auxiliar.get("NumINF", queryString) || 0;
                // },
                getIsRoundTrip: function (searchParameters, queryString) {
                    var roundTrip = _functions.queryString.auxiliar.get("RoundTrip", queryString);

                    searchParameters.Bus.IsRoundTrip = (roundTrip == 1);
                },
            },
        };

        this.initialize = function (target, opts) {

            component = $(target);

            $.extend(true, settings, opts || {});

            _attachEvents();

            _setLiveEvents();
        }

        this.render = function () {
            _selectComponents();

            component.html(settings.template(settings));

            if (settings.events.posRender)
                settings.events.posRender(settings);

            _selectComponents();

            _initBus();

            _setValidators();

            _showCombos();

            _setComponentsEvents();

            settings.components.bus.clearSearchParams.show();
        }

        this.setOptions = function (options) {
            $.extend(true, settings, options);
        }

        this.getData = function () {

            var searchParameters = {};

            searchParameters.CompanyId = 0;

            searchParameters.Bus = {};

            // if (settings.components.bus.roundTrip.length)
            //     searchParameters.Bus.IsRoundTrip = settings.components.bus.roundTrip.is(":ischecked");
            // else
            //     searchParameters.Bus.IsRoundTrip = settings.components.bus.inboundDate && settings.components.bus.inboundDate.datepickermanager("val") && settings.components.bus.inboundDate.datepickermanager("val").length;

            // searchParameters.Bus.MultiDestination = settings.components.bus.multiDestination.is(":ischecked");

            searchParameters.Bus.IsOneWay = settings.components.bus.oneWay.is("ischecked") || settings.components.bus.oneWay.hasClass(settings.componentsOptions.customCheckedClass);

            // if (settings.components.bus.nonStop && settings.components.bus.nonStop.length)
            //     searchParameters.Bus.NonStop = Util.IsChecked(settings.components.bus.nonStop);

            var origin = "";
            var destination = "";
            searchParameters.Bus.Destinations = [];

            var citiPairItens = settings.components.bus.destinationDv;
            isInternationalBusSearch = false;

            var index = 0;

            citiPairItens.each(function () {
                var currentCityPair = $(this);
                var destinationTravel = {};

                if (currentCityPair.length > 1) {
                    currentCityPair = $(currentCityPair[index]);
                }

                if ($.fn.locationsFinder) {
                    origin = currentCityPair.find(settings.components.bus.origin[index]).locationsFinder("getData");
                    destinationTravel.Origin = origin && origin.i ? origin.i : currentCityPair.find(settings.components.bus.origin[index]).val();

                    if (origin && origin["in"]) isInternationalBusSearch = true;
                    destination = currentCityPair.find(settings.components.bus.destination[index]).locationsFinder("getData");
                    destinationTravel.Destination = destination && destination.i ? destination.i : currentCityPair.find(settings.components.bus.destination[index]).val();
                    if (destination && destination["in"]) isInternationalBusSearch = true;
                }
                else {
                    origin = currentCityPair.find(settings.components.bus.origin[index]).val();
                    destinationTravel.Origin = origin;

                    destination = currentCityPair.find(settings.components.bus.destination[index]).val();
                    destinationTravel.Destination = destination;
                }

                destinationTravel.OriginData = origin;
                destinationTravel.DestinationData = destination;

                if (destinationTravel.Origin.length == 3)
                    destinationTravel.Origin = destinationTravel.Origin.toUpperCase();

                if (destinationTravel.Destination.length == 3)
                    destinationTravel.Destination = destinationTravel.Destination.toUpperCase();

                var outboundDate = currentCityPair.find(settings.components.bus.outboundDate[index], currentCityPair).datepickermanager("val");
                if (!outboundDate || !outboundDate.length)
                    outboundDate = currentCityPair.parent().find(settings.components.bus.outboundDate[index], currentCityPair).datepickermanager("val");

                if (outboundDate)
                    destinationTravel.OutboundDate = outboundDate.toDateValues();

                var inboundDateField = currentCityPair.find(settings.components.bus.inboundDate[index], currentCityPair);
                if (!searchParameters.Bus.MultiDestination && (!inboundDateField || !inboundDateField.length))
                    inboundDateField = currentCityPair.parent().find(settings.components.bus.inboundDate[index], currentCityPair);

                if (!searchParameters.Bus.MultiDestination && inboundDateField && inboundDateField.length) {
                    var inboundDate = inboundDateField.datepickermanager("val");
                    if (inboundDate)
                        destinationTravel.InboundDate = inboundDate.toDateValues();
                }

                destinationTravel.NonStop = currentCityPair.find(settings.components.bus.nonStop).length == 0
                    ? Util.IsChecked(settings.components.bus.nonStop)
                    : currentCityPair.find(settings.components.bus.nonStop).is(":checked");

                //Periodo selecionado
                var periodInboundComponent = currentCityPair.find(settings.components.bus.inboundPeriod);
                var periodOutboundComponent = currentCityPair.find(settings.components.bus.outboundPeriod);
                var periodInbound = thisSearchEngine.getPeriodByComponent(periodInboundComponent);
                var periodOutbound = thisSearchEngine.getPeriodByComponent(periodOutboundComponent);

                destinationTravel.StartTimeIn = periodInbound.StartTime;
                destinationTravel.EndTimeIn = periodInbound.EndTime;
                destinationTravel.StartTimeOut = periodOutbound.StartTime;
                destinationTravel.EndTimeOut = periodOutbound.EndTime;

                _setCiaCodes(destinationTravel, searchParameters, currentCityPair);

                if (settings.components.bus.pricingTradeType)
                    destinationTravel.PricingTradeType = currentCityPair.find(settings.components.bus.pricingTradeType).eq(0).val();

                //Cabin
                destinationTravel.CabinFilter = Util.GetComponentValue(currentCityPair.find(settings.components.bus.cabinType));

                searchParameters.Bus.Destinations.push(destinationTravel);
                index++;
            });

            searchParameters.Bus.BusStationPairsRequest = _getBusStationPairRequest(searchParameters.Bus);
            
            // searchParameters.Bus.Adults = parseInt(Util.GetComponentValue(settings.components.bus.adults));
            // searchParameters.Bus.Children = parseInt(Util.GetComponentValue(settings.components.bus.children));
            // searchParameters.Bus.Babies = parseInt(Util.GetComponentValue(settings.components.bus.babies));
            // searchParameters.Bus.Srcs = parseInt(Util.GetComponentValue(settings.components.bus.srcs));

            // if (isNaN(searchParameters.Bus.Adults) && isNaN(searchParameters.Bus.Srcs) && isNaN(searchParameters.Bus.Children))
            //     searchParameters.Bus.Adults = 1;
            //
            // if (settings.components.bus.cabinType)
            //     searchParameters.Bus.CabinType = settings.components.bus.cabinType.val();
            //
            // if (settings.components.bus.baggageFilter)
            //     searchParameters.Bus.BaggageFilter = settings.components.bus.baggageFilter.val();

            // if (settings.components.bus.searchType.length != 0)
            //     searchParameters.Bus.SearchType = settings.components.bus.searchType.val();
            // else
            //     searchParameters.Bus.SearchType = settings.searchType;
            //
            // if (searchParameters.Bus.SearchType == 0 && isInternationalBusSearch) {
            //     searchParameters.Bus.SearchType = 3;
            //     var func = function () { alert(Util.GetInterfaceMessage("InternationalSearch")); };
            //     setTimeout(func, 500);
            // }

            // searchParameters.Bus.isInternationalBusSearch = isInternationalBusSearch;

            // searchParameters.SearchForPackageComposition = Util.IsChecked(settings.components.bus.searchForPackageComposition);

            // _getBusRequestData(searchParameters);
            
            if (Util.IsAbleToSendGtagEvents(_rootSystemAccountInfo))
                _sendGtagEvents(searchParameters);

            return searchParameters;
        }

        function _setCiaCodes(destinationTravel, searchParameters, currentCityPair) {
            destinationTravel.CiaCodes = [];
            if (settings.components.bus.ciaCode) {
                var ciaCode;
                var ciaCodeComponentValue;

                if (searchParameters.Bus.MultiDestination) {
                    ciaCodeComponentValue = Util.GetComponentValue(currentCityPair.find(settings.components.bus.ciaCode));
                }
                else {
                    ciaCodeComponentValue = Util.GetComponentValue(settings.components.bus.ciaCode);
                }

                if (ciaCodeComponentValue != "") {
                    ciaCode = ciaCodeComponentValue;
                }

                if (ciaCode && ciaCode != "") {
                    if (ciaCode.indexOf(",") >= 0)
                        destinationTravel.CiaCodes = ciaCode.split(",");
                    else
                        destinationTravel.CiaCodes.push(ciaCode);
                }
            }
        };

        this.updateValues = function (searchParameters) {
            if (searchParameters) {

                var adults = 1, babies = 0, childrens = 0;

                // if (searchParameters.ConsumerSummary) {
                //     adults = searchParameters.ConsumerSummary.Adults;
                //     babies = searchParameters.ConsumerSummary.Babies;
                //     childrens = searchParameters.ConsumerSummary.Childrens;
                // }
                //
                // if (searchParameters.getConsumerTotals) {
                //     var consumerTotals = searchParameters.getConsumerTotals();
                //
                //     if (consumerTotals && (consumerTotals.Adults != adults || consumerTotals.Babies != babies || consumerTotals.Childrens != childrens)) {
                //         adults = consumerTotals.Adults <= settings.maxPassengers ? consumerTotals.Adults : settings.maxPassengers;
                //         childrens = consumerTotals.Childrens <= settings.maxChildren ? consumerTotals.Childrens : settings.maxChildren;
                //         babies = consumerTotals.Babies <= settings.maxBabies ? consumerTotals.Babies <= adults ? consumerTotals.Babies : adults : settings.maxBabies;
                //     }
                // }

                // if (!settings.components.bus.adults.hasClass(settings.componentsOptions.comboBoxClass)) {
                //     settings.components.bus.adults.val(adults);
                //     settings.components.bus.children.val(childrens);
                //     settings.components.bus.babies.val(babies);
                // } else {
                //     settings.components.bus.adults.setSelectedValue(adults);
                //     settings.components.bus.children.setSelectedValue(childrens);
                //     settings.components.bus.babies.setSelectedValue(babies);
                // }

                if (searchParameters.DepartureLocationData)
                    settings.components.bus.origin.addClass(settings.componentsOptions.updateValueCompleteClass).locationsFinder("setData", searchParameters.DepartureLocationData);
                else if (searchParameters.DepartureLocation)
                    settings.components.bus.origin.addClass(settings.componentsOptions.updateValueCompleteClass).val(searchParameters.DepartureLocation);
                else
                    settings.components.bus.origin.removeClass(settings.componentsOptions.updateValueCompleteClass).val("").locationsFinder("setData", 0);

                if (searchParameters.DestinationLocationData)
                    settings.components.bus.destination.addClass(settings.componentsOptions.updateValueCompleteClass).locationsFinder("setData", searchParameters.DestinationLocationData);
                else if (searchParameters.DestinationLocation)
                    settings.components.bus.destination.addClass(settings.componentsOptions.updateValueCompleteClass).val(searchParameters.DestinationLocation);
                else
                    settings.components.bus.destination.removeClass(settings.componentsOptions.updateValueCompleteClass).val("").locationsFinder("setData", 0);

                if (searchParameters.StartDate) {
                    settings.components.bus.outboundDate.datepickermanager("setDate", formatter.dateValuesToDate(searchParameters.StartDate)).val(formatter.dateValuesShort(searchParameters.StartDate));
                    if (settings.validateBusRulesOnChange)
                        _outboundDateRules(settings.components.bus.outboundDate.selector);
                } else {
                    settings.components.bus.outboundDate.val("").datepickermanager("setDate", undefined);
                }

                if (searchParameters.EndDate) {
                    settings.components.bus.inboundDate.val(formatter.dateValuesShort(searchParameters.EndDate)).datepickermanager("setDate", formatter.dateValuesToDate(searchParameters.EndDate));
                    if (settings.validateBusRulesOnChange)
                        _inboundDateRules(settings.components.bus.inboundDate.selector);
                } else {
                    settings.components.bus.inboundDate.val("").datepickermanager("setDate", undefined);
                }

                settings.components.bus.searchForPackageComposition.setCheck(searchParameters.SearchForPackageComposition);

                if (searchParameters.Bus) {

                    if (searchParameters.Bus.IsRoundTrip)
                        settings.components.bus.roundTrip.click();
                    else if (searchParameters.Bus.IsOneWay)
                        settings.components.bus.oneWay.click();
                    else
                        settings.components.bus.multiDestination.click();

                    settings.components.bus.nonStop.setCheck(searchParameters.Bus.NonStop);

                    var ciaCode = searchParameters.Bus.CiaCodes.length ? searchParameters.Bus.CiaCodes[0] : "";

                    if (!settings.components.bus.ciaCode.hasClass(settings.componentsOptions.comboBoxClass))
                        settings.components.bus.ciaCode.val(ciaCode);
                    else
                        settings.components.bus.ciaCode.setSelectedValue(ciaCode);

                }
            }
        }

        //METODO DO ANTIGO SEARCHENGINE
        this.fillValues = function (data) {

            if (data && !$.isEmptyObject(data)) {
                if (data.Bus)
                    data = data.Bus;
                
                //BUG 2101 - IE7 
                if (data.IsRoundTrip)
                    settings.components.bus.roundTrip.check();
                else if (data.Destinations && data.Destinations.length > 0 && data.Destinations[0].InboundDate)
                    settings.components.bus.multiDestination.check();
                else
                    settings.components.bus.oneWay.check();
                    

                _searchBusRules();

                if (data.Destinations) {
                    for (destinationIndex = 2; destinationIndex < data.Destinations.length; destinationIndex++) {
                        ////Multitrechos (+ de 2 trechos)
                        //Para que crie todos os componentes e depois preencha os valores, pois ao iniciar os componentes de data ele zera tudo
                        // fazendo com haja a perda dos dados.
                        _onAddBusSegment();
                        _selectComponents(settings.components.bus);
                    }
                    for (destinationIndex = 0; destinationIndex < data.Destinations.length; destinationIndex++) {

                        var destinationData = data.Destinations[destinationIndex];
                        var originComponent = $(settings.components.bus.origin[destinationIndex]);
                        var destinationComponent = $(settings.components.bus.destination[destinationIndex]);
                        var outboundDateComponent = $(settings.components.bus.outboundDate[destinationIndex]);
                        var inboundDateComponent = $(settings.components.bus.inboundDate[destinationIndex]);
                        var timeOutComponent = $(settings.components.bus.timeOut[destinationIndex]);
                        var timeInComponent = $(settings.components.bus.timeIn[destinationIndex]);
                        var ciaCodeComponent = $(settings.components.bus.ciaCode[destinationIndex]);

                        _functions.components.setOriginAndDestination(destinationData, originComponent, destinationComponent);

                        if (destinationData.OutboundDate)
                            _functions.components.setDate(destinationData.OutboundDate, outboundDateComponent, _outboundDateRules, settings.components.bus.outboundDate.selector);

                        if (destinationData.InboundDate)
                            _functions.components.setDate(destinationData.InboundDate, inboundDateComponent, _inboundDateRules, settings.components.bus.inboundDate.selector);

                        if (destinationData.StartTimeOut && destinationData.StartTimeOut != "")
                            timeOutComponent.val(destinationData.StartTimeOut);

                        if (destinationData.StartTimeIn && destinationData.StartTimeIn != "")
                            timeInComponent.val(destinationData.StartTimeIn);

                        if (Util.HasCount(destinationData.CiaCodes))
                            _functions.components.setCiaCodes(destinationData, ciaCodeComponent);

                        if (Util.HasCount(settings.components.bus.nonStop) && settings.components.bus.nonStop[destinationIndex] != undefined) {
                            var nonStopComponent = $(settings.components.bus.nonStop[destinationIndex]);

                            _functions.components.setNonStop(destinationData.NonStop, nonStopComponent);
                        }
                    }
                    
                    if (typeof settings.components.bus.nonStop !== 'string')
                        settings.components.bus.nonStop.setCheck(data.NonStop);
                    else
                        $(settings.components.bus.nonStop.selector, component).setCheck(data.NonStop);
                }

                settings.components.bus.cabinType.val(data.CabinType);
                settings.components.bus.pricingTradeType.val(data.PricingTradeType);
            }

        }

        this.validate = function () {
            var errors = [];

            settings.components.bus.destinationDv.each(function () {
                var thisDestination = $(this);

                var originComponent = thisDestination.find(settings.components.bus.origin);

                if (originComponent.val() == "")
                    errors.push("OnSearch_NoOrigin");
                else if (originComponent.locationsFinder("getData") == undefined)
                    errors.push("OnSearch_InvalidOrigin");

                var destinationComponent = thisDestination.find(settings.components.bus.destination);

                if (destinationComponent.val() == "")
                    errors.push("OnSearch_NoDestin");
                else if (originComponent.val() == destinationComponent.val())
                    errors.push("OnSearch_OriginEqualsDestin");
                else if (destinationComponent.locationsFinder("getData") == undefined)
                    errors.push("OnSearch_InvalidDestination");

                var minDate = new Date().addDays(settings.minDaysToSearch - 1);
                var maxDate = new Date();

                var outboundDateComponent = thisDestination.find(settings.components.bus.outboundDate);

                if (!outboundDateComponent.length)
                    outboundDateComponent = thisDestination.parent().find(settings.components.bus.outboundDate);

                if (outboundDateComponent.datepickermanager("val") == "")
                    errors.push("OnSearch_NoOutboundDate");
                else if (!outboundDateComponent.datepickermanager("val").isDate())
                    errors.push("OnSearch_InvalidOutboundDate");
                else if (settings.anotheDatePickersOption.minDate != undefined) {
                    var MinDate = new Date().addDays(settings.anotheDatePickersOption.minDate);

                    if (outboundDateComponent.datepickermanager("getDate") < minDate)
                        errors.push(["OnSearch_MinHoursHotel", settings.anotheDatePickersOption.minDate * 24]);
                }

                if (outboundDateComponent.datepickermanager("val").length) {
                    var outboundDate = formatter.dateValuesToDate(outboundDateComponent.datepickermanager("val").toDateValues());

                    if (outboundDate < minDate) {
                        if (settings.minDaysToSearch > 0)
                            errors.push(["OnSearch_MinHours", settings.minDaysToSearch * 24]);
                        else
                            errors.push("OnSearch_OutboundLessThanCurrentDate");
                    }

                    var refToCalcCheckoutMaxDate = settings.calcCheckoutMaxDateFromToday ? (new Date()) : outboundDate;
                    maxDate = refToCalcCheckoutMaxDate.addDays(settings.maxDaysToSearchHotels);
                }

                if (!settings.components.bus.inboundDate.hasClass('hide') && (settings.components.bus.roundTrip.is(':ischecked') || settings.components.bus.inboundDate && settings.components.bus.inboundDate.datepickermanager("val") && settings.components.bus.inboundDate.datepickermanager("val").length)) {
                    if (settings.components.bus.inboundDate.datepickermanager("val") == "") {
                        errors.push("OnSearch_NoInboundDate");
                    }
                    else if (!settings.components.bus.inboundDate.datepickermanager("val").isDate())
                        errors.push("OnSearch_InvalidInboundDate");
                }
            });

            _validateOutBoundMaxSearchDays(settings.components.bus.outboundDate, errors);

            if (settings.components.bus.multiDestination.is(':ischecked')) {
                var lastDate = undefined;
                var noErrors = true;

                settings.components.bus.destinationDv.each(function () {
                    var thisDestination = $(this);
                    if (lastDate > thisDestination.find(settings.components.bus.outboundDate).datepickermanager("val").toDateTime() && noErrors) {
                        errors.push("OnSearch_OutboundDateOutOrder");
                        noErrors = false;
                    }
                    lastDate = thisDestination.find(settings.components.bus.outboundDate).datepickermanager("val").toDateTime();
                });
            } else if (Util.IsChecked(settings.components.bus.roundTrip) || (settings.components.bus.inboundDate && settings.components.bus.inboundDate.datepickermanager("val") && settings.components.bus.inboundDate.datepickermanager("val").length)) {

                if (settings.components.bus.outboundDate.datepickermanager("val") != "" && settings.components.bus.inboundDate.datepickermanager("val") != "" && settings.components.bus.outboundDate.datepickermanager("getDate") > settings.components.bus.inboundDate.datepickermanager("getDate")) {
                    settings.components.bus.inboundDate.val(settings.components.bus.outboundDate.datepickermanager("val"));
                    errors.push("OnSearch_OutboundLessThanInboundDate");
                }

                if (settings.components.bus.timeOut.val() != "" && settings.components.bus.timeIn.val() != "") {
                    if (settings.components.bus.outboundDate.datepickermanager("val") == settings.components.bus.inboundDate.datepickermanager("val")
                        && parseInt(settings.components.bus.timeOut.val()) > parseInt(settings.components.bus.timeIn.val())) {
                        errors.push("OnSearch_CurrentDateTimeInLessThanTimeOut");
                    }
                }

                if (settings.components.bus.outboundDate.datepickermanager("val") != "") {

                    var outboundDate = settings.components.bus.outboundDate.datepickermanager("getDate");

                    outboundDate = new Date(outboundDate.getTime() + (1000 * 60 * 60 * 23 + (1000 * 60 * 59)));

                    if (outboundDate <= (new Date())) {
                        errors.push("OnSearch_OutboundLessThanCurrentDate");
                        settings.components.bus.outboundDate.datepickermanager("setDate", (new Date()));
                    }

                    _validateInBoundMaxSearchDays(settings.components.bus.inboundDate, errors);
                }
            } else if (settings.components.bus.outboundDate.datepickermanager("val") != "") {

                var outboundDate = settings.components.bus.outboundDate.datepickermanager("getDate");

                outboundDate = new Date(outboundDate.getTime() + (1000 * 60 * 60 * 23 + (1000 * 60 * 59)));

                if (outboundDate <= (new Date())) {
                    errors.push("OnSearch_OutboundLessThanCurrentDate");
                    settings.components.bus.outboundDate.datepickermanager("setDate", (new Date()));
                }
            }

            if ((parseInt(Util.GetComponentValue(settings.components.bus.adults)) + parseInt(Util.GetComponentValue(settings.components.bus.children)) + parseInt(Util.GetComponentValue(settings.components.bus.babies))) > 9) {
                errors.push("OnSearch_NoMoreThanNinePassengers");
                settings.components.bus.adults.val(1);
                settings.components.bus.children.val(0);
                settings.components.bus.babies.val(0);
            }

            // if ((parseInt(Util.GetComponentValue(settings.components.bus.children)) + parseInt(Util.GetComponentValue(settings.components.bus.babies))) > settings.maxChildren && settings.maxChildren > 0) {
            //     errors.push("OnSearch_NoMoreChildren");
            // }

            if (parseInt(Util.GetComponentValue(settings.components.bus.adults)) < parseInt(Util.GetComponentValue(settings.components.bus.babies))) {
                errors.push("OnSearch_NeedMoreAdultsThanInfants");
                settings.components.bus.babies.val(parseInt(Util.GetComponentValue(settings.components.bus.adults)));
            }

            if (parseInt(Util.GetComponentValue(settings.components.bus.adults)) == 0
                && parseInt(Util.GetComponentValue(settings.components.bus.children)) == 0
                && (parseInt(Util.GetComponentValue(settings.components.bus.srcs)) || 0) == 0) {
                errors.push("OnSearch_NeedPassenger");
            }

            SharedFunctions.ValidateContext(errors);

            if (settings.controllers.messagesController && errors && errors.length)
                settings.controllers.messagesController.notifyMessages(errors, settings.exhibitionType);

            return errors.length == 0;
        };

        this.readQueryString = function (queryString) {
            var searchParameters = {
                Bus: {
                    // CompanyId: 0,
                    Destinations: [],
                    // IsRoundTrip: false,
                    // MultiDestination: false,
                }
            };

            // _functions.queryString.getPassengerData(searchParameters, queryString);
            // _functions.queryString.getFlightTypeData(searchParameters, queryString);
            // _functions.queryString.getBaggageFilter(searchParameters, queryString);
            // _functions.queryString.getCabinTypeFilter(searchParameters, queryString);
            _functions.queryString.getDestinationData(searchParameters, queryString);
            // _functions.queryString.getNonStopFilter(searchParameters, queryString);
            // _functions.queryString.getIsRoundTrip(searchParameters, queryString);

            // searchParameters.Bus.SearchType = settings.components.bus.searchType.length != 0
            //     ? settings.components.bus.searchType.val()
            //     : settings.searchType;

            //_getBusRequestData(searchParameters);
            searchParameters.Bus.BusStationPairsRequest = _getBusStationPairRequest(searchParameters.Bus);
            

            return searchParameters;
        }
        
        this.getQueryString = function (pageUrl) {

            var data = thisSearchEngine.getData();

            pageUrl = pageUrl + "?SearchType=Bus";

            var querystring = "";

            querystring = querystring + _getQueryStringBusDestination(data);

            querystring += "&RoundTrip=" + (data.Bus.IsRoundTrip == true ? "1" : "0");
            //querystring += "&NonStop=" + data.Bus.NonStop.toString();

            if (data.Bus.BusStationPairsRequest[0] != undefined && data.Bus.BusStationPairsRequest[0].EndTime != undefined)
                querystring += "&Hora=" + (data.Bus.BusStationPairsRequest[0].EndTime - 1).toString();
            else
                querystring += "&Hora=";

            if (data.Bus.BusStationPairsRequest[1] != undefined && data.Bus.BusStationPairsRequest[1].EndTime != undefined)
                querystring += "&Hora=" + (data.Bus.BusStationPairRequest[1].EndTime - 1).toString();
            else
                querystring += "&Hora=";

            //querystring += "&Cabine=" + data.Bus.CabinType;
            //querystring += "&Baggage=" + data.Bus.BaggageFilter;
            //querystring += "&Multi=" + (data.Bus.MultiDestination || false).toString();
            //querystring += "&DestQtd=" + data.Bus.Destinations.length.toString();

            querystring = querystring.replace("undefined", "");
            querystring = querystring.replace("null", "");

            return pageUrl + querystring;
        }

        function _dettachEvents() {

        }

        function _attachEvents() {
            _dettachEvents();
        }

        function _setLiveEvents() {
            _selectComponents();

            $(component).off('click', settings.components.bus.outboundCalendarIcon.selector).on('click', settings.components.bus.outboundCalendarIcon.selector, _showOutBoundCalendar)
            $(component).off('click', settings.components.bus.inboundCalendarIcon.selector).on('click', settings.components.bus.inboundCalendarIcon.selector, _showInboundDateCalendar);
            $(component).off('click', settings.components.bus.oneWay.selector).on('click', settings.components.bus.oneWay.selector, _onChangeSearchType);
            $(component).off('click', settings.components.bus.roundTrip.selector).on('click', settings.components.bus.roundTrip.selector, _onChangeSearchType);
            //$(component).off('click', settings.components.bus.multiDestination.selector).on('click', settings.components.bus.multiDestination.selector, _onChangeSearchType);
            //$(component).off('click', settings.components.bus.advancedSearch.selector).on('click', settings.components.bus.advancedSearch.selector, _advancedSearch);
            //$(component).off('click', settings.components.bus.clearSearchParams.selector).on('click', settings.components.bus.clearSearchParams.selector, thisSearchEngine.render);
            //$(component).off('click', settings.components.bus.addSegment.selector).on('click', settings.components.bus.addSegment.selector, _onAddSegment);
            //$(component).off('click', settings.components.bus.removeSegment.selector).on('click', settings.components.bus.removeSegment.selector, _onRemoveSegment);

            var eventChangeDate = (Global.Mobile) ? 'blur' : 'change';

            if (settings.validateBusRulesOnChange) {
                $(component).off(eventChangeDate, settings.components.bus.outboundDate.selector).on(eventChangeDate, settings.components.bus.outboundDate.selector, _outboundDateRules);
                $(component).off(eventChangeDate, settings.components.bus.inboundDate.selector).on(eventChangeDate, settings.components.bus.inboundDate.selector, _inboundDateRules);
            }

            if (!Global.Mobile) {
                $(component).off('keyup', settings.components.bus.outboundDate.selector).on('keyup', settings.components.bus.outboundDate.selector, Util.ForceMaskDate);
                $(component).off('keyup', settings.components.bus.inboundDate.selector).on('keyup', settings.components.bus.inboundDate.selector, Util.ForceMaskDate);
            }

            $(component).off(eventChangeDate, settings.components.bus.outboundDate.selector).on(eventChangeDate, settings.components.bus.outboundDate.selector, _dateBusRules);
        }

        function _setComponentsEvents() {
            settings.components.bus.toggleAdvancedOptions.unbind("click").bind("click", _toggleAdvancedOptions);
        }

        function _dateBusRules(component) {
            var $this = component != undefined && typeof component == 'string' ? $(component) : $(this);

            _applyMinDateRules($this);

            var myDate = $this.datepickermanager("getDate") || $this.datepickermanager("option", "minDate");

            var refToCalcCheckoutMaxDate = settings.calcCheckoutMaxDateFromToday ? (new Date()) : myDate;
            var minDate = $this.datepickermanager("getDate");

            if (!minDate)
                minDate = $this.datepickermanager("option", "minDate");

            if (settings.components.bus.inboundDate.not(':hidden') && !settings.components.bus.inboundDate.hasClass('hide')) {
                var checkoutDaysToAdd = settings.type == "BusHotel" ? settings.maxDaysToSearchHotels : settings.maxSearchDays;
                settings.components.bus.inboundDate.datepickermanager("option", "minDate", minDate)
                    .datepickermanager("option", "maxDate", refToCalcCheckoutMaxDate.addDays(checkoutDaysToAdd));
            }

            var filteredOutboundDate = settings.components.bus.outboundDate.not(':hidden');

            var parentIndex = filteredOutboundDate.index($this);

            if (parentIndex + 1 != filteredOutboundDate.length) {
                filteredOutboundDate.eq(parentIndex + 1).datepickermanager("option", "minDate", minDate);
                _dateBusRules.call(filteredOutboundDate.eq(parentIndex + 1));
            }
        }

        function _setPesqIncConfig() {
            pesqIncConfig = {
                SearchType: Global.SearchTypes.Full,
                maxResultsClient: 15,
                maxResultsServer: 30,
                idealNumberOfProximities: 6,
                idealNumberOfProximitiesRoots: 3,
                useCacheEnhancer: true,
                onlyHalfClientResults: true,
                onDropBoxSelect: function () { },
                clientCache: Global.LocationsCache,
                useScroll: settings.useScrollOnPesqInc,
                applyStatusClasses: settings.applyStatusClassesOnPesqInc,
                applyFixedClass: settings.applyFixedClassOnPesqInc,
                controllers: {
                    locationsController: Global.LocationsController
                }
            };
        }

        function _initBus(settingsDatePicker, toHotel) {
            _setPesqIncConfig();

            var settingsDatePicker = undefined;

            var currentDate = Util.CreateAbsoluteDate();

            if (typeof settings.anotheDatePickersOption.minDate != 'undefined') {
                settingsDatePicker = {
                    numberOfMonths: (Global.Mobile) ? 1 : 2,
                    minDate: currentDate.addDays(parseInt(settings.minDaysToSearch, 10)),
                    maxDate: currentDate.addDays(parseInt(settings.maxDaysToSearch, 10))
                };
            }
            else
                settingsDatePicker = {
                    numberOfMonths: (Global.Mobile) ? 1 : 2,
                    maxDate: currentDate.addDays(parseInt(settings.maxDaysToSearch, 10))
                };

            _initBusDatePickers(settingsDatePicker);

            _initBusLocations();

            if (settings.events.afterInitialize)
                settings.events.afterInitialize(settings);
        }

        function _initBusLocations() {
            if ($.fn.locationsFinder && settings.controllers.locationsController) {
                pesqIncConfig.IsAirport = false;
                pesqIncConfig.CurrentProduct = Global.Product.Bus;
                pesqIncConfig.SearchType = Global.SearchTypes.Full;
                pesqIncConfig.allowCitiesWithoutIATA = true;
                pesqIncConfig.HasIata = false;
                pesqIncConfig.HasHotelCode = false;
                pesqIncConfig.ShowBus = true;
                pesqIncConfig.LocationsType = [EnumHelper.LocationType.City, EnumHelper.LocationType.BusStation];
                pesqIncConfig.loadProximities = settings.loadProximities;
                pesqIncConfig.includeAirportsChildren = settings.includeAirportsChildren;

                settings.components.bus.destination.locationsFinder(pesqIncConfig).click(function () { $(this).select(); });
                settings.components.bus.origin.locationsFinder(pesqIncConfig).click(function () { $(this).select(); });
                
                if (settings.defaultOriginId > 0) {
                    var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(settings.defaultOriginId) });
                    if (auxLocationData.length > 0)
                        settings.components.bus.origin.locationsFinder('setData', auxLocationData[0]);
                }
                if (settings.defaultDestinationId > 0) {
                    var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(settings.defaultDestinationId) });
                    if (auxLocationData.length > 0)
                        settings.components.bus.destination.locationsFinder('setData', auxLocationData[0]);
                }
                if (settings.lockDestination == "true") {
                    $(settings.components.bus.destination).attr("disabled", "disabled");
                }
            }
        }

        function _initBusDatePickers(settingsDatePicker) {
            if (Global.Mobile) {
                settings.components.bus.outboundDate.removeClass(settings.componentsOptions.hasDatepicker).datepickermanager('destroy');
                settings.components.bus.outboundDate.datepickermanager(DatePickerOption(settingsDatePicker));
            } else {
                settings.components.bus.outboundDate.removeClass(settings.componentsOptions.hasDatepicker).datepickermanager('destroy').datepickermanager(DatePickerOption(settingsDatePicker));
            }

            if (settings.events.onOutboundDateBlur)
                settingsDatePicker.onSelect = settings.events.onOutboundDateBlur;

            settingsDatePicker.minDate = settingsDatePicker.minDate.addDays(settings.minPeriodToSearch);

            settingsDatePicker.maxDate = settingsDatePicker.maxDate.addDays(settings.minPeriodToSearch);

            if (Global.Mobile) {
                settings.components.bus.inboundDate.removeClass(settings.componentsOptions.hasDatepicker).datepickermanager('destroy');
                settings.components.bus.inboundDate.datepickermanager(DatePickerOption(settingsDatePicker));
            } else {
                settings.components.bus.inboundDate.removeClass(settings.componentsOptions.hasDatepicker).datepickermanager('destroy').datepickermanager(DatePickerOption(settingsDatePicker));;
            }

            _setDefaultDate(settings.defaultOutboundDate, settings.components.bus.outboundDate);

            _outboundDateRules.call(settings.components.bus.outboundDate.eq(0));
            _setDefaultDate(settings.defaultInboundDate, settings.components.bus.inboundDate);

            if (settings.lockCheckin == "true")
                settings.components.bus.outboundDate.attr("disabled", "disabled");
            if (settings.lockCheckout == "true")
                settings.components.bus.inboundDate.attr("disabled", "disabled");

        }

        function _setDefaultDate(defaultDate, $component) {
            if (defaultDate) {
                var date = defaultDate.toDateValues("pt");

                if (date.isValid) {
                    $component.datepickermanager("setDate", formatter.dateValuesToDate(date));
                    $component.datepickermanager("val", formatter.dateValuesShort(date));
                }
            }
        }

        function _onChangeSearchType(event) {
            if (!$(this).hasClass("current")) {
                setTimeout(_searchBusRules, 50);
            }
        }

        function _onAddSegment(event) {
            if (event)
                event.preventDefault();
            _onAddBusSegment();
        }

        function _onRemoveSegment(event) {
            if (event)
                event.preventDefault();

            $(this).closest(settings.components.bus.destinationDv).remove();
            _selectComponents(settings.components.bus);
        }

        function _showOutBoundCalendar() {
            settings.components.bus.outboundDate.datepickermanager("show");
        }

        function _showInboundDateCalendar() {
            settings.components.bus.inboundDate.datepickermanager("show");
        }

        function _onAddBusSegment() {
            var lastSegment = settings.components.bus.destinationDv.filter(':last');
            lastSegment.find(settings.components.bus.outboundDate).attr('id', '');

            var lastOrigin = lastSegment.find(settings.components.bus.destination).locationsFinder("getData");
            var lastOriginText = lastSegment.find(settings.components.bus.destination).val();

            var clonedLastSegment = lastSegment.clone();

            var txtClonedLastSegmentOrigin;
            var txtClonedLastSegmentDestination;
            var txtClonedLastSegmentOutboundDate;

            clonedLastSegment.addClass("clonedSegment");
            clonedLastSegment.insertAfter(lastSegment);

            txtClonedLastSegmentOrigin = clonedLastSegment.find(settings.components.bus.origin.selector, component);
            txtClonedLastSegmentDestination = clonedLastSegment.find(settings.components.bus.destination.selector, component);
            txtClonedLastSegmentOutboundDate = clonedLastSegment.find(settings.components.bus.outboundDate.selector, component);

            var lastIndex = settings.components.bus.outboundDate.index(settings.components.bus.outboundDate.last());
            _outboundDateRules.call(settings.components.bus.outboundDate.eq(lastIndex));

            if ($(".removeSegment", component).length == 2) {
                clonedLastSegment.find(".removeSegment").hide();
            }
            else {
                $(".removeSegment", component).eq(1).show();
                clonedLastSegment.find(".removeSegment").show();
            }

            _selectComponents(settings.components.bus);
            _initBus();

            if (lastOrigin) {
                txtClonedLastSegmentOrigin.locationsFinder("setData", lastOrigin);
                txtClonedLastSegmentOrigin.val(lastOriginText);
            }
            else {
                txtClonedLastSegmentOrigin.val("");
            }

            txtClonedLastSegmentDestination.locationsFinder("setData", {});
            txtClonedLastSegmentDestination.val("");
            txtClonedLastSegmentOutboundDate.val("");
            _dateBusRules.call(settings.components.bus.outboundDate.eq(0));
        }

        function _inboundDateRules() {
            if (settings.applycorrectDateRules && settings.components.bus.inboundDate.not(':hidden') && !settings.components.bus.inboundDate.hasClass('hide')) {
                _applyMinDateRules(settings.components.bus.inboundDate);
                _applyMaxDateRules(settings.components.bus.inboundDate);
            }
        }

        function _outboundDateRules(component) {
            var $this = component != undefined && typeof component == 'string' ? $(component) : $(this);

            if (settings.applycorrectDateRules) {
                _applyMinDateRules($this);
                _applyMaxDateRules($this);
            }

            var myDate = $this.datepickermanager("getDate") || $this.datepickermanager("option", "minDate");

            var refToCalcCheckoutMaxDate = settings.calcCheckoutMaxDateFromToday ? (new Date()) : myDate;

            var minDate = $this.datepickermanager("getDate");

            if (!minDate)
                minDate = $this.datepickermanager("option", "minDate");

            if (settings.components.bus.inboundDate.not(':hidden') && !settings.components.bus.inboundDate.hasClass('hide')) {
                var checkoutDaysToAdd = settings.maxDaysToSearch;
                settings.components.bus.inboundDate.datepickermanager("option", "minDate", minDate)
                    .datepickermanager("option", "maxDate", refToCalcCheckoutMaxDate.addDays(checkoutDaysToAdd));
            }

            var filteredOutboundDate = settings.components.bus.outboundDate.not(':hidden');

            var parentIndex = filteredOutboundDate.index($this);

            if (parentIndex + 1 != filteredOutboundDate.length) {
                filteredOutboundDate.eq(parentIndex + 1).datepickermanager("option", "minDate", minDate);
                _outboundDateRules.call(filteredOutboundDate.eq(parentIndex + 1));
            }
        }

        function _applyMinDateRules(ctrl) {
            var myDate = ctrl.datepickermanager("getDate");
            var minDate = ctrl.datepickermanager("option", "minDate");
            var currentDateValue = ctrl.datepickermanager("val").toDateValues();

            if (!myDate)
                myDate = minDate;

            var isInvalid = (currentDateValue.isValid == false && ctrl.val() != "");

            if (myDate < minDate || isInvalid) {
                ctrl.datepickermanager('setDate', minDate);

                if (isInvalid)
                    settings.controllers.messagesController.notifyMessages(["ApplyCorrectDateRule"], settings.exhibitionType);
            }
        }

        function _applyMaxDateRules(ctrl) {
            var myDate = ctrl.datepickermanager("getDate");
            var minDate = ctrl.datepickermanager("option", "minDate");
            var maxDate = ctrl.datepickermanager("option", "maxDate");
            var currentDateValue = ctrl.datepickermanager("val").toDateValues();

            if (!myDate)
                myDate = maxDate;

            if (myDate > maxDate || (currentDateValue.isValid == false && ctrl.val() != "")) {
                ctrl.datepickermanager('setDate', minDate);

                settings.controllers.messagesController.notifyMessages(["ApplyCorrectDateRule"], settings.exhibitionType);
            }

        }

        ///////////////Funcoes acionadas ao mudar o tipo de pesquisa////////////////////////////////////////
        function _searchBusRules() {
            var isOneWay = settings.components.bus.oneWay.is(":ischecked");
            var isRoundTrip = settings.components.bus.roundTrip.is(":ischecked");
            var isMultiDestination = !isOneWay && !isRoundTrip ? true : false;

            _removeExtraDestinationDiv();
            _hideOrShowMultiDestinationButtons("hide");


            var goingText = Resources.translate({ code: 'Going' }) + ':';

            if (isOneWay) {
                _hideOrShowInBoundFields("hide");
                settings.components.bus.destinationContainer.removeClass(settings.componentsOptions.bus.destinationContainerRemoveClassOneWay);
                settings.components.bus.destinationContainer.addClass(settings.componentsOptions.bus.destinationContainerAddClassOneWay);

                if (settings.components.bus.destinationContainer.parent()) {
                    settings.components.bus.destinationContainer.parent().removeClass(settings.componentsOptions.bus.destinationContainerRemoveClassOneWay);
                    settings.components.bus.destinationContainer.parent().addClass(settings.componentsOptions.bus.destinationContainerAddClassOneWay);
                }
            }
            else if (isRoundTrip) {
                _hideOrShowInBoundFields("show");
                settings.components.bus.destinationContainer.removeClass(settings.componentsOptions.bus.destinationContainerRemoveClassRoundTrip);
                settings.components.bus.destinationContainer.addClass(settings.componentsOptions.bus.destinationContainerAddClassRoundTrip);

                if (settings.components.bus.destinationContainer.parent()) {
                    settings.components.bus.destinationContainer.parent().removeClass(settings.componentsOptions.bus.destinationContainerRemoveClassRoundTrip);
                    settings.components.bus.destinationContainer.parent().addClass(settings.componentsOptions.bus.destinationContainerAddClassRoundTrip);
                }
            }
            else if (isMultiDestination) {
                settings.components.bus.destinationContainer.removeClass(settings.componentsOptions.bus.destinationContainerRemoveClassMultiDestination);
                settings.components.bus.destinationContainer.addClass(settings.componentsOptions.bus.destinationContainerAddClassMultiDestination);

                if (settings.components.bus.destinationContainer.parent()) {
                    settings.components.bus.destinationContainer.parent().removeClass(settings.componentsOptions.bus.destinationContainerRemoveClassMultiDestination);
                    settings.components.bus.destinationContainer.parent().addClass(settings.componentsOptions.bus.destinationContainerAddClassMultiDestination);
                }

                _hideOrShowInBoundFields("hide");
                _hideOrShowMultiDestinationButtons("show");
                _onAddBusSegment();

                goingText = Resources.translate({ code: 'Date' }) + ':';
            }

            $('.date[changetext*=true] p').html(goingText);
        }

        var _equivalentVisualAction = {
            'hide': 'addClass',
            'show': 'removeClass'
        };

        function _hideOrShowInBoundFields(action) {
            _validateHideOrShowAction(action);

            //Date
            settings.components.bus.inboundDate.val("")[action]()[_equivalentVisualAction[action]]('hide');
            settings.components.bus.inboundDate.parent()[action]()[_equivalentVisualAction[action]]('hide');
            settings.components.bus.timeIn[action]()[_equivalentVisualAction[action]]('hide');
            //Period
            settings.components.bus.periodIn[action]()[_equivalentVisualAction[action]]('hide');
            settings.components.bus.periodIn.parent()[action]()[_equivalentVisualAction[action]]('hide');
        }

        function _hideOrShowMultiDestinationButtons(action) {
            _validateHideOrShowAction(action);

            settings.components.bus.addSegment[action]();
            //settings.components.bus.removeSegment[action]();
        }

        function _validateHideOrShowAction(action) {
            return !(action != "hide" && action != "show");
        }

        /*Remove as divs extras criadas pelo "adicionar trecho"*/
        function _removeExtraDestinationDiv() {
            settings.components.bus.destinationDv.remove(".clonedSegment");
            settings.components.bus.destinationDv = $(settings.components.bus.destinationDv);

            _selectComponents();
        }

        ///////////////Fim das funcoes acionadas ao mudar o tipo de pesquisa////////////////////////////////////////
        function _setValidators() {
            settings.components.bus.origin.addClass(settings.componentsOptions.bus.origin.validatorClass);
            settings.components.bus.destination.addClass(settings.componentsOptions.bus.destination.validatorClass);
        }

        function _showCombos() {
            if (!settings.searchEngineTab) {
                if (settings.showCombos) {
                    settings.components.searchEngineCombos.show().next(settings.componentsOptions.comboDivisoria).show();
                    ctrl = settings.components.bus.advancedSearch;
                } else {
                    settings.components.searchEngineCombos.hide().next(settings.componentsOptions.comboDivisoria).hide();
                }
            }
        }

        // function _getBusRequestData(searchParameters) {
        //     if (searchParameters && searchParameters.Bus) {
        //         searchParameters.Bus.RequestData = {};
        //         searchParameters.Bus.RequestData.BusStationPairRequest = _getBusStationPairRequest(searchParameters.Bus);
        //
        //         // searchParameters.Bus.RequestData.NumberADTs = searchParameters.Bus.Adults || 0;
        //         // searchParameters.Bus.RequestData.NumberCHDs = searchParameters.Bus.Children || 0
        //         // searchParameters.Bus.RequestData.NumberINFs = searchParameters.Bus.Babies || 0;
        //         // searchParameters.Bus.RequestData.NumberSRCs = searchParameters.Bus.Srcs || 0;
        //
        //         searchParameters.Bus.RequestData.BestCombinationWithSwitchBus = searchParameters.Bus.BestCombinationWithSwitchBus;
        //         //searchParameters.Bus.RequestData.CabinFilter = parseFloat(searchParameters.Bus.CabinType);
        //         searchParameters.Bus.RequestData.TradeType = parseFloat(searchParameters.Bus.PricingTradeType);
        //         searchParameters.Bus.RequestData.BaggageFilter = searchParameters.Bus.BaggageFilter;
        //     }
        // }
        
        function _getBusStationPairRequest(searchParameters) {

            var busStationPairRequest = {
                Origin: "",
                Destination: "",
                OriginLocationId: 0,
                DestinationLocationId: 0,
                DepartureDate: null,
                DepartureYear: 0,
                DepartureMonth: 0,
                DepartureDay: 0,
                International: false
            };

            var destinationTravel = searchParameters.Destinations[0];
            
            var origin = Util.GetShortIATA(destinationTravel.Origin);
            busStationPairRequest.Origin = (origin == "") ? destinationTravel.Origin : origin;
            busStationPairRequest.OriginLocationId = (destinationTravel.OriginData) ? destinationTravel.OriginData.id : 0;
            
            var destination = Util.GetShortIATA(destinationTravel.Destination);
            busStationPairRequest.Destination = (destination == "") ? destinationTravel.Destination : destination;
            busStationPairRequest.DestinationLocationId = (destinationTravel.DestinationData) ? destinationTravel.DestinationData.id : 0;

            if (destinationTravel.OutboundDate) {
                busStationPairRequest.DepartureDate = destinationTravel.OutboundDate;
                busStationPairRequest.DepartureYear = destinationTravel.OutboundDate.Year;
                busStationPairRequest.DepartureMonth = destinationTravel.OutboundDate.Month;
                busStationPairRequest.DepartureDay = destinationTravel.OutboundDate.Day;
            }
            
            return busStationPairRequest;
            
            // var busStationsPair = [];
            //
            // var localCiaCodeList = [];
            // var lineContainer = $(this);
            // for (var s = 0; s < searchParameters.Destinations.length; s++) {
            //     var destinationTravel = searchParameters.Destinations[s];
            //
            //     destinationTravel.NonStop = searchParameters.Destinations[0].NonStop;
            //
            //     var busStationPair = {
            //         CiaCodeList: destinationTravel.CiaCodes,
            //         NonStop: destinationTravel.NonStop
            //     }
            //
            //     var origin = Util.GetShortIATA(destinationTravel.Origin);
            //     busStationPair.Origin = origin == "" ? destinationTravel.Origin : origin;
            //
            //     var destination = Util.GetShortIATA(destinationTravel.Destination);
            //     busStationPair.Destination = destination == "" ? destinationTravel.Destination : destination;
            //
            //     if (destinationTravel.OutboundDate) {
            //         busStationPair.DepartureYear = destinationTravel.OutboundDate.Year;
            //         busStationPair.DepartureMonth = destinationTravel.OutboundDate.Month;
            //         busStationPair.DepartureDay = destinationTravel.OutboundDate.Day;
            //     }
            //
            //     busStationPair.StartTime = Util.GetTreatyTime(destinationTravel.StartTimeOut, "START");
            //     busStationPair.EndTime = Util.GetTreatyTime(destinationTravel.EndTimeOut, "END");
            //
            //     //Cabin
            //     if (searchParameters.CabinType != "") {
            //         busStationPair.CabinFilter = searchParameters.CabinType;
            //     }
            //
            //     busStationsPair.push(busStationPair);
            // }
            //
            // if (searchParameters.IsRoundTrip) {
            //
            //     var busStationPairRoundTrip = {
            //         CiaCodeList: localCiaCodeList,
            //         NonStop: searchParameters.NonStop
            //     }
            //
            //     if (searchParameters.Destinations[0].Destination) {
            //         var origin = Util.GetShortIATA(searchParameters.Destinations[0].Destination);
            //         busStationPairRoundTrip.Origin = origin == "" ? searchParameters.Destinations[0].Destination : origin;
            //     }
            //
            //     if (searchParameters.Destinations[0].Origin) {
            //         var destination = Util.GetShortIATA(searchParameters.Destinations[0].Origin);
            //         busStationPairRoundTrip.Destination = destination == "" ? searchParameters.Destinations[0].Origin : destination;
            //     }
            //
            //     if (searchParameters.Destinations[0].InboundDate) {
            //         busStationPairRoundTrip.DepartureYear = searchParameters.Destinations[0].InboundDate.Year;
            //         busStationPairRoundTrip.DepartureMonth = searchParameters.Destinations[0].InboundDate.Month;
            //         busStationPairRoundTrip.DepartureDay = searchParameters.Destinations[0].InboundDate.Day;
            //     }
            //
            //     if (searchParameters.Destinations[0].StartTimeIn)
            //         busStationPairRoundTrip.StartTime = Util.GetTreatyTime(searchParameters.Destinations[0].StartTimeIn, "START");
            //     if (searchParameters.Destinations[0].EndTimeIn)
            //         busStationPairRoundTrip.EndTime = Util.GetTreatyTime(searchParameters.Destinations[0].EndTimeIn, "END");
            //
            //     busStationPairRoundTrip.CiaCodeList = searchParameters.Destinations[0].CiaCodes;
            //
            //     busStationsPair.push(busStationPairRoundTrip);
            //
            //     var filledCabinFilter = busStationsPair.first(function (h) { return h.CabinFilter; });
            //
            //     if (filledCabinFilter) {
            //         busStationsPair.forEach(function (x) {
            //             x.CabinFilter = filledCabinFilter.CabinFilter;
            //         });
            //     }
            //
            // }
            //
            // return busStationsPair;
        }

        function _validateOutBoundMaxSearchDays(componentDatePicker, errors) {
            var periodToSearch = new Date().addDays(settings.maxDaysToSearch);

            _validateMaxSearchDays(componentDatePicker, errors, periodToSearch);
        }

        function _validateInBoundMaxSearchDays(componentDatePicker, errors) {

            var periodToSearch;

            if (settings.validateMaxSearchDaysFromCheckinDate) {
                var outBoundComponentDatePicker = settings.components.bus.outboundDate;
                var dateValue = outBoundComponentDatePicker.datepickermanager("val");
                var date = formatter.dateValuesToDate(dateValue.toDateValues());
                periodToSearch = date.addDays(settings.maxDaysToSearch);
            }
            else
                periodToSearch = new Date().addDays(settings.maxDaysToSearch);


            _validateMaxSearchDays(componentDatePicker, errors, periodToSearch);
        }

        function _validateMaxSearchDays(componentDatePicker, errors, periodToSearch) {
            if (componentDatePicker.datepickermanager("getDate") && componentDatePicker.datepickermanager("getDate") > periodToSearch) {
                settings.maxDaysToSearch == 365 ? errors.push("OnSearch_NoMoreThanOneYear") : errors.push(["OnSearch_NoMoreThanXDays", settings.maxDaysToSearch]);
                componentDatePicker.datepickermanager("setDate", periodToSearch);
            }
        }

        function _getQueryStringBusDestination(data) {

            var querystring = "";

            if (data.Bus.Destinations) {
                for (var i = 0; i < data.Bus.Destinations.length; i++) {
                    querystring = querystring + "&Origem=" + data.Bus.Destinations[i].Origin.removeDiacritics().replaceAll(" ", "%20").replaceAll("(", "%28").replaceAll(")", "%29");
                    querystring = querystring + "&Destino=" + data.Bus.Destinations[i].Destination.removeDiacritics().replaceAll(" ", "%20").replaceAll("(", "%28").replaceAll(")", "%29");

                    querystring = querystring + "&OrigemId=" + data.Bus.Destinations[i].OriginData.id;
                    querystring = querystring + "&DestinoId=" + data.Bus.Destinations[i].DestinationData.id;
                    
                    if (data.Bus.IsRoundTrip) {
                        querystring = querystring + "&Origem=" + data.Bus.Destinations[i].Destination.removeDiacritics();
                        querystring = querystring + "&Destino=" + data.Bus.Destinations[i].Origin.removeDiacritics();

                        querystring = querystring + "&OrigemId=" + data.Bus.Destinations[i].OriginData.id;
                        querystring = querystring + "&DestinoId=" + data.Bus.Destinations[i].DestinationData.id;
                    }

                    // var proximityId = settings.components.bus.destination.getSelectedLocationIdProximity();
                    // var proximityName = settings.components.bus.destination.getSelectedLocationNameProximity().removeDiacritics();
                    //
                    // querystring = querystring + "&Proximity=" + proximityName
                    // querystring = querystring + "&ProximityId=" + (proximityName ? proximityName : 0);
                    querystring = querystring + "&Data=" + _getQueryStringDatePattern(data.Bus.Destinations[i].OutboundDate);

                    if (data.Bus.Destinations[i].InboundDate)
                        querystring = querystring + "&Data=" + _getQueryStringDatePattern(data.Bus.Destinations[i].InboundDate);

                    // if (data.Bus.Destinations[i].CiaCodes.length > 0) {
                    //     var ciaQueryString = "&Cia=";
                    //     var sep = "";
                    //
                    //     for (var j = 0; j < data.Bus.Destinations[i].CiaCodes.length; j++) {
                    //         ciaQueryString = ciaQueryString + sep + data.Bus.Destinations[i].CiaCodes[j];
                    //         sep = ",";
                    //     }
                    //
                    //     querystring = querystring + ciaQueryString;
                    // }

                    if (data.Bus.Destinations[i].NonStop)
                        querystring += "&NonStop=" + data.Bus.Destinations[i].NonStop.toString();
                }
            }

            return querystring;
        }

        function _advancedSearch() {
            var ctrl = $(this);

            if (ctrl.is(":ischecked"))
                settings.components.advancedSearchSiteForm.show();
            else
                settings.components.advancedSearchSiteForm.hide();
        }

        function _getQueryStringDatePattern(date) {
            return date.Day + '/' + date.Month + '/' + date.Year;
        }

        function _selectComponents(components) {
            if (!components)
                components = settings.components;
            Util.SelectComponents(components, component, true);
        }

        this.changeSearchType = function (newSearchType) {
            if (newSearchType != null)
                settings.searchType = newSearchType;
        };

        this.getPeriodByComponent = function ($component) {
            var rs = { StartTime: 0, EndTime: 0 };
            var isCustomElement = $component.hasClass("multi_options") ? true : false;
            var componentValue = isCustomElement ? $component.getSelectedValue() : $component.val();

            if (!componentValue) {
                return rs;
            }

            var timeValues = {
                Morning: { StartTime: 6, EndTime: 12 },
                Afternoon: { StartTime: 12, EndTime: 18 },
                Night: { StartTime: 18, EndTime: 24 },
                Dawn: { StartTime: 0, EndTime: 6 }
            };

            switch (componentValue) {
                case "Morning":
                case "Afternoon":
                case "Night":
                case "Dawn":
                    rs = timeValues[componentValue];
                    break;
                case "0":
                    rs.StartTime = 0;
                    rs.EndTime = 1;
                    break;
                default:
                    componentValue = parseInt(componentValue);
                    rs.StartTime = componentValue - 1;
                    rs.EndTime = componentValue + 1;
            }
            return rs;
        };

        function _toggleAdvancedOptions() {
            settings.components.bus.advancedOptionsContainer.toggleClass("opened");
        }

        function _sendGtagEvents(searchParameters) {
            var busSearchParameters = searchParameters.Bus;

            _sendGtagSelectOutboundPeriodEvent(busSearchParameters);
            _sendGtagSelectInboundPeriodEvent(busSearchParameters);
            _sendGtagSelectCiaEvent(busSearchParameters);
            _sendGtagSelectCabinEvent(busSearchParameters);
            _sendGtagSelectBaggageEvent(busSearchParameters);
            _sendGtagCheckNonStopEvent(busSearchParameters);
            _sendGtagSearchEvent(busSearchParameters);
        }

        function _sendGtagSelectOutboundPeriodEvent(busSearchParameters, useCustomLabel) {
            var destinations = busSearchParameters.Destinations;
            var outboundPeriodSelected;

            if (destinations.length) {
                if (busSearchParameters.MultiDestination) {
                    var concatenatedPeriods = destinations
                        .map(function (d) {
                            if (d.StartTimeOut != 0 || d.EndTimeOut != 0) {
                                return {
                                    StartTime: d.StartTimeOut,
                                    EndTime: d.EndTimeOut
                                };
                            }
                        })
                        .filter(function (e) {
                            return e != undefined;
                        })
                        .reduce(function (acc, cur, index) {
                            var periond = _getPeriodByStartAndEndValues(cur);
                            return Util.ConcatenateStringSeparatedBy("/", acc, periond, index);
                        }, '');

                    if (concatenatedPeriods)
                        outboundPeriodSelected = 'Multi-trechos ' + destinations.length + ' - ' + concatenatedPeriods;
                } else {
                    var outboundPeriodObj = {
                        StartTime: destinations[0].StartTimeOut,
                        EndTime: destinations[0].EndTimeOut
                    };

                    if (outboundPeriodObj.StartTime == 0 && outboundPeriodObj.EndTime == 0)
                        return;

                    var outboundPeriodSelected = _getPeriodByStartAndEndValues(outboundPeriodObj);
                }
            }

            if (outboundPeriodSelected) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = outboundPeriodSelected + ' - ' + _rootSystemAccountInfo;

                Util.SendGtagEvent('select_outboundPeriod', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagSelectInboundPeriodEvent(busSearchParameters, useCustomLabel) {
            var destinations = busSearchParameters.Destinations;
            var inboundPeriodSelected;

            if (destinations.length && busSearchParameters.IsRoundTrip) {
                var inboundPeriodObj = {
                    StartTime: destinations[0].StartTimeIn,
                    EndTime: destinations[0].EndTimeIn
                };

                if (inboundPeriodObj.StartTime == 0 && inboundPeriodObj.EndTime == 0)
                    return;

                var inboundPeriodSelected = _getPeriodByStartAndEndValues(inboundPeriodObj);
            }

            if (inboundPeriodSelected) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = inboundPeriodSelected + ' - ' + _rootSystemAccountInfo;

                Util.SendGtagEvent('select_inboundPeriod', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagSelectCiaEvent(busSearchParameters, useCustomLabel) {
            var destinations = busSearchParameters.Destinations;
            var ciaCodeSelected;

            if (destinations.length) {
                if (busSearchParameters.MultiDestination) {
                    var listOfCiaCodesInStr = destinations.reduce(function (acc, destination, index) {
                        // Funciona pegar sÃ³ o primeiro item pois no v2 nosso motor sÃ³ permite a seleÃ§Ã£o de UMA ciaCode por trecho
                        // Se for implementado um multiple select deve-se iterar pela lista CiaCodes
                        var ciaCode = destination.CiaCodes[0];
                        return Util.ConcatenateStringSeparatedBy("/", acc, ciaCode, index);
                    }, '');

                    if (listOfCiaCodesInStr) {
                        ciaCodeSelected = 'Multi-trechos ' + destinations.length + ' - ' + listOfCiaCodesInStr;
                    }
                } else {
                    var ciaCodeSelected = destinations[0].CiaCodes[0];
                }
            }

            if (ciaCodeSelected) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = ciaCodeSelected + ' - ' + _rootSystemAccountInfo;

                Util.SendGtagEvent('select_ciaCode', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagSelectCabinEvent(busSearchParameters, useCustomLabel) {
            var destinations = busSearchParameters.Destinations;
            var cabinType;
            var cabinTypesLabel = {
                "0": "Primeira classe",
                "1": "Executiva",
                "2": "EconÃ´mica",
                "3": "EconÃ´mica premium",
            };

            if (destinations.length) {
                if (busSearchParameters.MultiDestination) {
                    var listOfCabinTypesInStr = destinations.reduce(function (acc, destination, index) {
                        var cabinType = destination.CabinFilter;

                        if (cabinType) {
                            var cabinTypeLabel = cabinTypesLabel[cabinType];
                            return Util.ConcatenateStringSeparatedBy("/", acc, cabinTypeLabel, index);
                        }

                        return acc;
                    }, '');

                    if (listOfCabinTypesInStr) {
                        cabinType = 'Multi-trechos ' + destinations.length + ' - ' + listOfCabinTypesInStr;
                    }
                } else if (destinations[0].CabinFilter) {
                    cabinType = cabinTypesLabel[destinations[0].CabinFilter];
                }
            }

            if (cabinType) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = cabinType + ' - ' + _rootSystemAccountInfo;

                Util.SendGtagEvent('select_cabinType', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagSelectBaggageEvent(busSearchParameters, useCustomLabel) {
            if (busSearchParameters.BaggageFilter != "0") {
                var gtagEventLabel;

                if (useCustomLabel) {
                    var baggageFilterLabels = {
                        "1": "Com bagagem",
                        "2": "Sem bagagem"
                    };
                    gtagEventLabel = baggageFilterLabels[busSearchParameters.BaggageFilter] + ' - ' + _rootSystemAccountInfo;
                }

                Util.SendGtagEvent('select_baggageFilter', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagCheckNonStopEvent(busSearchParameters) {
            if (busSearchParameters.NonStop)
                Util.SendGtagEvent('select_nonStop', _gtagEventCategory);
        }

        function _sendGtagSearchEvent(busSearchParameters, useCustomLabel) {
            var gtagEventLabel;

            if (useCustomLabel) {
                var tripType = _getTripTypeBySearchBusSearchParameters(busSearchParameters);
                var searchType = _getSearchTypeByBusSearchParameters(busSearchParameters);
                var destinations = _getDestinationByBusSearchParameters(busSearchParameters);
                gtagEventLabel = tripType + ' - ' + (searchType ? searchType + ' - ' : '') + (destinations ? destinations + ' - ' : '') + _rootSystemAccountInfo;
            }

            Util.SendGtagEvent('search', _gtagEventCategory, gtagEventLabel);
        }

        function _getTripTypeBySearchBusSearchParameters(busSearchParameters) {
            var tripOptions = {
                oneWay: "Somente ida",
                roundTrip: "Ida e volta",
                multiDestination: "Multi-trechos"
            };
            var isOneWay = busSearchParameters.IsOneWay;
            var isRoundTrip = busSearchParameters.IsRoundTrip;
            var tripType = isOneWay ? tripOptions.oneWay : (isRoundTrip ? tripOptions.roundTrip : tripOptions.multiDestination);

            if (tripType === tripOptions.multiDestination)
                tripType = _appendNumberOfDestinations(tripType, busSearchParameters.Destinations.length);

            return tripType;
        }

        function _appendNumberOfDestinations(str, number) {
            return str + ' ' + number;
        }

        function _getSearchTypeByBusSearchParameters(busSearchParameters) {
            var searchTypeOptions = {
                "0": "PreÃ§o + horÃ¡rio",
                "2": "HorÃ¡rio",
                "3": "PreÃ§o",
            }

            return searchTypeOptions[busSearchParameters.SearchType] || '';
        }

        function _getDestinationByBusSearchParameters(busSearchParameters) {
            var destinationsList = busSearchParameters.Destinations;
            var destinationsIds;

            if (busSearchParameters.IsRoundTrip || busSearchParameters.IsOneWay) {
                destinationsIds = destinationsList[0].DestinationData.id;
            } else {
                destinationsIds = destinationsList.reduce(function (acc, cur, index) {
                    return Util.ConcatenateStringSeparatedBy("/", acc, cur.DestinationData.id, index);
                }, "");
            }

            return destinationsIds || "";
        }

        function _getPeriodByStartAndEndValues(periodObj) {
            var periodSelected;

            if (periodObj.StartTime == 6 && periodObj.EndTime == 12)
                periodSelected = "Morning";
            else if (periodObj.StartTime == 12 && periodObj.EndTime == 18)
                periodSelected = "Afternoon";
            else if (periodObj.StartTime == 18 && periodObj.EndTime == 24)
                periodSelected = "Night";
            else if (periodObj.StartTime == 0 && periodObj.EndTime == 6)
                periodSelected = "Dawn";
            else if (periodObj.StartTime == 0 && periodObj.EndTime == 1)
                periodSelected = "0";
            else periodSelected = parseInt(periodObj.StartTime) + 1;

            return periodSelected;
        }
    }

    $.fn.busSearchEngine = function () {
        return Util.pluginDefaultBehavior(this, "busSearchEngine", arguments, function () { return new BusSearchEngine() });
    }

})(jQuery);

ï»¿/// <reference path="WebCommon/Scripts/Libraries/Util.js" />
/// <reference path="WebCommon/Scripts/Libraries/DatePickerOption.js" />
/// <reference path="WebCommon/Scripts/Libraries/Libraries/Jquery.js" />

(function ($) {

    function HotelSearchEngine() {
        var component = undefined;
        var thisSearchEngine = this;
        var settings = {
            data: {},
            template: undefined,
            templateOptions: {},
            minDaysToSearch: 0,
            useMinDaysToSearchToCheckout: false,
            maxDaysToSearch: 30,
            maxPeriodToSearch: 30,
            calcCheckoutMaxDateFromToday: false,
            maxGuestQuantities: 999999,
            maxGuestChildrenQuantities: 0,
            validateNeedMoreAdultsThanInfants: false,
            useScrollOnPesqInc: false,
            applyStatusClassesOnPesqInc: true,
            applyFixedClassOnPesqInc: false,
            applycorrectDateRules: true,
            onChangeTheGuestsQtd: true,
            locationId: undefined,
            hotelId: undefined,
            hotelName: undefined,
            source: undefined,
            controllers: {
                messagesController: undefined,
                locationsController: undefined,
                searchController: undefined
            },
            events: {
                displayRooms: undefined,
                displayChildrenAges: undefined,
                afterInitialize: undefined
            },
            components: {
                hotel: {
                    location: '.txtLocation',
                    checkIn: '.txtCheckIn',
                    checkInCalendarIcon: '#checkInCalendarIcon',
                    checkOut: '.txtCheckOut',
                    checkOutCalendarIcon: '#checkOutCalendarIcon',
                    name: '.hotelName',
                    source: '.hotelSource',
                    chainCode: '.chainCode',
                    chainCodes: '.chainsList',
                    chainCodesContainer: '#hotelChainsEngine',
                    
                    commercialAgreements: '.commercialAgreementsList',
                    hotelCommercialAgreementsContainer: '#hotelCommercialAgreements',

                    rooms: '.drpRoomsQtd',
                    roomContainer: '.search-engine-roomContainer',
                    childrenAge: '.childrenAge',
                    childrenAgeTitle: '.ages-title',
                    childrenAgeDisplay: '.child-ages',
                    childrenAgeQntd: '.qtd-children',
                    childrensQtdRoom: ".childrensQtdRoom", //
                    searchForPackageComposition: '.searchForPackageComposition',
                    guests: {
                        adults: '#drpAdultsQtdRoom',
                        childrens: '#drpChildrenQtdRoom',
                        childrensAge: '#drpChildAge'
                    },
                    clearSearchParams: '.clearSearchParams'
                },
                searchEngineCombos: '#combos'
            },
            componentsOptions: {
                hasDatepicker: 'hasDatepicker',
                childreenAgesSiblingsClass: '.child-ages',
                comboBoxClass: 'multi_options',
                comboDivisoria: '.Motor_Divisoria',
                locationValidatorClass: 'just-letters-for-locations',
                updateValueCompleteClass: 'autocomplete_completed',
                customCheckedClass: 'current'
            },
            exhibitionType: undefined,
            showCombos: false,
            searchEngineTab: false,
            searchType: 1,
            defaultDestinationId: 0,
            defaultCheckIn: undefined,
            defaultCheckOut: undefined,
            extraParameters: undefined,
            defaultSearchData: undefined
        };
        var pesqIncConfig = {};
        var _gtagEventCategory = "Motor de hotel";
        var _rootSystemAccountInfo = Util.GetRootSystemAccountInfo();

        this.initialize = function (target, opts) {

            component = $(target);

            $.extend(true, settings, opts || {});

            _formatSettingsValues();

            _attachEvents();

            _setLiveEvents();

        };

        this.render = function () {
            _selectComponents();

            component.html(settings.template(settings));

            if (settings.events.posRender)
                settings.events.posRender(settings);

            _selectComponents();

            _initHotel();

            _setValidators();

            _showCombos();
        }

        this.setOptions = function (options) {
            $.extend(true, settings, options);
        }

        this.getData = function () {
            var searchParameters = {};

            searchParameters.CompanyId = 0;

            searchParameters.Hotel = {};

            var numberOfRooms = Util.GetComponentValue(settings.components.hotel.rooms);
            searchParameters.Hotel.RoomsRequest = [];

            for (var i = 0; i < numberOfRooms; i++) {
                var ChildrenByRoom = [];

                var numberOfChildren = Util.GetComponentValue($(settings.components.hotel.guests.childrens.selector + i, component));
                for (var j = 0; j < numberOfChildren; j++)
                    ChildrenByRoom.push(Util.GetComponentValue($(settings.components.hotel.guests.childrensAge.selector + i.toString() + j.toString(), component)));

                var numberOfAdultsAux = Util.GetComponentValue($(settings.components.hotel.guests.adults.selector + i, component));
                var numberOfAdults = numberOfAdultsAux.length ? numberOfAdultsAux[0] : numberOfAdultsAux;

                searchParameters.Hotel.RoomsRequest.push({ Adults: numberOfAdults, ChildAges: ChildrenByRoom });
            }

            if (settings.components.hotel.checkIn.length && settings.components.hotel.checkIn.datepickermanager("val") != "")
                searchParameters.Hotel.CheckIn = settings.components.hotel.checkIn.datepickermanager("val").toDateValues();

            if (settings.components.hotel.checkOut.length && settings.components.hotel.checkOut.datepickermanager("val") != "")
                searchParameters.Hotel.CheckOut = settings.components.hotel.checkOut.datepickermanager("val").toDateValues();

            if (!settings.locationId) {
                var destination = null;

                var destinationComponentConfig = _getComponentSettings("Destination");
                var destinationComponentIsSelect = destinationComponentConfig && destinationComponentConfig.ComponentType == "Select";
                if (destinationComponentIsSelect) {
                    var destinationId = settings.components.hotel.location.val();
                    destination = settings.destinationLocations.first(function (l) { return l.id == destinationId; });
                }
                else
                    destination = settings.components.hotel.location.locationsFinder ? settings.components.hotel.location.locationsFinder("getData") : undefined;

                if (destination) {
                    searchParameters.Hotel.LocationId = destination ? destination.id : 0;
                    searchParameters.Hotel.LocationCode = destination.co;
                    searchParameters.Hotel.LocationData = destination;

                    if (destinationComponentIsSelect)
                        searchParameters.Hotel.Location = destination.n;
                    else
                        searchParameters.Hotel.Location = settings.components.hotel.location.length ? settings.components.hotel.location.val() : '';

                    if (searchParameters.Hotel.Location.length == 3)
                        searchParameters.Hotel.Location = searchParameters.Hotel.Location.toUpperCase();
                }
            }
            else
                searchParameters.Hotel.LocationId = settings.locationId;

            searchParameters.Hotel.ChainCode = settings.components.hotel.chainCode.val();

            if (Util.HasCount(settings.components.hotel.chainCodes))
                searchParameters.Hotel.ChainCodes = settings.components.hotel.chainCodes.val();

            if (Util.HasCount(settings.components.hotel.commercialAgreements))
                searchParameters.Hotel.CommercialAgreements = settings.components.hotel.commercialAgreements.val();

            searchParameters.Hotel.Name = settings.hotelName || settings.components.hotel.name.val();
            searchParameters.Hotel.Sources = [];

            var selectedSource = settings.source || settings.components.hotel.source.find("option:selected").val();

            if (selectedSource && selectedSource.trim() != '-')
                searchParameters.Hotel.Sources.push(selectedSource);

            searchParameters.SearchForPackageComposition = Util.IsChecked(settings.components.hotel.searchForPackageComposition);

            _getHotelRequestData(searchParameters);

            $.extend(true, searchParameters, settings.defaultSearchData);

            searchParameters.UserParameters = {
                PagingData: {
                    PageIndex: 0,
                    ItemsPerPage: 10,
                    StartIndex: 0
                }
            };

            if (Util.IsAbleToSendGtagEvents(_rootSystemAccountInfo))
                _sendGtagEvents(searchParameters);

            return searchParameters;
        }

        this.fillValues = function (data) {
            if (data && !$.isEmptyObject(data)) {
                //Valores de origem, destino, outbound e inbound de air
                var airDestinationData = undefined,
                    airInboundData = undefined,
                    airOutboundData = undefined;
                if (data.Air) {
                    if (data.Air.Destinations.length) {
                        if (data.Air.Destinations[0].DestinationData)
                            airDestinationData = data.Air.Destinations[0].DestinationData;
                        if (data.Air.Destinations[0].OutboundDate)
                            airOutboundData = formatter.dateValuesToDate(data.Air.Destinations[0].OutboundDate);
                        if (data.Air.Destinations[0].InboundDate)
                            airInboundData = formatter.dateValuesToDate(data.Air.Destinations[0].InboundDate);
                    }

                    if (data.Hotel) {
                        if (!_compareAirPassengersWithHotelGuests(data.Air, data.Hotel))
                            data.Hotel.RoomsRequest = _convertAirPassengersToHotelRoomRequest(data.Air);
                    }
                }

                if (data.Hotel)
                    data = data.Hotel;

                if (data.LocationData)
                    settings.components.hotel.location.locationsFinder("setData", data.LocationData);
                else if (data.LocationId)
                    settings.components.hotel.location.locationsFinder("setDataById", data.LocationId);
                else if (airDestinationData)
                    settings.components.hotel.location.locationsFinder("setData", airDestinationData);
                else if (data.Location) {
                    settings.components.hotel.location.val(data.Location);
                }

                if (data.Name)
                    settings.components.hotel.name.val(data.Name);

                if (data.CheckIn && data.CheckIn.isValid) {
                    settings.components.hotel.checkIn.datepickermanager("setDate", formatter.dateValuesToDate(data.CheckIn))
                    settings.components.hotel.checkIn.datepickermanager("val", formatter.dateValuesShort(data.CheckIn));
                    _checkInDateRules();
                } else if (airOutboundData) {
                    var maxDate = settings.components.hotel.checkIn.datepickermanager("option", "maxDate");
                    var minDate = settings.components.hotel.checkIn.datepickermanager("option", "minDate");
                    var checkinDate = (airOutboundData >= minDate) ? ((airOutboundData <= maxDate) ? airOutboundData : maxDate) : minDate;
                    settings.components.hotel.checkIn.datepickermanager("setDate", checkinDate)
                    settings.components.hotel.checkIn.datepickermanager("val", formatter.dateValuesShort(checkinDate.toDateValues()));
                    _checkOutDateRules();
                }

                if (data.CheckOut && data.CheckOut.isValid) {
                    settings.components.hotel.checkOut.datepickermanager("setDate", formatter.dateValuesToDate(data.CheckOut));
                    settings.components.hotel.checkOut.datepickermanager("val", formatter.dateValuesShort(data.CheckOut));
                } else if (airInboundData) {
                    var maxDate = settings.components.hotel.checkOut.datepickermanager("option", "maxDate");
                    var minDate = settings.components.hotel.checkOut.datepickermanager("option", "minDate");
                    var checkoutDate = (airInboundData >= minDate) ? ((airInboundData <= maxDate) ? airInboundData : maxDate) : minDate;
                    settings.components.hotel.checkOut.datepickermanager("setDate", checkoutDate);
                    settings.components.hotel.checkOut.datepickermanager("val", formatter.dateValuesShort(checkoutDate.toDateValues()));
                }

                if (data.RoomsRequest) {
                    _fillHotelRoomsRequest(data);
                    _displayRooms();
                }
            }
        }

        this.updateValues = function (searchParameters) {

            if (searchParameters) {

                if (searchParameters.DestinationLocationData)
                    settings.components.hotel.location.addClass(settings.componentsOptions.updateValueCompleteClass).locationsFinder("setData", searchParameters.DestinationLocationData);
                else if (searchParameters.DestinationLocation)
                    settings.components.hotel.location.addClass(settings.componentsOptions.updateValueCompleteClass).val(searchParameters.DestinationLocation);
                //else
                //settings.components.hotel.location.removeClass(settings.componentsOptions.updateValueCompleteClass).val("").locationsFinder("setData", 0);

                if (searchParameters.StartDate) {
                    settings.components.hotel.checkIn.datepickermanager("val", formatter.dateValuesShort(searchParameters.StartDate)).datepickermanager("setDate", formatter.dateValuesToDate(searchParameters.StartDate));
                    _checkInDateRules();
                } else {
                    settings.components.hotel.checkIn.datepickermanager("val", "").datepickermanager("setDate", undefined);
                }

                if (searchParameters.EndDate) {
                    settings.components.hotel.checkOut.datepickermanager("val", formatter.dateValuesShort(searchParameters.EndDate)).datepickermanager("setDate", formatter.dateValuesToDate(searchParameters.EndDate));
                    _checkOutDateRules();
                } else {
                    settings.components.hotel.checkOut.datepickermanager("val", "").datepickermanager("setDate", undefined);
                }

                settings.components.hotel.searchForPackageComposition.setCheck(searchParameters.SearchForPackageComposition);

                var consumerSummary = searchParameters.ConsumerSummary;

                if (searchParameters.ConsumerSummary || searchParameters.ConsumerGroups) {
                    if (!consumerSummary) {
                        _fillHotelRoomsRequest(searchParameters.ConsumerGroups);
                    } else {
                        var consumerTotals = searchParameters.getConsumerTotals();
                        if (consumerTotals && settings.onChangeTheGuestsQtd && (consumerTotals.Adults != searchParameters.ConsumerSummary.Adults || consumerTotals.Babies != searchParameters.ConsumerSummary.Babies || consumerTotals.Childrens != searchParameters.ConsumerSummary.Childrens))
                            _fillHotelRoomsRequest(searchParameters.getConsumerSummaryGrouped());
                        else
                            _fillHotelRoomsRequest(searchParameters.ConsumerGroups);
                    }
                    _displayRooms();
                }

                if (searchParameters.Hotel && searchParameters.Hotel.HotelName != undefined)
                    settings.components.hotel.name.val(searchParameters.Hotel.HotelName);
            }
        }

        this.validate = function (isOffline) {
            var errors = [];

            _validateHotelLocation(errors);
            _validateHotelGuests(errors);

            SharedFunctions.ValidateContext(errors);

            if (settings.controllers.messagesController)
                settings.controllers.messagesController.notifyMessages(errors, settings.exhibitionType);

            var validated = errors.length == 0;

            errors = _validateHotelDates(isOffline);

            validated = errors.length == 0 && validated;

            var hotelMaxSearchDays = '0';
            if ((typeof Ide != 'undefined') && Ide.applicationSettings) {
                hotelMaxSearchDays = Ide.applicationSettings.HotelMaxSearchDays;
            } else {
                hotelMaxSearchDays = Global.Settings.HotelMaxSearchDays;
            }

            
            if (!isOffline && settings.controllers.messagesController && hotelMaxSearchDays != '0')
                settings.controllers.messagesController.notifyMessages(errors, EnumHelper.MessagesExhibitor.ExhibitionType.Alert, EnumHelper.MessagesExhibitor.Type.Warning);
            else if (settings.controllers.messagesController)
                settings.controllers.messagesController.notifyMessages(errors, settings.exhibitionType);
                
            return validated;
        }

        this.readQueryString = function (queryString) {

            var searchParameters = {};

            searchParameters.Hotel = {};

            var numberOfRooms = Util.QueryString("Rooms", queryString);
            searchParameters.Hotel.RoomsRequest = [];

            for (var i = 0; i < numberOfRooms; i++) {
                var ChildrenByRoom = [];

                var numberOfChildren = Util.QueryString("Children", queryString).split(",")[i];
                var ChildrenAgesByRoom = Util.QueryString("ChildAges", queryString).split(";");

                for (var j = 0; j < numberOfChildren; j++)
                    ChildrenByRoom.push(ChildrenAgesByRoom[i].split(",")[j].replaceAll("%3C1", "0").replaceAll("<1", "0"));

                var numberOfAdults = Util.QueryString("Adults", queryString).split(",")[i];
                searchParameters.Hotel.RoomsRequest.push({ Adults: numberOfAdults, ChildAges: ChildrenByRoom });
            }

            searchParameters.Hotel.CheckIn = Util.QueryString("CheckIn", queryString).toDateValues('pt');
            searchParameters.Hotel.CheckOut = Util.QueryString("CheckOut", queryString).toDateValues('pt');

            var destination = "";
            var location = Util.QueryString("Location", queryString)
            if (location) {
                location = location.replaceAll("%20", " ").replaceAll("---", ")").replaceAll("--", "(");
                destination = location;
            }

            searchParameters.Hotel.LocationId = Util.QueryString("LocationId", queryString);

            if (destination) {
                if (Global.LocationsCache && Global.LocationsCache.length > 0) {
                    var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.d == $.trim(destination) });

                    if (auxLocationData.length > 0)
                        searchParameters.Hotel.LocationData = auxLocationData[0];
                }
                else {
                    searchParameters.Hotel.LocationData = destination;
                }
            }

            if (location) {
                searchParameters.Hotel.Location = location;
            }

            if (searchParameters.Hotel.Location.length == 3)
                searchParameters.Hotel.Location = searchParameters.Hotel.Location.toUpperCase();

            var hotelName = Util.QueryString("HotelName", queryString);
            if (hotelName)
                searchParameters.Hotel.Name = decodeURI(hotelName);

            if (!searchParameters.AdditionalInfo)
                searchParameters.AdditionalInfo = {};

            var isCruise = Util.QueryString("IsCruise", queryString);
            if (isCruise)
                searchParameters.AdditionalInfo.IsCruise = isCruise;

            var cruiseType = Util.QueryString("CruiseType", queryString);
            if (cruiseType)
                searchParameters.AdditionalInfo.CruiseType = cruiseType;

            _getHotelRequestData(searchParameters);

            if (Util.QueryString("RoomSharingCode", queryString) && Util.QueryString("RoomSharingCode", queryString).length)
                Global.InterfaceEnvelope.RoomSharingCode = Util.QueryString("RoomSharingCode", queryString);

            if (!searchParameters.hasOwnProperty("UserParameters")) {
                searchParameters.UserParameters = {
                    PagingData: {
                        PageIndex: 0,
                        ItemsPerPage: 10,
                        StartIndex: 0
                    }
                };
            }

            return searchParameters;
        }

        this.getQueryString = function (pageUrl) {
            var data = thisSearchEngine.getData();

            pageUrl = pageUrl + "?SearchType=Hotel";

            var querystring = "";

            querystring += "&Location=" + settings.components.hotel.location.getSelectedLocationName().removeDiacritics().split("-")[0];
            querystring += "&LocationId=" + data.Hotel.LocationId;
            querystring += "&CheckIn=" + _getQueryStringUtilFunctions.GetDatePattern(data.Hotel.CheckIn);
            querystring += "&CheckOut=" + _getQueryStringUtilFunctions.GetDatePattern(data.Hotel.CheckOut);
            querystring += "&Rooms=" + data.Hotel.RoomsRequest.length;
            querystring += "&Adults=" + _getQueryStringUtilFunctions.GetAdults(data.Hotel.RoomsRequest);
            querystring += "&Children=" + _getQueryStringUtilFunctions.GetChildren(data.Hotel.RoomsRequest);
            querystring += "&ChildAges=" + _getQueryStringUtilFunctions.GetChildAges(data.Hotel.RoomsRequest);
            querystring += "&HotelName=" + data.Hotel.Name;

            return pageUrl + querystring;
        }

        this.getGenericData = function (getConsumersTotals) {

            var data = thisSearchEngine.getData();
            var genericData = { Hotel: {} };

            genericData.SearchForPackageComposition = data.SearchForPackageComposition;
            genericData.DestinationLocation = data.Hotel.Location;
            genericData.DestinationLocationData = data.Hotel.LocationData ? data.Hotel.LocationData : null;
            genericData.StartDate = data.Hotel.CheckIn ? data.Hotel.CheckIn : null;
            genericData.EndDate = data.Hotel.CheckOut ? data.Hotel.CheckOut : null;

            genericData.ConsumerGroups = data.Hotel.RoomsRequest;
            genericData.ConsumerSummary = getConsumersTotals(data.Hotel.RoomsRequest);

            genericData.Hotel.HotelName = data.Hotel.Name;

            return genericData;
        }

        function _formatSettingsValues() {
            if (settings.defaultSearchData) {
                if (typeof (settings.defaultSearchData) == 'string')
                    settings.defaultSearchData = JSON.parse(settings.defaultSearchData);
            }

            if (settings.componentsSettings) {
                if (typeof (settings.componentsSettings) == 'string')
                    settings.componentsSettings = JSON.parse(settings.componentsSettings);
            }
        };

        function _dettachEvents() {
        }

        function _attachEvents() {
            if (Global.CompanyContextController && Global.CompanyContextController.changeCompanyContextCompleted) {
                Global.CompanyContextController.changeCompanyContextCompleted.attach(function () {
                    if (Ide.companyContext && Ide.companyContext.ConnectionContextSummary && Ide.companyContext.ConnectionContextSummary.SummarySource) {

                        settings.components.hotel.source.empty();

                        settings.components.hotel.source.append('<option>-</option>');

                        for (var i = 0; i < Ide.companyContext.ConnectionContextSummary.SummarySource.length; i++) {
                            var summary = Ide.companyContext.ConnectionContextSummary.SummarySource[i];

                            if (summary.ProductTypes.any(EnumHelper.ProductType[1]))
                                settings.components.hotel.source.append('<option value="{0}">{1}</option>'.format([summary.Source, summary.SourceAlias]));
                        }
                    }
                });
            }

            var destinationComponentConfig = _getComponentSettings("Destination");
            if (destinationComponentConfig &&
                destinationComponentConfig.ComponentType &&
                destinationComponentConfig.ComponentType.toLowerCase() == "select" &&
                destinationComponentConfig.FillSettings &&
                destinationComponentConfig.FillSettings.Mode == "Before" &&
                settings.controllers.searchController &&
                settings.controllers.searchController.loadHotelLocationsCompleted) {

                settings.controllers.searchController.loadHotelLocationsCompleted.attach(function (response) {
                    if (Util.HasCount(response.Locations)) {
                        settings.destinationLocations = response.Locations;

                        settings.components.hotel.location.empty();
                        settings.components.hotel.location.append("<option value>" + Resources.translate({ code: 'Select' }) + "</option>");
                        for (var i = 0; i < response.Locations.length; i++) {
                            var location = response.Locations[i];
                            settings.components.hotel.location.append("<option value=" + location.id + ">" + location.n + "</option>");
                        }
                    }
                });
            }
        }

        function _setLiveEvents() {
            _selectComponents();

            $(component).off('click', settings.components.hotel.clearSearchParams.selector).on('click', settings.components.hotel.clearSearchParams.selector, thisSearchEngine.render);
            $(component).off('click', settings.components.hotel.checkInCalendarIcon.selector).on('click', settings.components.hotel.checkInCalendarIcon.selector, _onClickCheckInCalendarIcon);
            $(component).off('click', settings.components.hotel.checkOutCalendarIcon.selector).on('click', settings.components.hotel.checkOutCalendarIcon.selector, _onClickCheckOutCalendarIcon);

            var eventChangeDate = (Global.Mobile) ? 'blur' : 'change';

            $(component).off('change', settings.components.hotel.rooms.selector).on('change', settings.components.hotel.rooms.selector, _displayRooms);
            $(component).off(eventChangeDate, settings.components.hotel.checkIn.selector).on(eventChangeDate, settings.components.hotel.checkIn.selector, _checkInDateRules);
            $(component).off(eventChangeDate, settings.components.hotel.checkOut.selector).on(eventChangeDate, settings.components.hotel.checkOut.selector, _checkOutDateRules);

            if (!Global.Mobile) {
                $(component).off('keyup', settings.components.hotel.checkOut.selector).on('keyup', settings.components.hotel.checkOut.selector, Util.ForceMaskDate);
                $(component).off('keyup', settings.components.hotel.checkIn.selector).on('keyup', settings.components.hotel.checkIn.selector, Util.ForceMaskDate);
            }

            $(component).off('change', settings.components.hotel.childrensQtdRoom.selector).on('change', settings.components.hotel.childrensQtdRoom.selector, _onChangeRoomChildQuantity);

            var datePickerEvent = Global && Global.Mobile ? 'blur' : 'change';
            $(component).off(datePickerEvent, settings.components.hotel.checkIn.selector).on(datePickerEvent, settings.components.hotel.checkIn.selector, _checkInDateRules);

            $(component).off('change', settings.components.hotel.source.selector).on('change', settings.components.hotel.source.selector, _onChangeSourceSelection);
        }

        function _onChangeSourceSelection() {
            var source = $(settings.components.hotel.source).val();

            if (source == "SabreCSL") {
                $(settings.components.hotel.chainCodesContainer).show();
            }
            else {
                $(settings.components.hotel.chainCodesContainer).hide();
            }

            if (source) {
                settings.controllers.searchController.getHotelCommercialAgreements(thisSearchEngine.getData());
                settings.controllers.searchController.getHotelCommercialAgreementsCompleted.attach(function (res) {
                    settings.components.hotel.commercialAgreements.empty().trigger("change");

                    if (res.CommercialAgreements && res.CommercialAgreements.length) {
                        $(settings.components.hotel.hotelCommercialAgreementsContainer).show();

                        for (var i = 0; i < res.CommercialAgreements.length; i++) {
                            var option = new Option(res.CommercialAgreements[i].Name, res.CommercialAgreements[i].AgreementCode, false, false);
                            settings.components.hotel.commercialAgreements.append(option).trigger("change");
                        }
                    }
                    else {
                        $(settings.components.hotel.hotelCommercialAgreementsContainer).hide();
                    }

                }, undefined, undefined, true);
            }
        }

        function _onClickCheckInCalendarIcon() {
            settings.components.hotel.checkIn.datepickermanager("show");
        }

        function _onClickCheckOutCalendarIcon() {
            settings.components.hotel.checkOut.datepickermanager("show");
        }

        function _fillHotelRoomsRequest(data) {
            var isCustomElements = $(settings.components.hotel.guests.adults.selector + '0', component).hasClass('multi_options');

            if (!isCustomElements)
                settings.components.hotel.rooms.val(data.RoomsRequest.length);
            else
                $(settings.components.hotel.rooms.selector, component).setSelectedValue(data.RoomsRequest.length).trigger('change');

            for (var i = 0; i < data.RoomsRequest.length; i++) {

                var room = data.RoomsRequest[i];

                if (!isCustomElements) {
                    $(settings.components.hotel.guests.adults.selector + i).val(room.Adults);
                    $(settings.components.hotel.guests.childrens.selector + i).val(room.ChildAges ? room.ChildAges.length : 0);

                    if (room.ChildAges) {
                        for (var c = 0; c < room.ChildAges.length; c++)
                            $(settings.components.hotel.guests.childrensAge.selector + i + "" + c).val(room.ChildAges[c]);
                    }
                }
                else {
                    $(settings.components.hotel.guests.adults.selector + i, component).setSelectedValue(room.Adults);
                    $(settings.components.hotel.guests.childrens.selector + i, component).setSelectedValue(room.ChildAges.length);
                    if (room.ChildAges.length) {
                        $(settings.components.hotel.guests.childrens.selector + i, component).trigger('change');
                        for (var c = 0, len = room.ChildAges.length; c < len; c++)
                            _fillChildrenAge($(settings.components.hotel.guests.childrensAge.selector + i + "" + c, component), room.ChildAges[c]);
                    }
                }
            }
        };

        function _fillChildrenAge(childrenAgeComponent, age) {
            childrenAgeComponent.setSelectedValue(age);
            $('a.current', childrenAgeComponent).click();
        };

        function _setPesqIncConfig() {
            pesqIncConfig = {
                SearchType: Global.SearchTypes.Full,
                maxResultsClient: 15,
                maxResultsServer: 5,
                idealNumberOfProximities: 6,
                idealNumberOfProximitiesRoots: 3,
                useCacheEnhancer: true,
                onlyHalfClientResults: true,
                onDropBoxSelect: function () { },
                clientCache: Global.LocationsCache,
                useScroll: settings.useScrollOnPesqInc,
                applyStatusClasses: settings.applyStatusClassesOnPesqInc,
                applyFixedClass: settings.applyFixedClassOnPesqInc,
                controllers: {
                    locationsController: Global.LocationsController
                },
                columns: {
                    googleIdentifier: true,
                    type: false,
                    name: true,
                    h: false
                }
            };
        }

        function _getComponentsSettings() {
            if (settings.componentsSettings) {
                return settings.componentsSettings;
            } else {
                return null;
            }
        }

        function _getComponentSettings(componentName) {
            var configs = _getComponentsSettings();
            if (configs)
                return configs[componentName];
            else
                return null;
        }

        function _initHotel() {

            var settingsDatePicker = {
                numberOfMonths: (Global.Mobile) ? 1 : 2,
                'minDate': Util.CreateAbsoluteDate().addDaysSafe(parseInt(settings.minDaysToSearch, 10)),
                'maxDate': Util.CreateAbsoluteDate().addDaysSafe(parseInt(settings.maxDaysToSearch, 10))
            };

            _initHotelDatePickers(settingsDatePicker);

            var destinationComponentConfig = _getComponentSettings("Destination");

            if (destinationComponentConfig &&
                destinationComponentConfig.ComponentType &&
                destinationComponentConfig.ComponentType.toLowerCase() == "select" &&
                destinationComponentConfig.FillSettings &&
                destinationComponentConfig.FillSettings.Mode == "Before" &&
                settings.controllers.searchController) {

                settings.controllers.searchController.loadHotelLocations({
                    ChainCode: destinationComponentConfig.FillSettings.ChainCode,
                    Sources: destinationComponentConfig.FillSettings.Sources
                });

            } else if ($.fn.locationsFinder && settings.controllers.locationsController && !settings.locationId) {
                _setPesqIncConfig();
                pesqIncConfig.CurrentProduct = Global.Product.Hotel;
                pesqIncConfig.IsAirport = false;
                pesqIncConfig.HasHotelCode = true;
                pesqIncConfig.HasIata = false;

                settings.components.hotel.location.locationsFinder(pesqIncConfig).click(function () { $(this).select(); });

                if (settings.defaultDestinationId) {
                    var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(settings.defaultDestinationId); });

                    if (auxLocationData.length > 0)
                        settings.components.hotel.location.locationsFinder('setData', auxLocationData[0]);
                }
            }

            if (settings.lockDestination == "true")
                $(settings.components.hotel.location).attr("disabled", "disabled");

            if (settings.defaultHotelName)
                $(settings.components.hotel.name).val(settings.defaultHotelName);

            if (settings.lockHotelName == "true")
                $(settings.components.hotel.name).attr("disabled", "disabled");

            if (Util.HasCount(settings.components.hotel.chainCodes) && settings.components.hotel.chainCodes.select2)
                settings.components.hotel.chainCodes.select2();

            if(settings.components.hotel.commercialAgreements.select2)
                settings.components.hotel.commercialAgreements.select2();

            if (settings.events.afterInitialize)
                settings.events.afterInitialize(settings);
        }

        function _initHotelDatePickers(settingsDatePicker) {
            if (settings.calcCheckoutMaxDateFromToday)
                settingsDatePicker.maxDate = settingsDatePicker.maxDate.addDaysSafe(-1);

            settings.components.hotel.checkIn.removeClass(settings.componentsOptions.hasDatepicker).datepickermanager('destroy').datepickermanager(DatePickerOption(settingsDatePicker));
            settings.components.hotel.checkOut.removeClass(settings.componentsOptions.hasDatepicker).datepickermanager('destroy').datepickermanager(DatePickerOption(settingsDatePicker));

            _setDefaultDate(settings.defaultCheckIn, settings.components.hotel.checkIn);
            _checkInDateRules();
            _setDefaultDate(settings.defaultCheckOut, settings.components.hotel.checkOut);

            if (settings.lockCheckin == "true")
                settings.components.hotel.checkIn.attr("disabled", "disabled");
            if (settings.lockCheckout == "true")
                settings.components.hotel.checkOut.attr("disabled", "disabled");
        }

        function _setDefaultDate(defaultDate, $component) {
            if (defaultDate) {
                var date = defaultDate.toDateValues();

                if (date.isValid) {
                    $component.datepickermanager("setDate", formatter.dateValuesToDate(date))
                        .datepickermanager("val", formatter.dateValuesShort(date));
                }
            }
        }

        function _onChangeRoomChildQuantity() {
            var $t = $(this);
            var value = parseInt($t.val());
            var $room = $t.closest(".search-engine-roomContainer");
            var $roomChildAgeContainer = $(".child_years_old", $room);

            if (value > 0)
                $roomChildAgeContainer.removeClass("hide");
            else
                $roomChildAgeContainer.addClass("hide");

            $(".roomChildAges", $room).addClass("hide");

            for (var i = 0; i < value; i++)
                $(".roomChildAges", $room).eq(i).removeClass("hide");
        }

        function _displayChildrenAges() {
            var ctrl = $(this);
            ctrl.siblings(settings.componentsOptions.childreenAgesSiblingsClass).hide();
            settings.components.hotel.childrenAgeTitle.hide();

            settings.components.hotel.childrenAgeQntd.each(function () {
                if (Util.GetComponentValue($(this)) > 0)
                    settings.components.hotel.childrenAgeTitle.show();
            });

            for (var child = 0; child < Util.GetComponentValue(ctrl); child++)
                ctrl.siblings(settings.componentsOptions.childreenAgesSiblingsClass).eq(child).show();

            if (Util.GetComponentValue(ctrl) == '0')
                settings.components.hotel.childrenAge.hide();
            else
                settings.components.hotel.childrenAge.show();
        }

        function _displayRooms() {
            if (settings.components.hotel && settings.components.hotel.rooms && settings.components.hotel.rooms.length && settings.components.hotel.rooms.val().length == 0) {

                var roomsQuantity = Util.GetComponentValue(settings.components.hotel.rooms);

                roomsQuantity = roomsQuantity == undefined ? 1 : roomsQuantity;

                var rooms = settings.components.hotel.roomContainer.hide();

                for (var i = 0; i < roomsQuantity; i++)
                    rooms.eq(i).show();
            } else {
                if (settings.events.displayRooms)
                    settings.events.displayRooms(settings.components.hotel.rooms.val());
                else {
                    var numberOfRooms = settings.components.hotel.rooms.val();

                    var roomContainers = settings.components.hotel.roomContainer.hide().addClass('hide');

                    settings.components.hotel.childrenAgeTitle.hide();

                    for (var i = 0; i < numberOfRooms; i++) {
                        var roomContainer = roomContainers.eq(i).show().removeClass('hide');
                        var qtdChildren = settings.components.hotel.childrenAgeQntd.eq(i).change();// val();
                        if (qtdChildren > 0) {
                            settings.components.hotel.childrenAgeTitle.show().removeClass('hide');

                            var childAges = roomContainer.find(settings.components.hotel.childrenAgeDisplay);
                            for (var j = 0; j < qtdChildren; j++) {
                                childAges.eq(j).show().removeClass('hide');
                            }
                        }
                    }
                }
            }
        }

        function _checkInDateRules() {
            if (settings.applycorrectDateRules) {
                _applyMinDateRules(settings.components.hotel.checkIn);
                _applyMaxDateRules(settings.components.hotel.checkIn);
            }
            var checkInDate = settings.components.hotel.checkIn.datepickermanager("getDate");
            var refToCalcCheckoutMaxDate = settings.calcCheckoutMaxDateFromToday ? (new Date()) : checkInDate;

            if (checkInDate != null) {
                var minDate = checkInDate;
                if (settings.useMinDaysToSearchToCheckout)
                    minDate = checkInDate.addDaysSafe(settings.minDaysToSearch);

                var maxDate = refToCalcCheckoutMaxDate.addDaysSafe(settings.maxPeriodToSearch);

                settings.components.hotel.checkOut.datepickermanager("option", "minDate", minDate)
                    .datepickermanager("option", "maxDate", maxDate);
            }
        }

        function _checkOutDateRules() {
            if (settings.applycorrectDateRules) {
                _applyMinDateRules(settings.components.hotel.checkOut);
                _applyMaxDateRules(settings.components.hotel.checkOut);
            }
        }

        function _applyMinDateRules(ctrl) {
            var myDate = ctrl.datepickermanager("getDate");
            var minDate = ctrl.datepickermanager("option", "minDate");
            var currentDateValue = ctrl.datepickermanager("val").toDateValues();

            if (!myDate)
                myDate = minDate;

            if (myDate < minDate || (currentDateValue.isValid == false && ctrl.val() != "")) {
                ctrl.datepickermanager('setDate', minDate);

                settings.controllers.messagesController.notifyMessages(["ApplyCorrectDateRule"], settings.exhibitionType);
            }
        }

        function _applyMaxDateRules(ctrl) {
            var myDate = ctrl.datepickermanager("getDate");
            var minDate = ctrl.datepickermanager("option", "minDate");
            var maxDate = ctrl.datepickermanager("option", "maxDate");
            var currentDateValue = ctrl.datepickermanager("val").toDateValues();

            if (!myDate)
                myDate = maxDate;

            if (myDate > maxDate || (currentDateValue.isValid == false && ctrl.val() != "")) {
                ctrl.datepickermanager('setDate', minDate);

                settings.controllers.messagesController.notifyMessages(["ApplyCorrectDateRule"], settings.exhibitionType);
            }

        }

        function _setValidators() {
            settings.components.hotel.location.addClass(settings.componentsOptions.locationValidatorClass);
        }

        function _showCombos() {

            if (!settings.searchEngineTab) {
                if (settings.showCombos) {
                    settings.components.searchEngineCombos.show().next(settings.componentsOptions.comboDivisoria).show();
                    ctrl = settings.components.air.advancedSearch;
                } else {
                    settings.components.searchEngineCombos.hide().next(settings.componentsOptions.comboDivisoria).hide();
                }
            }
        }

        function _getHotelRequestData(searchParameters) {
            if (searchParameters && searchParameters.Hotel) {
                searchParameters.Hotel.RequestData = {};
                searchParameters.Hotel.RequestData.HotelName = searchParameters.Hotel.Name;
                searchParameters.Hotel.RequestData.ChainCode = searchParameters.Hotel.ChainCode;
                searchParameters.Hotel.RequestData.ChainCodes = searchParameters.Hotel.ChainCodes;
                searchParameters.Hotel.RequestData.CommercialAgreements = searchParameters.Hotel.CommercialAgreements;
                searchParameters.Hotel.RequestData.LocationId = searchParameters.Hotel.LocationId;
                searchParameters.Hotel.RequestData.LocationCode = searchParameters.Hotel.LocationCode;
                searchParameters.Hotel.RequestData.LocationData = searchParameters.Hotel.LocationData;
                searchParameters.Hotel.RequestData.Location = searchParameters.Hotel.Location;
                searchParameters.Hotel.RequestData.CheckIn = searchParameters.Hotel.CheckIn;
                searchParameters.Hotel.RequestData.CheckOut = searchParameters.Hotel.CheckOut;
                searchParameters.Hotel.RequestData.RoomsRequest = searchParameters.Hotel.RoomsRequest;
                searchParameters.Hotel.RequestData.HotelId = searchParameters.Hotel.HotelId;
                searchParameters.Hotel.RequestData.Source = searchParameters.Hotel.Source;
                searchParameters.Hotel.RequestData.Sources = searchParameters.Hotel.Sources;

                if (searchParameters.Hotel.AnotherDate != undefined)
                    searchParameters.Hotel.RequestData.AnotherDate = searchParameters.Hotel.AnotherDate;
            }
        }

        function _validateHotelLocation(errors) {
            if (!settings.locationId) {
                var destinationSetting = _getComponentSettings("Destination");
                if (destinationSetting && destinationSetting.ComponentType == "Select") {
                    var locationId = settings.components.hotel.location.val();
                    if (!locationId)
                        errors.push("OnSearch_InvalidCity");

                    var destination = settings.destinationLocations.first(function (l) { return l.id == locationId });
                    if (!destination)
                        errors.push("OnSearch_InvalidCity");

                } else {
                    var locationName = settings.components.hotel.location.val();

                    if (locationName != undefined) {

                        if (locationName == "") {
                            errors.push("OnSearch_NoCityName");
                        } else {
                            if (locationName.length < 3) {
                                errors.push("OnSearch_HotelCityNameLengthMoreThan3");
                            } else {
                                var location = settings.components.hotel.location.locationsFinder("getData");

                                if (!location)
                                    errors.push("OnSearch_InvalidCity");
                            }
                        }
                    }

                }
            }
        }

        function _validateHotelDates(isOffline) {
            var checkInDate = settings.components.hotel.checkIn.datepickermanager("val");
            var checkOutDate = settings.components.hotel.checkOut.datepickermanager("val");

            var errorsDate = [];

            if (checkInDate == "")
                errorsDate.push("OnSearch_CheckInDateFormat");
            else if (!checkInDate.isDate())
                errorsDate.push("OnSearch_InvalidCheckInDate");

            if (checkOutDate == "")
                errorsDate.push("OnSearch_CheckOutDateFormat");
            else if (!checkOutDate.isDate())
                errorsDate.push("OnSearch_InvalidCheckOutDate");

            if (errorsDate.length == 0) {
                if (checkInDate == checkOutDate)
                    errorsDate.push("OnSearchAirHotel_ChekinLessEqualsOutboundDate");
                else if (formatter.dateValuesToDate(checkInDate.toDateValues()) > formatter.dateValuesToDate(checkOutDate.toDateValues()))
                    errorsDate.push("OnSearchHotel_CheckoutLessEqualsCheckin");
                else {
                    var minDate = settings.components.hotel.checkIn.datepickermanager('option', 'minDate');
                    var maxDate = settings.components.hotel.checkOut.datepickermanager('option', 'maxDate');

                    if (formatter.dateValuesToDate(checkInDate.toDateValues()) < formatter.dateValuesToDate(minDate.toDateValues()))
                        errorsDate.push(["OnSearch_MinHoursHotel", settings.minDaysToSearch * 24]);
                    else if (formatter.dateValuesToDate(checkOutDate.toDateValues()) > formatter.dateValuesToDate(maxDate.toDateValues()))
                        errorsDate.push(["OnSearch_MaxDaysToChekoutDate", settings.maxDaysToSearch]);
                }
            }

            if (!isOffline) {
                var hotelMaxSearchDays = '0';
                if ((typeof Ide != 'undefined') && Ide.applicationSettings) {
                    hotelMaxSearchDays = Ide.applicationSettings.HotelMaxSearchDays;
                } else {
                    hotelMaxSearchDays = Global.Settings.HotelMaxSearchDays;
                }

                if (hotelMaxSearchDays && hotelMaxSearchDays != '0') {
                    var hostingDays = Util.DateValuesDiff(checkInDate.toDateValues(), checkOutDate.toDateValues(), 'd');

                    var hotelMaxSerachDaysInt = parseInt(hotelMaxSearchDays);

                    var hotelMaxSearchDaysMessage = '0';
                    if ((typeof Ide != 'undefined') && Ide.applicationSettings) {
                        hotelMaxSearchDaysMessage = Ide.applicationSettings.HotelMaxSearchDaysMessage;
                    } else {
                        hotelMaxSearchDaysMessage = Global.Settings.HotelMaxSearchDaysMessage;
                    }

                    if (hostingDays >= hotelMaxSerachDaysInt) {
                        var message = hotelMaxSearchDaysMessage;

                        if (!message) {
                            message = "OnSearch_MaxDaysToChekoutDate";
                        }

                        errorsDate.push([message, hotelMaxSearchDaysMessage]);
                    }
                }
            }

            return errorsDate;
        }

        function _validateHotelGuests(errors) {
            var hotelGuests = _getHotelGuestsQuantities();

            //if (hotelGuests.total > settings.maxGuestQuantities)
            //    errors.push(["OnSearch_NoMoreThanXGuests", settings.maxGuestQuantities]);
            if (settings.validateNeedMoreAdultsThanInfants && hotelGuests.babies > hotelGuests.adults)
                errors.push(["OnSearch_NeedMoreAdultsThanInfants"]);
        }

        function _getHotelGuestsQuantities() {
            var guests = {  
                babies: 0,
                adults: 0,
                children: 0,
                total: 0
            };
            var numberOfRooms = parseInt(Util.GetComponentValue(settings.components.hotel.rooms), 10);

            for (var i = 0; i < numberOfRooms; i++) {
                guests.adults += parseInt(Util.GetComponentValue($(settings.components.hotel.guests.adults.selector + i, component)), 10);

                var numberOfChildren = parseInt(Util.GetComponentValue($(settings.components.hotel.guests.childrens.selector + i, component)), 10);
                for (var j = 0; j < numberOfChildren; j++) {
                    var age = parseInt(Util.GetComponentValue($(settings.components.hotel.guests.childrensAge.selector + i.toString() + j.toString(), component)), 10);
                    age > 2 ? guests.children++ : guests.babies++;
                }
            }

            guests.total = guests.babies + guests.adults + guests.children;

            return guests;
        }

        var _getQueryStringUtilFunctions = new (function () {

            this.GetAdults = function (roomsRequest) {
                return roomsRequest.select(function (r) { return r.Adults; }).join(",");
            };

            this.GetChildren = function (roomsRequest) {
                return roomsRequest.select(function (r) { return r.ChildAges.length; }).join(",");
            };

            this.GetChildAges = function (roomsRequest) {
                return roomsRequest.select(function (r) { return r.ChildAges.join(","); }).join(";");
            };

            this.GetDatePattern = function (date) {
                return date.Day + '/' + date.Month + '/' + date.Year;
            };
        });

        function _selectComponents(components) {
            if (!components)
                components = settings.components;
            Util.SelectComponents(components, component, true);
        }

        function _sendGtagEvents(searchParameters) {
            var hotelSearchParameters = searchParameters.Hotel;
            
            _sendGtagSelectNameEvent(hotelSearchParameters);
            _sendGtagSelectSourcesEvent(hotelSearchParameters);
            _sendGtagSelectRoomsEvent(hotelSearchParameters);
            _sendGtagSearchEvent(hotelSearchParameters);
        }

        function _sendGtagSelectNameEvent(hotelSearchParameters, useCustomLabel) {
            if (hotelSearchParameters.Name) {
                var gtagEventLabel;

                if (useCustomLabel) {
                    var hotelName = hotelSearchParameters.Name.trim();    
                    gtagEventLabel = hotelName + ' - ' + _rootSystemAccountInfo;
                }

                Util.SendGtagEvent('select_name', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagSelectSourcesEvent(hotelSearchParameters, useCustomLabel) {
            if (hotelSearchParameters.Sources && hotelSearchParameters.Sources.length) {
                var sources = hotelSearchParameters.Sources.reduce(function (acc, cur, index) {
                    return Util.ConcatenateStringSeparatedBy("/", acc, cur, index);
                }, "");

                if (sources) {
                    var gtagEventLabel;

                    if (useCustomLabel)
                        gtagEventLabel = sources + ' - ' + _rootSystemAccountInfo;

                    Util.SendGtagEvent('select_sources', _gtagEventCategory, gtagEventLabel);
                }
            }
        }

        function _sendGtagSelectRoomsEvent(hotelSearchParameters, useCustomLabel) {
            if (hotelSearchParameters.RoomsRequest && hotelSearchParameters.RoomsRequest.length) {
                var roomsLength = hotelSearchParameters.RoomsRequest.length;
                var peoplePerRoom = hotelSearchParameters.RoomsRequest.reduce(function (acc, cur, index) {
                    var adults = "A" + cur.Adults;
                    var childs = "C" + cur.ChildAges.length;
                    var combine = adults + '-' + childs;

                    return Util.ConcatenateStringSeparatedBy("/", acc, combine, index);
                }, "");

                if (peoplePerRoom) {
                    var gtagEventLabel;

                    if (useCustomLabel)
                        gtagEventLabel = roomsLength + ': ' + peoplePerRoom + ' - ' + _rootSystemAccountInfo;
                    
                    Util.SendGtagEvent('select_rooms', _gtagEventCategory, gtagEventLabel);
                }
            }
        }

        function _sendGtagSearchEvent(hotelSearchParameters, useCustomLabel) {
            if (hotelSearchParameters.LocationId) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = hotelSearchParameters.LocationId + ' - ' + _rootSystemAccountInfo;

                Util.SendGtagEvent('search', _gtagEventCategory, gtagEventLabel);
            }
        }
    }

    $.fn.hotelSearchEngine = function () {
        return Util.pluginDefaultBehavior(this, "hotelSearchEngine", arguments, function () { return new HotelSearchEngine() });
    }

})(jQuery);


ï»¿/// <reference path="WebCommon/Scripts/Libraries/Util.js" />
/// <reference path="WebCommon/Scripts/Libraries/DatePickerOption.js" />
/// <reference path="WebCommon/Scripts/Libraries/Libraries/Jquery.js" />

(function ($) {

    function PackageSearchEngine() {

        var component = undefined;

        var _this = this;

        var _state = {
            searchOnlyLand: false
        }

        var _gtagEventCategory = "Motor de pacote";
        var _rootSystemAccountInfo = Util.GetRootSystemAccountInfo();

        var settings = {
            data: {
                minSearchDays: 1,
                maxSearchDays: 30
            },
            template: undefined,
            templates: {
                passengersAges: undefined,
                packageRoom: undefined
            },
            templateOptions: {
                toolbarTemplate: true,
                showDateInDatePicker: false,
                specificDateRange: false
            },
            searchType: EnumHelper.SearchType.Package,
            controllers: {
                messagesController: undefined,
                locationsController: undefined,
                searchController: undefined
            },
            components: {
                startDate: "#startDate",
                endDate: "#endDate",
                labelEndDate: '.enddate',
                origin: ".txtOrigin",
                destination: ".cboPackageDestination",
                outboundDate: ".txtOutboundDate",
                hotelRooms: ".drpRoomsQtd",
                hotelChildrensQtdRoom: ".childrensQtdRoom",
                hotelRoomContainer: ".roomContainer",
                childAgesContainer: ".child_years_old",
                childsByRoomSelector: "#drpChildrenQtdRoom",
                childAgeSelector: "#drpChildAge",
                adultsSelector: "#drpAdultsQtdRoom",
                totalPassengers: ".cboPackagePassengers",
                passengersAgesContainer: ".passengersAges",
                addRoom: ".addRoom",
                removeRoom: ".removeRoom",
                roomList: ".packageRoomList",
                passengerAge: ".cboPassengerAge",
                lblRoomNumber: ".roomNumber",
                clearEngine: ".clearSearchParams",
                dates: {
                    outboundDate: ".packageOutboundDate",
                    inboundDate: ".packageInboundDate"
                },
                name: "",
                switchSearchParam: ".switchSearchParam",
                searchLandOnly: ".landOnly"
            },
            componentsOptions: {
                hasDatepicker: "hasDatepicker"
            },
            selectors: {
                roomindex: "roomindex"
            },
            useScrollOnPesqInc: true,
            applyStatusClassesOnPesqInc: true,
            applyFixedClassOnPesqInc: false,
            validateNeedMoreAdultsThanInfants: true,
            maxRoomsRequest: 3,
            maxGuestQuantities: 9,
            defaultOriginId: 0,
            exhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Dialog,
            availableLocations: [],
            debugModeOn: Global.IsDebugContext,
            loadProximities: false,
            inferPaxes: false,
            defaultPassengersData: [],
            salesFlowVersion: EnumHelper.HybridPackageSalesFlowVersion.One,
            enableSearchByName: true,
            usePesqIncSelectOnDestination: false,
            typeOfSearch: 'destination'
        };

        //#region :: Public

        this.initialize = function (target, opts) {

            component = $(target);

            $.extend(true, settings, opts || {});

            _functions.validTemplates();

            _functions.components.select();

            _functions.components.dettachEvents();

            _functions.components.attachEvents();

            _functions.controllers.attachEvents();

            _functions.validTemplates();
        };

        this.render = function () {
            component.html(settings.template({
                templateOptions: settings.templateOptions,
                maxRooms: settings.inferPaxes ? 0 : settings.maxRoomsRequest,
                versionSearchEngine: settings.versionSearchEngine,
                enableSearchByName: settings.enableSearchByName,
                maxDaysToSearch: settings.data.maxSearchDays
            }));

            _functions.components.select();

            _functions.afterRender();
        };

        this.getData = function () {
            var packageConfigurationNightId = component.attr("packageConfigurationNightId");

            var origin = _functions.getData.getComponentLocationsFinderData(settings.components.origin);

            var selectedRange = _functions.getData.getSelectedData();

            var data = {
                Package: {
                    BeginDepartureDateTime: selectedRange.BeginDepartureDateTime,
                    EndDepartureDateTime: selectedRange.EndDepartureDateTime,
                    OriginId: 0,
                    Origin: "",
                    OriginData: {},
                    PackageDestination: {
                        LocationId: 0,
                        Location: "",
                        PackageDestinationData: {}
                    },
                    PackageRoomsRequest: _functions.getData.getPassengersData(),
                    PackageConfigurationNightId: 0,
                    SearchLandOnly: true
                }
            };

            if (origin != undefined && !_functions.searchOnlyLand()) {
                data.Package.Origin = origin.IATA;
                data.Package.OriginId = origin.Id;
                data.Package.OriginData = origin;
                data.Package.SearchLandOnly = false;
            }

            if (packageConfigurationNightId) {
                packageConfigurationNightId = parseInt(packageConfigurationNightId, 10);
                if (packageConfigurationNightId) {
                    data.Package.PackageConfigurationNightId = packageConfigurationNightId;
                }
            }

            data.Package.SalesFlowVersion = parseInt(settings.salesFlowVersion, 10);

            if (_functions.hasSelectedDestination() && settings.typeOfSearch == 'destination') {
                _functions.setDestinationData(data);
            }

            if (_functions.hasSelectedPackage() && settings.typeOfSearch == 'name') {
                var selectedPackage = _functions.getSelectedPackage();
                if (typeof selectedPackage !== "undefined" && selectedPackage.hasOwnProperty("Id")) {
                    data.Package.PackageConfigurationId = selectedPackage.Id;

                    if (!_functions.hasSelectedDestination() && selectedPackage.hasOwnProperty("PackageDestinationId")) {
                        _functions.setDestinationInfo(data, selectedPackage.PackageDestinationId, selectedPackage.PackageDestinationId);

                        if (data.Package.PackageDestination.PackageDestinationData && data.Package.PackageDestination.PackageDestinationData.Id) {
                            data.Package.PackageDestination.LocationId = data.Package.PackageDestination.PackageDestinationData.Id;
                        }
                    }
                }
            }

            return data;
        };

        this.validate = function () {

            var errors = [];

            var data = _this.getData();

            var totalAdults = data.Package.PackageRoomsRequest.sum(function (r) {
                return r.PassengersAges.where(function (age) { return age >= 18; }).length;
            });

            var totalInfants = data.Package.PackageRoomsRequest.sum(function (r) {
                return r.PassengersAges.where(function (age) { return age <= 2; }).length;
            });

            var totalTravelers = data.Package.PackageRoomsRequest.sum(function (r) { return r.PassengersAges.length; });

            if (!_functions.searchOnlyLand() && $.isEmptyObject(data.Package.OriginData))
                errors.push("OnSearch_InvalidOrigin");
            else if (data.Package.PackageDestination.LocationId === 0 && (typeof data.Package.PackageDestination.DestinationId === "undefined" || data.Package.PackageDestination.DestinationId === 0))
                errors.push("OnSearch_InvalidDestination");
            else if (data.Package.OriginId == data.Package.PackageDestination.LocationId)
                errors.push("OnSearch_OriginEqualsDestin");
            else if (settings.validateNeedMoreAdultsThanInfants && (totalAdults < totalInfants))
                errors.push("OnSearch_NeedMoreAdultsThanInfants");
            else if (totalTravelers > settings.maxGuestQuantities)
                errors.push(["OnSearch_NoMoreThanXGuests", settings.maxGuestQuantities]);

            if (settings.templateOptions.specificDateRange) {
                var dateRange = _functions.getData.getSelectedData();
                if (!dateRange.BeginDepartureDateTime.isValid)
                    errors.push(["OnSearch_NoOutboundDate"]);
                if (!dateRange.EndDepartureDateTime.isValid)
                    errors.push(["OnSearch_NoInboundDateForAirHotel"]);
            }

            SharedFunctions.ValidateContext(errors);

            if (errors.length){
                settings.controllers.messagesController.notifyMessages(errors, settings.exhibitionType);
            }
            else if (Util.IsAbleToSendGtagEvents(_rootSystemAccountInfo))
                _sendGtagEvents(data);

            return (errors.length == 0);
        };

        this.readQueryString = function (queryString) {

            var searchParameters = {};
            searchParameters.Package = {
                BeginDepartureDateTime: Util.QueryString("BeginDeparture", queryString).toDateValues(),
                EndDepartureDateTime: Util.QueryString("EndDeparture", queryString).toDateValues(),
                OriginId: 0,
                Origin: "",
                OriginData: {},
                PackageDestination: {
                    LocationId: 0,
                    Location: "",
                    PackageDestinationData: {}
                },
                PackageRoomsRequest: []
            };

            var originLocation = _functions.queryString.getLocation('Origin', queryString);
            searchParameters.Package.OriginId = originLocation.Id;
            searchParameters.Package.Origin = originLocation.Name;
            searchParameters.Package.OriginData = originLocation.LocationData;

            var destination = _functions.queryString.getLocation('Destination', queryString);
            searchParameters.Package.PackageDestination.LocationId = destination.Id;
            searchParameters.Package.PackageDestination.Location = destination.Name;
            searchParameters.Package.PackageDestination.PackageDestinationData = destination.LocationData;

            var packageDestinationId = Util.QueryString("PackageDestinationId", queryString);

            if (packageDestinationId)
                searchParameters.Package.PackageDestination.DestinationId = packageDestinationId;

            $.each(Util.QueryString("Ages", queryString).split(';'), function () {
                var ages = [];
                var agesSplited = this.toString().split(',');
                for (var i = 0; i < agesSplited.length; i++) {
                    ages.push(agesSplited[i]);
                }

                searchParameters.Package.PackageRoomsRequest.push({ PassengersAges: ages });
            });

            var packageConfigurationNightId = Util.QueryString("PackageConfigurationNightId", queryString);

            if (packageConfigurationNightId) {

                packageConfigurationNightId = parseInt(packageConfigurationNightId, 10);

                if (packageConfigurationNightId) {
                    searchParameters.Package.PackageConfigurationNightId = packageConfigurationNightId;
                }
            }

            var specificOutboundDate = Util.QueryString("SpecificOutboundDate", queryString);

            if (specificOutboundDate) {
                specificOutboundDate = specificOutboundDate.toDateValues();
                searchParameters.Package.BeginDepartureDateTime = specificOutboundDate;
                searchParameters.Package.EndDepartureDateTime = specificOutboundDate;
            }

            if (Util.QueryString("RoomSharingCode", queryString) && Util.QueryString("RoomSharingCode", queryString).length)
                Global.InterfaceEnvelope.RoomSharingCode = Util.QueryString("RoomSharingCode", queryString);

            return searchParameters;
        }

        this.getQueryString = function (pageUrl) {
            var data = _this.getData();

            pageUrl = pageUrl + "?SearchType=Package";

            var querystring = "";
            querystring += "&BeginDeparture=" + _functions.queryString.getDatePattern(data.Package.BeginDepartureDateTime);
            querystring += "&EndDeparture=" + _functions.queryString.getDatePattern(data.Package.EndDepartureDateTime);
            querystring += "&Origin=" + data.Package.Origin;
            querystring += "&OriginId=" + data.Package.OriginId;
            querystring += "&Destination=" + data.Package.PackageDestination.Location;
            querystring += "&DestinationId=" + data.Package.PackageDestination.LocationId;

            if (typeof (data.Package.PackageDestination.DestinationId) !== 'undefined' && data.Package.PackageDestination.DestinationId > 0)
                querystring += "&PackageDestinationId=" + data.Package.PackageDestination.DestinationId;

            var ages = [];
            for (var i = 0; i < data.Package.PackageRoomsRequest.length; i++) {
                ages.push(data.Package.PackageRoomsRequest[i].PassengersAges.join(","));
            }

            querystring += "&Ages=" + ages.join(';');

            if (_functions.hasSelectedPackage()) {
                querystring += "&PackageConfigurationId=" + data.Package.PackageConfigurationId;
            }

            return pageUrl + querystring;
        };

        this.fillValues = function (data) {

            if (data && !$.isEmptyObject(data)) {

                function updateDestinationField() {
                    if (data.Package.PackageDestination.LocationId)
                        settings.components.destination.val(data.Package.PackageDestination.LocationId);
                    else if (data.Package.PackageDestination.Location) {
                        settings.components.destination.find('select:[text=' + data.Package.PackageDestination.Location + ']');
                    }

                    if (settings.controllers.searchController)
                        settings.controllers.searchController.getPackageLocationsCompleted.dettach(updateDestinationField);
                }

                if (data.Package.OriginData) {
                    settings.components.origin.locationsFinder("setData", data.Package.OriginData);
                    _functions.onOriginSelected();
                }
                else if (data.Package.OriginId) {
                    settings.components.origin.locationsFinder("setDataById", data.Package.OriginId);
                    _functions.onOriginSelected();
                }
                else if (data.Package.Origin) {
                    settings.components.origin.val(data.Package.Origin);
                }

                if (data.Package.BeginDepartureDateTime && data.Package.BeginDepartureDateTime.isValid) {
                    if (settings.templateOptions.showDateInDatePicker) {
                        var startDateSelected = Util.DateValuesToDate(data.Package.BeginDepartureDateTime);
                        var endDateSelected = Util.DateValuesToDate(data.Package.EndDepartureDateTime);
                        settings.components.startDate.data('daterangepicker').setStartDate(startDateSelected);
                        settings.components.startDate.data('daterangepicker').setEndDate(endDateSelected);
                    }
                    else {
                        settings.components.outboundDate
                            .find('option[data-month="' + data.Package.BeginDepartureDateTime.Month + '"][data-year="' + data.Package.BeginDepartureDateTime.Year + '"]')
                            .data('selected', true);
                    }
                }

                for (var roomIndex = 0; roomIndex < data.Package.PackageRoomsRequest.length; roomIndex++) {
                    if (_functions.roomManager.getTotalRooms() != data.Package.PackageRoomsRequest.length)
                        _functions.roomManager.addRoom();
                    else
                        _functions.roomManager.managerAddRemoveButtons();

                    _functions.roomManager.changePassengerQuantity(roomIndex, data.Package.PackageRoomsRequest[roomIndex].PassengersAges.length);
                    for (var passengerIndex = 0; passengerIndex < data.Package.PackageRoomsRequest[roomIndex].PassengersAges.length; passengerIndex++) {
                        _functions.roomManager.setPassengerAge(data.Package.PackageRoomsRequest[roomIndex].PassengersAges[passengerIndex], passengerIndex, roomIndex);
                    }
                }

                if (data.Package.PackageConfigurationNightId) {
                    component.attr("packageConfigurationNightId", data.Package.PackageConfigurationNightId);
                }
                else {
                    component.removeAttr("packageConfigurationNightId");
                }

                if (settings.controllers.searchController) {
                    settings.controllers.searchController.getPackageLocationsCompleted.attach(updateDestinationField);
                }
                else {
                    updateDestinationField();
                }
            }
        };

        this.updateOptions = function () { };

        this.updateValues = function () { };

        this.setOptions = function () { };

        this.clear = function () {

            var totalRooms = _functions.roomManager.getTotalRooms();

            settings.components.origin.val("");
            settings.components.destination.val("");

            settings.components.outboundDate.children().eq(0).prop("selected", true);

            //Remove os quartos extras
            $(settings.components.hotelRoomContainer.selector, component).each(function () {
                var $this = $(this);
                if ($this.index() > 0)
                    $this.remove();
            });

            //Define como 1 a qtde de pax do quarto 1
            $(settings.components.totalPassengers.selector, component).eq(0).children().eq(0).prop("selected", true);
            $(settings.components.totalPassengers.selector, component).eq(0).change();

            _functions.roomManager.managerAddRemoveButtons();

        };

        this.hideAddRoomsButton = function(){
            settings.maxRoomsRequest = 1;

            _functions.roomManager.managerAddRemoveButtons();
        };

        //#endregion

        //#region :: Events

        var _events = {
            components: {
                onChangePassengerQuantity: function () {
                    var $this = $(this);

                    _functions.roomManager.changePassengerQuantity(settings.components.totalPassengers.index(this), $this.val());
                },
                addRoom: function (event) {
                    event.preventDefault();
                    _functions.roomManager.addRoom();
                },
                removeRoom: function (event) {
                    event.preventDefault();
                    var totalRooms = _functions.roomManager.getTotalRooms();
                    _functions.roomManager.removeRoom(totalRooms - 1);
                },
                switchSearchParam: function (event) {
                    var operations = {
                        hide: function (field) { field.parent().addClass("hide").hide(); },
                        show: function (field) { field.parent().removeClass("hide").show(); }
                    };

                    settings.typeOfSearch = $(event.target).val();
                    switch (settings.typeOfSearch) {
                        case "destination":
                            operations.hide(settings.components.name);
                            operations.show(settings.components.destination);
                            settings.components.name.packagesAutocomplete("clearSelected");
                            break;
                        case "name":
                            operations.hide(settings.components.destination);
                            operations.show(settings.components.name);
                            settings.components.destination.locationsFinder("clearSelected");
                            settings.components.destination.val("");
                            break;
                    }
                },
                onClickLandOnly: function () {
                    _state.searchOnlyLand = settings.components.searchLandOnly.is(":checked");
                    _events.components.changeOriginAccessibility();
                },
                checkLandOnlyDefaultState: function () {
                    if (Util.CompareSettingValue("Search.Package.LandOnly.DefaultSelected", "true")) {
                        settings.components.searchLandOnly.attr("checked", "checked");
                        _events.components.onClickLandOnly();
                    }
                },
                changeOriginAccessibility: function () {
                    if (_state.searchOnlyLand) {
                        settings.components.origin.attr("disabled", "disabled");

                        _functions.getPackageLocations({ OriginId: 0 });
                    }
                    else {
                        settings.components.origin.removeAttr("disabled");
                    }
                },
                onDestinationChange: function () {
                    _functions.onDestinationSelected();
                }
            },
            controllers: {
                onGetPackageLocationsCompleted: function (data) {
                    if (data) {

                        if (data.Destinations && data.Destinations.length) {
                            settings.availableLocations = data.Destinations;
                        }
                        else if (data.Locations && data.Locations.length) {
                            settings.availableLocations = data.Locations;
                        }
                        else {
                            settings.availableLocations = [{ id: 0, c: 'NÃ£o hÃ¡ destinos disponÃ­veis' }];
                        }

                        settings.components.destination.empty();
                        settings.components.destination.append(PackageSearchEngineLocationsOptionsTPL(settings.availableLocations));

                        var position = settings.components.destination.children().length == 2 ? 1 : 0;

                        settings.components.destination.children().eq(position).prop("selected", true);

                        if (settings.usePesqIncSelectOnDestination)
                            settings.components.destination.select2();
                    }
                    else if (settings.debugModeOn) {
                        console.log("======================================================");
                        console.log("Ocorreu um erro ao obter as localidades de pacotes");
                        console.log(data);
                        console.log("======================================================");
                    }
                }
            }
        };

        //#endregion

        //#region :: Functions

        var _functions = {
            afterRender: function () {
                _functions.initializeLocationsFinder();
                _functions.initializeLocations();
                _functions.datePickers.initialize();
                _functions.roomManager.managerAddRemoveButtons();
                _functions.initializePackagesAutocomplete();

                if (Global.PackageDestinations && Global.PackageDestinations.length) {
                    settings.availableLocations = Global.PackageDestinations;
                    settings.components.destination.empty();
                    settings.components.destination.append(PackageSearchEngineLocationsOptionsTPL(settings.availableLocations));
                    settings.components.destination.children().eq(0).click();
                }

                if (settings.debugModeOn)
                    _functions.debug.forceData();

                _functions.components.setBindings();

                _events.components.checkLandOnlyDefaultState();
            },
            onOriginSelected: function () {
                var originData = _functions.getData.getComponentLocationsFinderData(settings.components.origin);

                if (originData && Util.ObjectContainsProperty(originData, "Id")) {

                    var params = {
                        OriginId: originData.Id
                    };

                    _functions.getPackageLocations(params);
                }
            },
            onDestinationSelected: function () {
                if (settings.availableLocations && settings.availableLocations.length) {
                    var selectedDestination = _functions.getSelectedDestination();

                    if (selectedDestination) {
                        var destination = selectedDestination.destinationId > 0 && settings.availableLocations.first(function (h) {
                            return h.did == selectedDestination.destinationId;
                        });

                        if (!destination) {
                            destination = settings.availableLocations.first(function (h) {
                                return h.lid == selectedDestination.locationId;
                            });
                        }

                        if (destination) {
                            var minDate = destination.mind;
                            var maxDate = destination.maxd;

                            var minDate = _functions.datePickers.getMinDate(Util.DateValuesToDate(minDate));
                            var maxDate = _functions.datePickers.getMaxDate(Util.DateValuesToDate(maxDate));

                            if (settings.components.dates.outboundDate.length) {
                                var currentMinDate = settings.components.dates.outboundDate.datepicker("option", "minDate");
                                var currentMaxDate = settings.components.dates.outboundDate.datepicker("option", "maxDate");

                                if (currentMinDate.getTime() != minDate.getTime() || currentMaxDate.getTime() != maxDate.getTime()) {
                                    settings.components.dates.outboundDate.datepicker("option", "minDate", minDate);
                                    settings.components.dates.outboundDate.datepicker("option", "maxDate", maxDate);
                                    settings.components.dates.outboundDate.datepicker("setDate", minDate)
                                        .val(formatter.dateValuesShort(minDate.toDateValues()))

                                    _functions.datePickers.onSelectOutboundDate(formatter.dateValuesShort(minDate.toDateValues()));
                                }

                            }

                            _functions.datePickers.initializeDateRangePicker(minDate, maxDate);
                        }
                    }
                }
            },
            initializeLocationsFinder: function () {
                var pesqIncConfig = {
                    CurrentProduct: Global.Product.Air,
                    HasIata: true,
                    IsCity: true,
                    SearchType: Global.SearchTypes.Full,
                    maxResultsClient: 15,
                    maxResultsServer: 30,
                    idealNumberOfProximities: 6,
                    idealNumberOfProximitiesRoots: 3,
                    useCacheEnhancer: true,
                    onlyHalfClientResults: true,
                    onDropBoxSelect: _functions.onOriginSelected,
                    clientCache: Global.LocationsCache,
                    useScroll: settings.useScrollOnPesqInc,
                    applyStatusClasses: settings.applyStatusClassesOnPesqInc,
                    applyFixedClass: settings.applyFixedClassOnPesqInc,
                    controllers: {
                        locationsController: settings.controllers.locationsController
                    }
                };

                settings.components.origin.locationsFinder(pesqIncConfig).click(function () { $(this).select(); });
            },
            initializeLocations: function () {
                if (settings.defaultOriginId > 0) {
                    var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(settings.defaultOriginId) });
                    if (auxLocationData.length > 0) {
                        settings.components.origin.locationsFinder('setData', auxLocationData[0]);
                        _functions.onOriginSelected();
                    }
                }
            },
            datePickers: {
                initialize: function () {

                    _functions.datePickers.initializeDateRangePicker();

                    if (settings.templateOptions.specificDateRange)
                        _functions.datePickers.initializeOutboundInboundDatePicker();
                },
                initializeDateRangePicker: function (minSearchDate, maxSearchDate) {
                    if (settings.templateOptions.showDateInDatePicker) {
                        var options = {};
                        options.dateLimit = { days: 30 };
                        options.startDate = _functions.datePickers.getMinDate(minSearchDate);

						options.endDate = minSearchDate ? _functions.datePickers.getMaxDate(minSearchDate).addDays(30)
                            : _functions.datePickers.getMaxDate();

                        options.minDate = options.startDate;

                        if (maxSearchDate)
                            options.maxDate = maxSearchDate;

                        options.autoApply = true;

                        settings.components.labelEndDate.hide();
                        if (settings.components.startDate.length) {
                            if (settings.components.startDate.data().daterangepicker) {
                                DestroyDatePicker(settings.components.startDate);
                            }

                            settings.components.startDate.daterangepicker(DateRangePickerOption(options));

                        }

                        if (settings.components.endDate.length)
                            settings.components.endDate.hide();
                    }
                },
                initializeOutboundInboundDatePicker: function () {
                    var currentDateValuesLastDay = Util.GetCurrentDateWithLastDay().toDateValues();

                    var packageDateSettings = {
                        minDate: new Date(),
                        maxDate: undefined,
                        numberOfMonths: (Global.Mobile) ? 1 : 2,
                        onSelect: _functions.datePickers.onSelectOutboundDate
                    };

                    settings.components.dates.outboundDate
                        .datepicker(DatePickerOption(packageDateSettings))
                        .datepicker("setDate", packageDateSettings.minDate)
                        .val(formatter.dateValuesShort(packageDateSettings.minDate.toDateValues()));

                    packageDateSettings.onSelect = undefined;
                    packageDateSettings.maxDate = packageDateSettings.minDate.addDays(30);

                    settings.components.dates.inboundDate
                        .datepicker(DatePickerOption(packageDateSettings))
                        .datepicker("setDate", formatter.dateValuesToDate(currentDateValuesLastDay))
                        .val(formatter.dateValuesShort(currentDateValuesLastDay));
                },
                getMinDate: function (destinationMinDate) {
                    var minSearchDays = (new Date()).addDays(settings.data.minSearchDays);

                    if (destinationMinDate && destinationMinDate > minSearchDays)
                        minSearchDays = destinationMinDate;

                    return minSearchDays;
                },
                getMaxDate: function (destinationMaxDate) {
                    var maxConfiguredDays = (new Date()).addDays(settings.data.minSearchDays + 30);

                    var maxSearchDays = destinationMaxDate || maxConfiguredDays;

                    if (destinationMaxDate && destinationMaxDate < maxConfiguredDays)
                        maxSearchDays = destinationMaxDate;

                    return maxSearchDays;
                },
                onSelectOutboundDate: function (dateText, inst) {
                    var inboundDate = settings.components.dates.inboundDate.val().toDateValues();

                    var forceDate = !inboundDate.isValid || dateText.toDateTime().dateDiff('d', settings.components.dates.inboundDate.val().toDateTime()) < 0;

                    if (forceDate) {
                        inboundDate = dateText.toDateTime().addDays(30);

                        settings.components.dates.inboundDate
                            .datepicker("setDate", inboundDate)
                            .val(formatter.dateValuesShort(inboundDate.toDateValues()));
                    }

                    var datetime = dateText.toDateTime();

                    settings.components.dates.inboundDate.datepicker("option", "minDate", datetime);

                    settings.components.dates.inboundDate.datepicker("option", "maxDate", datetime.addDays(30));
                }
            },
            getData: {
                getSelectedData: function () {
                    var selectedDateRange = {
                        BeginDepartureDateTime: undefined,
                        EndDepartureDateTime: undefined,
                    };

                    if (settings.templateOptions.showDateInDatePicker) {
                        selectedDateRange.BeginDepartureDateTime = settings.components.startDate.data('daterangepicker').startDate.format("DD/MM/YYYY").toDateValues();
                        selectedDateRange.EndDepartureDateTime = settings.components.startDate.data('daterangepicker').endDate.format("DD/MM/YYYY").toDateValues();

                    }
                    else if (settings.templateOptions.specificDateRange) {
                        selectedDateRange.BeginDepartureDateTime = settings.components.dates.outboundDate.val().toDateValues();
                        selectedDateRange.EndDepartureDateTime = settings.components.dates.inboundDate.val().toDateValues();
                    }
                    else {
                        selectedDateRange.BeginDepartureDateTime = _functions.getData.getOutboundDate();
                        selectedDateRange.EndDepartureDateTime = _functions.getData.getOutboundDate();
                        selectedDateRange.EndDepartureDateTime.Day = Util.GetLastMonthDay(selectedDateRange.EndDepartureDateTime.Month, selectedDateRange.EndDepartureDateTime.Year);
                    }
                    return selectedDateRange;
                },
                getPassengersData: function () {

                    if (settings.inferPaxes) {
                        return settings.defaultPassengersData;
                    }
                    else {
                        var roomsRequested = _functions.roomManager.getTotalRooms();
                        var roomsRequest = [];

                        settings.components.hotelRoomContainer.each(function () {
                            var passengersAges = [];

                            var roomCtrl = $(this);

                            roomCtrl.find(settings.components.passengerAge).each(function () {
                                passengersAges.push(parseInt($(this).val()));
                            });

                            roomsRequest.push({ PassengersAges: passengersAges });

                        });

                        return roomsRequest;
                    }
                },
                getOutboundDate: function () {

                    var $selected = $(settings.components.outboundDate.selector + " option:selected", component);

                    return {
                        Month: $selected.data("month"),
                        Year: $selected.data("year"),
                        Day: 1
                    };
                },
                getComponentLocationsFinderData: function ($component) {

                    var data = $component.locationsFinder("getData");

                    if (data)
                        return Util.ParseLocationsFinderDataToLocation(data);

                    return null;
                }
            },
            queryString: {
                getDatePattern: function (date) {
                    return date.Day + '/' + date.Month + '/' + date.Year;
                },
                getLocation: function (parameter, queryString) {
                    var location = {
                        Name: decodeURIComponent(Util.QueryString(parameter, queryString) || "").replaceAll("---", ")").replaceAll("--", "("),
                        Id: Util.QueryString(parameter + "Id", queryString),
                        LocationData: ''
                    };

                    if (Global.LocationsCache && Global.LocationsCache.length > 0) {
                        var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.d == $.trim(location.Name) });

                        if (auxLocationData.length > 0)
                            location.LocationData = auxLocationData[0];
                    }
                    else {
                        location.LocationData = location.Name;
                    }

                    if (location.Name.length == 3)
                        location.Name = location.Name.toUpperCase();

                    return location;
                }
            },
            validTemplates: function () {
                if (!settings.templates)
                    settings.templates = {};

                if (!settings.templates.passengersAges)
                    settings.templates.passengersAges = ServiceTemplates.PassengersAges;

                if (!settings.templates.packageRoom)
                    settings.templates.packageRoom = PackageSearchEngineTemplates.packageRoom;
            },
            getPackageLocations: function (params) {
                if (settings.controllers.searchController) {

                    var req = { OriginId: params.OriginId };

                    settings.controllers.searchController.getPackageLocations(req);
                }
            },
            controllers: {
                setEvents: function (action) {
                    if (settings.controllers.searchController)
                        settings.controllers.searchController.getPackageLocationsCompleted[action](_events.controllers.onGetPackageLocationsCompleted);

                    if (settings.controllers.companyContextController)
                        settings.controllers.companyContextController.changeCompanyContextCompleted[action](_functions.getPackageLocations);
                },
                attachEvents: function () {
                    _functions.controllers.setEvents('attach');
                },
                dettachEvents: function () {
                    _functions.controllers.setEvents('dettach');
                }
            },
            components: {
                setBindings: function () {
                    settings.components.switchSearchParam.unbind("click").bind("click", _events.components.switchSearchParam);
                    settings.components.searchLandOnly.unbind("click").bind("click", _events.components.onClickLandOnly);
                    settings.components.destination.unbind("change").bind("change", _events.components.onDestinationChange);
                },
                setEvents: function (action) {
                    $(component)[action]('click', settings.components.addRoom.selector, _events.components.addRoom);
                    $(component)[action]('click', settings.components.removeRoom.selector, _events.components.removeRoom);
                    $(component)[action]('change', settings.components.totalPassengers.selector, _events.components.onChangePassengerQuantity);
                    $(component)[action]('click', settings.components.clearEngine.selector, _this.clear);
                },
                attachEvents: function () {
                    _functions.components.setEvents('on');
                },
                dettachEvents: function () {
                    _functions.components.setEvents('off');
                },
                select: function () {
                    Util.SelectComponents(settings.components, component, true);
                }
            },
            roomManager: {
                managerAddRemoveButtons: function () {
                    var totalRooms = _functions.roomManager.getTotalRooms();
                    if (totalRooms < settings.maxRoomsRequest)
                        $(settings.components.addRoom.selector, component).addClass("hide").eq(-1).removeClass("hide");
                    else
                        $(settings.components.addRoom.selector, component).addClass("hide");

                    if (totalRooms > 1)
                        settings.components.removeRoom.removeClass('hide');
                    else
                        settings.components.removeRoom.addClass('hide');
                },
                changePassengerQuantity: function (roomIndex, passengersQuantity) {
                    var $passengersAgesContainer = settings.components.passengersAgesContainer.eq(roomIndex);
                    if (!settings.templates)
                        settings.templates = {};

                    if (!settings.templates.passengersAges)
                        settings.templates.passengersAges = ServiceTemplates.PassengersAges;

                    $passengersAgesContainer.html(settings.templates.passengersAges({ amount: passengersQuantity }));
                    _functions.components.select();

                    var $totalPassengers = settings.components.totalPassengers.eq(roomIndex);

                    if ($totalPassengers.length)
                        $totalPassengers.val(passengersQuantity);
                },
                addRoom: function () {
                    var totalRooms = _functions.roomManager.getTotalRooms();
                    var $room = settings.templates.packageRoom({
                        roomNumber: (totalRooms),
                        maxRooms: settings.maxRoomsRequest,
                        settings: {
                            version: settings.versionSearchEngine
                        }
                    });

                    settings.components.roomList.append($room);

                    _functions.roomManager.managerAddRemoveButtons();
                },
                getTotalRooms: function () {
                    _functions.components.select();
                    return settings.components.hotelRoomContainer.length;
                },
                removeRoom: function (roomIndex) {
                    $(settings.components.hotelRoomContainer.selector + '[' + settings.selectors.roomindex + '=' + roomIndex + ']').remove();
                    _functions.roomManager.managerAddRemoveButtons();
                    _functions.roomManager.setRoomNumberLabel();
                },
                setPassengerAge: function (age, passengerIndex, roomIndex) {
                    settings.components.hotelRoomContainer
                        .eq(roomIndex)
                        .find(settings.components.passengerAge)
                        .eq(passengerIndex)
                        .val(age);
                },
                setRoomNumberLabel: function () {
                    $(settings.components.hotelRoomContainer.selector, component).each(function () {
                        var $this = $(this);
                        var $lblRoomNumber = $this.find(settings.components.lblRoomNumber.selector, component);

                        var label = Util.StringFormat("{0} {1}",
                            Util.CallResources("HotelRoom"),
                            ($this.index() + 1));

                        $lblRoomNumber.html(label);
                    });
                }
            },
            debug: {
                forceData: function () {
                    var origin = {
                        ac: [
                            {
                                ac: null,
                                c: "Rio de Janeiro - Rio de Janeiro / BR, Brasil, Todos os Aeroportos (RIO)",
                                d: "Santos Dumont (Aeroporto)",
                                h: 15991,
                                hc: true,
                                i: "SDU",
                                id: 2701273,
                                in: false,
                                ip: 0,
                                n: "Aeroporto Santos Dumont, Brasil (SDU)",
                                t: 5
                            },
                            {
                                ac: null,
                                c: "Rio de Janeiro - Rio de Janeiro / BR, Brasil, Todos os Aeroportos (RIO)",
                                d: "Bartolomeu de GusmÃ£o (Santa Cruz)",
                                h: 53,
                                hc: true,
                                i: "SNZ",
                                id: 2701224,
                                in: false,
                                ip: 0,
                                n: "Bartolomeu de GusmÃ£o (Santa Cruz), Brasil (SNZ)",
                                t: 5
                            },
                            {
                                ac: null,
                                c: "Rio de Janeiro - Rio de Janeiro / BR, Brasil, Todos os Aeroportos (RIO)",
                                d: "GaleÃ£o - AntÃ´nio Carlos (Tom) Jobim International Airport",
                                h: 106547,
                                hc: true,
                                i: "GIG",
                                id: 2701188,
                                in: false,
                                ip: 0,
                                n: "GaleÃ£o - AntÃ´nio Carlos (Tom) Jobim International Airport, Brasil (GIG)",
                                t: 5
                            }
                        ],
                        c: "Rio de Janeiro - Rio de Janeiro / BR, Brasil, Todos os Aeroportos (RIO)",
                        d: "Rio de Janeiro",
                        h: 260795,
                        hc: true,
                        i: "RIO",
                        id: 272337,
                        in: false,
                        ip: 0,
                        n: "Rio de Janeiro - Rio de Janeiro / BR, Brasil ",
                        t: 4
                    };

                    settings.components.origin.locationsFinder("setData", origin);

                    _functions.onOriginSelected();
                }
            },
            initializePackagesAutocomplete: function () {
                if (!settings.enableSearchByName || typeof settings.components.name !== "object" ||
                    settings.components.name.length === 0 ||
                    typeof $.fn.packagesAutocomplete !== "function") {
                    return;
                }

                settings.components.name.packagesAutocomplete({
                    controllers: {
                        searchController: new SearchController({ Global: _this })
                    }
                });
            },
            hasSelectedPackage: function () {
                if (typeof settings.components.name !== "undefined" &&
                    settings.components.name.length > 0 &&
                    settings.components.name.val() !== "" &&
                    settings.components.name.containsPlugin("packagesAutocomplete")) {

                    return typeof _functions.getSelectedPackage() !== "undefined";
                }

                return false;
            },
            getSelectedPackage: function () {
                return settings.components.name.packagesAutocomplete("getData");
            },
            hasSelectedDestination: function () {
                var destinationValue = settings.components.destination.val();
                return typeof (destinationValue) !== 'undefined' && destinationValue !== "";
            },
            setDestinationData: function (data) {
                var selectedDestination = _functions.getSelectedDestination();

                _functions.setDestinationInfo(data, selectedDestination.locationId, selectedDestination.destinationId);
            },
            setDestinationInfo: function (data, locationId, destinationId) {
                var destination = _functions.getDestination(locationId, destinationId);

                if (destination)
                    destination = Util.ParseLocationsFinderDataToLocation(destination);

                data.Package.PackageDestination.LocationId = locationId;
                data.Package.PackageDestination.DestinationId = locationId != destinationId ? destinationId : 0;

                if (destination != undefined) {
                    data.Package.PackageDestination.Location = destination.IATA ? destination.IATA : destination.Name;
                    data.Package.PackageDestination.PackageDestinationData = destination;
                }
            },
            getSelectedDestination: function () {
                var selectedOption = settings.components.destination.find("option:selected");
                var locationId = selectedOption.attr("locationId");
                var destinationId = selectedOption.attr("destinationId");

                var destination = _functions.getDestination(locationId, destinationId);

                if (destination) {
                    destination.locationId = locationId;
                    destination.destinationId = destinationId;
                }

                return destination;
            },
            getDestination: function (locationId, destinationId) {
                var destination = undefined;

                if (locationId > 0 && Global.LocationsCache)
                    destination = Global.LocationsCache.first(function (location) {
                        return location.id == locationId || location.lid == locationId;
                    });

                if (!destination && destinationId > 0 && settings.availableLocations) {
                    var auxLocation = settings.availableLocations.first(function (location) {
                        return location.id == destinationId || location.lid == destinationId;
                    });

                    if (auxLocation)
                        destination = auxLocation.loc;
                }

                if (typeof destination === "undefined") {
                    var matchLocation = settings.availableLocations.first(function (avl) {
                        return avl.lid == locationId;
                    });

                    if (typeof matchLocation !== "undefined" && matchLocation.hasOwnProperty("loc")) {
                        destination = matchLocation.loc;
                    }
                }

                return destination;
            },
            searchOnlyLand: function () {
                return _state.searchOnlyLand;
            }
        };

        function _sendGtagEvents(searchParameters) {
            var packageSearchParameters = searchParameters.Package;
            
            _sendGtagSearchLandOnlyEvent(packageSearchParameters);
            _sendGtagSearchEvent(packageSearchParameters);
        }

        function _sendGtagSearchLandOnlyEvent(packageSearchParameters) {
            if (packageSearchParameters.SearchLandOnly)
                Util.SendGtagEvent('select_searchLandOnly', _gtagEventCategory);
        }

        function _sendGtagSearchEvent(packageSearchParameters, useCustomLabel) {
            if (packageSearchParameters.PackageDestination && packageSearchParameters.PackageDestination.LocationId) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = packageSearchParameters.PackageDestination.LocationId + ' - ' + _rootSystemAccountInfo;
                
                Util.SendGtagEvent('search', _gtagEventCategory, gtagEventLabel);
            }
        }

        //#endregion
    };

    var constructorFunction = function () { return new PackageSearchEngine(); };

    $.fn.packageSearchEngine = function (args) {
        if (args && args == "readQueryString") {
            return Util[this.length ? "pluginDefaultBehavior" : "execPluginMethod"](this, "packageSearchEngine", arguments, constructorFunction);
        }
        else {
            return Util["pluginDefaultBehavior"](this, "packageSearchEngine", arguments, constructorFunction);
        }
    }

})(jQuery);

ï»¿/// <reference path="../Libraries/Util.js" />
/// <reference path="WebCommon/Scripts/Libraries/Util.js" />
/// <reference path="WebCommon/Scripts/Libraries/DatePickerOption.js" />
/// <reference path="WebCommon/Scripts/Libraries/Libraries/Jquery.js" />

if (typeof (Global) == 'undefined') {
    Global = {};
}

Global.ServiceSearchEngine = {
    BlackList: []
};

(function ($) {

    function ServiceSearchEngine() {

        //#region Properties
        var _this = this;

        var component = undefined;

        var categories;

        var _gtagEventCategory = "Motor de serviÃ§o";
        var _rootSystemAccountInfo = Util.GetRootSystemAccountInfo();

        var settings = {
            templates: {
                toolbar: function () { },
                categories: function () { },
                blacklistCategories: function () { },
                passengersAges: function () { }
            },
            controllers: {
                locationsController: undefined,
                messagesController: undefined,
                searchController: undefined
            },
            components: {
                destination: ".txtServiceDestination",
                category: ".cboServiceCategory",
                selectedCategory: ".selectedservicecategory",
                labelCategory: ".category",
                initialDate: ".txtServiceInitialDate",
                finalDate: ".txtServiceFinalDate",
                passengersAmount: ".cboServicePassengers",
                passengersAgesArea: ".passengersAges",
                passengerAge: ".cboPassengerAge",
                serviceName: '#service-name',
                blacklistCategories: '.blacklist_category',
                switchSearchParam: ".switchSearchParam",
            },
            componentsOptions: {
                hasDatepicker: "hasDatepicker"
            },
            exhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Inline,
            maxPassengers: 10,
            applycorrectDateRules: true,
            defaultDestinationId: 0,
            defaultInitialDate: undefined,
            defaultFinalDate: undefined,
            validatePassengerAges: true,
            enableSearchByName: true
        };

        //#endregion

        var _functions = {
            dateRules: {
                initial: function (e) {
                    if (settings.applycorrectDateRules) {
                        _applyMinDateRules(settings.components.initialDate);
                    }
                    var input = settings.components.initialDate;
                    var outboundDate = input.datepickermanager("getDate") || input.datepickermanager("option", "minDate");
                    var refToCalcCheckoutMaxDate = settings.calcCheckoutMaxDateFromToday ? (new Date()) : outboundDate;
                    var filteredOutboundDate = settings.components.finalDate.filter(':visible');
                    if (filteredOutboundDate) {
                        filteredOutboundDate.datepickermanager("option", "minDate", outboundDate);
                    }
                },
                final: function (e) {
                    if (settings.applycorrectDateRules) {
                        _applyMinDateRules(settings.components.initialDate);
                    }
                }
            }
        }

        //#region Public

        this.initialize = function (target, opts) {
            component = $(target);

            $.extend(true, settings, opts || {});

            _dettachEvents();
            _attachEvents();

            _setLiveEvents();
        };

        this.render = function () {
            component.html(settings.templates.toolbar({
                enableSearchByName: settings.enableSearchByName
            }));

            _selectComponents();

            _setEvents();

            _initializeDatePickers();

            _initializePesqInc();

            _initializeServicesAutoComplete();

            _getCategories();
        };

        this.getData = function () {
            var data = {
                "AdditionalInfo": {},
                "Service": {
                    "StartDate": settings.components.initialDate.datepickermanager("val").toDateValues(),
                    "EndDate": settings.components.finalDate.datepickermanager("val").toDateValues(),
                    "Customers": _getPassengersAges(),
                    "ServiceType": 0
                }
            };

            var category = _getSelectedCategoryId();

            if (category && category != "") {
                if (category.contains(","))
                    data.Service.CategoryIds = category.split(",");
                else
                    data.Service.CategoryId = category;
            }
                

            if (_hasSelectedService()) {
                var selectedService = _getSelectedService();

                if (typeof selectedService !== "undefined" && selectedService.hasOwnProperty("Id")) {
                    data.Service.ServiceIds = [selectedService.Id];
                    data.Service.ReturnAllFares = false; //bit para retornar apenas tarifa mais barata ou vitrine, se houver.
                }
            }

            if (_hasSelectedDestination()) {
                data.AdditionalInfo.ServiceDestination = _getDestinationLocation();
                data.Service.LocationId = _getDestinationLocation("id")
            }

            if (Util.IsAbleToSendGtagEvents(_rootSystemAccountInfo))
                _sendGtagEvents(data);

            return data;
        };

        this.setOptions = function () { };

        this.validate = function () {

            var errors = [];

            if (!_getDestinationLocation() && !_hasSelectedService())
                errors.push("OnSearch_NoDestin");

            if (settings.components.initialDate.val() == "" || !settings.components.initialDate.datepickermanager("val").isDate())
                errors.push("OnSearchService_NoInitialDate");

            if (settings.components.finalDate.val() == "" || !settings.components.finalDate.datepickermanager("val").isDate())
                errors.push("OnSearchService_NoFinalDate");

            if (errors.length && settings.controllers.messagesController)
                settings.controllers.messagesController.notifyMessages(errors, settings.exhibitionType);

            if (settings.validatePassengerAges && settings.components.passengerAge.filter(function () { return $(this).val() == ""; }).length)
                errors.push("OnSearchService_InformAllPassengersAges");

            if (errors.length && settings.controllers.messagesController)
                settings.controllers.messagesController.notifyMessages(errors, settings.exhibitionType);

            return errors.length == 0;
        };

        this.readQueryString = function (queryString) {
            var searchParameters = {
                Service: {
                    StartDate: Util.QueryString("StartDate", queryString).toDateValues('pt'),
                    EndDate: Util.QueryString("EndDate", queryString).toDateValues('pt'), 
                    LocationId: Util.QueryString("LocationId", queryString), 
                    ServiceType: EnumHelper.Services.ServiceType.Other,
                },
                Customers: [],
            };
            var customers = Util.QueryString("Customers", queryString);
            var categoryId = Util.QueryString("CategoryId", queryString);
            var queryStringBlackListCategory = _getQueryStringUtilFunctions.GetBlackListCategories(queryString);
            var serviceId = Util.QueryString("ServiceId", queryString);
            var serviceName = Util.QueryString("ServiceName", queryString);

            if (customers && customers.length) {
                $.each(customers.split(','), function () {
                    searchParameters.Service.Customers.push(this.toString());
                });
            }

            if (Global.LocationsCache && Global.LocationsCache.length > 0) {
                var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(searchParameters.Service.LocationId) });

                if (auxLocationData.length > 0)
                    searchParameters.AdditionalInfo = {
                        ServiceDestination: auxLocationData[0]
                    };
            }

            if (Util.isNotNullOrWhiteSpace(categoryId))
                searchParameters.Service.CategoryId = categoryId;

            if (Util.isNotNullOrWhiteSpace(queryStringBlackListCategory))
                searchParameters.Service.BlackListCategoryIds = queryStringBlackListCategory.split(',');

            if (Util.isNotNullOrWhiteSpace(serviceId))
                searchParameters.Service.ServiceId = serviceId;

            if (Util.isNotNullOrWhiteSpace(serviceName))
                searchParameters.Service.ServiceName = decodeURIComponent(serviceName);

            return searchParameters;
        }

        this.getQueryString = function (pageUrl) {
            var data = _this.getData();
            var selectedSwitch = $(settings.components.switchSearchParam.selector + ':checked').val() || 'destination';

            pageUrl = pageUrl + "?SearchType=Service";

            var querystring = "";

            if (typeof data.Service.LocationId !== "undefined" && selectedSwitch == 'destination') {
                querystring += "&LocationId=" + data.Service.LocationId;
            }

            querystring += "&Customers=" + _getQueryStringUtilFunctions.GetCustomersAges(data.Service.Customers);
            querystring += "&StartDate=" + _getQueryStringUtilFunctions.GetDatePattern(data.Service.StartDate);
            querystring += "&EndDate=" + _getQueryStringUtilFunctions.GetDatePattern(data.Service.EndDate);
            if (data.Service.CategoryId)
                querystring += "&CategoryId=" + data.Service.CategoryId;

            if (selectedSwitch != 'destination' && settings.components.serviceName != undefined && settings.components.serviceName.length) {
                var selectedService = settings.components.serviceName.servicesAutocomplete('getData');

                if (selectedService) {
                    querystring += '&ServiceId=' + selectedService.Id;
                    querystring += '&ServiceName=' + encodeURIComponent(selectedService.Name);
                }
            }

            if (settings.components.blacklistCategories && settings.components.blacklistCategories.length) {
                var blCategoryIds = _getQueryStringUtilFunctions.GetBlackListCategories();

                if (blCategoryIds && blCategoryIds.length)
                    querystring += '&BlackListCategoryIds=' + blCategoryIds;
            }

            return pageUrl + querystring;
        }

        var _getQueryStringUtilFunctions = new (function () {

            this.GetCustomersAges = function (customers) {
                return customers.join(",");
            };

            this.GetDatePattern = function (date) {
                return date.Day + '/' + date.Month + '/' + date.Year;
            };

            this.GetBlackListCategories = function (queryString) {
                var ids = [];

                if (!queryString) {
                    if (settings.components.blacklistCategories
                        && settings.components.blacklistCategories.find
                        && settings.components.blacklistCategories.find('input').length) {
                        settings.components.blacklistCategories.find('input').each(function () {
                            if ($(this).is(":checked"))
                                ids.push($(this).val());
                        });
                    }
                }


                if (!ids.length) {

                    queryString = queryString || window.location.search;

                    var blackListCatIds = Util.QueryString("BlackListCategoryIds", window.location.search);

                    if (blackListCatIds && blackListCatIds.length) {
                        $.each(blackListCatIds.split(','), function () {
                            ids.push(this.toString());
                        });
                    }
                }

                return ids.join(',');
            };

        });

        this.fillValues = function (data) {
            if (data && !$.isEmptyObject(data)) {
                var hasLocation = false;
                var hasServiceNameOrId = false;

                if (data.Service.LocationId) {
                    settings.components.destination.locationsFinder("setDataById", data.Service.LocationId);

                    hasLocation = true;
                }
                    

                if (data.Service.StartDate && data.Service.StartDate.isValid) {
                    settings.components.initialDate.datepickermanager("setDate", formatter.dateValuesToDate(data.Service.StartDate))
                    settings.components.initialDate.datepickermanager("val", formatter.dateValuesShort(data.Service.StartDate));
                }

                if (data.Service.EndDate && data.Service.EndDate.isValid) {
                    settings.components.finalDate.datepickermanager("setDate", formatter.dateValuesToDate(data.Service.EndDate))
                    settings.components.finalDate.datepickermanager("val", formatter.dateValuesShort(data.Service.EndDate));
                    _functions.dateRules.final();
                }

                if (data.Service.Customers && data.Service.Customers.length) {
                    settings.components.passengersAmount.val(data.Service.Customers.length);
                    _onChangePassengersAmount();
                    $(settings.components.passengerAge.selector, component).each(function (index) {
                        $(this).val(data.Service.Customers[index]);
                    });
                }

                if (Util.isValidNumber(data.Service.Id)) {
                    settings.components.serviceName.servicesAutocomplete('setById', data.Service.Id);

                    hasServiceNameOrId = true;
                } else if (data.Service.ServiceName != undefined && data.Service.ServiceName.length > 0) {
                    settings.components.serviceName.servicesAutocomplete('setDataByServiceName', data.Service.ServiceName);

                    hasServiceNameOrId = true;
                }

                settings.components.switchSearchParam.removeAttr('checked');

                if (hasServiceNameOrId) {
                    $(settings.components.switchSearchParam.selector + '[value="name"]').click();
                } else {
                    $(settings.components.switchSearchParam.selector + '[value="destination"]').click();
                } 

                _this.fillCategoryValues(data);
            }
        };

        this.fillCategoryValues = function (data) {
            if (data && !$.isEmptyObject(data)) {
                if (data.Service.CategoryId)
                    settings.components.category.val(data.Service.CategoryId);

                if (data.Service.BlackListCategoryIds && data.Service.BlackListCategoryIds.length) {
                    data.Service.BlackListCategoryIds.forEach(function (id) {
                        $(settings.components.labelCategory.find('option[value="' + id + '"]'), component).remove();

                        $(settings.components.blacklistCategories.selector + ' input[value="' + id + '"]', component).click();
                    });

                    if (settings.components.labelCategory.find("option").length == 1)
                        settings.components.labelCategory.addClass('hide');
                }
            }
        };

        this.updateValues = function () { };

        //#endregion

        //#region Plugin

        function _setEvents() {
            if (!Global.Mobile) {
                settings.components.initialDate.unbind("keyup").bind("keyup", Util.ForceMaskDate);
                settings.components.finalDate.unbind("keyup").bind("keyup", Util.ForceMaskDate);
            }

            var datePickerEvent = Global && Global.Mobile ? 'blur' : 'change';

            settings.components.initialDate.unbind(datePickerEvent).bind(datePickerEvent, _functions.dateRules.initial);
            settings.components.finalDate.unbind(datePickerEvent).bind(datePickerEvent, _functions.dateRules.final);

            settings.components.passengersAmount.unbind("change").bind("change", _onChangePassengersAmount);

            settings.components.switchSearchParam.unbind("click").bind("click", _switchSearchParam);
        }

        function _setLiveEvents() { }

        function _attachEvents() {
            if (settings.controllers.searchController)
                settings.controllers.searchController.getServiceCategoriesCompleted.attach(_onGetCategoriesCompleted);

            if (settings.controllers.companyContextController)
                settings.controllers.companyContextController.changeCompanyContextCompleted.attach(_getCategories);
        }

        function _dettachEvents() {
            if (settings.controllers.searchController)
                settings.controllers.searchController.getServiceCategoriesCompleted.dettach(_onGetCategoriesCompleted);

            if (settings.controllers.companyContextController)
                settings.controllers.companyContextController.changeCompanyContextCompleted.dettach(_getCategories);
        }

        function _selectComponents() {
            Util.SelectComponents(settings.components, component, true);
        }

        //#endregion

        //#region DatePickers

        function _initializeDatePickers() {

            var currentDate = Util.CreateAbsoluteDate();
            var datePickerSettings = {
                numberOfMonths: (Global.Mobile) ? 1 : 2,
                "minDate": currentDate.addDays(parseInt(settings.minDaysToSearch, 10)),
                "maxDate": currentDate.addDays(parseInt(settings.maxDaysToSearch, 10))
            };

            _initializeDatePicker(settings.components.initialDate, datePickerSettings);

            datePickerSettings = {
                numberOfMonths: (Global.Mobile) ? 1 : 2,
                "minDate": datePickerSettings.minDate.addDays(settings.minPeriodToSearch),
                "maxDate": datePickerSettings.maxDate.addDays(settings.minPeriodToSearch)
            };

            _initializeDatePicker(settings.components.finalDate, datePickerSettings);
            _setDefaultDate(settings.defaultInitialDate, settings.components.initialDate);
            _functions.dateRules.initial(settings.components.initialDate);
            _setDefaultDate(settings.defaultFinalDate, settings.components.finalDate);

            if (settings.lockCheckin == "true")
                settings.components.initialDate.attr("disabled", "disabled");
            if (settings.lockCheckout == "true")
                settings.components.finalDate.attr("disabled", "disabled");

        }

        function _setDefaultDate(defaultDate, $component) {
            if (defaultDate) {
                var date = defaultDate.toDateValues();

                if (date.isValid) {
                    $component
                        .datepickermanager("setDate", formatter.dateValuesToDate(date))
                        .datepickermanager("val", formatter.dateValuesShort(date));
                }
            }
        }

        function _initializeDatePicker($component, datePickerSettings) {
            $component
                .removeClass(settings.componentsOptions.hasDatepicker)
                .datepickermanager("destroy")
                .datepickermanager(DatePickerOption(datePickerSettings));
        }

        //#endregion

        //#region DateRules

        function _applyMinDateRules(ctrl) {
            var myDate = ctrl.datepickermanager("getDate");
            var minDate = ctrl.datepickermanager("option", "minDate");
            var currentDateValue = ctrl.datepickermanager("val").toDateValues();

            if (!myDate)
                myDate = minDate;

            if (myDate < minDate || (currentDateValue.isValid == false && ctrl.val() != "")) {
                ctrl.datepickermanager("setDate", minDate);
                settings.controllers.messagesController.notifyMessages(["ApplyCorrectDateRule"], settings.exhibitionType);
            }
        }

        //#endregion

        //#region Services AutoComplete

        function _initializeServicesAutoComplete() {
            if (settings.components.serviceName && settings.components.serviceName.length) {
                settings.components.serviceName.servicesAutocomplete({
                    controllers: {
                        searchController: new SearchController({ Global: _this })
                    }
                });
            }
        }

        //#endregion

        //#region PesqInc

        function _initializePesqInc() {

            settings.components.destination.locationsFinder({
                "CurrentProduct": Global.Product.Air, //TODO: Ocorre erro se utilizar Global.Product.Car, descobrir por que
                "HasIata": false,
                "IsCity": true,
                "SearchType": Global.SearchTypes.Full,
                "maxResultsClient": 15,
                "maxResultsServer": 30,
                "idealNumberOfProximities": 6,
                "idealNumberOfProximitiesRoots": 3,
                "useCacheEnhancer": true,
                "onlyHalfClientResults": true,
                "onDropBoxSelect": function () { },
                "clientCache": Global.LocationsCache,
                "useScroll": settings.useScrollOnPesqInc,
                "applyStatusClasses": settings.applyStatusClassesOnPesqInc,
                "applyFixedClass": settings.applyFixedClassOnPesqInc,
                "controllers": {
                    "locationsController": settings.controllers.locationsController
                }
            }).click(function () { $(this).select(); });

            if (settings.defaultDestinationId) {
                var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(settings.defaultDestinationId) });

                if (auxLocationData.length > 0)
                    settings.components.destination.locationsFinder('setData', auxLocationData[0]);
            }
            if (settings.lockDestination == "true") {
                $(settings.components.destination).attr("disabled", "disabled");
            }

        }

        //#endregion

        //#region GetCategories

        function _getCategories() {
            if (settings.controllers.searchController)
                settings.controllers.searchController.getServiceCategories();
        }

        function _onGetCategoriesCompleted(resp) {
            if (resp && resp.Successful && resp.GetServiceCategoriesRS) {

                Global.ServiceSearchEngine.BlackListIds = [];

                if (Global && Global.ServiceSearchEngine && Global.ServiceSearchEngine.BlackList && Global.ServiceSearchEngine.BlackList.length) {

                    if (resp.GetServiceCategoriesRS.Categories) {
                        resp.GetServiceCategoriesRS.Categories.forEach(function (category) {
                            if (Global.ServiceSearchEngine.BlackList.contains(category.Name)) {
                                Global.ServiceSearchEngine.BlackListIds.push(category.Id);
                                category.IsBlackList = true;
                            }
                        });
                    }
                }

                settings.components.blacklistCategories.html(settings.templates.blacklistCategories(resp.GetServiceCategoriesRS.Categories));

                resp.GetServiceCategoriesRS.Categories = resp.GetServiceCategoriesRS.Categories.where(function (category) {
                    return !Global.ServiceSearchEngine.BlackListIds.contains(category.Id);
                });

                settings.components.category.html(settings.templates.categories(resp.GetServiceCategoriesRS.Categories));
                settings.components.blacklistCategories.html(settings.templates.blacklistCategories(resp.GetServiceCategoriesRS.Categories));
            }

            if (Global.InterfaceEnvelope && Global.InterfaceEnvelope.SearchParameters)
                _this.fillCategoryValues(Global.InterfaceEnvelope.SearchParameters);
        }

        //#endregion

        //#region Auxiliar

        function _onChangePassengersAmount() {
            var passengersAmount = settings.components.passengersAmount.val();
            var content = settings.templates.passengersAges(passengersAmount);

            settings.components.passengersAgesArea.empty().html(content);
        }

        function _getPassengersAges() {
            var customers = [];

            settings.components.passengerAge.each(function () {
                customers.push($(this).val());
            });

            return customers;
        }

        function _hasSelectedDestination() {
            return typeof _getDestinationLocation() !== "undefined";
        }

        function _getDestinationLocation(property) {
            var data = settings.components.destination.locationsFinder("getData");

            if (property && data[property])
                return data[property];

            return data;
        }

        function _hasSelectedService() {
            if (typeof settings.components.serviceName !== "undefined" &&
                settings.components.serviceName.length > 0 &&
                settings.components.serviceName.val() !== "" &&
                settings.components.serviceName.containsPlugin("servicesAutocomplete")) {

                return typeof _getSelectedService() !== "undefined";
            }

            return false;
        }

        function _getSelectedService() {
            return settings.components.serviceName.servicesAutocomplete("getData");
        }

        function _getSelectedCategoryId() {
            return settings.components.category.val();
        }

        function _switchSearchParam() {
            var operations = {
                hide: function (field) { field.parent().addClass("hide").hide(); },
                show: function (field) { field.parent().removeClass("hide").show(); }
            };

            switch ($(this).val()) {
                case "destination":
                    operations.hide(settings.components.serviceName);
                    operations.show(settings.components.destination);
                    settings.components.serviceName.servicesAutocomplete("clearSelected");
                    break;
                case "name":
                    operations.hide(settings.components.destination);
                    operations.show(settings.components.serviceName);
                    settings.components.destination.locationsFinder("clearSelected");
                    break;
            }
        }

        function _sendGtagEvents(searchParameters) {
            var serviceSearchParameters = searchParameters.Service;
            
            _sendGtagSelectCategoryEvent(serviceSearchParameters);
            _sendGtagSearchEvent(serviceSearchParameters);
        }

        function _sendGtagSelectCategoryEvent(serviceSearchParameters, useCustomLabel) {
            var categoryId = serviceSearchParameters.CategoryId;
            
            if (categoryId) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = categoryId + ' - ' + _rootSystemAccountInfo;
                
                Util.SendGtagEvent('select_category', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagSearchEvent(serviceSearchParameters, useCustomLabel) {
            var locationId = serviceSearchParameters.LocationId;
            
            if (locationId) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = locationId + ' - ' + _rootSystemAccountInfo;

                Util.SendGtagEvent('search', _gtagEventCategory, gtagEventLabel);
            }
        }

        //#endregion
    }

    $.fn.serviceSearchEngine = function () {
        return Util.pluginDefaultBehavior(this, "serviceSearchEngine", arguments, function () { return new ServiceSearchEngine() });
    }

})(jQuery);

ï»¿(function ($) {

    function DynamicPackageSearchEngine() {
        var _this = this;
        var _component = undefined;

        var _settings = {
            template: undefined,
            templates: {
                categories: undefined
            },
            simpleService: false,
            minSearchDays: 1,
            useMinDaysToSearchToCheckout: true,
            maxSearchDays: 365,
            minPeriodToSearch: 1,
            maxPeriodToSearch: 30,
            maxPassengers: 9,
            calcCheckoutMaxDateFromToday: false,
            defaultStartDate: undefined,
            defaultEndDate: undefined,
            adultHotelAge: 12,
            adultAirAge: 12,
            childAirAge: 2,
            suppressGetServiceCategories: undefined,
            limitMinCheckin: undefined,
            limitMaxCheckin: undefined,
            lockCheckin: undefined,
            lockCheckout: undefined,
            searchType: 1,
            products: {
                air: false,
                hotel: false,
                service: true,
                insurance: false,
            },
            components: {
                destination: '#destination',
                startDate: '#startDate',
                endDate: '#endDate',
                passenger: {
                    quantity: '#passenger-quantity',
                    container: '.passenger-container',
                    age: '.passenger-age',
                    room: '.passenger-room'
                },
                hotel: {
                    toggle: '#package-hotel-toggle',
                    components: '.package-hotel',
                    name: '.hotelName',
                    chainCode: '.chainCode',
                    chooseOtherDestination: '.hotel-other-choosedestination',
                    chooseOtherDates: '.hotel-other-choosedates',
                    otherDestination: '.hotel-other-destination',
                    otherCheckIn: '.hotel-other-checkin',
                    otherCheckOut: '.hotel-other-checkout'
                },
                air: {
                    toggle: '#package-air-toggle',
                    components: '.package-air',
                    origin: '#origin',
                    nonStop: '#chkNonStop',
                    oneWay: '#chkOneWay',
                    roundTrip: '#chkRoundTrip',
                    ciaCode: '#drpCiaCode',
                    baggageFilter: '#drpBaggageFilter',
                    cabinType: '#drpCabin'
                },
                service: {
                    toggle: '#package-service-toggle',
                    components: '.package-service',
                    category: '.cboServiceCategory',
                    serviceName: '#service-name'
                },
                insurance: {
                    toggle: '#package-insurance-toggle',
                },
                clearSearchParams: '.clearSearchParams'
            },
            componentsOptions: {
                hideClass: 'hide',
                hasDatepicker: 'hasDatepicker',
                locationValidatorClass: 'just-letters-for-locations'
            },
            controllers: {
                locationsController: undefined,
                messagesController: undefined,
                searchController: undefined
            },
            loadProximities: false
        };

        this.initialize = function (target, opts) {
            _component = $(target);

            $.extend(true, _settings, opts || {});

            _functions.components.select();
            _functions.components.attachEvents();
            _functions.controllers.attachEvents();
        };

        this.setOptions = function (options) {
            $.extend(true, _settings, options);
        };

        this.destroy = function () {
            _functions.components.dettachEvents();
            _functions.controllers.dettachEvents();
        };

        this.render = function () {
            _component.html(_settings.template(_settings));

            _functions.components.select();

            _functions.posRender();
        };

        this.getData = function () {
            var searchParameters = {};

            _functions.getDatas.air(searchParameters);
            _functions.getDatas.hotel(searchParameters);
            _functions.getDatas.service(searchParameters);
            _functions.getDatas.insurance(searchParameters);
            _functions.getDatas.getAirRequestData(searchParameters);
            _functions.getDatas.getHotelRequestData(searchParameters);
            _functions.getDatas.getInsuranceRequestData(searchParameters);

            return searchParameters;
        };

        this.validate = function () {
            var errors = [];

            if (_settings.simpleService) {
                var selectedService = _settings.components.service.serviceName.servicesAutocomplete('getData');

                if (!selectedService) {
                    errors.push("OnSearch_SelectAService");
                }
            }
            else {

                if (!_settings.products.air && !_settings.products.hotel && !_settings.products.service && !settings.products.insurance)
                    errors.push("OnSearch_SelectOneProduct");

                if (_settings.components.destination.val() == "")
                    errors.push("OnSearch_NoDestin");
                else if (_settings.components.destination.locationsFinder("getData") == undefined)
                    errors.push("OnSearch_InvalidDestination");

                if (_settings.components.startDate.val() == "" || !_settings.components.startDate.datepickermanager("val").isDate())
                    errors.push("OnSearchService_NoInitialDate");
                if (_settings.components.endDate.val() == "" || !_settings.components.endDate.datepickermanager("val").isDate())
                    errors.push("OnSearchService_NoFinalDate");

                if (_settings.products.air) {
                    if (_settings.components.air.origin.val() == "")
                        errors.push("OnSearch_NoOrigin");
                    else if (_settings.components.air.origin.locationsFinder("getData") == undefined)
                        errors.push("OnSearch_InvalidOrigin");
                    else if (_settings.components.air.origin.val() == _settings.components.destination.val())
                        errors.push("OnSearch_OriginEqualsDestin");

                    var guests = {
                        babies: 0,
                        adults: 0,
                        children: 0,
                        total: 0
                    };

                    _settings.components.passenger.container.filter(':not(.' + _settings.componentsOptions.hideClass + ')').each(function () {
                        var age = parseInt($(this).find(_settings.components.passenger.age).val());
                        if (age >= _settings.adultAirAge)
                            guests.adults++;
                        else if (age >= _settings.childAirAge)
                            guests.children++;
                        else
                            guests.babies++;
                    });

                    guests.total = guests.babies + guests.adults + guests.children;

                    if (guests.total > 9) {
                        errors.push("OnSearch_NoMoreThanNinePassengers");
                    }

                    if ((guests.children + guests.babies) > _settings.maxChildren && _settings.maxChildren > 0) {
                        errors.push("OnSearch_NoMoreChildren");
                    }

                    if (guests.adults < guests.babies) {
                        errors.push("OnSearch_NeedMoreAdultsThanInfants");
                    }
                }

                if (_settings.products.hotel) {
                    if (_settings.components.hotel.chooseOtherDestination.is(':checked')) {
                        var value = _settings.components.hotel.otherDestination.val();

                        if (!value.length)
                            errors.push("OnSearchAirHotel_NoCityName");
                        else if (value.length < 3)
                            errors.push("OnSearch_HotelCityNameLengthMoreThan3");
                    }

                    if (_settings.components.hotel.chooseOtherDates.is(':checked')) {
                        if (_settings.components.startDate.val() != "" && _settings.components.hotel.otherCheckIn.datepickermanager("val") != "") {
                            if (formatter.dateValuesToDate(_settings.components.hotel.otherCheckIn.datepickermanager("val").toDateValues()) < formatter.dateValuesToDate(_settings.components.startDate.datepickermanager("val").toDateValues())) {
                                errors.push("OnSearchAirHotel_ChekinLessThanOutboundDate");
                            }
                        }

                        if (!_settings.components.hotel.otherCheckOut.datepickermanager("val").length) {
                            errors.push("OnSearch_CheckOutDateFormat");
                        }
                        else {
                            if (_settings.components.hotel.otherCheckOut.val().length && _settings.components.endDate.val().length) {
                                if (formatter.dateValuesToDate(_settings.components.hotel.otherCheckOut.datepickermanager("val").toDateValues()) > formatter.dateValuesToDate(_settings.components.endDate.datepickermanager("val").toDateValues())) {
                                    errors.push("OnSearchAirHotel_CheckOutDateMoreThanInboundDate");
                                }
                            }
                        }
                    }

                    var guests = _functions.getHotelGuestsQuantities();

                    if ((guests.babies + guests.children + guests.adults) > 9)
                        errors.push("OnSearch_NoMoreThanNinePassengers");
                    else if (guests.babies > guests.adults)
                        errors.push("OnSearchAirHotel_OneInfantToOneAdult");
                }

                if (_settings.products.insurance) {
                    var guests = {
                        babies: 0,
                        adults: 0,
                        children: 0,
                        total: 0
                    };

                    _settings.components.passenger.container.filter(':not(.' + _settings.componentsOptions.hideClass + ')').each(function () {
                        var age = parseInt($(this).find(_settings.components.passenger.age).val());
                        if (age >= _settings.adultAirAge)
                            guests.adults++;
                        else if (age >= _settings.childAirAge)
                            guests.children++;
                        else
                            guests.babies++;
                    });

                    guests.total = guests.babies + guests.adults + guests.children;

                    if (guests.total > 9) {
                        errors.push("OnSearch_NoMoreThanNinePassengers");
                    }

                    if ((guests.children + guests.babies) > _settings.maxChildren && _settings.maxChildren > 0) {
                        errors.push("OnSearch_NoMoreChildren");
                    }

                    if (guests.adults < guests.babies) {
                        errors.push("OnSearch_NeedMoreAdultsThanInfants");
                    }

                    var startDateValue = _settings.components.startDate.datepickermanager("val").toDateValues();
                    var endDateValue = _settings.components.endDate.datepickermanager("val").toDateValues();

                    if (Util.DateValuesDiff(endDateValue, startDateValue) < 3) {
                        errors.push("OnSearch_Insurance_MinimumThreeDays");
                    }
                }
            }

            if (_settings.controllers.messagesController && errors && errors.length)
                _settings.controllers.messagesController.notifyMessages(errors, _settings.exhibitionType);

            return !errors.length;
        };

        this.readQueryString = function (querystring) {
            var searchParameters = {};
            searchParameters.AdditionalInfo = {};

            if (Util.QueryString("Air", querystring) == "true")
                _settings.products.air = true;
            else
                _settings.products.air = false;

            if (Util.QueryString("Hotel", querystring) == "true")
                _settings.products.hotel = true;
            else
                _settings.products.hotel = false;

            if (Util.QueryString("Service", querystring) == "true")
                _settings.products.service = true;
            else
                _settings.products.service = false;

            _settings.products.insurance = Util.QueryString("Insurance", querystring) == "true";

            _functions.setInitialProducts();
            _functions.readersQueryString.readCustomersAge(querystring, searchParameters);
            _functions.readersQueryString.readAirQueryString(querystring, searchParameters);
            _functions.readersQueryString.readHotelQueryString(querystring, searchParameters);
            _functions.readersQueryString.readServiceQueryString(querystring, searchParameters);
            _functions.readersQueryString.readInsuranceQueryString(querystring, searchParameters);

            _functions.getDatas.getInsuranceRequestData(searchParameters);

            return searchParameters;
        };

        this.getQueryString = function (pageUrl) {
            pageUrl = pageUrl + "?SearchType=DynamicPackage";

            if (_settings.products.air)
                pageUrl += "&Air=true"
            if (_settings.products.service)
                pageUrl += "&Service=true"
            if (_settings.products.hotel)
                pageUrl += "&Hotel=true"
            if (_settings.products.insurance)
                pageUrl += "&Insurance=true"

            if (!_settings.simpleService) {
                var querystring = "&Destination=" + _settings.components.destination.val().removeDiacritics().replaceAll(" ", "%20").replaceAll("(", "%28").replaceAll(")", "%29");
                var destination = _settings.components.destination.locationsFinder("getData");
                querystring += "&DestinationId=" + destination.id;
                querystring += "&StartDate=" + $.datepicker.formatDate('dd/mm/yy', $(_settings.components.startDate).datepickermanager('getDate'));
                querystring += "&EndDate=" + $.datepicker.formatDate('dd/mm/yy', $(_settings.components.endDate).datepickermanager('getDate'));
                querystring += "&QtdPassengers=" + _settings.components.passenger.quantity.val();
                querystring += "&Ages=";

                _settings.components.passenger.container.filter(':not(.' + _settings.componentsOptions.hideClass + ')').each(function (index) {
                    if (index > 0)
                        querystring += ",";

                    querystring += $(this).find(_settings.components.passenger.age).val();
                });
            }

            if (_settings.products.air) {
                querystring += "&Origin=" + _settings.components.air.origin.val().removeDiacritics().replaceAll(" ", "%20").replaceAll("(", "%28").replaceAll(")", "%29");
                var origin = _settings.components.air.origin.locationsFinder("getData");
                querystring += "&OriginId=" + origin.id;
                querystring += "&NonStop=" + (_settings.components.air.nonStop.is(':checked') ? "1" : "0");
                querystring += "&RoundTrip=" + (_settings.components.air.roundTrip.is(':checked') ? "1" : "0");
                querystring += "&Cabin=" + _settings.components.air.cabinType.val();
                querystring += "&Cia=" + _settings.components.air.ciaCode.val();
                querystring += "&Baggage=" + _settings.components.air.baggageFilter.val();
            }

            if (_settings.products.hotel) {
                querystring += "&HotelName=" + _settings.components.hotel.name.val();
                querystring += "&HotelChainCode=" + _settings.components.hotel.chainCode.val();
                querystring += "&PassengerRooms=";

                _settings.components.passenger.container.filter(':not(.' + _settings.componentsOptions.hideClass + ')').each(function (index) {
                    if (index > 0)
                        querystring += ",";
                    querystring += $(this).find(_settings.components.passenger.room).val();
                });

                if (_settings.components.hotel.chooseOtherDestination.is(':checked')) {
                    querystring += "&HotelDestination=" + _settings.components.hotel.otherDestination.val().removeDiacritics().replaceAll(" ", "%20").replaceAll("(", "%28").replaceAll(")", "%29");
                    var destination = _settings.components.hotel.otherDestination.locationsFinder("getData");
                    querystring += "&HotelDestinationId=" + destination.id;
                }


                if (_settings.components.hotel.chooseOtherDates.is(':checked')) {
                    querystring += "&CheckIn=" + _settings.components.hotel.otherCheckIn.datepickermanager("val");
                    querystring += "&CheckOut=" + _settings.components.hotel.otherCheckOut.datepickermanager("val");
                }
            }

            if (_settings.products.service) {
                if (!_settings.simpleService) {
                    querystring += "&ServiceCategory=" + _settings.components.service.category.val();
                    if (_settings.components.service.serviceName && _settings.components.service.serviceName.length) {
                        var selectedService = _settings.components.service.serviceName.servicesAutocomplete('getData');
                        if (selectedService) {
                            querystring += '&ServiceId=' + selectedService.Id;
                            querystring += '&ServiceName=' + selectedService.Name;
                        }
                    }
                }
                else {
                    if (_settings.components.service.serviceName && _settings.components.service.serviceName.length) {
                        var selectedService = _settings.components.service.serviceName.servicesAutocomplete('getData');
                        if (selectedService) {
                            querystring += '&ServiceId=' + selectedService.Id;
                            querystring += "&StartDate=" + formatter.dateValuesShort((new Date().addDays(_settings.minSearchDays + 1)).toDateValues());
                            querystring += "&EndDate=" + formatter.dateValuesShort((new Date().addDays(_settings.maxSearchDays - 1)).toDateValues());

                            querystring += "&DestinationId=" + selectedService.LocationId;
                            querystring += '&ServiceName=' + selectedService.Name;
                        }
                    }
                }
            }

            if (_settings.products.insurance) {
                var destinationId = _functions.getDestinationLocation("id");

                if (destinationId) {
                    querystring += "&DestinationId=" + destinationId.toString();
                    querystring += "&StartDate=" + $.datepicker.formatDate('dd/mm/yy', $(_settings.components.startDate).datepickermanager('getDate'));
                    querystring += "&EndDate=" + $.datepicker.formatDate('dd/mm/yy', $(_settings.components.endDate).datepickermanager('getDate'));
                    querystring += "&Ages=";

                    _settings.components.passenger.container.filter(':not(.' + _settings.componentsOptions.hideClass + ')').each(function (index) {
                        if (index > 0)
                            querystring += ",";

                        querystring += $(this).find(_settings.components.passenger.age).val();
                    });
                }
            }

            querystring = querystring.replace("undefined", "");
            querystring = querystring.replace("null", "");

            return pageUrl + querystring;
        };

        this.fillValues = function (data) {
            _functions.fillValues.fillCustomersAge(data);
            _functions.fillValues.fillAirValues(data);
            _functions.fillValues.fillHotelValues(data);
            _functions.fillValues.fillServiceValues(data);
            _functions.fillValues.fillInsuranceValues(data);
        };

        this.getGenericData = function () { }

        this.updateValues = function () { }

        var _events = {
            components: {
                changePassengerQuantity: function () {
                    var quantity = _settings.components.passenger.quantity.val();
                    _settings.components.passenger.container.addClass(_settings.componentsOptions.hideClass);
                    for (var i = 0; i < quantity; i++) {
                        _settings.components.passenger.container.eq(i).removeClass(_settings.componentsOptions.hideClass);
                    }
                },
                showHotelOtherDates: function () {
                    if ($(this).is(':checked')) {
                        _settings.components.hotel.otherCheckIn.removeClass(_settings.componentsOptions.hideClass).parent('label').removeClass(_settings.componentsOptions.hideClass);
                        _settings.components.hotel.otherCheckOut.removeClass(_settings.componentsOptions.hideClass).parent('label').removeClass(_settings.componentsOptions.hideClass);
                    }
                    else {
                        _settings.components.hotel.otherCheckIn.addClass(_settings.componentsOptions.hideClass).parent('label').addClass(_settings.componentsOptions.hideClass);
                        _settings.components.hotel.otherCheckOut.addClass(_settings.componentsOptions.hideClass).parent('label').addClass(_settings.componentsOptions.hideClass);
                    }
                },
                showHotelOtherDestination: function () {
                    if ($(this).is(':checked'))
                        _settings.components.hotel.otherDestination.removeClass(_settings.componentsOptions.hideClass).parent('label').removeClass(_settings.componentsOptions.hideClass);
                    else
                        _settings.components.hotel.otherDestination.addClass(_settings.componentsOptions.hideClass).parent('label').addClass(_settings.componentsOptions.hideClass);
                },
                toggleAirComponents: function () {
                    if ($(this).is(':checked'))
                        _functions.showAirComponents();
                    else
                        _functions.hideAirComponents();
                },
                toggleHotelComponents: function () {
                    if ($(this).is(':checked'))
                        _functions.showHotelComponents();
                    else
                        _functions.hideHotelComponents();
                },
                toggleServiceComponents: function () {
                    if ($(this).is(':checked'))
                        _functions.showServiceComponents();
                    else
                        _functions.hideServiceComponents();
                },
                toggleInsuranceComponents: function () {
                    if ($(this).is(':checked'))
                        _functions.showInsuranceComponents();
                    else
                        _functions.hideInsuranceComponents();
                }, 
            },
            controllers: {
                onGetCategoriesCompleted: function (response) {
                    if (response && response.Successful && response.GetServiceCategoriesRS) {
                        _settings.components.service.category.html(_settings.templates.categories(response.GetServiceCategoriesRS.Categories));
                    }
                }
            }
        };

        var _functions = {
            getHotelGuestsQuantities: function () {
                var guests = {
                    babies: 0,
                    adults: 0,
                    children: 0,
                    total: 0
                };

                var rooms = _functions.getDatas.getRoomsRequest();

                $.each(rooms, function () {
                    guests.adults += this.Adults;
                    $.each(this.ChildAges, function () {
                        this > 2 ? guests.children++ : guests.babies++;
                    });
                });

                guests.total = guests.babies + guests.adults + guests.children;

                return guests;
            },
            getDestinationLocation: function (property) {
                var data = _settings.components.destination.locationsFinder("getData");

                if (property && data[property])
                    return data[property];

                return data;
            },
            showAirComponents: function () {
                _settings.products.air = true;
                _settings.components.air.toggle.check();
                _settings.components.air.components.removeClass(_settings.componentsOptions.hideClass);
                _settings.components.air.origin.removeClass(_settings.componentsOptions.hideClass);
            },
            showHotelComponents: function () {
                _settings.products.hotel = true;
                _settings.components.hotel.toggle.check();
                _settings.components.hotel.components.removeClass(_settings.componentsOptions.hideClass);
            },
            showServiceComponents: function () {
                _settings.products.service = true;
                _settings.components.service.toggle.check();
                _settings.components.service.components.removeClass(_settings.componentsOptions.hideClass);
            },
            showInsuranceComponents: function () {
                _settings.products.insurance = true;
                _settings.components.insurance.toggle.check();
            },
            hideAirComponents: function () {
                _settings.products.air = false;
                _settings.components.air.toggle.uncheck();
                _settings.components.air.components.addClass(_settings.componentsOptions.hideClass);
                _settings.components.air.origin.addClass(_settings.componentsOptions.hideClass);
            },
            hideHotelComponents: function () {
                _settings.products.hotel = false;
                _settings.components.hotel.toggle.uncheck();
                _settings.components.hotel.components.addClass(_settings.componentsOptions.hideClass);
            },
            hideServiceComponents: function () {
                _settings.products.service = false;
                _settings.components.service.toggle.uncheck();
                _settings.components.service.components.addClass(_settings.componentsOptions.hideClass);
            },
            hideInsuranceComponents: function () {
                _settings.products.insurance = false;
                _settings.components.insurance.toggle.uncheck();
            },
            setDefaultDate: function (defaultDate, $component) {
                if (defaultDate) {
                    var date = defaultDate.toDateValues();

                    if (date.isValid) {
                        $component
                            .datepickermanager("setDate", formatter.dateValuesToDate(date))
                            .datepickermanager("val", formatter.dateValuesShort(date));
                    }
                }
            },
            startDateRules: function () {
                _functions.applyMinDateRules(_settings.components.startDate);
                _functions.applyMaxDateRules(_settings.components.startDate);

                var startDate = _settings.components.startDate.datepickermanager("getDate");
                var refToCalcCheckoutMaxDate = _settings.calcCheckoutMaxDateFromToday ? (new Date()) : startDate;

                if (startDate != null) {
                    var minDate = startDate;

                    if (_settings.useMinDaysToSearchToCheckout)
                        minDate = startDate.addDays(_settings.minSearchDays);

                    if (!_settings.limitMinCheckin)
                        _settings.components.endDate.datepickermanager("option", "minDate", minDate);
                }
            },
            endDateRules: function () {
                _functions.applyMinDateRules(_settings.components.endDate);
                _functions.applyMaxDateRules(_settings.components.endDate);
            },
            applyMinDateRules: function (ctrl) {
                var myDate = ctrl.datepickermanager("getDate");
                var minDate = ctrl.datepickermanager("option", "minDate");
                var currentDateValue = ctrl.datepickermanager("val").toDateValues();

                if (!myDate)
                    myDate = minDate;

                mindate = minDate.toDateValues();
                mindate.Hour = 0;
                mindate.Minutes = 0;
                mindate = Util.DateValuesToDate(mindate);

                myDate = myDate.toDateValues();
                myDate.Hour = 0;
                myDate.Minutes = 0;
                myDate = Util.DateValuesToDate(myDate);

                if (myDate < mindate || (currentDateValue.isValid == false && ctrl.val() != "")) {
                    ctrl.datepickermanager('setDate', mindate);
                    _settings.controllers.messagesController.notifyMessages(["ApplyCorrectDateRule"], _settings.exhibitionType);
                }
            },
            applyMaxDateRules: function (ctrl) {
                var myDate = ctrl.datepickermanager("getDate");
                var minDate = ctrl.datepickermanager("option", "minDate");
                var maxDate = ctrl.datepickermanager("option", "maxDate");
                var currentDateValue = ctrl.datepickermanager("val").toDateValues();

                if (!myDate)
                    myDate = maxDate;

                if (myDate > maxDate || (currentDateValue.isValid == false && ctrl.val() != "")) {
                    ctrl.datepickermanager('setDate', minDate);
                    _settings.controllers.messagesController.notifyMessages(["ApplyCorrectDateRule"], _settings.exhibitionType);
                }
            },
            removeInvalidPassengersQuantity: function () {
                _settings.components.passenger.quantity.find('option').filter(function () {
                    return $(this).val() > _settings.maxPassengers;
                }).remove();
            },
            initializeServicesAutoComplete: function () {
                if (_settings.components.service.serviceName && _settings.components.service.serviceName.length) {
                    _settings.components.service.serviceName.servicesAutocomplete({
                        controllers: {
                            searchController: _settings.controllers.searchController
                        }
                    });
                }
            },
            getCategories: function () {
                if (_settings.controllers.searchController && !_settings.suppressGetServiceCategories)
                    _settings.controllers.searchController.getServiceCategories();
            },
            setInitialProducts: function () {
                if (_settings.products.air)
                    _functions.showAirComponents();
                else
                    _functions.hideAirComponents();

                if (_settings.products.hotel)
                    _functions.showHotelComponents();
                else
                    _functions.hideHotelComponents();

                if (_settings.products.service)
                    _functions.showServiceComponents();
                else
                    _functions.hideServiceComponents();

                if (_settings.products.insurance)
                    _functions.showInsuranceComponents();
                else
                    _functions.hideInsuranceComponents();
            },
            initializeDatePickers: function () {
                var _settingsDatePicker = {
                    numberOfMonths: (Global.Mobile) ? 1 : 2,
                    'minDate': (new Date()).addDays(_settings.minSearchDays),
                    'maxDate': (new Date()).addDays(_settings.maxSearchDays)
                };

                if (_settings.limitMinCheckin)
                    _settingsDatePicker.minDate = Util.StringToDate(_settings.limitMinCheckin, formatter.language);
                if (_settings.limitMaxCheckin)
                    _settingsDatePicker.maxDate = Util.StringToDate(_settings.limitMaxCheckin, formatter.language);
                _settings.components.startDate.removeClass(_settings.componentsOptions.hasDatepicker).datepickermanager('destroy').datepickermanager(DatePickerOption(_settingsDatePicker));
                _settings.components.hotel.otherCheckIn.removeClass(_settings.componentsOptions.hasDatepicker).datepickermanager('destroy').datepickermanager(DatePickerOption(_settingsDatePicker));

                _settingsDatePicker.minDate = _settingsDatePicker.minDate.addDays(_settings.minPeriodToSearch);
                _settingsDatePicker.maxDate = _settingsDatePicker.maxDate.addDays(_settings.minPeriodToSearch);
                if (_settings.limitMinCheckout)
                    _settingsDatePicker.minDate = Util.StringToDate(_settings.limitMinCheckout, formatter.language);
                if (_settings.limitMaxCheckout)
                    _settingsDatePicker.maxDate = Util.StringToDate(_settings.limitMaxCheckout, formatter.language);
                _settings.components.endDate.removeClass(_settings.componentsOptions.hasDatepicker).datepickermanager('destroy').datepickermanager(DatePickerOption(_settingsDatePicker));
                _settings.components.hotel.otherCheckOut.removeClass(_settings.componentsOptions.hasDatepicker).datepickermanager('destroy').datepickermanager(DatePickerOption(_settingsDatePicker));

                if (_settings.lockCheckin == "true")
                    _settings.components.startDate.attr("disabled", "disabled");
                if (_settings.lockCheckout == "true")
                    _settings.components.endDate.attr("disabled", "disabled");

            },
            initializeLocationsFinder: function () {
                var options = {
                    SearchType: Global.SearchTypes.Full,
                    maxResultsClient: 15,
                    maxResultsServer: 30,
                    idealNumberOfProximities: 6,
                    idealNumberOfProximitiesRoots: 3,
                    useCacheEnhancer: true,
                    onlyHalfClientResults: true,
                    onDropBoxSelect: function () { },
                    clientCache: Global.LocationsCache,
                    useScroll: true,
                    applyStatusClasses: true,
                    controllers: {
                        locationsController: _settings.controllers.locationsController
                    },
                    loadProximities: _settings.loadProximities
                };

                _settings.components.destination.locationsFinder(options).click(function () { $(this).select(); });
                _settings.components.air.origin.locationsFinder(options).click(function () { $(this).select(); });
                _settings.components.hotel.otherDestination.locationsFinder(options).click(function () { $(this).select(); });

                if (_settings.defaultOriginId > 0) {
                    var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(_settings.defaultOriginId) });
                    if (auxLocationData.length > 0)
                        _settings.components.air.origin.locationsFinder('setData', auxLocationData[0]);
                }
                if (_settings.defaultDestinationId > 0) {
                    var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(_settings.defaultDestinationId) });
                    if (auxLocationData.length > 0)
                        _settings.components.destination.locationsFinder('setData', auxLocationData[0]);
                }

                if (_settings.lockDestination == "true")
                    _settings.components.destination.attr("disabled", "disabled");

            },
            fillValues: {
                fillCustomersAge: function (data) {
                    if (data.AdditionalInfo && data.AdditionalInfo.Customers && data.AdditionalInfo.Customers.length) {
                        _settings.components.passenger.quantity.val(data.AdditionalInfo.Customers.length);
                        _events.components.changePassengerQuantity();
                        $.each(data.AdditionalInfo.Customers, function (index) {
                            _settings.components.passenger.age.eq(index).val(this.toString());
                        });
                    }
                },
                fillAirValues: function (data) {
                    if (data.Air) {

                        var passengersCount = 0;
                        passengersCount += data.Air.Adults;
                        passengersCount += data.Air.Children;
                        passengersCount += data.Air.Babies;

                        _settings.components.passenger.quantity.val(passengersCount);
                        _events.components.changePassengerQuantity();
                        //BUG 2101 - IE7 
                        if (data.Air.IsRoundTrip)
                            _settings.components.air.roundTrip.check();
                        else {
                            _settings.components.air.roundTrip.uncheck();
                            _settings.components.air.oneWay.check();
                        }


                        if (data.Air.Destinations[0].OutboundDate) {
                            _settings.components.startDate
                                .datepickermanager("setDate", formatter.dateValuesToDate(data.Air.Destinations[0].OutboundDate))
                                .datepickermanager("val", formatter.dateValuesShort(data.Air.Destinations[0].OutboundDate));

                            _functions.startDateRules();
                        }

                        if (data.Air.Destinations[0].InboundDate) {
                            _settings.components.endDate
                                .datepickermanager("setDate", formatter.dateValuesToDate(data.Air.Destinations[0].InboundDate))
                                .datepickermanager("val", formatter.dateValuesShort(data.Air.Destinations[0].InboundDate));

                            _functions.endDateRules();
                        }

                        if (data.Air.Destinations[0].NonStop)
                            _settings.components.air.nonStop.check();

                        if (data.Air.BaggageFilter)
                            _settings.components.air.baggageFilter.val(data.Air.BaggageFilter);

                        _settings.components.air.cabinType.val(data.CabinType);

                        if (data.Air.Destinations && data.Air.Destinations.length && data.Air.Destinations[0].CiaCodes && data.Air.Destinations[0].CiaCodes.length) {
                            var ciaCodes = undefined;

                            if (data.Air.Destinations[0].CiaCodes.length == 1)
                                ciaCodes = data.Air.Destinations[0].CiaCodes[0];
                            else if (data.Air.Destinations[0].CiaCodes.length == 2)
                                ciaCodes = data.Air.Destinations[0].CiaCodes[0] + ',' + data.Air.Destinations[0].CiaCodes[1];

                            _settings.components.air.ciaCode.val(ciaCodes);
                        }

                        if (data.Air.Destinations) {
                            if (data.Air.Destinations[0].OriginData) {
                                _settings.components.air.origin.locationsFinder("setData", data.Air.Destinations[0].OriginData);
                            }
                            else {
                                var origin = data.Air.Destinations[0].Origin;

                                if (origin && origin.length == 3) {
                                    var location = Global.LocationsCache.first(function (h) { return h.i == origin; });

                                    if (location) {
                                        _settings.components.air.origin.locationsFinder("setData", location);
                                    }
                                    else {
                                        var loadByIataUrl = Global.WebCommonPath + "Handlers/LocationsCache.ashx?" + "culture=" + Global.Culture + "&iata=" + origin;

                                        $.getScript(loadByIataUrl, function (resp) {
                                            if (resp) {
                                                (new Function(resp))();

                                                loc = Global.LocationsCache.first(function (l) { return l && l.i == origin });

                                                if (loc) {
                                                    _settings.components.air.origin.locationsFinder("setData", loc);
                                                }
                                            }
                                        });
                                    }
                                }
                                else {
                                    _settings.components.air.origin.val(origin);
                                }
                            }

                            if (data.Air.Destinations[0].DestinationData) {
                                _settings.components.destination.locationsFinder("setData", data.Air.Destinations[0].DestinationData);
                            }
                            else {

                                var destination = data.Air.Destinations[0].Destination;

                                if (destination && destination.length == 3) {
                                    var location = Global.LocationsCache.first(function (h) { return h.i == destination; });

                                    if (location) {
                                        _settings.components.destination.locationsFinder("setData", location);
                                    }
                                    else {
                                        var loadByIataUrl = Global.WebCommonPath + "Handlers/LocationsCache.ashx?" + "culture=" + Global.Culture + "&iata=" + destination;

                                        $.getScript(loadByIataUrl, function (resp) {
                                            if (resp) {
                                                (new Function(resp))();

                                                loc = Global.LocationsCache.first(function (l) { return l && l.i == destination });

                                                if (loc) {
                                                    _settings.components.destination.locationsFinder("setData", loc);
                                                }
                                            }
                                        });
                                    }
                                }
                                else {
                                    _settings.components.destination.val(destination);
                                }
                            }
                        }
                    }
                },
                fillHotelValues: function (data) {
                    if (data.Hotel) {
                        _settings.components.destination.locationsFinder("setDataById", data.Hotel.LocationId);

                        if (data.Hotel.Name)
                            _settings.components.hotel.name.val(data.Hotel.Name);

                        if (data.Hotel.CheckIn && data.Hotel.CheckIn.isValid) {
                            _settings.components.startDate.datepickermanager("setDate", formatter.dateValuesToDate(data.Hotel.CheckIn))
                            _settings.components.startDate.datepickermanager("val", formatter.dateValuesShort(data.Hotel.CheckIn));
                            _functions.startDateRules();
                        }

                        if (data.Hotel.CheckOut && data.Hotel.CheckOut.isValid) {
                            _settings.components.endDate.datepickermanager("setDate", formatter.dateValuesToDate(data.Hotel.CheckOut));
                            _settings.components.endDate.datepickermanager("val", formatter.dateValuesShort(data.Hotel.CheckOut));
                        }

                        var passengersCount = 0;
                        for (var i = 0; i < data.Hotel.RoomsRequest.length; i++) {
                            var room = data.Hotel.RoomsRequest[i];

                            for (var j = 0; j < room.Adults; j++) {
                                _settings.components.passenger.room.eq(passengersCount).val(i + 1);
                                passengersCount++;
                            }

                            for (var j = 0; j < room.ChildAges.length ; j++) {
                                _settings.components.passenger.room.eq(passengersCount).val(i + 1);
                                passengersCount++;
                            }
                        }

                        _settings.components.passenger.quantity.val(passengersCount);
                        _events.components.changePassengerQuantity();
                    }
                },
                fillServiceValues: function (data) {
                    if (data.Service) {
                        if (data.Service.LocationId)
                            _settings.components.destination.locationsFinder("setDataById", data.Service.LocationId);

                        if (data.Service.StartDate && data.Service.StartDate.isValid) {
                            _settings.components.startDate.datepickermanager("setDate", formatter.dateValuesToDate(data.Service.StartDate))
                            _settings.components.startDate.datepickermanager("val", formatter.dateValuesShort(data.Service.StartDate));
                            _functions.startDateRules();
                        }

                        if (data.Service.EndDate && data.Service.EndDate.isValid) {
                            _settings.components.endDate.datepickermanager("setDate", formatter.dateValuesToDate(data.Service.EndDate))
                            _settings.components.endDate.datepickermanager("val", formatter.dateValuesShort(data.Service.EndDate));
                            _functions.endDateRules();
                        }

                        if (data.Service.CategoryId)
                            _settings.components.service.category.val(data.Service.CategoryId);

                        if (data.Service.ServiceId)
                            _settings.components.service.serviceName.servicesAutocomplete('setById', data.Service.ServiceId);
                    }
                },
                fillInsuranceValues: function (data) {
                    if (data && data.Insurance) {
                        if (data.Insurance.Location && data.Insurance.Location.Id)
                            _settings.components.destination.locationsFinder("setDataById", data.Insurance.Location.Id);

                        if (data.Insurance.StartDate && data.Insurance.StartDate.isValid) {
                            _settings.components.startDate.datepickermanager("setDate", formatter.dateValuesToDate(data.Insurance.StartDate))
                            _settings.components.startDate.datepickermanager("val", formatter.dateValuesShort(data.Insurance.StartDate));

                            _functions.startDateRules();
                        }

                        if (data.Insurance.EndDate && data.Insurance.EndDate.isValid) {
                            _settings.components.endDate.datepickermanager("setDate", formatter.dateValuesToDate(data.Insurance.EndDate))
                            _settings.components.endDate.datepickermanager("val", formatter.dateValuesShort(data.Insurance.EndDate));

                            _functions.endDateRules();
                        }

                        if (data.Insurance.PassengerAges) {
                            _settings.components.passenger.quantity.val(data.Insurance.PassengerAges.length);
                            _events.components.changePassengerQuantity();

                            $.each(data.Insurance.PassengerAges, function (index) {
                                _settings.components.passenger.age.eq(index).val(this.toString());
                            });
                        }
                    }
                },
            },
            readersQueryString: {
                readCustomersAge: function (querystring, searchParameters) {
                    searchParameters.AdditionalInfo.Customers = [];
                    if ((Util.QueryString("Ages", querystring) && Util.QueryString("Ages", querystring).length)) {
                        $.each(Util.QueryString("Ages", querystring).split(','), function () {
                            searchParameters.AdditionalInfo.Customers.push(this.toString());
                        });
                    }
                },
                readAirQueryString: function (querystring, searchParameters) {
                    if (_settings.products.air) {
                        searchParameters.Air = {};
                        searchParameters.Air.IsRoundTrip = (Util.QueryString("RoundTrip", querystring) == 1 || Util.QueryString("RoundTrip", querystring) == "true") ? true : false;
                        searchParameters.Air.CabinType = Util.QueryString("Cabin", querystring);
                        searchParameters.Air.BaggageFilter = Util.QueryString("Baggage", querystring);

                        var cityPair = {};

                        cityPair.NonStop = (Util.QueryString("NonStop", querystring) == 1 || Util.QueryString("RoundTrip", querystring) == "true") ? true : false;
                        cityPair.CiaCodes = [];
                        if (Util.QueryString("Cia", querystring)) {
                            var ciaCode;
                            var ciaCodeValue = Util.QueryString("Cia", querystring);

                            if (ciaCodeValue != "")
                                ciaCode = ciaCodeValue;

                            if (ciaCode && ciaCode != "") {
                                if (ciaCode.indexOf(",") >= 0)
                                    cityPair.CiaCodes = ciaCode.split(",");
                                else
                                    cityPair.CiaCodes.push(ciaCode);
                            }
                        }

                        var subtractDays = Util.QueryString("SubtractDays", querystring);
                        var outboundDate = Util.QueryString("StartDate", querystring);
                        cityPair.OutboundDate = outboundDate.toDateValues('pt');
                        if (!isNaN(subtractDays) && parseInt(subtractDays))
                            cityPair.OutboundDate.Day -= subtractDays;

                        var inboundDate = Util.QueryString("EndDate", querystring);
                        if (inboundDate != undefined)
                            cityPair.InboundDate = inboundDate.toDateValues('pt');

                        origin = Util.GetQueryStringValue("Origin", querystring, true);
                        cityPair.Origin = origin;

                        destination = Util.GetQueryStringValue("Destination", querystring, true);
                        cityPair.Destination = destination;

                        if (Global.LocationsCache && Global.LocationsCache.length > 0) {
                            var auxOriginData = Global.LocationsCache.where(function (loc) { return loc.id == Util.QueryString("OriginId", querystring) });

                            if (auxOriginData.length > 0)
                                cityPair.OriginData = auxOriginData[0];

                            var auxDestinationData = Global.LocationsCache.where(function (loc) { return loc.id == Util.QueryString("DestinationId", querystring) });

                            if (auxDestinationData.length > 0)
                                cityPair.DestinationData = auxDestinationData[0];
                        } else {
                            cityPair.OriginData = origin;
                            cityPair.DestinationData = destination;
                        }

                        searchParameters.Air.Adults = _functions.readersQueryString.getAdultCountquerystring(querystring, _settings.adultAirAge);
                        searchParameters.Air.Children = _functions.readersQueryString.getChildrenCountquerystring(querystring, _settings.childAirAge, _settings.adultAirAge);
                        searchParameters.Air.Babies = _functions.readersQueryString.getInfantCountquerystring(querystring, _settings.childAirAge);
                        searchParameters.Air.Destinations = [cityPair];
                        _functions.getDatas.getAirRequestData(searchParameters);
                    }
                },
                readHotelQueryString: function (querystring, searchParameters) {
                    if (_settings.products.hotel) {
                        searchParameters.Hotel = {};

                        searchParameters.Hotel = {};

                        searchParameters.Hotel.RoomsRequest = _functions.readersQueryString.createRooms(querystring);

                        if (Util.QueryString("CheckIn", querystring)) {
                            searchParameters.Hotel.CheckIn = Util.QueryString("CheckIn", querystring).toDateValues('pt');
                            searchParameters.Hotel.CheckOut = Util.QueryString("CheckOut", querystring).toDateValues('pt');
                        }
                        else {
                            searchParameters.Hotel.CheckIn = Util.QueryString("StartDate", querystring).toDateValues('pt');
                            searchParameters.Hotel.CheckOut = Util.QueryString("EndDate", querystring).toDateValues('pt');
                        }

                        var location = undefined;

                        if (Util.QueryString("HotelDestinationId", querystring)) {
                            searchParameters.Hotel.LocationId = Util.QueryString("HotelDestinationId", querystring);
                            location = Util.GetQueryStringValue("HotelDestination", querystring, true);
                        }
                        else {
                            searchParameters.Hotel.LocationId = Util.QueryString("DestinationId", querystring);
                            location = Util.GetQueryStringValue("Destination", querystring, true);
                        }

                        var destination = location;

                        if (Global.LocationsCache && Global.LocationsCache.length > 0) {
                            var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.d == $.trim(destination) });

                            if (auxLocationData.length > 0)
                                searchParameters.Hotel.LocationData = auxLocationData[0];
                        }
                        else {
                            searchParameters.Hotel.LocationData = destination;
                        }

                        searchParameters.Hotel.Location = location;

                        if (searchParameters.Hotel.Location.length == 3)
                            searchParameters.Hotel.Location = searchParameters.Hotel.Location.toUpperCase();
                        _functions.getDatas.getHotelRequestData(searchParameters);
                    }
                },
                readServiceQueryString: function (querystring, searchParameters) {
                    if (_settings.products.service) {
                        searchParameters.Service = {};

                        var ages = Util.QueryString("Ages", querystring);
                        if (ages && ages.length) {
                            searchParameters.Service.Customers = [{ Key: 0, Value: [] }];
                            $.each(ages.split(','), function () {
                                searchParameters.Service.Customers[0].Value.push(this.toString());
                            });
                        }

                        searchParameters.Service.StartDate = Util.QueryString("StartDate", querystring).toDateValues('pt');
                        searchParameters.Service.EndDate = Util.QueryString("EndDate", querystring).toDateValues('pt');
                        searchParameters.Service.LocationId = Util.QueryString("DestinationId", querystring);
                        if (Global.LocationsCache && Global.LocationsCache.length > 0) {
                            var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(searchParameters.Service.LocationId) });

                            if (auxLocationData.length > 0) {
                                if (!searchParameters.AdditionalInfo)
                                    searchParameters.AdditionalInfo = {};
                                searchParameters.AdditionalInfo.ServiceDestination = auxLocationData[0];
                            }
                        }

                        var categoryId = Util.QueryString("ServiceCategory", querystring);
                        if (categoryId && categoryId.length)
                            searchParameters.Service.CategoryId = categoryId;

                        var serviceId = Util.QueryString("ServiceId", querystring);
                        if (serviceId && serviceId.length)
                            searchParameters.Service.ServiceId = serviceId;

                    }
                },
                readInsuranceQueryString: function (querystring, searchParameters) {
                    if (_settings.products.insurance) {
                        var destinationId = Util.QueryString("DestinationId", querystring);
                        var ages = Util.QueryString("Ages", querystring);

                        searchParameters.Insurance = {
                            EndDate: Util.QueryString("EndDate", querystring).toDateValues('pt'),
                            StartDate: Util.QueryString("StartDate", querystring).toDateValues('pt'),
                            PassengerAges: []
                        };

                        if (ages && ages.length)
                            $.each(ages.split(','), function (index, age) {
                                searchParameters.Insurance.PassengerAges.push(parseInt(age));
                            });

                        if (destinationId && Global && Util.HasCount(Global.LocationsCache)) {
                            var locationsFound = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(destinationId) });

                            if (Util.HasCount(locationsFound)) {
                                var parsedLocation = {
                                    "Id": locationsFound[0].id,
                                    "Code": locationsFound[0].co,
                                    "IATA": locationsFound[0].IATANormalized,
                                    "Name": locationsFound[0].d,
                                    "ParentId": null,
                                    "Type": locationsFound[0].t,
                                    "HasAirportChildren": Util.HasCount(locationsFound[0].ac),
                                    "Hits": locationsFound[0].h,
                                };

                                searchParameters.Insurance.Location = parsedLocation;
                            }
                                
                        }
                    }
                },
                createRooms: function (querystring) {
                    var queryRooms = Util.QueryString("PassengerRooms", querystring);
                    var splitedRooms = (queryRooms) ? queryRooms.split(',') : [];
                    var queryAges = Util.QueryString("Ages", querystring);
                    var ages = queryAges.split(',');

                    var rooms = {};
                    for (var i = 0; i < splitedRooms.length; i++) {
                        if (!rooms[splitedRooms[i]])
                            rooms[splitedRooms[i]] = { Adults: 0, ChildAges: [] };

                        if (ages[i] < _settings.adultHotelAge)
                            rooms[splitedRooms[i]].ChildAges.push(ages[i]);
                        else
                            rooms[splitedRooms[i]].Adults++;
                    }

                    var roomsRequests = [];
                    for (var room in rooms)
                        roomsRequests.push(rooms[room]);

                    return roomsRequests;
                },
                getAdultCountquerystring: function (querystring, adultAge) {
                    var queryAges = Util.QueryString("Ages", querystring);
                    var ages = queryAges.split(',');
                    var adults = 0;
                    for (var i = 0; i < ages.length; i++) {
                        if (ages[i] >= adultAge)
                            adults++;
                    }

                    return adults;
                },
                getChildrenCountquerystring: function (querystring, childAge, adultAge) {
                    var queryAges = Util.QueryString("Ages", querystring);
                    var ages = queryAges.split(',');
                    var children = 0;
                    for (var i = 0; i < ages.length; i++) {
                        if (ages[i] >= childAge && ages[i] < adultAge)
                            children++;
                    }

                    return children;
                },
                getInfantCountquerystring: function (querystring, childAge) {
                    var queryAges = Util.QueryString("Ages", querystring);
                    var ages = queryAges.split(',');
                    var infants = 0;
                    for (var i = 0; i < ages.length; i++) {
                        if (ages[i] < childAge)
                            infants++;
                    }

                    return infants;
                }
            },
            getDatas: {
                getRoomsRequest: function () {
                    var roomsRequest = [];
                    var rooms = {};

                    _settings.components.passenger.container.filter(':not(.' + _settings.componentsOptions.hideClass + ')').each(function (index) {
                        var container = $(this);
                        var roomIndex = container.find(_settings.components.passenger.room).val();
                        if (!rooms[roomIndex])
                            rooms[roomIndex] = {
                                Adults: 0,
                                ChildAges: []
                            };

                        if (container.find(_settings.components.passenger.age).val() > _settings.adultHotelAge)
                            rooms[roomIndex].Adults++;
                        else
                            rooms[roomIndex].ChildAges.push(container.find(_settings.components.passenger.age).val());
                    });

                    for (var roomIndex in rooms)
                        roomsRequest.push(rooms[roomIndex]);

                    return roomsRequest;
                },
                getAirDestinations: function () {
                    var cityPair = {};

                    if ($.fn.locationsFinder) {
                        origin = _settings.components.air.origin.locationsFinder("getData");
                        cityPair.Origin = origin && origin.i ? origin.i : _settings.components.air.origin.val();

                        destination = _settings.components.destination.locationsFinder("getData");
                        cityPair.Destination = destination && destination.i ? destination.i : _settings.components.destination.val();
                    }
                    else {
                        origin = _settings.components.air.origin.val();
                        cityPair.Origin = origin;

                        destination = _settings.components.destination.val();
                        cityPair.Destination = destination;
                    }

                    cityPair.OriginData = origin;
                    cityPair.DestinationData = destination;

                    if (cityPair.Origin.length == 3)
                        cityPair.Origin = cityPair.Origin.toUpperCase();

                    if (cityPair.Destination.length == 3)
                        cityPair.Destination = cityPair.Destination.toUpperCase();

                    var outboundDate = _settings.components.startDate.datepickermanager("val");
                    if (outboundDate)
                        cityPair.OutboundDate = outboundDate.toDateValues();

                    var inboundDate = _settings.components.endDate.datepickermanager("val");
                    if (inboundDate)
                        cityPair.InboundDate = inboundDate.toDateValues();

                    cityPair.NonStop = _settings.components.air.nonStop.is(":checked");
                    cityPair.CabinFilter = _settings.components.air.cabinType.val();

                    cityPair.CiaCodes = [];
                    if (_settings.components.air.ciaCode) {
                        var ciaCode;
                        var ciaCodeComponentValue = _settings.components.air.ciaCode.val();

                        if (ciaCodeComponentValue != "")
                            ciaCode = ciaCodeComponentValue;

                        if (ciaCode && ciaCode != "") {
                            if (ciaCode.indexOf(",") >= 0)
                                cityPair.CiaCodes = ciaCode.split(",");
                            else
                                cityPair.CiaCodes.push(ciaCode);
                        }
                    }

                    return [cityPair];
                },
                getCityPairsRequest: function (searchParameters) {
                    var cityPairs = [];

                    var localCiaCodeList = [];
                    var lineContainer = $(this);
                    for (var s = 0; s < searchParameters.Destinations.length; s++) {
                        var destinationTravel = searchParameters.Destinations[s];

                        var cityPair = {
                            CiaCodeList: destinationTravel.CiaCodes,
                            NonStop: destinationTravel.NonStop
                        };

                        var origin = Util.GetShortIATA(destinationTravel.Origin);
                        cityPair.Origin = origin == "" ? destinationTravel.Origin : origin;

                        var destination = Util.GetShortIATA(destinationTravel.Destination);
                        cityPair.Destination = destination == "" ? destinationTravel.Destination : destination;

                        if (destinationTravel.OutboundDate) {
                            cityPair.DepartureYear = destinationTravel.OutboundDate.Year;
                            cityPair.DepartureMonth = destinationTravel.OutboundDate.Month;
                            cityPair.DepartureDay = destinationTravel.OutboundDate.Day;
                        }

                        if (destinationTravel.CabinFilter != "") {
                            cityPair.CabinFilter = destinationTravel.CabinFilter;
                        }

                        cityPairs.push(cityPair);
                    }

                    if (searchParameters.IsRoundTrip) {

                        var cityPairRoundTrip = {
                            CiaCodeList: localCiaCodeList,
                            NonStop: searchParameters.NonStop
                        }

                        if (searchParameters.Destinations[0].Destination) {
                            var origin = Util.GetShortIATA(searchParameters.Destinations[0].Destination);
                            cityPairRoundTrip.Origin = origin == "" ? searchParameters.Destinations[0].Destination : origin;
                        }

                        if (searchParameters.Destinations[0].Origin) {
                            var destination = Util.GetShortIATA(searchParameters.Destinations[0].Origin);
                            cityPairRoundTrip.Destination = destination == "" ? searchParameters.Destinations[0].Origin : destination;
                        }

                        if (searchParameters.Destinations[0].InboundDate) {
                            cityPairRoundTrip.DepartureYear = searchParameters.Destinations[0].InboundDate.Year;
                            cityPairRoundTrip.DepartureMonth = searchParameters.Destinations[0].InboundDate.Month;
                            cityPairRoundTrip.DepartureDay = searchParameters.Destinations[0].InboundDate.Day;
                        }

                        cityPairRoundTrip.CiaCodeList = searchParameters.Destinations[0].CiaCodes;

                        cityPairs.push(cityPairRoundTrip);

                        var filledCabinFilter = cityPairs.first(function (h) { return h.CabinFilter; });

                        if (filledCabinFilter) {
                            cityPairs.forEach(function (x) {
                                x.CabinFilter = filledCabinFilter.CabinFilter;
                            });
                        }

                    }

                    return cityPairs;
                },
                getAirRequestData: function (searchParameters) {
                    if (searchParameters && searchParameters.Air) {
                        searchParameters.Air.RequestData = {};
                        searchParameters.Air.RequestData.CityPairsRequest = _functions.getDatas.getCityPairsRequest(searchParameters.Air);

                        if (isNaN(searchParameters.Air.Adults))
                            searchParameters.Air.RequestData.NumberADTs = 1;
                        else
                            searchParameters.Air.RequestData.NumberADTs = searchParameters.Air.Adults;

                        if (isNaN(searchParameters.Air.Children))
                            searchParameters.Air.RequestData.NumberCHDs = 0;
                        else
                            searchParameters.Air.RequestData.NumberCHDs = searchParameters.Air.Children;

                        if (isNaN(searchParameters.Air.Babies))
                            searchParameters.Air.RequestData.NumberINFs = 0;
                        else
                            searchParameters.Air.RequestData.NumberINFs = searchParameters.Air.Babies;

                        searchParameters.SearchType = _settings.searchType;
                        searchParameters.Air.SearchType = _settings.searchType;
                        searchParameters.Air.RequestData.SearchType = _settings.searchType;
                    }
                },
                getHotelRequestData: function (searchParameters) {
                    if (searchParameters && searchParameters.Hotel) {
                        searchParameters.Hotel.RequestData = {};
                        searchParameters.Hotel.RequestData.HotelName = searchParameters.Hotel.Name;
                        searchParameters.Hotel.RequestData.ChainCode = searchParameters.Hotel.ChainCode;
                        searchParameters.Hotel.RequestData.LocationId = searchParameters.Hotel.LocationId;
                        searchParameters.Hotel.RequestData.Location = searchParameters.Hotel.Location;
                        searchParameters.Hotel.RequestData.CheckIn = searchParameters.Hotel.CheckIn;
                        searchParameters.Hotel.RequestData.CheckOut = searchParameters.Hotel.CheckOut;
                        searchParameters.Hotel.RequestData.RoomsRequest = searchParameters.Hotel.RoomsRequest;
                        searchParameters.Hotel.RequestData.HotelId = searchParameters.Hotel.HotelId;
                        searchParameters.Hotel.RequestData.Source = searchParameters.Hotel.Source;

                        if (searchParameters.Hotel.AnotherDate != undefined)
                            searchParameters.Hotel.RequestData.AnotherDate = searchParameters.Hotel.AnotherDate;
                    }
                },
                getInsuranceRequestData: function (searchParameters) {
                    if (searchParameters && searchParameters.Insurance) {
                        searchParameters.Insurance.RequestData = {
                            AdditionalInformation: [],
                            EndDate: searchParameters.Insurance.EndDate,
                            Location: searchParameters.Insurance.Location,
                            PassengerAges: searchParameters.Insurance.PassengerAges,
                            StartDate: searchParameters.Insurance.StartDate,
                        };
                    }
                },
                hotel: function (searchParameters) {
                    if (_settings.products.hotel) {
                        searchParameters.Hotel = {};
                        searchParameters.Hotel.Name = _settings.components.hotel.name.val();
                        searchParameters.Hotel.ChainCode = _settings.components.hotel.chainCode.val();

                        var destination = _settings.components.destination.locationsFinder("getData");
                        searchParameters.Hotel.Location = _settings.components.destination.length ? _settings.components.destination.val() : '';

                        if (_settings.components.hotel.chooseOtherDestination.is(':checked')) {
                            destination = _settings.components.hotel.otherDestination.locationsFinder("getData");
                            searchParameters.Hotel.Location = _settings.components.hotel.otherDestination.length ? _settings.components.hotel.otherDestination.val() : '';
                        }

                        searchParameters.Hotel.LocationId = destination ? destination.id : 0;
                        searchParameters.Hotel.LocationData = destination;
                        if (searchParameters.Hotel.Location.length == 3)
                            searchParameters.Hotel.Location = searchParameters.Hotel.Location.toUpperCase();

                        if (_settings.components.hotel.chooseOtherDates.is(':checked')) {
                            if (_settings.components.hotel.otherCheckIn.length && _settings.components.hotel.otherCheckIn.val() != "")
                                searchParameters.Hotel.CheckIn = _settings.components.hotel.otherCheckIn.datepickermanager("val").toDateValues();

                            if (_settings.components.hotel.otherCheckOut.length && _settings.components.hotel.otherCheckOut.val() != "")
                                searchParameters.Hotel.CheckOut = _settings.components.hotel.otherCheckOut.datepickermanager("val").toDateValues();
                        }
                        else {
                            if (_settings.components.startDate.length && _settings.components.startDate.val() != "")
                                searchParameters.Hotel.CheckIn = _settings.components.startDate.datepickermanager("val").toDateValues();

                            if (_settings.components.endDate.length && _settings.components.endDate.val() != "")
                                searchParameters.Hotel.CheckOut = _settings.components.endDate.datepickermanager("val").toDateValues();
                        }

                        searchParameters.Hotel.RoomsRequest = _functions.getDatas.getRoomsRequest();
                    }
                },
                air: function (searchParameters) {
                    if (_settings.products.air) {
                        searchParameters.Air = {};
                        searchParameters.Air.Adults = 0;
                        searchParameters.Air.Children = 0;
                        searchParameters.Air.Babies = 0;
                        searchParameters.Air.MultiDestination = false;
                        searchParameters.Air.Destinations = _functions.getDatas.getAirDestinations();

                        _settings.components.passenger.container.filter(':not(.' + _settings.componentsOptions.hideClass + ')').each(function () {
                            var age = parseInt($(this).find(_settings.components.passenger.age).val());
                            if (age >= _settings.adultAirAge)
                                searchParameters.Air.Adults++;
                            else if (age >= _settings.childAirAge)
                                searchParameters.Air.Children++;
                            else
                                searchParameters.Air.Babies++;
                        });

                        if (_settings.components.air.cabinType)
                            searchParameters.Air.CabinType = _settings.components.air.cabinType.val();

                        searchParameters.Air.IsRoundTrip = _settings.components.air.roundTrip.is(":checked");
                        searchParameters.Air.IsOneWay = _settings.components.air.oneWay.is(":checked");

                        if (_settings.components.air.nonStop && _settings.components.air.nonStop.length)
                            searchParameters.Air.NonStop = _settings.components.air.nonStop.is(':checked');
                    }
                },
                service: function (searchParameters) {
                    if (_settings.products.service) {
                        if (_settings.simpleService) {
                            var selectedService = _settings.components.service.serviceName.servicesAutocomplete('getData');
                            if (selectedService) {
                                searchParameters.Service = {
                                    ServiceId: selectedService.Id
                                };
                            }
                        }
                        else {
                            searchParameters.AdditionalInfo = {
                                ServiceDestination: _functions.getDestinationLocation()
                            };

                            searchParameters.Service = {
                                StartDate: _settings.components.startDate.datepickermanager("val").toDateValues(),
                                EndDate: _settings.components.endDate.datepickermanager("val").toDateValues(),
                                LocationId: _functions.getDestinationLocation("id"),
                                Customers: [
                                    { Key: 0, Value: [] }
                                ]
                            };

                            _settings.components.passenger.container.filter(':not(.' + _settings.componentsOptions.hideClass + ')').each(function () {
                                searchParameters.Service.Customers[0].Value.push($(this).find(_settings.components.passenger.age).val());
                            });

                            var category = _settings.components.service.category.val();
                            if (category && category != "" && category > 0)
                                searchParameters.Service.CategoryId = category;

                            if (_settings.components.service.serviceName && _settings.components.service.serviceName.length) {
                                var selectedService = _settings.components.service.serviceName.servicesAutocomplete('getData');
                                if (selectedService)
                                    searchParameters.Service.ServiceId = selectedService.Id;
                            }
                        }
                    }
                },
                insurance: function (searchParameters) {
                    if (!searchParameters)
                        searchParameters = {};

                    if (_settings.products.insurance) {
                        var passengerAges = [];

                        _settings.components.passenger.container.filter(':not(.' + _settings.componentsOptions.hideClass + ')').each(function () {
                            passengerAges.push(parseInt($(this).find(_settings.components.passenger.age).val()));
                        });

                        searchParameters.Insurance = {
                            EndDate: _settings.components.endDate.datepickermanager("getDate").toDateValues(),
                            Location: _functions.getDestinationLocation(),
                            PassengerAges: passengerAges,
                            StartDate: _settings.components.startDate.datepickermanager("getDate").toDateValues(),
                        };
                    }
                },
            },
            posRender: function () {
                _functions.initializeDatePickers();
                _functions.initializeLocationsFinder();
                _functions.getCategories();
                _functions.setDefaultDate(_settings.defaultStartDate, _settings.components.startDate);
                _functions.startDateRules();
                _functions.setDefaultDate(_settings.defaultEndDate, _settings.components.endDate);
                _functions.setDefaultDate(_settings.defaultStartDate, _settings.components.hotel.otherCheckIn);
                _functions.setDefaultDate(_settings.defaultEndDate, _settings.components.hotel.otherCheckOut);
                _functions.setInitialProducts();
                _functions.initializeServicesAutoComplete();
                _functions.removeInvalidPassengersQuantity();
            },
            components: {
                select: function () {
                    Util.SelectComponents(_settings.components, _component, true);
                },
                setEvents: function (action) {
                    $(_component)[action]('click', _settings.components.air.toggle.selector, _events.components.toggleAirComponents);
                    $(_component)[action]('click', _settings.components.hotel.toggle.selector, _events.components.toggleHotelComponents);
                    $(_component)[action]('click', _settings.components.service.toggle.selector, _events.components.toggleServiceComponents);
                    $(_component)[action]('click', _settings.components.insurance.toggle.selector, _events.components.toggleInsuranceComponents);
                    $(_component)[action]('change', _settings.components.passenger.quantity.selector, _events.components.changePassengerQuantity);

                    $(_component)[action]('click', _settings.components.hotel.chooseOtherDestination.selector, _events.components.showHotelOtherDestination);
                    $(_component)[action]('click', _settings.components.hotel.chooseOtherDates.selector, _events.components.showHotelOtherDates);

                    if (!Global || !Global.Mobile) {
                        $(_component)[action]('keyup', _settings.components.startDate.selector, Util.ForceMaskDate);
                        $(_component)[action]('keyup', _settings.components.endDate.selector, Util.ForceMaskDate);
                    }

                    var datePickerEvent = Global && Global.Mobile ? 'blur' : 'change';

                    $(_component)[action](datePickerEvent, _settings.components.startDate.selector, _functions.startDateRules);
                    $(_component)[action](datePickerEvent, _settings.components.endDate.selector, _functions.endDateRules);

                },
                attachEvents: function () {
                    _functions.components.setEvents('on');
                },
                dettachEvents: function () {
                    _functions.components.setEvents('off');
                }
            },
            controllers: {
                setEvents: function (action) {
                    if (_settings.controllers.searchController)
                        _settings.controllers.searchController.getServiceCategoriesCompleted[action](_events.controllers.onGetCategoriesCompleted);
                },
                attachEvents: function () {
                    _functions.controllers.setEvents('attach');
                },
                dettachEvents: function () {
                    _functions.controllers.setEvents('dettach');
                }
            }
        };
    };


    $.fn.dynamicPackageSearchEngine = function () {
        return Util.pluginDefaultBehavior(this, "dynamicPackageSearchEngine", arguments, function () { return new DynamicPackageSearchEngine() });
    }
})(jQuery);


/// <reference path="WebCommon/Scripts/Libraries/Util.js" />
/// <reference path="WebCommon/Scripts/Libraries/DatePickerOption.js" />
/// <reference path="WebCommon/Scripts/Libraries/Libraries/Jquery.js" />

(function ($) {

    function TourSearchEngine() {

        var component = undefined;

        var _this = this;

        var settings = {
            templates: {
                toolbar: undefined,
                tourRoom: undefined,
                passengersAges: undefined
            },
            searchType: EnumHelper.SearchType.Tour,
            controllers: {
                messagesController: undefined,
                locationsController: undefined,
                searchController: undefined
            },
            components: {
                destination: ".txtTourDestination",
                hotelRoomContainer: ".roomContainer",
                childAgesContainer: ".child_years_old",
                childsByRoomSelector: "#drpChildrenQtdRoom",
                childAgeSelector: "#drpChildAge",
                adultsSelector: "#drpAdultsQtdRoom",
                totalPassengers: ".cboTourPassengers",
                passengersAgesContainer: ".passengersAges",
                addRoom: ".addRoom",
                removeRoom: ".removeRoom",
                roomList: ".tourRoomList",
                passengerAge: ".cboPassengerAge",
                lblRoomNumber: ".roomNumber",
                clearEngine: ".clearSearchParams",
                dates: {
                    outboundDate: ".tourOutboundDate",
                    inboundDate: ".tourInboundDate"
                },
                tourName: '',
                switchSearchParam: ".switchSearchParam",
                tourSource: '.tourSource'
            },
            componentsOptions: {
                hasDatepicker: "hasDatepicker"
            },
            useScrollOnPesqInc: true,
            applyStatusClassesOnPesqInc: true,
            applyFixedClassOnPesqInc: false,
            minDaysToSearch: 0,
            maxDaysToSearch: 360,
            maxRoomsRequest: 3,
            defaultDestinationId: 0,
            exhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Dialog,
            enableSearchByName: true,
            maxPassengers: 9,
            maxPassengerQtd: undefined,
            typeOfSearch: 'destination',
            tourSources : []
        };

        var _gtagEventCategory = "Motor de circuito";
        var _rootSystemAccountInfo = Util.GetRootSystemAccountInfo();

        //#region :: Public

        this.initialize = function (target, opts) {

            component = $(target);

            $.extend(true, settings, opts || {});

            _functions.validTemplates();
            _functions.components.selectComponents();
            _functions.components.attachEvents();
            _functions.attachControllerEvents();
            _functions.setSources();
        };

        this.render = function () {

            component.html(settings.templates.toolbar({
                maxRooms: settings.maxRoomsRequest,
                enableSearchByName: settings.enableSearchByName,
                maxPassengers: settings.maxPassengers,
                tourSources: settings.tourSources
            }));

            _functions.components.selectComponents();

            _functions.afterRender();
        };

        this.getData = function () {
            var data = {
                AdditionalInfo: {},
                Service: {
                    StartDate: settings.components.dates.outboundDate.datepickermanager("val").toDateValues(),
                    EndDate: settings.components.dates.inboundDate.datepickermanager("val").toDateValues(),
                    Customers: _functions.getRoomsPassengersAges(),
                    ServiceType: 1
                }
            };

            if (_functions.hasSelectedDestination() && settings.typeOfSearch == 'destination') {
                data.AdditionalInfo.ServiceDestination = _functions.getDestinationLocation();
                data.Service.LocationId = _functions.getDestinationLocation("id");
            }

            if (_functions.hasSelectedTour() && settings.typeOfSearch == 'name') {
                var selectedService = _functions.getSelectedTour();
                if (typeof selectedService !== "undefined" && selectedService.hasOwnProperty("Id"))
                    data.Service.ServiceIds = [selectedService.Id];
            }

            if (_functions.hasSelectedSourceType()){
                var selectedSourceType = _functions.getSelectedSourceType();
                data.Service.Source = selectedSourceType;
            }

            if (Util.IsAbleToSendGtagEvents(_rootSystemAccountInfo))
                _sendGtagEvents(data);

            return data;
        };

        this.validate = function () {

            var errors = [];

            if (!_functions.hasSelectedDestination() && !_functions.hasSelectedTour())
                errors.push("OnSearch_InvalidDestination");

            if (settings.components.dates.outboundDate.val() == "" || !settings.components.dates.outboundDate.datepickermanager("val").isDate())
                errors.push("OnSearchService_NoInitialDate");

            if (settings.components.dates.inboundDate.val() == "" || !settings.components.dates.inboundDate.datepickermanager("val").isDate())
                errors.push("OnSearchService_NoFinalDate");

            if (errors.length && settings.controllers.messagesController)
                settings.controllers.messagesController.notifyMessages(errors, settings.exhibitionType);

            return errors.length == 0;
        };

        this.readQueryString = function (queryString) {

            var searchParameters = {};
            searchParameters.Service = {};

            searchParameters.Service.Customers = [];
            var keysString = Util.QueryString("PassengerRooms", queryString);
            var agesString = Util.QueryString("Ages", queryString);
            if (keysString && agesString) {
                var keys = keysString.split(',');
                var ages = agesString.split(',');
                keys.forEach(function (key, index) {
                    var age = ages[index];
                    if (searchParameters.Service.Customers[key])
                        searchParameters.Service.Customers[key].Value.push(age);
                    else
                        searchParameters.Service.Customers.add({ Key: key, Value: [age] });
                });
            }

            var startDate = Util.QueryString("StartDate", queryString);
            if (startDate)
                searchParameters.Service.StartDate = startDate.toDateValues('pt');

            var endDate = Util.QueryString("EndDate", queryString);
            if (endDate)
                searchParameters.Service.EndDate = endDate.toDateValues('pt');


            searchParameters.Service.LocationId = Util.QueryString("LocationId", queryString);

            if (Global.LocationsCache && Global.LocationsCache.length > 0) {
                var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(searchParameters.Service.LocationId) });

                if (auxLocationData.length > 0)
                    searchParameters.AdditionalInfo = {
                        ServiceDestination: auxLocationData[0]
                    };
            }

            var serviceId = Util.QueryString("ServiceId", queryString);
            if (serviceId && serviceId.length)
                searchParameters.Service.ServiceId = serviceId;

            searchParameters.Service.ServiceType = EnumHelper.Services.ServiceType.Tour;

            return searchParameters;
        }

        this.getQueryString = function (pageUrl) {
            var data = _this.getData();

            pageUrl = pageUrl + "?SearchType=Tour";

            var querystring = "";

            querystring += "&LocationId=" + data.Service.LocationId;
            querystring += "&PassengerRooms=" + _functions.queryString.getPassengerRooms(data.Service.Customers);
            querystring += "&Ages=" + _functions.queryString.getPassengerAges(data.Service.Customers);
            querystring += "&StartDate=" + _functions.queryString.getDatePattern(data.Service.StartDate);
            querystring += "&EndDate=" + _functions.queryString.getDatePattern(data.Service.EndDate);

            return pageUrl + querystring;
        };

        this.fillValues = function (data) {
            _this.clear();
            if (data && !$.isEmptyObject(data)) {
                if (data.Service.LocationId)
                    settings.components.destination.locationsFinder("setDataById", data.Service.LocationId);

                if (data.Service.StartDate && data.Service.StartDate.isValid) {
                    settings.components.dates.outboundDate.datepickermanager("setDate", formatter.dateValuesToDate(data.Service.StartDate))
                    settings.components.dates.outboundDate.datepickermanager("val", formatter.dateValuesShort(data.Service.StartDate));
                }

                if (data.Service.EndDate && data.Service.EndDate.isValid) {
                    settings.components.dates.inboundDate.datepickermanager("setDate", formatter.dateValuesToDate(data.Service.EndDate))
                    settings.components.dates.inboundDate.datepickermanager("val", formatter.dateValuesShort(data.Service.EndDate));
                }

                if (data.Service.Customers) {
                    for (var i = 1; i < data.Service.Customers.length; i++)
                        _functions.addRoom();

                    $(settings.components.totalPassengers.selector, component).each(function (index) {
                        $(this).val(data.Service.Customers[index].Value.length);
                        _functions.changePassengerQuantity(index, data.Service.Customers[index].Value.length);
                    });

                    var ages = [];
                    data.Service.Customers.forEach(function (c) {
                        c.Value.forEach(function (a) { ages.push(a) });
                    });

                    $(settings.components.passengerAge.selector, component).each(function (index) {
                        $(this).val(ages[index]);
                    });
                }
            }
        };

        this.updateOptions = function () { };

        this.updateValues = function () { };

        this.setOptions = function () { };

        this.clear = function () {

            var totalRooms = _functions.getTotalRooms();

            settings.components.destination.val("");

            settings.components.dates.outboundDate.children().eq(0).prop("selected", true);
            settings.components.dates.inboundDate.children().eq(0).prop("selected", true);

            //Remove os quartos extras
            $(settings.components.hotelRoomContainer.selector, component).each(function () {
                var $this = $(this);
                if ($this.index() > 0)
                    $this.remove();
            });

            //Define como 1 a qtde de pax do quarto 1
            $(settings.components.totalPassengers.selector, component).eq(0).children().eq(0).prop("selected", true);
            $(settings.components.totalPassengers.selector, component).eq(0).change();

            _functions.managerAddButtons();

        };

        //#endregion

        //#region :: Events

        var _events = {
            components: {
                onChangePassengerQuantity: function () {
                    var $this = $(this);

                    _functions.changePassengerQuantity(settings.components.totalPassengers.index(this), $this.val());
                },
                addRoom: function (event) {
                    event.preventDefault();
                    _functions.addRoom();
                },
                removeRoom: function (event) {
                    event.preventDefault();
                    _functions.removeRoom(settings.components.removeRoom.index(this));
                }
            }
        };

        //#endregion

        //#region :: Functions

        var _functions = {
            components: {
                setEvents: function (action) {
                    settings.components.addRoom[action]("click", _events.components.addRoom);
                    settings.components.removeRoom[action]("click", _events.components.removeRoom);
                    settings.components.totalPassengers[action]("change", _events.components.onChangePassengerQuantity);
                    settings.components.clearEngine[action]("click", _this.clear);
                    settings.components.switchSearchParam[action]("click", _functions.switchSearchParam);
                },
                attachEvents: function () {
                    _functions.components.setEvents('live');
                },
                dettachEvents: function () {
                    _functions.components.setEvents('die');
                },
                selectComponents: function () {
                    Util.SelectComponents(settings.components, component, true);
                }
            },
            afterRender: function () {
                _functions.initializeLocationsFinder();
                _functions.initializeLocations();
                _functions.datePickers.initialize();
                _functions.initializeToursAutoComplete();
                _functions.initializeDateMask();
            },
            initializeDateMask: function () {                
                settings.components.dates.outboundDate.addClass("full-year-date-mask");
                settings.components.dates.inboundDate.addClass("full-year-date-mask");

                if (Global && Global.RefreshMasks)
                    Global.RefreshMasks();                
            },
            initializeLocationsFinder: function () {
                var pesqIncConfig = {
                    SearchType: Global.SearchTypes.Full,
                    maxResultsClient: 15,
                    maxResultsServer: 30,
                    idealNumberOfProximities: 6,
                    idealNumberOfProximitiesRoots: 3,
                    useCacheEnhancer: true,
                    onlyHalfClientResults: true,
                    useClientCache: false,
                    onDropBoxSelect: function () { },
                    clientCache: Global.LocationsCache,
                    useScroll: settings.useScrollOnPesqInc,
                    applyStatusClasses: settings.applyStatusClassesOnPesqInc,
                    applyFixedClass: settings.applyFixedClassOnPesqInc,
                    LocationsType: [1, 2, 3, 4],
                    controllers: {
                        locationsController: settings.controllers.locationsController
                    }
                };

                settings.components.destination.locationsFinder(pesqIncConfig).click(function () { $(this).select(); });
            },
            initializeLocations: function () {
                if (settings.defaultDestinationId > 0) {
                    var auxLocationData = Global.LocationsCache.where(function (loc) { return loc.id == $.trim(settings.defaultDestinationId) });
                    if (auxLocationData.length > 0)
                        settings.components.destination.locationsFinder('setData', auxLocationData[0]);
                }
            },
            initializeToursAutoComplete: function () {
                if (typeof settings.components.tourName !== "object" || settings.components.tourName.length == 0)
                    return;

                settings.components.tourName.servicesAutocomplete({
                    controllers: { searchController: new SearchController({ Global: _this }) },
                    serviceType: EnumHelper.Services.ServiceType.Tour
                });
            },
            datePickers: {
                initialize: function () {
                    var currentDate = Util.CreateAbsoluteDate();
                    var datePickerSettings = {
                        numberOfMonths: (Global.Mobile) ? 1 : 2,
                        minDate: currentDate.addDays(parseInt(settings.minDaysToSearch, 10)),
                        maxDate: currentDate.addDays(parseInt(settings.maxDaysToSearch, 10)),
                        onSelect: _functions.datePickers.onSelectOutboundDate
                    };

                    _functions.datePickers.initializeDatePicker(settings.components.dates.outboundDate, datePickerSettings);

                    datePickerSettings = {
                        numberOfMonths: (Global.Mobile) ? 1 : 2,
                        minDate: currentDate.addDays(parseInt(settings.minDaysToSearch, 10)),
                        maxDate: currentDate.addDays(parseInt(settings.maxDaysToSearch, 10)),
                    };

                    _functions.datePickers.initializeDatePicker(settings.components.dates.inboundDate, datePickerSettings);
                    _functions.datePickers.setDefaultDate(settings.defaultInitialDate, settings.components.dates.outboundDate);
                    _functions.datePickers.setDefaultDate(settings.defaultFinalDate, settings.components.dates.inboundDate);
                },
                initializeDatePicker: function ($component, datePickerSettings) {
                    $component
                        .removeClass(settings.componentsOptions.hasDatepicker)
                        .datepickermanager("destroy")
                        .datepickermanager(DatePickerOption(datePickerSettings));
                },
                onSelectOutboundDate: function (dateText, inst) {
                    settings.components.dates.inboundDate.datepicker("option", "minDate", dateText.toDateTime());
                    settings.components.dates.inboundDate.datepicker("option", "maxDate", dateText.toDateTime().addDays(parseInt(settings.maxDaysToSearch, 10)));
                },
                setDefaultDate: function (defaultDate, $component) {
                    if (defaultDate) {
                        var date = defaultDate.toDateValues();

                        if (date.isValid) {
                            $component
                                .datepickermanager("setDate", formatter.dateValuesToDate(date))
                                .datepickermanager("val", formatter.dateValuesShort(date));
                        }
                    }
                }
            },
            changePassengerQuantity: function (roomIndex, passengersQuantity) {
                var $passengersAgesContainer = settings.components.passengersAgesContainer.eq(roomIndex);
                if (!settings.templates)
                    settings.templates = {};

                if (!settings.templates.passengersAges)
                    settings.templates.passengersAges = ServiceTemplates.PassengersAges;

                $passengersAgesContainer.html(settings.templates.passengersAges({ amount: passengersQuantity, hiddenlabel: true }));
                _functions.components.selectComponents();
            },
            getTotalRooms: function () {
                _functions.components.selectComponents();
                return settings.components.hotelRoomContainer.length;
            },
            addRoom: function () {
                var totalRooms = _functions.getTotalRooms();
                var $room = settings.templates.tourRoom({
                    roomNumber: (totalRooms + 1),
                    maxRooms: settings.maxRoomsRequest,
                    maxPassengers: settings.maxPassengers
                });

                settings.components.roomList.append($room);

                _functions.managerAddButtons();
            },
            removeRoom: function (roomIndex) {
                settings.components.hotelRoomContainer.eq(roomIndex).remove();

                _functions.managerAddButtons();

                _functions.setRoomNumberLabel();
            },
            managerAddButtons: function () {
                _functions.getTotalRooms() < settings.maxRoomsRequest
                    ? $(settings.components.addRoom.selector, component).addClass("hide").eq(-1).removeClass("hide")
                    : $(settings.components.addRoom.selector, component).addClass("hide");
            },
            setPassengerAge: function (age, passengerIndex, roomIndex) {
                settings.components.hotelRoomContainer
                    .eq(roomIndex)
                    .find(settings.components.passengerAge)
                    .eq(passengerIndex)
                    .val(age);
            },
            setRoomNumberLabel: function () {
                $(settings.components.hotelRoomContainer.selector, component).each(function () {
                    var $this = $(this);
                    var $lblRoomNumber = $this.find(settings.components.lblRoomNumber.selector, component);

                    var label = Util.StringFormat("{0} {1}",
                        Util.CallResources("HotelRoom"),
                        ($this.index() + 1));

                    $lblRoomNumber.html(label);
                });
            },
            setSources: function () {
                if (typeof(Ide) != 'undefined' && Ide.companyContext && Ide.companyContext.ConnectionContextSummary && Ide.companyContext.ConnectionContextSummary.SummarySource) {
                    settings.tourSources = [];
                    for (var i = 0; i < Ide.companyContext.ConnectionContextSummary.SummarySource.length; i++) {
                        var summary = Ide.companyContext.ConnectionContextSummary.SummarySource[i];
                        if (summary.ProductTypes.any("Tour"))
                            settings.tourSources.push({ Code: Util.Sources[summary.Source], Name: summary.Source })
                    }
                }
            },
            validTemplates: function () {
                if (!settings.templates)
                    settings.templates = {};

                if (!settings.templates.passengersAges)
                    settings.templates.passengersAges = ServiceTemplates.PassengersAges;

                if (!settings.templates.tourRoom)
                    settings.templates.tourRoom = TourSearchEngineTemplates.tourRoom;
            },
            hasSelectedDestination: function () {
                return typeof _functions.getDestinationLocation() !== "undefined";
            },
            hasSelectedTour: function () {
                if (typeof settings.components.tourName !== "undefined" &&
                    settings.components.tourName.length > 0 &&
                    settings.components.tourName.val() !== "" &&
                    settings.components.tourName.containsPlugin("servicesAutocomplete")) {

                    return typeof _functions.getSelectedTour() !== "undefined";
                }

                return false;
            },
            hasSelectedSourceType : function () {
                if (settings.tourSources.length)
                    return _functions.getSelectedSourceType() != "";
                return false;
            },
            getDestinationLocation: function (property) {
                var data = settings.components.destination.locationsFinder("getData");
                if (property && data[property])
                    return data[property];

                return data;
            },
            getSelectedTour: function () {
                return settings.components.tourName.servicesAutocomplete("getData");
            },
            getSelectedSourceType: function () {
                return settings.components.tourSource.val();
            },
            getRoomsPassengersAges: function () {
                var customers = [];
                settings.components.hotelRoomContainer.each(function () {
                    var ages = [];
                    $(this).find(settings.components.passengerAge).each(function () { ages.push($(this).val()); });
                    customers.push({ Key: $(this).index(), Value: ages });
                });

                return customers;
            },
            queryString: {
                getPassengerRooms: function (customers) {
                    var rooms = [];
                    customers.forEach(function (c) {
                        c.Value.forEach(function (a) { rooms.push(c.Key) });
                    });
                    return rooms.join(",");
                },
                getPassengerAges: function (customers) {
                    var ages = [];
                    customers.forEach(function (c) {
                        c.Value.forEach(function (a) { ages.push(a) });
                    });
                    return ages.join(",");
                },
                getDatePattern: function (date) {
                    return date.Day + '/' + date.Month + '/' + date.Year;
                }
            },
            switchSearchParam: function () {
                var operations = {
                    hide: function (field) { field.parent().addClass("hide").hide(); },
                    show: function (field) { field.parent().removeClass("hide").show(); }
                };

                settings.typeOfSearch = $(this).val();
                switch (settings.typeOfSearch) {
                    case "destination":
                        operations.hide(settings.components.tourName);
                        operations.show(settings.components.destination);
                        settings.components.tourName.servicesAutocomplete("clearSelected");
                        break;
                    case "name":
                        operations.hide(settings.components.destination);
                        operations.show(settings.components.tourName);
                        settings.components.destination.locationsFinder("clearSelected");
                        break;
                }
            },
            attachControllerEvents : function()
            {
                if (Global.CompanyContextController && Global.CompanyContextController.changeCompanyContextCompleted)
                    Global.CompanyContextController.changeCompanyContextCompleted.attach(_functions.changeCompanyContextCompleted);
            },
            changeCompanyContextCompleted : function()
            {
                _functions.setSources();
                _this.render();
            }
            
        };

        function _sendGtagEvents(searchParameters) {
            var tourSearchParameters = searchParameters.Service;
            
            _sendGtagSelectRoomsEvent(tourSearchParameters);
            _sendGtagSearchEvent(tourSearchParameters);
        }

        function _sendGtagSelectRoomsEvent(tourSearchParameters, useCustomLabel) {
            if (tourSearchParameters.Customers && tourSearchParameters.Customers.length) {
                var gtagEventLabel;

                if (useCustomLabel) {                    
                    var roomsLength = tourSearchParameters.Customers.length;
                    var customersLengthStr = tourSearchParameters.Customers.reduce(function (acc, cur, index) {
                        var lengthPerRoom = cur.Value.length || "";
    
                        return Util.ConcatenateStringSeparatedBy("/", acc, lengthPerRoom, index);
                    }, "");
                    
                    gtagEventLabel = roomsLength + ': ' + customersLengthStr + ' - ' + _rootSystemAccountInfo;
                }

                Util.SendGtagEvent('select_rooms', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagSearchEvent(tourSearchParameters, useCustomLabel) {
            var locationId = tourSearchParameters.LocationId;
            
            if (locationId) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = locationId + ' - ' + _rootSystemAccountInfo;

                Util.SendGtagEvent('search', _gtagEventCategory, gtagEventLabel);
            }
        }

        //#endregion
    };

    $.fn.tourSearchEngine = function () {
        return Util.pluginDefaultBehavior(this, "tourSearchEngine", arguments, function () { return new TourSearchEngine() });
    }

})(jQuery);

ï»¿(function ($) {

    function CruiseSearchEngine() {
        var _this = this;
        var component = undefined;
        var _cruiseContent = undefined;
        var _filteredCruiseContent = undefined;
        var _gtagEventCategory = "Motor de cruzeiro";
        var _rootSystemAccountInfo = Util.GetRootSystemAccountInfo();
        var settings = {
            data: {},
            exhibitionType: Util.isTravelGo() ? EnumHelper.MessagesExhibitor.ExhibitionType.Dialog : EnumHelper.MessagesExhibitor.ExhibitionType.Inline,
            template: undefined,
            templateOptions: {},
            useScrollOnPesqInc: false,
            applyStatusClassesOnPesqInc: true,
            applyFixedClassOnPesqInc: false,
            useBrowserGeoLocation: true,
            calcCheckoutMaxDateFromToday: false,
            anotheDatePickersOption: {
                minDate: 0
            },
            controllers: {
                messagesController: undefined,
                locationsController: undefined
            },
            events: {
                afterInitialize: undefined
            },
            components: {
                cruise: {
                    ship: '.ship',
                    cruiseLine: '.cruise_line',
                    embarkStart: '.txtEmbarkStart',
                    embarkStartCalendar: '.txtEmbarkStartCalendar',
                    embarkEnd: '.txtEmbarkEnd',
                    origin: '.origin',
                    destination: '.destination',
                    adultsQuantity: '#adultsQnt',
                    childsQuantity: '.childsQnt',
                    childsAgeQuantity: '.childsAgeQuantity',
                    childAge: '.childAge',
                    childAgeLabel: '.childAgeLabel',
                    senior: '.chkSenior',
                    accessibility: '.chkAccessibility'
                },
                fidelityCodes: {
                    container: '.fidelityCodes',
                    remove: '.removeFidelityCode',
                    template: '.fidelityTemplate.txtFidelityCodes',
                    inputText: '.txtFidelityCodes'
                },
                guests: {
                    guestsContainer: '.guests_label',
                    guestsField: '.txtGuests',
                    guestsDataPanel: '.guestsData'
                },
                clearFilters: '.clearFilters',
                searchCall: '.doResearch',
                advancedSearch: '.cruise_advanced_check',
                advancedSearchContent: '.advanced .content',
                clearSelectedDates: '.date_label .clearSelectedOptions'
            },
            selectedRange: {
                startDate: null,
                endDate: null
            },
            componentsOptions: {
                hasDatepicker: 'hasDatepicker',
                updateValueCompleteClass: 'autocomplete_completed'
            },
            loadProximities: false,
            currentChildQuantity: 1,
            minDaysToSearch: 0,
            maxDaysToSearch: 730 //default 2 anos
        };

        this.initialize = function (target, opts) {
            component = $(target);

            $.extend(true, settings, opts || {});

            if (Util.isTravelGo()) {
                if (!Global.Cruise)
                    Global.Cruise = {};
                Global.Cruise.DefaultCompany = Global.ShortCodeParameters.cruise_cruiseline;
            }

            window.location.hash = window.location.hash.replace('selectOpened', '');
        };

        this.render = function () {
            _selectComponents();

            component.html(settings.template(settings));

            if (settings.events.posRender)
                settings.events.posRender(settings);

            _selectComponents();
            _setEvents();

            _initCruise();

            _addEmptyFidelityCodeBox();
            _changePaxLimits();

            //Workaround para impedir a exibiÃ§Ã£o do teclado quando estiver acessando via celular/tabled
            if (Util.UserResolution() !== EnumHelper.UserResolution.Desktop)
                $(".txtEmbarkStart ").on('focus', function (event) { $(this).blur(); });

            //if (!Global.isHome) {
            //    _fillValues(_readQueryString(window.location.queryString));
            //}
        };

        function _renderGuestsSelection() {
            var pluginSettings = new CruisePassengersQuantity.Settings();

            pluginSettings.events.onQuantityChange = _changeChildsAgeFields;
            pluginSettings.data.showChildAgesSelection = false;

            var queryStringParams = _readQueryString(window.location.queryString);
            pluginSettings.data.defaultAdults = queryStringParams.Cruise.NumberOfAdults;
            pluginSettings.data.defaultChildAges = queryStringParams.Cruise.ChildAges;

            settings.components.guests.guestsDataPanel.cruisePassengersQuantity(pluginSettings);
        }

        function verifyAvailableStartEmbark(date) {
            var endDate = settings.components.cruise.embarkEnd.datepickermanager("getDate");
            if ((!endDate || date <= endDate) && _filteredCruiseContent.EmbarkDates.any(function (r) { return r.getTime() === date.getTime(); })) {
                return [true, "", "Available"];
            } else {
                return [false, "", "unAvailable"];
            }
        }

        function verifyAvailableEndEmbark(date) {
            var startDate = settings.components.cruise.embarkStart.datepickermanager("getDate");
            if ((!startDate || date >= startDate) && _filteredCruiseContent.EmbarkDates.any(function (r) { return r.getTime() === date.getTime(); })) {
                return [true, "", "Available"];
            } else {
                return [false, "", "unAvailable"];
            }
        }

        function _initCruise() {

            if (!Util.isTravelGo()) {
                settings.components.cruise.embarkStart.datepickermanager(DatePickerOption({
                    numberOfMonths: Global.Mobile ? 1 : 2,
                    beforeShowDay: verifyAvailableStartEmbark,
                    minDate: new Date().addDays(settings.minDaysToSearch),
                    maxDate: new Date().addDays(settings.maxDaysToSearch)
                }));

                settings.components.cruise.embarkEnd.datepickermanager(DatePickerOption({
                    numberOfMonths: Global.Mobile ? 1 : 2,
                    beforeShowDay: verifyAvailableEndEmbark,
                    minDate: new Date().addDays(settings.minDaysToSearch),
                    maxDate: new Date().addDays(settings.maxDaysToSearch)
                }));
            }

            _initOptionList(settings.components.cruise.origin);
            _initOptionList(settings.components.cruise.destination);
            _initOptionList(settings.components.cruise.cruiseLine);
            _initOptionList(settings.components.cruise.ship);

            //_changeChildsAgeFields();

            if (Util.isTravelGo()) {
                _renderGuestsSelection();
                settings.components.guests.guestsField.val('');
            }

            _cruiseContent = Global.CruiseContent;

            _loadContents();
        }

        function _addEmptyFidelityCodeBox() {
            var template = _cloneFidelityCodeTemplate();
            settings.components.fidelityCodes.container.append(template);
            _selectComponents();
            settings.components.fidelityCodes.remove.last().hide();

            _enableOrDisableFidelityInputs(_filteredCruiseContent);
        }

        function _addEmptyFidelityCodeBoxIfNecessary() {
            _selectComponents();

            var inputs = $(":input", settings.components.fidelityCodes.inputText);
            var inputsLength = inputs.length - 1;
            var filledInputsLength = inputs.get().where(function (i) { return i.value !== ''; }).length;

            if (inputsLength === 1)
                settings.components.fidelityCodes.remove.hide();

            //if (inputs.eq(inputsLength).val() !== "" || inputsLength === 1) {
            if (inputsLength < settings.components.cruise.adultsQuantity.val() && filledInputsLength > 0) {
                if (inputsLength === 1)
                    settings.components.fidelityCodes.remove.hide();

                settings.components.fidelityCodes.remove.show();
                _addEmptyFidelityCodeBox();
            }
        }

        function _onTxtFidelityCodesKeyUp(event) {
            if (event && event.keyCode === 13 && $(event.target).val() !== "") {
                $(":input", settings.components.fidelityCodes.inputText.last()).focus();
            }
            else {
                _addEmptyFidelityCodeBoxIfNecessary();
            }
        }

        function _removeFidelityCode(event) {
            _selectComponents();

            if (settings.components.fidelityCodes.inputText.not('.fidelityTemplate').length !== 1)
                $(event.target).closest('.txtFidelityCodes').remove();
        }

        function _cloneFidelityCodeTemplate() {
            return settings.components.fidelityCodes.template
                .clone()
                .removeClass('hide')
                .removeClass('fidelityTemplate');
        }

        function _adaptCruiseContent() {
            if (typeof _cruiseContent.Combinations[0] === "string") {
                for (var i = 0; i < _cruiseContent.Combinations.length; i++) {
                    var splited = _cruiseContent.Combinations[i].split(",");

                    _cruiseContent.Combinations[i] = {
                        PortIndex: splited[0],
                        DestinationIndex: splited[1],
                        ShipIndex: splited[2],
                        CruiseLineIndex: splited[3],
                        EmbarkIndexes: splited[4].split("|")
                    };
                }

                for (var j = 0; j < _cruiseContent.EmbarkDates.length; j++)
                    _cruiseContent.EmbarkDates[j] = Util.DateValuesToDate(_cruiseContent.EmbarkDates[j]);
            }
        }

        function _adjustCruiseLinesSelected(element) {
            if (element.parentElement && element.parentElement.parentElement.parentElement.className.includes('cruise_line')) {
                var ulElement = document.getElementsByClassName('cruise_line');

                for (var i = 0; i < ulElement.length; i++) {
                    var input = ulElement[i].getElementsByTagName('input');
                    for (var j = 0; j < input.length; j++) {
                        input[j].checked = false;
                    }
                }

                element.checked = true;
            }
        }

        function _getFilteredCruiseContent(data, element = null) {
            var cruiseValidations = [];
            var embarkValidations = [];

            if (data.CruiseLineCode && data.CruiseLineCode.includes('|')) {
                var cruiseLineCodeArray = data.CruiseLineCode.split('|');
                cruiseValidations.push(function (c) { return _cruiseContent.CruiseLines[c.CruiseLineIndex] && cruiseLineCodeArray.includes(_cruiseContent.CruiseLines[c.CruiseLineIndex].Code); });
            } else if (data.CruiseLineCode) {
                cruiseValidations.push(function (c) { return _cruiseContent.CruiseLines[c.CruiseLineIndex] && _cruiseContent.CruiseLines[c.CruiseLineIndex].Code === data.CruiseLineCode; });
            }

            if (Util.HasCount(data.ShipCode))
                cruiseValidations.push(function (c) { return data.ShipCode.split('|').any(_cruiseContent.Ships[c.ShipIndex].Code); });

            if (Util.HasCount(data.Origin))
                cruiseValidations.push(function (c) { return data.Origin.split('|').any(_cruiseContent.Ports[c.PortIndex].Code); });

            if (Util.HasCount(data.Destination)) {
                if (!Array.isArray(data.Destination))
                    data.Destination = data.Destination.split('|');
                cruiseValidations.push(function (c) { return data.Destination.any(_cruiseContent.Destinations[c.DestinationIndex].Code); });
            }

            if (data.EmbarkStart && data.EmbarkStart.isValid) {
                cruiseValidations.push(function (c) { return c.EmbarkIndexes.any(function (e) { return _cruiseContent.EmbarkDates[e] >= data.EmbarkStartDate; }); });
                embarkValidations.push(function (e) { return _cruiseContent.EmbarkDates[e] >= data.EmbarkStart; });
            }

            if (data.EmbarkEnd && data.EmbarkEnd.isValid) {
                cruiseValidations.push(function (c) { return c.EmbarkIndexes.any(function (e) { return _cruiseContent.EmbarkDates[e] <= data.EmbarkEndDate; }); });
                embarkValidations.push(function (e) { return _cruiseContent.EmbarkDates[e] <= data.EmbarkEnd; });
            }

            var filteredCruiseContent = {};

            filteredCruiseContent.SelectedCruiseLines = {};
            filteredCruiseContent.SelectedShips = {};
            filteredCruiseContent.SelectedPorts = {};
            filteredCruiseContent.SelectedDestinations = {};
            filteredCruiseContent.SelectedEmbarks = {};

            filteredCruiseContent.CruiseLines = [];
            filteredCruiseContent.Ships = [];
            filteredCruiseContent.Ports = [];
            filteredCruiseContent.Destinations = [];
            filteredCruiseContent.EmbarkDates = [];

            for (var i = 0; i < _cruiseContent.Combinations.length; i++) {
                var combination = _cruiseContent.Combinations[i];
                if (cruiseValidations.all(function (c) { return c(combination); })) {
                    if (!filteredCruiseContent.SelectedCruiseLines[combination.CruiseLineIndex]) {
                        filteredCruiseContent.SelectedCruiseLines[combination.CruiseLineIndex] = true;
                        filteredCruiseContent.CruiseLines.push(_cruiseContent.CruiseLines[combination.CruiseLineIndex]);
                    }

                    if (!filteredCruiseContent.SelectedShips[combination.ShipIndex]) {
                        filteredCruiseContent.SelectedShips[combination.ShipIndex] = true;
                        filteredCruiseContent.Ships.push(_cruiseContent.Ships[combination.ShipIndex]);
                    }

                    if (!filteredCruiseContent.SelectedDestinations[combination.DestinationIndex]) {
                        filteredCruiseContent.SelectedDestinations[combination.DestinationIndex] = true;
                        filteredCruiseContent.Destinations.push(_cruiseContent.Destinations[combination.DestinationIndex]);
                    }

                    if (!filteredCruiseContent.SelectedPorts[combination.PortIndex]) {
                        filteredCruiseContent.SelectedPorts[combination.PortIndex] = true;
                        filteredCruiseContent.Ports.push(_cruiseContent.Ports[combination.PortIndex]);
                    }

                    for (var j = 0; j < combination.EmbarkIndexes.length; j++) {
                        var embarkIndex = combination.EmbarkIndexes[j];

                        if (!filteredCruiseContent.SelectedEmbarks[embarkIndex]) {
                            filteredCruiseContent.SelectedEmbarks[embarkIndex] = true;

                            if (embarkValidations.all(function (c) { return c(embarkIndex); }))
                                filteredCruiseContent.EmbarkDates.push(_cruiseContent.EmbarkDates[embarkIndex]);
                        }
                    }
                }
            }

            return filteredCruiseContent;
        }

        function _filterCruiseContent(element) {
            if (_cruiseContent && _cruiseContent.Combinations && _cruiseContent.Combinations.length > 0) {
                _adaptCruiseContent();

                var data = _this.getData().Cruise;

                _filteredCruiseContent = {};
                var filteredCruiseContent = _getFilteredCruiseContent(data, element);
                filterCruiseLines(data, filteredCruiseContent);
                filterShips(data, filteredCruiseContent);
                filterDestinations(data, filteredCruiseContent);
                filterOrigins(data, filteredCruiseContent);
                filterEmbarks(data, filteredCruiseContent);

                if (!Util.isTravelGo())
                    settings.components.cruise.embarkEnd.datepickermanager('option', 'minDate', data.EmbarkStartDate);
            }
        }

        function filterCruiseLines(data, filteredCruiseContent) {
            var originalValue = data.CruiseLineCode;
            if (data.CruiseLineCode) {
                data.CruiseLineCode = null;
                filteredCruiseContent = _getFilteredCruiseContent(data);
                data.CruiseLineCode = originalValue;
            }

            _filteredCruiseContent.CruiseLines = filteredCruiseContent.CruiseLines;
        }

        function filterShips(data, filteredCruiseContent) {
            var originalValue = data.ShipCode;
            if (data.ShipCode) {
                data.ShipCode = null;
                filteredCruiseContent = _getFilteredCruiseContent(data);
                data.ShipCode = originalValue;
            }

            _filteredCruiseContent.Ships = filteredCruiseContent.Ships;
        }

        function filterDestinations(data, filteredCruiseContent) {
            var originalValue = data.Destination;
            if (data.Destination) {
                data.Destination = null;
                filteredCruiseContent = _getFilteredCruiseContent(data);
                data.Destination = originalValue;
            }

            _filteredCruiseContent.Destinations = filteredCruiseContent.Destinations;
        }

        function filterOrigins(data, filteredCruiseContent) {
            var originalValue = data.Origin;
            if (data.Origin) {
                data.Origin = null;
                filteredCruiseContent = _getFilteredCruiseContent(data);
                data.Origin = originalValue;
            }

            _filteredCruiseContent.Ports = filteredCruiseContent.Ports;
        }

        function filterEmbarks(data, filteredCruiseContent) {
            var originalStartValue = data.EmbarkStart;
            var originalEndValue = data.EmbarkEnd;

            if (data.EmbarkEnd || data.EmbarkStart) {
                data.EmbarkStart = null;
                data.EmbarkEnd = null;
                filteredCruiseContent = _getFilteredCruiseContent(data);
                data.EmbarkStart = originalStartValue;
                data.EmbarkEnd = originalEndValue;
            }

            _filteredCruiseContent.EmbarkDates = filteredCruiseContent.EmbarkDates;
        }

        function _loadContents(element = null) {
            _filterCruiseContent(element);

            if (_filteredCruiseContent) {
                _filteredCruiseContent.Ships = _filteredCruiseContent.Ships.orderByDescending(function (ship) { return ship.Name; });
                _filteredCruiseContent.Destinations = _filteredCruiseContent.Destinations.orderBy(function (destination) { return destination.Name; });
                _filteredCruiseContent.Ports = _filteredCruiseContent.Ports.orderByDescending(function (port) { return port.Name; });

                _filteredCruiseContent.CruiseLines = _filteredCruiseContent.CruiseLines
                    .where(function (cruiseLine) { return cruiseLine !== undefined; })
                    .orderByDescending(function (cruiseLine) { return cruiseLine.Name; });

                _filteredCruiseContent.Destinations = _filteredCruiseContent.Destinations.where(function (d) { return d.Code !== 'CUBAN'; });

                //Armazena a primeira filtragem para considerar o marco zero dos itens vÃ¡lidos
                _cruiseContent.firstFilterItems = _cruiseContent.firstFilterItems || {};
                _cruiseContent.firstFilterItems.CruiseLines = _cruiseContent.firstFilterItems.CruiseLines || _filteredCruiseContent.CruiseLines;
                _cruiseContent.firstFilterItems.Ships = _cruiseContent.firstFilterItems.Ships || _filteredCruiseContent.Ships;
                _cruiseContent.firstFilterItems.Ports = _cruiseContent.firstFilterItems.Ports || _filteredCruiseContent.Ports;
                _cruiseContent.firstFilterItems.Destinations = _cruiseContent.firstFilterItems.Destinations || _filteredCruiseContent.Destinations;

                _renderOptions(settings.components.cruise.cruiseLine, _filteredCruiseContent.CruiseLines, "Name", "Code", _cruiseContent.firstFilterItems.CruiseLines);
                _renderOptions(settings.components.cruise.ship, _filteredCruiseContent.Ships, "Name", "Code", _cruiseContent.firstFilterItems.Ships);
                _renderOptions(settings.components.cruise.origin, _filteredCruiseContent.Ports, "Name", "Code", _cruiseContent.firstFilterItems.Ports);
                _renderOptions(settings.components.cruise.destination, _filteredCruiseContent.Destinations, "Name", "Code", _cruiseContent.firstFilterItems.Destinations);

                if (Util.isTravelGo()) {
                    _renderEmbarkDatesCalendar();
                }

                _enableOrDisableFidelityInputs(_filteredCruiseContent);
                _adjustChildAgeLimits();

                //if (Util.isTravelGo())
                //    _setValidDatesOnCalendar(_filteredCruiseContent.EmbarkDates);
            }
        }

        function _enableOrDisableFidelityInputs(filteredCruiseContent) {
            var data = _this.getData().Cruise;
            var fidelityInputs = settings.components.fidelityCodes.inputText.not('.fidelityTemplate').find(':input');
            if (data.ShipCode && data.ShipCode.length ||
                data.CruiseLineCode && data.CruiseLineCode.length && data.CruiseLineCode !== "P" ||
                filteredCruiseContent && filteredCruiseContent.CruiseLines.length === 1 && filteredCruiseContent.CruiseLines[0] === "P") {
                fidelityInputs
                    .removeAttr('disabled');
            } else {
                fidelityInputs
                    .removeAttr('disabled')
                    .attr('disabled', 'disabled');
            }
        }

        function _adjustChildAgeLimits() {
            var currentCruiseLine = settings.components.cruise.cruiseLine.val();

            settings.components.cruise.childAge.find('option[value=0]').hide();

            //Para pullmantur, a idade minima para crianÃ§as Ã© de > 6 meses, para as demais, 1 ano
            if (currentCruiseLine === "P") {
                settings.components.cruise.childAge.find('option[value=0]').show();
                settings.components.cruise.childAge.find('option[value=1]').removeAttr('selected');
            } else {
                for (var i = 0; i < settings.components.cruise.childAge.length; i++) {
                    var childAgeEl = settings.components.cruise.childAge.eq(i);
                    if (childAgeEl.val() === "0")
                        childAgeEl.find('option[value=1]').attr('selected', 'selected');
                }
            }
        }


        function _renderEmbarkDatesCalendar() {
            var now = new Date();
            var minDate = now; //_filteredCruiseContent.EmbarkDates.first(); 
            var maxDate = [new Date(now.getFullYear() + 2, now.getMonth(), now.getDate()), _filteredCruiseContent.EmbarkDates.last()].max();

            var monthsRangePickerComponent = settings.components.cruise.embarkStartCalendar.data('monthsrangepicker');
            if (!monthsRangePickerComponent) {
                settings.components.cruise.embarkStartCalendar.MonthsRangePicker({
                    validDates: _filteredCruiseContent.EmbarkDates,
                    events: {
                        onRangeSelected: _onEmbarkRangeSelected
                    },
                    startDate: settings.selectedRange.startDate,
                    endDate: settings.selectedRange.endDate,

                    minDate: minDate,
                    maxDate: maxDate
                });
            } else {
                monthsRangePickerComponent.setValidDates(_filteredCruiseContent.EmbarkDates);
            }
        }

        function _onEmbarkRangeSelected(range) {
            if (!range)
                range = [];

            var start = range.first();
            var end = range.last();

            var selectedDatesText = "";

            if (Util.HasCount(range)) {
                //Atualiza o input com a informaÃ§Ã£o formatada
                selectedDatesText = start.MonthLabel + ' ' + start.Year;
                if (range.length > 1)
                    selectedDatesText += ' - ' + end.MonthLabel + ' ' + end.Year;

                //Atualiza as propriedades para reconhecimento das datas selecionadas
                settings.selectedRange.startDate = new Date(start.Year, start.Month - 1, 1);
                settings.selectedRange.endDate = new Date(end.Year, end.Month, 0); //Last Day of Month (month = month -1 | month + 1 with 0 in day represents day - 1)
            } else {
                settings.selectedRange.startDate = null;
                settings.selectedRange.endDate = null;
            }

            settings.components.cruise.embarkStart.val(selectedDatesText);

            var clearOptionsButton = settings.components.clearSelectedDates;
            clearOptionsButton.removeClass('hide');
            if (!Util.HasCount(range))
                clearOptionsButton.addClass('hide');

            _loadContents();
        }

        function _selectComponents(components) {
            if (!components)
                components = settings.components;

            Util.SelectComponents(components, component, true);
        }

        function _initOptionList(component, options) {
            if (component.is('select')) {
                _initSelect2(component, options);
            }
        }

        function _initSelect2(component, options) {
            component.select2(options || {
                allowClear: false
            }).on('select2:unselecting', function () {
                $(this).data('unselecting', true);
            }).on('select2:opening', function (e) {
                if ($(this).data('unselecting')) {
                    $(this).removeData('unselecting');
                    e.preventDefault();
                }
            });
        }

        function _setEvents() {
            _selectComponents();

            settings.components.cruise.embarkStart.on('click', _showEmbarkStartCalendar);
            settings.components.cruise.embarkEnd.on('click', _showEmbarkEndCalendar);
            settings.components.cruise.adultsQuantity.on('change', _changeAdultsQuantity);
            settings.components.cruise.childsQuantity.on('change', _changeChildsAgeFields);
            settings.components.cruise.cruiseLine.on('change', _loadContents);

            if (settings.components.cruise.ship.is('select'))
                settings.components.cruise.ship.on('change', _loadContents);
            else
                _applySelectLikeEvents(settings.components.cruise.ship.closest('label'));

            if (settings.components.cruise.origin.is('select'))
                settings.components.cruise.origin.on('change', _loadContents);
            else
                _applySelectLikeEvents(settings.components.cruise.origin.closest('label'));


            if (settings.components.cruise.destination.is('select'))
                settings.components.cruise.destination.on('change', _loadContents);
            else
                _applySelectLikeEvents(settings.components.cruise.destination.closest('label'));

            if (Util.isTravelGo()) {
                _applySelectLikeEvents(settings.components.cruise.embarkStart.closest('label'), false);

                if (settings.components.cruise.cruiseLine.is('select'))
                    settings.components.cruise.cruiseLine.on('change', _loadContents);
                else
                    _applySelectLikeEvents(settings.components.cruise.cruiseLine.closest('label'));
            }

            if (Util.HasCount(settings.components.clearSelectedDates))
                settings.components.clearSelectedDates.on('click', _clearSelectedDates);

            settings.components.fidelityCodes.container.on('keyup', '.txtFidelityCodes', _onTxtFidelityCodesKeyUp);
            settings.components.fidelityCodes.container.on('click', '.removeFidelityCode', _removeFidelityCode);

            var eventChangeDate = Global.Mobile && !Util.isTravelGo() ? 'blur' : 'change';

            settings.components.cruise.embarkStart.on(eventChangeDate, _loadContents);
            settings.components.cruise.embarkEnd.on(eventChangeDate, _loadContents);

            if (!Global.Mobile) {
                settings.components.cruise.embarkStart.on('keyup', Util.ForceMaskDate);
                settings.components.cruise.embarkEnd.on('keyup', Util.ForceMaskDate);
            }

            if (Util.HasCount(settings.components.clearFilters))
                settings.components.clearFilters.on('click', _clearFilters);

            settings.components.searchCall.on('click', function (event) { _doSearch(event); });
            settings.components.advancedSearch.on('click', function (event) { settings.components.advancedSearchContent.toggle(); });

            //Comportamento da abertura do painel de hÃ³spedes ao abrir o campo
            if (Util.HasCount(settings.components.guests.guestsContainer)) {
                _applySelectLikeEvents(settings.components.guests.guestsContainer);
            }

            if (Util.isTravelGo()) {
                $(document).mouseup(function (event) {
                    var activeField = $('.select-like:hover', component);
                    var isOpened = activeField.hasClass('opened');
                    var targetElement = $(event.toElement);

                    if (Util.UserResolution() === EnumHelper.UserResolution.Mobile) {
                        if (Util.HasCount(activeField))
                            window.location.hash = "selectOpened";
                        else if (window.location.hash === "#selectOpened" && !$(event.toElement).closest('.select-like').length)
                            window.history.back();

                    } else {
                        if (!isOpened) {
                            //Abre o campo caso nÃ£o esteja aberto
                            _showSelectLikeActiveComponent();
                        } else if (targetElement[0] === activeField[0] || targetElement[0] === activeField.find('.select-arrow')[0] || targetElement[0] === activeField.find('input[type=text]')[0]) {
                            //Recolhe o conteudo quando clicar no campo, na seta ou no texto do campo quando estiver aberto
                            _hideContentPanel($('.select-like', component).find('.content-panel'));
                            _registerBodyClass(false);
                        }
                    }
                });

                $(document).keypress(function (event) {
                    if (event.keyCode === 13) {
                        var activeField = $('.select-like:hover', component);
                        activeField.find('.apply').click();
                    }
                });

                //window.setInterval(_checkUrlChange, 100);
                window.onpopstate = function (event) {
                    //console.log('pop: ' + event.state);
                    //_checkUrlChange();
                    _onUrlChange(window.location.href);
                };

                //Verifica a alteraÃ§Ã£o do tamanho da tela e ajusta o tamanho dos menus para limitar conforme o banner da home
                var resizeMenu = function () {
                    var newHeight = '';
                    if (Util.UserResolution() === EnumHelper.UserResolution.Desktop) {
                        var bannerEl = $(".metaslider:visible"); //$(".master-slider-parent");
                        if (Util.HasCount(bannerEl))
                            newHeight = bannerEl.height() - 20;
                    }

                    $("#searchEngine .list-items-field .content-panel .list-items-content").css('max-height', newHeight);
                };

                resizeMenu();
                $(window).resize(function () {
                    resizeMenu();
                });
            }
        }

        function _doSearch(event) {
            event.preventDefault();

            var pageUrl = Global.ShortCodeParameters.transactionalurl + 'masterpricer';
            if (_this.validate()) {
                var pageUrlWithParameters = _getQueryString(pageUrl);
                window.location.href = pageUrlWithParameters;
            }
        }

        var _lastUrl;
        function _checkUrlChange() {
            if (!_lastUrl)
                _lastUrl = window.location.href;

            if (_lastUrl && _lastUrl !== window.location.href) {
                _lastUrl = window.location.href;
                _onUrlChange(window.location.href);
            }
        }

        function _onUrlChange() {
            _showSelectLikeActiveComponent();
        }

        function _showSelectLikeActiveComponent() {
            var openedClassName = 'opened';
            var openedOptionClassName = 'opened_option';

            var activeField = $('.select-like:hover', component);
            var nonActiveField = $('.select-like', component).not(activeField);

            var searchEngineElement = $(component).parent();
            var dialogElement = searchEngineElement.closest(".ui-dialog");

            //Somente executa as rotinas nos motores visÃ­veis
            if (searchEngineElement.is(':visible')) {
                if (Util.UserResolution() === EnumHelper.UserResolution.Mobile && window.location.hash.replace("#", "") !== 'selectOpened') {
                    _hideContentPanel($('.select-like', component).find('.content-panel'));
                    _registerBodyClass(false);

                    searchEngineElement.removeClass(openedOptionClassName);
                    dialogElement.removeClass(openedOptionClassName);
                } else {
                    _showContentPanel(activeField.find('.content-panel'));
                    activeField.removeClass(openedClassName).addClass(openedClassName);

                    _hideContentPanel(nonActiveField.find('.content-panel'));
                    nonActiveField.removeClass(openedClassName);

                    var hasActiveField = Util.HasCount(activeField);
                    _registerBodyClass(hasActiveField);

                    if (hasActiveField) {
                        searchEngineElement.removeClass(openedOptionClassName).addClass(openedOptionClassName);
                        dialogElement.removeClass(openedOptionClassName).addClass(openedOptionClassName);
                    }
                }
            }
        }

        function _registerBodyClass(hasOpenedOptions) {

            //Registra no body uma classe para indicar o campo aberto para o motor da home na visualizaÃ§Ã£o mobile
            if (Util.UserResolution() === EnumHelper.UserResolution.Mobile) {

                var bodyEl = $('body');

                /*
                var currentClasses = bodyEl.attr('class');
                var finalClassBodyName = 'select-like_opened noscroll';
                //var finalClassBodyName = 'select-like_opened';

                if (!currentClasses)
                    currentClasses = '';

                currentClasses = currentClasses.replaceAll(' ' + finalClassBodyName, '');

                if (hasOpenedOptions)
                    currentClasses += ' ' + finalClassBodyName;

                bodyEl.attr('class', currentClasses);
                */

                var classesToAdd = ['select-like_opened', 'noscroll'];
                for (var i = 0; i < classesToAdd.length; i++) {
                    bodyEl.removeClass(classesToAdd[i]);
                    if (hasOpenedOptions)
                        bodyEl.addClass(classesToAdd[i]);
                }
            }
        }

        function _applySelectLikeEvents(mainComponent, setDefaultClearEvent) {
            if (setDefaultClearEvent === undefined)
                setDefaultClearEvent = true;

            var selectLikeComponentClass = 'select-like';

            mainComponent.removeClass(selectLikeComponentClass).addClass(selectLikeComponentClass);
            _hideContentPanel(mainComponent.find('.content-panel'));

            //Eventos para botÃµes exibidos no mobile
            mainComponent.find('.apply').click(function (event) { _applyListSelection(event); });
            mainComponent.find('.cancel').click(function (event) { _cancelListSelection(event); });

            if (setDefaultClearEvent)
                mainComponent.find('.clearSelectedOptions').click(function (event) { _clearSelectedOptions(event); });
        }

        function _clearSelectedDates(event) {
            var monthsRangePickerComponent = settings.components.cruise.embarkStartCalendar.data('monthsrangepicker');
            monthsRangePickerComponent.setDates(null, null);
        }

        function _clearSelectedOptions(event) {
            var clearButton = $(event.delegateTarget);

            clearButton.closest('.content-panel').find('input[type=checkbox]').removeAttr('checked');
            _loadContents();

            clearButton.removeClass('hide').addClass('hide');
        }

        function _applyListSelection(event) {
            _loadContents();
            _hideContentPanel($(event.delegateTarget).closest('.content-panel'));
            _registerBodyClass(false);

            if (Util.UserResolution() === EnumHelper.UserResolution.Mobile)
                window.history.back();
        }

        function _cancelListSelection(event) {
            var contentPanelElement = $(event.delegateTarget).closest('.content-panel');
            var originalSelection = contentPanelElement.data('originalselection');
            if (originalSelection) {
                var itens = originalSelection.split(',');

                contentPanelElement.find('input.list-item').removeAttr('checked');

                //Retorna a seleÃ§Ã£o original dos itens da lista
                if (Util.HasCount(itens)) {
                    contentPanelElement.find('input.list-item').each(function () {
                        var thisElement = $(this);
                        if (itens.any(function (i) { return i === thisElement.val(); }))
                            thisElement.attr('checked', 'checked');
                    });
                }

            }

            _loadContents();
            _hideContentPanel(contentPanelElement);
            _registerBodyClass(false);

            if (Util.UserResolution() === EnumHelper.UserResolution.Mobile)
                window.history.back();
        }

        function _hideContentPanel(contentPanelElement) {
            contentPanelElement.removeClass('hide').addClass('hide');

            //Limpa as seleÃ§Ãµes originais para que a prÃ³xima abertura registre corretamente as seleÃ§Ãµes originais
            contentPanelElement.data('originalselection', '');

            contentPanelElement.closest('.select-like').removeClass('opened');
        }

        function _showContentPanel(contentPanelElement) {
            contentPanelElement.removeClass('hide');

            //Armazena no elemento as seleÃ§Ãµes originais para posterior cancelamento das novas seleÃ§Ãµes
            var selectedItems = contentPanelElement.find('input.list-item:checked').map(function () { return $(this).val(); }).get();
            if (!contentPanelElement.data('originalselection')) {
                contentPanelElement.data('originalselection', selectedItems.join(','));
            }
        }

        function _showGuestsQuantity() {
            var guestsData = settings.components.guests.guestsDataPanel.cruisePassengersQuantity('getData');
            var guestsSufix = 'HÃ³spedes';

            var totalGuests = parseInt(guestsData.NumberOfAdults) + parseInt(guestsData.NumberOfChildrens);
            if (totalGuests > 0)
                settings.components.guests.guestsField.val(totalGuests + ' ' + guestsSufix);
            else
                settings.components.guests.guestsField.val('');
        }


        function _renderOptions(component, items, textProperty, valueProperty, allItems) {
            if (component.is('select'))
                _renderSelectOptions(component, items, textProperty, valueProperty);
            else
                _renderListOptions(component, items, textProperty, valueProperty, allItems);
        }

        function _renderListOptions(component, items, textProperty, valueProperty, allItems) {
            //var componentContainer = component.closest('.select-like');
            var selectedValues = component.find('input.list-item:checked').map(function () { return $(this).val(); }).get();
            component.empty();

            var listItemClassName = 'list-item';
            var listItemAllClassName = 'list-item-all';

            var orderedItems = allItems.orderBy(function (i) { return i ? i[textProperty] : ""; }).concat([]);

            var getItemHtml = function (value, text, selected, cssClass, enabled) {
                var template =
                    '<li>' +
                    '   <label class="' + (!enabled ? 'disabled' : '') + '">' +
                    '      <input type="checkbox" class="' + cssClass + ' ' + (!enabled ? 'disabled' : '') + '" value="' + value + '" ' + (selected ? 'checked' : '') + ' ' + (!enabled ? 'disabled="disabled"' : '') + ' />' +
                    '      <p>' + text + '</p>' +
                    '   </label > ' +
                    '</li>';

                return template;
            };

            if (Util.HasCount(orderedItems)) {
                //component.eq(0).append(getItemHtml('', 'Todos', isAllSelected, listItemAllClassName, true));

                var allItem = {};
                allItem[valueProperty] = '';
                allItem[textProperty] = 'Todos';

                orderedItems.unshift(allItem);
            }

            var qtdOfLists = 4;
            var splittedList = orderedItems.chunk(Math.ceil(orderedItems.length / qtdOfLists));

            for (var s = 0; s < splittedList.length; s++) {
                var listComponent = component.eq(s);
                listComponent.html('');

                for (var i = 0; i < splittedList[s].length; i++) {
                    var item = splittedList[s][i];

                    var isAllItem = item[valueProperty] === '';

                    var value = item[valueProperty];
                    var text = item[textProperty];

                    var selected = isAllItem && isAllSelected || Util.HasCount(selectedValues) && selectedValues.any(function (i) { return i === value; });
                    var enabled = isAllItem || items.any(function (x) { return x[valueProperty] === item[valueProperty]; });

                    var className = isAllItem ? listItemAllClassName : listItemClassName;

                    listComponent.append(getItemHtml(value, text, selected, className, enabled));
                }
            }
            var allItensElement = component.find('.' + listItemAllClassName);
            allItensElement.removeAttr('checked');
            var itemsElements = component.find('input.list-item:not(.' + listItemAllClassName + '):not(.disabled)');
            var isAllSelected = itemsElements.length === itemsElements.filter(':checked').length;
            if (isAllSelected)
                allItensElement.attr('checked', 'checked');

            $('.' + listItemClassName, component).click(_onListItemClick);
            allItensElement.click(_selectAllOptions);

            _updateFieldValue(component);
        }


        function _chanceCleanButtonVisibility(containerEl) {
            var clearOptionsButton = containerEl.find('.clearSelectedOptions');
            var selectedItens = containerEl.find('input.list-item:checked');
            clearOptionsButton.removeClass('hide');
            if (!Util.HasCount(selectedItens))
                clearOptionsButton.addClass('hide');
        }

        function _onListItemClick(event) {
            var targetEl = $(event.delegateTarget);
            var containerEl = targetEl.closest('.select-like');

            if (Util.HasCount(targetEl.closest('ul.destination'))) {
                //Seleciona os destinos filhos caso o atual selecionado contenha os filhos
                _selectChildDestinations(targetEl);
            }

            //Para mobile, aplicar as seleÃ§Ãµes ao clicar em "Aplicar", e nÃ£o quando selecionar cada opÃ§Ã£o
            if (Util.UserResolution() !== EnumHelper.UserResolution.Mobile)
                _loadContents(this);

            _chanceCleanButtonVisibility(containerEl);
        }

        function _selectChildDestinations(destinationSelectedElement) {
            var destinationCode = destinationSelectedElement.val();
            var destination = _cruiseContent.Destinations.first(function (x) { return x.Code === destinationCode; });

            if (destination && Util.HasCount(destination.ChildsCode)) {
                for (var i = 0; i < destination.ChildsCode.length; i++) {
                    var childCode = destination.ChildsCode[i];
                    var childEl = $('.destination [value=' + childCode + ']', component);

                    if (destinationSelectedElement.is(':checked'))
                        childEl.attr('checked', 'checked');
                    else
                        childEl.removeAttr('checked');
                }
            }
        }

        function _selectAllOptions(event) {
            var jElement = $(event.delegateTarget);
            var component = jElement.closest('ul').parent();

            if (jElement.is(':checked'))
                component.find('input:not(.disabled)').attr('checked', 'checked');
            else
                component.find('input').removeAttr('checked');

            if (Util.UserResolution !== EnumHelper.UserResolution.Mobile)
                _loadContents(this);

            _chanceCleanButtonVisibility(component.closest('.select-like'));
        }

        function _updateFieldValue(component) {
            var mapOptions = function (elements) {
                return elements.map(function () {
                    return {
                        Value: $(this).val(),
                        Text: $(this).parent().text().trim()
                    };
                }).get();
            };

            var listItemsContainer = component.closest('.list-items-field');
            var items = mapOptions(component.find('input.list-item'));
            var selectedValues = mapOptions(component.find('input.list-item:checked'));

            var isAllSelected = items.length === selectedValues.length;
            var totalSelectedItems = selectedValues ? selectedValues.length : 0;
            var valueText = totalSelectedItems >= 1 ? items.first(function (i) { return i.Value === selectedValues.first().Value; }).Text : '';

            var textElement = listItemsContainer.find('.list-items-text');
            if (!textElement.val() || !valueText || !selectedValues.any(function (i) { return i.Text === textElement.val().trim(); }))
                textElement.val(valueText);

            var countBadge = listItemsContainer.find('.list-items-badge');
            countBadge.removeClass('hide');
            if (totalSelectedItems > 1 || isAllSelected)
                countBadge.html('+' + (isAllSelected ? items.length - 1 : totalSelectedItems - 1));
            else
                countBadge.addClass('hide');
        }

        function _renderSelectOptions(component, items, textProperty, valueProperty) {
            var selectedValue = component.val();
            component.empty();

            var newOption = new Option("", "", false, selectedValue === "");
            component.append(newOption);

            if (Util.HasCount(items)) {
                var allOption = new Option("Todos", "-", false, selectedValue === "-");
                component.append(allOption);
            }

            items = items.orderBy(function (i) { return i ? i[textProperty] : ""; });

            $.each(items, function (i, v) {
                if (v && v[textProperty] && v[valueProperty]) {
                    var newOption = new Option(v[textProperty], v[valueProperty], false, selectedValue === v[valueProperty]);
                    component.append(newOption);
                }
            });
        }

        function _changeAdultsQuantity(event) {
            _addEmptyFidelityCodeBoxIfNecessary();
            _changePaxLimits();

            var inputsLength = $(":input", settings.components.fidelityCodes.inputText).length - 1;
            var adultsQuantity = settings.components.cruise.adultsQuantity.val();

            //remove inputs de fidelity em excesso
            if (inputsLength > adultsQuantity) {
                var diff = inputsLength - adultsQuantity;
                settings.components.fidelityCodes.inputText.slice(-diff).closest('.txtFidelityCodes').remove();
            }

            if (Util.HasCount(settings.components.guests.guestsField))
                _showGuestsQuantity();
        }

        function _changeChildsAgeFields(event) {
            if (event && event.preventDefault)
                event.preventDefault();

            _changePaxLimits();

            var currentQuantity = settings.currentChildQuantity;
            var quantitySelected = settings.components.cruise.childsQuantity.val();

            if (Util.HasCount(settings.components.guests.guestsField))
                _showGuestsQuantity();

            if (quantitySelected === "0") {
                settings.components.cruise.childsAgeQuantity.hide();
                return;
            } else {
                settings.components.cruise.childsAgeQuantity.show();
            }

            settings.currentChildQuantity = quantitySelected;

            if (quantitySelected > currentQuantity)
                _addChildAgeField(quantitySelected - currentQuantity);
            else
                _removeChildAgeField(currentQuantity - quantitySelected);


        }

        function _changePaxLimits() {
            var adultsQuantity = parseInt(settings.components.cruise.adultsQuantity.val());
            var childQuantity = parseInt(settings.components.cruise.childsQuantity.val());

            var paxLimit = 4;

            var totalPax = adultsQuantity + childQuantity;
            var available = totalPax = paxLimit - totalPax;

            var availToAdults = adultsQuantity + available;
            var availToChild = childQuantity + available;

            _disablePaxQuantityLimits(settings.components.cruise.adultsQuantity, availToAdults);
            _disablePaxQuantityLimits(settings.components.cruise.childsQuantity, availToChild);
        }

        function _disablePaxQuantityLimits(component, limit) {
            var options = $(component).find('option');
            $(options).show();

            for (var i = 0; i < options.length; i++) {
                if (parseInt(options[i].value) > limit)
                    $(options[i]).hide();
            }
        }

        function _addChildAgeField(fieldsToAdd) {
            _selectComponents(settings.components.cruise);

            for (var i = 0; i < fieldsToAdd; i++)
                settings.components.cruise.childsAgeQuantity.append(settings.components.cruise.childAgeLabel.filter(':last').clone());
        }

        function _removeChildAgeField(fieldsToRemove) {
            for (var i = 0; i < fieldsToRemove; i++) {
                _selectComponents(settings.components.cruise); // update component list - required!
                settings.components.cruise.childAgeLabel.filter(':last').remove();
            }
        }

        function _getComponentLocationsFinderData($component, property) {
            var data = $component.locationsFinder("getData");

            if (!data)
                return null;
            else if (property === undefined)
                return data;
            else
                return data[property];
        }

        function _getFidelityCodes() {
            _selectComponents();

            var validFidelityCodes = [];
            var $fidelityCodes = settings.components.fidelityCodes.inputText.not('.template');

            $fidelityCodes.each(function () {
                var input = $(this).find(':input').not(':disabled');

                if (input && input.val())
                    validFidelityCodes.push(input.val());
            });

            return validFidelityCodes;
        }

        this.validate = function () {
            var errors = [];

            var data = _getData();
            var cia_element = document.getElementsByClassName('cia_label');

            if (cia_element[0] && cia_element[0].style.display != 'none') {
                if (!data.Cruise.Destination &&
                    !data.Cruise.Origin &&
                    !data.Cruise.ShipCode &&
                    !data.Cruise.EmbarkStart &&
                    !data.Cruise.CruiseLineCode) {

                    errors.push(["OnSearch_AtLeastOneFieldIsRequired", "cinco primeiros"]);
                }
            }
            else if (!data.Cruise.Destination &&
                !data.Cruise.Origin &&
                !data.Cruise.ShipCode &&
                !data.Cruise.EmbarkStart) {

                errors.push(["OnSearch_AtLeastOneFieldIsRequired", "quatro primeiros"]);
            }

            if (settings.controllers.messagesController && errors && errors.length)
                settings.controllers.messagesController.notifyMessages(errors, settings.exhibitionType);
            else if (Util.IsAbleToSendGtagEvents(_rootSystemAccountInfo))
                _sendGtagEvents(data);

            return errors.length === 0;
        };

        _getFieldValue = function (component) {
            var value = '';
            if (component.is('select'))
                value = component.val();
            else
                value = component.find('input:checked').map(function () { return $(this).val(); }).get().where(function (x) { return x; }).join('|');

            return !value || value === '-' ? null : value;
        };

        function _getData() {
            var embarkStart, embarkEnd;
            var adultsQuantity = "2";
            var childrenQuantity = "0";
            var childAges = [];

            if (Util.isTravelGo()) {
                embarkStart = settings.selectedRange.startDate && settings.selectedRange.startDate.toDateValues();
                embarkEnd = settings.selectedRange.endDate && settings.selectedRange.endDate.toDateValues();

                var guestsData = settings.components.guests.guestsDataPanel.cruisePassengersQuantity('getData');

                adultsQuantity = guestsData.NumberOfAdults;
                childrenQuantity = parseInt(guestsData.NumberOfChildrens);

                if (childrenQuantity > 0) {
                    childAges = [];
                    for (var i = 0; i < childrenQuantity; i++) {
                        childAges.push(10); //Idade padrÃ£o de crianÃ§a
                    }
                }
            } else {
                embarkStart = settings.components.cruise.embarkStart.datepickermanager("val").toDateValues();
                embarkEnd = settings.components.cruise.embarkEnd.datepickermanager("val").toDateValues();

                adultsQuantity = settings.components.cruise.adultsQuantity.val();
                childrenQuantity = parseInt(settings.components.cruise.childsQuantity.val());
                childAges = settings.components.cruise.childAge.map(function () { return $(this).val(); }).get().take(settings.components.cruise.childsQuantity.val());
            }

            var searchParameters = {
                Cruise: {
                    EmbarkStart: embarkStart,
                    EmbarkEnd: embarkEnd,
                    CruiseLineCode: Global.Cruise && Global.Cruise.DefaultCompany || _getFieldValue(settings.components.cruise.cruiseLine),
                    ShipCode: _getFieldValue(settings.components.cruise.ship),
                    Destination: _getFieldValue(settings.components.cruise.destination),
                    Origin: _getFieldValue(settings.components.cruise.origin),
                    FidelityCodes: _getFidelityCodes(),
                    Senior: Util.isTravelGo() ? settings.components.cruise.senior.is(':checked') : settings.components.cruise.senior.hasClass('current'),
                    Accessibility: Util.isTravelGo() ? settings.components.cruise.accessibility.is(':checked') : settings.components.cruise.accessibility.hasClass("current"),
                    NumberOfAdults: adultsQuantity,
                    ChildAges: childAges
                }
            };

            searchParameters.Cruise.EmbarkStartDate = Util.DateValuesToDate(searchParameters.Cruise.EmbarkStart);
            searchParameters.Cruise.EmbarkEndDate = Util.DateValuesToDate(searchParameters.Cruise.EmbarkEnd);

            //CÃ³digo provisÃ³rio para informar a quantidade de sÃªniors
            //No B2C foi exposto atravÃ©s de input a quantidade de seniors, porÃ©m o B2B ainda nÃ£o possui o numero.
            //Portanto, para manter o funcionamento como era antes desta propriedade, caso seja selecionado sÃªnior, serÃ¡ considerado todos os adultos
            if (!Util.isTravelGo() && searchParameters.Cruise.Senior && !searchParameters.Cruise.NumberOfSeniors) {
                searchParameters.Cruise.NumberOfSeniors = searchParameters.Cruise.NumberOfAdults;
            }

            return searchParameters;
        }

        this.getData = function () {
            return _getData();
        };

        this.setOptions = function (options) {
            $.extend(true, settings, options);
        };

        function _setValue(component, value, trigger) {
            if (value && Util.HasCount(value)) {
                if (component.is('select')) {
                    component.val(value);

                    if (trigger)
                        component.trigger(trigger);
                }
                else {
                    component.find('input').removeAttr('checked');
                    if (value) {
                        var splitted = value;

                        if (!Array.isArray(splitted))
                            splitted = value.split('|');

                        for (var i = 0; i < splitted.length; i++) {
                            var thisValue = splitted[i];
                            if (thisValue) {
                                var input = component.find('input[value="' + thisValue + '"]');
                                input.attr('checked', 'checked');

                                if (trigger)
                                    input.trigger(trigger);
                            }
                        }
                    }
                }
            }
        }

        this.updateValues = function (searchParameters) {
            if (searchParameters && searchParameters.Cruise) {

                _setValue(settings.components.cruise.origin, searchParameters.Cruise.Origin);
                _setValue(settings.components.cruise.destination, searchParameters.Cruise.Destination);
                _setValue(settings.components.cruise.ship, searchParameters.Cruise.Ship);

                settings.components.cruise.cruiseLine.val(searchParameters.Cruise.CruiseLine);
                settings.components.cruise.adultsQuantity.val(searchParameters.Cruise.NumberOfAdults);
                settings.components.cruise.childsQuantity.val(searchParameters.Cruise.ChildAges.length);
                settings.components.cruise.senior.prop('checked', searchParameters.Cruise.Senior);
                settings.components.cruise.accessibility.prop('checked', searchParameters.Cruise.Accessibility);

                for (var i = 0; i < searchParameters.Cruise.ChildAges.length; i++)
                    settings.components.cruise.childAge.eq(i).val(searchParameters.Cruise.ChildAges[i]);

                if (searchParameters.Cruise.EmbarkStart) {
                    settings.components.cruise.embarkStart.datepickermanager("setDate", formatter.dateValuesToDate(searchParameters.Cruise.EmbarkStart)).val(formatter.dateValuesShort(searchParameters.Cruise.EmbarkStart));
                    _embarkStartRules(settings.components.cruise.embarkStart.selector);
                } else {
                    settings.components.cruise.embarkStart.val("").datepickermanager("setDate", undefined);
                }

                if (searchParameters.Cruise.EmbarkEnd) {
                    settings.components.cruise.embarkEnd.val(formatter.dateValuesShort(searchParameters.Cruise.EmbarkEnd)).datepickermanager("setDate", formatter.dateValuesToDate(searchParameters.Cruise.EmbarkEnd));
                    _embarkEndRules(settings.component.cruise.embarkEnd.selector);
                } else {
                    settings.components.cruise.embarkEnd.val("").datepickermanager("setDate", undefined);
                }
            }
        };

        function _showEmbarkStartCalendar() {
            if (!Util.isTravelGo())
                settings.components.cruise.embarkStart.datepickermanager("show");
        }

        function _showEmbarkEndCalendar() {
            if (!Util.isTravelGo())
                settings.components.cruise.embarkEnd.datepickermanager("show");
        }

        function _formatEmbarkDates(date) {
            if (!date)
                return '';

            return Util.StringFormat("{0}/{1}/{2}",
                date.Day, date.Month, date.Year);
        }

        function _clearFilters() {
            //Cruise Filters
            _setValue(settings.components.cruise.cruiseLine, '-', 'change');
            _setValue(settings.components.cruise.ship, '-', 'change');
            _setValue(settings.components.cruise.origin, '-', 'change');
            _setValue(settings.components.cruise.destination, '-', 'change');

            //Embark & Debark
            settings.components.cruise.embarkStart.val('');
            settings.components.cruise.embarkEnd.val('');

            //Adults & Childrens
            settings.components.cruise.adultsQuantity.val('2').trigger('change');
            settings.components.cruise.childsQuantity.val('0').trigger('change');

            //Senior & Accessibility
            settings.components.cruise.senior.prop('checked', false).removeClass('current');
            settings.components.cruise.accessibility.prop('checked', false).removeClass('current');

            //Fidelity Codes
            settings.components.fidelityCodes.inputText.find('input[type=text]').val('');

        }

        function _fillValues(data) {
            if (data && !$.isEmptyObject(data)) {

                if (data.Cruise) {
                    var triggerAction = 'change';

                    if (data.Cruise.CruiseLineCode !== "")
                        settings.components.cruise.cruiseLine.val(data.Cruise.CruiseLineCode).trigger(triggerAction);

                    _setValue(settings.components.cruise.ship, data.Cruise.ShipCode, triggerAction);
                    _setValue(settings.components.cruise.origin, data.Cruise.Origin, triggerAction);
                    _setValue(settings.components.cruise.destination, data.Cruise.Destination, triggerAction);

                    //var dateMonthsOnlyComponent = settings.components.cruise.embarkStart.data('daterangepicker');
                    var monthsRangePickerComponent = settings.components.cruise.embarkStartCalendar.data('monthsrangepicker');
                    if (monthsRangePickerComponent) {
                        if (_formatEmbarkDates(data.Cruise.EmbarkStart) !== "1/1/1" &&
                            _formatEmbarkDates(data.Cruise.EmbarkEnd) !== "1/1/1") {

                            settings.selectedRange.startDate = Util.DateValuesToDate(data.Cruise.EmbarkStart);
                            settings.selectedRange.endDate = Util.DateValuesToDate(data.Cruise.EmbarkEnd);

                            monthsRangePickerComponent.setDates(settings.selectedRange.startDate, settings.selectedRange.endDate);
                        }
                    } else {
                        if (_formatEmbarkDates(data.Cruise.EmbarkStart) !== "1/1/1")
                            settings.components.cruise.embarkStart.val(formatter.dateValuesShort(data.Cruise.EmbarkStart)).trigger(triggerAction);

                        if (_formatEmbarkDates(data.Cruise.EmbarkEnd) !== "1/1/1")
                            settings.components.cruise.embarkEnd.val(formatter.dateValuesShort(data.Cruise.EmbarkEnd)).trigger(triggerAction);
                    }

                    if (data.Cruise.Accessibility && Util.HasCount(settings.components.cruise.accessibility)) {
                        settings.components.cruise.accessibility[0].checked = data.Cruise.Accessibility;
                    }

                    if (data.Cruise.Senior && Util.HasCount(settings.components.cruise.senior)) {
                        settings.components.cruise.senior[0].checked = data.Cruise.Senior;
                    }

                    if (data.Cruise.NumberOfAdults)
                        settings.components.cruise.adultsQuantity.val(data.Cruise.NumberOfAdults).trigger(triggerAction);

                    if (Util.HasCount(data.Cruise.ChildAges)) {
                        settings.components.cruise.childsQuantity.val(data.Cruise.ChildAges.length).trigger(triggerAction);

                        Util.SelectComponents(settings.components, component, true);

                        for (var i = 0; i < data.Cruise.ChildAges.length; i++) {
                            settings.components.cruise.childAge.eq(i).val(data.Cruise.ChildAges[i]).trigger(triggerAction);
                        }
                    }

                    if (Util.isTravelGo()) {
                        _loadContents();
                    }
                }
            }
        }

        this.fillValues = function (data) {
            _fillValues(data);
        };

        function _readQueryString(queryString) {
            var searchParameters = {};

            searchParameters.Cruise = {};

            searchParameters.Cruise.Accessibility = Util.QueryString("Accessibility", queryString) === "true" ? true : false;
            searchParameters.Cruise.Senior = Util.QueryString("Senior", queryString) === "true" ? true : false;

            searchParameters.Cruise.NumberOfAdults = Util.QueryString("NumADT", queryString) ? Util.QueryString("NumADT", queryString) : Util.isTravelGo() && Global.ShortCodeParameters.default_adt ? Global.ShortCodeParameters.default_adt : "1";
            searchParameters.Cruise.CruiseLineCode = Global.Cruise && Global.Cruise.DefaultCompany ? Global.Cruise.DefaultCompany : Util.QueryString("CruiseLine", queryString) === "undefined" || Util.QueryString("CruiseLine", queryString) === "null" ? null : Util.QueryString("CruiseLine", queryString);

            var activeFilters = true;
            if (activeFilters) {
                searchParameters.Cruise.ShipCode = Util.QueryString("ShipCode", queryString) === "undefined" || Util.QueryString("ShipCode", queryString) === "null" ? null : Util.QueryString("ShipCode", queryString);

                searchParameters.Cruise.Origin = Util.QueryString("Origin", queryString) === "undefined" || Util.QueryString("Origin", queryString) === "null" ? null : Util.QueryString("Origin", queryString);
                searchParameters.Cruise.OriginName = Util.QueryString("OriginName", queryString) === "undefined" || Util.QueryString("OriginName", queryString) === "null" ? null : Util.QueryString("OriginName", queryString);

                searchParameters.Cruise.Destination = Util.QueryString("Destination", queryString) === "undefined" || Util.QueryString("Destination", queryString) === "null" ? null : Util.QueryString("Destination", queryString);
                searchParameters.Cruise.DestinationName = Util.QueryString("DestinationName", queryString) === "undefined" || Util.QueryString("DestinationName", queryString) === "null" ? null : Util.QueryString("DestinationName", queryString);

                searchParameters.Cruise.EmbarkStart = Util.QueryString("EmbarkStart", queryString) ? Util.QueryString("EmbarkStart", queryString).toDateValues("pt") : "1/1/1".toDateValues("pt");
                searchParameters.Cruise.EmbarkEnd = Util.QueryString("EmbarkEnd", queryString) ? Util.QueryString("EmbarkEnd", queryString).toDateValues("pt") : "1/1/1".toDateValues("pt");
            }

            if (Util.QueryString("ChildAges", queryString) === "" || Util.QueryString("ChildAges", queryString) === "undefined" || typeof Util.QueryString("ChildAges", queryString) === "undefined")
                searchParameters.Cruise.ChildAges = [];
            else
                searchParameters.Cruise.ChildAges = Util.QueryString("ChildAges", queryString).split(",").where(function (age) { return age !== ""; });

            if (Util.QueryString("FidelityCodes", queryString) === "" || Util.QueryString("FidelityCodes", queryString) === "undefined" || typeof Util.QueryString("FidelityCodes", queryString) === "undefined")
                searchParameters.Cruise.FidelityCodes = [];
            else
                searchParameters.Cruise.FidelityCodes = Util.QueryString("FidelityCodes", queryString).split(",").where(function (code) { return code !== ""; });


            /*
            if (searchParameters.Cruise.ShipCode && searchParameters.Cruise.ShipCode.indexOf('|') >= 0)
                searchParameters.Cruise.ShipCode = searchParameters.Cruise.ShipCode.split('|');

            if (searchParameters.Cruise.Origin && searchParameters.Cruise.Origin.indexOf('|') >= 0)
                searchParameters.Cruise.Origin = searchParameters.Cruise.Origin.split('|');

            if (searchParameters.Cruise.Destination && searchParameters.Cruise.Destination.indexOf('|') >= 0)
                searchParameters.Cruise.Destination = searchParameters.Cruise.Destination.split('|');
            */

            return searchParameters;
        }

        this.readQueryString = function (queryString) {
            return _readQueryString(queryString);
        };

        function _getQueryString(pageUrl) {
            var data = _this.getData();

            pageUrl = pageUrl + "?SearchType=Cruise";

            var queryString = "";

            queryString += _addQueryStringParam(queryString, "CruiseLine", data.Cruise.CruiseLineCode)
            queryString += _addQueryStringParam(queryString, "ShipCode", data.Cruise.ShipCode);

            queryString += _addQueryStringParam(queryString, "Destination", data.Cruise.Destination);
            queryString += _addQueryStringParam(queryString, "DestinationName", data.Cruise.DestinationName);

            queryString += _addQueryStringParam(queryString, "Origin", data.Cruise.Origin);
            queryString += _addQueryStringParam(queryString, "OriginName", data.Cruise.OriginName);

            queryString += _addQueryStringParam(queryString, "Accessibility", data.Cruise.Accessibility);
            queryString += _addQueryStringParam(queryString, "Senior", data.Cruise.Senior);

            queryString += _addQueryStringParam(queryString, "EmbarkStart", _formatEmbarkDates(data.Cruise.EmbarkStart));
            queryString += _addQueryStringParam(queryString, "EmbarkEnd", _formatEmbarkDates(data.Cruise.EmbarkEnd));

            queryString += _addQueryStringParam(queryString, "NumADT", data.Cruise.NumberOfAdults ? data.Cruise.NumberOfAdults : 1);

            queryString += _addQueryStringParam(queryString, "ChildAges", data.Cruise.ChildAges.join(","));
            queryString += _addQueryStringParam(queryString, "FidelityCodes", data.Cruise.FidelityCodes.join(","));

            return pageUrl + queryString;
        }

        function _addQueryStringParam(queryString, name, value) {
            if (value)
                return "&" + name + "=" + value;
            else
                return "";
        }

        this.getQueryString = function (pageUrl) {
            return _getQueryString(pageUrl);
        };

        function _sendGtagEvents(searchParameters) {
            var cruiseSearchParameters = searchParameters.Cruise;

            _sendGtagEventShortLabel('select_cruiseLine', cruiseSearchParameters.CruiseLineCode);
            _sendGtagEventShortLabel('select_shipCode', cruiseSearchParameters.ShipCode);
            _sendGtagEventShortLabel('select_origin', cruiseSearchParameters.Origin);
            _sendGtagEventShortLabel('select_destination', cruiseSearchParameters.Destination);
            _sendGtagSelectEmbarkStartEvent(cruiseSearchParameters);
            _sendGtagSelectEmbarkEndEvent(cruiseSearchParameters);
            _sendGtagEventDefault('select_accessibility', cruiseSearchParameters.Accessibility);
            _sendGtagEventDefault('select_senior', cruiseSearchParameters.Senior);
            _sendGtagEventShortLabel('select_numberOfAdults', cruiseSearchParameters.NumberOfAdults);
            _sendGtagSelectNumberOfChildrenEvent(cruiseSearchParameters);
            _sendGtagSelectFidelityCodesEvent(cruiseSearchParameters);
            _sendGtagSearchEvent(cruiseSearchParameters);
        }

        function _sendGtagEventShortLabel(action, searchParameter, useCustomLabel) {
            if (searchParameter) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = searchParameter + ' - ' + _rootSystemAccountInfo;
                
                Util.SendGtagEvent(action, _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagSelectEmbarkStartEvent(cruiseSearchParameters, useCustomLabel) {
            var embarkStart = cruiseSearchParameters.EmbarkStart;

            if (embarkStart && !_isEmptyDate(embarkStart)) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = embarkStart.Day + '/' + embarkStart.Month + '/' + embarkStart.Year + ' - ' + _rootSystemAccountInfo;
                
                Util.SendGtagEvent('select_embarkStart', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagSelectEmbarkEndEvent(cruiseSearchParameters, useCustomLabel) {
            var embarkEnd = cruiseSearchParameters.EmbarkEnd;

            if (embarkEnd && !_isEmptyDate(embarkEnd)) {
                var gtagEventLabel;

                if (useCustomLabel) 
                    gtagEventLabel = embarkEnd.Day + '/' + embarkEnd.Month + '/' + embarkEnd.Year + ' - ' + _rootSystemAccountInfo;
                
                Util.SendGtagEvent('select_embarkEnd', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagEventDefault(action, searchParameter) {
            if (searchParameter)
                Util.SendGtagEvent(action, _gtagEventCategory);
        }

        function _sendGtagSelectNumberOfChildrenEvent(cruiseSearchParameters, useCustomLabel) {
            var numberOfChildren = cruiseSearchParameters.ChildAges && cruiseSearchParameters.ChildAges.length;
            var childrenLength = $(settings.components.cruise.childAge).length;

            if (numberOfChildren && childrenLength) {
                var gtagEventLabel;

                if (useCustomLabel)
                    gtagEventLabel = childrenLength + ' - ' + _rootSystemAccountInfo;
                
                Util.SendGtagEvent('select_numberOfChildren', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagSelectFidelityCodesEvent(cruiseSearchParameters, useCustomLabel) {
            if (cruiseSearchParameters.FidelityCodes && cruiseSearchParameters.FidelityCodes.length) {
                var gtagEventLabel;

                if (useCustomLabel) {
                    var codes = cruiseSearchParameters.FidelityCodes.reduce(function (acc, cur, index) {
                        return Util.ConcatenateStringSeparatedBy("/", acc, cur, index); 
                    });
                    gtagEventLabel = codes + ' - ' + _rootSystemAccountInfo;
                }

                Util.SendGtagEvent('select_fidelityCodes', _gtagEventCategory, gtagEventLabel);
            }
        }

        function _sendGtagSearchEvent(cruiseSearchParameters, useCustomLabel) {
            var gtagEventLabel;

            if (useCustomLabel) {
                var destination = cruiseSearchParameters.Destination;            
                gtagEventLabel = (destination ? destination + ' - ' : '') + _rootSystemAccountInfo;
            }
            
            Util.SendGtagEvent('search', _gtagEventCategory, gtagEventLabel);
        }

        function _isEmptyDate(date) {
            return date.Year == 1 && date.Month == 1 && date.Day == 1;
        }
    }

    $.fn.cruiseSearchEngine = function () {
        return Util.pluginDefaultBehavior(this, "cruiseSearchEngine", arguments, function () { return new CruiseSearchEngine(); });
    };

})(jQuery);

/// <reference path="WebCommon/Scripts/Libraries/Util.js" />

(function ($) {

    function SearchEngine() {
        var component = undefined;
        var thisSearchEngine = this;
        var currentPluginSelected = {
            contextPlugin: undefined,
            pluginName: ""
        };
        var settings = {
            air: true,
            bus: true,
            cruise: false,
            cruiseGroup: false,
            hotel: true,
            dynamicPackage: false,
            package: true,
            service: false,
            car: false,
            airHotel: false,
            tour: false,
            insurance: false,
            itinerary: false,
            updateValuesOnChangeSE: true,
            components: {
                cruiseGroup: {
                    searchEngineContainer: '.cruiseGroupSearchEngineContainer',
                    searchEngineOption: '#cruiseGroupSearchEngineOption'
                },
                cruise: {
                    searchEngineContainer: '.cruiseSearchEngineContainer',
                    searchEngineOption: '#cruiseSearchEngineOption'
                },
                air: {
                    searchEngineContainer: '.airSearchEngineContainer',
                    searchEngineOption: '#airSearchEngineOption'
                },
                bus: {
                    searchEngineContainer: '.busSearchEngineContainer',
                    searchEngineOption: '#busSearchEngineOption'
                },
                hotel: {
                    searchEngineContainer: '.hotelSearchEngineContainer',
                    searchEngineOption: '#hotelSearchEngineOption'
                },
                package: {
                    searchEngineContainer: '.packageSearchEngineContainer',
                    searchEngineOption: '#packageSearchEngineOption'
                },
                service: {
                    searchEngineContainer: '.servicesSearchEngineContainer',
                    searchEngineOption: '#serviceSearchEngineOption'
                },
                car: {
                    searchEngineContainer: '.carSearchEngineContainer',
                    searchEngineOption: '#carSearchEngineOption'
                },
                insurance: {
                    searchEngineContainer: '.insuranceSearchEngineContainer',
                    searchEngineOption: '#insuranceSearchEngineOption'
                },
                map: {
                    searchEngineContainer: '.mapSearchEngineContainer',
                    searchEngineOption: '#mapSearchEngineOption'
                },
                calendar: {
                    searchEngineContainer: '.calendarSearchEngineContainer',
                    searchEngineOption: '#calendarSearchEngineOption'
                },
                airHotel: {
                    searchEngineContainer: '.airHotelSearchEngineContainer',
                    searchEngineOption: '#airHotelSearchEngineOption'
                },
                dynamicPackage: {
                    searchEngineContainer: '.dynamicPackageSearchEngineContainer',
                    searchEngineOption: '#dynamicPackageSearchEngineOption'
                },
                tour: {
                    searchEngineContainer: '.tourSearchEngineContainer',
                    searchEngineOption: '#tourSearchEngineOption'
                },
                itinerary: {
                    searchEngineContainer: '.itinerarySearchEngineContainer',
                    searchEngineOption: '#itinerarySearchEngineOption'
                },
                modal: {
                    header: '.search-engine-header',
                    closeButton: '.close-button'
                }
            },
            modal: {
                doubleBackground: false
            },
            template: undefined,
            plugins: {
                cruise: { options: {} },
                cruiseGroup: { options: {} },
                air: { options: {} },
                bus: { options: {} },
                hotel: { options: {} },
                package: { options: {} },
                service: { options: {} },
                car: { options: {} },
                airHotel: { options: {} },
                dynamicPackage: { options: {} },
                tour: { options: {} },
                insurance: { options: {} },
                itinerary: { options: {} },
            },
            events: {
                clearMessagesExhibitor: function () { }
            }
        };

        var lastPluginData = {
            DepartureLocation: undefined,
            DestinationLocation: undefined,
            StartDate: undefined,
            EndDate: undefined,
            SearchForPackageComposition: undefined,
            ConsumerGroups: [],
            Air: { CiaCodes: [], isRoundTrip: undefined, NonStop: undefined },
            Hotel: { HotelName: undefined },
            Service: { EventNumber: undefined, EventName: undefined },
            Car: {},
            Insurance: {},
            getConsumerTotals: _getConsumersTotals,
            getConsumerSummaryGrouped: _getConsumerSummaryGrouped,
            getConsumerGroupsTotals: _getConsumerGroupsTotals
        };

        this.initialize = function (target, opts) {

            component = $(target);

            $.extend(true, settings, opts || {});

            thisSearchEngine.render();

            _setLiveEvents();

            _initializeDependencePlugins();

            thisSearchEngine.updateValues(settings.origin);

            _attachEvents();

        };

        this.render = function () {
            _selectComponents();

            var searchEngineHtml = settings.template(settings);

            component.html(searchEngineHtml);
        };

        this.setOptions = function (options) {
            currentPluginSelected.contextPlugin[currentPluginSelected.pluginName]("setOptions", options);
        };

        this.getData = function () {
            return currentPluginSelected.contextPlugin[currentPluginSelected.pluginName]("getData");
        };

        this.getGenericData = function (auxFunction) {
            return currentPluginSelected.contextPlugin[currentPluginSelected.pluginName]("getGenericData", auxFunction);
        };

        this.updateValues = function (searchParameters) {
            currentPluginSelected.contextPlugin[currentPluginSelected.pluginName]("updateValues", searchParameters);
        };

        this.validate = function (isOffiline) {

            settings.events.clearMessagesExhibitor();

            return currentPluginSelected.contextPlugin[currentPluginSelected.pluginName]("validate", isOffiline);
        };

        this.readQueryString = function (queryString) {
            return currentPluginSelected.contextPlugin[currentPluginSelected.pluginName]("readQueryString", queryString);
        };

        this.getQueryString = function (pageUrl) {
            return currentPluginSelected.contextPlugin[currentPluginSelected.pluginName]("getQueryString", pageUrl);
        };

        this.getCurrentContextPlugin = function () {
            return currentPluginSelected.contextPlugin;
        };

        this.fillValues = function (searchParameters) {
            return currentPluginSelected.contextPlugin[currentPluginSelected.pluginName]("fillValues", searchParameters);
        }

        function _initializeDependencePlugins() {

            function _showCurrentSearchEngineContainer(searchEngineContainerType) {
                settings.components[searchEngineContainerType].searchEngineContainer.show();
                currentPluginSelected = { contextPlugin: settings.components[searchEngineContainerType].searchEngineContainer, pluginName: searchEngineContainerType + 'SearchEngine' };
            }

            function _initializeMaxPassengerQtd(pluginName, globalPropertyName) {
                if (settings.plugins[pluginName].options.maxPassengerQtd != undefined) {
                    var data = settings.plugins[pluginName].options.maxPassengerQtd;

                    data.maxPassengerQtdSettingValue = settings.plugins[pluginName].options.maxPassengers;

                    if (TravelGo.Plugin && TravelGo.Plugin.MaxPassengerQtd) {
                        var maxPassenger = new TravelGo.Plugin.MaxPassengerQtd({
                            data: data
                        });
                    }
                }
            }

            if (Global.MaxPassengerQtd == undefined) {
                Global.MaxPassengerQtd = {};
            }

            if (settings.air) {
                settings.components.air.searchEngineContainer.airSearchEngine(settings.plugins["air"].options);
                settings.components.air.searchEngineContainer.airSearchEngine("render");

                _initializeMaxPassengerQtd('air', 'AirSearchEngine');
            }

            if (settings.bus && settings.components.bus.searchEngineContainer.length > 0) {
                settings.components.bus.searchEngineContainer.busSearchEngine(settings.plugins["bus"].options);
                settings.components.bus.searchEngineContainer.busSearchEngine("render");
            }

            if (settings.cruise) {
                settings.components.cruise.searchEngineContainer.cruiseSearchEngine(settings.plugins["cruise"].options);
                settings.components.cruise.searchEngineContainer.cruiseSearchEngine("render");
            }

            if (settings.cruiseGroup) {
                settings.components.cruiseGroup.searchEngineContainer.cruiseGroupSearchEngine(settings.plugins["cruiseGroup"].options);
                settings.components.cruiseGroup.searchEngineContainer.cruiseGroupSearchEngine("render");
            }

            if (settings.hotel) {
                settings.components.hotel.searchEngineContainer.hotelSearchEngine(settings.plugins["hotel"].options);
                settings.components.hotel.searchEngineContainer.hotelSearchEngine("render");

                _initializeMaxPassengerQtd('hotel', 'HotelSearchEngine');
            }

            if (settings.package) {
                settings.components.package.searchEngineContainer.packageSearchEngine(settings.plugins["package"].options);
                settings.components.package.searchEngineContainer.packageSearchEngine("render");
            }

            if (settings.service) {
                settings.components.service.searchEngineContainer.serviceSearchEngine(settings.plugins["service"].options);
                settings.components.service.searchEngineContainer.serviceSearchEngine("render");
            }

            if (settings.car) {
                settings.components.car.searchEngineContainer.carSearchEngine(settings.plugins["car"].options);
                settings.components.car.searchEngineContainer.carSearchEngine("render");
            }

            if (settings.insurance) {
                settings.components.insurance.searchEngineContainer.insuranceSearchEngine(settings.plugins["insurance"].options);
                settings.components.insurance.searchEngineContainer.insuranceSearchEngine("render");
            }

            if (settings.calendar) {
                settings.components.calendar.searchEngineContainer.calendarSearchEngine(settings.plugins["calendar"].options);
                settings.components.calendar.searchEngineContainer.calendarSearchEngine("render");
            }

            if (settings.map) {
                settings.components.map.searchEngineContainer.mapSearchEngine(settings.plugins["map"].options);
                settings.components.map.searchEngineContainer.mapSearchEngine("render");
            }

            if (settings.airHotel) {
                settings.components.airHotel.searchEngineContainer.airHotelSearchEngine(settings.plugins["airHotel"].options);
                settings.components.airHotel.searchEngineContainer.airHotelSearchEngine("render");
            }

            if (settings.dynamicPackage) {
                settings.components.dynamicPackage.searchEngineContainer.dynamicPackageSearchEngine(settings.plugins["dynamicPackage"].options);
                settings.components.dynamicPackage.searchEngineContainer.dynamicPackageSearchEngine("render");
            }

            if (settings.tour) {
                settings.components.tour.searchEngineContainer.tourSearchEngine(settings.plugins["tour"].options);
                settings.components.tour.searchEngineContainer.tourSearchEngine("render");

                _initializeMaxPassengerQtd('tour', 'TourSearchEngine');
            }

            if (settings.itinerary) {
                settings.components.itinerary.searchEngineContainer.itinerarySearchEngine(settings.plugins["itinerary"].options);
                settings.components.itinerary.searchEngineContainer.itinerarySearchEngine("render");
            }

            _hideSearchEnginesContainers();
            _showCurrentSearchEngineContainer(settings.defaultSearchEngine);

        }

        function _setLiveEvents() {
            _selectComponents();

            $(component).off('click', settings.components.cruise.searchEngineOption.selector).on('click', settings.components.cruise.searchEngineOption.selector, _showCruiseSearchEnginePlugin);
            $(component).off('click', settings.components.cruiseGroup.searchEngineOption.selector).on('click', settings.components.cruiseGroup.searchEngineOption.selector, _showCruiseGroupSearchEnginePlugin);

            $(component).off('click', settings.components.airHotel.searchEngineOption.selector).on('click', settings.components.airHotel.searchEngineOption.selector, _showairHotelSearchEnginePlugin);
            $(component).off('click', settings.components.air.searchEngineOption.selector).on('click', settings.components.air.searchEngineOption.selector, _showAirSearchEnginePlugin);
            $(component).off('click', settings.components.bus.searchEngineOption.selector).on('click', settings.components.bus.searchEngineOption.selector, _showBusSearchEnginePlugin);
            $(component).off('click', settings.components.hotel.searchEngineOption.selector).on('click', settings.components.hotel.searchEngineOption.selector, _showHotelSearchEnginePlugin);
            $(component).off('click', settings.components.package.searchEngineOption.selector).on('click', settings.components.package.searchEngineOption.selector, _showPackageSearchEnginePlugin);
            $(component).off('click', settings.components.service.searchEngineOption.selector).on('click', settings.components.service.searchEngineOption.selector, _showServiceSearchEnginePlugin);
            $(component).off('click', settings.components.car.searchEngineOption.selector).on('click', settings.components.car.searchEngineOption.selector, _showCarSearchEnginePlugin);
            $(component).off('click', settings.components.dynamicPackage.searchEngineOption.selector).on('click', settings.components.dynamicPackage.searchEngineOption.selector, _showDynamicPackageSearchEnginePlugin);
            $(component).off('click', settings.components.tour.searchEngineOption.selector).on('click', settings.components.tour.searchEngineOption.selector, _showTourSearchEnginePlugin);

            $(component).off('click', settings.components.insurance.searchEngineOption.selector).on('click', settings.components.insurance.searchEngineOption.selector, _showInsuranceSearchEnginePlugin);


            $(component).off('click', settings.components.itinerary.searchEngineOption.selector).on('click', settings.components.itinerary.searchEngineOption.selector, _showItinerarySearchEnginePlugin);
            

            //settings.components.event.searchEngineOption.die('click').live('click', _showEventsSearchEnginePlugin);
        }

        function _showCruiseGroupSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.cruiseGroup.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.cruiseGroup.searchEngineContainer, pluginName: 'cruiseGroupSearchEngine' };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }


        function _showCruiseSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.cruise.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.cruise.searchEngineContainer, pluginName: 'cruiseSearchEngine' };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }

        function _showAirSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.air.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.air.searchEngineContainer, pluginName: 'airSearchEngine' };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }

        function _showBusSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.bus.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.bus.searchEngineContainer, pluginName: 'busSearchEngine' };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }

        function _showHotelSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.hotel.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.hotel.searchEngineContainer, pluginName: 'hotelSearchEngine' };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }

        function _showPackageSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.package.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.package.searchEngineContainer, pluginName: 'packageSearchEngine' };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }

        function _showServiceSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.service.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.service.searchEngineContainer, pluginName: 'serviceSearchEngine' };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }

        function _showDynamicPackageSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.dynamicPackage.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.dynamicPackage.searchEngineContainer, pluginName: "dynamicPackageSearchEngine" };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();

        }

        function _showCarSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.car.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.car.searchEngineContainer, pluginName: "carSearchEngine" };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }

        function _showairHotelSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.airHotel.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.airHotel.searchEngineContainer, pluginName: 'airHotelSearchEngine' };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }

        function _showTourSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.tour.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.tour.searchEngineContainer, pluginName: 'tourSearchEngine' };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }

        function _showInsuranceSearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.insurance.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.insurance.searchEngineContainer, pluginName: 'insuranceSearchEngine' };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }

        function _showItinerarySearchEnginePlugin() {
            _hideSearchEnginesContainers();
            settings.components.itinerary.searchEngineContainer.show();
            var auxFunction = _getConsumersTotals;
            lastPluginData = $.extend(false, lastPluginData, thisSearchEngine.getGenericData(auxFunction));
            currentPluginSelected = { contextPlugin: settings.components.itinerary.searchEngineContainer, pluginName: 'itinerarySearchEngine' };

            if (settings.updateValuesOnChangeSE)
                thisSearchEngine.updateValues(lastPluginData);

            _afterShowPlugin();
        }

        function _afterShowPlugin() {
            _clearMessagesExhibitor();
        }

        function _hideSearchEnginesContainers() {
            for (var settingsComponent in settings.components) {
                if (settings.components[settingsComponent].hasOwnProperty('searchEngineContainer'))
                    settings.components[settingsComponent].searchEngineContainer.hide();
            }
        }

        function _selectComponents() {
            Util.SelectComponents(settings.components, component, true);
        }

        function _dettachEvents() { }

        function _attachEvents() {
            _dettachEvents();
        }

        function _getConsumersTotals(extConsumerGroup) {
            var obj = undefined;
            var consumerGroups = !extConsumerGroup ? this.ConsumerGroups : extConsumerGroup;

            if (consumerGroups && consumerGroups.length) {
                obj = {
                    Adults: 0,
                    Babies: 0,
                    Childrens: 0
                };
                for (var i = 0; i < consumerGroups.length; i++) {
                    obj.Adults += parseInt(consumerGroups[i].Adults);

                    if (consumerGroups[i].ChildAges.length) {
                        var babies = consumerGroups[i].ChildAges.where(function (age) { return parseInt(age) < 2 }).length;
                        obj.Babies += babies;
                        obj.Childrens += consumerGroups[i].ChildAges.length - babies;
                    }
                }

            }

            return obj;
        }

        function _getConsumerSummaryGrouped() {
            var obj = [];
            var consumerSummaryGrouped = {};
            var consumerSummary = this.ConsumerSummary;

            if (consumerSummary) {
                consumerSummaryGrouped.Adults = consumerSummary.Adults.toString();
                consumerSummaryGrouped.ChildAges = [];

                for (var i = 0; i < consumerSummary.Childrens; i++)
                    consumerSummaryGrouped.ChildAges.push("2");

                for (var i = 0; i < consumerSummary.Babies; i++)
                    consumerSummaryGrouped.ChildAges.push("1");

                obj.push(consumerSummaryGrouped);
            }


            return obj;
        }

        function _getConsumerGroupsTotals() {
            var obj = [];
            var consumerGroupsTotals = {};
            var consumerGroups = this.ConsumerGroups;

            if (consumerGroups) {
                consumerGroupsTotals.Adults = 0;
                consumerGroupsTotals.ChildAges = [];

                consumerGroups.forEach(function (c) {
                    consumerGroupsTotals.Adults += parseInt(c.Adults);
                    consumerGroupsTotals.ChildAges = $.merge(consumerGroupsTotals.ChildAges, c.ChildAges);
                });
            }
            return [consumerGroupsTotals];
        }

        function _clearMessagesExhibitor() {
            component.find("#messages").click();
        }

        this.changeAirSearchType = function (newSearchType) {
            settings.components.air.searchEngineContainer.airSearchEngine("changeSearchType", newSearchType);
        };

        this.changeBusSearchType = function (newSearchType) {
            settings.components.bus.searchEngineContainer.busSearchEngine("changeSearchType", newSearchType);
        };
    }

    $.fn.searchEngine = function () {
        return Util.pluginDefaultBehavior(this, "searchEngine", arguments, function () { return new SearchEngine(); });
    }

})(jQuery);


ï»¿if (typeof (PageManager) === 'undefined') {
    PageManager = typeof pageManager !== 'undefined' ? new pageManager() : {};
}

(function ($) {
    PageManager.SearcEngine = function (component) {
        var settings = {
            properties: {
                products: {
                    air: true,
                    bus: true,
                    hotel: true,
                    service: true,
                    tour: true
                }
            },
            components: {
                searchEngineContainer: '#searchEngine',
                btnSendSearch: '#btnSearch',
                typeButtons: '.searchEngineSel',
                ddlQtdChildrens: '.childrensQtdRoom',
                txtHotelCity: '#txtLocation',
                outBoundDateGo: '.txtInboundDateBack',
                inBoundDateBack: '.txtOutboundDateGo',
                textInputs: '.autocomplete_completed, .autocomplete_empty'
            }
        };

        var _searchTypeCaptalized = {
            'AIR': 'Air',
            'BUS': 'Bus',
            'HOTEL': 'Hotel',
            'SERVICE': 'Service',
            'PACKAGE': 'Package',
            'DYNAMICPACKAGE': 'DynamicPackage',
            'TOUR': 'Tour',
            'MAP': 'Map',
            'CALENDAR': 'Calendar',
            'CRUISE': 'Cruise'
        };

        var _events = {
            components: {
                changeSearchEngineType: function (event) {
                    event.preventDefault();
                    if (Global.SearchType)
                        settings.components.searchEngineContainer.removeClass(Global.SearchType.toLowerCase());

                    Global.SearchType = $(this).attr("searchEngineType");
                    _functions.initialize();

                    settings.components.typeButtons.removeClass('active')
                        .filter('[searchEngineType="' + Global.SearchType + '"]').addClass('active');

                },
                changeChildrenCount: function () {
                    var ctrl = $(this);

                    var quantity = Util.GetComponentValue(ctrl);

                    var ctrlChildAges = ctrl.parent().siblings('.child-ages');

                    ctrlChildAges.addClass('hide');

                    if (quantity > 0)
                        ctrlChildAges.removeClass('hide');

                    var childrensComponents = ctrlChildAges.find('label');

                    childrensComponents.addClass('hide');

                    for (var i = 0; i < quantity; i++)
                        childrensComponents.eq(i).removeClass('hide');
                },
                sendSearch: function (e) {

                    var _thisSender = $(this);

                    e.preventDefault();

                    if ($(settings.components.txtHotelCity).val() == "Digite a cidade do hotel")
                        $(settings.components.txtHotelCity).val("");

                    var compSearchEngine = $(settings.components.searchEngineContainer);
                    if (compSearchEngine.searchEngine("validate")) {
                        var data = compSearchEngine.searchEngine("getData");

                        if (data && data.Hotel && data.Hotel.LocationData.t == "10") {

                            var codes = data.Hotel.LocationData.co.split('|');

                            var hotel = {
                                Name: data.Hotel.LocationData.n,
                                HotelBrokers: [
                                    { Key: 'HotelOffline', Value: codes[0] }
                                ],
                                Address: { LocationId: codes[1] },
                                RoomsGroups: [],
                                Services: []
                            };

                            HotelExtensions.Hotel(hotel);

                            var url = hotel.getHotelDetailPageUrl(data, Global.ShortCodeParameters.preferhoteloffline);
                            Global.InterfaceEnvelope.backByQueryString = true;

                            TravelGo.Functions.ContinueForm.RedirectTo(Global.ShortCodeParameters.hotelurl + url, '_blank');
                        }
                        else {
                            var pageUrl = _events.components.getMasterPricerUrl(_thisSender.attr('page'));
                            var pageUrlWithParameters = compSearchEngine.searchEngine("getQueryString", pageUrl);

                            var queryStringCampain = _functions.getUrlComplementCampaign();

                            pageUrlWithParameters += queryStringCampain;

                            var additionalParameters = _functions.getAdditionalSearchParameters();
                            if (additionalParameters)
                                pageUrlWithParameters += additionalParameters;

                            _events.components.tryCloseDialog();
                            TravelGo.Functions.ContinueForm.SetAction(pageUrlWithParameters);
                            var submitFormFunction = _functions.setupSubmitSearchEngineFunction();
                            submitFormFunction();
                        }
                    }
                },
                tryCloseDialog: function () {
                    try {
                        compSearchEngine.dialog('close');
                    } catch (e) { }
                },
                getMasterPricerUrl: function (destinationPage) {
                    var pageUrl = Global.ShortCodeParameters.transactionalurl;

                    if (pageUrl == undefined || !pageUrl.length)
                        pageUrl = window.location.toString().replace(window.location.search, '');
                    else
                        pageUrl += 'masterpricer';

                    if (destinationPage == 'calendar')
                        pageUrl = Global.ShortCodeParameters.calendarurl;

                    if (destinationPage == 'map')
                        pageUrl = Global.ShortCodeParameters.mapurl;

                    return pageUrl;
                },
                clearVal: function () {
                    $(this).val('');
                },
                selectText: function () {
                    $(this).select();
                }
            },
            controllers: {
                onIncludeProduct: function (productType) {
                    settings.properties.products[productType] = true;
                    Global.SearchType = "DynamicPackage";

                    var data = settings.components.searchEngineContainer.searchEngine("getData");
                    _functions.initialize();
                    settings.components.searchEngineContainer.searchEngine("fillValues", data);
                    settings.components.searchEngineContainer.dialog({
                        width: 470,
                        open: function () {
                            settings.components.searchEngineContainer.removeClass('research').addClass('search_engine');
                        },
                        close: function () {
                            settings.components.searchEngineContainer.destroyDialog();
                            _events.controllers.onRemoveProduct(productType);
                            settings.components.searchEngineContainer.removeClass('search_engine').addClass('research');
                        },
                        modal: true,
                        create: function (event, ui) {
                            $(event.target).closest('.ui-dialog').css('position', 'absolute');
                        }
                    });
                },
                onRemoveProduct: function (productType) {
                    //settings.properties.products[productType] = false;
                    Global.SearchType = "DynamicPackage";

                    var data = settings.components.searchEngineContainer.searchEngine("getData");
                    _functions.initialize();
                    settings.components.searchEngineContainer.searchEngine("fillValues", data);
                }
            },
            afterInitialize: function (settings) {
                if (settings.components.air) {
                    $(document).off("paste copy cut", settings.components.air.inboundDate.selector).on("paste copy cut", settings.components.air.inboundDate.selector, function () { return false; });
                    $(document).off("paste copy cut", settings.components.air.outboundDate.selector).on("paste copy cut", settings.components.air.outboundDate.selector, function () { return false; });
                    
                }

                if (settings.components.bus) {
                    $(document).off("paste copy cut", settings.components.bus.inboundDate.selector).on("paste copy cut", settings.components.bus.inboundDate.selector, function () { return false; });
                    $(document).off("paste copy cut", settings.components.bus.outboundDate.selector).on("paste copy cut", settings.components.bus.outboundDate.selector, function () { return false; });

                }

                if (settings.components.hotel) {
                    settings.components.hotel.checkIn.bind("paste copy cut", function () { return false; });
                    settings.components.hotel.checkOut.bind("paste copy cut", function () { return false; });
                }
            }
        };

        var _functions = {
            settings: {
                getSettingBool: function (settingName) {
                    var settingValue = undefined;

                    if (settingName) {
                        if (typeof (TravelGo.Util) != 'undefined') {
                            settingValue = TravelGo.Util.GetSettingBool(settingName);
                        } else if (Global.Settings && Global.Settings[settingName]) {
                            settingValue = (Global.Settings[settingName].toUpperCase().trim() === "TRUE");
                        }
                    }

                    return settingValue;
                },
                getSettingInt: function (settingName) {
                    var settingValue = undefined;

                    if (settingName) {
                        if (typeof (TravelGo.Util) != 'undefined') {
                            settingValue = TravelGo.Util.GetSettingInt(settingName);
                        } else if (Global.Settings && Global.Settings[settingName] && !isNaN(Global.Settings[settingName])) {
                            settingValue = parseInt(Global.Settings[settingName]);
                        }
                    }

                    return settingValue;
                },
                getSetting: function (settingName) {
                    var settingValue = undefined;

                    if (settingName) {
                        if (typeof (TravelGo.Util) != 'undefined') {
                            settingValue = TravelGo.Util.GetSetting(settingName);
                        } else if (Global.Settings && Global.Settings[settingName]) {
                            settingValue = Global.Settings[settingName];
                        }
                    }

                    return settingValue;
                },
            },
            passengers: {
                getMaxPassengers: function () {
                    var maxPassengerQtd = _functions.settings.getSettingInt("Travelgo.Validation.MaxPassengerQtd");
                    var mandatoryLoginSetting = _functions.settings.getSetting("Travelgo.Validation.MandatoryUserLogin");
                    var isLoginMandatory = mandatoryLoginSetting && !mandatoryLoginSetting.toUpperCase().trim() === 'NO';
                    var passengerMustBeAuthenticatedUser = isLoginMandatory && _functions.settings.getSettingBool("Travelgo.Checkout.PassengerMustBeAuthenticatedUser");

                    if (passengerMustBeAuthenticatedUser)
                        return 1;

                    if (maxPassengerQtd < 0
                        && Global.ShortCodeParameters.max_passengers
                        && !isNaN(Global.ShortCodeParameters.max_passengers)) {
                        maxPassengerQtd = parseInt(Global.ShortCodeParameters.max_passengers);
                    }

                    return maxPassengerQtd <= 0 ? 9 : maxPassengerQtd;
                },
                getPassengerSettings: function () {
                    var maxPassengers = _functions.passengers.getMaxPassengers();
                    var maxIndex = maxPassengers + 1;

                    return {
                        maxPassengers: maxPassengers,
                        maxAdults: Util.MinValue([9, maxIndex]),
                        maxChildren: Util.MinValue([8, maxIndex]),
                        maxBabies: Util.MinValue([4, maxIndex]),
                    };
                }
            },
            plugins: {
                options: {
                    base: function (initialSearchType, template) {
                        return {
                            template: SearchEngineTPL,
                            defaultSearchEngine: initialSearchType,
                            hotel: false,
                            airHotel: false,
                            car: false,
                            service: false,
                            air: false,
                            bus: false,
                            cruise: false,
                            dynamicPackage: false,
                            package: false,
                            tour: false,
                            insurance: false,
                            map: false,
                            calendar: false,
                            tplName: template,
                            searchType: 1,
                            controllers: {
                                messagesController: Global.MessagesController,
                                locationsController: Global.LocationsController
                            },
                            components: {},
                            plugins: {}
                        };
                    },
                    air: function () {
                        var passengersConfig = _functions.passengers.getPassengerSettings();

                        return {
                            options: {
                                template: AirSearchEngineTPL,
                                controllers: {
                                    locationsController: Global.LocationsController,
                                    messagesController: Global.MessagesController
                                },
                                components: {
                                    air: {
                                        searchEngineContainer: '.content.flight',
                                        inboundDate: settings.components.outBoundDateGo,
                                        outboundDate: settings.components.inBoundDateBack,
                                        destinationDiv: '.destinationContainer',
                                        adults: '#drpAdultsQtd',
                                        children: '#drpChildrenQtd',
                                        babies: '#drpBabiesQtd',
                                        nonStop: '#chkNonStop',
                                        oneWay: '#chkOneWay',
                                        roundTrip: '#chkRoundTrip',
                                        ciaCode: '#drpCiaCode',
                                        cabinType: '#drpCabin',
                                    }
                                },
                                validateMaxSearchDaysFromCheckinDate: true,
                                minDaysToSearch: _functions.getMinDaysToSearch(EnumHelper.ProductTypeName.Air),
                                maxDaysToSearch: SharedFunctions.ResolveSearchRange.MaxDays(EnumHelper.ProductTypeName.Air),
                                maxSearchDays: SharedFunctions.ResolveSearchRange.MaxDays(EnumHelper.ProductTypeName.Air),
                                searchType: 1,
                                minPeriodToSearch: 0,
                                exhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Alert,
                                anotheDatePickersOption: {
                                    minDate: _functions.getMinDaysToSearch(EnumHelper.ProductTypeName.Air) || 1
                                },
                                events: {
                                    afterInitialize: _events.afterInitialize
                                },
                                maxPassengers: passengersConfig.maxPassengers,
                                maxChildren: passengersConfig.maxChildren,
                                maxBabies: passengersConfig.maxBabies,
                                maxAdults: passengersConfig.maxAdults,
                                validateAirRulesOnChange: true,
                                calcCheckoutMaxDateFromToday: true,
                                validateNeedMoreAdultsThanInfants: true,
                                defaultOriginId: Global.ShortCodeParameters.defaultoriginid,
                                defaultDestinationId: Global.ShortCodeParameters.defaultdestinationid,
                                defaultOutboundDate: Global.ShortCodeParameters.defaultcheckin,
                                defaultInboundDate: Global.ShortCodeParameters.defaultcheckout,
                                lockDestination: Global.ShortCodeParameters.lockdestination,
                                lockOrigin: Global.ShortCodeParameters.lockorigin,
                                lockCheckin: Global.ShortCodeParameters.lockcheckin,
                                lockCheckout: Global.ShortCodeParameters.lockcheckout,
                                useBrowserGeoLocation: Global.ShortCodeParameters.searchmotor_get_client_location == 'true',
                                defaultAirCia: Global.ShortCodeParameters.defaultaircia,
                                lockAirCia: Global.ShortCodeParameters.lockaircia,
                                loadProximities: Global.Settings && Global.Settings['PesqInc.LoadProximities'] && Global.Settings['PesqInc.LoadProximities'].toLowerCase() == 'true',
                                mobile: Global.Mobile,
                                versionSearchEngine: Global.ShortCodeParameters.versionSearchEngine,
                                useScrollOnPesqInc: true,
                                maxPassengerQtd: {
                                    passengerDropDowns: [
                                        { dropDownClass: 'air_drpAdultsQtd', maxValueOption: passengersConfig.maxAdults, minValueOption: 1, isHotelRoom: false },
                                        { dropDownClass: 'air_drpChildrenQtd', maxValueOption: passengersConfig.maxChildren, minValueOption: 0, isHotelRoom: false },
                                        { dropDownClass: 'air_drpBabiesQtd', maxValueOption: passengersConfig.maxBabies, minValueOption: 0, isHotelRoom: false },
                                    ],
                                    maxPassengerQtdSettingValue: passengersConfig.maxPassengers,
                                }
                            }
                        };
                    },
                    bus: function () {
                        return {
                            options: {
                                template: BusSearchEngineTPL,
                                controllers: {
                                    locationsController: Global.LocationsController,
                                    messagesController: Global.MessagesController
                                },
                                components: {
                                    bus: {
                                        searchEngineContainer: '.content.bus',
                                        inboundDate: settings.components.outBoundDateGo,
                                        outboundDate: settings.components.inBoundDateBack,
                                        destinationDiv: '.destinationContainer',
                                        oneWay: '#chkOneWay',
                                        roundTrip: '#chkRoundTrip'
                                    }
                                },
                                validateMaxSearchDaysFromCheckinDate: true,
                                minDaysToSearch: _functions.getMinDaysToSearch(EnumHelper.ProductTypeName.Bus),
                                maxDaysToSearch: SharedFunctions.ResolveSearchRange.MaxDays(EnumHelper.ProductTypeName.Bus),
                                maxSearchDays: SharedFunctions.ResolveSearchRange.MaxDays(EnumHelper.ProductTypeName.Bus),
                                searchType: 1,
                                minPeriodToSearch: 0,
                                exhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Alert,
                                anotheDatePickersOption: {
                                    minDate: _functions.getMinDaysToSearch(EnumHelper.ProductTypeName.Bus) || 1
                                },
                                events: {
                                    afterInitialize: _events.afterInitialize
                                },
                                validateAirRulesOnChange: true,
                                calcCheckoutMaxDateFromToday: true,
                                //validateNeedMoreAdultsThanInfants: true,
                                defaultOriginId: Global.ShortCodeParameters.defaultoriginid,
                                defaultDestinationId: Global.ShortCodeParameters.defaultdestinationid,
                                defaultOutboundDate: Global.ShortCodeParameters.defaultcheckin,
                                defaultInboundDate: Global.ShortCodeParameters.defaultcheckout,
                                lockDestination: Global.ShortCodeParameters.lockdestination,
                                lockOrigin: Global.ShortCodeParameters.lockorigin,
                                lockCheckin: Global.ShortCodeParameters.lockcheckin,
                                lockCheckout: Global.ShortCodeParameters.lockcheckout,
                                useBrowserGeoLocation: Global.ShortCodeParameters.searchmotor_get_client_location == 'true',
                                loadProximities: Global.Settings && Global.Settings['PesqInc.LoadProximities'] && Global.Settings['PesqInc.LoadProximities'].toLowerCase() == 'true',
                                mobile: Global.Mobile,
                                versionSearchEngine: Global.ShortCodeParameters.versionSearchEngine,
                                useScrollOnPesqInc: true
                            }
                        };
                    },
                    hotel: function () {
                        var passengersConfig = _functions.passengers.getPassengerSettings();

                        return {
                            options: {
                                template: HotelSearchEngineTPL,
                                templateOptions: {
                                    roomsQtd: 1,
                                    roomIndex: 0,
                                    maxGuestQuantities: passengersConfig.maxAdults,
                                    maxGuestChildrenQuantities: passengersConfig.maxChildren,
                                },
                                controllers: {
                                    locationsController: Global.LocationsController,
                                    messagesController: Global.MessagesController
                                },
                                components: {
                                    hotel: {
                                        location: '#txtLocation',
                                        checkIn: '#txtCheckIn',
                                        checkOut: '#txtCheckOut',
                                        rooms: '#drpRoomsQtd',
                                        childrenAgeQntd: '.childrensQtdRoom'
                                    }
                                },
                                componentsOptions: {
                                    childreenAgesSiblingsClass: '.roomChildAges'
                                },
                                useMinDaysToSearchToCheckout: false,
                                minDaysToSearch: _functions.getMinDaysToSearch(EnumHelper.ProductTypeName.Hotel),
                                maxDaysToSearch: SharedFunctions.ResolveSearchRange.MaxDays(EnumHelper.ProductTypeName.Hotel),
                                maxPeriodToSearch: SharedFunctions.ResolveSearchRange.MaxDays(EnumHelper.ProductTypeName.Hotel),
                                maxSearchDays: SharedFunctions.ResolveSearchRange.MaxDays(EnumHelper.ProductTypeName.Hotel),
                                searchType: 3,
                                exhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Alert,
                                events: {
                                    displayChildrenAges: function () { },
                                    afterInitialize: _events.afterInitialize
                                },
                                maxGuestQuantities: 5,
                                maxGuestChildrenQuantities: 4,
                                calcCheckoutMaxDateFromToday: true,
                                validateNeedMoreAdultsThanInfants: true,
                                defaultDestinationId: Global.ShortCodeParameters.defaultdestinationid,
                                defaultCheckIn: Global.ShortCodeParameters.defaultcheckin,
                                defaultCheckOut: Global.ShortCodeParameters.defaultcheckout,
                                lockDestination: Global.ShortCodeParameters.lockdestination,
                                lockOrigin: Global.ShortCodeParameters.lockorigin,
                                lockCheckin: Global.ShortCodeParameters.lockcheckin,
                                lockCheckout: Global.ShortCodeParameters.lockcheckout,
                                defaultHotelName: Global.ShortCodeParameters.defaulthotelname,
                                lockHotelName: Global.ShortCodeParameters.lockhotelname,
                                mobile: Global.Mobile,
                                versionSearchEngine: Global.ShortCodeParameters.versionSearchEngine,
                                maxPassengers: passengersConfig.maxPassengers,
                                useScrollOnPesqInc: true,
                                maxPassengerQtd: {
                                    passengerDropDowns: [
                                        { dropDownClass: 'hotel_drpRoomsQtd', maxValueOption: 3, minValueOption: 1, isHotelRoom: true },
                                        { dropDownClass: 'hotel_drpAdults', maxValueOption: passengersConfig.maxAdults, minValueOption: 1, isHotelRoom: false },
                                        { dropDownClass: 'hotel_childrensQtdRoom', maxValueOption: passengersConfig.maxChildren, minValueOption: 0, isHotelRoom: false },
                                    ],
                                    maxPassengerQtdSettingValue: passengersConfig.maxPassengers,
                                }
                            }
                        };
                    },
                    service: function () {
                        return {
                            options: {
                                controllers: {
                                    locationsController: Global.LocationsController,
                                    messagesController: Global.MessagesController,
                                    searchController: Global.SearchController
                                },
                                templates: {
                                    toolbar: ServiceSearchEngineTPL,
                                    categories: ServiceSearchEngineCategoriesTPL,
                                    blacklistCategories: ServiceSearchEngineBlackListCategoriesTPL,
                                    passengersAges: ServiceSearchEnginePassengersAgesTPL
                                },
                                components: {
                                    passengerAge: '.passenger-age',
                                    serviceName: ".txtServiceName"
                                },
                                validateMaxSearchDaysFromCheckinDate: true,
                                minDaysToSearch: _functions.getMinDaysToSearch(EnumHelper.ProductTypeName.Service),
                                maxDaysToSearch: SharedFunctions.ResolveSearchRange.MaxDays(EnumHelper.ProductTypeName.Service),
                                exhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Alert,
                                calcCheckoutMaxDateFromToday: true,
                                defaultDestinationId: Global.ShortCodeParameters.defaultdestinationid,
                                defaultInitialDate: Global.ShortCodeParameters.defaultcheckin,
                                defaultFinalDate: Global.ShortCodeParameters.defaultcheckout,
                                validatePassengerAges: false,
                                lockDestination: Global.ShortCodeParameters.lockdestination,
                                lockOrigin: Global.ShortCodeParameters.lockorigin,
                                lockCheckin: Global.ShortCodeParameters.lockcheckin,
                                lockCheckout: Global.ShortCodeParameters.lockcheckout,
                                mobile: Global.Mobile,
                                versionSearchEngine: Global.ShortCodeParameters.versionSearchEngine,
                                enableSearchByName: (Global.ShortCodeParameters['Search.Service.EnableSearchByName'] === 'true'),
                                useScrollOnPesqInc: true,
                        }
                        };
                    },
                    'package': function () {
                        var _options = {
                            options: {
                                templates: {
                                    passengersAges: SearchEngine.PassengersAges,
                                    packageRoom: SearchEngine.packageRoom
                                },
                                template: PackageSearchEngineTPL,
                                templateOptions: {
                                    showDateInDatePicker: true
                                },
                                components: {
                                    passengerAge: '.passenger-age',
                                    name: ".txtPackageName"
                                },
                                controllers: {
                                    locationsController: Global.LocationsController,
                                    messagesController: Global.MessagesController,
                                    searchController: Global.SearchController //,
                                    //companyContextController: Global.CompanyContextController
                                },
                                locationsFinderRecordStep: false,
                                searchType: 3,
                                data: {
                                    minSearchDays: _functions.getMinDaysToSearch(EnumHelper.ProductTypeName.HybridPackage),
                                    maxSearchDays: SharedFunctions.ResolveSearchRange.MaxDays(EnumHelper.ProductTypeName.HybridPackage),
                                },
                                anotheDatePickersOption: {
                                    minDate: SharedFunctions.ResolveSearchRange.MinDays(EnumHelper.ProductTypeName.HybridPackage) || 1
                                },
                                maxGuestQuantities: 9,
                                maxGuestChildrenQuantities: 8,
                                validateAirRulesOnChange: true,
                                calcCheckoutMaxDateFromToday: true,
                                validateNeedMoreAdultsThanInfants: true,
                                exhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Alert,
                                maxRoomsRequest: 3,
                                defaultOriginId: Global.ShortCodeParameters.defaultoriginid,
                                defaultDestinationId: Global.ShortCodeParameters.defaultdestinationid,
                                defaultInitialDate: Global.ShortCodeParameters.defaultcheckin,
                                defaultFinalDate: Global.ShortCodeParameters.defaultcheckout,
                                lockDestination: Global.ShortCodeParameters.lockdestination,
                                lockOrigin: Global.ShortCodeParameters.lockorigin,
                                lockCheckin: Global.ShortCodeParameters.lockcheckin,
                                lockCheckout: Global.ShortCodeParameters.lockcheckout,
                                loadProximities: Global.Settings && Global.Settings['PesqInc.LoadProximities'] && Global.Settings['PesqInc.LoadProximities'].toLowerCase() == 'true',
                                mobile: Global.Mobile,
                                versionSearchEngine: Global.ShortCodeParameters.versionSearchEngine,
                                enableSearchByName: (Global.ShortCodeParameters['Search.Package.EnableSearchByName'] === 'true'),
                                useScrollOnPesqInc: true,
                            }
                        };

                        var salesFlowVersion = Util.GetSetting("HybridPackage.SalesFlowVersion") || Util.GetShortCodeParameter("hybridpackage_salesflowversion");

                        if (salesFlowVersion)
                            _options.options.salesFlowVersion = salesFlowVersion;

                        if (_options.options.salesFlowVersion == EnumHelper.HybridPackageSalesFlowVersion.Two) {
                            _options.options.inferPaxes = true;
                            _options.options.defaultPassengersData = CommonFunctions.ResolveDefaultHybridPackagePassengers();
                        }

                        return _options;
                    },
                    dynamicPackage: function () {
                        var passengersConfig = _functions.passengers.getPassengerSettings();

                        return {
                            options: {
                                template: DynamicPackageSearchEngineTPL,
                                controllers: {
                                    locationsController: Global.LocationsController,
                                    messagesController: Global.MessagesController,
                                    searchController: Global.SearchController
                                },
                                templates: {
                                    categories: ServiceSearchEngineCategoriesTPL
                                },
                                useMinDaysToSearchToCheckout: false,
                                simpleService: Global.ShortCodeParameters['simpleservice'] && JSON.parse(Global.ShortCodeParameters['simpleservice']),
                                products: settings.properties.products,
                                validateMaxSearchDaysFromCheckinDate: true,
                                minSearchDays: _functions.getMinDaysToSearch(EnumHelper.ProductTypeName.DynamicPackage),
                                maxSearchDays: SharedFunctions.ResolveSearchRange.MaxDays(EnumHelper.ProductTypeName.DynamicPackage),
                                exhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Alert,
                                maxPassengers: passengersConfig.maxPassengers,
                                defaultOriginId: Global.ShortCodeParameters.defaultoriginid,
                                defaultDestinationId: Global.ShortCodeParameters.defaultdestinationid,
                                defaultStartDate: Global.ShortCodeParameters.defaultcheckin,
                                defaultEndDate: Global.ShortCodeParameters.defaultcheckout,
                                lockDestination: Global.ShortCodeParameters.lockdestination,
                                lockOrigin: Global.ShortCodeParameters.lockorigin,
                                lockCheckin: Global.ShortCodeParameters.lockcheckin,
                                lockCheckout: Global.ShortCodeParameters.lockcheckout,
                                limitMinCheckin: Global.ShortCodeParameters.limitmincheckin,
                                limitMaxCheckin: Global.ShortCodeParameters.limitmaxcheckin,
                                limitMinCheckout: Global.ShortCodeParameters.limitmincheckout,
                                limitMaxCheckout: Global.ShortCodeParameters.limitmaxcheckout,
                                suppressGetServiceCategories: Global.ShortCodeParameters.suppressgetservicecategories,
                                loadProximities: Global.Settings && Global.Settings['PesqInc.LoadProximities'] && Global.Settings['PesqInc.LoadProximities'].toLowerCase() == 'true',
                                mobile: Global.Mobile,
                                versionSearchEngine: Global.ShortCodeParameters.versionSearchEngine,
                                useScrollOnPesqInc: true,
                            }
                        };
                    },
                    tour: function () {
                        var passengersConfig = _functions.passengers.getPassengerSettings();

                        return {
                            options: {
                                controllers: {
                                    locationsController: Global.LocationsController,
                                    messagesController: Global.MessagesController,
                                    searchController: Global.SearchController
                                },
                                templates: {
                                    toolbar: TourSearchEngineTPL,
                                    passengersAges: SearchEngine.PassengersAges,
                                    tourRoom: SearchEngine.tourRoom
                                },
                                components: {
                                    passengerAge: '.passenger-age',
                                    tourName: ".txtTourName"
                                },
                                validateMaxSearchDaysFromCheckinDate: true,
                                minDaysToSearch: _functions.getMinDaysToSearch(EnumHelper.ProductTypeName.Tour),
                                maxDaysToSearch: SharedFunctions.ResolveSearchRange.MaxDays(EnumHelper.ProductTypeName.Tour),
                                exhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Alert,
                                calcCheckoutMaxDateFromToday: true,
                                defaultDestinationId: Global.ShortCodeParameters.defaultdestinationid,
                                defaultInitialDate: Global.ShortCodeParameters.defaultcheckin,
                                defaultFinalDate: Global.ShortCodeParameters.defaultcheckout,
                                validatePassengerAges: false,
                                lockDestination: Global.ShortCodeParameters.lockdestination,
                                lockOrigin: Global.ShortCodeParameters.lockorigin,
                                lockCheckin: Global.ShortCodeParameters.lockcheckin,
                                lockCheckout: Global.ShortCodeParameters.lockcheckout,
                                mobile: Global.Mobile,
                                versionSearchEngine: Global.ShortCodeParameters.versionSearchEngine,
                                enableSearchByName: (Global.ShortCodeParameters['Search.Tour.EnableSearchByName'] === 'true'),
                                maxPassengers: passengersConfig.maxPassengers,
                                useScrollOnPesqInc: true,
                                maxPassengerQtd: {
                                    passengerDropDowns: [
                                        { dropDownClass: 'cboTourPassengers', maxValueOption: passengersConfig.maxPassengers, minValueOption: 1, isHotelRoom: false },
                                    ],
                                    maxPassengerQtdSettingValue: passengersConfig.maxPassengers,
                                }
                            }
                        };
                    },
                    insurance: function () {
                        return {
                            options: {
                                controllers: {
                                    locationsController: Global.LocationsController,
                                    messagesController: Global.MessagesController,
                                    searchController: Global.SearchController
                                },
                                template: InsuranceSearchEngineTPL,
                                components: {}
                            }
                        }
                    },
                    calendar: function () {
                        return {
                            options: {
                                controllers: {
                                    locationsController: Global.LocationsController,
                                    messagesController: Global.MessagesController,
                                    searchController: Global.SearchController
                                },
                                template: CalendarSearchEngineTPL,
                                components: {}
                            }
                        }
                    },
                    map: function () {
                        return {
                            options: {
                                controllers: {
                                    locationsController: Global.LocationsController,
                                    messagesController: Global.MessagesController,
                                    searchController: Global.SearchController
                                },
                                template: MapSearchEngineTPL,
                                components: {}
                            }
                        }
                    },
                    cruise: function () {
                        return {
                            options: {
                                controllers: {
                                    locationsController: Global.LocationsController,
                                    messagesController: Global.MessagesController,
                                    searchController: Global.SearchController
                                },
                                template: CruiseSearchEngineTPL,
                                components: {}
                            }
                        }
                    }
                },
                components: {
                    air: {
                        searchEngineContainer: '.content.flight',
                    },
                    bus: {
                        searchEngineContainer: '.content.bus',
                    },
                    hotel: {
                        searchEngineContainer: '.content.hotel',
                    },
                    service: {
                        searchEngineContainer: '.content.service'
                    },
                    'package': {
                        searchEngineContainer: '.content.package'
                    },
                    dynamicPackage: {
                        searchEngineContainer: '.content.dynamicpackage'
                    },
                    tour: {
                        searchEngineContainer: '.content.tour'
                    },
                    insurance: {
                        searchEngineContainer: '.content.insurance'
                    },
                    map: {
                        searchEngineContainer: '.content.map'
                    },
                    calendar: {
                        searchEngineContainer: '.content.calendar'
                    },
                    cruise: {
                        searchEngineContainer: '.content.cruise'
                    }
                }
            },
            productsConfiguredByQueryString: function () {
                return Util.QueryString("SearchType") == 'DynamicPackage';
            },
            configureProductsByQueryString: function () {
                if (Util.QueryString("Air") == "true")
                    settings.properties.products.air = true;
                else
                    settings.properties.products.air = false;

                if (Util.QueryString("Bus") == "true")
                    settings.properties.products.bus = true;
                else
                    settings.properties.products.bus = false;

                if (Util.QueryString("Hotel") == "true")
                    settings.properties.products.hotel = true;
                else
                    settings.properties.products.hotel = false;

                if (Util.QueryString("Service") == "true" || Global.ShortCodeParameters['simpleservice'] && JSON.parse(Global.ShortCodeParameters['simpleservice']))
                    settings.properties.products.service = true;
                else
                    settings.properties.products.service = false;

                if (Util.QueryString("Tour") == "true")
                    settings.properties.products.tour = true;
                else
                    settings.properties.products.tour = false;

                if (!settings.properties.products.air && !settings.properties.products.hotel && !settings.properties.products.service) {
                    settings.properties.products.air = settings.properties.products.hotel = settings.properties.products.service = true;
                }
            },
            configureProductsByShortCodeParameter: function () {
                var products = Global.ShortCodeParameters['searchmotor_dynamic_products'].toLowerCase().split("_");
                settings.properties.products.air = products.contains('air');
                settings.properties.products.bus = products.contains('bus');
                settings.properties.products.hotel = products.contains('hotel');
                settings.properties.products.service = products.contains('service');
                settings.properties.products.tour = products.contains('tour');
            },
            configureVisualization: function () {
                if (settings.components.searchEngineContainer.attr('isMasterPricer'))
                    Global.ShortCodeParameters.isMasterPricer = JSON.parse(settings.components.searchEngineContainer.attr('isMasterPricer'));

                Global.isMasterPricer = JSON.parse(Global.ShortCodeParameters.isMasterPricer);
                if (Global.isMasterPricer)
                    settings.components.searchEngineContainer.addClass('research');
                else
                    settings.components.searchEngineContainer.addClass('search_engine');
            },
            getFirstInteger: function (stringArray) {
                var integer = 0;
                for (var i = 0; i < stringArray.length; i++) {
                    if (!isNaN(parseInt(stringArray[i]))) {
                        integer = parseInt(stringArray[i]);
                        break;
                    }
                }

                return integer;
            },
            getDefaultDateInDays: function (defaultDate) {
                var moredays = 0;
                if (defaultDate && !defaultDate.replaceAll('-', '/').toDateValues().isValid) {
                    if (defaultDate.contains('today')) {
                        var properties = defaultDate.split(';');

                        $.each(properties, function () {
                            if (this.contains('days'))
                                moredays = _functions.getFirstInteger(this.split('+'));
                        });
                    }
                } else {
                    moredays = parseInt((new Date()).untilInDays(defaultDate.toDateTime()));
                }

                return moredays;
            },
            calculateDefaultDate: function (defaultDate) {
                if (defaultDate && !defaultDate.replaceAll('-', '/').toDateValues().isValid) {
                    if (defaultDate.contains('today')) {
                        var properties = defaultDate.split(';');
                        var moredays = 0;

                        $.each(properties, function () {
                            if (this.contains('days'))
                                moredays = _functions.getFirstInteger(this.split('+'));
                        });

                        var now = (new Date()).addDays(moredays);
                        defaultDate = formatter.dateValuesShort(now.toDateValues());
                    }
                }

                return defaultDate.replaceAll('-', '/');
            },
            calculateDefaultDates: function () {
                if (Global.ShortCodeParameters.defaultcheckin) {
                    Global.ShortCodeParameters.defaultcheckinindays = _functions.getDefaultDateInDays(Global.ShortCodeParameters.defaultcheckin);
                    Global.ShortCodeParameters.defaultcheckin = _functions.calculateDefaultDate(Global.ShortCodeParameters.defaultcheckin);
                }

                if (Global.ShortCodeParameters.defaultcheckout) {
                    Global.ShortCodeParameters.defaultcheckout = _functions.calculateDefaultDate(Global.ShortCodeParameters.defaultcheckout);
                }
            },
            getUrlComplementCampaign: function () {

                var queryString = '';

                var parameters = ['utm_source', 'utm_medium', 'utm_campaign', 'utm_content'];

                for (var i = 0; i < parameters.length; i++) {

                    var name = parameters[i];
                    var value = Global.ShortCodeParameters['search_campaign_' + name];

                    if (value) {
                        queryString += '&' + name + '=' + value;
                    }
                }

                return queryString;
            },
            getAdditionalSearchParameters: function () {
                var res = '';
                if (Global.AdditionalSearchParameters && Global.AdditionalSearchParameters.length) {
                    for (idx = 0; idx < Global.AdditionalSearchParameters.length; idx++) {
                        res += '&' + Global.AdditionalSearchParameters[idx].Key + '=' + Global.AdditionalSearchParameters[idx].Value;
                    }
                }
                return res;
            },
            initialize: function () {
                if (!Global.SearchType)
                    Global.SearchType = '';

                _functions.components.select();
                _functions.configureVisualization();
                _functions.controllers.initialize();
                _functions.controllers.attachEvents();
                _functions.calculateDefaultDates();

                var initSearchType = _functions.getInitialSearchType();

                settings.components.searchEngineContainer.addClass(initSearchType.toLowerCase());

                if (location.pathname.toLowerCase().indexOf('/transacional') < 0)
                    Global.isHome = true;

                _functions.callSearchEngineTemplate(initSearchType);

                if (Global.isHome) {
                    settings.components.searchEngineContainer.find('.content')
                        .css({
                            opacity: '0.0',
                            '-moz-opacity': '0.0',
                            filter: 'alpha(opacity=60)'
                        })
                        .animate({
                            opacity: '1.0',
                            '-moz-opacity': '1.0',
                            filter: 'alpha(opacity=100)'
                        }, 600);
                }

                if (Global.ShortCodeParameters.startopened && Global.ShortCodeParameters.startopened == "false" && !settings.properties.wasStarted) {
                    settings.components.searchEngineContainer.find('.content').hide();
                    var tabActive = settings.components.searchEngineContainer.find(".tabs .active");
                    if (tabActive)
                        tabActive.removeClass("active");

                    settings.properties.wasStarted = true;
                }
            },
            components: {
                select: function () {
                    Util.SelectComponents(settings.components);
                },
                setEvents: function (action) {
                    $(document)[action]("click", settings.components.typeButtons.selector, _events.components.changeSearchEngineType);
                    $(document)[action]("change", settings.components.ddlQtdChildrens.selector, _events.components.changeChildrenCount);
                    $(document)[action]("click", settings.components.txtHotelCity.selector, _events.components.clearVal);
                    $(document)[action]("click", settings.components.btnSendSearch.selector, _events.components.sendSearch);
                    $(document)[action]('focus', settings.components.textInputs.selector, _events.components.selectText);
                },
                attachEvents: function () {
                    _functions.components.setEvents('on');
                },
            },
            controllers: {
                initialize: function () {
                    Global.LocationsController = new LocationsController();
                    Global.MessagesController = Global.MessagesController || new MessagesController(Global.Options.messagesController);
                    Global.SearchController = Global.SearchController || new SearchController();
                },
                setEvents: function (action) {
                    Global.SearchController.onIncludeProduct[action](_events.controllers.onIncludeProduct);
                    Global.SearchController.onRemoveProduct[action](_events.controllers.onRemoveProduct);
                },
                attachEvents: function () {
                    _functions.controllers.setEvents('dettachAndAttach');
                }
            },
            getInitialSearchType: function () {
                var initialSearchType = 'Air';
                var queryStringSearchType = TravelGo.Functions.QueryString.requestQueryString('SearchType');
                var defaultSearchType = Global.ShortCodeParameters.defaultsearch;

                if (Global.SearchType && Global.SearchType.length)
                    initialSearchType = Global.SearchType;
                else if (queryStringSearchType && queryStringSearchType.length)
                    initialSearchType = queryStringSearchType;
                else if (defaultSearchType && defaultSearchType.length)
                    initialSearchType = defaultSearchType;

                return initialSearchType;
            },
            overrideDefaultSearchType: function(searchType){
                Global.ShortCodeParameters.defaultsearch = searchType; 
            },
            callSearchEngineTemplate: function (template) {
                var searchType = _searchTypeCaptalized[template.toUpperCase()] ? _searchTypeCaptalized[template.toUpperCase()] : '';

                if (searchType != "") {
                    Global.SearchType = searchType;
                    template = searchType;
                }

                var initialSearchType = Global.SearchType.toLowerCase() == 'dynamicpackage' ? 'dynamicPackage' : Global.SearchType.toLowerCase();

                var options = _functions.plugins.options.base(initialSearchType, template);
                options[initialSearchType] = true;
                options['components'][initialSearchType] = _functions.plugins.components[initialSearchType];
                options['plugins'][initialSearchType] = _functions.plugins.options[initialSearchType]();
                $(settings.components.searchEngineContainer).empty().searchEngine(options);

                _functions.components.select();
            },
            getMinDaysToSearch: function (productType) {
                var minDaysToSearch = 1;

                if (Global.ShortCodeParameters.allow_search_blocked_date == 'true') {
                    minDaysToSearch = 0;
                }
                else if (Global.ShortCodeParameters.block_search_before_default_initial_date == 'true') {
                    minDaysToSearch = Global.ShortCodeParameters.defaultcheckinindays;
                }

                if (minDaysToSearch == undefined)
                    minDaysToSearch = SharedFunctions.ResolveSearchRange.MinDays(productType) || 1;

                return minDaysToSearch;
            },
            setupSubmitSearchEngineFunction: function () {
                if (Global.ShortCodeParameters.searchmotor_form_target && Global.ShortCodeParameters.searchmotor_form_target != "_self") {
                    TravelGo.Functions.ContinueForm.SetFormTarget(Global.ShortCodeParameters.searchmotor_form_target)
                    return TravelGo.Functions.ContinueForm.SubmitForm;
                }
                else {
                    return TravelGo.Functions.ContinueForm.SubmitWindowLocation;
                }
            }
        };

        if (_functions.productsConfiguredByQueryString())
            _functions.configureProductsByQueryString();
        else
            _functions.configureProductsByShortCodeParameter();
        _functions.components.select();
        _functions.components.attachEvents();
        _functions.initialize();

        return this;
    };

    $(document).ready(function () {
        if (!Global.PageManagers)
            Global.PageManagers = {};

        Global.PageManagers.SearcEngine = new PageManager.SearcEngine();
    });
})(jQuery);


ï»¿if (typeof TravelGo === 'undefined')
    TravelGo = {
        Util: {}
    };
else if (TravelGo.Util == undefined)
    TravelGo.Util = {};

TravelGo.Util.getElementsByClass = function (tagName, htmlclassToRetrieve) {
    if (TravelGo.Util.isStringAndNotEmpty(tagName) && TravelGo.Util.isStringAndNotEmpty(htmlclassToRetrieve)) {
        return $(tagName).filter('.' + htmlclassToRetrieve);
    }

    return undefined;
};

TravelGo.Util.addDropDownOption = function (dropDown, optionText, optionValue, selected) {
    if (selected == undefined) {
        selected = false;
    }

    if (TravelGo.Util.isJQuery(dropDown) && TravelGo.Util.isStringAndNotEmpty(optionText) && optionValue != undefined) {
        var dropDownOption = dropDown.find('option[value="' + optionValue + '"]');
        var optionProps = { value: optionValue, text: optionText, selected: selected };

        if (dropDownOption != undefined && dropDownOption.length > 0) {
            dropDown.find('option[value="' + optionValue + '"]').remove();
        }

        dropDown.append($('<option>', optionProps));
    }
};

TravelGo.Util.addDropDownOptions = function (dropDown, firstValue, lastValue, valueToSelect) {
    if (TravelGo.Util.isJQuery(dropDown) && TravelGo.Util.isNumber(firstValue) && TravelGo.Util.isNumber(lastValue)) {
        if (!TravelGo.Util.isNumber(valueToSelect)) {
            valueToSelect = firstValue;
        }

        for (var i = firstValue; i <= lastValue; i++) {
            TravelGo.Util.addDropDownOption(dropDown, i.toString(), i);
        }

        var options = dropDown.children().toArray();
        $options = TravelGo.Util.sortDropDownOptionsList(options);

        dropDown.empty().append($options);

        // o Append adiciona selected no Ãºltimo elemento inserido. Por isso Ã© necessÃ¡rio fazer o ajuste do selected depois.
        dropDown.find('option').removeProp('selected');
        dropDown.find('option[value="' + valueToSelect.toString() + '"]').prop('selected', true);
    }
};

TravelGo.Util.removeDropDownOptions = function (dropDown, valueToRemove, removeAllOptionsBiggerThanValue) {
    if (TravelGo.Util.isJQuery(dropDown)) {
        if (removeAllOptionsBiggerThanValue) {
            dropDown.find('option').filter(function () {
                return parseInt(this.value) >= valueToRemove;
            }).remove();
        } else {
            dropDown.find('option').filter(function () {
                return parseInt(this.value) == valueToRemove;
            }).remove();
        }
    }
};

TravelGo.Util.sortDropDownOptionsList = function (arrayList) {
    if (TravelGo.Util.isArrayAndNotEmpty(arrayList)) {
        arrayList.sort(function (a, b) {
            return parseInt(a.value) > parseInt(b.value);
        });
    }

    return arrayList;
};

TravelGo.Util.leftOneOptionOnly = function (dropDown, value) {
    if (TravelGo.Util.isJQuery(dropDown)) {
        if (value == undefined) {
            value = 0;
        }

        dropDown.empty().append($('<option>', { value: value, text: value.toString() }));
    }
}

TravelGo.Util.isJQuery = function (obj) {
    return obj != undefined && obj instanceof jQuery;
};

TravelGo.Util.isJqueryAndHasLength = function (obj) {
    return TravelGo.Util.isJQuery(obj) && obj.length > 0;
}

TravelGo.Util.isArray = function (obj) {
    return obj != undefined && Array.isArray(obj);
};

TravelGo.Util.isArrayAndNotEmpty = function (obj) {
    return TravelGo.Util.isArray(obj) && obj.length > 0;
};

TravelGo.Util.isNumber = function (value) {
    return value != undefined && !isNaN(value);
};

TravelGo.Util.isString = function (value) {
    return value != undefined && Util.isString(value);
};

TravelGo.Util.isStringAndNotEmpty = function (value) {
    return TravelGo.Util.isString(value) && value.length > 0;
};

TravelGo.Util.getUserDataFromAuthCookie = function (authenticationCookieName) {
    var loginCookie = Util.getCookie(authenticationCookieName);

    //loginCookie != undefined e != null
    return loginCookie !== undefined ? JSON.parse(unescape(loginCookie)) : undefined;
};

TravelGo.Util.isUserAuthenticated = function (authenticationCookieName) {
    if (TravelGo.Util.isStringAndNotEmpty(authenticationCookieName)) {
        var loginCookie = TravelGo.Util.getUserDataFromAuthCookie(authenticationCookieName);

        if (loginCookie != undefined) {
            var isSecurityKeyValid = loginCookie.st != undefined && Util.isString(loginCookie.st) && loginCookie.st.length > 0;
            var isUserNameValid = loginCookie.un != undefined && Util.isString(loginCookie.un) && loginCookie.un.length > 0;

            return isSecurityKeyValid && isUserNameValid;
        }
    }

    return false;
};

TravelGo.Util.GetSetting = function (settingName) {
    if (TravelGo.Util.isStringAndNotEmpty(settingName)) {
        if (Global != undefined && Global.Settings != undefined && Global.Settings[settingName] != undefined) {
            return Global.Settings[settingName];
        }
    }

    return undefined;
};

TravelGo.Util.GetSettingBool = function (settingName) {
    if (TravelGo.Util.isStringAndNotEmpty(settingName)) {
        if (Global != undefined && Global.Settings != undefined && Global.Settings[settingName] != undefined) {
            return Global.Settings[settingName].trim().toUpperCase() == 'TRUE';
        }
    }

    return undefined;
};

TravelGo.Util.GetSettingInt = function (settingName) {
    var settingValue = TravelGo.Util.GetSetting(settingName);

    if (settingValue != undefined && TravelGo.Util.isNumber(settingValue)) {
        return parseInt(settingValue);
    }

    return undefined;
};

TravelGo.Util.parseRecordsToArray = function (records, skipEmptyRecordFields) {
    var array = [];

    if (skipEmptyRecordFields == undefined) {
        skipEmptyRecordFields = true;
    }

    if (TravelGo.Util.isArrayAndNotEmpty(records)) {
        for (m = 0; m < records.length; m++) {
            var record = records[m];
            var user = {};
            var isRecordFieldNotEmpty = TravelGo.Util.isArrayAndNotEmpty(record.Fields);

            if (isRecordFieldNotEmpty) {
                for (n = 0; n < record.Fields.length; n++) {
                    user[record.Fields[n].Name] = record.Fields[n].Value;
                }
            }

            if (isRecordFieldNotEmpty || !skipEmptyRecordFields) {
                array.push(user);
            }
        }
    }

    return array;
};

TravelGo.Util.updateKey = function (object, keyToUpdate) {
    if (object !== undefined && TravelGo.Util.isStringAndNotEmpty(keyToUpdate)) {
        if (object.hasOwnProperty(keyToUpdate)) {
            return keyToUpdate;
        } else {
            var keys = Object.keys(object);

            for (var keyIndex = 0; keyIndex < keys.length; keyIndex++) {
                if (keys[keyIndex].toLowerCase() == keyToUpdate) {
                    return keys[keyIndex];
                }
            }
        }
    }

    return '';
};

ï»¿/// <reference path="WebCommon/Scripts/Libraries/EnumHelper.js" />
/// <reference path="WebCommon/Scripts/Libraries/Util.js" />
/// <reference path="WebCommon/Scripts/Libraries/Libraries/Jquery.js" />

if (TravelGo == undefined) {
    TravelGo = {};
}

if (TravelGo.Plugin == undefined) {
    TravelGo.Plugin = {};
}

TravelGo.Plugin.MaxPassengerQtd = function (baseSettings) {
    var _this = this;
    var _settings = {
        data: {
            passengerDropDowns: [],    // { dropDownClass: '', maxValueOption: 4, isHotelRoom: false }
            maxPassengerQtdSettingValue: 0,
        },
        dropDownManagers: [],
        components: {
            dropDowns: [],
        },
    };
    var _functions = {
        initialize: function (baseSettings) {
            if (baseSettings != undefined) {
                $.extend(_settings, baseSettings);
            }

            _functions.dropDowns.selectDropDownsByClass();
            _functions.dropDowns.setDropDownHotelRoom();

            if (_functions.settings.canApplySetting()) {
                _functions.events.setOnChangeEvents();
            }
        },
        settings: {
            canApplySetting: function () {
                return TravelGo.Util.isArrayAndNotEmpty(_settings.components.dropDowns) && _functions.settings.getSettingValue() > 0;
            },
            getSettingValue: function () {
                if (_settings.data.maxPassengerQtdSettingValue == 0) {
                    if (Global != undefined && Global.Settings != undefined) {
                        var mandatoryLoginSetting = TravelGo.Util.GetSetting("Travelgo.Validation.MandatoryUserLogin");
                        var isLoginMandatory = mandatoryLoginSetting && !mandatoryLoginSetting.toUpperCase().trim() === 'NO';
                        var passengerMustBeAuthenticatedUser = isLoginMandatory && TravelGo.Util.GetSettingBool("Travelgo.Checkout.PassengerMustBeAuthenticatedUser");

                        _settings.data.maxPassengerQtdSettingValue = passengerMustBeAuthenticatedUser
                            ? 1
                            : TravelGo.Util.GetSettingInt("Travelgo.Validation.MaxPassengerQtd");
                    }
                }

                return _settings.data.maxPassengerQtdSettingValue;
            },
        },
        events: {
            setOnChangeEvents: function () {
                var maxPassengerQtd = _settings.data.maxPassengerQtdSettingValue;

                if (maxPassengerQtd && parseInt(maxPassengerQtd) > 0) {
                    for (var i = 0, len = _settings.components.dropDowns.length; i < len; i++) {
                        var dropDown = _settings.components.dropDowns[i];

                        if (TravelGo.Util.isJQuery(dropDown)) {
                            dropDown.off('change', _functions.events.onChangeDropDown).on('change', _functions.events.onChangeDropDown);
                        }
                    }
                }
            },
            onChangeDropDown: function (e) {
                var totalSelectedPassengers = _functions.dropDowns.getTotalPassengersValue();

                for (var m = 0; m < _settings.dropDownManagers.length; m++) {
                    var dropDownManager = _settings.dropDownManagers[m];

                    dropDownManager.updateAllDropDowns(_settings.data.maxPassengerQtdSettingValue, totalSelectedPassengers);
                }
            }
        },
        dropDowns: {
            getTotalPassengersValue: function () {
                var passengersQtd = 0;

                for (i = 0; i < _settings.dropDownManagers.length; i++) {
                    var dropDownManager = _settings.dropDownManagers[i];

                    passengersQtd = passengersQtd + dropDownManager.getSelectedPassengersQtd();
                }

                return passengersQtd;
            },
            selectDropDownsByClass: function () {
                _settings.components.dropDowns = [];

                for (var i = 0; i < _settings.data.passengerDropDowns.length; i++) {
                    var dropDown = _settings.data.passengerDropDowns[i];
                    var dropDownSettings = {
                        data: {
                            className: dropDown.dropDownClass,
                            maxPassengerQtdSettingValue: _settings.data.maxPassengerQtdSettingValue,
                            maxOptionValue: dropDown.maxValueOption,
                            areThoseDropDownsNotPassengers: dropDown.isHotelRoom,
                            minValueOption: dropDown.minValueOption,
                        }
                    };
                    var dropDownManager = dropDown.isHotelRoom ? new TravelGo.Plugin.HotelRoomDropDownManager(dropDownSettings) : new TravelGo.Plugin.DropDownManager(dropDownSettings);
                    var selectedDropDowns = dropDownManager.getSelectedDropDowns();

                    if (TravelGo.Util.isArrayAndNotEmpty(selectedDropDowns)) {
                        for (j = 0; j < selectedDropDowns.length; j++) {
                            _settings.components.dropDowns.push(selectedDropDowns[j]);
                        }
                    }

                    _settings.dropDownManagers.push(dropDownManager);
                }
            },
            getRoomDropDown: function () {

                if (_settings.data.passengerDropDowns) {
                    // Por padrÃ£o somente existe um DropDown de quarto na pesquisa.
                    var hotelRoomClass = _settings.data.passengerDropDowns.first(function (dropDownSettings) {
                        return dropDownSettings.isHotelRoom;
                    });

                    if (hotelRoomClass != undefined) {
                        var hotelRoomDropDownManagers = _settings.dropDownManagers.first(function (dropDownManager) {
                            return dropDownManager.getClassName() == hotelRoomClass.dropDownClass;
                        });

                        if (hotelRoomDropDownManagers != undefined) {
                            return hotelRoomDropDownManagers.getSelectedDropDowns()[0];
                        }
                    }
                }

                return undefined;
            },
            setDropDownHotelRoom: function () {
                var hotelRoom = _functions.dropDowns.getRoomDropDown();

                if (hotelRoom != undefined) {
                    for (i = 0; i < _settings.dropDownManagers.length; i++) {
                        var dropDownManager = _settings.dropDownManagers[i];

                        dropDownManager.setHotelRoomDropDown(hotelRoom);
                    }
                }
            },
        },
    }

    _functions.initialize(baseSettings);
}

ï»¿/// <reference path="WebCommon/Scripts/Libraries/EnumHelper.js" />
/// <reference path="WebCommon/Scripts/Libraries/Util.js" />
/// <reference path="WebCommon/Scripts/Libraries/Libraries/Jquery.js" />

if (TravelGo == undefined) {
    TravelGo = {};
}

if (TravelGo.Plugin == undefined) {
    TravelGo.Plugin = {};
}

TravelGo.Plugin.DropDownManager = function (baseSettings) {
    var _this = this;
    var _proxyObj = {
        updateAllDropDowns: function (maxNumberOfPassengers, qtdOfPassengersSelected) {
            return _this._updateAllDropDowns.apply(_this, [maxNumberOfPassengers, qtdOfPassengersSelected]);
        },
        getSelectedDropDowns: function () {
            return _this.settings.components.dropDowns;
        },
        getClassName: function () {
            return _this.settings.data.className;
        },
        setHotelRoomDropDown: function (hotelRoom) {
            _this.settings.components.hotelRoomDropDown = hotelRoom;
        },
        getSelectedPassengersQtd: function () {
            return _this._getSelectedPassengersQtd.apply(_this, undefined);
        },
    }
    var _functions = {
        initialize: function (baseSettings) {
            return _this._initialize.apply(_this, [baseSettings]);
        },
    }

    this.settings = {
        data: {
            className: undefined,
            maxPassengerQtdSettingValue: 0,
            actualSelectedPassengersQtd: 0,
            maxOptionValue: 0,
            minValueOption: 0,
            areThoseDropDownsNotPassengers: false,
        },
        components: {
            dropDowns: [],
            hotelRoomDropDown: undefined,
        },
        events: {
            onDropDownChange: undefined,
        }
    };

    _functions.initialize(baseSettings);

    return _proxyObj;
};

TravelGo.Plugin.DropDownManager.prototype = {
    _getElementsByClass: function () {
        var dropDowns = TravelGo.Util.getElementsByClass('select', this.settings.data.className);

        if (TravelGo.Util.isJqueryAndHasLength(dropDowns)) {
            for (var i = 0, len = dropDowns.length; i < len; i++) {
                this.settings.components.dropDowns.push($(dropDowns[i]));
            }
        }
    },
    _getHotelRoomIndex: function () {
        if (TravelGo.Util.isJQuery(this.settings.components.hotelRoomDropDown)) {
            var dropDownValue = this.settings.components.hotelRoomDropDown.val();

            if (TravelGo.Util.isNumber(dropDownValue)) {
                return parseInt(dropDownValue);
            }
        }

        return 0;
    },
    _getSelectedPassengersQtd: function () {
        var passengersQtd = 0;

        if (!this.settings.data.areThoseDropDownsNotPassengers) {
            var hotelRoomIndex = this._getHotelRoomIndex();

            for (var i = 0, len = this.settings.components.dropDowns.length; i < len; i++) {
                var dropDown = this.settings.components.dropDowns[i];

                if (TravelGo.Util.isJQuery(dropDown)) {
                    if (hotelRoomIndex > 0) {
                        var dropDownRoomIndex = dropDown.attr('data-roomIndex');

                        if (dropDownRoomIndex != undefined && parseInt(dropDownRoomIndex) > hotelRoomIndex) {
                            continue;
                        }
                    }

                    passengersQtd = passengersQtd + (parseInt(dropDown.val()));
                }
            }
        }

        return passengersQtd;
    },
    _maxNumberOfPassengersReached: function () {
        return this.settings.data.maxPassengerQtdSettingValue <= this.settings.data.actualSelectedPassengersQtd;
    },
    _isDropDownFromHigherRoomThanSelected: function (dropDown) {
        var roomIndex = this._getHotelRoomIndex();
        var dropDownRoomIndex = dropDown.attr('data-roomIndex');

        return roomIndex > 0 && TravelGo.Util.isNumber(dropDownRoomIndex) && parseInt(dropDownRoomIndex) > roomIndex;
    },
    _getMaxPassengerOptionValue: function (dropDown) {
        var optionSelectedValue = parseInt(dropDown.val());
        var maxPassengers = this.settings.data.maxPassengerQtdSettingValue;
        var maxPassengerQtdToSelect = maxPassengers - this.settings.data.actualSelectedPassengersQtd;

        maxPassengerQtdToSelect = maxPassengerQtdToSelect + optionSelectedValue;

        return maxPassengerQtdToSelect < 0 ? 0 : Util.MinValue([maxPassengerQtdToSelect, this.settings.data.maxOptionValue, maxPassengers]);
    },
    _defaultUpdateDropDown: function (dropDown) {
        if (TravelGo.Util.isJQuery(dropDown) && this.settings.data.maxPassengerQtdSettingValue > 0 && this.settings.data.actualSelectedPassengersQtd >= 0) {
            var optionSelectedValue = parseInt(dropDown.val());

            if (this._isDropDownFromHigherRoomThanSelected(dropDown)) {
                TravelGo.Util.leftOneOptionOnly(dropDown, this.settings.data.minValueOption);

                return;
            } else if (this._maxNumberOfPassengersReached()) {
                if (optionSelectedValue == 0) {
                    TravelGo.Util.leftOneOptionOnly(dropDown, this.settings.data.minValueOption);
                } else {
                    TravelGo.Util.removeDropDownOptions(dropDown, optionSelectedValue + 1, true);
                }
            } else {
                var maxQtdOfPassengerAvailableToSelect = this._getMaxPassengerOptionValue(dropDown);

                dropDown.find('option').remove();

                TravelGo.Util.addDropDownOptions(dropDown, this.settings.data.minValueOption, maxQtdOfPassengerAvailableToSelect, optionSelectedValue);
            }
        }
    },
    _updateAllDropDowns: function (maxNumberOfPassengers, qtdOfPassengersSelected) {
        this.settings.data.maxPassengerQtdSettingValue = maxNumberOfPassengers;
        this.settings.data.actualSelectedPassengersQtd = qtdOfPassengersSelected;

        for (i = 0; i < this.settings.components.dropDowns.length; i++) {
            this.settings.events.onDropDownChange.apply(this, [this.settings.components.dropDowns[i]]);
        }
    },
    _initialize: function (baseSettings) {
        if (baseSettings != undefined) {
            $.extend(this.settings, baseSettings);
        }

        this._getElementsByClass();

        if (this.settings.events.onDropDownChange == undefined) {
            this.settings.events.onDropDownChange = this._defaultUpdateDropDown;
        }

        if (this.settings.data.maxOptionValue > this.settings.data.maxPassengerQtdSettingValue) {
            this.settings.data.maxOptionValue = this.settings.data.maxPassengerQtdSettingValue;
        }
    },
};

TravelGo.Plugin.HotelRoomDropDownManager = function (baseSettings) {
    var _this = this;

    function _onDropDownChange(dropDown) {
        if (TravelGo.Util.isJQuery(dropDown) && this.settings.data.maxPassengerQtdSettingValue > 0 && this.settings.data.actualSelectedPassengersQtd >= 0) {
            var optionSelectedValue = parseInt(dropDown.val());

            if (this._maxNumberOfPassengersReached()) {
                TravelGo.Util.removeDropDownOptions(dropDown, optionSelectedValue + 1, true);
            } else {
                TravelGo.Util.addDropDownOptions(dropDown, 1, this.settings.data.maxOptionValue, optionSelectedValue);
            }
        }
    }

    if (baseSettings == undefined) {
        baseSettings = {};
    }

    if (baseSettings.events == undefined) {
        baseSettings.events = {
            onDropDownChange: _onDropDownChange,
        }
    }

    // Na prÃ¡tica o return abaixo equivale a $.extend(_this, new TravelGo.Plugin.DropDownManager(baseSettings));
    return new TravelGo.Plugin.DropDownManager(baseSettings);
};

ï»¿function AuthenticateController(params) {
    var _model = new AuthenticateModel(this);
    var _this = this;

    this.loginStarting = new Event();
    this.loginCompleted = new Event();
    this.logoutStarting = new Event();
    this.logoutCompleted = new Event();
    this.forgottenPasswordStarting = new Event();
    this.forgottenPasswordCompleted = new Event();
    this.changePasswordStarting = new Event();
    this.changePasswordCompleted = new Event();
    this.getUsersByUserResponsibleStarting = new Event();
    this.getUsersByUserResponsibleCompleted = new Event();
    this.getSecurityContextStarting = new Event();
    this.getSecurityContextCompleted = new Event();


    this.login = function (request) {
        _this.loginStarting.notify(request);

        _model.login(request);
    };

    this.onLoginCompleted = function (response) {
        _this.loginCompleted.notify(response);
    };

    this.logout = function (request) {
        _this.logoutStarting.notify(request);

        _model.logout(request);
    };

    this.onLogoutCompleted = function (response) {
        _this.logoutCompleted.notify(response);
    };

    this.forgottenPassword = function (request) {
        _this.forgottenPasswordStarting.notify(request);

        _model.forgottenPassword(request);
    };

    this.onForgottenPasswordCompleted = function (response) {
        _this.forgottenPasswordCompleted.notify(response);
    };

    this.changePassword = function (request) {
        _this.changePasswordStarting.notify(request);

        _model.changePassword(request);
    };

    this.onChangePasswordCompleted = function (response) {
        _this.changePasswordCompleted.notify(response);
    };

    this.getUsersByUserResponsibleId = function (request) {
        _this.getUsersByUserResponsibleStarting.notify(request);

        _model.getUsersByUserResponsibleId(request);
    }

    this.onGetUsersByUserResponsibleIdCompleted = function (response) {
        this.getUsersByUserResponsibleCompleted.notify(response);
    };

    this.getSecurityContext = function (request) {
        _this.getSecurityContextStarting.notify(request);

        _model.getSecurityContext(request);
    };

    this.onGetSecurityContext = function (response) {
        _this.getSecurityContextCompleted.notify(response);
    };

    var settings = { "Global": undefined };

    $.extend(true, settings, params || {});

    if (!settings.Global) {
        if (!Global)
            Global = {};

        if (!Global.AuthenticateController)
            Global.AuthenticateController = this;

        return Global.AuthenticateController;
    }
    else {
        params.Global.AuthenticateController = this;
        return params.Global.AuthenticateController;
    }
};

ï»¿function AuthenticateModel(controller) {
    var _this = this;
    var _controller = controller;
    var _serviceCaller = new ServiceCaller(Global.PathWebService);

    this.login = function (request) {

        if (request.userName)
            request.Signature = request.userName;

        if (request.password)
            request.Password = request.password;

        if (request.hasOwnProperty('authenticationType') && !$.isEmptyObject(request.authenticationType))
            request.AuthenticationType = request.authenticationType;

        var callback = function (response) {

            if (response)
                response.Request = request;

            _loginCompleted(response);
        };

        _serviceCaller.invoke("SignIn", { req: request }, callback);
    };

    function _loginCompleted(response) {
        _controller.onLoginCompleted(response);
    };

    this.logout = function (request) {
        _serviceCaller.invoke("SignOut", { req: request || {} }, _logoutCompleted);
    };

    function _logoutCompleted(response) {
        _controller.onLogoutCompleted(response);
    };

    this.forgottenPassword = function (request) {

        var callback = function (response) {

            if (response)
                response.Request = request;

            _forgottenPasswordCompleted(response);
        };

        _serviceCaller.invoke("ForgottenUserPassword", { req: request || {} }, callback);
    };

    function _forgottenPasswordCompleted(response) {
        _controller.onForgottenPasswordCompleted(response);
    };

    this.changePassword = function (request) {

        var callback = function (response) {

            if (response)
                response.Request = request;

            _changePasswordCompleted(response);
        };

        _serviceCaller.invoke("ChangeUserPassword", { req: request }, _changePasswordCompleted);
    };

    function _changePasswordCompleted(response) {
        _controller.onChangePasswordCompleted(response);
    };

    this.getUsersByUserResponsibleId = function (request) {
        _serviceCaller.invoke("GetUsersByUserResponsibleId", request, _getUsersByUserResponsibleIdCompleted);
    };

    function _getUsersByUserResponsibleIdCompleted(response) {
        _controller.onGetUsersByUserResponsibleIdCompleted(response);
    }

    this.getSecurityContext = function (request) {
        _serviceCaller.invoke("GetSecurityContext",
            { req: request },
            function (response) {
                _controller.onGetSecurityContext(response);
            });
    };
};

// This file was automatically generated from Login.soy.
// Please don't edit this file by hand.

if (typeof Login == 'undefined') { var Login = {}; }


Login.login = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label for="login_form_call" class="login_form_call">Meus <br /> pedidos</label><input id="login_form_call" type="checkbox" name="login_form_call" class="login_form_call"><div class="login_form normal"><h3>Identifique-se</h3><p>Identifique-se para ter acesso ao seu hist&oacute;rico de pedidos</p>');
  Login.coreLogin(null, output);
  output.append('</div>');
  if (!opt_sb) return output.toString();
};


Login.business = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="login_form business"><h3>Acesso Empresarial</h3>');
  Login.coreLogin(null, output);
  output.append('</div>');
  if (!opt_sb) return output.toString();
};


Login.coreLogin = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label class="lblEmail login"><input type="email" placeholder="E-mail:" name="userEmail" id="userEmail" class="email" /></label><label class="lblPassword password"><input type="password" placeholder="Senha:" name="userPassword" id="userPassword" class="password" /></label><a href="#" class="btn enter send" id="userLoginBtn" title="Entrar">Entrar</a><a id="openContainerForgotPassword" href="#" title="Esqueci minha senha" class="forgot">Esqueci minha senha</a>');
  if (!opt_sb) return output.toString();
};


Login.forgotPassword = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h3>Esqueci Minha Senha</h3><p>Digite seu e-mail de cadastro e clique em enviar para receber um e-mail com instru&ccedil;&otilde;es sobre como cadastrar uma nova senha.</p><label class="login"><input name="userEmailForgot" placeholder="E-mail:" id="userEmailForgot" type="text" class="email" /></label><a href="#" class="btn send forgot_pass" id="forgotPassword" title="Enviar">Enviar</a><a href="#" id="closeContainerForgotPassword" class="btn close" title="Voltar">Voltar</a>');
  if (!opt_sb) return output.toString();
};


Login.loggedInUser = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="logged_in"><p>');
  Resources.translate({code: 'Hello'}, output);
  output.append(', <strong>', soy.$$escapeHtml(opt_data.User.FullName), '</strong></p>');
  if (opt_data.User.FidelityInfo) {
    output.append((opt_data.User.FidelityInfo.SumPoints && opt_data.User.FidelityInfo.PartnerPoints) ? '<p class="total">Seu saldo total Ã© <strong>' + soy.$$escapeHtml(opt_data.User.FidelityInfo.SumPoints) + '</strong></p><p>sendo: <span> ' + soy.$$escapeHtml(opt_data.User.FidelityInfo.PartnerPointsUnit) + '</span> <strong> ' + soy.$$escapeHtml(opt_data.User.FidelityInfo.PartnerPoints) + ' </strong></p><p>e <span> ' + soy.$$escapeHtml(opt_data.User.FidelityInfo.PointsUnit) + ' </span><strong>' + soy.$$escapeHtml(opt_data.User.FidelityInfo.TotalPoints) + ' </strong></p>' : '<p class="total">Seu saldo total de ' + soy.$$escapeHtml(opt_data.User.FidelityInfo.PointsUnit) + ' Ã© <strong>' + soy.$$escapeHtml(opt_data.User.FidelityInfo.TotalPoints) + '</strong></p>', (opt_data.User.FidelityInfo.AdditionalText) ? '<p>' + soy.$$escapeHtml(opt_data.User.FidelityInfo.AdditionalText) + '</p>' : '');
  } else {
    output.append('<a href="', soy.$$escapeHtml(opt_data.myOrdersUrl), '" class="my_orders">');
    Resources.translate({code: 'MyOrders'}, output);
    output.append('</a>');
  }
  output.append('<a href="#" id="logout" class="logout">Sair</a></div>');
  if (!opt_sb) return output.toString();
};


Login.changePassword = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h3>');
  Resources.translate({code: 'ChangePassword'}, output);
  output.append('</h3><label class="password new"><input type="password" placeholder="Senha antiga:" name="old_password" id="old_password" /></label><label class="password new"><input type="password" placeholder=" Nova senha:" name="password" id="password" /></label><label class="password new"><input type="password" placeholder=" ConfirmaÃ§Ã£o de senha:" name="password_again" id="password_again" /></label><a href="#" class="btn enter send" id="change_password" title="Enviar">Enviar</a>');
  if (!opt_sb) return output.toString();
};


ï»¿function LoginTPL(options) {

    var settings = {
        'template': Login.login,
        'data': {},
        'type': 1
    };

    $.fn.extend(settings, options || {});

    if (settings.data && settings.data.User && !settings.data.User.FullName) {
        settings.data.User.FullName = settings.data.User.Name;
    }

    switch (settings.type) {
        case EnumHelper.LoginFormType.login:
        case EnumHelper.LoginFormType.logOut:
            return Login.login();
            break;
        case EnumHelper.LoginFormType.loggedInUser:
            return Login.loggedInUser({ User: settings.data.User, myOrdersUrl: Global.ShortCodeParameters.myordersurl });
            break;
        case EnumHelper.LoginFormType.forgotPassword:
            return Login.forgotPassword();
            break;
        case EnumHelper.LoginFormType.changePassword:
            return Login.changePassword();
            break;
        case EnumHelper.LoginFormType.businessLogin:
            return Login.business();
            break;
    }
};


ï»¿/// <reference path="../Libraries/Util.js" />
/// <reference path="../../Templates/Login/DatePickerOption.js" />
/// <reference path="../Libraries/jquery-ui-1.8.13.custom.min.js" />
/// <reference path="../Controllers/MessagesController.js" />

(function ($) {

    function Login() {
        var component = undefined;
        var _this = this;
        var _myCode = Util.Guid();

        var _settings = {
            data: {},
            needChangePassword: false,
            errorMessageExhibitionType: undefined,
            authenticationType: parseInt(EnumHelper.AuthenticationType.Normal, 10),
            template: function (f) { return ""; },
            controllers: {
                messagesController: undefined,
                WorkFlowController: undefined,
                authenticateController: undefined
            },
            type: 1,
            components: {
                userName: '#userEmail',
                userNameForgotPassword: '#userEmail',
                password: '#userPassword',
                loginButton: '#userLoginBtn',
                loginStar: '#loginStar',
                passwordStar: '#passwordStar',
                errorDiv: '#messagesExhibitor',
                addUserBtn: '#userAddBtn',
                lbUSerExists: '#lbUSerExists',
                selectUser: '#userSelectBtn',
                myOrdersBtn: '#myOrders',
                myRegisterBtn: '#myRegister',
                forgotPassword: '#forgotPassword',
                openContainerForgotPassword: '#openContainerForgotPassword',
                closeContainerForgotPassword: '#closeContainerForgotPassword',
                containerForgotPassword: '#containerForgotPassword',
                containerLogin: '#Authenticate',
                editUser: '#editUser',
                logOut: '#logout',
                form: '.login_form',
                changePassword: {
                    oldPassword: '#old_password',
                    newPassword: '#password',
                    retryPassword: '#password_again',
                    change: '#change_password'
                }
            },
            events: {
                doLogin: undefined,
                LoginCompleted: undefined,
                afterLogin: undefined,
                afterLoginRendered: undefined,
                selectUser: undefined,
                selectUserCompleted: undefined,
                myOrders: undefined,
                myRegister: undefined,
                forgotPassword: undefined,
                editUser: undefined
            }
        };

        this.ClearData = function () {
            _settings.components.userName.val('');
            _settings.components.password.val('');
        }

        this.getData = function () {
            var loginData = {};
            loginData.userName = _settings.components.userName.val();
            loginData.password = _settings.components.password.val();
            loginData.authenticationType = _settings.authenticationType;
            loginData.myPluginCode = _myCode;
            return loginData;
        }

        this.LoadUser = function (user, target) {
            if (target)
                $(target).html(_settings.template({ type: 3, data: user }));
            else
                component.html(_settings.template({ type: 3, data: user }));

            _functions.components.select();
        }

        this.initialize = function (target, user_settings) {
            component = $(target);
            $.extend(true, _settings, user_settings || {});

            _functions.defineType();
            _functions.render();
            _functions.controllers.attachEvents();
            _functions.components.select();
            _functions.components.attachEvents();

            if (!_settings.components.form.length && (_settings.components.form.jquery && !_settings.components.form.selector.length))
                _settings.components.form = component;

            if (!$.isEmptyObject(_settings.data))
                _this.fillValues(_settings.data);
        };

        this.destroy = function () {
            _functions.controllers.dettachEvents();
            _functions.components.dettachEvents();
            component.empty();
        };

        this.fillValues = function (loginData) {

            if (loginData) {
                _settings.components.password.val(loginData.password);
                _settings.components.userName.val(loginData.userName);

                if (typeof (loginData.authenticationType) !== 'undefined')
                    _settings.authenticationType = loginData.authenticationType;
            }
        };

        this.authenticate = function (data) {
            _this.fillValues(data);

            _events.components.userAuthenticate();
        };

        var _events = {
            components: {
                userAuthenticate: function (event) {

                    if (event)
                        event.preventDefault();

                    _settings.components.errorDiv.empty();

                    if (_this.validate()) {
                        var data = _this.getData();

                        if (data) {
                            if (_settings.controllers.WorkFlowController)
                                _settings.controllers.WorkFlowController.doLogin(data);
                            else if (_settings.controllers.authenticateController)
                                _settings.controllers.authenticateController.login(data);
                        }
                    }
                    else {
                        return false;
                    }
                },
                forgotPassword: function (event) {
                    event.preventDefault();

                    var em = _settings.components.userNameForgotPassword.val();
                    if (!em.isEmail()) {
                        var errors = [];
                        //TODO: USAR INTERFACEMESSAGES
                        errors.push({
                            ErrorMessage: 'Preencha o Email corretamente',
                            FriendlyMessage: 'Preencha o Email corretamente'
                        });

                        if (_settings.controllers.messagesController && errors.length > 0)
                            _settings.controllers.messagesController.notifyMessages(errors, _settings.errorMessageExhibitionType || EnumHelper.MessagesExhibitor.ExhibitionType.Dialog);

                        return;
                    }

                    if (_settings.events.forgotPassword) {
                        _settings.events.forgotPassword(em);
                    }
                    else if (_settings.controllers.authenticateController) {
                        _settings.controllers.authenticateController.forgottenPassword({
                            Signature: em,
                            AuthenticationType: _settings.authenticationType,
                            myPluginCode: _myCode
                        });
                    }
                },
                myOrders: function (event) {
                    event.preventDefault();
                    if (_settings.events.myOrders)
                        _settings.events.myOrders();
                },
                myRegister: function (event) {
                    event.preventDefault();
                    if (_settings.events.myRegister)
                        _settings.events.myRegister();
                },
                selectUser: function (event) {
                    event.preventDefault();

                    if (!_settings.components.userName.val().isEmail())
                        return;
                    if (_settings.events.selectUser)
                        _settings.events.selectUser(_settings.components.userName.val());
                },
                ediUser: function (event) {
                    event.preventDefault();
                    if (_settings.events.editUser)
                        _settings.events.editUser();
                },
                openContainerForgotPassword: function (event) {
                    event.preventDefault();
                    if (_settings.components.containerForgotPassword) {
                        _functions.components.select();

                        _settings.type = EnumHelper.LoginFormType.forgotPassword;
                        _settings.components.containerForgotPassword.html(_settings.template(_settings));

                        _functions.components.select();
                    }

                    _settings.components.errorDiv.empty();

                    _settings.components.containerLogin.hide();

                    _settings.components.containerForgotPassword.show(600);
                },
                closeContainerForgotPassword: function (event) {
                    event.preventDefault();
                    _functions.closeContainerForgotPassword();
                },
                logoutClientArea: function (event) {
                    event.preventDefault();
                    if (_settings.controllers.authenticateController)
                        _settings.controllers.authenticateController.logout();
                    _functions.onLogOut();
                },
                changePassword: function (event) {
                    event.preventDefault();

                    if (_functions.validChangePassword()) {
                        var oldPassword = _settings.components.changePassword.oldPassword.val();
                        var newPassword = _settings.components.changePassword.newPassword.val();

                        var chgPasswordObj = {
                            NewPassword: newPassword,
                            OldPassword: oldPassword,
                            Culture: Global.Culture,
                            myPluginCode: _myCode
                        };

                        if(_settings.needChangePasswordSignature)
                            chgPasswordObj.Signature = _settings.needChangePasswordSignature;

                        _settings.controllers.authenticateController.changePassword(chgPasswordObj);
                    }
                },
                callFunctionOnPressEnter: function (event) {
                    var code = (event.keyCode ? event.keyCode : event.which);
                    if (code == 13) {
                        event.data.function.call(this, event);
                    }
                }
            },
            controllers: {
                loginCompleted: function (response) {
                    if (!response.Request || response.Request.myPluginCode == _myCode) {
                        if (response.SecurityContext && response.SecurityContext.User)
                            response.User = response.SecurityContext.User;

                        if (response.User && response.User.JuridicalPerson)
                            response.User.Name = response.User.TradingName;

                        if (response.Successful && _settings.events.afterLogin) {
                            _settings.events.afterLogin(response);
                        }
                        else if (!response.Errors.length) {
                            _settings.needChangePassword = response.NeedChangePassword;
                            _settings.needChangePasswordSignature = (response.Request || {}).Signature;

                            var type = response.NeedChangePassword ? 6 : 3;
                            component.html(_settings.template({ type: type, data: response }));
                            _functions.components.select();

                            if (_settings.events.afterLoginRendered)
                                _settings.events.afterLoginRendered(response);
                        }
                        else if (response.Errors.length && _settings.controllers.messagesController) {
                            _settings.controllers.messagesController.notifyMessages(response.Errors, _settings.errorMessageExhibitionType || EnumHelper.MessagesExhibitor.ExhibitionType.Dialog);
                        }
                    }
                },

                selectUserCompleted: function (response) {
                    if (_settings.events.selectUserCompleted)
                        _settings.events.selectUserCompleted(response);
                },
                resetPasswordCompleted: function (response) {
                    if (!response.Request || response.Request.myPluginCode == _myCode) {

                        var errors = [];

                        //TODO: USAR INTERFACEMESSAGES
                        if (response.Errors && response.Errors.length > 0)
                            errors.push({
                                ErrorMessage: 'Email nÃ£o cadastrado',
                                FriendlyMessage: 'Email nÃ£o cadastrado'
                            });
                        else {
                            errors.push({
                                ErrorMessage: 'Nova senha enviada por e-mail',
                                FriendlyMessage: 'Nova senha enviada por e-mail'
                            });
                            _functions.closeContainerForgotPassword();
                        }

                        if (_settings.controllers.messagesController)
                            _settings.controllers.messagesController.notifyMessages(errors, _settings.errorMessageExhibitionType || EnumHelper.MessagesExhibitor.ExhibitionType.Dialog);
                    }
                }
            }
        };

        var _functions = {
            onLogOut: function () {
                Global.InterfaceEnvelope.User = undefined;
                Global.InterfaceEnvelope.SelectedUser = undefined;

                _settings.type = EnumHelper.LoginFormType.logOut;

                if (EnumHelper.AuthenticationType[component.data("authenticationtype")] == EnumHelper.AuthenticationType.BusinessAccess)
                    _settings.type = EnumHelper.LoginFormType.businessLogin;

                component.html(_settings.template(_settings));
                _functions.components.select();
            },
            validChangePassword: function () {
                var messages = [];
                var oldPassword = _settings.components.changePassword.oldPassword.val();
                var newPassword = _settings.components.changePassword.newPassword.val();
                var confirmPassword = _settings.components.changePassword.retryPassword.val();

                if (newPassword != undefined && newPassword.length == 0)
                    messages.push(['Login_NewPasswordRequired']);
                if (confirmPassword != undefined && confirmPassword.length == 0)
                    messages.push(['Login_ConfirmPasswordRequired']);
                else if (confirmPassword != undefined && newPassword != undefined && confirmPassword != newPassword)
                    messages.push(['Login_ConfirmPasswordAndPasswordDontMatch']);

                if (_settings.controllers.messagesController)
                    _settings.controllers.messagesController.notifyMessages(messages, EnumHelper.MessagesExhibitor.ExhibitionType.Dialog);

                return !messages.length;
            },
            render: function () {
                component.html(_settings.template(_settings));

                _functions.components.select();
            },
            defineType: function () {
                if (Global.InterfaceEnvelope.CorporateUser && _settings.type == EnumHelper.LoginFormType.login) {
                    _settings.type = 4;
                }

                if (Global.InterfaceEnvelope.User && _settings.type == EnumHelper.LoginFormType.logOut) {
                    _settings.type = EnumHelper.LoginFormType.loggedInUser;
                    _settings.data = Global.InterfaceEnvelope.User;
                }

                if (_settings.authenticationType == EnumHelper.AuthenticationType.BusinessAccess)
                    _settings.type = EnumHelper.LoginFormType.businessLogin;

                if (_settings.data.User)
                    _settings.type = EnumHelper.LoginFormType.loggedInUser;

                if (_settings.needChangePassword)
                    _settings.type = EnumHelper.LoginFormType.changePassword;
            },
            closeContainerForgotPassword: function () {
                _settings.components.errorDiv.empty();

                _settings.components.containerForgotPassword.hide();
                _settings.components.containerLogin.show(600);
                _settings.type = EnumHelper.LoginFormType.login;
                _functions.defineType();
                _functions.render();
            },
            components: {
                select: function () {
                    Util.SelectComponents(_settings.components, component, true);
                },
                setEvents: function (action) {
                    _settings.components.userName[action]('keypress', { 'function': _events.components.userAuthenticate }, _events.components.callFunctionOnPressEnter);
                    _settings.components.userNameForgotPassword[action]('keypress', { 'function': _events.components.forgotPassword }, _events.components.callFunctionOnPressEnter);
                    _settings.components.password[action]('keypress', { 'function': _events.components.userAuthenticate }, _events.components.callFunctionOnPressEnter);
                    _settings.components.loginButton[action]('click', _events.components.userAuthenticate);
                    _settings.components.forgotPassword[action]('click', _events.components.forgotPassword);
                    _settings.components.myRegisterBtn.off("click").on("click", _events.components.myRegister);
                    _settings.components.myOrdersBtn[action]('click', _events.components.myOrders);
                    _settings.components.selectUser[action]('click', _events.components.selectUser);
                    _settings.components.editUser[action]('click', _events.components.ediUser);
                    _settings.components.openContainerForgotPassword[action]('click', _events.components.openContainerForgotPassword);
                    _settings.components.closeContainerForgotPassword[action]('click', _events.components.closeContainerForgotPassword);
                    _settings.components.logOut[action]('click', _events.components.logoutClientArea);
                    _settings.components.changePassword.change[action]('click', _events.components.changePassword);
                },
                dettachEvents: function () {
                    _functions.components.setEvents('die');
                },
                attachEvents: function () {
                    _functions.components.setEvents('live');
                }
            },
            controllers: {
                setEvents: function (action) {
                    if (_settings.controllers.WorkFlowController) {
                        _settings.controllers.WorkFlowController.loginCompleted[action](_events.controllers.loginCompleted);
                        _settings.controllers.WorkFlowController.selectUserCompleted[action](_events.controllers.selectUserCompleted);
                        _settings.controllers.WorkFlowController.forgottenPasswordCompleted[action](_events.controllers.resetPasswordCompleted);
                    }

                    if (_settings.controllers.authenticateController) {
                        _settings.controllers.authenticateController.loginCompleted[action](_events.controllers.loginCompleted);
                        _settings.controllers.authenticateController.getSecurityContextCompleted[action](_events.controllers.loginCompleted);
                        _settings.controllers.authenticateController.changePasswordCompleted[action](_events.controllers.loginCompleted);
                        _settings.controllers.authenticateController.forgottenPasswordCompleted[action](_events.controllers.resetPasswordCompleted);
                        _settings.controllers.authenticateController.logoutCompleted[action](_functions.onLogOut);
                    }
                },
                dettachEvents: function () {
                    _functions.controllers.setEvents('dettach');
                },
                attachEvents: function () {
                    _functions.controllers.setEvents('attach');
                }
            }
        };

        this.clear = function () {
            component.html('');
        }

        this.validate = function () {
            var errors = [];

            //TODO: USAR INTERFACEMESSAGES
            if (!_settings.components.userName.val().isEmail())
                errors.push({ ErrorMessage: 'Preencha o Email corretamente', FriendlyMessage: 'Preencha o Email corretamente' });
            if (_settings.components.password.val().length == 0)
                errors.push({ ErrorMessage: 'Preencha a Senha corretamente', FriendlyMessage: 'Preencha a Senha corretamente' });

            if (_settings.controllers.messagesController && errors.length)
                _settings.controllers.messagesController.notifyMessages(errors, _settings.errorMessageExhibitionType);

            return !errors.length;
        }

    }

    $.fn.login = function () {
        return Util.pluginDefaultBehavior(this, "login", arguments, function () { return new Login() });
    }

})(jQuery);


ï»¿/// <reference path="WebCommon/Scripts/Libraries/EnumHelper.js" />
/// <reference path="WebCommon/Scripts/Libraries/Util.js" />
/// <reference path="WebCommon/Scripts/Libraries/Libraries/Jquery.js" />

if (TravelGo == undefined) {
    TravelGo = {};
}

if (TravelGo.Plugin == undefined) {
    TravelGo.Plugin = {};
}

if (typeof (PageManager) === 'undefined') {
    PageManager = typeof pageManager !== 'undefined' ? new pageManager() : {};
}

TravelGo.Plugin.MandatoryUserLogin = function (baseSettings) {
    var _this = this;
    var _componentIds = {
        login: {
            modal: '#mandatoryLogin',
            modalContent: '#mandatoryLoginContent',
            container: {
                login: '#login_Container',
                forgotPassword: '#forgotPassword_Container'
            },
            inputs: {
                login: {
                    userName: '#login_email',
                    password: '#login_password',
                    loginButton: '#login_send'
                },
                forgotPassword: {
                    forgotPassword: '#forgotPassword_send',
                    closeContainer: '#forgotPassword_close',
                    userName: '#forgotPassword_email'
                }
            },
            errorMessages: '#messageExhibit'
        }
    }
    var _settings = {
        data: {
            authentication : {
                authenticationCookieName: "tg_client",
            },
            loginConfigs: {
                errorMessageExhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Inline,
                needChangePassword: false,
            },
        },
        templates: {
            login: mandatoryLoginTPL
        },
        controllers: {
            messagesController: undefined,
            authenticateController: Global.AuthenticateController,
            urlController: Global.UrlController,
            searchController: Global.SearchController,
            checkOutController: Global.CheckOutController,
            params: {
                messagesController: Global.Options.messagesController,
            }
        },
        components: {
            login_errorMessages: '#login_errorMessage',
            login_modal: '#mandatoryLogin',
            login_modalContent: '#mandatoryLoginContent',
            login_modalLoginContent: '#login_Container',
            login_container_forgotPassword: '#login_forgotPassword_container',
            login_container: '#login_form_container',
            login_input_userName: '#login_email',
            login_input_password: '#login_password',
            login_input_loginButton: '#login_send',
            login_openContainerForgotPassword: '#login_openContainerForgotPassword',
            login_forgotPassword_forgotPasswordSend: '#forgotPassword_send',
            login_forgotPassword_closeContainer: '#forgotPassword_close',
            login_forgotPassword_userName: '#forgotPassword_email',
            login_changePassword_container: '#login_changePassword_container',
            login_changePassword_oldPassword: '#changePassword_oldPassword',
            login_changePassword_newPassword: '#changePassword_newPassword',
            login_changePassword_newPasswordAgain: '#changePassword_newPasswordAgain',
            login_changePassword_send: '#changePassword_send',
            checkout: {
                orderSimple: {
                    container: '#simpleorder',
                },
                contacts: {
                    name: '#contact-full-name_txt',
                    email: '#contact-email_txt',
                }
            }
        },
    };
    var _plugins = {
        login: {
            initialize: function () {
                _settings.components.login_modalLoginContent.login({
                    data: _functions.user.createLoginData(),
                    template: _settings.templates.login,
                    errorMessageExhibitionType: _settings.data.loginConfigs.errorMessageExhibitionType,
                    needChangePassword: _settings.data.loginConfigs.needChangePassword,
                    type: 1,
                    controllers: {
                        messagesController: _settings.controllers.messagesController,
                        authenticateController: _settings.controllers.authenticateController,
                    },
                    components: {
                        containerLogin: _settings.components.login_container,
                        userName: _settings.components.login_input_userName,
                        password: _settings.components.login_input_password,
                        loginButton: _settings.components.login_input_loginButton,
                        containerForgotPassword: _settings.components.login_container_forgotPassword,
                        closeContainerForgotPassword: _settings.components.login_forgotPassword_closeContainer,
                        openContainerForgotPassword: _settings.components.login_openContainerForgotPassword,
                        forgotPassword: _settings.components.login_forgotPassword_forgotPasswordSend,
                        userNameForgotPassword: _settings.components.login_forgotPassword_userName,
                        errorDiv: _settings.components.login_errorMessages,
                        changePassword: {
                            oldPassword: _settings.components.login_changePassword_oldPassword,
                            newPassword: _settings.components.login_changePassword_newPassword,
                            retryPassword: _settings.components.login_changePassword_newPasswordAgain,
                            change: _settings.components.login_changePassword_send
                        },
                    },
                    events: {
                        afterLogin: function(){ } //_functions.events.onLoginCompleted
                    },
                });
            },
            destroy: function () {
                _settings.components.login_container.login('destroy');
            },
        },
        loader: {
            show: function () {
                Global.LoaderController.showLoader();
            },
            hide: function () {
                Global.LoaderController.hideLoader();
            },
        },
        messages: {
            initialize: function () {
                _settings.components.login_errorMessages.messagesExhibitor({
                    controllers: {
                        messagesController: _settings.controllers.messagesController
                    },
                    exhibitionType: EnumHelper.MessagesExhibitor.ExhibitionType.Inline,
                    type: EnumHelper.MessagesExhibitor.Type.Warning,
                    addBold: false,
                    hasTwoBehaviors: false,
                    clickClear: false
                });
            },
            destroy: function () {
                _settings.components.login.elements.errorMessages.messagesExhibitor('destroy');
            },
        },
        initialize: function () {
            _plugins.login.initialize();

            _functions.components.select();

            _plugins.messages.initialize();
        },
        destroy: function () {
            _plugins.login.destroy();
            _plugins.messages.destroy();
        }
    };
    var _functions = {
        initialize: function (baseSettings) {
            var userLoginMandatoryOnSearch = _functions.settings.getSettingUserLoginMandatoryOnSearch();
            var userLoginMandatoryOnCheckout = _functions.settings.getSettingUserLoginMandatoryOnCheckout();

            if (baseSettings != undefined) {
                $.extend(_settings, baseSettings);
            }

            _functions.components.select();
            _functions.controllers.initialize();
            _functions.loginModal.hide();

            if (userLoginMandatoryOnSearch || userLoginMandatoryOnCheckout) {

                _functions.controllers.dettachEvents();
                _functions.controllers.attachEvents();

                if (userLoginMandatoryOnSearch && !_functions.user.isUserAuthenticated() && !Global.AuthenticateHelper) {
                    _functions.showLoginDialog();
                }
            }

            _functions.plugins.checkAndSetExternalEvents();
        },
        showLoginDialog: function () {
            _plugins.initialize();
            _functions.loginModal.show();
        },
        isUserLoginMandatoryOnCheckout: function (isUserAutenticated) {
            var pageName = _functions.getUrlFileName();
            var isPageCheckout = pageName != undefined && Util.isString(pageName) && pageName.toLowerCase().trim() === 'checkout';
            var mustLoginOnCheckout = _functions.settings.getSettingUserLoginMandatoryOnCheckout();

            if (!mustLoginOnCheckout) {
                mustLoginOnCheckout = _functions.settings.getSettingUserLoginMandatoryOnSearch();
            }

            return isPageCheckout && mustLoginOnCheckout;
        },
        getUrlFileName: function () {
            var url = (document.URL.split(/[?#]/)[0] + '////').replace(/[/]*$/, '');

            return url.substr(url.lastIndexOf('/') + 1);
        },
        settings: {
            getMandatoryRule: function () {
                if (Global != undefined && Global.Settings != undefined && Global.Settings["Travelgo.Validation.MandatoryUserLogin"] != undefined) {
                    return Global.Settings["Travelgo.Validation.MandatoryUserLogin"];
                }

                return EnumHelper.MandatoryUserLogin.No;
            },
            getSettingUserLoginMandatoryOnSearch: function () {
                return _functions.settings.checkMandatoryUserLoginPropertyMatch(EnumHelper.MandatoryUserLogin.OnSearch);
            },
            getSettingUserLoginMandatoryOnCheckout: function () {
                return _functions.settings.checkMandatoryUserLoginPropertyMatch(EnumHelper.MandatoryUserLogin.OnOrder);
            },
            checkMandatoryUserLoginPropertyMatch: function (valueToMatch) {
                var keyToCheck = _functions.settings.getMandatoryRule();

                if (EnumHelper.MandatoryUserLogin.hasOwnProperty(keyToCheck)) {
                    return EnumHelper.MandatoryUserLogin[keyToCheck] == valueToMatch;
                } else {
                    var keys = Object.keys(EnumHelper.MandatoryUserLogin);

                    for (var propertyIndex in keys) {
                        if (keys[propertyIndex].toLowerCase() == keyToCheck) {
                            return EnumHelper.MandatoryUserLogin[keys[propertyIndex]] == valueToMatch
                        }
                    }
                }

                return false;
            },
            mustLoginAtAll: function () {
                return _functions.settings.getSettingUserLoginMandatoryOnCheckout() || _functions.settings.getSettingUserLoginMandatoryOnSearch();
            }
        },
        user: {
            getUser: function () {
                var loginCookie = Util.getCookie(_settings.data.authentication.authenticationCookieName);

                //loginCookie != undefined e != null
                return loginCookie !== undefined ? JSON.parse(unescape(loginCookie)) : undefined;
            },
            isUserAuthenticated: function () {
                var loginCookie = _functions.user.getUser();

                if (loginCookie != undefined) {
                    var isSecurityKeyValid = loginCookie.st != undefined && Util.isString(loginCookie.st) && loginCookie.st.length > 0;
                    var isUserNameValid = loginCookie.un != undefined && Util.isString(loginCookie.un) && loginCookie.un.length > 0;

                    return isSecurityKeyValid && isUserNameValid;
                }

                return false;
            },
            createLoginData: function () {
                var loginCookie = _functions.user.getUser();

                return loginCookie != undefined ? { User: { Name: JSON.parse(loginCookie).un } } : undefined;
            }
        },
        loginModal: {
            show: function () {
                _settings.components.login_modal.css('display', 'block');
            },
            hide: function () {
                _settings.components.login_modal.css('display', 'none');
            }
        },
        components: {
            select: function () {
                Util.SelectComponents(_settings.components);
            },
        },
        controllers: {
            initialize: function () {
                if (_settings.controllers.messagesController === undefined) {
                    var options = Global.Options.messagesController;
                    options.Global = {};
                    _settings.controllers.messagesController = new MessagesController(options);
                }

                if (_settings.controllers.authenticateController === undefined) {
                    _settings.controllers.authenticateController = new AuthenticateController();
                }

                if (!_settings.controllers.checkOutController && typeof (CheckOutController) != "undefined")
                    _settings.controllers.checkOutController = Global.CheckOutController = Global.CheckOutController || new CheckOutController();

            },
            attachEvents: function () {
                if (_settings.controllers.authenticateController != undefined && !Global.AuthenticateHelper)
                    _settings.controllers.authenticateController.loginCompleted.attach(_functions.events.onLoginCompleted);

                var starRouteAttached = false;
                if (_settings.controllers.checkOutController != undefined) {
                    _settings.controllers.checkOutController.preOrderStarting.attach(_functions.events.onStartRouteCompleted);
                    starRouteAttached = true;
                }
                if (_settings.controllers.searchController != undefined) {
                    _settings.controllers.searchController.searchStarting.attach(_functions.events.onStartRouteCompleted);
                    starRouteAttached = true
                }

                if (!starRouteAttached && _settings.controllers.urlController != undefined) {
                    _settings.controllers.urlController.startRouteCompleted.attach(_functions.events.onStartRouteCompleted);
                }
            },
            dettachEvents: function () {
                if (_settings.controllers.authenticateController != undefined)
                    _settings.controllers.authenticateController.loginCompleted.dettach(_functions.events.onLoginCompleted);

                if (_settings.controllers.checkOutController != undefined)
                    _settings.controllers.checkOutController.preOrderStarting.dettach(_functions.events.onStartRouteCompleted);

                if (_settings.controllers.searchController != undefined)
                    _settings.controllers.searchController.searchStarting.dettach(_functions.events.onStartRouteCompleted);

                if (_settings.controllers.urlController != undefined)
                    _settings.controllers.urlController.startRouteCompleted.dettach(_functions.events.onStartRouteCompleted);
            },
            assignControllers: function () {
                if (Global.CheckOutController)
                    _settings.controllers.checkOutController = Global.CheckOutController;
            },
            reattachEvents: function () {
                _functions.controllers.dettachEvents();
                _functions.controllers.attachEvents();
            },
            destroy: function () {
                functions.controllers.dettachEvents();
            }
        },
        events: {
            onLoginCompleted: function (loginRS) {
                if (loginRS != undefined && loginRS.Successful) {
                    Util.setCookie(_settings.data.authentication.authenticationCookieName, JSON.stringify({ st: loginRS.SecurityToken.Key, un: loginRS.User.FullName, uc: loginRS.User.Id }), 0, false);
                    Global.Headers.st = loginRS.SecurityToken.Key;
                    _functions.loginModal.hide();
                    _functions.validations.reloadPageAfterLogin(loginRS);
                }
            },
            onStartRouteCompleted: function () {
                _functions.validations.showMessageWhenMorePassengerThenPermitted();
            },
            onAfterRenderCheckout: function (origin, data) {
                if (origin && origin == 'OrderSimple') {
                    if (_functions.settings.getSettingUserLoginMandatoryOnSearch() || _functions.isUserLoginMandatoryOnCheckout()) {
                        _functions.components.select();

                        if (_settings.components.checkout.contacts.name) {
                            _settings.components.checkout.contacts.name.attr('readonly', '');
                        }

                        if (_settings.components.checkout.contacts.email) {
                            _settings.components.checkout.contacts.email.attr('readonly', '');
                        }

                        if (!_functions.user.isUserAuthenticated() && !Global.AuthenticateHelper) {
                            _functions.showLoginDialog();
                        }
                    }
                }
            },
            onBeforeRenderPaymentAndChoosePasswordStarting: function (data) {
                if (_functions.settings.getSettingUserLoginMandatoryOnSearch() || _functions.isUserLoginMandatoryOnCheckout()) {
                    data.ContactInformations.isEmailFieldReadOnly = true;
                    data.ContactInformations.isNameFieldReadOnly = true;
                }
            }
        },
        validations: {
            showMessageWhenMorePassengerThenPermitted: function () {
                if (_functions.validations.morePassengerThenPermitted()) {
                    if (_settings.controllers.messagesController) {
                        _settings.controllers.messagesController.notifyMessages([["Passenger_MoreThanPermitted", Global.URLSite]], EnumHelper.MessagesExhibitor.ExhibitionType.Inline);
                    }
                }
            },
            morePassengerThenPermitted: function () {
                if (Global.InterfaceEnvelope && Global.Settings) {
                    var passengerMustBeAuthenticatedUser = Global.Settings["Travelgo.Checkout.PassengerMustBeAuthenticatedUser"] && Global.Settings["Travelgo.Checkout.PassengerMustBeAuthenticatedUser"].toUpperCase().trim() === "TRUE";
                    var maxPassengerQtd = passengerMustBeAuthenticatedUser
                        ? 1
                        : parseInt(Global.Settings["Travelgo.Validation.MaxPassengerQtd"]);

                    if (maxPassengerQtd > 0) {
                        var selectedPaxQuantity = _functions.validations.passengerSelection.air();
                        if (selectedPaxQuantity > 0)
                            return selectedPaxQuantity > maxPassengerQtd;

                        selectedPaxQuantity = _functions.validations.passengerSelection.hotel();
                        if (selectedPaxQuantity > 0)
                            return selectedPaxQuantity > maxPassengerQtd;

                    }
                }
            },
            passengerSelection: {
                air: function () {
                    if (Global.InterfaceEnvelope &&
                        Global.InterfaceEnvelope.SearchParameters &&
                        Global.InterfaceEnvelope.SearchParameters.Air) {
                        var searching = Global.InterfaceEnvelope.SearchParameters.Air.Adults +
                            Global.InterfaceEnvelope.SearchParameters.Air.Babies +
                            Global.InterfaceEnvelope.SearchParameters.Air.Children;

                        return searching;
                    }
                    return 0;
                },
                hotel: function () {
                    if (Global.InterfaceEnvelope &&
                        Global.InterfaceEnvelope.SearchParameters &&
                        Global.InterfaceEnvelope.SearchParameters.Hotel &&
                        Global.InterfaceEnvelope.SearchParameters.Hotel.RoomsRequest) {
                        var searching = Global.InterfaceEnvelope.SearchParameters.Hotel.RoomsRequest.sum(function (r) { return parseInt(r.Adults) + r.ChildAges.length; });
                        return searching;
                    }
                    return 0;
                }
            },
            reloadPageAfterLogin: function (responseSignIn) {
                if (_functions.settings.mustLoginAtAll() && !responseSignIn.pageReloaded) {

                    if (_settings.controllers.messagesController)
                        _settings.controllers.messagesController.notifyMessages(['Please_Wait'], EnumHelper.MessagesExhibitor.ExhibitionType.Dialog);

                    location.reload(false);
                    responseSignIn.pageReloaded = true;
                }
            }
        },
        plugins: {
            checkAndSetExternalEvents: function () {
                if (PageManager && PageManager.attachOnRenderCompleted) {
                    PageManager.attachOnRenderCompleted(_functions.events.onAfterRenderCheckout);
                }
            }
        },
    };

    _this.reattachEvents = function () {
        _functions.controllers.assignControllers();
        _functions.controllers.reattachEvents();
    }

    _this.isUserLoginMandatoryOnCheckout = _functions.isUserLoginMandatoryOnCheckout;
    _this.validationAfterLogin = function (responseSignIn) {
        _functions.validations.reloadPageAfterLogin(responseSignIn);
    }
    _this.onBeforeRenderPaymentAndChoosePasswordStarting = _functions.events.onBeforeRenderPaymentAndChoosePasswordStarting;
    _this.onAfterRenderCheckout = _functions.events.onAfterRenderCheckout;

    _functions.initialize(baseSettings);

    return _this;
};

(function () {
    $(document).ready(function () {
        if (Global == undefined) {
            Global = {};
        }

        if (Global.UrlController) {
            Global.UrlController.startRouteCompleted.attach(function () {
                if (Global.MandatoryUserLogin == undefined)
                    Global.MandatoryUserLogin = new TravelGo.Plugin.MandatoryUserLogin({});
                else
                    Global.MandatoryUserLogin.reattachEvents();
            });
        }
        else {
            Global.MandatoryUserLogin = new TravelGo.Plugin.MandatoryUserLogin({});
        }
    });
}());

// This file was automatically generated from MandatoryUserLogin.soy.
// Please don't edit this file by hand.

if (typeof MandatoryUserLoginTemplate == 'undefined') { var MandatoryUserLoginTemplate = {}; }


MandatoryUserLoginTemplate.login = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="login_form_container" class="loginDialog"><h3>Identifique-se</h3><p class="info">Identifique-se para prosseguir</p><label class="lblEmail"><input type="email" placeholder="E-mail:" id="login_email" class="email" /></label><label class="lblPassword"><input type="password" placeholder="Senha:" id="login_password" class="password" /></label><a id="login_openContainerForgotPassword" href="#" title="Esqueci minha senha" class="forgot">Esqueci minha senha</a><label class="continue"><a href="#" class="btn btn_send" id="login_send" title="Continuar">Continuar</a></label></div><div id="login_forgotPassword_container" class="loginDialog"></div><div id="login_changePassword_container" class="loginDialog"></div>');
  if (!opt_sb) return output.toString();
};


MandatoryUserLoginTemplate.forgotPassword = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="login_form_container" class="loginDialog"></div><div id="login_forgotPassword_container" class="loginDialog"><h3>Trocar minha senha</h3><p class="info">Digite seu e-mail de cadastro e clique em enviar para receber um e-mail com instruÃ§Ãµes sobre como cadastrar uma nova senha.</p><label class="lblEmail"><input type="text" id="forgotPassword_email" name="userEmailForgot" class="email" placeholder="E-mail:"  /></label><a href="#" class="btn btn_send" id="forgotPassword_send" title="Enviar">Enviar</a><a href="#" class="btn btn_close" id="forgotPassword_close" title="Voltar">Voltar</a></div><div id="login_changePassword_container" class="loginDialog"></div>');
  if (!opt_sb) return output.toString();
};


MandatoryUserLoginTemplate.changePassword = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="login_form_container" class="loginDialog"></div><div id="login_forgotPassword_container" class="loginDialog"></div><div id="login_changePassword_container" class="loginDialog"><h3>Trocar senha</h3><p class="info">Para prosseguir, Ã© necessÃ¡rio trocar sua senha. Informe a senha atual e a nova senha nos campos abaixo e clique em enviar.</p><label class="lblPassword"><input type="password" id="changePassword_oldPassword" name="changePassword_oldPassword" class="password" placeholder="Senha antiga:"  /></label><label class="lblPassword"><input type="password" id="changePassword_newPassword" name="changePassword_newPassword" class="password" placeholder="Nova senha:"  /></label><label class="lblPassword"><input type="password" id="changePassword_newPasswordAgain" name="changePassword_newPasswordAgain" class="password" placeholder="ConfirmaÃ§Ã£o de senha:"  /></label><a href="#" class="btn btn_send" id="changePassword_send" title="Enviar">Enviar</a></div>');
  if (!opt_sb) return output.toString();
};


ï»¿var mandatoryLoginTPL = function (options) {

    var _settings = {
        'type': 1
    };

    $.fn.extend(_settings, options || {});

    switch (_settings.type) {
        case 1:
        case 2:
            return MandatoryUserLoginTemplate.login();
            break;
        case 5:
            return MandatoryUserLoginTemplate.forgotPassword();
            break;
        case 6:
            return MandatoryUserLoginTemplate.changePassword();
            break;
    }

    return '';
};